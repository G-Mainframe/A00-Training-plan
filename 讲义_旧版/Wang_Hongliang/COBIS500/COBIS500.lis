Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

t@C: C:\COB97\SOC\COBIS500\COBIS500.PCOI[v
     1  000010******************************************************************
     2  000020*         CP(A)                                     *
     3  000030*      1. vO  : _`׈ڍs               *
     4  000040*      2. vOID  : COBIS500                               *
     5  000050*      3. Tv      : SUMMITt@N^OcaA_` *
     6  000060*                         ׃e[u쐬B           *
     7  000070*      4. 쐬        : ^                                 *
     8  000080*      5. 쐬        : 2005.4.4                               *
     9  000090******************************************************************
    10  000100*                                                                 
    11  000110******************************************************************
    12  000120*    hcdmshehb`shnm  chuhrhnm              *
    13  000130******************************************************************
    14  000140 IDENTIFICATION                       DIVISION.                   
    15  000150*                                                                 
    16  000160 PROGRAM-ID.                          COBIS500.                   
    17  000170******************************************************************
    18  000180*    dmuhqnmldms        chuhrhnm              *
    19  000190******************************************************************
    20  000200 ENVIRONMENT                          DIVISION.                   
    21  000210******************************************************************
    22  000220*    c`s`                      chuhrhnm              *
    23  000230******************************************************************
    24  000240 DATA                                 DIVISION.                   
    25  000250******************************************************************
    26  000260*  vnqjhmf|rsnq`fd  rdbshnm                *
    27  000270******************************************************************
    28  000280  WORKING-STORAGE                     SECTION.                    
    29  000290*----------------------------------------------------------------*
    30  000300*    zXgϐ`GA                                        *
    31  000310*----------------------------------------------------------------*
    32  000320     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
    33  000330*--< nq`bkdʕϐ >                                       
    34  000340     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
    35  000350*                                                                 
    36  000360*--< nq`bkd  rpks >                               
t@C: Z:\COB97\COPYLIB_DB\SQLCOM.CBLI[v
     1  000010*--rpkʕϐ
     2  000030   01  SQLSTATE                      PIC  X(005).
     3  000040   01  DB-STRING                     PIC  X(020).
     4  000050   01  USERNAME                      PIC  X(010).
     5  000060   01  PASSWD                        PIC  X(010).
     6  000070*
t@C: Z:\COB97\COPYLIB_DB\SQLCOM.CBLN[Y
    37  000370     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
    38  000380*                                                                 
    39  000390*--< ڍs_WJ >                                            
    40  000400     EXEC  SQL  INCLUDE  LTRFCT.CBL            END-EXEC.          
    41  000410*--< ϊe[u >                                               
t@C: Z:\COB97\COPYLIB_DB\LTRFCT.CBLI[v
     1  000010************************************************
     2  000020* ̧ݸށi`j(LTRFCT)
     3  000030************************************************
     4  000040 01  ksqebs|_ԍ PIC  X(009).
     5  000050 01  ksqebs| PIC  X(007).
     6  000060 01  ksqebs|@ PIC S9(001) COMP-3.
     7  000070 01  ksqebs|㗝敪 PIC S9(001) COMP-3.
     8  000080 01  ksqebs|ԓ PIC S9(004) COMP-3.
     9  000090 01  ksqebs|z PIC S9(013) COMP-3.
    10  000100 01  ksqebs| PIC S9(013) COMP-3.
    11  000110 01  ksqebs| PIC S9(003)V9(8) COMP-3.
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    12  000120 01  ksqebs|萔 PIC S9(013) COMP-3.
    13  000130 01  ksqebs|萔œz PIC S9(013) COMP-3.
    14  000140 01  ksqebs|ߗ\ PIC  X(007).
    15  000150 01  ksqebs|x PIC  X(007).
    16  000160 01  ksqebs|\ PIC  X(060).
    17  000170 01  ksqebs|Oٓ PIC  X(007).
    18  000180 01  ksqebs|߂z PIC S9(013) COMP-3.
    19  000190 01  ksqebs|߂ PIC S9(003)V9(8) COMP-3.
    20  000200 01  ksqebs|߂ PIC S9(004) COMP-3.
    21  000210 01  ksqebs|߂E敪 PIC S9(001) COMP-3.
    22  000220 01  ksqebs|ԍώ萔 PIC S9(013) COMP-3.
    23  000230 01  ksqebs|ԍώ萔œz PIC S9(013) COMP-3.
    24  000240 01  ksqebs|_~[OOP PIC  X(040).
    25  000250 01  ksqebs|`ԍ PIC  X(010).
    26  000260 01  ksqebs|` PIC S9(001) COMP-3.
    27  000270 01  ksqebs|`@ PIC S9(001) COMP-3.
    28  000280 01  ksqebs|sR[h PIC  X(007).
    29  000290 01  ksqebs|xl PIC  X(060).
    30  000300 01  ksqebs|xꏊ PIC  X(060).
    31  000310 01  ksqebs|_~[OOQ PIC  X(061).
t@C: Z:\COB97\COPYLIB_DB\LTRFCT.CBLN[Y
    42  000420     EXEC  SQL  INCLUDE  IKOTBL001.CBL         END-EXEC.          
    43  000430*--< ڍs_ >                                                
t@C: Z:\COB97\COPYLIB_DB\IKOTBL001.CBLI[v
     1  000010************************************************
     2  000020* ϊe[u(IKOTBL001)
     3  000030************************************************
     4  000040 01  hjnOOP|R[h PIC  X(008).
     5  000050 01  hjnOOP|ړIbc PIC  X(001).
     6  000060 01  hjnOOP|VR[h PIC  X(007).
     7  000070 01  hjnOOP|} PIC  X(003).
     8  000080 01  hjnOOP|^MR[h PIC  X(007).
     9  000090 01  hjnOOP|񂹃R[h PIC  X(008).
    10  000100 01  hjnOOP|[UR[h PIC  X(008).
    11  000110 01  hjnOOP|ʂbc PIC  X(001).
t@C: Z:\COB97\COPYLIB_DB\IKOTBL001.CBLN[Y
    44  000440     EXEC  SQL  INCLUDE  LTRFCK.CBL            END-EXEC.          
    45  000450*--< ϑca>                                                  
t@C: Z:\COB97\COPYLIB_DB\LTRFCK.CBLI[v
     1  000010************************************************
     2  000020* ̧ݸށi{j(LTRFCK)
     3  000030************************************************
     4  000040 01  ksqebj|_ԍ PIC  X(009).
     5  000050 01  ksqebj|[U[R[h PIC  X(008).
     6  000060 01  ksqebj|R[h PIC  X(008).
     7  000070 01  ksqebj|ƏR[h PIC S9(004) COMP-3.
     8  000080 01  ksqebj|S҃R[h PIC S9(004) COMP-3.
     9  000090 01  ksqebj|_ PIC  X(007).
    10  000100 01  ksqebj|s PIC  X(007).
    11  000110 01  ksqebj|菈R[h PIC S9(002) COMP-3.
    12  000120 01  ksqebj|Г PIC S9(003)V9(8) COMP-3.
    13  000130 01  ksqebj| PIC S9(003)V9(8) COMP-3.
    14  000140 01  ksqebj|ev PIC S9(013) COMP-3.
    15  000150 01  ksqebj|zʋz PIC S9(013) COMP-3.
    16  000160 01  ksqebj|Ɩ敪 PIC S9(001) COMP-3.
    17  000170 01  ksqebj| PIC  X(007).
    18  000180 01  ksqebj|sR[h PIC  X(007).
    19  000190 01  ksqebj|ԍ PIC  X(007).
    20  000200 01  ksqebj|a PIC S9(001) COMP-3.
    21  000210 01  ksqebj|Č敪 PIC  X(001).
    22  000220 01  ksqebj|gc敪 PIC S9(001) COMP-3.
    23  000230 01  ksqebj|R[h PIC S9(001) COMP-3.
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    24  000240 01  ksqebj|[R[h PIC S9(001) COMP-3.
    25  000250 01  ksqebj|O敪 PIC S9(001) COMP-3.
    26  000260 01  ksqebj|В[[敪 PIC S9(001) COMP-3.
    27  000270 01  ksqebj|ϓ敪 PIC S9(001) COMP-3.
    28  000280 01  ksqebj|A敪 PIC S9(002) COMP-3.
    29  000290 01  ksqebj|Xvbh PIC S9(003)V9(8) COMP-3.
    30  000300 01  ksqebj|xΉ敪 PIC S9(001) COMP-3.
    31  000310 01  ksqebj|҃R[h PIC  X(008).
    32  000320 01  ksqebj|ҏP PIC  X(040).
    33  000330 01  ksqebj|ҏQ PIC  X(040).
    34  000340 01  ksqebj|ҏR PIC  X(040).
    35  000350 01  ksqebj|Fmn PIC  X(006).
    36  000360 01  ksqebj|xF PIC  X(007).
    37  000370 01  ksqebj|xF|S҃R[h PIC  X(004).
    38  000380 01  ksqebj|x@R[h PIC S9(002) COMP-3.
    39  000390 01  ksqebj|Ǘs PIC  X(007).
    40  000400 01  ksqebj|cao^ PIC  X(007).
    41  000410 01  ksqebj|\ PIC  X(090).
    42  000420 01  ksqebj|ʏ PIC  X(035).
t@C: Z:\COB97\COPYLIB_DB\LTRFCK.CBLN[Y
    46  000460     EXEC  SQL  INCLUDE  D415UTM.CBL           END-EXEC.          
    47  000470*                                                                 
t@C: Z:\COB97\COPYLIB_DB\D415UTM.CBLI[v
     1        *****************************************************************
     2        *   _`(D415UTM_TBL)
     3        *****************************************************************
     4         01  _`.
     5             03  cSPT|_ԍ    PIC  X(010).
     6             03  cSPT|הԍ    PIC S9(003) PACKED-DECIMAL.
     7             03  cSPT|R[h
     8                                       PIC  X(009).
     9             03  cSPT|_R[h
    10                                       PIC  X(005).
    11             03  cSPT|zʋz    PIC S9(013) PACKED-DECIMAL.
    12             03  cSPT|`    PIC  X(008).
    13             03  cSPT|    PIC  X(008).
    14             03  cSPT|        PIC S9(003) PACKED-DECIMAL.
    15             03  cSPT|      PIC S9(002)V9(008) PACKED-DECIMAL.
    16             03  cSPT|      PIC S9(013) PACKED-DECIMAL.
    17             03  cSPT|旧萔
    18                                       PIC S9(013) PACKED-DECIMAL.
    19             03  cSPT|旧萔Ŋz
    20                                       PIC S9(013) PACKED-DECIMAL.
    21             03  cSPT|z  PIC S9(013) PACKED-DECIMAL.
    22             03  cSPT|Г敪
    23                                       PIC  X(001).
    24             03  cSPT|Г    PIC S9(002)V9(008) PACKED-DECIMAL.
    25             03  cSPT|N    PIC S9(002)V9(008) PACKED-DECIMAL.
    26             03  cSPT|e        PIC S9(013) PACKED-DECIMAL.
    27             03  cSPT|`ԍ    PIC  X(010).
    28             03  cSPT|`    PIC  X(001).
    29             03  cSPT|xsR[h
    30                                       PIC  X(004).
    31             03  cSPT|xxXR[h
    32                                       PIC  X(003).
    33             03  cSPT|R[h
    34                                       PIC  X(009).
    35             03  cSPT|R[h
    36                                       PIC  X(005).
    37             03  cSPT|Г|
    38                                       PIC S9(002)V9(008) PACKED-DECIMAL.
    39             03  cSPT|e|  PIC S9(013) PACKED-DECIMAL.
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    40             03  cSPT|Oٓ
    41                                       PIC  X(008).
    42             03  cSPT|    PIC  X(010).
    43             03  cSPT|敪
    44                                       PIC  X(001).
    45             03  cSPT|XVN  PIC  X(008).
    46             03  cSPT|XV    PIC  X(008).
    47             03  cSPT|XV      PIC  X(008).
    48             03  cSPT|͒S҃R[h
    49                                       PIC  X(008).
    50             03  cSPT|o^N  PIC  X(008).
    51             03  cSPT|o^    PIC  X(008).
    52             03  cSPT|o^S  PIC  X(008).
t@C: Z:\COB97\COPYLIB_DB\D415UTM.CBLN[Y
    48  000480     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
    49  000490*                                                                 
    50  000500*----------------------------------------------------------------*
    51  000510*    vnqjGA                                              *
    52  000520*----------------------------------------------------------------*
    53  000530 01  vnqj|GA.                                            
    54  000540*--< G[p >                                               
    55  000550     03  v|G[R[h             PIC S9(04).                 
    56  000560*                                                                 
    57  000570*--< tOAA >                                               
    58  000580     03  tOAA.                                            
    59  000590         05  v|I|tO         PIC  X(01).                 
    60  000600         05  v|ُI|tO     PIC  X(01).                 
    61  000610*                                                                 
    62  000620*--< GA >                                                 
    63  000630     03  GA.                                              
    64  000640         05  v|́|P           PIC  9(09).               
    65  000650         05  v|́|Q           PIC  9(09).               
    66  000660         05  v|ó|             PIC  9(09).               
    67  000670*                                                                 
    68  000680*--< ʏ >                                                   
    69  000690 01  v|ʏ.                                                
    70  000700     03  v|VXet.                                        
    71  000710         05  v|I                 PIC  X(02) VALUE  "20".     
    72  000720         05  v|N               PIC  X(06).                 
    73  000730     03  v|VXe             PIC  X(08).                 
    74  000740     03  v|S                   PIC  X(08) VALUE "IKOPG   ".
    75  000750*                                                                 
    76  000760*----------------------------------------------------------------*
    77  000770*    Tu[`                                              *
    78  000780*----------------------------------------------------------------*
    79  000790 01  CALL-AREA.                                                   
    80  000800*--< ʃOTu[` >                                       
    81  000810     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
    82  000820     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
    83  000830*                                                                 
    84  000840*----------------------------------------------------------------*
    85  000850*    bnoẍ                                                *
    86  000860*----------------------------------------------------------------*
    87  000870*--< ʃOpp[^ >                                       
    88  000880 01  IF-CHOCO001.                                                 
    89  000890     COPY  CHOCO001  REPLACING  ==()==  BY  ==P|==.           
    90  000900*                                                                 
    91  000910*----------------------------------------------------------------*
    92  000920*    hmht@CǍTu[`pp^̈                *
    93  000930*----------------------------------------------------------------*
    94  000940 01  PARA-AREA.                                                   
    95  000950     COPY CPBCO001.                                               
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    96  000960******************************************************************
    97  000970*    萔pf[^`GA                                      *
    98  000980******************************************************************
    99  000990 CONSTANT                             SECTION.                    
   100  001000 01  萔̈.                                                    
   101  001010     03  萔|vOhc         PIC  X(08) VALUE "COBIS500".
   102  001020     03  萔|vO           PIC  X(80)                  
   103  001030                                    VALUE  "_`ׂca".
   104  001040     03  萔|rpknj             PIC S9(04)  VALUE  ZERO.    
   105  001050     03  萔|rpkdmc           PIC S9(04)  VALUE  0100.    
   106  001060     03  萔|               PIC S9(04)  VALUE  ZERO.    
   107  001070     03  萔|ُ               PIC S9(04)  VALUE  0009.    
   108  001080******************************************************************
   109  001090*    oqnbdctqd            chuhrhnm              *
   110  001100******************************************************************
   111  001110 PROCEDURE                            DIVISION.                   
   112  001120*                                                                 
   113  001130     PERFORM  .                                           
   114  001140*                                                                 
   115  001150     PERFORM  又  UNTIL  v|I|tO  =  "Y".            
   116  001160*                                                                 
   117  001170     PERFORM  I.                                           
   118  001180*                                                                 
   119  001190     STOP     RUN.                                                
   120  001200*                                                                 
   121  001210******************************************************************
   122  001220*                                                        *
   123  001230******************************************************************
   124  001240                              SECTION.                    
   125  001250 |rs`qs.                                            
   126  001260*                                                                 
   127  001270*----------------------------------------------------------------*
   128  001280*    JnbZ[Wo͏                                      *
   129  001290*----------------------------------------------------------------*
   130  001300     INITIALIZE                       IF-CHOCO001.                
   131  001310     MOVE  "3"                        TO  P|Cxg.     
   132  001320     MOVE  萔|vOhc       TO  P|\[Xhc.       
   133  001330     MOVE  "0"                        TO  P|AR[h.       
   134  001340     MOVE  "START"                    TO  P|.         
   135  001350     MOVE  萔|vO         TO  P|̑bZ[W. 
   136  001360     CALL  CLOCO001                USING  IF-CHOCO001.            
   137  001370*                                                                 
   138  001380*----------------------------------------------------------------*
   139  001390*    Ɨ̈̏l                                        *
   140  001400*----------------------------------------------------------------*
   141  001410     MOVE  SPACE                      TO  vnqj|GA.       
   142  001420     INITIALIZE                           vnqj|GA.       
   143  001430*                                                                 
   144  001440*--< bott擾 >                                           
   145  001450     ACCEPT  v|N               FROM  DATE.                 
   146  001460*                                                                 
   147  001470*--< bot擾 >                                           
   148  001480     ACCEPT  v|VXe         FROM  TIME.                 
   149  001490*                                                                 
   150  001500*--< nq`bkdڑ >                                           
   151  001510     PERFORM   nq`bkdڑ.                                  
   152  001520*                                                                 
   153  001530*--< e[uJ[\` >                                   
   154  001540     PERFORM  e[uJ[\`.                           
   155  001550*                                                                 
   156  001560*--< e[uJ[\Ǎ(P) >                           
   157  001570     PERFORM  e[uJ[\Ǎ.                           
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   158  001580*                                                                 
   159  001590 |dwhs.                                              
   160  001600     EXIT.                                                        
   161  001610******************************************************************
   162  001620*    nq`bkdڑ                                            *
   163  001630******************************************************************
   164  001640 nq`bkdڑ                     SECTION.                    
   165  001650 nq`bkdڑ|rs`qs.                                    
   166  001660*                                                                 
   167  001670*--< hmht@CǍTu[`Ăяo >                     
   168  001680     CALL  COBCO001                USING  PARA-AREA.              
   169  001690*                                                                 
   170  001700     MOVE  PARA-DBSTRING              TO  DB-STRING.              
   171  001710     MOVE  PARA-USERNAME              TO  USERNAME.               
   172  001720     MOVE  PARA-PASSWORD              TO  PASSWD.                 
   173  001730*                                                                 
   174  001740*----------------------------------------------------------------*
   175  001750*    Jnڑ                                                    *
   176  001760*----------------------------------------------------------------*
   177  001770     IF  DB-STRING  =  SPACE                                      
   178  001780        EXEC  SQL                                                 
   179  001790           CONNECT  :USERNAME  IDENTIFIED  BY  :PASSWD            
   180  001800        END-EXEC                                                  
   181  001810     ELSE                                                         
   182  001820        EXEC  SQL                                                 
   183  001830           CONNECT  :USERNAME  IDENTIFIED  BY  :PASSWD            
   184  001840             USING  :DB-STRING                                    
   185  001850        END-EXEC                                                  
   186  001860     END-IF.                                                      
   187  001870*                                                                 
   188  001880*----------------------------------------------------------------*
   189  001890*    ڑԔ                                                *
   190  001900*----------------------------------------------------------------*
   191  001910     EVALUATE  SQLCODE                                            
   192  001920        WHEN  萔|rpknj                                    
   193  001930*--<       ڑ >                                             
   194  001940           CONTINUE                                               
   195  001950        WHEN  OTHER                                               
   196  001960*--<       ڑG[ >                                           
   197  001970           MOVE     -10               TO  v|G[R[h        
   198  001980           PERFORM  G[                                    
   199  001990     END-EVALUATE.                                                
   200  002000*                                                                 
   201  002010 nq`bkdڑ|dwhs.                                      
   202  002020     EXIT.                                                        
   203  002030******************************************************************
   204  002040*        e[uJ[\`                                *
   205  002050******************************************************************
   206  002060 e[uJ[\`             SECTION.                    
   207  002070 e[uJ[\`|rs`qs.                            
   208  002080*                                                                 
   209  002090*----------------------------------------------------------------*
   210  002100*    J[\nodm                                        *
   211  002110*----------------------------------------------------------------*
   212  002120     EXEC SQL                                                     
   213  002130        DECLARE CUR1  CURSOR FOR                                  
   214  002140           SELECT  LTRFCT._ԍ                                
   215  002141                  ,NVL(LTRFCK.[U[R[h,RPAD('0',8,'0'))     
   216  002142                  ,NVL(LTRFCK.zʋz,0)                         
   217  002143                  ,NVL(LTRFCK.,RPAD('0',7,'0'))               
   218  002170                  ,LTRFCT.                                
   219  002180                  ,LTRFCT.ԓ                                
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   220  002190                  ,LTRFCT.                                  
   221  002200                  ,LTRFCT.                                  
   222  002210                  ,LTRFCT.萔                              
   223  002220                  ,LTRFCT.萔œz                    
   224  002230                  ,LTRFCT.z                                
   225  002231                  ,NVL(LTRFCK.Г,0)                         
   226  002232                  ,NVL(LTRFCK.ev,0)                           
   227  002260                  ,LTRFCT.`ԍ                                
   228  002270                  ,LTRFCT.`                                
   229  002280                  ,LTRFCT.sR[h                          
   230  002300                  ,NVL(LTRFCK.R[h,RPAD('0',8,'0'))       
   231  002310                  ,LTRFCT.Oٓ                            
   232  002320             FROM  LTRFCK                                         
   233  002330                  ,LTRFCT                                         
   234  002340            WHERE  LTRFCT._ԍ  =  LTRFCK._ԍ ( + )      
   235  002350     END-EXEC.                                                    
   236  002360*                                                                 
   237  002370*----------------------------------------------------------------*
   238  002380*    J[\nodm                                        *
   239  002390*----------------------------------------------------------------*
   240  002400     EXEC  SQL                                                    
   241  002410        OPEN  CUR1                                                
   242  002420     END-EXEC.                                                    
   243  002430*                                                                 
   244  002440*----------------------------------------------------------------*
   245  002450*    J[\nodmmF                                        *
   246  002460*----------------------------------------------------------------*
   247  002470     EVALUATE  SQLCODE                                            
   248  002480        WHEN  萔|rpknj                                    
   249  002490*--<        >                                                 
   250  002500           CONTINUE                                               
   251  002510        WHEN  OTHER                                               
   252  002520*--<       J[\nodmG[ >                               
   253  002530           MOVE -20                   TO  v|G[R[h        
   254  002540           PERFORM  G[                                    
   255  002550     END-EVALUATE.                                                
   256  002560*                                                                 
   257  002570 e[uJ[\`|dwhs.                              
   258  002580     EXIT.                                                        
   259  002590******************************************************************
   260  002600*    e[uJ[\Ǎ                                    *
   261  002610******************************************************************
   262  002620 e[uJ[\Ǎ             SECTION.                    
   263  002630 e[uJ[\Ǎ|rs`qs.                            
   264  002640*                                                                 
   265  002650*--< e[uJ[\Ǎ >                                   
   266  002660     EXEC SQL                                                     
   267  002670         FETCH  CUR1                                              
   268  002680          INTO  :ksqebs|_ԍ                           
   269  002681               ,:ksqebj|[U[R[h                     
   270  002690               ,:ksqebj|zʋz                           
   271  002700               ,:ksqebj|                               
   272  002710               ,:ksqebs|                           
   273  002720               ,:ksqebs|ԓ                           
   274  002730               ,:ksqebs|                             
   275  002740               ,:ksqebs|                             
   276  002750               ,:ksqebs|萔                         
   277  002760               ,:ksqebs|萔œz               
   278  002770               ,:ksqebs|z                           
   279  002780               ,:ksqebj|Г                           
   280  002790               ,:ksqebj|ev                             
   281  002800               ,:ksqebs|`ԍ                           
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   282  002810               ,:ksqebs|`                           
   283  002820               ,:ksqebs|sR[h                     
   284  002830               ,:ksqebj|R[h                       
   285  002840               ,:ksqebs|Oٓ                       
   286  002850     END-EXEC.                                                    
   287  002860*                                                                 
   288  002870*----------------------------------------------------------------*
   289  002880*    e[uJ[\ǍmF                              *
   290  002890*----------------------------------------------------------------*
   291  002900     EVALUATE   SQLCODE                                           
   292  002910        WHEN   萔|rpknj                                   
   293  002920*--<        >                                                 
   294  002930           COMPUTE  v|́|P  =  v|́|P  +  1   
   295  002940           COMPUTE  v|́|Q  =  v|́|Q  +  1   
   296  002950        WHEN   萔|rpkdmc                                 
   297  002960*--<       ǍI >                                             
   298  002970           MOVE  "Y"                  TO  v|I|tO        
   299  002980        WHEN   OTHER                                              
   300  002990*--<       ǍG[ >                                           
   301  003000           MOVE     -30               TO  v|G[R[h        
   302  003010           PERFORM  G[                                    
   303  003020     END-EVALUATE.                                                
   304  003030*                                                                 
   305  003040 e[uJ[\Ǎ|dwhs.                              
   306  003050     EXIT.                                                        
   307  003060******************************************************************
   308  003070*    又                                                      *
   309  003080******************************************************************
   310  003090 又                               SECTION.                    
   311  003100 又|rs`qs.                                              
   312  003110*                                                                 
   313  003120     PERFORM  ҏWo͏.                                       
   314  003130*                                                                 
   315  003140     PERFORM  o͏                                            
   316  003150*--< e[uJ[\ǍiQڈȍ~j >                     
   317  003160     PERFORM  e[uJ[\Ǎ.                           
   318  003170*                                                                 
   319  003180 又|dwhs.                                                
   320  003190     EXIT.                                                        
   321  003200******************************************************************
   322  003210*    ڒoP                                              *
   323  003220******************************************************************
   324  003230 ڒoP                         SECTION.                  
   325  003240 ڒo|rs`qs.                                        
   326  003241                                                                  
   327  003242     MOVE  SPACE                      TO                          
   328  003243                                      hjnOOP|VR[h
   329  003244     MOVE  SPACE                      TO  hjnOOP|}      
   330  003250*                                                                 
   331  003260*----------------------------------------------------------------*
   332  003270*    VR[hǍ                                          *
   333  003280*----------------------------------------------------------------*
   334  003290      EXEC SQL                                                    
   335  003300         SELECT   VR[h                                  
   336  003310         INTO    :hjnOOP|VR[h                    
   337  003320         FROM    IKOTBL001                                        
   338  003340        WHERE    IKOTBL001.R[h =                         
   339  003360                                    :ksqebj|[U[R[h 
   340  003370          AND    IKOTBL001.ړIbc = '2'                         
   341  003380      END-EXEC.                                                   
   342  003390*----------------------------------------------------------------*
   343  003400*   VR[hmF                                     *
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   344  003410*----------------------------------------------------------------*
   345  003420     EVALUATE   SQLCODE                                           
   346  003430        WHEN   萔|rpknj                                   
   347  003440*--< ̎ >                                                   
   348  003450           CONTINUE                                               
   349  003460        WHEN   OTHER                                              
   350  003470*--< ݂Ȃ >                                                 
   351  003480           MOVE     SPACE             TO                          
   352  003490                                      hjnOOP|VR[h
   353  003520     END-EVALUATE.                                                
   354  003530*----------------------------------------------------------------*
   355  003540*    }ԓǍ                                                    *
   356  003550*----------------------------------------------------------------*
   357  003560      EXEC SQL                                                    
   358  003570         SELECT  }                                             
   359  003580         INTO   :hjnOOP|}                               
   360  003590         FROM   IKOTBL001                                         
   361  003610        WHERE   IKOTBL001.R[h =                          
   362  003630                                     :ksqebj|[U[R[h
   363  003640          AND   IKOTBL001.ړIbc = '2'                          
   364  003650      END-EXEC.                                                   
   365  003660*----------------------------------------------------------------*
   366  003670*   }ԌmF                                               *
   367  003680*----------------------------------------------------------------*
   368  003690     EVALUATE   SQLCODE                                           
   369  003700        WHEN   萔|rpknj                                   
   370  003710*--< ̎ >                                                   
   371  003720           CONTINUE                                               
   372  003730        WHEN   OTHER                                              
   373  003740*--< ݂Ȃ >                                                 
   374  003750           MOVE     SPACE             TO  hjnOOP|}      
   375  003780     END-EVALUATE.                                                
   376  003790  ڒoP|dwhs.                                       
   377  003800     EXIT.                                                        
   378  003810******************************************************************
   379  003820*    ڒoQ                                              *
   380  003830******************************************************************
   381  003840 ڒoQ                         SECTION.                  
   382  003850 ڒo|rs`qs.                                        
   383  003851                                                                  
   384  003852     MOVE  SPACE                      TO                          
   385  003853                                      hjnOOP|VR[h
   386  003854     MOVE  SPACE                      TO  hjnOOP|}      
   387  003855                                                                  
   388  003860*----------------------------------------------------------------*
   389  003870*    VR[hǍ                                          *
   390  003880*----------------------------------------------------------------*
   391  003890      EXEC SQL                                                    
   392  003900         SELECT  VR[h                                   
   393  003910         INTO    :hjnOOP|VR[h                    
   394  003920         FROM    IKOTBL001                                        
   395  003930         WHERE   IKOTBL001.R[h =                         
   396  003950                                       :ksqebj|R[h
   397  003970          AND    IKOTBL001.ړIbc = '3'                         
   398  003980      END-EXEC.                                                   
   399  003990*----------------------------------------------------------------*
   400  004000*    VR[hmF                                    *
   401  004010*----------------------------------------------------------------*
   402  004020     EVALUATE   SQLCODE                                           
   403  004030        WHEN   萔|rpknj                                   
   404  004040*--< ̎ >                                                   
   405  004050           CONTINUE                                               
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   406  004060        WHEN   OTHER                                              
   407  004070*--< ݂Ȃ >                                                 
   408  004080           MOVE     SPACE             TO                          
   409  004090                                      hjnOOP|VR[h
   410  004100     END-EVALUATE.                                                
   411  004130*----------------------------------------------------------------*
   412  004140*    }ԓǍ                                                    *
   413  004150*----------------------------------------------------------------*
   414  004160      EXEC SQL                                                    
   415  004170         SELECT  }                                             
   416  004180         INTO    :hjnOOP|}                              
   417  004190         FROM    IKOTBL001                                        
   418  004200        WHERE    IKOTBL001.R[h =                         
   419  004220                                       :ksqebj|R[h
   420  004240          AND    IKOTBL001.ړIbc = '3'                         
   421  004250      END-EXEC.                                                   
   422  004260*----------------------------------------------------------------*
   423  004270*     }ԌmF                                             *
   424  004280*----------------------------------------------------------------*
   425  004290     EVALUATE   SQLCODE                                           
   426  004300        WHEN   萔|rpknj                                   
   427  004310*--< ̎ >                                                   
   428  004320           CONTINUE                                               
   429  004330        WHEN   OTHER                                              
   430  004340*--< ݂Ȃ >                                                 
   431  004350           MOVE     SPACE             TO   hjnOOP|}     
   432  004380     END-EVALUATE.                                                
   433  004390 ڒoQ|dwhs.                                        
   434  004400     EXIT.                                                        
   435  004410******************************************************************
   436  004420*     ҏWo͏                                               *
   437  004430******************************************************************
   438  004440 ҏWo͏                         SECTION.                    
   439  004450 ҏWo͏|rs`qs.                                        
   440  004460*----------------------------------------------------------------*
   441  004470*                                                      *
   442  004480*----------------------------------------------------------------*
   443  004490        MOVE  SPACE                   TO  _`        
   444  004500        INITIALIZE                        _`        
   445  004510*                                                                 
   446  004520*----------------------------------------------------------------*
   447  004530*       ڕҏW                                             *
   448  004540*----------------------------------------------------------------*
   449  004550*--<    No.01 >                                                   
   450  004560        MOVE  ksqebs|_ԍ  TO  cSPT|_ԍ.     
   451  004570*                                                                 
   452  004580*--<    No.02 >                                                   
   453  004590        MOVE  v|ó|          TO  cSPT|הԍ.     
   454  004600*                                                                 
   455  004610        PERFORM  ڒoP.                                  
   456  004620*--<    No.03 >                                                   
   457  004630        MOVE  hjnOOP|VR[h                        
   458  004640                                      TO  cSPT|R[h. 
   459  004650*                                                                 
   460  004660*--<    No.04 >                                                   
   461  004670        MOVE  hjnOOP|}      TO  cSPT|_R[h. 
   462  004680*                                                                 
   463  004690*--<    No.05 >                                                   
   464  004700        MOVE  ksqebj|zʋz  TO  cSPT|zʋz.     
   465  004710*                                                                 
   466  004720*--<    No.06 >                                                   
   467  004730        MOVE  ksqebj|      TO  cSPT|`.     
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   468  004740*                                                                 
   469  004750*--<    No.07 >                                                   
   470  004760        MOVE  ksqebs|  TO  cSPT|.     
   471  004770*                                                                 
   472  004780*--<    No.08 >                                                   
   473  004790        MOVE  ksqebs|ԓ  TO  cSPT|.         
   474  004800*                                                                 
   475  004810*--<    No.09 >                                                   
   476  004820        MOVE  ksqebs|    TO  cSPT|.       
   477  004830*                                                                 
   478  004840*--<    No.10 >                                                   
   479  004850        MOVE  ksqebs|    TO  cSPT|.       
   480  004860*                                                                 
   481  004870*--<    No.11 >                                                   
   482  004880        MOVE  ksqebs|萔                            
   483  004890                                      TO  cSPT|旧萔. 
   484  004900*                                                                 
   485  004910*--<    No.12 >                                                   
   486  004920        MOVE  ksqebs|萔œz                  
   487  004930                                      TO                          
   488  004940                                   cSPT|旧萔Ŋz.
   489  004950*                                                                 
   490  004960*--<    No.13 >                                                   
   491  004970        MOVE  ksqebs|z  TO  cSPT|z.   
   492  004980*                                                                 
   493  004990*--<    No.14 >                                                   
   494  005000        MOVE  ZERO                    TO  cSPT|Г敪. 
   495  005010*                                                                 
   496  005020*--<    No.15 >                                                   
   497  005030        MOVE  ksqebj|Г  TO  cSPT|Г.     
   498  005040*                                                                 
   499  005050*--<    No.16 >                                                   
   500  005060        MOVE  ZERO                    TO  cSPT|N.     
   501  005070*                                                                 
   502  005080*--<    No.17 >                                                   
   503  005090        MOVE  ksqebj|ev    TO  cSPT|e.         
   504  005100*                                                                 
   505  005110*--<    No.18 >                                                   
   506  005120        MOVE  ksqebs|`ԍ  TO  cSPT|`ԍ.     
   507  005130*                                                                 
   508  005140*--<    No.19 >                                                   
   509  005150        MOVE  ksqebs|`  TO  cSPT|`.     
   510  005160*                                                                 
   511  005170*--<    No.20 >                                                   
   512  005180        MOVE  ksqebs|sR[h(1:4)                   
   513  005190                                      TO cSPT|xsR[h.
   514  005210*--<    No.21 >                                                   
   515  005220        MOVE  ksqebs|sR[h(5:3)                   
   516  005230                                      TO cSPT|xxXR[h.
   517  005250*                                                                 
   518  005260        PERFORM  ڒoQ.                                  
   519  005270*--<    No.22 >                                                   
   520  005280        MOVE  hjnOOP|VR[h                        
   521  005290                                      TO                          
   522  005300                                       cSPT|R[h.
   523  005310*                                                                 
   524  005320*--<    No.23 >                                                   
   525  005330        MOVE  hjnOOP|}      TO  cSPT|R[h. 
   526  005340*                                                                 
   527  005350*--<    No.24 >                                                   
   528  005360        MOVE  ksqebj|Г  TO                          
   529  005370                                         cSPT|Г|.
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   530  005380*                                                                 
   531  005390*--<    No.25 >                                                   
   532  005400        MOVE  ksqebj|ev    TO  cSPT|e|.   
   533  005410*                                                                 
   534  005420*--<    No.26 >                                                   
   535  005430        MOVE  ZERO                    TO  cSPT|.     
   536  005440*                                                                 
   537  005450*--<    No.27 >                                                   
   538  005460        MOVE  ZERO                    TO                          
   539  005470                                       cSPT|敪.
   540  005480*                                                                 
   541  005490*--<    No.28 >                                                   
   542  005500        MOVE  ksqebs|Oٓ                          
   543  005510                                      TO  cSPT|Oٓ. 
   544  005520*                                                                 
   545  005530*--<    No.29 >                                                   
   546  005540        MOVE  v|VXet        TO  cSPT|XVN.   
   547  005550*                                                                 
   548  005560*--<    No.30 >                                                   
   549  005570        MOVE  v|VXe        TO  cSPT|XV.     
   550  005580*                                                                 
   551  005590*--<    No.31 >                                                   
   552  005600        MOVE  v|S              TO  cSPT|XV.       
   553  005610*                                                                 
   554  005620*--<    No.32 >                                                   
   555  005630        MOVE  v|S              TO                          
   556  005640                                      cSPT|͒S҃R[h. 
   557  005650*                                                                 
   558  005660*--<    No.33 >                                                   
   559  005670        MOVE  v|VXet        TO  cSPT|o^N.   
   560  005680*                                                                 
   561  005690*--<    No.34 >                                                   
   562  005700        MOVE  v|VXe        TO  cSPT|o^.     
   563  005710*                                                                 
   564  005720*--<    No.35 >                                                   
   565  005730        MOVE  v|S              TO  cSPT|o^S.   
   566  005740*                                                                 
   567  005750 ҏWo͏|dwhs.                                          
   568  005760     EXIT.                                                        
   569  005770******************************************************************
   570  005780*    o͏                                                    *
   571  005790******************************************************************
   572  005800 o͏                             SECTION.                    
   573  005810 o͏|rs`qs.                                            
   574  005820*                                                                 
   575  005830       EXEC  SQL                                                  
   576  005840         INSERT  INTO  D415UTM_TBL                                
   577  005850           ( _ԍ                                             
   578  005860            ,הԍ                                             
   579  005870            ,R[h                                         
   580  005880            ,_R[h                                         
   581  005890            ,zʋz                                             
   582  005900            ,`                                             
   583  005910            ,                                             
   584  005920            ,                                                 
   585  005930            ,                                               
   586  005940            ,                                               
   587  005950            ,旧萔                                         
   588  005960            ,旧萔Ŋz                                 
   589  005970            ,z                                           
   590  005980            ,Г敪                                         
   591  005990            ,Г                                             
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   592  006000            ,N                                             
   593  006010            ,e                                                 
   594  006020            ,`ԍ                                             
   595  006030            ,`                                             
   596  006040            ,xsR[h                                       
   597  006050            ,xxXR[h                                       
   598  006060            ,R[h                                     
   599  006070            ,R[h                                         
   600  006080            ,Г_                                        
   601  006090            ,e_                                            
   602  006091            ,Oٓ                                         
   603  006100            ,                                             
   604  006110            ,敪                                     
   605  006130            ,XVN                                           
   606  006140            ,XV                                             
   607  006150            ,XV                                               
   608  006160            ,͒S҃R[h                                     
   609  006170            ,o^N                                           
   610  006180            ,o^                                             
   611  006190            ,o^S)                                          
   612  006200       VALUES                                                     
   613  006210           ( :cSPT|_ԍ                                  
   614  006220            ,:cSPT|הԍ                                  
   615  006230            ,:cSPT|R[h                              
   616  006240            ,:cSPT|_R[h                              
   617  006250            ,:cSPT|zʋz                                  
   618  006260            ,:cSPT|`                                  
   619  006270            ,:cSPT|                                  
   620  006280            ,:cSPT|                                      
   621  006290            ,:cSPT|                                    
   622  006300            ,:cSPT|                                    
   623  006310            ,:cSPT|旧萔                              
   624  006320            ,:cSPT|旧萔Ŋz                      
   625  006330            ,:cSPT|z                                
   626  006340            ,:cSPT|Г敪                              
   627  006350            ,:cSPT|Г                                  
   628  006360            ,:cSPT|N                                  
   629  006370            ,:cSPT|e                                      
   630  006380            ,:cSPT|`ԍ                                  
   631  006390            ,:cSPT|`                                  
   632  006400            ,:cSPT|xsR[h                            
   633  006410            ,:cSPT|xxXR[h                            
   634  006420            ,:cSPT|R[h                          
   635  006430            ,:cSPT|R[h                              
   636  006440            ,:cSPT|Г|                            
   637  006450            ,:cSPT|e|                                
   638  006451            ,:cSPT|Oٓ                              
   639  006460            ,:cSPT|                                  
   640  006470            ,:cSPT|敪                          
   641  006490            ,:cSPT|XVN                                
   642  006500            ,:cSPT|XV                                  
   643  006510            ,:cSPT|XV                                    
   644  006520            ,:cSPT|͒S҃R[h                          
   645  006530            ,:cSPT|o^N                                
   646  006540            ,:cSPT|o^                                  
   647  006550            ,:cSPT|o^S)                               
   648  006560                                                                  
   649  006570     END-EXEC.                                                    
   650  006580*                                                                 
   651  006590*----------------------------------------------------------------*
   652  006600*    ǉmF                                              *
   653  006610*----------------------------------------------------------------*
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   654  006620     EVALUATE  SQLCODE                                            
   655  006630        WHEN   萔|rpknj                                   
   656  006640*--<       ǉ >                                             
   657  006650           COMPUTE  v|ó|  =  v|ó|  +  1       
   658  006660        WHEN   OTHER                                              
   659  006670*--<       ǉG[ >                                       
   660  006680           MOVE     -50               TO  v|G[R[h        
   661  006690           PERFORM  G[                                    
   662  006700     END-EVALUATE.                                                
   663  006710*                                                                 
   664  006720 o͏|dwhs.                                              
   665  006730     EXIT.                                                        
   666  006740******************************************************************
   667  006750*    I                                                    *
   668  006760******************************************************************
   669  006770 I                             SECTION.                    
   670  006780 I|rs`qs.                                            
   671  006790*                                                                 
   672  006800     PERFORM  caN[Y.                                   
   673  006810*                                                                 
   674  006820     PERFORM  caR~bg.                                   
   675  006830*                                                                 
   676  006840     PERFORM  IbZ[Wo.                                 
   677  006850*                                                                 
   678  006860*--< vOI >                                         
   679  006870     MOVE  萔|             TO  PROGRAM-STATUS.         
   680  006880*                                                                 
   681  006890 I|dwhs.                                              
   682  006900     EXIT.                                                        
   683  006910******************************************************************
   684  006920*    IbZ[Wo                                          *
   685  006930******************************************************************
   686  006940 IbZ[Wo                   SECTION.                    
   687  006950 IbZ[Wó|rs`qs.                                  
   688  006960*                                                                 
   689  006970*----------------------------------------------------------------*
   690  006980*    bZ[Wo͏                                      *
   691  006990*----------------------------------------------------------------*
   692  007000     INITIALIZE                       IF-CHOCO001.                
   693  007010     MOVE  "3"                        TO  P|Cxg.     
   694  007020     MOVE  萔|vOhc       TO  P|\[Xhc.       
   695  007030     MOVE  "0"                        TO  P|AR[h.       
   696  007040     MOVE  "LTRFCT"                   TO  P|e[uhc. 
   697  007050     MOVE  "COUNT"                    TO  P|.         
   698  007060     MOVE  v|́|P           TO  P|f[^e.       
   699  007070     MOVE  "SUMMIŢݸގ`Ǎ"                       
   700  007080                                      TO  P|̑bZ[W. 
   701  007090     CALL  CLOCO001                USING  IF-CHOCO001.            
   702  007100*                                                                 
   703  007110     INITIALIZE                       IF-CHOCO001.                 
   704  007120     MOVE  "3"                        TO  P|Cxg.     
   705  007130     MOVE  萔|vOhc       TO  P|\[Xhc.       
   706  007140     MOVE  "0"                        TO  P|AR[h.       
   707  007150     MOVE  "LTRFCK"                   TO  P|e[uhc. 
   708  007160     MOVE  "COUNT"                    TO  P|.         
   709  007170     MOVE  v|́|Q           TO  P|f[^e.       
   710  007180     MOVE  "SUMMIŢݸފ{Ǎ"                       
   711  007190                                      TO  P|̑bZ[W. 
   712  007200     CALL  CLOCO001                USING  IF-CHOCO001.            
   713  007210*                                                                 
   714  007220     INITIALIZE                       IF-CHOCO001.                
   715  007230     MOVE  "3"                        TO  P|Cxg.     
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   716  007240     MOVE  萔|vOhc       TO  P|\[Xhc.       
   717  007250     MOVE  "0"                        TO  P|AR[h.       
   718  007260     MOVE  "D415UTM"                  TO  P|e[uhc. 
   719  007270     MOVE  "COUNT"                    TO  P|.         
   720  007280     MOVE  v|ó|             TO  P|f[^e.       
   721  007290     MOVE  "_`דo^"                             
   722  007300                                      TO  P|̑bZ[W. 
   723  007310     CALL  CLOCO001                USING  IF-CHOCO001.            
   724  007320*                                                                 
   725  007330*----------------------------------------------------------------*
   726  007340*    IbZ[Wo                                          *
   727  007350*----------------------------------------------------------------*
   728  007360     INITIALIZE                       IF-CHOCO001.                
   729  007370     MOVE  "3"                        TO  P|Cxg.     
   730  007380     MOVE  萔|vOhc       TO  P|\[Xhc.       
   731  007390     MOVE  "0"                        TO  P|AR[h.       
   732  007400     MOVE  "END"                      TO  P|.         
   733  007410     MOVE  萔|vO         TO  P|̑bZ[W. 
   734  007420     CALL  CLOCO001                USING  IF-CHOCO001.            
   735  007430*                                                                 
   736  007440 IbZ[Wó|dwhs.                                    
   737  007450     EXIT.                                                        
   738  007460******************************************************************
   739  007470*    caN[Y                                                *
   740  007480******************************************************************
   741  007490 caN[Y                     SECTION.                    
   742  007500 caN[Y|rs`qs.                                    
   743  007510*                                                                 
   744  007520*--< J[\ N[Y >                                          
   745  007530     EXEC SQL                                                     
   746  007540        CLOSE  CUR1                                               
   747  007550     END-EXEC.                                                    
   748  007560*                                                                 
   749  007570 caN[Y|dwhs.                                      
   750  007580     EXIT.                                                        
   751  007590******************************************************************
   752  007600*    caR~bg                                            *
   753  007610******************************************************************
   754  007620 caR~bg                     SECTION.                    
   755  007630 caR~bg|rs`qs.                                    
   756  007640*                                                                 
   757  007650     EXEC  SQL                                                    
   758  007660        COMMIT  WORK  RELEASE                                     
   759  007670     END-EXEC.                                                    
   760  007680*                                                                 
   761  007690     INITIALIZE                       IF-CHOCO001.                
   762  007700     MOVE  "3"                        TO  P|Cxg.     
   763  007710     MOVE  萔|vOhc       TO  P|\[Xhc.       
   764  007720     MOVE  "0"                        TO  P|AR[h.       
   765  007730     MOVE  "COMMIT"                   TO  P|.         
   766  007740     MOVE  "R~bg{"             TO  P|̑bZ[W. 
   767  007750     CALL  CLOCO001                USING  IF-CHOCO001.            
   768  007760*                                                                 
   769  007770 caR~bg|dwhs.                                      
   770  007780     EXIT.                                                        
   771  007790******************************************************************
   772  007800*    ca[obN                                        *
   773  007810******************************************************************
   774  007820 ca[obN                 SECTION.                    
   775  007830 ca[obN|rs`qs.                                
   776  007840*                                                                 
   777  007850     EXEC  SQL                                                    
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   778  007860        ROLLBACK WORK  RELEASE                                    
   779  007870     END-EXEC.                                                    
   780  007880*                                                                 
   781  007890     INITIALIZE                       IF-CHOCO001.                
   782  007900     MOVE  "1"                        TO  P|Cxg.     
   783  007910     MOVE  萔|vOhc       TO  P|\[Xhc.       
   784  007920     MOVE  "9"                        TO  P|AR[h.       
   785  007930     MOVE  "ROLLBACK"                 TO  P|.         
   786  007940     MOVE  "[obN{"         TO  P|̑bZ[W. 
   787  007950     CALL  CLOCO001                USING  IF-CHOCO001.            
   788  007960*                                                                 
   789  007970 ca[obN|dwhs.                                  
   790  007980     EXIT.                                                        
   791  007990******************************************************************
   792  008000*    G[                                                  *
   793  008010******************************************************************
   794  008020 G[                       SECTION.                        
   795  008030 G[|rs`qs.                                          
   796  008040*                                                                 
   797  008050     MOVE  "Y"                        TO v|ُI|tO.    
   798  008060     INITIALIZE                           IF-CHOCO001.            
   799  008070*                                                                 
   800  008080     EVALUATE  v|G[R[h                                   
   801  008090        WHEN  -10                                                 
   802  008100*--<       nq`bkdڑs >                                 
   803  008110           MOVE  "1"                  TO  P|Cxg      
   804  008120           MOVE  萔|vOhc TO  P|\[Xhc        
   805  008130           MOVE  "9"                  TO  P|AR[h        
   806  008140           MOVE  "CONNECT"            TO  P|          
   807  008150           MOVE  SQLCODE              TO  P|f[^e        
   808  008160           MOVE  SQLERRMC             TO  P|̑bZ[W  
   809  008170           CALL  CLOCO001          USING  IF-CHOCO001             
   810  008180*                                                                 
   811  008190        WHEN  -20                                                 
   812  008200*--<       e[uJ[\I[vs >                     
   813  008210           MOVE  "1"                  TO  P|Cxg      
   814  008220           MOVE  萔|vOhc TO  P|\[Xhc        
   815  008230           MOVE  "9"                  TO  P|AR[h        
   816  008240           MOVE  "LTRFCT"             TO  P|e[uhc  
   817  008250           MOVE  "OPEN"               TO  P|          
   818  008260           MOVE  SQLCODE              TO  P|f[^e        
   819  008270           MOVE  SQLERRMC             TO  P|̑bZ[W  
   820  008280           CALL  CLOCO001          USING  IF-CHOCO001             
   821  008290*                                                                 
   822  008300        WHEN  -30                                                 
   823  008310*--<       e[uǍs >                                 
   824  008320           MOVE  "1"                  TO  P|Cxg      
   825  008330           MOVE  萔|vOhc TO  P|\[Xhc        
   826  008340           MOVE  "9"                  TO  P|AR[h        
   827  008350           MOVE  "LTRFCT"             TO  P|e[uhc  
   828  008360           MOVE  "FETCH"              TO  P|          
   829  008370           MOVE  SQLCODE              TO  P|f[^e        
   830  008380           MOVE  SQLERRMC             TO  P|̑bZ[W  
   831  008390           CALL  CLOCO001          USING  IF-CHOCO001             
   832  008400*                                                                 
   833  008410        WHEN  -40                                                 
   834  008420*--<      ڒoG[ >                                    
   835  008430           MOVE  "2"                  TO  P|Cxg      
   836  008440           MOVE  萔|vOhc TO  P|\[Xhc        
   837  008450           MOVE  "9"                  TO  P|AR[h        
   838  008460           MOVE  "IKOTBL001"          TO  P|e[uhc  
   839  008470           MOVE  "SELECT"             TO  P|          
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   840  008480           MOVE  SQLCODE              TO  P|f[^e        
   841  008490           MOVE  SQLERRMC             TO  P|̑bZ[W  
   842  008500           CALL  CLOCO001          USING  IF-CHOCO001             
   843  008510           MOVE  "N"                  TO  v|ُI|tO      
   844  008520        WHEN  -50                                                 
   845  008530*--<       _`ׂcaǉs >                         
   846  008540           MOVE  "1"                  TO  P|Cxg      
   847  008550           MOVE  萔|vOhc TO  P|\[Xhc        
   848  008560           MOVE  "9"                  TO  P|AR[h        
   849  008570           MOVE  "D415UTM"            TO  P|e[uhc  
   850  008580           MOVE  "INSERT"             TO  P|          
   851  008590           MOVE  SQLCODE              TO  P|f[^e        
   852  008600           MOVE  SQLERRMC             TO  P|̑bZ[W  
   853  008610           CALL  CLOCO001          USING  IF-CHOCO001             
   854  008620*                                                                 
   855  008630        WHEN  OTHER                                               
   856  008640           MOVE  "N"                  TO v|ُI|tO     
   857  008650     END-EVALUATE.                                                
   858  008660*                                                                 
   859  008670     IF v|ُI|tO  =  "Y"                              
   860  008680        PERFORM  ca[obN                             
   861  008690*                                                                 
   862  008700        PERFORM  IbZ[Wo                               
   863  008710*                                                                 
   864  008720*--<    vOُĨ^[R[h >                      
   865  008730        MOVE  萔|ُ          TO  PROGRAM-STATUS          
   866  008740*                                                                 
   867  008750        EXIT  PROGRAM                                             
   868  008760     END-IF.                                                      
   869  008770*                                                                 
   870  008780 G[|dwhs.                                            
   871  008790     EXIT.                                                        
   872  008800******************************************************************
   873  008810*                  END OF PROGRAM                                *
   874  008820******************************************************************
t@C: C:\COB97\SOC\COBIS500\COBIS500.PCON[Y
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


zXgϐ
--------------

01  DB-STRING                                           Charf(20)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      3
  C:\COB97\SOC\COBIS500\COBIS500.PCO    184

01  PASSWD                                              Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      5
  C:\COB97\SOC\COBIS500\COBIS500.PCO    179    183

01  SQLSTATE                                            Charf(5)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      2
  C:\COB97\SOC\COBIS500\COBIS500.PCO    178    182    240    266    334    357    391    414    575    745    757    777

01  USERNAME                                            Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      4
  C:\COB97\SOC\COBIS500\COBIS500.PCO    179    183

03  cSPT|zʋz OF _`              Decimal(13,0)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     11
  C:\COB97\SOC\COBIS500\COBIS500.PCO    617

03  cSPT| OF _`                Decimal(10,8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     15
  C:\COB97\SOC\COBIS500\COBIS500.PCO    621

03  cSPT| OF _`                Decimal(13,0)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     16
  C:\COB97\SOC\COBIS500\COBIS500.PCO    622

03  cSPT|Oٓ OF _`            Charf(8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     40
  C:\COB97\SOC\COBIS500\COBIS500.PCO    638

03  cSPT|_R[h OF _`            Charf(5)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL      9
  C:\COB97\SOC\COBIS500\COBIS500.PCO    616

03  cSPT|_ԍ OF _`              Charf(10)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL      5
  C:\COB97\SOC\COBIS500\COBIS500.PCO    613

03  cSPT|XV OF _`              Charf(8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     46
  C:\COB97\SOC\COBIS500\COBIS500.PCO    642

03  cSPT|XV OF _`                Charf(8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     47
  C:\COB97\SOC\COBIS500\COBIS500.PCO    643

03  cSPT|XVN OF _`            Charf(8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     45
  C:\COB97\SOC\COBIS500\COBIS500.PCO    641

03  cSPT|敪 OF _`            Charf(1)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     43
  C:\COB97\SOC\COBIS500\COBIS500.PCO    640

03  cSPT|xsR[h OF _`            Charf(4)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     29
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  C:\COB97\SOC\COBIS500\COBIS500.PCO    632

03  cSPT|xxXR[h OF _`            Charf(3)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     31
  C:\COB97\SOC\COBIS500\COBIS500.PCO    633

03  cSPT|N OF _`              Decimal(10,8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     25
  C:\COB97\SOC\COBIS500\COBIS500.PCO    628

03  cSPT|Г OF _`              Decimal(10,8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     24
  C:\COB97\SOC\COBIS500\COBIS500.PCO    627

03  cSPT|Г| OF _`            Decimal(10,8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     37
  C:\COB97\SOC\COBIS500\COBIS500.PCO    636

03  cSPT|Г敪 OF _`            Charf(1)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     22
  C:\COB97\SOC\COBIS500\COBIS500.PCO    626

03  cSPT|R[h OF _`            Charf(9)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL      7
  C:\COB97\SOC\COBIS500\COBIS500.PCO    615

03  cSPT|旧萔 OF _`            Decimal(13,0)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     17
  C:\COB97\SOC\COBIS500\COBIS500.PCO    623

03  cSPT|旧萔Ŋz OF _            Decimal(13,0)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     19
  C:\COB97\SOC\COBIS500\COBIS500.PCO    624

03  cSPT|` OF _`              Charf(8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     12
  C:\COB97\SOC\COBIS500\COBIS500.PCO    618

03  cSPT|` OF _`              Charf(1)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     28
  C:\COB97\SOC\COBIS500\COBIS500.PCO    631

03  cSPT|`ԍ OF _`              Charf(10)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     27
  C:\COB97\SOC\COBIS500\COBIS500.PCO    630

03  cSPT|R[h OF _`            Charf(9)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     33
  C:\COB97\SOC\COBIS500\COBIS500.PCO    634

03  cSPT|R[h OF _`            Charf(5)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     35
  C:\COB97\SOC\COBIS500\COBIS500.PCO    635

03  cSPT|e OF _`                  Decimal(13,0)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     26
  C:\COB97\SOC\COBIS500\COBIS500.PCO    629

03  cSPT|e| OF _`            Decimal(13,0)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     39
  C:\COB97\SOC\COBIS500\COBIS500.PCO    637

Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

03  cSPT|o^ OF _`              Charf(8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     51
  C:\COB97\SOC\COBIS500\COBIS500.PCO    646

03  cSPT|o^S OF _`            Charf(8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     52
  C:\COB97\SOC\COBIS500\COBIS500.PCO    647

03  cSPT|o^N OF _`            Charf(8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     50
  C:\COB97\SOC\COBIS500\COBIS500.PCO    645

03  cSPT| OF _`                  Decimal(3,0)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     14
  C:\COB97\SOC\COBIS500\COBIS500.PCO    620

03  cSPT|͒S҃R[h OF _`            Charf(8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     48
  C:\COB97\SOC\COBIS500\COBIS500.PCO    644

03  cSPT|z OF _`            Decimal(13,0)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     21
  C:\COB97\SOC\COBIS500\COBIS500.PCO    625

03  cSPT|הԍ OF _`              Decimal(3,0)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL      6
  C:\COB97\SOC\COBIS500\COBIS500.PCO    614

03  cSPT| OF _`              Charf(8)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     13
  C:\COB97\SOC\COBIS500\COBIS500.PCO    619

03  cSPT| OF _`              Charf(10)
  Z:\COB97\COPYLIB_DB\D415UTM.CBL     42
  C:\COB97\SOC\COBIS500\COBIS500.PCO    639

01  hjnOOP|}                                  Charf(3)
  Z:\COB97\COPYLIB_DB\IKOTBL001.CBL      7
  C:\COB97\SOC\COBIS500\COBIS500.PCO    359    416

01  hjnOOP|VR[h                        Charf(7)
  Z:\COB97\COPYLIB_DB\IKOTBL001.CBL      6
  C:\COB97\SOC\COBIS500\COBIS500.PCO    336    393

01  ksqebj|[U[R[h                        Charf(8)
  Z:\COB97\COPYLIB_DB\LTRFCK.CBL      5
  C:\COB97\SOC\COBIS500\COBIS500.PCO    269    339    362

01  ksqebj|zʋz                              Decimal(13,0)
  Z:\COB97\COPYLIB_DB\LTRFCK.CBL     15
  C:\COB97\SOC\COBIS500\COBIS500.PCO    270

01  ksqebj|                                  Charf(7)
  Z:\COB97\COPYLIB_DB\LTRFCK.CBL     17
  C:\COB97\SOC\COBIS500\COBIS500.PCO    271

01  ksqebj|Г                              Decimal(11,8)
  Z:\COB97\COPYLIB_DB\LTRFCK.CBL     12
  C:\COB97\SOC\COBIS500\COBIS500.PCO    279

01  ksqebj|R[h                          Charf(8)
  Z:\COB97\COPYLIB_DB\LTRFCK.CBL      6
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  C:\COB97\SOC\COBIS500\COBIS500.PCO    284    396    419

01  ksqebj|ev                                Decimal(13,0)
  Z:\COB97\COPYLIB_DB\LTRFCK.CBL     14
  C:\COB97\SOC\COBIS500\COBIS500.PCO    280

01  ksqebs|                                Decimal(11,8)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL     11
  C:\COB97\SOC\COBIS500\COBIS500.PCO    274

01  ksqebs|                                Decimal(13,0)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL     10
  C:\COB97\SOC\COBIS500\COBIS500.PCO    275

01  ksqebs|ԓ                              Decimal(4,0)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL      8
  C:\COB97\SOC\COBIS500\COBIS500.PCO    273

01  ksqebs|Oٓ                          Charf(7)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL     17
  C:\COB97\SOC\COBIS500\COBIS500.PCO    285

01  ksqebs|_ԍ                              Charf(9)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL      4
  C:\COB97\SOC\COBIS500\COBIS500.PCO    268

01  ksqebs|sR[h                        Charf(7)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL     28
  C:\COB97\SOC\COBIS500\COBIS500.PCO    283

01  ksqebs|`                              Decimal(1,0)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL     26
  C:\COB97\SOC\COBIS500\COBIS500.PCO    282

01  ksqebs|`ԍ                              Charf(10)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL     25
  C:\COB97\SOC\COBIS500\COBIS500.PCO    281

01  ksqebs|萔                            Decimal(13,0)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL     12
  C:\COB97\SOC\COBIS500\COBIS500.PCO    276

01  ksqebs|萔œz                  Decimal(13,0)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL     13
  C:\COB97\SOC\COBIS500\COBIS500.PCO    277

01  ksqebs|z                              Decimal(13,0)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL      9
  C:\COB97\SOC\COBIS500\COBIS500.PCO    278

01  ksqebs|                              Charf(7)
  Z:\COB97\COPYLIB_DB\LTRFCT.CBL      5
  C:\COB97\SOC\COBIS500\COBIS500.PCO    272

Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


SQLʎq
---------------

CUR1                  CURSOR                        
  C:\COB97\SOC\COBIS500\COBIS500.PCO    213    241    267    746    213

Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.



                              vRpCEIvV
-------------------------------------------------------------------------------
IvV   ݂̐ݒl         ݒ
-------------------------------------------------------------------------------
asacc             no                ftHg                                  
assume_sqlcode    no                ftHg                                  
auto_connect      no                ftHg                                  
close_on_commit   yes               mode                                        
comp5             yes               D:\oracle\precomp\admin\pcbcfg.cfg          
config            default config    ftHg                                  
date_format       local             ftHg                                  
dbms              native            ftHg                                  
declare_section   yes               mode                                        
define            *Ȃ*            ftHg                                  
dynamic           ansi              mode                                        
end_of_fetch      100               mode                                        
eol_padding       yes               ftHg                                  
errors            yes               ftHg                                  
fips              no                ftHg                                  
format            ansi              ftHg                                  
hold_cursor       no                ftHg                                  
host              cobol             ftHg                                  
iname             C:\COB97\SOC\COBISR}hCCO                            
include           Z:\COB97\COPYLIB  D:\oracle\precomp\admin\pcbcfg.cfg          
                  Z:\COB97\COPYLIB_DD:\oracle\precomp\admin\pcbcfg.cfg          
                  *Ȃ*            D:\oracle\precomp\admin\pcbcfg.cfg          
ireclen           132               D:\oracle\precomp\admin\pcbcfg.cfg          
litdelim          quote             ftHg                                  
lname             *Ȃ*            ftHg                                  
lreclen           132               ftHg                                  
ltype             long              ftHg                                  
maxliteral        160               D:\oracle\precomp\admin\pcbcfg.cfg          
maxopencursors    10                ftHg                                  
mode              ANSI              D:\oracle\precomp\admin\pcbcfg.cfg          
nested            yes               ftHg                                  
nls_local         yes               D:\oracle\precomp\admin\pcbcfg.cfg          
oname             COBIS500.COB      R}hC                              
oraca             no                ftHg                                  
oreclen           80                ftHg                                  
pagelen           66                ftHg                                  
picx              charf             ftHg                                  
prefetch          1                 ftHg                                  
release_cursor    no                ftHg                                  
select_error      yes               ftHg                                  
sqlcheck          FULL              D:\oracle\precomp\admin\pcbcfg.cfg          
threads           no                ftHg                                  
type_code         ansi              mode                                        
unsafe_null       no                ftHg                                  
userid            WANGHL/WHL@FIP    D:\oracle\precomp\admin\pcbcfg.cfg          
varchar           no                ftHg                                  
xref              yes               ftHg                                  
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 7 09:35:12 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


v\
----------

^[ER[h: 0
dv Ił̃bZ[W: 0
dv Wł̃bZ[W: 0
dv Eł̃bZ[W: 0
dv Fł̃bZ[W: 0
̓C̐: 1016
錾ꂽzXgϐ̐: 115
J[\̐: 1
̐: 0
gpő僁[(oCg): 220458
