000010******************************************************************
000020*         ⃊[X                                         *
000030*      1. vO  : ϑڍs                         *
000040*      2. vOID  : COBIS430                               *
000050*      3. Tv      : ڍsixAbvj̍WJA *
000060*                         ϑca쐬B                 *
000070*                                                                *
000080*      4. 쐬        : C嗘                                 *
000090*      5. 쐬        : 2004.10.10                             *
000100******************************************************************
000110*                                                                 
000120******************************************************************
000130*    hcdmshehb`shnm  chuhrhnm              *
000140******************************************************************
000150 IDENTIFICATION                       DIVISION.                   
000160*                                                                 
000170 PROGRAM-ID.                          COBIS430.                   
000180******************************************************************
000190*    dmuhqnmldms        chuhrhnm              *
000200******************************************************************
000210 ENVIRONMENT                          DIVISION.                   
000220******************************************************************
000230*    c`s`                      chuhrhnm              *
000240******************************************************************
000250 DATA                                 DIVISION.                   
000260******************************************************************
000270*  vnqjhmf|rsnq`fd  rdbshnm                *
000280******************************************************************
000290  WORKING-STORAGE                     SECTION.                    
000300*----------------------------------------------------------------*
000310*    zXgϐ`GA                                        *
000320*----------------------------------------------------------------*
000330     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +12.
           02  SQLFPN-FILENAME PIC X(12) VALUE "COBIS430.PCO".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(159) VALUE "insert into D34HNS_TBL(_ԍ,
      -     "ă[X,_,Jn,JnN,I,IN,z,
      -     ",XVN,XV,XV,͒S҃R[h,o^N
      -    ",o^".

           02  FILLER PIC X(94) VALUE ",o^S) values (:b1,:b2,:b
      -    "3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,:b16
      -    ")".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +287845.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +16.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 16 TIMES.


       01  SQ0001 GLOBAL.
           02  FILLER PIC X(160) VALUE "select D411STK_TBL._ԍ  ,D4
      -    "11STK_TBL.ă[X  ,D411STK_TBL._  ,D411STK_TBL.
      -    "z  ,D411STK_TBL.  ,D411STK_TBL.N  ,D41
      -    "1STK_TBL".

           02  FILLER PIC X(160) VALUE ".A   from D32SAK_TBL ,D411STK
      -    "_TBL where (((D32SAK_TBL.ϑ='1' and D32SAK_TBL._ԍ=
      -    "D411STK_TBL._ԍ) and D32SAK_TBL.ă[X=D411STK_TB
      -    "L.ă[".

           02  FILLER PIC X(159) VALUE "X) and D32SAK_TBL._=
      -    "D411STK_TBL._) order by D411STK_TBL._ԍ,D411STK_
      -    "TBL.ă[X,D411STK_TBL._,D411STK_TBL.z    
      -    "       ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +199.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +203.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +479.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +257.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +82.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +283.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +125.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +253.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +422.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +204.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +544.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +219.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +12.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +556.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +234.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +14.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +32.
           02     FILLER PIC S9(4) COMP-5 VALUE +576.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000340*                                                                 
000350*--< nq`bkdʕϐ >                                       
000360     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
000370*                                                                 
000380*--< nq`bkd  rpks >                               
000010*--rpkʕϐ
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000390     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000400*                                                                 
000410*--< ڍs_WJ >                                            
000420     
      *    EXEC  SQL  INCLUDE  D411STK.CBL           END-EXEC.
000430*                                                                 
000440*--< ڍs_ >                                                
      *****************************************************************
      *   WJ(D411STK_TBL)
      *****************************************************************
       01  WJ.
           03  cSPP|_ԍ    PIC  X(010).
           03  cSPP|ă[X
                                     PIC S9(002) PACKED-DECIMAL.
           03  cSPP|_    PIC  X(003).
           03  cSPP|A        PIC S9(003) PACKED-DECIMAL.
           03  cSPP|ŗ    PIC S9(002)V9(008) PACKED-DECIMAL.
           03  cSPP|ŗ敪
                                     PIC  X(002).
           03  cSPP|N    PIC  X(006).
           03  cSPP|z      PIC S9(013) PACKED-DECIMAL.
           03  cSPP|  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ŕ␳z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|R[h
                                     PIC  X(009).
           03  cSPP|R[h
                                     PIC  X(005).
           03  cSPP|N  PIC  X(008).
           03  cSPP|z      PIC S9(013) PACKED-DECIMAL.
           03  cSPP|  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ŕ␳z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|\  PIC  X(008).
           03  cSPP|N  PIC  X(008).
           03  cSPP|z      PIC S9(013) PACKED-DECIMAL.
           03  cSPP|z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|sσtO
                                     PIC  X(001).
           03  cSPP|XVN  PIC  X(008).
           03  cSPP|XV    PIC  X(008).
           03  cSPP|XV      PIC  X(008).
           03  cSPP|s
                                     PIC  X(008).
           03  cSPP|ԍ  PIC S9(007) PACKED-DECIMAL.
           03  cSPP|z    PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ϑێ敪
                                     PIC  X(001).
           03  cSPP|ϑێ痿  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ϑێ
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|_ԍ
                                     PIC  X(015).
           03  cSPP|@    PIC  X(001).
           03  cSPP|͒S҃R[h
                                     PIC  X(008).
           03  cSPP|`tO
                                     PIC  X(001).
           03  cSPP|Љz  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Љz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Аz  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|А
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|R[h
                                     PIC  X(003).
           03  cSPP|R[h
                                     PIC  X(003).
           03  cSPP|ʔ    PIC  X(011).
           03  cSPP|A    PIC S9(002) PACKED-DECIMAL.
           03  cSPP|c  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|c
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|c  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|c
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Аc
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Аc
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|{    PIC S9(013) PACKED-DECIMAL.
           03  cSPP|    PIC S9(013) PACKED-DECIMAL.
           03  cSPP|{c
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|{z  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|z  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ЌŒ莑Y
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Гی
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Јϑێ痿
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Д㌳{
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Д㗘
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Д㌳{c
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|vWJ
                                     PIC S9(002)V9(008) PACKED-DECIMAL.
           03  cSPP|Д㌳{
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ЕxKp
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Еx
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|        PIC S9(002)V9(008) PACKED-DECIMAL.
           03  cSPP|ԍϔN  PIC  X(008).
           03  cSPP|Ԍ    PIC S9(003) PACKED-DECIMAL.
           03  cSPP|ԓ    PIC S9(003) PACKED-DECIMAL.
           03  cSPP|vZJn
                                     PIC  X(008).
           03  cSPP|vZI
                                     PIC  X(008).
           03  cSPP|Љz  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Љ
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|o^N  PIC  X(008).
           03  cSPP|o^    PIC  X(008).
           03  cSPP|o^S  PIC  X(008).
           03  cSPP|  PIC  X(008).
           03  cSPP|O[敪
                                     PIC  X(001).
           03  cSPP|      PIC S9(003) PACKED-DECIMAL.
           03  cSPP|N  PIC  X(008).
           03  cSPP|Аz  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Аz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Ђ̑p
                                     PIC S9(013) PACKED-DECIMAL.
000450     
      *    EXEC  SQL  INCLUDE  D32SAK.CBL            END-EXEC.
000460*                                                                 
000470*--< ϑca>                                                  
      *****************************************************************
      *    (D32SAK_TBL)
      *****************************************************************
       01  .
           03  cRQ|_ԍ      PIC  X(010).
           03  cRQ|ă[X  PIC S9(002) PACKED-DECIMAL.
           03  cRQ|_      PIC  X(003).
           03  cRQ|_񌏖      PIC  X(040).
           03  cRQ|      PIC  X(060).
           03  cRQ|ϑ        PIC  X(001).
           03  cRQ|z  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŋ敪
                                     PIC  X(002).
           03  cRQ|Ŋz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|_񑍊z  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|őz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVŋ敪
                                     PIC  X(002).
           03  cRQ|ŐVŊz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐV_񑍊z  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVőz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ێ疳  PIC S9(003) PACKED-DECIMAL.
           03  cRQ|ԃtO    PIC  X(001).
           03  cRQ|tO    PIC  X(001).
           03  cRQ|N    PIC  X(008).
           03  cRQ|敪      PIC  X(001).
           03  cRQ|񗝗R      PIC  X(002).
           03  cRQ|      PIC S9(002) PACKED-DECIMAL.
           03  cRQ|ŐV
                                     PIC  X(008).
           03  cRQ|z        PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŉz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐV    PIC  X(008).
           03  cRQ|Ǘx
                                     PIC  X(001).
           03  cRQ|z  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|vz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|擾z      PIC S9(013) PACKED-DECIMAL.
           03  cRQ|kytO
                                     PIC  X(001).
           03  cRQ|񏈗N  PIC  X(006).
           03  cRQ|Gg
                                     PIC  X(008).
           03  cRQ|tO    PIC  X(001).
           03  cRQ|N    PIC  X(008).
           03  cRQ|\tO
                                     PIC  X(001).
           03  cRQ|\    PIC  X(008).
           03  cRQ|ύXtO
                                     PIC  X(001).
           03  cRQ|ύX
                                     PIC S9(002) PACKED-DECIMAL.
           03  cRQ|ύX
                                     PIC  X(008).
           03  cRQ|O敪      PIC  X(001).
           03  cRQ|ă[X
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[X敪
                                     PIC  X(001).
           03  cRQ|ێLtO
                                     PIC  X(001).
           03  cRQ|ă[X쐬tO
                                     PIC  X(001).
           03  cRQ|ă[X쐬N
                                     PIC  X(008).
           03  cRQ|XVN    PIC  X(008).
           03  cRQ|XV      PIC  X(008).
           03  cRQ|XV        PIC  X(008).
           03  cRQ|擾z    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|擾z    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|O      PIC S9(002) PACKED-DECIMAL.
           03  cRQ|ă[X
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[Xŋ敪
                                     PIC  X(002).
           03  cRQ|      PIC S9(003) PACKED-DECIMAL.
           03  cRQ|    PIC S9(003) PACKED-DECIMAL.
           03  cRQ|Z_
                                     PIC  X(003).
           03  cRQ|ă[X敪
                                     PIC  X(001).
           03  cRQ|ă[X萔
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|UXgbv\N
                                     PIC  X(008).
           03  cRQ|UXgbv\
                                     PIC  X(004).
           03  cRQ|UXgbv\
                                     PIC  X(008).
           03  cRQ|UXgbvJnN
                                     PIC  X(006).
           03  cRQ|UXgbvIN
                                     PIC  X(006).
           03  cRQ|UXgbvR
                                     PIC  X(002).
           03  cRQ|UXgbvGg
                                     PIC  X(008).
           03  cRQ|Uʐ\N
                                     PIC  X(008).
           03  cRQ|Uʐ\
                                     PIC  X(004).
           03  cRQ|Uʐ\
                                     PIC  X(008).
           03  cRQ|UʐJnN
                                     PIC  X(006).
           03  cRQ|UʐIN
                                     PIC  X(006).
           03  cRQ|Uʐ\z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|UʃGg
                                     PIC  X(008).
           03  cRQ|xă[X
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ϑێ敪  PIC  X(001).
           03  cRQ|ϑێ瑊z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|͒S҃R[h
                                     PIC  X(008).
           03  cRQ|̑_ދ敪
                                     PIC  X(001).
           03  cRQ|R[h  PIC  X(009).
           03  cRQ|R[h  PIC  X(005).
           03  cRQ|evz      PIC S9(013) PACKED-DECIMAL.
           03  cRQ|evz|\  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|`    PIC  X(008).
           03  cRQ|`      PIC S9(003) PACKED-DECIMAL.
           03  cRQ|Еz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Еz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Е_񑍊z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Еőz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ѝwz    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|cݒz    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ўcݒz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Љz    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Љz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Њz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Њvz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[X萔z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[X萔
                                     PIC  X(008).
           03  cRQ|p萔  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[XЎcݒz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[XЎcݒz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|vz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|vz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|pz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|菈R[h
                                     PIC  X(002).
           03  cRQ|Œ|
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|菈R[h
                                     PIC  X(002).
           03  cRQ|敪  PIC  X(001).
           03  cRQ|zz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ŋzz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVzz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVŊzz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐV_񑍊zz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVőzz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|擾zz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|擾zz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[Xz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[Xőz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|cTCg
                                     PIC S9(002)V9(002) PACKED-DECIMAL.
           03  cRQ|XPO_񑍊z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Œ敪
                                     PIC  X(001).
           03  cRQ|o^N    PIC  X(008).
           03  cRQ|o^      PIC  X(008).
           03  cRQ|o^S    PIC  X(008).
           03  cRQ|UzύXR
                                     PIC  X(002).
           03  cRQ|Еă[X
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Еă[X
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ݒuꏊ敪  PIC S9(001) PACKED-DECIMAL.
           03  cRQ|_񑍊zz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|őzz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ѝwz    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ўcݒz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ќ{z  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Д㗘z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Зz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Џpz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ЌŒ莑Yőz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Гیz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Јϑێ痿z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ђ̑pz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ЕxpKpv
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Еxpʍv
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|{z      PIC S9(013) PACKED-DECIMAL.
           03  cRQ|z      PIC S9(013) PACKED-DECIMAL.
           03  cRQ|pz    PIC S9(013) PACKED-DECIMAL.
000480     
      *    EXEC  SQL  INCLUDE  D34HNS.CBL            END-EXEC.
000490*                                                                 
      *****************************************************************
      *   ϑ(D34HNS_TBL)
      *****************************************************************
       01  ϑ.
           03  cRS|_ԍ      PIC  X(010).
           03  cRS|ă[X  PIC S9(002) PACKED-DECIMAL.
           03  cRS|_      PIC  X(003).
           03  cRS|Jn        PIC S9(003) PACKED-DECIMAL.
           03  cRS|JnN      PIC  X(006).
           03  cRS|I        PIC S9(003) PACKED-DECIMAL.
           03  cRS|IN      PIC  X(006).
           03  cRS|z          PIC S9(013) PACKED-DECIMAL.
           03  cRS|        PIC S9(013) PACKED-DECIMAL.
           03  cRS|XVN    PIC  X(008).
           03  cRS|XV      PIC  X(008).
           03  cRS|XV        PIC  X(008).
           03  cRS|͒S҃R[h
                                     PIC  X(008).
           03  cRS|o^N    PIC  X(008).
           03  cRS|o^      PIC  X(008).
           03  cRS|o^S    PIC  X(008).
000500     
      *    EXEC  SQL  END  DECLARE          SECTION  END-EXEC.
000510*                                                                 
000520*----------------------------------------------------------------*
000530*    vnqjGA                                              *
000540*----------------------------------------------------------------*
000550 01  vnqj|GA.                                            
000560*--< G[p >                                               
000570     03  v|G[R[h             PIC S9(04).                 
000580*                                                                 
000590*--< tOAA >                                               
000600     03  tOAA.                                            
000610         05  v|I|tO         PIC  X(01).                 
000620         05  v|ُI|tO     PIC  X(01).                 
000630*                                                                 
000640*--< GA >                                                 
000650     03  GA.                                              
000660         05  v|́|           PIC  9(09).                 
000670         05  v|ó|           PIC  9(09).                 
000680*                                                                 
000690*--< L[GA >                                                 
000700     03  jdx|GA.                                          
000710        05  mdvL[.                                           
000720            07 m|_ԍ           PIC  X(09).                 
000730            07 m|ă[X       PIC  9(02).                 
000740            07 m|_           PIC  X(03).                 
000750            07 m|z             PIC  9(13).                 
000760        05  nkcL[.                                           
000770            07 n|_ԍ           PIC  X(09).                 
000780            07 n|ă[X       PIC  9(02).                 
000790            07 n|_           PIC  X(03).                 
000800            07 n|z             PIC  9(13).                 
000810*                                                                 
000820*--< ʏ >                                                   
000830 01  v|ʏ.                                                
000840     03  v|VXet.                                        
000850         05  v|I                 PIC  X(02) VALUE  "20".     
000860         05  v|N               PIC  X(06).                 
000870     03  v|VXe             PIC  X(08).                 
000880     03  v|S                   PIC  X(08) VALUE "IKOPG   ".
000890*                                                                 
000900*----------------------------------------------------------------*
000910*    Tu[`                                              *
000920*----------------------------------------------------------------*
000930 01  CALL-AREA.                                                   
000940*--< ʃOTu[` >                                       
000950     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
000960     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
000970*                                                                 
000980*----------------------------------------------------------------*
000990*    bnoẍ                                                *
001000*----------------------------------------------------------------*
001010*--< ʃOpp[^ >                                       
001020 01  IF-CHOCO001.                                                 
001030     COPY  CHOCO001  REPLACING  ==()==  BY  ==P|==.           
001040*                                                                 
001050*----------------------------------------------------------------*
001060*    hmht@CǍTu[`pp^̈                *
001070*----------------------------------------------------------------*
001080 01  PARA-AREA.                                                   
001090     COPY CPBCO001.                                               
001100******************************************************************
001110*    萔pf[^`GA                                      *
001120******************************************************************
001130 CONSTANT                             SECTION.                    
001140 01  萔̈.                                                    
001150     03  萔|vOhc         PIC  X(08) VALUE "COBIS430".
001160     03  萔|vO           PIC  X(80)                  
001170                                      VALUE  "ϑڍs".        
001180     03  萔|rpknj             PIC S9(04)  VALUE  ZERO.    
001190     03  萔|rpkdmc           PIC S9(04)  VALUE  0100.    
001200     03  萔|               PIC S9(04)  VALUE  ZERO.    
001210     03  萔|ُ               PIC S9(04)  VALUE  0009.    
001220******************************************************************
001230*    oqnbdctqd            chuhrhnm              *
001240******************************************************************
001250 PROCEDURE                            DIVISION.                   
001260*                                                                 
001270     PERFORM  .                                           
001280*                                                                 
001290     PERFORM  又  UNTIL  v|I|tO  =  "Y".            
001300*                                                                 
001310     PERFORM  I.                                           
001320*                                                                 
001330     STOP     RUN.                                                
001340*                                                                 
001350******************************************************************
001360*                                                        *
001370******************************************************************
001380                              SECTION.                    
001390 |rs`qs.                                            
001400*                                                                 
001410*----------------------------------------------------------------*
001420*    JnbZ[Wo͏                                      *
001430*----------------------------------------------------------------*
001440     INITIALIZE                       IF-CHOCO001.                
001450     MOVE  "3"                        TO  P|Cxg.     
001460     MOVE  萔|vOhc       TO  P|\[Xhc.       
001470     MOVE  "0"                        TO  P|AR[h.       
001480     MOVE  "START"                    TO  P|.         
001490     MOVE  萔|vO         TO  P|̑bZ[W. 
001500     CALL  CLOCO001                USING  IF-CHOCO001.            
001510*                                                                 
001520*----------------------------------------------------------------*
001530*    Ɨ̈̏l                                        *
001540*----------------------------------------------------------------*
001550     MOVE  SPACE                      TO  vnqj|GA.       
001560     INITIALIZE                           vnqj|GA.       
001570*                                                                 
001580     MOVE  LOW-VALUE                  TO  nkcL[.             
001590*                                                                 
001600*--< bott擾 >                                           
001610     ACCEPT  v|N               FROM  DATE.                 
001620*                                                                 
001630*--< bot擾 >                                           
001640     ACCEPT  v|VXe         FROM  TIME.                 
001650*----------------------------------------------------------------*
001660*    nq`bkdڑ                                            *
001670*----------------------------------------------------------------*
001680     PERFORM   nq`bkdڑ.                                  
001690*                                                                 
001700*----------------------------------------------------------------*
001710*    e[uJ[\`                                    *
001720*----------------------------------------------------------------*
001730     PERFORM  e[uJ[\`.                           
001740*                                                                 
001750*----------------------------------------------------------------*
001760*    e[uJ[\Ǎ(1)                             *
001770*----------------------------------------------------------------*
001780     PERFORM  e[uJ[\Ǎ.                           
001790*                                                                 
001800 |dwhs.                                              
001810     EXIT.                                                        
001820******************************************************************
001830*    nq`bkdڑ                                            *
001840******************************************************************
001850 nq`bkdڑ                     SECTION.                    
001860 nq`bkdڑ|rs`qs.                                    
001870*                                                                 
001880*--< caڑp擾 >                                   
001890     CALL  COBCO001                USING  PARA-AREA.              
001900*                                                                 
001910     MOVE  PARA-DBSTRING              TO  DB-STRING.              
001920     MOVE  PARA-USERNAME              TO  USERNAME.               
001930     MOVE  PARA-PASSWORD              TO  PASSWD.                 
001940*                                                                 
001950*----------------------------------------------------------------*
001960*    Jnڑ                                                    *
001970*----------------------------------------------------------------*
001980     IF    DB-STRING  =  SPACE                                    
001990        
      *       EXEC SQL                                                  
002000*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002010*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002020     ELSE                                                         
002030        
      *       EXEC SQL                                                  
002040*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002050*            USING  :DB-STRING                                    
002060*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002070     END-IF.                                                      
002080*                                                                 
002090*----------------------------------------------------------------*
002100*    ڑmF                                                    *
002110*----------------------------------------------------------------*
002120     EVALUATE  SQLCODE                                            
002130        WHEN   萔|rpknj                                   
002140           CONTINUE                                               
002150        WHEN   OTHER                                              
002160*--<       ڑG[ >                                           
002170           MOVE     -10               TO  v|G[R[h        
002180           PERFORM  G[菈                                
002190     END-EVALUATE.                                                
002200*                                                                 
002210 nq`bkdڑ|dwhs.                                      
002220     EXIT.                                                        
002230******************************************************************
002240*        e[uJ[\`                                *
002250******************************************************************
002260 e[uJ[\`             SECTION.                    
002270 e[uJ[\`|rs`qs.                            
002280*                                                                 
002290*----------------------------------------------------------------*
002300*    J[\nodm                                        *
002310*----------------------------------------------------------------*
002320     
      *    EXEC SQL                                                     
002330*       DECLARE CUR1  CURSOR FOR                                  
002340*          SELECT  D411STK_TBL._ԍ                           
002350*                 ,D411STK_TBL.ă[X                       
002360*                 ,D411STK_TBL._                           
002370*                 ,D411STK_TBL.z                             
002380*                 ,D411STK_TBL.                         
002390*                 ,D411STK_TBL.N                           
002400*                 ,D411STK_TBL.A                               
002410*            FROM  D32SAK_TBL                                     
002420*                 ,D411STK_TBL                                    
002430*           WHERE  D32SAK_TBL.ϑ       =  '1'                 
002440*             AND  D32SAK_TBL._ԍ     =  D411STK_TBL._ԍ
002450*             AND  D32SAK_TBL.ă[X =                      
002460*                                         D411STK_TBL.ă[X
002470*             AND  D32SAK_TBL._     =  D411STK_TBL._
002480*        ORDER BY  D411STK_TBL._ԍ                           
002490*                 ,D411STK_TBL.ă[X                       
002500*                 ,D411STK_TBL._                           
002510*                 ,D411STK_TBL.z                             
002520*    END-EXEC.
002530*                                                                 
002540*----------------------------------------------------------------*
002550*    J[\nodm                                        *
002560*----------------------------------------------------------------*
002570     
      *    EXEC  SQL                                                    
002580*       OPEN  CUR1                                                
002590*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
002600*                                                                 
002610*----------------------------------------------------------------*
002620*    J[\nodmmF                                        *
002630*----------------------------------------------------------------*
002640     EVALUATE  SQLCODE                                            
002650        WHEN  萔|rpknj                                    
002660*--<        >                                                 
002670           CONTINUE                                               
002680        WHEN  OTHER                                               
002690*--<       J[\nodmG[ >                               
002700           MOVE -20                   TO  v|G[R[h        
002710           PERFORM  G[菈                                
002720     END-EVALUATE.                                                
002730*                                                                 
002740 e[uJ[\`|dwhs.                              
002750     EXIT.                                                        
002760******************************************************************
002770*    e[uJ[\Ǎ                                    *
002780******************************************************************
002790 e[uJ[\Ǎ             SECTION.                    
002800 e[uJ[\Ǎ|rs`qs.                            
002810*                                                                 
002820*--< e[uJ[\Ǎ >                                   
002830     
      *    EXEC SQL                                                     
002840*        FETCH  CUR1                                              
002850*         INTO  :cSPP|_ԍ                               
002860*              ,:cSPP|ă[X                           
002870*              ,:cSPP|_                               
002880*              ,:cSPP|z                                 
002890*              ,:cSPP|                             
002900*              ,:cSPP|N                               
002910*              ,:cSPP|A                                   
002920*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 82 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               cSPP|_ԍ IN
               WJ
               SQL-SQHSTV(1)
           MOVE 10 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               cSPP|ă[X IN
               WJ
               SQL-SQHSTV(2)
           MOVE 2 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               cSPP|_ IN
               WJ
               SQL-SQHSTV(3)
           MOVE 3 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               cSPP|z IN
               WJ
               SQL-SQHSTV(4)
           MOVE 7 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               cSPP| IN
               WJ
               SQL-SQHSTV(5)
           MOVE 7 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               cSPP|N IN
               WJ
               SQL-SQHSTV(6)
           MOVE 6 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               cSPP|A IN
               WJ
               SQL-SQHSTV(7)
           MOVE 2 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
002930*                                                                 
002940*----------------------------------------------------------------*
002950*    e[uJ[\ǍmF                              *
002960*----------------------------------------------------------------*
002970     EVALUATE   SQLCODE                                           
002980        WHEN   萔|rpknj                                   
002990*--<        >                                                 
003000           MOVE  cSPP|_ԍ   TO  m|_ԍ            
003010           MOVE  cSPP|ă[X                           
003020                                      TO  m|ă[X        
003030           MOVE  cSPP|_   TO  m|_            
003040           MOVE  cSPP|z     TO  m|z              
003050*                                                                 
003060           COMPUTE  v|́|  =  v|́|  +  1       
003070        WHEN   萔|rpkdmc                                 
003080*--<       ǍI >                                             
003090           MOVE  "Y"                  TO  v|I|tO        
003100        WHEN   OTHER                                              
003110*--<       ǍG[ >                                           
003120           MOVE     -30               TO  v|G[R[h        
003130           PERFORM  G[菈                                
003140     END-EVALUATE.                                                
003150*                                                                 
003160 e[uJ[\Ǎ|dwhs.                              
003170     EXIT.                                                        
003180******************************************************************
003190*    又                                                      *
003200******************************************************************
003210 又                               SECTION.                    
003220 又|rs`qs.                                              
003230*                                                                 
003240     PERFORM  ҏWo͏.                                       
003250*                                                                 
003260*--< e[uJ[\ǍiQڈȍ~j >                     
003270     PERFORM  e[uJ[\Ǎ.                           
003280*                                                                 
003290     IF  v|I|tO  =  "Y"                                 
003300*--<    ̓f[^I鎞 >                                      
003310        PERFORM  o͏                                         
003320     END-IF.                                                      
003330*                                                                 
003340 又|dwhs.                                                
003350     EXIT.                                                        
003360******************************************************************
003370*     ҏWo͏                                               *
003380******************************************************************
003390 ҏWo͏                         SECTION.                    
003400 ҏWo͏|rs`qs.                                        
003410*                                                                 
003420     IF  mdvL[  =  nkcL[                                
003430*--<    No.06 >                                                   
003440        MOVE  cSPP|A          TO  cRS|I          
003450*--<    No.07 >                                                   
003460        MOVE  cSPP|N      TO  cRS|IN        
003470     ELSE                                                         
003480        IF  v|́|  >  1                                  
003490*--<       Qڈȍ~AL[ς鎞Ao͂ >               
003500           PERFORM  o͏                                      
003510        END-IF                                                    
003520*                                                                 
003530*----------------------------------------------------------------*
003540*                                                      *
003550*----------------------------------------------------------------*
003560        MOVE  SPACE                   TO  ϑ                  
003570        INITIALIZE                        ϑ                  
003580*                                                                 
003590*----------------------------------------------------------------*
003600*       ڕҏW                                             *
003610*----------------------------------------------------------------*
003620*--<    No.01 >                                                   
003630        MOVE  cSPP|_ԍ(1:9) TO  cRS|_ԍ        
003640*                                                                 
003650*--<    No.02 >                                                   
003660        MOVE  cSPP|ă[X  TO  cRS|ă[X    
003670                                                                  
003680*--<    No.03 >                                                   
003690        MOVE  cSPP|_      TO  cRS|_        
003700*                                                                 
003710*--<    No.04 >                                                   
003720        MOVE  cSPP|A          TO  cRS|Jn          
003730*                                                                 
003740*--<    No.05 >                                                   
003750        MOVE  cSPP|N      TO  cRS|JnN        
003760*                                                                 
003770*--<    No.06 >                                                   
003780        MOVE  cSPP|A          TO  cRS|I          
003790*                                                                 
003800*--<    No.07 >                                                   
003810        MOVE  cSPP|N      TO  cRS|IN        
003820*                                                                 
003830*--<    No.08 >                                                   
003840        MOVE  cSPP|z        TO  cRS|z            
003850*                                                                 
003860*--<    No.09 >                                                   
003870        MOVE  cSPP|    TO  cRS|          
003880*                                                                 
003890*--<    No.10 >                                                   
003900        MOVE  v|VXet        TO  cRS|XVN      
003910*                                                                 
003920*--<    No.11 >                                                   
003930        MOVE  v|VXe        TO  cRS|XV        
003940*                                                                 
003950*--<    No.12 >                                                   
003960        MOVE  v|S              TO  cRS|XV          
003970*                                                                 
003980*--<    No.13 >                                                   
003990        MOVE  v|S              TO  cRS|͒S҃R[h
004000*                                                                 
004010*--<    No.14 >                                                   
004020        MOVE  v|VXet        TO  cRS|o^N      
004030*                                                                 
004040*--<    No.15 >                                                   
004050        MOVE  v|VXe        TO  cRS|o^        
004060*                                                                 
004070*--<    No.16 >                                                   
004080        MOVE  v|S              TO  cRS|o^S      
004090*                                                                 
004100     END-IF.                                                      
004110*                                                                 
004120     MOVE mdvL[                  TO  nkcL[.             
004130*                                                                 
004140 ҏWo͏|dwhs.                                          
004150     EXIT.                                                        
004160******************************************************************
004170*    o͏                                                    *
004180******************************************************************
004190 o͏                             SECTION.                    
004200 o͏|rs`qs.                                            
004210*                                                                 
004220       
      *      EXEC  SQL                                                  
004230*       INSERT  INTO  D34HNS_TBL                                  
004240*          ( _ԍ                                             
004250*           ,ă[X                                         
004260*           ,_                                             
004270*           ,Jn                                               
004280*           ,JnN                                             
004290*           ,I                                               
004300*           ,IN                                             
004310*           ,z                                                 
004320*           ,                                               
004330*           ,XVN                                           
004340*           ,XV                                             
004350*           ,XV                                               
004360*           ,͒S҃R[h                                     
004370*           ,o^N                                           
004380*           ,o^                                             
004390*           ,o^S)                                          
004400*      VALUES                                                     
004410*          ( :cRS|_ԍ                                    
004420*           ,:cRS|ă[X                                
004430*           ,:cRS|_                                    
004440*           ,:cRS|Jn                                      
004450*           ,:cRS|JnN                                    
004460*           ,:cRS|I                                      
004470*           ,:cRS|IN                                    
004480*           ,:cRS|z                                        
004490*           ,:cRS|                                      
004500*           ,:cRS|XVN                                  
004510*           ,:cRS|XV                                    
004520*           ,:cRS|XV                                      
004530*           ,:cRS|͒S҃R[h                            
004540*           ,:cRS|o^N                                  
004550*           ,:cRS|o^                                    
004560*           ,:cRS|o^S)                                 
004570*    END-EXEC.
             CALL "SQLADR" USING SQ0002 SQL-STMT
             MOVE 1 TO SQL-ITERS
             MOVE 125 TO SQL-OFFSET
             MOVE 0 TO SQL-OCCURS
             CALL "SQLADR" USING
                 SQLCUD
                 SQL-CUD
             CALL "SQLADR" USING
                 SQLCA
                 SQL-SQLEST
             MOVE 256 TO SQL-SQLETY
             CALL "SQLADR" USING
                 cRS|_ԍ IN
                 ϑ
                 SQL-SQHSTV(1)
             MOVE 10 TO SQL-SQHSTL(1)
             MOVE 0 TO SQL-SQHSTS(1)
             MOVE 0 TO SQL-SQINDV(1)
             MOVE 0 TO SQL-SQINDS(1)
             MOVE 0 TO SQL-SQHARM(1)
             CALL "SQLADR" USING
                 cRS|ă[X IN
                 ϑ
                 SQL-SQHSTV(2)
             MOVE 2 TO SQL-SQHSTL(2)
             MOVE 0 TO SQL-SQHSTS(2)
             MOVE 0 TO SQL-SQINDV(2)
             MOVE 0 TO SQL-SQINDS(2)
             MOVE 0 TO SQL-SQHARM(2)
             CALL "SQLADR" USING
                 cRS|_ IN
                 ϑ
                 SQL-SQHSTV(3)
             MOVE 3 TO SQL-SQHSTL(3)
             MOVE 0 TO SQL-SQHSTS(3)
             MOVE 0 TO SQL-SQINDV(3)
             MOVE 0 TO SQL-SQINDS(3)
             MOVE 0 TO SQL-SQHARM(3)
             CALL "SQLADR" USING
                 cRS|Jn IN
                 ϑ
                 SQL-SQHSTV(4)
             MOVE 2 TO SQL-SQHSTL(4)
             MOVE 0 TO SQL-SQHSTS(4)
             MOVE 0 TO SQL-SQINDV(4)
             MOVE 0 TO SQL-SQINDS(4)
             MOVE 0 TO SQL-SQHARM(4)
             CALL "SQLADR" USING
                 cRS|JnN IN
                 ϑ
                 SQL-SQHSTV(5)
             MOVE 6 TO SQL-SQHSTL(5)
             MOVE 0 TO SQL-SQHSTS(5)
             MOVE 0 TO SQL-SQINDV(5)
             MOVE 0 TO SQL-SQINDS(5)
             MOVE 0 TO SQL-SQHARM(5)
             CALL "SQLADR" USING
                 cRS|I IN
                 ϑ
                 SQL-SQHSTV(6)
             MOVE 2 TO SQL-SQHSTL(6)
             MOVE 0 TO SQL-SQHSTS(6)
             MOVE 0 TO SQL-SQINDV(6)
             MOVE 0 TO SQL-SQINDS(6)
             MOVE 0 TO SQL-SQHARM(6)
             CALL "SQLADR" USING
                 cRS|IN IN
                 ϑ
                 SQL-SQHSTV(7)
             MOVE 6 TO SQL-SQHSTL(7)
             MOVE 0 TO SQL-SQHSTS(7)
             MOVE 0 TO SQL-SQINDV(7)
             MOVE 0 TO SQL-SQINDS(7)
             MOVE 0 TO SQL-SQHARM(7)
             CALL "SQLADR" USING
                 cRS|z IN
                 ϑ
                 SQL-SQHSTV(8)
             MOVE 7 TO SQL-SQHSTL(8)
             MOVE 0 TO SQL-SQHSTS(8)
             MOVE 0 TO SQL-SQINDV(8)
             MOVE 0 TO SQL-SQINDS(8)
             MOVE 0 TO SQL-SQHARM(8)
             CALL "SQLADR" USING
                 cRS| IN
                 ϑ
                 SQL-SQHSTV(9)
             MOVE 7 TO SQL-SQHSTL(9)
             MOVE 0 TO SQL-SQHSTS(9)
             MOVE 0 TO SQL-SQINDV(9)
             MOVE 0 TO SQL-SQINDS(9)
             MOVE 0 TO SQL-SQHARM(9)
             CALL "SQLADR" USING
                 cRS|XVN IN
                 ϑ
                 SQL-SQHSTV(10)
             MOVE 8 TO SQL-SQHSTL(10)
             MOVE 0 TO SQL-SQHSTS(10)
             MOVE 0 TO SQL-SQINDV(10)
             MOVE 0 TO SQL-SQINDS(10)
             MOVE 0 TO SQL-SQHARM(10)
             CALL "SQLADR" USING
                 cRS|XV IN
                 ϑ
                 SQL-SQHSTV(11)
             MOVE 8 TO SQL-SQHSTL(11)
             MOVE 0 TO SQL-SQHSTS(11)
             MOVE 0 TO SQL-SQINDV(11)
             MOVE 0 TO SQL-SQINDS(11)
             MOVE 0 TO SQL-SQHARM(11)
             CALL "SQLADR" USING
                 cRS|XV IN
                 ϑ
                 SQL-SQHSTV(12)
             MOVE 8 TO SQL-SQHSTL(12)
             MOVE 0 TO SQL-SQHSTS(12)
             MOVE 0 TO SQL-SQINDV(12)
             MOVE 0 TO SQL-SQINDS(12)
             MOVE 0 TO SQL-SQHARM(12)
             CALL "SQLADR" USING
                 cRS|͒S҃R[h IN
                 ϑ
                 SQL-SQHSTV(13)
             MOVE 8 TO SQL-SQHSTL(13)
             MOVE 0 TO SQL-SQHSTS(13)
             MOVE 0 TO SQL-SQINDV(13)
             MOVE 0 TO SQL-SQINDS(13)
             MOVE 0 TO SQL-SQHARM(13)
             CALL "SQLADR" USING
                 cRS|o^N IN
                 ϑ
                 SQL-SQHSTV(14)
             MOVE 8 TO SQL-SQHSTL(14)
             MOVE 0 TO SQL-SQHSTS(14)
             MOVE 0 TO SQL-SQINDV(14)
             MOVE 0 TO SQL-SQINDS(14)
             MOVE 0 TO SQL-SQHARM(14)
             CALL "SQLADR" USING
                 cRS|o^ IN
                 ϑ
                 SQL-SQHSTV(15)
             MOVE 8 TO SQL-SQHSTL(15)
             MOVE 0 TO SQL-SQHSTS(15)
             MOVE 0 TO SQL-SQINDV(15)
             MOVE 0 TO SQL-SQINDS(15)
             MOVE 0 TO SQL-SQHARM(15)
             CALL "SQLADR" USING
                 cRS|o^S IN
                 ϑ
                 SQL-SQHSTV(16)
             MOVE 8 TO SQL-SQHSTL(16)
             MOVE 0 TO SQL-SQHSTS(16)
             MOVE 0 TO SQL-SQINDV(16)
             MOVE 0 TO SQL-SQINDS(16)
             MOVE 0 TO SQL-SQHARM(16)
             CALL "SQLADR" USING
                 SQL-SQHSTV(1)
                 SQL-SQPHSV
             CALL "SQLADR" USING
                 SQL-SQHSTL(1)
                 SQL-SQPHSL
             CALL "SQLADR" USING
                 SQL-SQHSTS(1)
                 SQL-SQPHSS
             CALL "SQLADR" USING
                 SQL-SQINDV(1)
                 SQL-SQPIND
             CALL "SQLADR" USING
                 SQL-SQINDS(1)
                 SQL-SQPINS
             CALL "SQLADR" USING
                 SQL-SQHARM(1)
                 SQL-SQPARM
             CALL "SQLADR" USING
                 SQL-SQHARC(1)
                 SQL-SQPARC

             CALL "SQLBEX" USING
                 SQLCTX
                 SQLEXD
                 SQLFPN

             CALL "SQLGSS" USING
                SQLSTATE
                 .
004580*                                                                 
004590*----------------------------------------------------------------*
004600*    ǉmF                                              *
004610*----------------------------------------------------------------*
004620     EVALUATE  SQLCODE                                            
004630        WHEN   萔|rpknj                                   
004640*--<       ǉ >                                             
004650           COMPUTE  v|ó|  =  v|ó|  +  1       
004660        WHEN   OTHER                                              
004670*--<       ǉG[ >                                       
004680           MOVE     -40               TO  v|G[R[h        
004690           PERFORM  G[菈                                
004700     END-EVALUATE.                                                
004710*                                                                 
004720 o͏|dwhs.                                              
004730     EXIT.                                                        
004740******************************************************************
004750*    I                                                    *
004760******************************************************************
004770 I                             SECTION.                    
004780 I|rs`qs.                                            
004790*                                                                 
004800*--< caN[Y >                                               
004810     PERFORM  caN[Y.                                   
004820*                                                                 
004830*--< caR~bg >                                           
004840     PERFORM  caR~bg.                                   
004850*                                                                 
004860*--< IbZ[Wo͏ >                                     
004870     PERFORM  IbZ[Wo.                                 
004880*                                                                 
004890*--< vOI >                                         
004900     MOVE  萔|             TO  PROGRAM-STATUS.         
004910*                                                                 
004920 I|dwhs.                                              
004930     EXIT.                                                        
004940******************************************************************
004950*    IbZ[Wo                                          *
004960******************************************************************
004970 IbZ[Wo                   SECTION.                    
004980 IbZ[Wó|rs`qs.                                  
004990*                                                                 
005000*----------------------------------------------------------------*
005010*    bZ[Wo͏                                      *
005020*----------------------------------------------------------------*
005030     INITIALIZE                       IF-CHOCO001.                
005040     MOVE  "3"                        TO  P|Cxg.     
005050     MOVE  萔|vOhc       TO  P|\[Xhc.       
005060     MOVE  "0"                        TO  P|AR[h.       
005070     MOVE  "D411STK"                  TO  P|e[uhc. 
005080     MOVE  "COUNT"                    TO  P|.         
005090     MOVE  v|́|             TO  P|f[^e.       
005100     MOVE  "xAbvWJ͌"                         
005110                                      TO  P|̑bZ[W. 
005120     CALL  CLOCO001                USING  IF-CHOCO001.            
005130*                                                                 
005140     INITIALIZE                       IF-CHOCO001.                
005150     MOVE  "3"                        TO  P|Cxg.     
005160     MOVE  萔|vOhc       TO  P|\[Xhc.       
005170     MOVE  "0"                        TO  P|AR[h.       
005180     MOVE  "D34HNS"                   TO  P|e[uhc. 
005190     MOVE  "COUNT"                    TO  P|.         
005200     MOVE  v|ó|             TO  P|f[^e.       
005210     MOVE  "ϑDBo͌"         TO  P|̑bZ[W. 
005220     CALL  CLOCO001                USING  IF-CHOCO001.            
005230*                                                                 
005240*----------------------------------------------------------------*
005250*    IbZ[Wo                                          *
005260*----------------------------------------------------------------*
005270     INITIALIZE                       IF-CHOCO001.                
005280     MOVE  "3"                        TO  P|Cxg.     
005290     MOVE  萔|vOhc       TO  P|\[Xhc.       
005300     MOVE  "0"                        TO  P|AR[h.       
005310     MOVE  "END"                      TO  P|.         
005320     MOVE  萔|vO         TO  P|̑bZ[W. 
005330     CALL  CLOCO001                USING  IF-CHOCO001.            
005340*                                                                 
005350 IbZ[Wó|dwhs.                                    
005360     EXIT.                                                        
005370******************************************************************
005380*    caN[Y                                                *
005390******************************************************************
005400 caN[Y                     SECTION.                    
005410 caN[Y|rs`qs.                                    
005420*                                                                 
005430*--< J[\ N[Y >                                          
005440     
      *    EXEC SQL                                                     
005450*       CLOSE  CUR1                                               
005460*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 204 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005470*                                                                 
005480 caN[Y|dwhs.                                      
005490     EXIT.                                                        
005500******************************************************************
005510*    caR~bg                                            *
005520******************************************************************
005530 caR~bg                     SECTION.                    
005540 caR~bg|rs`qs.                                    
005550*                                                                 
005560     
      *    EXEC  SQL                                                    
005570*       COMMIT  WORK  RELEASE                                     
005580*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 219 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005590*                                                                 
005600     INITIALIZE                       IF-CHOCO001.                
005610     MOVE  "3"                        TO  P|Cxg.     
005620     MOVE  萔|vOhc       TO  P|\[Xhc.       
005630     MOVE  "0"                        TO  P|AR[h.       
005640     MOVE  "COMMIT"                   TO  P|.         
005650     MOVE  "R~bg{"             TO  P|̑bZ[W. 
005660     CALL  CLOCO001                USING  IF-CHOCO001.            
005670*                                                                 
005680 caR~bg|dwhs.                                      
005690     EXIT.                                                        
005700******************************************************************
005710*    ca[obN                                        *
005720******************************************************************
005730 ca[obN                 SECTION.                    
005740 ca[obN|rs`qs.                                
005750*                                                                 
005760     
      *    EXEC  SQL                                                    
005770*       ROLLBACK WORK  RELEASE                                    
005780*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 234 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005790*                                                                 
005800     INITIALIZE                       IF-CHOCO001.                
005810     MOVE  "1"                        TO  P|Cxg.     
005820     MOVE  萔|vOhc       TO  P|\[Xhc.       
005830     MOVE  "9"                        TO  P|AR[h.       
005840     MOVE  "ROLLBACK"                 TO  P|.         
005850     MOVE  "[obN{"         TO  P|̑bZ[W. 
005860     CALL  CLOCO001                USING  IF-CHOCO001.            
005870*                                                                 
005880 ca[obN|dwhs.                                  
005890     EXIT.                                                        
005900******************************************************************
005910*    G[                                                  *
005920******************************************************************
005930 G[菈                       SECTION.                    
005940 G[菈|rs`qs.                                      
005950*                                                                 
005960     MOVE  "Y"                        TO v|ُI|tO.    
005970     INITIALIZE                       IF-CHOCO001.                
005980*                                                                 
005990     EVALUATE  v|G[R[h                                   
006000        WHEN  -10                                                 
006010*--<       nq`bkdڑs >                                 
006020           MOVE  "1"                  TO  P|Cxg      
006030           MOVE  萔|vOhc TO  P|\[Xhc        
006040           MOVE  "9"                  TO  P|AR[h        
006050           MOVE  "CONNECT"            TO  P|          
006060           MOVE  SQLCODE              TO  P|f[^e        
006070           MOVE  SQLERRMC             TO  P|̑bZ[W  
006080           CALL  CLOCO001          USING  IF-CHOCO001             
006090*                                                                 
006100        WHEN  -20                                                 
006110*--<       e[uJ[\I[vs >                     
006120           MOVE  "1"                  TO  P|Cxg      
006130           MOVE  萔|vOhc TO  P|\[Xhc        
006140           MOVE  "9"                  TO  P|AR[h        
006150           MOVE  "D32SAK"             TO  P|e[uhc  
006160           MOVE  "OPEN"               TO  P|          
006170           MOVE  SQLCODE              TO  P|f[^e        
006180           MOVE  SQLERRMC             TO  P|̑bZ[W  
006190           CALL  CLOCO001          USING  IF-CHOCO001             
006200*                                                                 
006210        WHEN  -30                                                 
006220*--<       e[uǍs >                                 
006230           MOVE  "1"                  TO  P|Cxg      
006240           MOVE  萔|vOhc TO  P|\[Xhc        
006250           MOVE  "9"                  TO  P|AR[h        
006260           MOVE  "D11STK"             TO  P|e[uhc  
006270           MOVE  "FETCH"              TO  P|          
006280           MOVE  SQLCODE              TO  P|f[^e        
006290           MOVE  SQLERRMC             TO  P|̑bZ[W  
006300           CALL  CLOCO001          USING  IF-CHOCO001             
006310*                                                                 
006320        WHEN  -40                                                 
006330*--<       ϑcaǉs >                                   
006340           MOVE  "1"                  TO  P|Cxg      
006350           MOVE  萔|vOhc TO  P|\[Xhc        
006360           MOVE  "9"                  TO  P|AR[h        
006370           MOVE  "D34HNS"             TO  P|e[uhc  
006380           MOVE  "INSERT"             TO  P|          
006390           MOVE  SQLCODE              TO  P|f[^e        
006400           MOVE  SQLERRMC             TO  P|̑bZ[W  
006410           CALL  CLOCO001          USING  IF-CHOCO001             
006420*                                                                 
006430        WHEN  OTHER                                               
006440           MOVE  "N"                  TO v|ُI|tO     
006450     END-EVALUATE.                                                
006460*                                                                 
006470     IF v|ُI|tO  =  "Y"                              
006480        PERFORM  ca[obN                             
006490*                                                                 
006500        PERFORM  IbZ[Wo                               
006510*                                                                 
006520*--<    vO^[R[h >                                
006530        MOVE  萔|ُ          TO  PROGRAM-STATUS          
006540*                                                                 
006550        EXIT  PROGRAM                                             
006560     END-IF.                                                      
006570*                                                                 
006580 G[|dwhs.                                            
006590     EXIT.                                                        
006600******************************************************************
006610*                  END OF PROGRAM                                *
006620******************************************************************
