USE [master]
GO
-- SQL CLRを有効にする
sp_configure 'clr enable',1
GO
RECONFIGURE
GO
-- cobdb データベースの作成
IF NOT EXISTS (select * from sys.databases where [name]= 'cobdb')
  CREATE DATABASE [cobdb]
GO
-- SQL CLRを使用するので互換レベルを最新にする
sp_dbcmptlevel 'cobdb',90
GO

USE [cobdb]
GO
-- SYAPF テーブルの作成
IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SYAPF]') AND type in (N'U'))
  DROP TABLE [dbo].[SYAPF]
GO
CREATE TABLE [dbo].[SYAPF](
	[SYACD] [int] NOT NULL,
	[SYANA] [nvarchar](20) NULL,
	[PASS]  [nvarchar](6) NULL,
	[BUSYO] [int] NULL,
	[SDATE] [int] NULL,
	[SNAME] [nvarchar](10) NULL,
 CONSTRAINT [PK_SYAPF] PRIMARY KEY CLUSTERED 
 (
	[SYACD] ASC
 ) WITH (PAD_INDEX  = OFF, IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
-- SYOIOPF テーブルの作成
IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SYOIOPF]') AND type in (N'U'))
  DROP TABLE [dbo].[SYOIOPF]
GO
CREATE TABLE [dbo].[SYOIOPF](
	[IODATE] [int] NOT NULL,
	[SYOCD]  [int] NOT NULL,
	[NODATE] [int] NULL,
	[SYUBAN] [int] NULL,
	[TUBAN]  [int] NULL,
	[KUBUN]  [int] NULL,
	[IOSU]   [int] NULL,
 CONSTRAINT [PK_SYOIOPF] PRIMARY KEY CLUSTERED 
 (
	[IODATE] ASC,
	[SYOCD] ASC
 ) WITH (PAD_INDEX  = OFF, IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
-- SYOPF テーブルの作成
IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SYOPF]') AND type in (N'U'))
  DROP TABLE [dbo].[SYOPF]
GO
CREATE TABLE [dbo].[SYOPF](
	[SYOCD] [int] NOT NULL,
	[SYONA] [nvarchar](20) NULL,
	[BAIKA] [int] NULL,
	[GENKA] [int] NULL,
 CONSTRAINT [PK_SYOPF] PRIMARY KEY CLUSTERED 
 (
	[SYOCD] ASC
 ) WITH (PAD_INDEX  = OFF, IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
-- SYAPF データの登録
INSERT INTO [dbo].[SYAPF]
           ([SYACD],[SYANA],[PASS],[BUSYO],[SDATE],[SNAME])
     VALUES (200004,N'富士通　太郎',N'200004',10,20010519,N'シスアド初')
GO
INSERT INTO [dbo].[SYAPF]
           ([SYACD],[SYANA],[PASS],[BUSYO],[SDATE],[SNAME])
     VALUES (200007,N'富士通　次郎',N'200007',10,20011028,N'基本情報処')
GO
INSERT INTO [dbo].[SYAPF]
           ([SYACD],[SYANA],[PASS],[BUSYO],[SDATE],[SNAME])
     VALUES (200011,N'富士通　三郎',N'200011',20,20021015,N'シスアド初')
GO
-- SYOIOPF データの登録
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040401,10024,20040301,1000020,1,11,40)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040402,10024,20040302,1000020,2,21,80)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040403,10024,20040303,1000020,3,31,120)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040404,10024,20040304,1000105,2,31,30)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040405,10024,20040305,1000105,3,39,70)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040406,10024,20040306,2000003,1,41,10)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040407,10024,20040307,2000003,4,44,90)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040409,10024,20040309,2000014,1,49,150)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040410,10024,20040310,2000014,2,51,60)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040411,10024,20040311,2000014,5,55,80)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040413,10024,20040313,2000014,6,59,110)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040415,10024,20040315,2000032,9,61,120)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040416,10024,20040316,2000032,11,69,80)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040417,10024,20040317,2000032,15,71,70)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040418,10024,20040318,2000032,16,59,90)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040419,10024,20040319,2000046,1,81,60)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040420,10024,20040320,2000046,7,55,10)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040421,10024,20040321,2000050,1,49,20)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040422,10024,20040322,2000050,2,51,10)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040423,10024,20040323,2000052,1,41,100)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040424,10024,20040324,2000053,1,11,15)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040425,10024,20040325,2000053,2,21,30)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040426,10024,20040326,2000053,3,39,50)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040427,10024,20040327,2000053,4,44,10)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040428,10024,20040328,2000055,1,55,10)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040429,10024,20040329,2000060,1,61,40)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040430,10024,20040330,2000061,1,71,60)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040401,10025,20040301,1000020,1,11,40)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040402,10025,20040302,1000020,2,21,80)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040403,10025,20040303,1000020,3,26,120)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040404,10025,20040304,1000105,2,31,30)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040405,10025,20040305,1000105,3,39,70)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040406,10025,20040306,2000003,1,41,10)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040407,10025,20040307,2000003,4,44,90)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040409,10025,20040309,2000014,1,49,150)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040410,10025,20040310,2000014,2,51,60)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040411,10025,20040311,2000014,5,55,80)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040413,10025,20040313,2000014,6,59,110)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040415,10025,20040315,2000032,9,61,120)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040416,10025,20040316,2000032,11,69,80)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040417,10025,20040317,2000032,15,71,70)
GO
INSERT INTO [dbo].[SYOIOPF]
           ([IODATE],[SYOCD],[NODATE],[SYUBAN],[TUBAN],[KUBUN],[IOSU])
     VALUES (20040418,10025,20040318,2000032,16,77,90)
GO
-- SYOPF データの登録
INSERT INTO [dbo].[SYOPF]
           ([SYOCD],[SYONA],[BAIKA],[GENKA])
     VALUES (10024,N'デジタル放送対応２０型ＴＶ',162000,125000)
GO
INSERT INTO [dbo].[SYOPF]
           ([SYOCD],[SYONA],[BAIKA],[GENKA])
     VALUES (10025,N'デジタル放送チューナー',62000,45000)
GO
INSERT INTO [dbo].[SYOPF]
           ([SYOCD],[SYONA],[BAIKA],[GENKA])
     VALUES (12345,N'ハイファイビデオ',162000,125000)
GO
-- NetCOBOL for .NET v3.0ランタイムの配置
IF NOT EXISTS (select * from sys.assemblies where [name]= 'Fujitsu.COBOL')
  CREATE ASSEMBLY [Fujitsu.COBOL] FROM 'C:\Program Files\Common Files\Fujitsu NetCOBOL for .NET Runtime V3.0\Runtime\Fujitsu.COBOL.dll'
GO
IF NOT EXISTS (select * from sys.assemblies where [name]= 'Fujitsu.COBOL.resources')
  CREATE ASSEMBLY [Fujitsu.COBOL.resources] FROM 'C:\Program Files\Common Files\Fujitsu NetCOBOL for .NET Runtime V3.0\Runtime\ja\Fujitsu.COBOL.resources.dll'
GO
