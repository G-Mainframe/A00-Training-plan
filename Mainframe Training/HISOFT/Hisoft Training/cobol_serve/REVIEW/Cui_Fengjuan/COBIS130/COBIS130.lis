Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

ファイル: COBIS130.PCOをオープン
     1  000010******************************************************************
     2  000020*         ＜ＮＮＮＮＮ＞                                         *
     3  000030*      1. プログラム名    ：資産コード変換マスタ移行処理         *
     4  000040*      2. プログラムID    ：COBIS130                             *
     5  000050*      3. 処理概要        ：提携先指定のコードからＢＯＴＬ資産   *
     6  000060*                           コードの変換テーブル                 *
     7  000070*                                                                *
     8  000080*      4. 作成者          ：ＮＮ                                 *
     9  000090*      5. 作成日          ：XXXX.XX.XX                           *
    10  000100******************************************************************
    11  000110*                                                                 
    12  000120******************************************************************
    13  000130*    ＩＤＥＮＴＩＦＩＣＡＴＩＯＮ  ＤＩＶＩＳＩＯＮ              *
    14  000140******************************************************************
    15  000150 IDENTIFICATION                       DIVISION.                   
    16  000160*                                                                 
    17  000170 PROGRAM-ID.                          COBIS130.                   
    18  000180******************************************************************
    19  000190*    ＥＮＶＩＲＯＮＭＥＮＴ        ＤＩＶＩＳＩＯＮ              *
    20  000200******************************************************************
    21  000210 ENVIRONMENT                          DIVISION.                   
    22  000220******************************************************************
    23  000230*    ＩＮＰＵＴ−ＯＵＴＰＵＴ      ＳＥＣＴＩＯＮ                *
    24  000240******************************************************************
    25  000250 INPUT-OUTPUT                         SECTION.                    
    26  000260 FILE-CONTROL.                                                    
    27  000270*                                                                 
    28  000280     SELECT         入力ファイル      ASSIGN    TO   U05          
    29  000290     FILE STATUS    IS     ファイル状態                           
    30  000300     ORGANIZATION   IS     LINE       SEQUENTIAL.                 
    31  000310*                                                                 
    32  000320******************************************************************
    33  000330*    ＤＡＴＡ                      ＤＩＶＩＳＩＯＮ              *
    34  000340******************************************************************
    35  000350 DATA                                 DIVISION.                   
    36  000360******************************************************************
    37  000370*    ＦＩＬＥ                      ＳＥＣＴＩＯＮ                *
    38  000380******************************************************************
    39  000390 FILE                                 SECTION.                    
    40  000400*----------------------------------------------------------------*
    41  000410*    入力ファイル                                                *
    42  000420*----------------------------------------------------------------*
    43  000430 FD  入力ファイル                                                 
    44  000440     LABEL  RECORD    IS              STANDARD                    
    45  000450     BLOCK  CONTAINS  0               RECORDS.                    
    46  000460*                                                                 
    47  000470 01  入力−レコード.                                              
    48  000480     COPY   CISPF001   REPLACING      ==()==  BY  ==入力−==.     
    49  000490*                                                                 
    50  000500******************************************************************
    51  000510*  ＷＯＲＫＩＮＧ−ＳＴＯＲＡＧＥ  ＳＥＣＴＩＯＮ                *
    52  000520******************************************************************
    53  000530 WORKING-STORAGE                      SECTION.                    
    54  000540*----------------------------------------------------------------*
    55  000550*    ホスト変数定義エリア                                        *
    56  000560*----------------------------------------------------------------*
    57  000570     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
    58  000580*                                                                 
    59  000590 01  ＷＳ−ジョモ商品                 PIC  X(08) VALUE "K3401966".
    60  000600*                                                                 
    61  000610*--< ＯＲＡＣＬＥ共通変数 >                                       
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    62  000620     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
    63  000630*                                                                 
    64  000640*--< ジョモ商品マスタ >                                           
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをオープン
     1  000010*--＜ＳＱＬ共通変数＞
     2  000030   01  SQLSTATE                      PIC  X(005).
     3  000040   01  DB-STRING                     PIC  X(020).
     4  000050   01  USERNAME                      PIC  X(010).
     5  000060   01  PASSWD                        PIC  X(010).
     6  000070*
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをクローズ
    65  000650     EXEC  SQL  INCLUDE  JOM_SYOHIN_MST.CBL    END-EXEC.          
    66  000660*                                                                 
    67  000670*--< 転リース提携先コード変換テーブル >                           
ファイル: Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBLをオープン
     1  000010************************************************
     2  000020* (JOM_SYOHIN_MST)
     3  000030************************************************
     4  000040 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−ジョモ商品コード PIC  X(004).
     5  000050 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−ジョモ商品分類名 PIC  X(030).
     6  000060 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−物件名−漢字 PIC  X(040).
     7  000070 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−物件名 PIC  X(020).
     8  000080 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−機種名 PIC  X(020).
     9  000090 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−資産コード PIC  X(007).
    10  000100 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−耐用年数 PIC  X(002).
    11  000110 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−税区分 PIC  X(001).
    12  000120 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−固定資産税率 
    13                                               PIC S9(002)V9(1) COMP-3.
    14  000130 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−保険料率 
    15                                               PIC S9(002)V9(3) COMP-3.
    16  000140 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−動総保険コード PIC  X(004).
    17  000150 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−信用保険コード−リース 
    18                                               PIC  X(006).
    19  000160 01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−信用保険コード−割賦 
    20                                               PIC  X(006).
ファイル: Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBLをクローズ
    68  000680     EXEC  SQL  INCLUDE  IKOTBL004.CBL         END-EXEC.          
    69  000690*                                                                 
    70  000700*--< 資産コード変換マスタ >                                       
ファイル: Z:\COB97\COPYLIB_DB\IKOTBL004.CBLをオープン
     1  000010************************************************
     2  000020* 転リース提携先コード変換テーブル(IKOTBL004)
     3  000030************************************************
     4  000040 01  ＩＫＯ００４−取引先コード PIC  X(008).
     5  000050 01  ＩＫＯ００４−転リース提携先コード PIC  X(003).
ファイル: Z:\COB97\COPYLIB_DB\IKOTBL004.CBLをクローズ
    71  000710     EXEC  SQL  INCLUDE  D077SSH.CBL           END-EXEC.          
    72  000720*                                                                 
    73  000730*--< ＯＲＡＣＬＥ ＳＱＬ実行情報 (SQLCA) >                        
ファイル: Z:\COB97\COPYLIB_DB\D077SSH.CBLをオープン
     1        *****************************************************************
     2        *   資産コード変換マスタ(D077SSH_TBL)
     3        *****************************************************************
     4         01  資産コード変換マスタ.
     5             03  Ｄ０７７−転リース提携先コード
     6                                       PIC  X(003).
     7             03  Ｄ０７７−先方商品コード
     8                                       PIC  X(010).
     9             03  Ｄ０７７−適用年月日  PIC  X(008).
    10             03  Ｄ０７７−資産コード  PIC  X(007).
    11             03  Ｄ０７７−動総保険コード
    12                                       PIC  X(004).
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    13             03  Ｄ０７７−信用保険コード−リース
    14                                       PIC  X(006).
    15             03  Ｄ０７７−信用保険コード−割賦
    16                                       PIC  X(006).
    17             03  Ｄ０７７−税負担区分  PIC  X(001).
    18             03  Ｄ０７７−商品分類名  PIC  X(030).
    19             03  Ｄ０７７−物件名漢字  PIC  X(040).
    20             03  Ｄ０７７−物件名      PIC  X(020).
    21             03  Ｄ０７７−機種名      PIC  X(020).
    22             03  Ｄ０７７−登録年月日  PIC  X(008).
    23             03  Ｄ０７７−登録時間    PIC  X(008).
    24             03  Ｄ０７７−登録担当者  PIC  X(008).
    25             03  Ｄ０７７−更新年月日  PIC  X(008).
    26             03  Ｄ０７７−更新時間    PIC  X(008).
    27             03  Ｄ０７７−更新者      PIC  X(008).
    28             03  Ｄ０７７−入力担当者コード
    29                                       PIC  X(008).
ファイル: Z:\COB97\COPYLIB_DB\D077SSH.CBLをクローズ
    74  000740     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
    75  000750*                                                                 
    76  000760     EXEC  SQL  END      DECLARE      SECTION  END-EXEC.          
    77  000770*----------------------------------------------------------------*
    78  000780*   作業領域定義                                                 *
    79  000790*----------------------------------------------------------------*
    80  000800 01  ＷＯＲＫ−エリア.                                            
    81  000810*--< エラーコード >                                               
    82  000820     03  Ｗ−エラーコード             PIC S9(04).                 
    83  000830*                                                                 
    84  000840*--< ファイル状態 >                                               
    85  000850     03  ファイル状態                 PIC  X(02).                 
    86  000860*                                                                 
    87  000870*--< 件数エリア >                                                 
    88  000880     03  件数エリア.                                              
    89  000890         05  Ｗ−入力−件数１         PIC  9(09).                 
    90  000900         05  Ｗ−入力−件数２         PIC  9(09).                 
    91  000910         05  Ｗ−出力−件数           PIC  9(09).                 
    92  000920*                                                                 
    93  000930*--< フラグアリア >                                               
    94  000940     03  フラグ−エリア.                                          
    95  000950         05  Ｗ−終了−フラグ         PIC  X(01).                 
    96  000960         05  Ｗ−終了−フラグ１       PIC  X(01).                 
    97  000970         05  異常終了−フラグ         PIC  X(01).                 
    98  000980*                                                                 
    99  000990*--< ファイル状態 >                                               
   100  001000     03  Ｗ−適用日                   PIC  X(08).                 
   101  001010*                                                                 
   102  001020*----------------------------------------------------------------*
   103  001030*   処理時間定義                                                 *
   104  001040*----------------------------------------------------------------*
   105  001050*--< 共通情報 >                                                   
   106  001060 01  Ｗ−共通情報.                                                
   107  001070     03  Ｗ−システム日付.                                        
   108  001080         05  Ｗ−世紀                 PIC  X(02) VALUE  "20".     
   109  001090         05  Ｗ−年月日               PIC  X(06).                 
   110  001100     03  Ｗ−システム時刻             PIC  X(08).                 
   111  001110     03  Ｗ−担当者                   PIC  X(08) VALUE "IKOPG   ".
   112  001120*----------------------------------------------------------------*
   113  001130*    サブルーチン名                                              *
   114  001140*----------------------------------------------------------------*
   115  001150 01  CALL-AREA.                                                   
   116  001160*--< 共通ログサブルーチン >                                       
   117  001170     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   118  001180     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
   119  001190*----------------------------------------------------------------*
   120  001200*    ＣＯＰＹ領域                                                *
   121  001210*----------------------------------------------------------------*
   122  001220*--< 共通ログ用パラメータ >                                       
   123  001230 01  IF-CHOCO001.                                                 
   124  001240     COPY  CHOCO001  REPLACING  ==()==  BY  ==共１−==.           
   125  001250*                                                                 
   126  001260*----------------------------------------------------------------*
   127  001270*    ＩＮＩファイル読込サブルーチン用パラメタ領域                *
   128  001280*----------------------------------------------------------------*
   129  001290 01  PARA-AREA.                                                   
   130  001300     COPY CPBCO001.                                               
   131  001310******************************************************************
   132  001320*    定数用データ定義エリア                                      *
   133  001330******************************************************************
   134  001340 CONSTANT                             SECTION.                    
   135  001350 01  定数領域.                                                    
   136  001360     03  定数−プログラムＩＤ         PIC  X(08) VALUE "COBIS130".
   137  001370     03  定数−プログラム名           PIC  X(80)                  
   138  001380                                VALUE  "資産コード変換マスタ移行".
   139  001390     03  定数−ＳＱＬＯＫ             PIC  9(04)  VALUE  0000.    
   140  001400     03  定数−ＳＱＬＥＮＤ           PIC  9(04)  VALUE  0100.    
   141  001410     03  定数−正常状態               PIC  9(04)  VALUE  ZERO.    
   142  001420     03  定数−異常状態               PIC  9(04)  VALUE  0009.    
   143  001430******************************************************************
   144  001440*    ＰＲＯＣＥＤＵＲＥ            ＤＩＶＩＳＩＯＮ              *
   145  001450******************************************************************
   146  001460 PROCEDURE                            DIVISION.                   
   147  001470*                                                                 
   148  001480     PERFORM   初期処理.                                          
   149  001490*                                                                 
   150  001500     PERFORM   主処理  UNTIL  Ｗ−終了−フラグ  =  "Y".           
   151  001510*                                                                 
   152  001520     PERFORM   終了処理.                                          
   153  001530*                                                                 
   154  001540     STOP RUN.                                                    
   155  001550*                                                                 
   156  001560******************************************************************
   157  001570*    初期処理                                            <1.0>   *
   158  001580******************************************************************
   159  001590 初期処理                             SECTION.                    
   160  001600 初期処理−ＳＴＡＲＴ.                                            
   161  001610*                                                                 
   162  001620*----------------------------------------------------------------*
   163  001630*    開始メッセージ出力                                          *
   164  001640*----------------------------------------------------------------*
   165  001650     INITIALIZE                       IF-CHOCO001.                
   166  001660     MOVE  "3"                        TO  共１−イベント種別.     
   167  001670     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   168  001680     MOVE  "0"                        TO  共１−復帰コード.       
   169  001690     MOVE  "START"                    TO  共１−処理識別.         
   170  001700     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
   171  001710     CALL  CLOCO001                USING  IF-CHOCO001.            
   172  001720*                                                                 
   173  001730*----------------------------------------------------------------*
   174  001740*    作業領域の初期値設定                                        *
   175  001750*----------------------------------------------------------------*
   176  001760     MOVE  SPACE                      TO  ＷＯＲＫ−エリア.       
   177  001770     INITIALIZE                           ＷＯＲＫ−エリア.       
   178  001780*                                                                 
   179  001790*--< ＣＰＵ日付を取得 >                                           
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   180  001800     ACCEPT  Ｗ−年月日               FROM  DATE.                 
   181  001810*                                                                 
   182  001820*--< ＣＰＵ時刻を取得 >                                           
   183  001830     ACCEPT  Ｗ−システム時刻         FROM  TIME.                 
   184  001840*----------------------------------------------------------------*
   185  001850*    ＯＲＡＣＬＥ接続                                    <1.1>   *
   186  001860*----------------------------------------------------------------*
   187  001870     PERFORM  ＯＲＡＣＬＥ接続.                                   
   188  001880*                                                                 
   189  001890*----------------------------------------------------------------*
   190  001900*    カーソル宣言                                        <1.2>   *
   191  001910*----------------------------------------------------------------*
   192  001920     PERFORM  カーソル宣言.                                       
   193  001930*                                                                 
   194  001940*--< ファイルオープン >                                           
   195  001950     OPEN  INPUT  入力ファイル.                                   
   196  001960*                                                                 
   197  001970*----------------------------------------------------------------*
   198  001980*    ファイルオープン状態判定                                    *
   199  001990*----------------------------------------------------------------*
   200  002000     EVALUATE  ファイル状態                                       
   201  002010        WHEN  ZERO                                                
   202  002020           CONTINUE                                               
   203  002030        WHEN  OTHER                                               
   204  002040*--<       ファイルオープンエラー >                               
   205  002050           MOVE     -1                TO  Ｗ−エラーコード        
   206  002060           PERFORM  エラー処理                                    
   207  002070     END-EVALUATE.                                                
   208  002080*----------------------------------------------------------------*
   209  002090*    ジョモ商品読込処理(１件目)                          <C.1>   *
   210  002100*----------------------------------------------------------------*
   211  002110     PERFORM   ジョモ商品読込処理.                                
   212  002120*                                                                 
   213  002130*----------------------------------------------------------------*
   214  002140*    基準適用日読込処理(１件目)                          <C.2>   *
   215  002150*----------------------------------------------------------------*
   216  002160     PERFORM   基準適用日読込処理.                                
   217  002170*                                                                 
   218  002180 初期処理−ＥＸＩＴ.                                              
   219  002190     EXIT.                                                        
   220  002200******************************************************************
   221  002210*    主処理                                              <2.0>   *
   222  002220******************************************************************
   223  002230 主処理                               SECTION.                    
   224  002240 主処理−ＳＴＡＲＴ.                                              
   225  002250*                                                                 
   226  002260*----------------------------------------------------------------*
   227  002270*    編集処理                                            <2.1>   *
   228  002280*----------------------------------------------------------------*
   229  002290     PERFORM  編集処理.                                           
   230  002300*                                                                 
   231  002310*----------------------------------------------------------------*
   232  002320*    資産コード変換マスタ追加処理                        <2.2>   *
   233  002330*----------------------------------------------------------------*
   234  002340     PERFORM  資産コード変換マスタ追加処理.                       
   235  002350*                                                                 
   236  002360*----------------------------------------------------------------*
   237  002370*    ジョモ商品読込処理. (２件目以降)                    <C.1>   *
   238  002380*----------------------------------------------------------------*
   239  002390     PERFORM   ジョモ商品読込処理.                                
   240  002400*                                                                 
   241  002410 主処理−ＥＸＩＴ.                                                
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   242  002420     EXIT.                                                        
   243  002430******************************************************************
   244  002440*    終了処理                                            <3.0>   *
   245  002450******************************************************************
   246  002460 終了処理                             SECTION.                    
   247  002470 終了処理−ＳＴＡＲＴ.                                            
   248  002480*                                                                 
   249  002490*----------------------------------------------------------------*
   250  002500*    ＤＢクローズ                                        <3.1>   *
   251  002510*----------------------------------------------------------------*
   252  002520     PERFORM   ＤＢクローズ.                                      
   253  002530*                                                                 
   254  002540*----------------------------------------------------------------*
   255  002550*    ＤＢコミット処理                                    <3.2>   *
   256  002560*----------------------------------------------------------------*
   257  002570     PERFORM   ＤＢコミット処理.                                  
   258  002580*                                                                 
   259  002590*--< ファイルクローズ >                                           
   260  002600     CLOSE  入力ファイル.                                         
   261  002610*                                                                 
   262  002620*----------------------------------------------------------------*
   263  002630*    終了メッセージ出力処理                              <C.3>   *
   264  002640*----------------------------------------------------------------*
   265  002650     PERFORM  終了メッセージ出力.                                 
   266  002660*                                                                 
   267  002670*--< プログラム正常終了 >                                         
   268  002680     MOVE  定数−正常状態             TO  PROGRAM-STATUS.         
   269  002690*                                                                 
   270  002700 終了処理−ＥＸＩＴ.                                              
   271  002710     EXIT.                                                        
   272  002720******************************************************************
   273  002730*    終了メッセージ出力                                  <C.3>   *
   274  002740******************************************************************
   275  002750  終了メッセージ出力                  SECTION.                    
   276  002760  終了メッセージ出力−ＳＴＡＲＴ.                                 
   277  002770*                                                                 
   278  002780*----------------------------------------------------------------*
   279  002790*    ジョモ商品マスタ入力件数                                    *
   280  002800*----------------------------------------------------------------*
   281  002810     INITIALIZE                       IF-CHOCO001.                
   282  002820     MOVE  "3"                        TO  共１−イベント種別.     
   283  002830     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   284  002840     MOVE  "0"                        TO  共１−復帰コード.       
   285  002850     MOVE  "JOM_MST"                  TO  共１−処理テーブルＩＤ. 
   286  002860     MOVE  "COUNT"                    TO  共１−処理識別.         
   287  002870     MOVE  Ｗ−入力−件数１           TO  共１−データ内容.       
   288  002880     MOVE  "ジョモ商品マスタ読込件数" TO  共１−その他メッセージ. 
   289  002890     CALL  CLOCO001                USING  IF-CHOCO001.            
   290  002900*                                                                 
   291  002910*----------------------------------------------------------------*
   292  002920*    基準適用日ファイル入力件数                                  *
   293  002930*----------------------------------------------------------------*
   294  002940     INITIALIZE                       IF-CHOCO001.                
   295  002950     MOVE  "3"                        TO  共１−イベント種別.     
   296  002960     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   297  002970     MOVE  "0"                        TO  共１−復帰コード.       
   298  002980     MOVE  "FFUSIA01"                  TO  共１−処理テーブルＩＤ. 
   299  002990     MOVE  "COUNT"                    TO  共１−処理識別.         
   300  003000     MOVE  Ｗ−入力−件数２           TO  共１−データ内容.       
   301  003010     MOVE  "基準適用日ファイル読込件数"                           
   302  003020                                      TO  共１−その他メッセージ. 
   303  003030     CALL  CLOCO001                USING  IF-CHOCO001.            
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   304  003040*                                                                 
   305  003050*----------------------------------------------------------------*
   306  003060*    資産コード変換マスタ出力件数                                *
   307  003070*----------------------------------------------------------------*
   308  003080     INITIALIZE                       IF-CHOCO001.                
   309  003090     MOVE  "3"                        TO  共１−イベント種別.     
   310  003100     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   311  003110     MOVE  "0"                        TO  共１−復帰コード.       
   312  003120     MOVE  "D077SSH"                  TO  共１−処理テーブルＩＤ. 
   313  003130     MOVE  "COUNT"                    TO  共１−処理識別.         
   314  003140     MOVE  Ｗ−出力−件数             TO  共１−データ内容.       
   315  003150     MOVE  "資産コード変換マスタ出力件数"                         
   316  003160                                      TO  共１−その他メッセージ. 
   317  003170     CALL  CLOCO001                USING  IF-CHOCO001.            
   318  003180*                                                                 
   319  003190*----------------------------------------------------------------*
   320  003200*    終了メッセージ 出力                                         *
   321  003210*----------------------------------------------------------------*
   322  003220     INITIALIZE                       IF-CHOCO001.                
   323  003230     MOVE  "3"                        TO  共１−イベント種別.     
   324  003240     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   325  003250     MOVE  "0"                        TO  共１−復帰コード.       
   326  003260     MOVE  "END"                      TO  共１−処理識別.         
   327  003270     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
   328  003280     CALL  CLOCO001                USING  IF-CHOCO001.            
   329  003290*                                                                 
   330  003300 終了メッセージ出力−ＥＸＩＴ.                                    
   331  003310     EXIT.                                                        
   332  003320******************************************************************
   333  003330*    ＯＲＡＣＬＥ接続                                    <1.1>   *
   334  003340******************************************************************
   335  003350 ＯＲＡＣＬＥ接続                     SECTION.                    
   336  003360 ＯＲＡＣＬＥ接続−ＳＴＡＲＴ.                                    
   337  003370*                                                                 
   338  003380*--< ＩＮＩファイル読込サブルーチン呼び出し >                     
   339  003390     CALL  COBCO001                USING  PARA-AREA.              
   340  003400*                                                                 
   341  003410     MOVE  PARA-DBSTRING              TO  DB-STRING.              
   342  003420     MOVE  PARA-USERNAME              TO  USERNAME.               
   343  003430     MOVE  PARA-PASSWORD              TO  PASSWD.                 
   344  003440*                                                                 
   345  003450*----------------------------------------------------------------*
   346  003460*    開始接続                                                    *
   347  003470*----------------------------------------------------------------*
   348  003480     IF  DB-STRING  =  SPACE                                      
   349  003490        EXEC  SQL                                                 
   350  003500           CONNECT  :USERNAME  IDENTIFIED  BY  :PASSWD            
   351  003510        END-EXEC                                                  
   352  003520     ELSE                                                         
   353  003530        EXEC  SQL                                                 
   354  003540           CONNECT  :USERNAME  IDENTIFIED  BY  :PASSWD            
   355  003550             USING  :DB-STRING                                    
   356  003560        END-EXEC                                                  
   357  003570     END-IF.                                                      
   358  003580*                                                                 
   359  003590*----------------------------------------------------------------*
   360  003600*    接続状態判定                                                *
   361  003610*----------------------------------------------------------------*
   362  003620     EVALUATE  SQLCODE                                            
   363  003630        WHEN  定数−ＳＱＬＯＫ                                    
   364  003640*--<       接続正常 >                                             
   365  003650           CONTINUE                                               
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   366  003660        WHEN  OTHER                                               
   367  003670*--<       接続エラー >                                           
   368  003680           MOVE     -10               TO  Ｗ−エラーコード        
   369  003690           PERFORM  エラー処理                                    
   370  003700     END-EVALUATE.                                                
   371  003710*                                                                 
   372  003720 ＯＲＡＣＬＥ接続−ＥＸＩＴ.                                      
   373  003730     EXIT.                                                        
   374  003740******************************************************************
   375  003750*    カーソル宣言                                        <1.2>   *
   376  003760******************************************************************
   377  003770*                                                                 
   378  003780 カーソル宣言                         SECTION.                    
   379  003790 カーソル宣言−ＳＴＡＲＴ.                                        
   380  003800*                                                                 
   381  003810*----------------------------------------------------------------*
   382  003820*    カーソル宣言                                                *
   383  003830*----------------------------------------------------------------*
   384  003840     EXEC  SQL                                                    
   385  003850        DECLARE  CUR1  CURSOR  FOR                                
   386  003860           SELECT  ジョモ商品コード                               
   387  003870                  ,ジョモ商品分類名                               
   388  003880                  ,物件名＿漢字                                   
   389  003890                  ,物件名                                         
   390  003900                  ,機種名                                         
   391  003910                  ,税区分                                         
   392  003920                  ,資産コード                                     
   393  003930                  ,動総保険コード                                 
   394  003940                  ,信用保険コード＿リース                         
   395  003950                  ,信用保険コード＿割賦                           
   396  003960             FROM  JOM_SYOHIN_MST                                 
   397  003970     END-EXEC.                                                    
   398  003980*                                                                 
   399  003990*----------------------------------------------------------------*
   400  004000*    カーソルオープン                                            *
   401  004010*----------------------------------------------------------------*
   402  004020     EXEC  SQL                                                    
   403  004030        OPEN  CUR1                                                
   404  004040     END-EXEC.                                                    
   405  004050*                                                                 
   406  004060*----------------------------------------------------------------*
   407  004070*    カーソルオープンを確認                                      *
   408  004080*----------------------------------------------------------------*
   409  004090     EVALUATE   SQLCODE                                           
   410  004100        WHEN   定数−ＳＱＬＯＫ                                   
   411  004110*--<       正常 >                                                 
   412  004120           CONTINUE                                               
   413  004130        WHEN   OTHER                                              
   414  004140*--<       カーソルオープン失敗、プログラムが異常終了 >           
   415  004150           MOVE      -20              TO  Ｗ−エラーコード        
   416  004160           PERFORM   エラー処理                                   
   417  004170     END-EVALUATE.                                                
   418  004180*                                                                 
   419  004190 カーソル宣言−ＥＸＩＴ.                                          
   420  004200     EXIT.                                                        
   421  004210******************************************************************
   422  004220*    ジョモ商品読込処理                                  <C.1>   *
   423  004230******************************************************************
   424  004240 ジョモ商品読込処理                   SECTION.                    
   425  004250 ジョモ商品読込処理−ＳＴＡＲＴ.                                  
   426  004260*                                                                 
   427  004270     EXEC  SQL                                                    
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   428  004280        FETCH  CUR1                                               
   429  004290           INTO                                                   
   430  004300             :ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−ジョモ商品コード      
   431  004310            ,:ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−ジョモ商品分類名      
   432  004320            ,:ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−物件名−漢字          
   433  004330            ,:ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−物件名                
   434  004340            ,:ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−機種名                
   435  004350            ,:ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−税区分                
   436  004360            ,:ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−資産コード            
   437  004370            ,:ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−動総保険コード        
   438  004380            ,:ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−信用保険コード−リース
   439  004390            ,:ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−信用保険コード−割賦  
   440  004400     END-EXEC.                                                    
   441  004410*                                                                 
   442  004420*----------------------------------------------------------------*
   443  004430*    ジョモ商品読込確認                                          *
   444  004440*----------------------------------------------------------------*
   445  004450     EVALUATE  SQLCODE                                            
   446  004460        WHEN  定数−ＳＱＬＯＫ                                    
   447  004470*--<       正常 >                                                 
   448  004480           COMPUTE   Ｗ−入力−件数１ =  Ｗ−入力−件数１ +  1    
   449  004490        WHEN  定数−ＳＱＬＥＮＤ                                  
   450  004500*--<       読込終了 >                                             
   451  004510           MOVE      "Y"              TO  Ｗ−終了−フラグ        
   452  004520        WHEN  OTHER                                               
   453  004530*--<       読込エラー、プログラムが異常終了 >                     
   454  004540           MOVE      -30              TO  Ｗ−エラーコード        
   455  004550           PERFORM   エラー処理                                   
   456  004560     END-EVALUATE.                                                
   457  004570*                                                                 
   458  004580 ジョモ商品読込処理−ＥＸＩＴ.                                    
   459  004590     EXIT.                                                        
   460  004600******************************************************************
   461  004610*    基準適用日読込処理                                  <C.2>   *
   462  004620******************************************************************
   463  004630 基準適用日読込処理                   SECTION.                    
   464  004640 基準適用日読込処理−ＳＴＡＲＴ.                                  
   465  004650*--<    基準適用日読込 >                                          
   466  004660        READ  入力ファイル                                        
   467  004670           AT  END                                                
   468  004680*--<          読込終了 >                                          
   469  004690              MOVE  "Y"               TO  Ｗ−終了−フラグ１      
   470  004700              GO  TO  基準適用日読込処理−ＥＸＩＴ                
   471  004710           NOT  AT  END                                           
   472  004720              COMPUTE  Ｗ−入力−件数２  =  Ｗ−入力−件数２ + 1  
   473  004730        END-READ.                                                 
   474  004740*                                                                 
   475  004750*----------------------------------------------------------------*
   476  004760*    ファイルオープン状態判定                                    *
   477  004770*----------------------------------------------------------------*
   478  004780     EVALUATE  ファイル状態                                       
   479  004790        WHEN  ZERO                                                
   480  004800           MOVE  入力−適用日         TO  Ｗ−適用日              
   481  004810        WHEN  OTHER                                               
   482  004820*--<       読み込みエラー >                                       
   483  004830           MOVE     ZERO              TO  Ｗ−適用日              
   484  004840           MOVE     -2                TO  Ｗ−エラーコード        
   485  004850           PERFORM  エラー処理                                    
   486  004860     END-EVALUATE.                                                
   487  004870*                                                                 
   488  004880 基準適用日読込処理−ＥＸＩＴ.                                    
   489  004890     EXIT.                                                        
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   490  004900******************************************************************
   491  004910*    編集処理                                            <2.1>   *
   492  004920******************************************************************
   493  004930 編集処理                             SECTION.                    
   494  004940 編集処理−ＳＴＡＲＴ.                                            
   495  004950*                                                                 
   496  004960*--< 出力レコードを初期化 >                                       
   497  004970*                                                                 
   498  004980     MOVE  SPACE                      TO  資産コード変換マスタ.   
   499  004990     INITIALIZE                           資産コード変換マスタ.   
   500  005000*----------------------------------------------------------------*
   501  005010*    転リースコード取得処理                              <2.1.1> *
   502  005020*----------------------------------------------------------------*
   503  005030     PERFORM       転リースコード取得処理.                        
   504  005040*                                                                 
   505  005050*----------------------------------------------------------------*
   506  005060*    編集処理                                                    *
   507  005070*----------------------------------------------------------------*
   508  005080     MOVE  ＩＫＯ００４−転リース提携先コード                     
   509  005090                             TO  Ｄ０７７−転リース提携先コード.  
   510  005100*                                                                 
   511  005110     MOVE  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−ジョモ商品コード         
   512  005120                             TO  Ｄ０７７−先方商品コード.        
   513  005130*                                                                 
   514  005140     MOVE  Ｗ−適用日        TO  Ｄ０７７−適用年月日.            
   515  005150*                                                                 
   516  005160     MOVE  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−資産コード               
   517  005170                             TO  Ｄ０７７−資産コード.            
   518  005180*                                                                 
   519  005190     MOVE  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−動総保険コード           
   520  005200                             TO  Ｄ０７７−動総保険コード.        
   521  005210*                                                                 
   522  005220     MOVE  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−信用保険コード−リース   
   523  005230                             TO  Ｄ０７７−信用保険コード−リース.
   524  005240*                                                                 
   525  005250     MOVE  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−信用保険コード−割賦     
   526  005260                             TO  Ｄ０７７−信用保険コード−割賦.  
   527  005270*                                                                 
   528  005280*----------------------------------------------------------------*
   529  005290*    税区分判定                                                  *
   530  005300*----------------------------------------------------------------*
   531  005310     EVALUATE  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−税区分               
   532  005320*--<    "0"非課税 >                                               
   533  005330        WHEN  "0"                                                 
   534  005340           MOVE    "0"                TO  Ｄ０７７−税負担区分    
   535  005350*--<    "1"非課税 >                                               
   536  005360        WHEN  "1"                                                 
   537  005370           MOVE    "1"                TO  Ｄ０７７−税負担区分    
   538  005380*--<    "2"非課税 >                                               
   539  005390        WHEN  "2"                                                 
   540  005400           MOVE    "2"                TO  Ｄ０７７−税負担区分    
   541  005410*--<    "3"非課税 >                                               
   542  005420        WHEN  "3"                                                 
   543  005430           MOVE    "3"                TO  Ｄ０７７−税負担区分    
   544  005440*--<    "4"非課税 >                                               
   545  005450        WHEN  "4"                                                 
   546  005460           MOVE    "4"                TO  Ｄ０７７−税負担区分    
   547  005470     END-EVALUATE.                                                
   548  005480*                                                                 
   549  005490     MOVE  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−ジョモ商品分類名         
   550  005500                                      TO  Ｄ０７７−商品分類名.   
   551  005510     MOVE  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−物件名−漢字             
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   552  005520                                      TO  Ｄ０７７−物件名漢字.   
   553  005530     MOVE  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−物件名                   
   554  005540                                      TO  Ｄ０７７−物件名.       
   555  005550     MOVE  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−機種名                   
   556  005560                                      TO  Ｄ０７７−機種名.       
   557  005570     MOVE  Ｗ−システム日付           TO  Ｄ０７７−登録年月日.   
   558  005580     MOVE  Ｗ−システム時刻           TO  Ｄ０７７−登録時間.     
   559  005590     MOVE  Ｗ−担当者                 TO  Ｄ０７７−登録担当者.   
   560  005600     MOVE  Ｗ−システム日付           TO  Ｄ０７７−更新年月日.   
   561  005610     MOVE  Ｗ−システム時刻           TO  Ｄ０７７−更新時間.     
   562  005620     MOVE  Ｗ−担当者                 TO  Ｄ０７７−更新者.       
   563  005630     MOVE  Ｗ−担当者                 TO                          
   564  005640                                      Ｄ０７７−入力担当者コード. 
   565  005650*                                                                 
   566  005660 編集処理−ＥＸＩＴ.                                              
   567  005670     EXIT.                                                        
   568  005680******************************************************************
   569  005690*    転リースコード取得処理                              <2.1.1> *
   570  005700******************************************************************
   571  005710 転リースコード取得処理               SECTION.                    
   572  005720 転リースコード取得処理−ＳＴＡＲＴ.                              
   573  005730                                                                  
   574  005740     MOVE  SPACE                      TO                          
   575  005750                               ＩＫＯ００４−転リース提携先コード.
   576  005760*--< 転リース提携先コード取得 >                                   
   577  005770     EXEC SQL                                                     
   578  005780        SELECT  転リース提携先コード                              
   579  005790          INTO :ＩＫＯ００４−転リース提携先コード                
   580  005800          FROM  IKOTBL004                                         
   581  005810        WHERE   取引先コード  =  :ＷＳ−ジョモ商品                
   582  005820     END-EXEC.                                                    
   583  005830*                                                                 
   584  005840*--< 転リーステーブル読込確認 >                                   
   585  005850     EVALUATE  SQLCODE                                            
   586  005860        WHEN  定数−ＳＱＬＯＫ                                    
   587  005870*--<       正常 >                                                 
   588  005880           CONTINUE                                               
   589  005890        WHEN  OTHER                                               
   590  005900*--<       転リース提携先コードを取得しない >                     
   591  005910           MOVE      -40              TO  Ｗ−エラーコード        
   592  005920           PERFORM   エラー処理                                   
   593  005930           MOVE  ZERO                 TO                          
   594  005940                               ＩＫＯ００４−転リース提携先コード 
   595  005950     END-EVALUATE.                                                
   596  005960*                                                                 
   597  005970 転リースコード取得処理−ＥＸＩＴ.                                
   598  005980     EXIT.                                                        
   599  005990******************************************************************
   600  006000*    資産コード変換マスタ追加処理                        <2.2>   *
   601  006010******************************************************************
   602  006020 資産コード変換マスタ追加処理         SECTION.                    
   603  006030 資産コード変換マスタ追加処理−ＳＴＡＲＴ.                        
   604  006040*                                                                 
   605  006050     EXEC  SQL                                                    
   606  006060        INSERT  INTO  D077SSH_TBL                                 
   607  006070           (転リース提携先コード                                  
   608  006080           ,先方商品コード                                        
   609  006090           ,適用年月日                                            
   610  006100           ,資産コード                                            
   611  006110           ,動総保険コード                                        
   612  006120           ,信用保険コード＿リース                                 
   613  006130           ,信用保険コード＿割賦                                   
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   614  006140           ,税負担区分                                            
   615  006150           ,商品分類名                                            
   616  006160           ,物件名漢字                                            
   617  006170           ,物件名                                                
   618  006180           ,機種名                                                
   619  006190           ,登録年月日                                            
   620  006200           ,登録時間                                              
   621  006210           ,登録担当者                                            
   622  006220           ,更新年月日                                            
   623  006230           ,更新時間                                              
   624  006240           ,更新者                                                
   625  006250           ,入力担当者コード)                                     
   626  006260       VALUES                                                     
   627  006270           (:Ｄ０７７−転リース提携先コード                       
   628  006280           ,:Ｄ０７７−先方商品コード                             
   629  006290           ,:Ｄ０７７−適用年月日                                 
   630  006300           ,:Ｄ０７７−資産コード                                 
   631  006310           ,:Ｄ０７７−動総保険コード                             
   632  006320           ,:Ｄ０７７−信用保険コード−リース                     
   633  006330           ,:Ｄ０７７−信用保険コード−割賦                       
   634  006340           ,:Ｄ０７７−税負担区分                                 
   635  006350           ,:Ｄ０７７−商品分類名                                 
   636  006360           ,:Ｄ０７７−物件名漢字                                 
   637  006370           ,:Ｄ０７７−物件名                                     
   638  006380           ,:Ｄ０７７−機種名                                     
   639  006390           ,:Ｄ０７７−登録年月日                                 
   640  006400           ,:Ｄ０７７−登録時間                                   
   641  006410           ,:Ｄ０７７−登録担当者                                 
   642  006420           ,:Ｄ０７７−更新年月日                                 
   643  006430           ,:Ｄ０７７−更新時間                                   
   644  006440           ,:Ｄ０７７−更新者                                     
   645  006450           ,:Ｄ０７７−入力担当者コード)                          
   646  006460     END-EXEC.                                                    
   647  006470*                                                                 
   648  006480*----------------------------------------------------------------*
   649  006490*    ＤＢ追加処理を確認                                          *
   650  006500*----------------------------------------------------------------*
   651  006510     EVALUATE  SQLCODE                                            
   652  006520        WHEN   定数−ＳＱＬＯＫ                                   
   653  006530*--<       追加成功 >                                             
   654  006540           COMPUTE  Ｗ−出力−件数    =  Ｗ−出力−件数  +  1     
   655  006550        WHEN   OTHER                                              
   656  006560*--<       追加失敗、プログラムを異常終了する >                   
   657  006570           MOVE     -50               TO  Ｗ−エラーコード        
   658  006580           PERFORM  エラー処理                                    
   659  006590     END-EVALUATE.                                                
   660  006600*                                                                 
   661  006610 資産コード変換マスタ追加処理−ＥＸＩＴ.                          
   662  006620     EXIT.                                                        
   663  006630******************************************************************
   664  006640*    ＤＢクローズ                                        <3.1>   *
   665  006650******************************************************************
   666  006660 ＤＢクローズ                         SECTION.                    
   667  006670 ＤＢクローズ−ＳＴＡＲＴ.                                        
   668  006680*                                                                 
   669  006690*--< カーソルのクローズ >                                         
   670  006700     EXEC  SQL                                                    
   671  006710        CLOSE  CUR1                                               
   672  006720     END-EXEC.                                                    
   673  006730*                                                                 
   674  006740 ＤＢクローズ−ＥＸＩＴ.                                          
   675  006750     EXIT.                                                        
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   676  006760******************************************************************
   677  006770*    ＤＢコミット処理                                    <3.2>   *
   678  006780******************************************************************
   679  006790 ＤＢコミット処理                     SECTION.                    
   680  006800 ＤＢコミット処理−ＳＴＡＲＴ.                                    
   681  006810*                                                                 
   682  006820     EXEC  SQL                                                    
   683  006830        COMMIT  WORK  RELEASE                                     
   684  006840     END-EXEC.                                                    
   685  006850*                                                                 
   686  006860*--< コミット処理 >                                               
   687  006870     INITIALIZE                       IF-CHOCO001.                
   688  006880     MOVE  "3"                        TO  共１−イベント種別.     
   689  006890     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   690  006900     MOVE  "0"                        TO  共１−復帰コード.       
   691  006910     MOVE  "COMMIT"                   TO  共１−処理識別.         
   692  006920     MOVE  "コミット実施"             TO  共１−その他メッセージ. 
   693  006930     CALL  CLOCO001                USING  IF-CHOCO001.            
   694  006940*                                                                 
   695  006950 ＤＢコミット処理−ＥＸＩＴ.                                      
   696  006960     EXIT.                                                        
   697  006970******************************************************************
   698  006980*    ＤＢロールバック処理                                <4.1>   *
   699  006990******************************************************************
   700  007000 ＤＢロールバック処理                 SECTION.                    
   701  007010 ＤＢロールバック処理−ＳＴＡＲＴ.                                
   702  007020*                                                                 
   703  007030     EXEC  SQL                                                    
   704  007040         ROLLBACK WORK  RELEASE                                   
   705  007050     END-EXEC.                                                    
   706  007060*                                                                 
   707  007070*--< ロールバック処理 >                                           
   708  007080     INITIALIZE                       IF-CHOCO001.                
   709  007090     MOVE  "1"                        TO  共１−イベント種別.     
   710  007100     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   711  007110     MOVE  "9"                        TO  共１−復帰コード.       
   712  007120     MOVE  "ROLLBACK"                 TO  共１−処理識別.         
   713  007130     MOVE  "ロールバック実施"         TO  共１−その他メッセージ. 
   714  007140     CALL  CLOCO001                USING  IF-CHOCO001.            
   715  007150*                                                                 
   716  007160 ＤＢロールバック処理−ＥＸＩＴ.                                  
   717  007170     EXIT.                                                        
   718  007180******************************************************************
   719  007190*    エラー処理                                          <4.0>   *
   720  007200******************************************************************
   721  007210 エラー処理                           SECTION.                    
   722  007220 エラー処理−ＳＴＡＲＴ.                                          
   723  007230*                                                                 
   724  007240     MOVE  "Y"                        TO  異常終了−フラグ.       
   725  007250     INITIALIZE                       IF-CHOCO001.                
   726  007260*                                                                 
   727  007270     EVALUATE  Ｗ−エラーコード                                   
   728  007280        WHEN  -1                                                  
   729  007290*--<       基準適用日ファイルオープンエラー >                     
   730  007300           MOVE  "2"                  TO  共１−イベント種別      
   731  007310           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   732  007320           MOVE  "9"                  TO  共１−復帰コード        
   733  007330           MOVE  "FFUISA01"           TO  共１−処理テーブルＩＤ  
   734  007340           MOVE  "OPEN"               TO  共１−処理識別          
   735  007350           MOVE  ファイル状態         TO  共１−データ内容        
   736  007360           MOVE  "基準適用日ファイルオープンエラー"               
   737  007370                                      TO  共１−その他メッセージ  
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   738  007380           CALL  CLOCO001          USING  IF-CHOCO001             
   739  007390           MOVE  "N"                  TO  異常終了−フラグ        
   740  007400*                                                                 
   741  007410        WHEN  -2                                                  
   742  007420*--<       基準適用日読み込みファイルエラー >                     
   743  007430           MOVE  "2"                  TO  共１−イベント種別      
   744  007440           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   745  007450           MOVE  "9"                  TO  共１−復帰コード        
   746  007460           MOVE  "FFUISA01"           TO  共１−処理テーブルＩＤ  
   747  007470           MOVE  "READ"               TO  共１−処理識別          
   748  007480           MOVE  ファイル状態         TO  共１−データ内容        
   749  007490           MOVE  "基準適用日ファイル読み込みエラー"               
   750  007500                                      TO  共１−その他メッセージ  
   751  007510           CALL  CLOCO001          USING  IF-CHOCO001             
   752  007520           MOVE  "N"                  TO  異常終了−フラグ        
   753  007530*                                                                 
   754  007540        WHEN  -10                                                 
   755  007550*--<       ＯＲＡＣＬＥ接続失敗 >                                 
   756  007560           MOVE  "1"                  TO  共１−イベント種別      
   757  007570           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   758  007580           MOVE  "9"                  TO  共１−復帰コード        
   759  007590           MOVE  "CONNECT"            TO  共１−処理識別          
   760  007600           MOVE  SQLCODE              TO  共１−データ内容        
   761  007610           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   762  007620           CALL  CLOCO001          USING  IF-CHOCO001             
   763  007630*                                                                 
   764  007640        WHEN  -20                                                 
   765  007650*--<       カーソルオープン失敗 >                                 
   766  007660           MOVE  "1"                  TO  共１−イベント種別      
   767  007670           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   768  007680           MOVE  "9"                  TO  共１−復帰コード        
   769  007690           MOVE  "JOM_MST"            TO  共１−処理テーブルＩＤ  
   770  007700           MOVE  "OPEN"               TO  共１−処理識別          
   771  007710           MOVE  SQLCODE              TO  共１−データ内容        
   772  007720           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   773  007730           CALL  CLOCO001          USING  IF-CHOCO001             
   774  007740*                                                                 
   775  007750        WHEN  -30                                                 
   776  007760*--<       ジョモ商品の読込失敗 >                                 
   777  007770           MOVE  "1"                  TO  共１−イベント種別      
   778  007780           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   779  007790           MOVE  "9"                  TO  共１−復帰コード        
   780  007800           MOVE  "JOM_MST"            TO  共１−処理テーブルＩＤ  
   781  007810           MOVE  "FETCH"              TO  共１−処理識別          
   782  007820           MOVE  SQLCODE              TO  共１−データ内容        
   783  007830           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   784  007840           CALL  CLOCO001          USING  IF-CHOCO001             
   785  007850*                                                                 
   786  007860        WHEN  -40                                                 
   787  007870*--<       転リース提携先コードを取得しない >                     
   788  007880           MOVE  "2"                  TO  共１−イベント種別      
   789  007890           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   790  007900           MOVE  "9"                  TO  共１−復帰コード        
   791  007910           MOVE  "IKO004"             TO  共１−処理テーブルＩＤ  
   792  007920           MOVE  "SELECT"             TO  共１−処理識別          
   793  007930           MOVE  ＷＳ−ジョモ商品     TO  共１−キー情報          
   794  007940           MOVE  SQLCODE              TO  共１−データ内容        
   795  007950           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   796  007960           CALL  CLOCO001          USING  IF-CHOCO001             
   797  007970           MOVE  "N"                  TO  異常終了−フラグ        
   798  007980*                                                                 
   799  007990        WHEN  -50                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   800  008000*--<       資産コード変換マスタ追加失敗 >                         
   801  008010           MOVE  "1"                  TO  共１−イベント種別      
   802  008020           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   803  008030           MOVE  "9"                  TO  共１−復帰コード        
   804  008040           MOVE  "D077SSH"            TO  共１−処理テーブルＩＤ  
   805  008050           MOVE  "INSERT"             TO  共１−処理識別          
   806  008060           MOVE  SQLCODE              TO  共１−データ内容        
   807  008070           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   808  008080           CALL  CLOCO001          USING  IF-CHOCO001             
   809  008090*                                                                 
   810  008100        WHEN  OTHER                                               
   811  008110           MOVE  "N"                  TO  異常終了−フラグ        
   812  008120     END-EVALUATE.                                                
   813  008130*                                                                 
   814  008140     IF  異常終了−フラグ  =  "Y"                                 
   815  008150*----------------------------------------------------------------*
   816  008160*    終了メッセージ出力処理                                      *
   817  008170*----------------------------------------------------------------*
   818  008180        PERFORM  終了メッセージ出力                               
   819  008190*                                                                 
   820  008200        PERFORM  ＤＢロールバック処理                             
   821  008210*--<    プログラムリターンコード >                                
   822  008220        MOVE  定数−異常状態          TO  PROGRAM-STATUS          
   823  008230        EXIT  PROGRAM                                             
   824  008240     END-IF.                                                      
   825  008250*                                                                 
   826  008260 エラー処理−ＥＸＩＴ.                                            
   827  008270      EXIT.                                                       
   828  008280******************************************************************
   829  008290*                  END OF PROGRAM                                *
   830  008300******************************************************************
ファイル: COBIS130.PCOをクローズ
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


ホスト変数
--------------

01  DB-STRING                                           Charf(20)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      3
  COBIS130.PCO    355

01  PASSWD                                              Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      5
  COBIS130.PCO    350    354

01  SQLSTATE                                            Charf(5)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      2
  COBIS130.PCO    349    353    402    427    577    605    670    682    703

01  USERNAME                                            Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      4
  COBIS130.PCO    350    354

03  Ｄ０７７−機種名 OF 資産コード変換マスタ            Charf(20)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     21
  COBIS130.PCO    638

03  Ｄ０７７−更新時間 OF 資産コード変換マス            Charf(8)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     26
  COBIS130.PCO    643

03  Ｄ０７７−更新者 OF 資産コード変換マスタ            Charf(8)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     27
  COBIS130.PCO    644

03  Ｄ０７７−更新年月日 OF 資産コード変換マ            Charf(8)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     25
  COBIS130.PCO    642

03  Ｄ０７７−資産コード OF 資産コード変換マ            Charf(7)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     10
  COBIS130.PCO    630

03  Ｄ０７７−商品分類名 OF 資産コード変換マ            Charf(30)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     18
  COBIS130.PCO    635

03  Ｄ０７７−信用保険コード−リース OF 資産            Charf(6)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     13
  COBIS130.PCO    632

03  Ｄ０７７−信用保険コード−割賦 OF 資産コ            Charf(6)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     15
  COBIS130.PCO    633

03  Ｄ０７７−税負担区分 OF 資産コード変換マ            Charf(1)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     17
  COBIS130.PCO    634

03  Ｄ０７７−先方商品コード OF 資産コード変            Charf(10)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL      7
  COBIS130.PCO    628

03  Ｄ０７７−適用年月日 OF 資産コード変換マ            Charf(8)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL      9
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  COBIS130.PCO    629

03  Ｄ０７７−転リース提携先コード OF 資産コ            Charf(3)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL      5
  COBIS130.PCO    627

03  Ｄ０７７−登録時間 OF 資産コード変換マス            Charf(8)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     23
  COBIS130.PCO    640

03  Ｄ０７７−登録担当者 OF 資産コード変換マ            Charf(8)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     24
  COBIS130.PCO    641

03  Ｄ０７７−登録年月日 OF 資産コード変換マ            Charf(8)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     22
  COBIS130.PCO    639

03  Ｄ０７７−動総保険コード OF 資産コード変            Charf(4)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     11
  COBIS130.PCO    631

03  Ｄ０７７−入力担当者コード OF 資産コード            Charf(8)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     28
  COBIS130.PCO    645

03  Ｄ０７７−物件名 OF 資産コード変換マスタ            Charf(20)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     20
  COBIS130.PCO    637

03  Ｄ０７７−物件名漢字 OF 資産コード変換マ            Charf(40)
  Z:\COB97\COPYLIB_DB\D077SSH.CBL     19
  COBIS130.PCO    636

01  ＩＫＯ００４−転リース提携先コード                  Charf(3)
  Z:\COB97\COPYLIB_DB\IKOTBL004.CBL      5
  COBIS130.PCO    579

01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−ジョモ商品            Charf(4)
  Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBL      4
  COBIS130.PCO    430

01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−ジョモ商品            Charf(30)
  Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBL      5
  COBIS130.PCO    431

01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−機種名                Charf(20)
  Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBL      8
  COBIS130.PCO    434

01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−資産コード            Charf(7)
  Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBL      9
  COBIS130.PCO    436

01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−信用保険コ            Charf(6)
  Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBL     17
  COBIS130.PCO    438

01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−信用保険コ            Charf(6)
  Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBL     19
  COBIS130.PCO    439

Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−税区分                Charf(1)
  Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBL     11
  COBIS130.PCO    435

01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−動総保険コ            Charf(4)
  Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBL     16
  COBIS130.PCO    437

01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−物件名                Charf(20)
  Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBL      7
  COBIS130.PCO    433

01  ＪＯＭ−ＳＹＯＨＩＮ−ＭＳＴ−物件名−漢            Charf(40)
  Z:\COB97\COPYLIB_DB\JOM_SYOHIN_MST.CBL      6
  COBIS130.PCO    432

01  ＷＳ−ジョモ商品                                    Charf(8)
  COBIS130.PCO     59    581

Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


SQL識別子
---------------

CUR1                  CURSOR                        
  COBIS130.PCO    385    403    428    671    385

Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.



                              プリコンパイラ・オプション
-------------------------------------------------------------------------------
オプション名   現在の設定値         設定先
-------------------------------------------------------------------------------
asacc             no                デフォルト                                  
assume_sqlcode    no                デフォルト                                  
auto_connect      no                デフォルト                                  
close_on_commit   yes               mode                                        
comp5             yes               D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
config            default config    デフォルト                                  
date_format       local             デフォルト                                  
dbms              native            デフォルト                                  
declare_section   yes               mode                                        
define            *なし*            デフォルト                                  
dynamic           ansi              mode                                        
end_of_fetch      100               mode                                        
eol_padding       yes               デフォルト                                  
errors            yes               デフォルト                                  
fips              no                デフォルト                                  
format            ansi              デフォルト                                  
hold_cursor       no                デフォルト                                  
host              cobol             デフォルト                                  
iname             COBIS130.PCO      コマンドライン                              
include           Z:\COB97\COPYLIB  D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
                  Z:\COB97\COPYLIB_DD:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
                  *なし*            D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
ireclen           132               D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
litdelim          quote             デフォルト                                  
lname             *なし*            デフォルト                                  
lreclen           132               デフォルト                                  
ltype             long              デフォルト                                  
maxliteral        160               D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
maxopencursors    10                デフォルト                                  
mode              ANSI              D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
nested            yes               デフォルト                                  
nls_local         yes               D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
oname             COBIS130.COB      コマンドライン                              
oraca             no                デフォルト                                  
oreclen           80                デフォルト                                  
pagelen           66                デフォルト                                  
picx              charf             デフォルト                                  
prefetch          1                 デフォルト                                  
release_cursor    no                デフォルト                                  
select_error      yes               デフォルト                                  
sqlcheck          FULL              D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
threads           no                デフォルト                                  
type_code         ansi              mode                                        
unsafe_null       no                デフォルト                                  
userid            CUIFJ/CFJ@FIP     D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
varchar           no                デフォルト                                  
xref              yes               デフォルト                                  
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Mar 25 14:08:57 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


統計表示
----------

リターン・コード: 0
重要性 Iでのメッセージ数: 0
重要性 Wでのメッセージ数: 0
重要性 Eでのメッセージ数: 0
重要性 Fでのメッセージ数: 0
入力ラインの数: 890
宣言されたホスト変数の数: 40
カーソル名の数: 1
文名の数: 0
使用される最大メモリー(バイト): 150929
