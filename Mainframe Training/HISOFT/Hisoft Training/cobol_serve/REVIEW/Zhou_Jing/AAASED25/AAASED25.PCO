000010******************************************************************
000020*         ÅÉäCãPìÓåè(ëÂòA)ÅÑ                                     *
000030*      1. ÉvÉçÉOÉâÉÄñº  : ëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉãçÏê¨             *
000040*      2. ÉvÉçÉOÉâÉÄID  : AAASED25                               *
000050*      3. èàóùäTóv      : à⁄çså„ÅiÉåÉxÉãÉAÉbÉvÅjÇÃç¬å†ìWäJÇÊÇËÅA *
000060*                         ïœë•ï•ÇcÇaÇçÏê¨Ç∑ÇÈÅB                 *
000070*                                                                *
000080*      4. çÏê¨é“        : é¸ê√                                   *
000090*      5. çÏê¨ì˙        : 2004.10.10                             *
000100******************************************************************
000110*                                                                *
000120******************************************************************
000130*    ÇhÇcÇdÇmÇsÇhÇeÇhÇbÇ`ÇsÇhÇnÇm  ÇcÇhÇuÇhÇrÇhÇnÇm              *
000140******************************************************************
000150 IDENTIFICATION                       DIVISION.                   
000160*                                                                 
000170 PROGRAM-ID.                          AAASED25.                   
000180******************************************************************
000190*    ÇdÇmÇuÇhÇqÇnÇmÇlÇdÇmÇs        ÇcÇhÇuÇhÇrÇhÇnÇm              *
000200******************************************************************
000210 ENVIRONMENT                          DIVISION.                   
000220******************************************************************
000230*    ÇhÇmÇoÇtÇsÅ|ÇnÇtÇsÇoÇtÇs      ÇrÇdÇbÇsÇhÇnÇm                *
000240******************************************************************
000250 INPUT-OUTPUT                         SECTION.                    
000260*                                                                 
000270 FILE-CONTROL.                                                    
000280     SELECT    èoóÕÉtÉ@ÉCÉã           ASSIGN    TO     U11        
000290     FILE      STATUS     IS          ÇvÅ|èÛë‘                    
000300     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000310******************************************************************
000320*    ÇcÇ`ÇsÇ`                      ÇcÇhÇuÇhÇrÇhÇnÇm              *
000330******************************************************************
000340 DATA                                 DIVISION.                   
000350******************************************************************
000360*    ÇeÇhÇkÇd                      ÇrÇdÇbÇsÇhÇnÇm                *
000370******************************************************************
000380 FILE                                 SECTION.                    
000390*----------------------------------------------------------------*
000400*    èoóÕÉtÉ@ÉCÉã                                                *
000410*----------------------------------------------------------------*
000420 FD  èoóÕÉtÉ@ÉCÉã                                                 
000430     LABEL     RECORD     IS          STANDARD                    
000440     BLOCK     CONTAINS   0           RECORDS.                    
000450*                                                                 
000460 01  èoóÕÅ|ÉåÉRÅ[Éh.                                              
000470     COPY  CPSCE50  REPLACING  ==()==  BY  ==èoóÕÅ|==.            
000480*                                                                 
000490******************************************************************
000500*  ÇvÇnÇqÇjÇhÇmÇfÅ|ÇrÇsÇnÇqÇ`ÇfÇd  ÇrÇdÇbÇsÇhÇnÇm                *
000510******************************************************************
000520  WORKING-STORAGE                     SECTION.                    
000530*----------------------------------------------------------------*
000540*    ÉzÉXÉgïœêîíËã`ÉGÉäÉA                                        *
000550*----------------------------------------------------------------*
000560     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
000570*--<  çÄñ⁄ñºèÃÉ}ÉXÉ^éÊìæçÄñ⁄ >                                    
000571 01  ÇvÇrÅ|ñºèÃÇP                      PIC    X(60).              
000580 01  ÇvÇrÅ|ñºèÃÇQ                      PIC    X(60).              
000590*--< ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûéÊìæèåè >                               
000591 01  ÇvÇrÅ|ã∆ñ±ä«óùÇhÇc                PIC    X(08)               
000592                                       VALUE  'GYMKNRRC'.         
000593*--< çÄñ⁄ñºèÃÉ}ÉXÉ^éÊìæèåè >                                     
000594 01  ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇP                PIC    X(12)               
000595                                       VALUE  '038'.              
000596 01  ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇQ                PIC    X(12)               
000597                                       VALUE  '005'.              
000598*--< ÉJÅ[É\Éãèåè >                                               
000599 01  ÇvÇrÅ|ëOéÛã‡éÛï•écçÇï\ëŒè€ÉtÉâÉO  PIC    X(01)               
000600                                       VALUE  '1'.                
000601*                                                                 
000602*--< ÇnÇqÇ`ÇbÇkÇdã§í ïœêî >                                       
000610     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
000620*                                                                 
000630*--< ÇnÇqÇ`ÇbÇkÇd  ÇrÇpÇké¿çsèÓïÒ >                               
000640     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
000650*                                                                 
000660*--< ëOéÛèÓïÒÇcÇa >                                               
000670     EXEC  SQL  INCLUDE  M40MAB.CBL           END-EXEC.           
000680*                                                                 
000690*--< ã∆ñ±ä«óùÉeÅ[ÉuÉã >                                           
000700     EXEC  SQL  INCLUDE  D70GYM.CBL           END-EXEC.           
000710*                                                                 
000720*--< éÊà¯êÊÉ}ÉXÉ^ >                                               
000730     EXEC  SQL  INCLUDE  D01TRS.CBL            END-EXEC.          
000740*                                                                 
000750*--< êøãÅêÊÉ}ÉXÉ^ >                                               
000760     EXEC  SQL  INCLUDE  D02SQS.CBL            END-EXEC.          
000770*                                                                 
000780*--< çÄñ⁄ñºèÃÉ}ÉXÉ^ >                                             
000790     EXEC  SQL  INCLUDE  D19MSY.CBL            END-EXEC.          
000800*                                                                 
000810*--< ç¬å†èÓïÒÅiàÍî ÅjÇcÇa>                                        
000820     EXEC  SQL  INCLUDE  M01SAJ.CBL            END-EXEC.          
000830                                                                  
000840*                                                                 
000850     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
000860*                                                                 
000870*----------------------------------------------------------------*
000880*    ÇvÇnÇqÇjÉGÉäÉA                                              *
000890*----------------------------------------------------------------*
000900 01  ÇvÇnÇqÇjÅ|ÉGÉäÉA.                                            
000910*--< ÉGÉâÅ[îªíËóp >                                               
000920     03  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             PIC S9(04).                 
000930*                                                                 
000940*--< ÉtÉâÉOÉAÉäÉA >                                               
000950     03  ÉtÉâÉOÉAÉäÉA.                                            
000960         05  ÇvÅ|èIóπÅ|ÉtÉâÉO         PIC  X(01).                 
000970         05  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     PIC  X(01).                 
000980*                                                                 
000990*--< åèêîÉGÉäÉA >                                                 
001000     03  åèêîÉGÉäÉA.                                              
001010         05  ÇvÅ|ì¸óÕÅ|åèêî           PIC  9(09).                 
001020         05  ÇvÅ|èoóÕÅ|åèêî           PIC  9(09).                 
001030*                                                                 
001040*--< ÉtÉ@ÉCÉãèÛë‘ >                                               
001050     03  ÇvÅ|èÛë‘ÉGÉäÉA.                                          
001060         05  ÇvÅ|èÛë‘                 PIC  X(02).                 
001070*                                                                 
001080*--< ã§í èÓïÒ >                                                   
001090 01  ÇvÅ|ã§í èÓïÒ.                                                
001100     03  ÇvÅ|ÉVÉXÉeÉÄì˙ït.                                        
001110         05  ÇvÅ|ê¢ãI                 PIC  X(02) VALUE  "20".     
001120         05  ÇvÅ|îNåéì˙               PIC  X(06).                 
001130     03  ÇvÅ|ÉVÉXÉeÉÄéûçè             PIC  X(08).                 
001140     03  ÇvÅ|íSìñé“                   PIC  X(08) VALUE "IKOPG   ".
001150*                                                                 
001160*----------------------------------------------------------------*
001170*    ÉTÉuÉãÅ[É`Éìñº                                              *
001180*----------------------------------------------------------------*
001190 01  CALL-AREA.                                                   
001200*--< ã§í ÉçÉOÉTÉuÉãÅ[É`Éì >                                       
001210     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001220     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001230*                                                                 
001240*----------------------------------------------------------------*
001250*    ÇbÇnÇoÇxóÃàÊ                                                *
001260*----------------------------------------------------------------*
001270*--< ã§í ÉçÉOópÉpÉâÉÅÅ[É^ >                                       
001280 01  IF-CHOCO001.                                                 
001290     COPY  CHOCO001  REPLACING  ==()==  BY  ==ã§ÇPÅ|==.           
001300*                                                                 
001310*----------------------------------------------------------------*
001320*    ÇhÇmÇhÉtÉ@ÉCÉãì«çûÉTÉuÉãÅ[É`ÉìópÉpÉâÉÅÉ^óÃàÊ                *
001330*----------------------------------------------------------------*
001340 01  PARA-AREA.                                                   
001350     COPY CPBCO001.                                               
001360******************************************************************
001370*    íËêîópÉfÅ[É^íËã`ÉGÉäÉA                                      *
001380******************************************************************
001390 CONSTANT                             SECTION.                    
001400 01  íËêîóÃàÊ.                                                    
001410     03  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc         PIC  X(08) VALUE "AAASED25".
001420     03  íËêîÅ|ÉvÉçÉOÉâÉÄñº           PIC  X(80)                  
001430                                      VALUE                       
001440                                 "ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉã".    
001450     03  íËêîÅ|ÇrÇpÇkÇnÇj             PIC S9(04)  VALUE  ZERO.    
001460     03  íËêîÅ|ÇrÇpÇkÇdÇmÇc           PIC S9(04)  VALUE  0100.    
001470     03  íËêîÅ|ê≥èÌèÛë‘               PIC S9(04)  VALUE  ZERO.    
001480     03  íËêîÅ|àŸèÌèÛë‘               PIC S9(04)  VALUE  0009.    
001490******************************************************************
001500*    ÇoÇqÇnÇbÇdÇcÇtÇqÇd            ÇcÇhÇuÇhÇrÇhÇnÇm              *
001510******************************************************************
001520 PROCEDURE                            DIVISION.                   
001530*                                                                 
001540     PERFORM  èâä˙èàóù.                                           
001550*                                                                 
001560     PERFORM  éÂèàóù  UNTIL  ÇvÅ|èIóπÅ|ÉtÉâÉO  =  "Y".            
001570*                                                                 
001580     PERFORM  èIóπèàóù.                                           
001590*                                                                 
001600     STOP     RUN.                                                
001610*                                                                 
001620******************************************************************
001630*    èâä˙èàóù                                                    *
001640******************************************************************
001650 èâä˙èàóù                             SECTION.                    
001660 èâä˙èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
001670*                                                                 
001680*----------------------------------------------------------------*
001690*    äJénÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
001700*----------------------------------------------------------------*
001710     INITIALIZE                       IF-CHOCO001.                
001720     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
001730     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
001740     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
001750     MOVE  "START"                    TO  ã§ÇPÅ|èàóùéØï .         
001760     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
001770     CALL  CLOCO001                USING  IF-CHOCO001.            
001780*                                                                 
001790*----------------------------------------------------------------*
001800*    çÏã∆óÃàÊÇÃèâä˙ílèàóù                                        *
001810*----------------------------------------------------------------*
001820     MOVE  SPACE                      TO  ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001830     INITIALIZE                           ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001840*                                                                 
001850*--< ÇbÇoÇtì˙ïtÇéÊìæ >                                           
001860     ACCEPT  ÇvÅ|îNåéì˙               FROM  DATE.                 
001870*                                                                 
001880*--< ÇbÇoÇtéûçèÇéÊìæ >                                           
001890     ACCEPT  ÇvÅ|ÉVÉXÉeÉÄéûçè         FROM  TIME.                 
001900*                                                                 
001910*--< ÇnÇqÇ`ÇbÇkÇdê⁄ë± >                                           
001920     PERFORM   ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                                  
001930*--< ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû >                                       
001940     PERFORM  ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû.                               
001950*                                                                 
001960*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã` >                                   
001970     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`.                           
001980*                                                                 
001990*--< OPEN  èoóÕÉtÉ@ÉCÉã >                                         
002000     PERFORM  ÉtÉ@ÉCÉãÉIÅ[ÉvÉì.                                   
002010*                                                                 
002020*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû(ÇPåèñ⁄) >                           
002030     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
002040*                                                                 
002050 èâä˙èàóùÅ|ÇdÇwÇhÇs.                                              
002060     EXIT.                                                        
002070******************************************************************
002080*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
002090******************************************************************
002100 ÇnÇqÇ`ÇbÇkÇdê⁄ë±                     SECTION.                    
002110 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇrÇsÇ`ÇqÇs.                                    
002120*                                                                 
002130*--< ÇcÇaê⁄ë±ópèÓïÒÇéÊìæèàóù >                                   
002140     CALL  COBCO001                USING  PARA-AREA.              
002150*                                                                 
002160     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002170     MOVE  PARA-USERNAME              TO  USERNAME.               
002180     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002190*                                                                 
002200*----------------------------------------------------------------*
002210*    äJénê⁄ë±                                                    *
002220*----------------------------------------------------------------*
002230     IF    DB-STRING  =  SPACE                                    
002240        EXEC SQL                                                  
002250           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002260        END-EXEC                                                  
002270     ELSE                                                         
002280        EXEC SQL                                                  
002290           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002300             USING  :DB-STRING                                    
002310        END-EXEC                                                  
002320     END-IF.                                                      
002330*                                                                 
002340*----------------------------------------------------------------*
002350*    ê⁄ë±ämîF                                                    *
002360*----------------------------------------------------------------*
002370     EVALUATE  SQLCODE                                            
002380        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002390           CONTINUE                                               
002400        WHEN   OTHER                                              
002410*--<       ê⁄ë±ÉGÉâÅ[ >                                           
002420           MOVE     -10               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002430           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002440     END-EVALUATE.                                                
002450*                                                                 
002460 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇdÇwÇhÇs.                                      
002470     EXIT.                                                        
002480******************************************************************
002490*        ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû                                    *
002500******************************************************************
002510 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû		   SECTION.                     
002520 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇrÇsÇ`ÇqÇs.                                
002530*----------------------------------------------------------------*
002540*        ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû                                    *
002550*----------------------------------------------------------------*
002560      EXEC  SQL                                                   
002570         SELECT  ÉoÉbÉ`ópã∆ñ±îNåé                         	
002580           INTO  ÇcÇVÇOÅ|ÉoÉbÉ`ópã∆ñ±îNåé                         
002590           FROM  D70GYM_TBL                                       
002600          WHERE  ã∆ñ±ä«óùÇhÇc = :ÇvÇrÅ|ã∆ñ±ä«óùÇhÇc               
002610      END-EXEC.                                                   
002620*----------------------------------------------------------------*
002630*       ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûèàóùÇämîF                           *
002640*----------------------------------------------------------------*
002650     EVALUATE  SQLCODE                                            
002660        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
002670*--<       ê≥èÌ >                                                 
002680           CONTINUE                                               
002690        WHEN  OTHER                                               
002700*--<        >                                                     
002710           MOVE -20                  TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh         
002720           MOVE  "Y"                 TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
002730           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002740     END-EVALUATE.                                                
002750*                                                                 
002760 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇdÇwÇhÇs.                                  
002770     EXIT.                                                        
002780******************************************************************
002790*        åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`                                *
002800******************************************************************
002810 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`             SECTION.                    
002820 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇrÇsÇ`ÇqÇs.                            
002830*                                                                 
002840*----------------------------------------------------------------*
002850*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
002860*----------------------------------------------------------------*
002870     EXEC SQL                                                     
002880        DECLARE CUR1  CURSOR FOR                                  
002890           SELECT  M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™ 			
002900                  ,M40MAB_TBL.åoóùópéÂå_ñÒãÊï™			
002910                  ,M40MAB_TBL.å⁄ãqãÊï™		         	
002920                  ,NVL(D01TRS_TBL.ñºäÒÇπÉRÅ[Éh,RPAD(' ',40,' '))	
002930                  ,M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh	                
002940                  ,M40MAB_TBL.êøãÅêÊÉRÅ[Éh	                
002950                  ,M40MAB_TBL.å_ñÒî‘çÜ			        
002960                  ,M40MAB_TBL.å_ñÒéÌóﬁ		        	
002970                  ,M40MAB_TBL.íSìñïîâ€ÉRÅ[Éh	 		
002980                  ,M40MAB_TBL.çƒÉäÅ[ÉXâÒêî			
002990                  ,M40MAB_TBL.è[ìñäJénîNåé 			
003000                  ,M40MAB_TBL.è[ìñåéêî 				
003010                  ,M40MAB_TBL.ëOï•âÒé˚ï˚ñ@			
003020                  ,M40MAB_TBL.ì¸ã‡ì˙				
003030                  ,M40MAB_TBL.ì¸ã‡ãÊï™                            
003040                  ,NVL(D01TRS_TBL.éÊà¯êÊñºèÃ,RPAD(' ',80,' '))   	
003050			,NVL(D02SQS_TBL.êøãÅêÊñºèÃ,RPAD(' ',80,' '))   	
003060			,M40MAB_TBL.ëOåéññécçÇ                          
003070                  ,M40MAB_TBL.ìñåéâÒé˚äz		        	
003080		        ,M40MAB_TBL.ìñåéè¡âªäz		        	
003090			,M40MAB_TBL.ìñåéññécçÇ                          
003100                  ,M40MAB_TBL.ã¶í≤ãÊï™                            
003110                  ,M40MAB_TBL.ëOåéññécçÇëºé–                      
003120                  ,M40MAB_TBL.ìñåéâÒé˚äzëºé–                      
003130                  ,M40MAB_TBL.ìñåéè¡âªäzëºé–                      
003140                  ,M40MAB_TBL.ìñåéëºé–âñÒï™óøã‡                  
003150                  ,M40MAB_TBL.ìñåéëºé–âñÒï™è¡îÔê≈                
003160                  ,M40MAB_TBL.ìñåéññécçÇëºé–                      
003170            FROM   M40MAB_TBL                                     
003180                  ,D01TRS_TBL                                     
003190                  ,D02SQS_TBL		                        
003200            WHERE M40MAB_TBL.ëOéÛã‡éÛï•écçÇï\ëŒè€ÉtÉâÉO           
003201                   = :ÇvÇrÅ|ëOéÛã‡éÛï•écçÇï\ëŒè€ÉtÉâÉO
003210              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh	        	
003220                        = D01TRS_TBL.éÊà¯êÊÉRÅ[Éh (+)		
003230              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh	        	
003240                   = D02SQS_TBL.éÊà¯êÊÉRÅ[Éh (+)                  
003250              AND  M40MAB_TBL.êøãÅêÊÉRÅ[Éh                        
003260                   = D02SQS_TBL.êøãÅêÊÉRÅ[Éh (+)          	
003270              ORDER BY                                            
003280                   M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™                        
003290                  ,M40MAB_TBL.å_ñÒî‘çÜ                            
003300     END-EXEC.                                                    
003310*                                                                 
003320*----------------------------------------------------------------*
003330*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
003340*----------------------------------------------------------------*
003350     EXEC  SQL                                                    
003360        OPEN  CUR1                                                
003370     END-EXEC.                                                    
003380*                                                                 
003390*----------------------------------------------------------------*
003400*    ÉJÅ[É\ÉãÇnÇoÇdÇmämîF                                        *
003410*----------------------------------------------------------------*
003420     EVALUATE  SQLCODE                                            
003430        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
003440*--<       ê≥èÌ >                                                 
003450           CONTINUE                                               
003460        WHEN  OTHER                                               
003470*--<       ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
003480           MOVE -30                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003490           PERFORM  ÉGÉâÅ[îªíËèàóù                                
003500     END-EVALUATE.                                                
003510*                                                                 
003520 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇdÇwÇhÇs.                              
003530     EXIT.                                                        
003540******************************************************************
003550*         ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                     *
003560******************************************************************
003570 ÉtÉ@ÉCÉãÉIÅ[ÉvÉì		            SECTION.                    
003580 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇrÇsÇ`ÇqÇs.                                    
003590     OPEN  OUTPUT   èoóÕÉtÉ@ÉCÉã.                                 
003600*                                                                 
003610*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÇÃèÛë‘îªíË >                                 
003620     EVALUATE  ÇvÅ|èÛë‘                                           
003630        WHEN  ZERO                                                
003640*--<       ê≥èÌ >                                                 
003650          CONTINUE                                                
003660        WHEN  OTHER                                               
003670*--<       ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                               
003680           MOVE     -40                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
003690           PERFORM  ÉGÉâÅ[îªíËèàóù                                
003700     END-EVALUATE.                                                
003710*                                                                 
003720 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇdÇwÇhÇs.                                      
003730     EXIT.                                                        
003740******************************************************************
003750*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                                    *
003760******************************************************************
003770 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû             SECTION.                    
003780 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇrÇsÇ`ÇqÇs.                            
003790*                                                                 
003800*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû >                                   
003810     EXEC SQL                                                     
003820         FETCH  CUR1                                              
003830          INTO  :ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™                             
003840               ,:ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™                         
003850               ,:ÇlÇSÇOÅ|å⁄ãqãÊï™                                 
003860               ,:ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh                             
003870               ,:ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh                       
003880               ,:ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh                             
003890               ,:ÇlÇSÇOÅ|å_ñÒî‘çÜ                                 
003900               ,:ÇlÇSÇOÅ|å_ñÒéÌóﬁ                                 
003910               ,:ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh                           
003920               ,:ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî                             
003930               ,:ÇlÇSÇOÅ|è[ìñäJénîNåé                             
003940               ,:ÇlÇSÇOÅ|è[ìñåéêî                                 
003950               ,:ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@                             
003960               ,:ÇlÇSÇOÅ|ì¸ã‡ì˙                                   
003970               ,:ÇlÇSÇOÅ|ì¸ã‡ãÊï™                                 
003980               ,:ÇcÇOÇPÅ|éÊà¯êÊñºèÃ                               
003990               ,:ÇcÇOÇQÅ|êøãÅêÊñºèÃ                               
004000               ,:ÇlÇSÇOÅ|ëOåéññécçÇ                               
004010               ,:ÇlÇSÇOÅ|ìñåéâÒé˚äz                               
004020               ,:ÇlÇSÇOÅ|ìñåéè¡âªäz                               
004030               ,:ÇlÇSÇOÅ|ìñåéññécçÇ                               
004040               ,:ÇlÇSÇOÅ|ã¶í≤ãÊï™                                 
004050               ,:ÇlÇSÇOÅ|ëOåéññécçÇëºé–                           
004060               ,:ÇlÇSÇOÅ|ìñåéâÒé˚äzëºé–                           
004070               ,:ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–                           
004080               ,:ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡                       
004090               ,:ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈                     
004100               ,:ÇlÇSÇOÅ|ìñåéññécçÇëºé–                           
004110     END-EXEC.                                                    
004120*                                                                 
004130*----------------------------------------------------------------*
004140*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÇämîF                              *
004150*----------------------------------------------------------------*
004160     EVALUATE   SQLCODE                                           
004170        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
004180*--<       ê≥èÌ >                                                 
004190        COMPUTE  ÇvÅ|ì¸óÕÅ|åèêî  =  ÇvÅ|ì¸óÕÅ|åèêî  +  1          
004200        WHEN   íËêîÅ|ÇrÇpÇkÇdÇmÇc                                 
004210*--<       ì«çûèIóπ >                                             
004220           MOVE  "Y"                  TO  ÇvÅ|èIóπÅ|ÉtÉâÉO        
004230        WHEN   OTHER                                              
004240*--<       ì«çûÉGÉâÅ[ >                                           
004250           MOVE     -50               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004260           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004270     END-EVALUATE.                                                
004280*                                                                 
004290 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇdÇwÇhÇs.                              
004300     EXIT.                                                        
004310******************************************************************
004320*    éÂèàóù                                                      *
004330******************************************************************
004340 éÂèàóù                               SECTION.                    
004350 éÂèàóùÅ|ÇrÇsÇ`ÇqÇs.                                              
004360*                                                                 
004370*--< çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù >                           
004380     PERFORM   çÄñ⁄ñºèÃÇÃíäèoèàóù.                                
004390*                                                                 
004400*--< ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù >                     
004410     PERFORM   ç¬å†èÓïÒÇÃíäèoèàóù.                                
004420*                                                                 
004430*--< ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕîªíËèàóù >                     
004440     IF  ÇlÇOÇPÅ|íSï€ãÊï™  NOT = '1'                              
004450*--< ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWÅAèoóÕèàóù >              	
004460        PERFORM  ëOéÛã‡çÄñ⁄ï“èWèàóù                               
004470     END-IF.                                                      
004480*                                                                 
004490*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅiÇQåèñ⁄à»ç~Åj >                     
004500     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
004510*                                                                 
004520 éÂèàóùÅ|ÇdÇwÇhÇs.                                                
004530     EXIT.                                                        
004540******************************************************************
004550*    çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù	                       *
004560******************************************************************
004570 çÄñ⁄ñºèÃÇÃíäèoèàóù                   SECTION.                    
004580 çÄñ⁄ñºèÃÇÃíäèoèàóùÅ|ÇrÇsÇ`ÇqÇs.                                  
004590*----------------------------------------------------------------*
004600*    çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒãÊï™ñºèÃÇÃíäèoèàóù		       *
004610*----------------------------------------------------------------*
004620     EXEC  SQL                                                    
004630        SELECT  ñºèÃ                                              
004640          INTO  :ÇvÇrÅ|ñºèÃÇP                                     
004650          FROM  D19MSY_TBL                                        
004660         WHERE  ÉRÅ[ÉhÇmÇn = :ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇP                  
004670           AND  SUBSTR (ÉRÅ[Éh,1,1) = :ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™   
004680     END-EXEC.                                               	
004690*----------------------------------------------------------------*
004700*    çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒãÊï™ñºèÃÇÃíäèoèàóùÇämîF            *
004710*----------------------------------------------------------------*
004720     EVALUATE   SQLCODE                                           
004730         WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                  
004740*--<       ê≥èÌ >                                                 
004750           CONTINUE                                               
004760         WHEN OTHER                                               
004770*--<       ì«çûÉGÉâÅ[ >                                           
004780           MOVE     SPACE             TO  ÇvÇrÅ|ñºèÃÇP            
004790           MOVE     -60               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004800           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004810     END-EVALUATE.                                                
004820*----------------------------------------------------------------*
004830*    çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËå⁄ãqãÊï™ñºèÃÇÃíäèoèàóù                    *
004840*----------------------------------------------------------------*
004850     EXEC  SQL                                                    
004860        SELECT  ñºèÃ                                              
004870          INTO :ÇvÇrÅ|ñºèÃÇQ                                      
004880          FROM  D19MSY_TBL                                        
004890         WHERE  ÉRÅ[ÉhÇmÇn = :ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇQ                  
004900           AND  SUBSTR (ÉRÅ[Éh,1,2) = :ÇlÇSÇOÅ|å⁄ãqãÊï™           
004910     END-EXEC.	                                                
004920*----------------------------------------------------------------*
004930*    çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËå⁄ãqãÊï™ñºèÃÇÃíäèoèàóùÇämîF              *
004940*----------------------------------------------------------------*
004950     EVALUATE   SQLCODE                                           
004960         WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                  
004970*--<       ê≥èÌ >                                                 
004980           CONTINUE                                               
004990         WHEN OTHER                                               
005000*--<       ì«çûÉGÉâÅ[ >                                           
005010           MOVE     SPACE             TO  ÇvÇrÅ|ñºèÃÇQ            
005020           MOVE     -60               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
005030           PERFORM  ÉGÉâÅ[îªíËèàóù                                
005040     END-EVALUATE.                                                
005050 çÄñ⁄ñºèÃÇÃíäèoèàóùÅ|ÇdÇwÇhÇs.                                    
005060     EXIT.                                                        
005070******************************************************************
005080*    ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù	               *
005090******************************************************************
005100 ç¬å†èÓïÒÇÃíäèoèàóù                   SECTION.                    
005110 ç¬å†èÓïÒÇÃíäèoèàóùÅ|ÇrÇsÇ`ÇqÇs.                                  
005120*----------------------------------------------------------------*
005130*    ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù	               *
005140*----------------------------------------------------------------*
005150     EXEC  SQL                                                    
005160        SELECT M01SAJ_TBL.èÛë‘ÉtÉâÉO                              
005170              ,M01SAJ_TBL.ç¬å†å_ñÒåèñº                            
005180              ,M01SAJ_TBL.íSï€ãÊï™                                
005190          INTO :ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO                                
005200              ,:ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº                              
005210              ,:ÇlÇOÇPÅ|íSï€ãÊï™                                  
005220          FROM M01SAJ_TBL                                         
005230         WHERE M01SAJ_TBL.ÉåÉRÅ[ÉhãÊï™ = '1'                      
005240           AND å_ñÒî‘çÜ = :ÇlÇSÇOÅ|å_ñÒî‘çÜ                       
005250           AND çƒÉäÅ[ÉXâÒêî = :ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî               
005260           AND å_ñÒéÌóﬁ = :ÇlÇSÇOÅ|å_ñÒéÌóﬁ                       
005270     END-EXEC.                                                    
005280*----------------------------------------------------------------*
005290*    ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóùÇämîF                *
005300*----------------------------------------------------------------*
005310     EVALUATE   SQLCODE                                           
005320         WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                  
005330*--<       ê≥èÌ >                                                 
005340           CONTINUE                                               
005350         WHEN OTHER                                               
005360*--<       ì«çûÉGÉâÅ[ >                                           
005370           MOVE     SPACE             TO  ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO      
005380           MOVE     SPACE             TO  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº    
005390           MOVE     SPACE             TO  ÇlÇOÇPÅ|íSï€ãÊï™        
005400           MOVE     -70               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
005410           PERFORM  ÉGÉâÅ[îªíËèàóù                                
005420     END-EVALUATE.                                                
005430 ç¬å†èÓïÒÇÃíäèoèàóùÅ|ÇdÇwÇhÇs.                                    
005440     EXIT.                                                        
005450******************************************************************
005460*    ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄï“èWÅAèoóÕèàóù	               *
005470******************************************************************
005480 ëOéÛã‡çÄñ⁄ï“èWèàóù                   SECTION.                    
005490 ëOéÛã‡çÄñ⁄ï“èWèàóùÅ|ÇrÇsÇ`ÇqÇs.                                  
005500*----------------------------------------------------------------*
005510*    èoóÕÅ|ÉåÉRÅ[ÉhÇÃèâä˙âªèàóù                                  *
005520*----------------------------------------------------------------*
005530     MOVE  SPACE                      TO  èoóÕÅ|ÉåÉRÅ[Éh.         
005540     INITIALIZE                           èoóÕÅ|ÉåÉRÅ[Éh.         
005550*----------------------------------------------------------------*
005560*    é©é–ï™å¬ï ÇÃï“èW                                            *
005570*----------------------------------------------------------------*
005580     PERFORM  é©é–ï™ï“èW.                                         
005590*----------------------------------------------------------------*
005600*       é©é–ï™èoóÕîªíË                                           *
005610*----------------------------------------------------------------*
005620     IF èoóÕÅ|ëOåéññécçÇ                NOT = 0                   
005630        OR èoóÕÅ|ìñåéì¸ã‡äz             NOT = 0                   
005640        OR èoóÕÅ|ìñåéè¡âªäz             NOT = 0                   
005650        OR èoóÕÅ|ìñåéññécçÇ             NOT = 0                   
005660        PERFORM  ëOéÛã‡ÉtÉ@ÉCÉãèoóÕèàóù                           
005670     END-IF.                                                      
005680*----------------------------------------------------------------*
005690*       ëºé–ï™å¬ï ÇÃï“èW	                                       *
005700*----------------------------------------------------------------*
005710     IF  ÇlÇSÇOÅ|ã¶í≤ãÊï™ = '2'                                   
005720*--<    ëºé–ï™ÇÃçÄñ⁄ï“èWÅAèoóÕèàóù >                              
005730        PERFORM  ëºé–ï™ï“èWèàóù                                   
005740     END-IF.                                                      
005750*----------------------------------------------------------------*
005751*       ëºé–ï™èoóÕîªíË                                           *
005752*----------------------------------------------------------------*
005753     IF  èoóÕÅ|ëOåéññécçÇ             NOT = 0                     
005754        OR èoóÕÅ|ìñåéì¸ã‡äz           NOT = 0                     
005755        OR èoóÕÅ|ìñåéè¡âªäz           NOT = 0                     
005756        OR èoóÕÅ|ìñåéññécçÇ           NOT = 0                     
005757        PERFORM  ëOéÛã‡ÉtÉ@ÉCÉãèoóÕèàóù                           
005758	   END-IF.                                                      
005759 ëOéÛã‡çÄñ⁄ï“èWèàóùÅ|ÇdÇwÇhÇs.                                    
005760        EXIT.                                                     
005770******************************************************************
005780*       é©é–ï™ï“èW	                                       *
005790******************************************************************
005800 é©é–ï™ï“èW                               SECTION.                
005810 é©é–ï™ï“èWÅ|ÇrÇsÇ`ÇqÇs.                                          
005820*                                                                 
005830*--<    No.01 >                                                   
005840        IF   ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO  <  3                             
005850              MOVE   3                 TO èoóÕÅ|é©ëºé–ãÊï™        
005860        ELSE                                                      
005870              MOVE   1                 TO èoóÕÅ|é©ëºé–ãÊï™        
005880        END-IF.                                                   
005890*                                                                 
005900*--<    No.02 >                                                   
005910        MOVE  ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™     TO èoóÕÅ|ëOéÛãÊï™.         
005920                                                                  
005930*--<    No.03 >                                                   
005940        MOVE  ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™ TO èoóÕÅ|éÂå_ñÒãÊï™.       
005950*                                                                 
005960*--<    No.04 >                                                   
005970        MOVE  ÇlÇSÇOÅ|å⁄ãqãÊï™         TO èoóÕÅ|òAåããÊï™.         
005980*                                                                 
005990*--<    No.05 >                                                   
006000        MOVE  ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh     TO èoóÕÅ|ñºäÒÇπÉRÅ[Éh.     
006010*                                                                 
006020*--<    No.06 >                                                   
006030        MOVE  ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh  TO èoóÕÅ|éÊà¯êÊÉRÅ[Éh.  
006040*                                                                 
006050*--<    No.07 >                                                   
006060        MOVE  ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh    TO èoóÕÅ|êøãÅêÊÉRÅ[Éh.      
006070*                                                                 
006080*--<    No.08 >                                                   
006090        MOVE  ÇlÇSÇOÅ|å_ñÒî‘çÜ        TO èoóÕÅ|å_ñÒî‘çÜ.          
006100*                                                                 
006110*--<    No.09 >                                                   
006120        MOVE  ÇlÇSÇOÅ|å_ñÒéÌóﬁ         TO èoóÕÅ|å_ñÒéÌóﬁ.         
006130*                                                                 
006140*--<    No.10 >                                                   
006150        MOVE  ÇcÇVÇOÅ|ÉoÉbÉ`ópã∆ñ±îNåé TO èoóÕÅ|ã∆ñ±îNåé.         
006160*                                                                 
006170*--<    No.11 >                                                   
006180        MOVE  ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh  TO èoóÕÅ|íSìñïîâ€ÉRÅ[Éh.    
006190*                                                                 
006200*--<    No.12 >                                                   
006210        MOVE  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº    TO èoóÕÅ|å_ñÒåèñº.          
006220*                                                                 
006230*--<    No.13 >                                                   
006240        MOVE  ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî    TO èoóÕÅ|çƒÉäÅ[ÉXâÒêî.      
006250*                                                                 
006260*--<    No.14 >                                                   
006270        MOVE  ÇlÇSÇOÅ|è[ìñäJénîNåé    TO èoóÕÅ|è[ìñäJénîNåé.      
006280*                                                                 
006290*--<    No.15 >                                                   
006300        MOVE  ÇlÇSÇOÅ|è[ìñåéêî        TO èoóÕÅ|è[ìñåéêî.          
006310*                                                                 
006320*--<    No.16 >                                                   
006330        MOVE  ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@    TO  èoóÕÅ|ëOï•âÒé˚ï˚ñ@.     
006340*                                                                 
006350*--<    No.17 >                                                   
006360        MOVE  ÇlÇSÇOÅ|ì¸ã‡ì˙          TO èoóÕÅ|ì¸ã‡ì˙.            
006370*                                                                 
006380*--<    No.18 >                                                   
006390        MOVE  ÇlÇSÇOÅ|ì¸ã‡ãÊï™        TO èoóÕÅ|ì¸ã‡ãÊï™.          
006400*                                                                 
006410*--<    No.19 >                                                   
006420        MOVE  ÇcÇOÇPÅ|éÊà¯êÊñºèÃ      TO èoóÕÅ|éÊà¯êÊñºèÃ.        
006430*                                                                 
006440*--<    No.20 >                                                   
006450        MOVE  ÇcÇOÇQÅ|êøãÅêÊñºèÃ      TO èoóÕÅ|êøãÅêÊñºèÃ.        
006460*                                                                 
006470*--<    No.21 >                                                   
006480        MOVE  ÇvÇrÅ|ñºèÃÇP           TO èoóÕÅ|éÂå_ñÒãÊï™ñºèÃ.     
006490*                                                                 
006500*--<    No.22 >                                                   
006510        MOVE  ÇvÇrÅ|ñºèÃÇQ             TO èoóÕÅ|òAåããÊï™ñºèÃ.     
006520*                                                                 
006530*--<    No.23 >                                                   
006540        MOVE  ÇlÇSÇOÅ|ëOåéññécçÇ      TO èoóÕÅ|ëOåéññécçÇ.        
006550*                                                                 
006560*--<    No.24 >                                                   
006570        MOVE  ÇlÇSÇOÅ|ìñåéâÒé˚äz      TO èoóÕÅ|ìñåéì¸ã‡äz.        
006580*                                                                 
006590*--<    No.25 >                                                   
006600        MOVE  ÇlÇSÇOÅ|ìñåéè¡âªäz      TO èoóÕÅ|ìñåéè¡âªäz.        
006610*                                                                 
006620*--<    No.26 >                                                   
006630        MOVE  ÇlÇSÇOÅ|ìñåéññécçÇ      TO èoóÕÅ|ìñåéññécçÇ.        
006640*                                                                 
006650  é©é–ï™ï“èWÅ|ÇdÇwÇhÇs.                                           
006660     EXIT.                                                        
006670******************************************************************
006680*     ëºé–ï™ï“èWèàóù	                                       *
006690******************************************************************
006700 ëºé–ï™ï“èWèàóù                       SECTION.                    
006710 ëºé–ï™ï“èWèàóùÅ|ÇrÇsÇ`ÇqÇs.                                      
006720*                                                                 
006730*--<    No.01 >                                                   
006740        IF   ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO  <  3                             
006750              MOVE   4                  TO èoóÕÅ|é©ëºé–ãÊï™       
006760        ELSE                                                      
006770              MOVE   2                  TO èoóÕÅ|é©ëºé–ãÊï™       
006780        END-IF.                                                   
006790*                                                                 
006800*--<    No.23 >                                                   
006810        MOVE  ÇlÇSÇOÅ|ëOåéññécçÇëºé–    TO èoóÕÅ|ëOåéññécçÇ.      
006820*                                                                 
006830*--<    No.24 >                                                   
006840        MOVE  ÇlÇSÇOÅ|ìñåéâÒé˚äzëºé–    TO èoóÕÅ|ìñåéì¸ã‡äz.      
006850*--<    No.25 >                                                   
006860        COMPUTE   èoóÕÅ|ìñåéè¡âªäz = ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–       
006870                               + ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡       
006880                               + ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈.    
006890*                                                                 
006900*--<    No.26 >                                                   
006910        COMPUTE   èoóÕÅ|ìñåéññécçÇ = ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–       
006920                               - ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡       
006930                               - ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈.    
007030 ëºé–ï™ï“èWèàóùÅ|ÇdÇwÇhÇs.                                        
007040        EXIT.                                                     
007050******************************************************************
007060*     ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóù                         *
007070******************************************************************
007080 ëOéÛã‡ÉtÉ@ÉCÉãèoóÕèàóù                    SECTION.               
007090 ëOéÛã‡ÉtÉ@ÉCÉãèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                              
007100*----------------------------------------------------------------*
007110*     ÉtÉ@ÉCÉãèoóÕ                                               *
007120*----------------------------------------------------------------*
007130     WRITE   èoóÕÅ|ÉåÉRÅ[Éh.                                      
007140*--< ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕÇÃèÛë‘îªíË >                   
007150     EVALUATE  ÇvÅ|èÛë‘                                           
007160        WHEN  ZERO                                                
007170*--<       ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕåèêîÇÃâ¡éZ >             
007180           COMPUTE  ÇvÅ|èoóÕÅ|åèêî =  ÇvÅ|èoóÕÅ|åèêî + 1          
007190        WHEN  OTHER                                               
007200*--<       ÉtÉ@ÉCÉãèoóÕÉGÉâÅ[ >                                   
007210           MOVE     -80                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
007220           PERFORM  ÉGÉâÅ[îªíËèàóù                                
007230     END-EVALUATE.                                                
007240 ëOéÛã‡ÉtÉ@ÉCÉãèoóÕèàóùÅ|ÇdÇwÇhÇs.                                
007250     EXIT.                                                        
007260******************************************************************
007270*    èIóπèàóù                                                    *
007280******************************************************************
007290 èIóπèàóù                             SECTION.                    
007300 èIóπèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
007310*                                                                 
007320     PERFORM  ÇcÇaÉNÉçÅ[ÉYèàóù.                                   
007330*----------------------------------------------------------------*
007340*    ÉtÉ@ÉCÉãÉNÉçÅ[ÉY                                            *
007350*----------------------------------------------------------------*
007360     CLOSE  èoóÕÉtÉ@ÉCÉã.                                         
007370*                                                                 
007380     PERFORM  åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù.                             
007390*                                                                 
007400     PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ.                                 
007410*                                                                 
007420*--< ÉvÉçÉOÉâÉÄê≥èÌèIóπ >                                         
007430     MOVE  íËêîÅ|ê≥èÌèÛë‘             TO  PROGRAM-STATUS.         
007440*                                                                 
007450 èIóπèàóùÅ|ÇdÇwÇhÇs.                                              
007460     EXIT.                                                        
007470******************************************************************
007480*    ÇcÇaÉNÉçÅ[ÉY                                                *
007490******************************************************************
007500 ÇcÇaÉNÉçÅ[ÉYèàóù                     SECTION.                    
007510 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
007520*                                                                 
007530*--< ÉJÅ[É\Éã ÉNÉçÅ[ÉY >                                          
007540     EXEC SQL                                                     
007550        CLOSE  CUR1                                               
007560     END-EXEC.                                                    
007570*                                                                 
007580 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇdÇwÇhÇs.                                      
007590     EXIT.                                                        
007600******************************************************************
007610*     èIóπÉÅÉbÉZÅ[ÉWèoóÕèàóù                                     *
007620******************************************************************
007630 èIóπÉÅÉbÉZÅ[ÉWèoóÕ                    SECTION.                   
007640 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
007650*----------------------------------------------------------------*
007660*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
007670*----------------------------------------------------------------*
007680     INITIALIZE                       IF-CHOCO001.                
007690     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007700     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007710     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007720     MOVE  "END"                      TO  ã§ÇPÅ|èàóùéØï .         
007730     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007740     CALL  CLOCO001                USING  IF-CHOCO001.            
007750*                                                                 
007760 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
007770     EXIT.                                                        
007780******************************************************************
007790*    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
007800******************************************************************
007810 åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù               SECTION.                    
007820 åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                              
007830*                                                                 
007840*----------------------------------------------------------------*
007850*    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
007860*----------------------------------------------------------------*
007870     INITIALIZE                       IF-CHOCO001.                
007880     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007890     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007900     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007910     MOVE  "M40MAB"                   TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007920     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007930     MOVE  ÇvÅ|ì¸óÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007940     MOVE  "ëOéÛèÓïÒÇcÇaì¸óÕåèêî"     TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007950     CALL  CLOCO001                USING  IF-CHOCO001.            
007960*                                                                 
007970     INITIALIZE                       IF-CHOCO001.                
007980     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007990     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
008000     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
008010     MOVE  "SFHSED25"                 TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
008020     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
008030     MOVE  ÇvÅ|èoóÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
008040     MOVE  "ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕåèêî"                   
008050                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008060     CALL  CLOCO001                USING  IF-CHOCO001.            
008070 åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóùÅ|ÇdÇwÇhÇs.                                
008080     EXIT.                                                        
008090******************************************************************
008100*    ÉGÉâÅ[èàóù                                                  *
008110******************************************************************
008120 ÉGÉâÅ[îªíËèàóù                       SECTION.                    
008130 ÉGÉâÅ[îªíËèàóùÅ|ÇrÇsÇ`ÇqÇs.                                      
008140*                                                                 
008160     INITIALIZE                           IF-CHOCO001.            
008170*                                                                 
008180     EVALUATE  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh                                   
008190        WHEN  -10                                                 
008200*--<       ÇnÇqÇ`ÇbÇkÇdê⁄ë±é∏îs >                                 
008210           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008220           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008230           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008240           MOVE  "CONNECT"            TO  ã§ÇPÅ|èàóùéØï           
008250           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008260           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008270           CALL  CLOCO001          USING  IF-CHOCO001             
008280*                                                                 
008290        WHEN  -20                                                 
008300*--<       ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûé∏îs >                             
008310           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008320           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008330           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008340           MOVE  "D70GYM"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008350           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008360           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008370           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008380           CALL  CLOCO001          USING  IF-CHOCO001             
008390*                                                                 
008400        WHEN  -30                                                 
008410*--<       åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãÉIÅ[ÉvÉìé∏îs >                     
008420           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008430           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008440           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008450           MOVE  "M40MAB"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008460           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008470           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008480           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008490           CALL  CLOCO001          USING  IF-CHOCO001             
008500*                                                                 
008510        WHEN  -40                                                 
008520*--<       ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãÉIÅ[ÉvÉì é∏îs >              
008530           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008540           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008550           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008560           MOVE  "SFHSED25"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008570           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008580           MOVE  ÇvÅ|èÛë‘             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008590           MOVE  "ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãÉIÅ[ÉvÉì é∏îs "       
008600                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008610           CALL  CLOCO001          USING  IF-CHOCO001             
008620*                                                                 
008630        WHEN  -50                                                 
008640*--<       åãçáÉeÅ[ÉuÉãì«çûé∏îs >                                 
008650           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008660           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008670           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008680           MOVE  "M40MAB"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008690           MOVE  "FETCH"              TO  ã§ÇPÅ|èàóùéØï           
008700           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008710           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008720           CALL  CLOCO001          USING  IF-CHOCO001             
008730*                                                                 
008740        WHEN  -60                                                 
008750*--<       çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóùé∏îs >                 
008760           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008770           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008780           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008790           MOVE  "D19MSY"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008800           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
008810           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008820           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008830           CALL  CLOCO001          USING  IF-CHOCO001             
008840        WHEN  -70                                                 
008850*--<       ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóùé∏îs >           
008860           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008870           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008880           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008890           MOVE  "M01SAJ"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008900           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
008910           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008920           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008930           CALL  CLOCO001          USING  IF-CHOCO001             
008940        WHEN  -80                                                 
008950*--<       ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóùé∏îs >               
008960           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008970           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008980           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008990           MOVE  "SFHSED25"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009000           MOVE  "WRITE"              TO  ã§ÇPÅ|èàóùéØï           
009010           MOVE  ÇvÅ|èÛë‘             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009020           MOVE  "ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóùé∏îs "        
009030                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009040           CALL  CLOCO001          USING  IF-CHOCO001             
009050*                                                                 
009060        WHEN  OTHER                                               
009070           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
009080     END-EVALUATE.                                                
009090*                                                                 
009100     IF ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO  =  "Y"                              
009110*                                                                 
009130        PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ                               
009140                 THRU  åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                     
009150*                                                                 
009160*--<    ÉvÉçÉOÉâÉÄàŸèÌèIóπÇÃÉäÉ^Å[ÉìÉRÅ[Éh >                      
009170        MOVE  íËêîÅ|àŸèÌèÛë‘          TO  PROGRAM-STATUS          
009180*                                                                 
009190        EXIT  PROGRAM                                             
009200     END-IF.                                                      
009210*                                                                 
009220 ÉGÉâÅ[èàóùÅ|ÇdÇwÇhÇs.                                            
009230     EXIT.                                                        
009440******************************************************************
009450*                  END OF PROGRAM                                *
009460******************************************************************
