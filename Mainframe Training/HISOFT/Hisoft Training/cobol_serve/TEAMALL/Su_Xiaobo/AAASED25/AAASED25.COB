000010******************************************************************
000020*         CP(A)                                     *
000030*      1. vO  : O󕥎ct@C쐬                         *
000040*      2. vOID  : AAASED25  (o)                              *
000050*      3. Tv      : oi[쐬j
000060                         i[XO֘A[oj                *
000070*                                                                *
000080*      4. 쐬        : h                                 *
000090*      5. 쐬        : 2005.3.26                             *
000100******************************************************************
000110*                                                                 
000120******************************************************************
000130*    hcdmshehb`shnm  chuhrhnm              *
000140******************************************************************
000150 IDENTIFICATION                       DIVISION.                   
000160*                                                                 
000170 PROGRAM-ID.                          AAASED25  (o).                   
000180***********************************************************傤*******
000190*    dmuhqnmldms        chuhrhnm              *
000200******************************************************************
000210 ENVIRONMENT                          DIVISION. 
000220******************************************************************
000230*    hmots|ntsots      rdbshnm                *
000240******************************************************************
000250 INPUT-OUTPUT                         SECTION.                    
000260 FILE-CONTROL.                                                    
000270*                                                                 
000280     SELECT         o̓t@C  ASSIGN        TO   U11          
000290     FILE STATUS    IS     t@C                           
000300     ORGANIZATION   IS     LINE       SEQUENTIAL.     
000310******************************************************************
000320*    c`s`                      chuhrhnm              *
000330******************************************************************
000340 DATA                                 DIVISION.          
000350******************************************************************
000360*    FILE                          SECTION                      *
000370******************************************************************
000380   FILE                        SECTION
000390	 FD  o̓t@C                                                 
000400     LABEL  RECORD    IS              STANDARD                    
000410     BLOCK  CONTAINS  0               RECORDS.                    
000420*                                                                 
000430 01  ó|R[h.                                              
000440     COPY   CPSCE50.CBL   REPLACING      ==()==  BY  ==FIRST-==.   
000450******************************************************************
000460*  vnqjhmf|rsnq`fd  rdbshnm                *
000470******************************************************************
000480  WORKING-STORAGE                     SECTION.                    
000490*----------------------------------------------------------------*
000500*    zXgϐ`GA                                          *
000510*----------------------------------------------------------------*
000520     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +34.
           02  SQLFPN-FILENAME PIC X(34) VALUE "C:\COB97\SOC\AAASED25\AA
      -    "ASED25.PCO".

       01  SQ0001 GLOBAL.
           02  FILLER PIC X(81) VALUE "select ob`pƖN   into :b
      -    "1  from D70GYM_TBL where ƖǗhc='GYMKNRRC'".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +157234284.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +22.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 22 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 22 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 22 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 22 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 22 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 22 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 22 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 22 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 22 TIMES.


       01  SQ0002 GLOBAL.
           02  FILLER PIC X(160) VALUE "select M40MAB_TBL.R[h敪  
      -    ",M40MAB_TBL.op_敪  ,M40MAB_TBL.ڋq敪  ,D01TRS_
      -    "TBL.񂹃R[h  ,M40MAB_TBL.R[h  ,M40MAB_TB
      -    "L.".

           02  FILLER PIC X(160) VALUE "R[h  ,M40MAB_TBL._ԍ  ,M
      -    "40MAB_TBL._  ,M40MAB_TBL.SۃR[h  ,M40MAB_TBL.
      -    "ă[X  ,M40MAB_TBL.[JnN  ,M40MAB_TBL.[
      -    "  ,M40MA".

           02  FILLER PIC X(160) VALUE "B_TBL.O@  ,M40MAB_TBL.
      -    "  ,M40MAB_TBL.敪  ,D01TRS_TBL.於  ,D02SQ
      -    "S_TBL.於  ,M40MAB_TBL.Oc  ,M40MAB_TBL.
      -    "z  ,M".

           02  FILLER PIC X(159) VALUE "40MAB_TBL.z  ,M40MAB_TB
      -    "L.c   from M40MAB_TBL ,D02SQS_TBL ,D01TRS_TBL where
      -    " (((M40MAB_TBL.O󕥎c\ΏۃtO='1' and M40MAB_TBL
      -    ".".

           02  FILLER PIC X(160) VALUE "R[h=D01TRS_TBL.R
      -     "[h) and M40MAB_TBL.R[h=D02SQS_TBL.R
      -    "[h) and M40MAB_TBL.R[h=D02SQS_TBL.R[h(+)
      -    ") order b".

           02  FILLER PIC X(56) VALUE "y M40MAB_TBL.R[h敪,M40MAB_
      -    "TBL._ԍ           ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +212.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +216.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +81.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +245.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +86.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +855.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +339.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +101.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +365.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +22.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +204.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +739.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +219.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +14.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +32.
           02     FILLER PIC S9(4) COMP-5 VALUE +760.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000530*                                                                 
000540*--< nq`bkdʕϐ >                                       
000550     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
000560*                                                                 
000570*--< nq`bkd  rpks >                               
000010*--rpkʕϐ
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000580     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000590*                                                                 
000600*--< Oca >                                            
000610     
      *    EXEC  SQL  INCLUDE  M40MAB.CBL            END-EXEC.
000620*                                                                 
000630*--< ƖǗe[u >                                                
000010************************************************
000020* O(M40MAB)
000030************************************************
000040 01  lSO|R[h敪           PIC  X(1).
000050 01  lSO|_ԍ               PIC  X(15).
000060 01  lSO|ă[X           PIC S9(2) COMP-3.
000070 01  lSO|_               PIC  X(3).
000080 01  lSO|           PIC  X(8).
000090 01  lSO|rdp|mn     PIC S9(6) COMP-3.
000100 01  lSO|O@           PIC  X(1).
000110 01  lSO|OTCg         PIC S9(2) COMP-3.
000120 01  lSO|O             PIC  X(2).
000130 01  lSO|[Jn             PIC S9(3) COMP-3.
000140 01  lSO|[               PIC S9(3) COMP-3.
000150 01  lSO|[JnN           PIC  X(6).
000160 01  lSO|U萔             PIC S9(13) COMP-3.
000170 01  lSO|Oz               PIC S9(13) COMP-3.
000180 01  lSO|Oz         PIC S9(13) COMP-3.
000190 01  lSO|БOz           PIC S9(13) COMP-3.
000200 01  lSO|БOz     PIC S9(13) COMP-3.
000210 01  lSO|񕪗݌v         PIC S9(13) COMP-3.
000220 01  lSO|񕪏ŗ݌v       PIC S9(13) COMP-3.
000230 01  lSO|Љ񕪗݌v     PIC S9(13) COMP-3.
000240 01  lSO|Љ񕪏ŗ݌v   PIC S9(13) COMP-3.
000250 01  lSO|z               PIC S9(13) COMP-3.
000260 01  lSO|Жz           PIC S9(13) COMP-3.
000270 01  lSO|ԃR[h             PIC  N(2).
000280 01  lSO|sR[h             PIC  X(4).
000290 01  lSO|xXR[h             PIC  X(4).
000300 01  lSO|U˗l           PIC  X(48).
000310 01  lSO|O󕥎c\ΏۃtO PIC  X(1).
000320 01  lSO|\ΏۃtO PIC  X(1).
000330 01  lSO|vR[h         PIC  X(2).
000340 01  lSO|dtO|U֑O󃊁[X PIC  X(1).
000350 01  lSO|dtO|U֑O   PIC  X(1).
000360 01  lSO|dtO|U։   PIC  X(1).
000370 01  lSO|_Jn             PIC  X(8).
000380 01  lSO|R[h     PIC  X(9).
000390 01  lSO|ڋq敪               PIC  X(2).
000400 01  lSO|s`rrR[h         PIC  X(7).
000410 01  lSO|ݓ|N             PIC  X(8).
000420 01  lSO|敪         PIC  X(1).
000430 01  lSO|ő           PIC  X(1).
000440 01  lSO|R[h           PIC  X(5).
000450 01  lSO|_R[h     PIC  X(9).
000460 01  lSO|_R[h           PIC  X(5).
000470 01  lSO|SۃR[h         PIC  X(4).
000480 01  lSO|S҃R[h           PIC  X(8).
000490 01  lSO|敪               PIC  X(1).
000500 01  lSO|Ǘx         PIC  X(1).
000510 01  lSO|_敪             PIC  X(1).
000520 01  lSO|op_敪       PIC  X(1).
000530 01  lSO|敪               PIC  X(1).
000540 01  lSO|Oc             PIC S9(13) COMP-3.
000550 01  lSO|Oc         PIC S9(13) COMP-3.
000560 01  lSO|O񕪗݌v   PIC S9(13) COMP-3.
000570 01  lSO|O񕪏ŗ݌v PIC S9(13) COMP-3.
000580 01  lSO|OЉ񕪗݌v PIC S9(13) COMP-3.
000590 01  lSO|OЉ񕪏ŗ݌v PIC S9(13) COMP-3.
000600 01  lSO|Oz݌v       PIC S9(13) COMP-3.
000610 01  lSO|Oz݌v   PIC S9(13) COMP-3.
000620 01  lSO|OU֊z݌v       PIC S9(13) COMP-3.
000630 01  lSO|OU֊z݌v   PIC S9(13) COMP-3.
000640 01  lSO|񕪗         PIC S9(13) COMP-3.
000650 01  lSO|񕪏       PIC S9(13) COMP-3.
000660 01  lSO|Љ񕪗     PIC S9(13) COMP-3.
000670 01  lSO|Љ񕪏   PIC S9(13) COMP-3.
000680 01  lSO|z                 PIC S9(13) COMP-3.
000690 01  lSO|Љz             PIC S9(13) COMP-3.
000700 01  lSO|Љz       PIC S9(13) COMP-3.
000710 01  lSO|                 PIC  X(8).
000720 01  lSO|                   PIC  X(1).
000730 01  lSO|敪               PIC  X(2).
000740 01  lSO|z             PIC S9(13) COMP-3.
000750 01  lSO|z         PIC S9(13) COMP-3.
000760 01  lSO|z             PIC S9(13) COMP-3.
000770 01  lSO|z         PIC S9(13) COMP-3.
000780 01  lSO|z݌v             PIC S9(13) COMP-3.
000790 01  lSO|z݌v         PIC S9(13) COMP-3.
000800 01  lSO|                 PIC  X(8).
000810 01  lSO|U֊z             PIC S9(13) COMP-3.
000820 01  lSO|U֊z         PIC S9(13) COMP-3.
000830 01  lSO|U֓                 PIC  X(8).
000840 01  lSO|U֊z݌v             PIC S9(13) COMP-3.
000850 01  lSO|U֊z݌v         PIC S9(13) COMP-3.
000860 01  lSO|c             PIC S9(13) COMP-3.
000870 01  lSO|c         PIC S9(13) COMP-3.
000880 01  lSO|cO󌎐             PIC S9(3)V9(2) COMP-3.
000640     
      *    EXEC  SQL  INCLUDE  D70GYM.CBL            END-EXEC.
000650*                                                                 
000660*--< }X^>                                                  
000010************************************************
000020* ƖǗ(D70GYM)
000030************************************************
000040 01  cVO|ƖǗhc           PIC  X(8).
000050 01  cVO|ƖN               PIC  X(6).
000060 01  cVO|N               PIC  X(6).
000070 01  cVO|N               PIC  X(6).
000080 01  cVO|{               PIC  X(8).
000090 01  cVO|{               PIC  X(8).
000100 01  cVO|{             PIC  X(8).
000110 01  cVO|UP             PIC  X(2).
000120 01  cVO|UP               PIC  X(8).
000130 01  cVO|UP           PIC  X(8).
000140 01  cVO|U{P           PIC  X(8).
000150 01  cVO|UQ             PIC  X(2).
000160 01  cVO|UQ               PIC  X(8).
000170 01  cVO|UQ           PIC  X(8).
000180 01  cVO|U{Q           PIC  X(8).
000190 01  cVO|               PIC  X(8).
000200 01  cVO|             PIC  X(8).
000210 01  cVO|N               PIC  X(8).
000220 01  cVO|N             PIC  X(8).
000230 01  cVO|               PIC  X(8).
000240 01  cVO|             PIC  X(8).
000250 01  cVO|ŐVԍ         PIC S9(7) COMP-3.
000260 01  cVO|XVN             PIC  X(8).
000270 01  cVO|XV               PIC  X(8).
000280 01  cVO|XV                 PIC  X(8).
000290 01  cVO|͒S҃R[h       PIC  X(8).
000300 01  cVO|ob`pƖN       PIC  X(6).
000310 01  cVO|ob`pN       PIC  X(6).
000320 01  cVO|ob`pN       PIC  X(6).
000330 01  cVO|N         PIC  X(8).
000340 01  cVO|`FbNXgN PIC  X(8).
000350 01  cVO|ōx˗ԍ       PIC S9(10) COMP-3.
000360 01  cVO|JnN     PIC  X(8).
000370 01  cVO|Jn       PIC  X(8).
000380 01  cVO|IN     PIC  X(8).
000390 01  cVO|I       PIC  X(8).
000400 01  cVO|ON     PIC  X(8).
000410 01  cVO|ob`󋵃tO   PIC  X(1).
000670     
      *    EXEC  SQL  INCLUDE  D01TRS.CBL            END-EXEC.
000680*                                                                 
000690*--< }X^>                                                  
      *****************************************************************
      *   }X^(D01TRS_TBL)
      *****************************************************************
       01  }X^.
           03  cOP|R[h  PIC  X(009).
           03  cOP|񂹃R[h  PIC  X(040).
           03  cOP|於    PIC  X(080).
           03  cOP|Z  PIC  X(016).
           03  cOP|Ji
                                     PIC  X(040).
           03  cOP|X֔ԍ      PIC  X(007).
           03  cOP|[tR[h  PIC  X(011).
           03  cOP|ZP        PIC  X(060).
           03  cOP|ZQ        PIC  X(060).
           03  cOP|ZR        PIC  X(060).
           03  cOP|dbԍ      PIC  X(015).
           03  cOP|Ж        PIC  X(080).
           03  cOP|{        PIC S9(013) PACKED-DECIMAL.
           03  cOP|ݗN        PIC S9(004) PACKED-DECIMAL.
           03  cOP|ݗ        PIC S9(002) PACKED-DECIMAL.
           03  cOP|ڋq敪      PIC  X(002).
           03  cOP|Ƌ敪      PIC  X(001).
           03  cOP|]ƈ      PIC S9(006) PACKED-DECIMAL.
           03  cOP|ƎR[h    PIC  X(005).
           03  cOP|itN    PIC  X(003).
           03  cOP|S      PIC  X(008).
           03  cOP|ŏIԍ
                                     PIC S9(005) PACKED-DECIMAL.
           03  cOP|xŏIԍ
                                     PIC S9(005) PACKED-DECIMAL.
           03  cOP|SۃR[h
                                     PIC  X(004).
           03  cOP|itNQ  PIC  X(003).
           03  cOP|\Җ    PIC  X(020).
           03  cOP|AhX      PIC  X(040).
           03  cOP|ڋqgpstO
                                     PIC  X(001).
           03  cOP|^MR[h
                                     PIC  X(007).
           03  cOP|񐿋u敪
                                     PIC  X(001).
           03  cOP|ēt敪
                                     PIC  X(001).
           03  cOP|ă[Xp敪
                                     PIC  X(001).
           03  cOP|敪
                                     PIC  X(001).
           03  cOP|Ə    PIC  X(080).
           03  cOP|ƏX֔ԍ
                                     PIC  X(007).
           03  cOP|ƏZR[h
                                     PIC  X(011).
           03  cOP|ƏZQ  PIC  X(060).
           03  cOP|Ədbԍ
                                     PIC  X(015).
           03  cOP|N      PIC  X(008).
           03  cOP|Ǘx
                                     PIC  X(001).
           03  cOP|ݓ|N    PIC  X(008).
           03  cOP|ݓ|z      PIC S9(013) PACKED-DECIMAL.
           03  cOP|ݓ|RR[h
                                     PIC  X(002).
           03  cOP|ݓ|Rg  PIC  X(100).
           03  cOP|ݓ|\N
                                     PIC  X(008).
           03  cOP|f[^쐬v
                                     PIC  X(001).
           03  cOP|J[擾i敪
                                     PIC  X(001).
           03  cOP|JnN  PIC  X(006).
           03  cOP|nƔN      PIC  X(006).
           03  cOP|n          PIC  X(030).
           03  cOP|̔        PIC  X(030).
           03  cOP|d        PIC  X(030).
           03  cOP|v      PIC  X(020).
           03  cOP|v厝  PIC S9(003)V9(003) PACKED-DECIMAL.
           03  cOP|ۏؐlǗx
                                     PIC  X(001).
           03  cOP|ߋōiK
                                     PIC  X(001).
           03  cOP|ߋōiKXV
                                     PIC  X(008).
           03  cOP|ݍōiK
                                     PIC  X(001).
           03  cOP|ݍōiKXV
                                     PIC  X(008).
           03  cOP|pݍōiK
                                     PIC  X(001).
           03  cOP|pݍōiKXV
                                     PIC  X(008).
           03  cOP|[Xo̓tO
                                     PIC  X(001).
           03  cOP|ro̓tO
                                     PIC  X(001).
           03  cOP|po̓tO
                                     PIC  X(001).
           03  cOP|sR[h    PIC  X(004).
           03  cOP|xXR[h    PIC  X(003).
           03  cOP|\ҖE  PIC  X(020).
           03  cOP|]Ǝ햼      PIC  X(020).
           03  cOP|ZJi    PIC  X(040).
           03  cOP|Rg    PIC  X(120).
           03  cOP|鍑R[h    PIC  X(009).
           03  cOP|v厝
                                     PIC S9(010) PACKED-DECIMAL.
           03  cOP|吔        PIC S9(010) PACKED-DECIMAL.
           03  cOP|SƊE  PIC S9(007) PACKED-DECIMAL.
           03  cOP|SƊEА
                                     PIC S9(007) PACKED-DECIMAL.
           03  cOP|ƊE  PIC S9(007) PACKED-DECIMAL.
           03  cOP|ƊEА
                                     PIC S9(007) PACKED-DECIMAL.
           03  cOP|Ə      PIC S9(005) PACKED-DECIMAL.
           03  cOP|vƏ  PIC  X(120).
           03  cOP|p[XЖ
                                     PIC  X(040).
           03  cOP|XRAO]_
                                     PIC S9(003) PACKED-DECIMAL.
           03  cOP|鍑]_      PIC S9(003) PACKED-DECIMAL.
           03  cOP|it\tO
                                     PIC  X(001).
           03  cOP|it\R
                                     PIC  X(200).
           03  cOP|it        PIC  X(008).
           03  cOP|^MxzKp
                                     PIC  X(008).
           03  cOP|ЎJno
                                     PIC  X(160).
           03  cOP|ƖړI      PIC  X(100).
           03  cOP|\Pʋ敪  PIC  X(001).
           03  cOP|asl敪
                                     PIC  X(001).
           03  cOP|aslSxXR[h
                                     PIC  X(003).
           03  cOP|ʒm敪
                                     PIC  X(001).
           03  cOP|ʒmݒ
                                     PIC  X(008).
           03  cOP|aslAΏۋ敪
                                     PIC  X(001).
           03  cOP|anskAΏۋ敪
                                     PIC  X(001).
           03  cOP|e敪    PIC  X(001).
           03  cOP|mdskd`rhmfpΏۋ敪
                                     PIC  X(001).
           03  cOP|][XgR[h
                                     PIC  X(003).
           03  cOP|ƏZP  PIC  X(060).
           03  cOP|ƏZR  PIC  X(060).
           03  cOP|ƌZ    PIC  X(002).
           03  cOP|ʑ敪  PIC  X(001).
           03  cOP|ؓʋ敪
                                     PIC  X(001).
           03  cOP|ؓ    PIC  X(002).
           03  cOP|Sۍ    PIC S9(003) PACKED-DECIMAL.
           03  cOP|񂹃R[h
                                     PIC  X(008).
           03  cOP|XVN    PIC  X(008).
           03  cOP|XV      PIC  X(008).
           03  cOP|XV        PIC  X(008).
           03  cOP|o^N    PIC  X(008).
           03  cOP|o^      PIC  X(008).
           03  cOP|o^S    PIC  X(008).
           03  cOP|͒S҃R[h
                                     PIC  X(008).
000700     
      *    EXEC  SQL  INCLUDE  D02SQS.CBL            END-EXEC.
000710*                                                                 
000720*--< ږ̃}X^>                                                  
      *****************************************************************
      *   }X^(D02SQS_TBL)
      *****************************************************************
       01  }X^.
           03  cOQ|R[h  PIC  X(009).
           03  cOQ|R[h  PIC  X(005).
           03  cOQ|於    PIC  X(080).
           03  cOQ|喼      PIC  X(060).
           03  cOQ|SҖ    PIC  X(020).
           03  cOQ|\    PIC  X(001).
           03  cOQ|Ul      PIC  X(040).
           03  cOQ|X֔ԍ      PIC  X(007).
           03  cOQ|[tR[h  PIC  X(011).
           03  cOQ|ZQ        PIC  X(060).
           03  cOQ|ZR        PIC  X(060).
           03  cOQ|dbԍ      PIC  X(015).
           03  cOQ|ꊇR[h
                                     PIC  X(005).
           03  cOQ|t於    PIC  X(060).
           03  cOQ|t敔    PIC  X(060).
           03  cOQ|tS  PIC  X(020).
           03  cOQ|tJi
                                     PIC  X(040).
           03  cOQ|tX֔ԍ
                                     PIC  X(007).
           03  cOQ|tsR[h
                                     PIC  X(011).
           03  cOQ|tZQ  PIC  X(060).
           03  cOQ|tZR  PIC  X(060).
           03  cOQ|tdbԍ
                                     PIC  X(015).
           03  cOQ|}b`OΏۊO敪
                                     PIC  X(001).
           03  cOQ|TCg    PIC S9(002) PACKED-DECIMAL.
           03  cOQ|        PIC  X(002).
           03  cOQ|@      PIC  X(001).
           03  cOQ|Ԋu      PIC S9(002) PACKED-DECIMAL.
           03  cOQ|TCg    PIC S9(002) PACKED-DECIMAL.
           03  cOQ|      PIC  X(002).
           03  cOQ|Ԋu      PIC S9(002) PACKED-DECIMAL.
           03  cOQ|    PIC S9(002) PACKED-DECIMAL.
           03  cOQ|쐬ʐ      PIC S9(002) PACKED-DECIMAL.
           03  cOQ|쐬P      PIC  X(001).
           03  cOQ|쐬敪
                                     PIC  X(001).
           03  cOQ|wl敪
                                     PIC  X(001).
           03  cOQ|t敪      PIC  X(001).
           03  cOQ|摤Z@փR[h
                                     PIC  X(004).
           03  cOQ|摤xXR[h
                                     PIC  X(003).
           03  cOQ|摤
                                     PIC  X(001).
           03  cOQ|摤ԍ
                                     PIC  X(010).
           03  cOQ|UsR[h
                                     PIC  X(004).
           03  cOQ|UxXR[h
                                     PIC  X(003).
           03  cOQ|U  PIC  X(001).
           03  cOQ|Uԍ  PIC  X(010).
           03  cOQ|U`l    PIC  X(030).
           03  cOQ|  PIC  X(001).
           03  cOQ|t  PIC  X(001).
           03  cOQ|  PIC  X(001).
           03  cOQ|gp    PIC  X(001).
           03  cOQ|      PIC  X(001).
           03  cOQ|ԍ  PIC  X(001).
           03  cOQ|Ev    PIC  X(001).
           03  cOQ|Ev        PIC  X(060).
           03  cOQ|l    PIC  X(001).
           03  cOQ|Uē쐬敪
                                     PIC  X(001).
           03  cOQ|W敪      PIC  X(001).
           03  cOQ|XV      PIC  X(016).
           03  cOQ|XV        PIC  X(008).
           03  cOQ|tR[h  PIC  X(003).
           03  cOQ|zA  PIC S9(003) PACKED-DECIMAL.
           03  cOQ|ڋqgpstO
                                     PIC  X(001).
           03  cOQ|Rg    PIC  X(060).
           03  cOQ|͒S҃R[h
                                     PIC  X(008).
           03  cOQ|Ji  PIC  X(030).
           03  cOQ|_R[h  PIC  X(005).
           03  cOQ|LtO    PIC  X(001).
           03  cOQ|ZP        PIC  X(060).
           03  cOQ|ZJi  PIC  X(060).
           03  cOQ|e`wԍ    PIC  X(015).
           03  cOQ|U֋sR[h
                                     PIC  X(004).
           03  cOQ|U    PIC  X(002).
           03  cOQ|摤R[h
                                     PIC  X(002).
           03  cOQ|U萔S敪
                                     PIC  X(001).
           03  cOQ|S      PIC  X(008).
           03  cOQ|SۃR[h
                                     PIC  X(004).
           03  cOQ|o^N    PIC  X(008).
           03  cOQ|o^      PIC  X(008).
           03  cOQ|o^S    PIC  X(008).
           03  cOQ|XVN    PIC  X(008).
           03  cOQ|XV      PIC  X(008).
           03  cOQ|R[h
                                     PIC  X(008).
           03  cOQ|˗̓
                                     PIC  X(008).
           03  cOQ|Jn
                                     PIC  X(008).
000730     
      *    EXEC  SQL  INCLUDE  D19MSY.CBL            END-EXEC.
000740*                                                                 
000750*--< iʁjca>                                                  
      *****************************************************************
      *   ږ̃}X^(D19MSY_TBL)
      *****************************************************************
       01  ږ̃}X^.
           03  cPX|R[hmn    PIC  X(012).
           03  cPX|R[h        PIC  X(005).
           03  cPX|R[h      PIC  X(040).
           03  cPX|          PIC  X(060).
           03  cPX|XV      PIC  X(016).
           03  cPX|XV        PIC  X(008).
           03  cPX|ftHg敪
                                     PIC  X(001).
           03  cPX|pX[h͋敪
                                     PIC  X(001).
           03  cPX|\[g      PIC S9(003) PACKED-DECIMAL.
           03  cPX|͒S҃R[h
                                     PIC  X(008).
           03  cPX|o^N    PIC  X(008).
           03  cPX|o^      PIC  X(008).
           03  cPX|o^S    PIC  X(008).
           03  cPX|XVN    PIC  X(008).
           03  cPX|XV      PIC  X(008).
000760     
      *    EXEC  SQL  INCLUDE  M01SAJ.CBL            END-EXEC.
000770*                                                                 
000100************************************************
000200* ()(M01SAJ)
000300************************************************
000400 01  lOP|R[h敪           PIC  X(1).
000500 01  lOP|_ԍ               PIC  X(15).
000600 01  lOP|ă[X           PIC S9(2) COMP-3.
000700 01  lOP|_               PIC  X(3).
000800 01  lOP|A                   PIC S9(3) COMP-3.
000900 01  lOP|敪               PIC  X(1).
001000 01  lOP|񔄋p敪       PIC  X(1).
001100 01  lOP|N               PIC  X(6).
001200 01  lOP|R[h     PIC  X(9).
001300 01  lOP|ڋq敪               PIC  X(2).
001400 01  lOP|s`rrR[h         PIC  X(7).
001500 01  lOP|ݓ|N             PIC  X(8).
001600 01  lOP|敪         PIC  X(1).
001700 01  lOP|ő           PIC  X(1).
001800 01  lOP|_                 PIC  X(8).
001900 01  lOP|nN             PIC  X(8).
002000 01  lOP|_Jn             PIC  X(8).
002100 01  lOP|_I             PIC  X(8).
002200 01  lOP|                   PIC S9(3) COMP-3.
002300 01  lOP|_敪               PIC  X(1).
002400 01  lOP|[XJn敪         PIC  X(1).
002500 01  lOP|SۃR[h         PIC  X(4).
002600 01  lOP|S҃R[h           PIC  X(8).
002700 01  lOP|敪               PIC  X(1).
002800 01  lOP|ԃtO             PIC  X(1).
002900 01  lOP|_敪             PIC  X(1).
003000 01  lOP|ky敪           PIC  X(1).
003100 01  lOP|kyN           PIC  X(6).
003200 01  lOP|N               PIC  X(6).
003300 01  lOP|N           PIC  X(6).
003400 01  lOP|N           PIC  X(6).
003500 01  lOP|             PIC  X(8).
003600 01  lOP|N       PIC  X(6).
003700 01  lOP|ŐV           PIC S9(3) COMP-3.
003800 01  lOP|             PIC S9(3) COMP-3.
003900 01  lOP|Ԋu               PIC S9(2) COMP-3.
004000 01  lOP|Ԋu               PIC S9(2) COMP-3.
004100 01  lOP|x]o^N         PIC  X(6).
004200 01  lOP|x]mtO       PIC  X(1).
004300 01  lOP|TCg             PIC S9(2) COMP-3.
004400 01  lOP|@               PIC  X(1).
004500 01  lOP|ă[X敪           PIC  X(1).
004600 01  lOP|Ǘx         PIC  X(1).
004700 01  lOP|OtO             PIC  X(1).
004800 01  lOP|               PIC S9(1) COMP-3.
004900 01  lOP|R[h           PIC  X(5).
005000 01  lOP|_R[h     PIC  X(9).
005100 01  lOP|_R[h           PIC  X(5).
005200 01  lOP|xR[h       PIC  X(9).
005300 01  lOP|xR[h           PIC  X(5).
005400 01  lOP|G̑             PIC S9(13) COMP-3.
005500 01  lOP|ŐVz           PIC S9(13) COMP-3.
005600 01  lOP|ŐV             PIC S9(2)V9(7) COMP-3.
005700 01  lOP|ŐVŊz           PIC S9(13) COMP-3.
005800 01  lOP|_񑍊z           PIC S9(13) COMP-3.
005900 01  lOP|őz         PIC S9(13) COMP-3.
006000 01  lOP|ŐV_񑍊z           PIC S9(13) COMP-3.
006100 01  lOP|ŐVőz         PIC S9(13) COMP-3.
006200 01  lOP|ێ疳           PIC S9(3) COMP-3.
006300 01  lOP|z                 PIC S9(13) COMP-3.
006400 01  lOP|ŉz           PIC S9(13) COMP-3.
006500 01  lOP|ŐV             PIC  X(8).
006600 01  lOP|z           PIC S9(13) COMP-3.
006700 01  lOP|vz           PIC S9(13) COMP-3.
006800 01  lOP|擾z           PIC S9(13) COMP-3.
006900 01  lOP|tO             PIC  X(1).
007000 01  lOP|                 PIC  X(8).
007100 01  lOP|Y               PIC  X(5).
007200 01  lOP|Z_         PIC  X(3).
007300 01  lOP|ݕt               PIC S9(2)V9(7) COMP-3.
007400 01  lOP|ă[X萔         PIC S9(13) COMP-3.
007500 01  lOP|ϑێ敪           PIC  X(1).
007600 01  lOP|ϑێ瑊z       PIC S9(13) COMP-3.
007700 01  lOP|x]xz         PIC S9(13) COMP-3.
007800 01  lOP|O               PIC S9(3) COMP-3.
007900 01  lOP|̑_ދ敪     PIC  X(1).
008000 01  lOP|_ދ敪           PIC  X(1).
008100 01  lOP|_ޓR[h     PIC  X(2).
008200 01  lOP|x               PIC S9(13) COMP-3.
008300 01  lOP|z             PIC S9(13) COMP-3.
008400 01  lOP|Œ莑Y             PIC S9(13) COMP-3.
008500 01  lOP|N               PIC S9(2)V9(3) COMP-3.
008600 01  lOP|^p             PIC S9(2)V9(3) COMP-3.
008700 01  lOP|evz               PIC S9(13) COMP-3.
008800 01  lOP|evz|\           PIC S9(13) COMP-3.
008900 01  lOP|evz|           PIC S9(13) COMP-3.
009000 01  lOP|K葹Q{z       PIC S9(13) COMP-3.
009100 01  lOP|Mpی             PIC S9(13) COMP-3.
009200 01  lOP|Yی             PIC S9(13) COMP-3.
009300 01  lOP|ێ痿                 PIC S9(13) COMP-3.
009400 01  lOP|̑G             PIC S9(13) COMP-3.
009500 01  lOP|萔                 PIC S9(13) COMP-3.
009600 01  lOP|`             PIC  X(8).
009700 01  lOP|`               PIC S9(3) COMP-3.
009800 01  lOP|it敪               PIC  X(2).
009900 01  lOP|擾z               PIC S9(13) COMP-3.
010000 01  lOP|Еz         PIC S9(13) COMP-3.
010100 01  lOP|Еz       PIC S9(13) COMP-3.
010200 01  lOP|Е_񑍊z         PIC S9(13) COMP-3.
010300 01  lOP|Еőz       PIC S9(13) COMP-3.
010400 01  lOP|Ѝwz             PIC S9(13) COMP-3.
010500 01  lOP|cݒz             PIC S9(13) COMP-3.
010600 01  lOP|Ўcݒz         PIC S9(13) COMP-3.
010700 01  lOP|Љz             PIC S9(13) COMP-3.
010800 01  lOP|Љz       PIC S9(13) COMP-3.
010900 01  lOP|Њz       PIC S9(13) COMP-3.
011000 01  lOP|Њvz       PIC S9(13) COMP-3.
011100 01  lOP|tO             PIC  X(1).
011200 01  lOP|                 PIC  X(8).
011300 01  lOP|               PIC S9(3) COMP-3.
011400 01  lOP|敪               PIC  X(1).
011500 01  lOP|񗝗R               PIC  X(2).
011600 01  lOP|񏈗N           PIC  X(6).
011700 01  lOP|敪               PIC  X(1).
011800 01  lOP|N       PIC  X(6).
011900 01  lOP|N               PIC  X(6).
012000 01  lOP|񌎐               PIC S9(3) COMP-3.
012100 01  lOP|Oz           PIC S9(13) COMP-3.
012200 01  lOP|O㑍z           PIC S9(13) COMP-3.
012300 01  lOP|O㑍z       PIC S9(13) COMP-3.
012400 01  lOP|Oőz         PIC S9(13) COMP-3.
012500 01  lOP|Oőz     PIC S9(13) COMP-3.
012600 01  lOP|㑍z               PIC S9(13) COMP-3.
012700 01  lOP|㑍z           PIC S9(13) COMP-3.
012800 01  lOP|őz         PIC S9(13) COMP-3.
012900 01  lOP|őz     PIC S9(13) COMP-3.
013000 01  lOP|Oc       PIC S9(13) COMP-3.
013100 01  lOP|Oc   PIC S9(13) COMP-3.
013200 01  lOP|Oz݌v       PIC S9(13) COMP-3.
013300 01  lOP|Oz݌v   PIC S9(13) COMP-3.
013400 01  lOP|OŊz݌v     PIC S9(13) COMP-3.
013500 01  lOP|OŊz݌v PIC S9(13) COMP-3.
013600 01  lOP|z             PIC S9(13) COMP-3.
013700 01  lOP|zQ           PIC S9(13) COMP-3.
013800 01  lOP|z         PIC S9(13) COMP-3.
013900 01  lOP|őz       PIC S9(13) COMP-3.
014000 01  lOP|őzQ     PIC S9(13) COMP-3.
014100 01  lOP|őz   PIC S9(13) COMP-3.
014200 01  lOP|ŗ           PIC S9(2)V9(7) COMP-3.
014300 01  lOP|ŗQ         PIC S9(2)V9(7) COMP-3.
014400 01  lOP|ŗ       PIC S9(2)V9(7) COMP-3.
014500 01  lOP|z݌v       PIC S9(13) COMP-3.
014600 01  lOP|z݌v   PIC S9(13) COMP-3.
014700 01  lOP|Ŋz݌v     PIC S9(13) COMP-3.
014800 01  lOP|Ŋz݌v PIC S9(13) COMP-3.
014900 01  lOP|z݌v         PIC S9(13) COMP-3.
015000 01  lOP|z݌v     PIC S9(13) COMP-3.
015100 01  lOP|c       PIC S9(13) COMP-3.
015200 01  lOP|c   PIC S9(13) COMP-3.
015300 01  lOP|㑝z         PIC S9(13) COMP-3.
015400 01  lOP|㑝z     PIC S9(13) COMP-3.
015500 01  lOP|őz       PIC S9(13) COMP-3.
015600 01  lOP|őz   PIC S9(13) COMP-3.
015700 01  lOP|㌸z         PIC S9(13) COMP-3.
015800 01  lOP|㌸z     PIC S9(13) COMP-3.
015900 01  lOP|Ōz       PIC S9(13) COMP-3.
016000 01  lOP|Ōz   PIC S9(13) COMP-3.
016100 01  lOP|kyN PIC  X(6).
016200 01  lOP|kyN PIC  X(6).
016300 01  lOP|ky㑝z   PIC S9(13) COMP-3.
016400 01  lOP|ky㑝zQ PIC S9(13) COMP-3.
016500 01  lOP|ky㑝z PIC S9(13) COMP-3.
016600 01  lOP|kyőz PIC S9(13) COMP-3.
016700 01  lOP|kyőzQ PIC S9(13) COMP-3.
016800 01  lOP|kyőz PIC S9(13) COMP-3.
016900 01  lOP|kyN PIC  X(6).
017000 01  lOP|kyN PIC  X(6).
017100 01  lOP|ky㌸z   PIC S9(13) COMP-3.
017200 01  lOP|ky㌸zQ PIC S9(13) COMP-3.
017300 01  lOP|ky㌸z PIC S9(13) COMP-3.
017400 01  lOP|kyŌz PIC S9(13) COMP-3.
017500 01  lOP|kyŌzQ PIC S9(13) COMP-3.
017600 01  lOP|kyŌz PIC S9(13) COMP-3.
017700 01  lOP|kyŗ     PIC S9(2)V9(7) COMP-3.
017800 01  lOP|kyŗQ   PIC S9(2)V9(7) COMP-3.
017900 01  lOP|Oz             PIC S9(13) COMP-3.
018000 01  lOP|OzQ           PIC S9(13) COMP-3.
018100 01  lOP|Oz         PIC S9(13) COMP-3.
018200 01  lOP|Oőz       PIC S9(13) COMP-3.
018300 01  lOP|OőzQ     PIC S9(13) COMP-3.
018400 01  lOP|Oőz   PIC S9(13) COMP-3.
018500 01  lOP|Oz݌v       PIC S9(13) COMP-3.
018600 01  lOP|Oz݌v   PIC S9(13) COMP-3.
018700 01  lOP|OŊz݌v     PIC S9(13) COMP-3.
018800 01  lOP|OŊz݌v PIC S9(13) COMP-3.
018900 01  lOP|O{c         PIC S9(13) COMP-3.
019000 01  lOP|Oc         PIC S9(13) COMP-3.
019100 01  lOP|O{z݌v   PIC S9(13) COMP-3.
019200 01  lOP|Oz݌v   PIC S9(13) COMP-3.
019300 01  lOP|O{c         PIC S9(13) COMP-3.
019400 01  lOP|Oc         PIC S9(13) COMP-3.
019500 01  lOP|VK{z       PIC S9(13) COMP-3.
019600 01  lOP|VKz       PIC S9(13) COMP-3.
019700 01  lOP|{z         PIC S9(13) COMP-3.
019800 01  lOP|z         PIC S9(13) COMP-3.
019900 01  lOP|{c         PIC S9(13) COMP-3.
020000 01  lOP|c         PIC S9(13) COMP-3.
020100 01  lOP|{\z݌v PIC S9(13) COMP-3.
020200 01  lOP|\z݌v PIC S9(13) COMP-3.
020300 01  lOP|{z݌v   PIC S9(13) COMP-3.
020400 01  lOP|z݌v   PIC S9(13) COMP-3.
020500 01  lOP|{z݌v PIC S9(13) COMP-3.
020600 01  lOP|z݌v PIC S9(13) COMP-3.
020700 01  lOP|\z         PIC S9(13) COMP-3.
020800 01  lOP|{o߃[X     PIC S9(13) COMP-3.
020900 01  lOP|o߃[X     PIC S9(13) COMP-3.
021000 01  lOP|{[X       PIC S9(13) COMP-3.
021100 01  lOP|[X       PIC S9(13) COMP-3.
021200 01  lOP|O󃊁[Xz PIC S9(13) COMP-3.
021300 01  lOP|O󃊁[Xz PIC S9(13) COMP-3.
021400 01  lOP|O󃊁[Xz PIC S9(13) COMP-3.
021500 01  lOP|Oz       PIC S9(13) COMP-3.
021600 01  lOP|{O             PIC S9(13) COMP-3.
021700 01  lOP|O             PIC S9(13) COMP-3.
021800 01  lOP|O󃊁[Xc PIC S9(13) COMP-3.
021900 01  lOP|ݓ|z             PIC S9(13) COMP-3.
022000 01  lOP|ݕ뉿               PIC S9(13) COMP-3.
022100 01  lOP|ϗpN               PIC S9(2) COMP-3.
022200 01  lOP|ی               PIC S9(2) COMP-3.
022300 01  lOP|SԌ㓖^ PIC S9(13) COMP-3.
022400 01  lOP|ΏۃtO     PIC  X(1).
022500 01  lOP|V_ԍ             PIC  X(15).
022600 01  lOP|㒲tO     PIC  X(1).
022700 01  lOP|ύXtO     PIC  X(1).
022800 01  lOP|cƊTv_񒊏otO PIC  X(1).
022900 01  lOP|cƊTvotO PIC  X(1).
023000 01  lOP|cƏ敪             PIC  X(1).
023100 01  lOP|_e_񌏖       PIC  N(20).
023200 01  lOP|_񌏖           PIC  N(20).
023300 01  lOP|                 PIC  X(8).
023400 01  lOP|Г               PIC S9(2)V9(3) COMP-3.
023500 01  lOP|Ne               PIC S9(2)V9(3) COMP-3.
023600 01  lOP|̔i             PIC S9(13) COMP-3.
023700 01  lOP|G                   PIC S9(13) COMP-3.
023800 01  lOP|ŏI\         PIC  X(8).
023900 01  lOP|vR[h         PIC  X(2).
024000 01  lOP|ptO         PIC  X(1).
024100 01  lOP|nxz         PIC S9(13) COMP-3.
024200 01  lOP|dtO|       PIC  X(1).
024300 01  lOP|dtO|       PIC  X(1).
024400 01  lOP|ă[XGg PIC  X(8).
024500 01  lOP|ŋ敪             PIC  X(2).
024600 01  lOP|Ѝwz         PIC S9(13) COMP-3.
024700 01  lOP|ЍŐV_񑍊z       PIC S9(13) COMP-3.
024800 01  lOP|ЍŐVőz     PIC S9(13) COMP-3.
024900 01  lOP|Ќ_񑍊z           PIC S9(13) COMP-3.
025000 01  lOP|Gg     PIC  X(8).
025100 01  lOP|ptO             PIC  X(1).
025200 01  lOP|ă[XN       PIC  X(6).
025300 01  lOP|ă[Xp敪   PIC  X(1).
025400 01  lOP|ă[X\L敪 PIC  X(1).
025500 01  lOP|ă[X\tO     PIC  X(1).
025600 01  lOP|\tO         PIC  X(1).
025700 01  lOP|敪           PIC  X(1).
025800 01  lOP|Oz       PIC S9(13) COMP-3.
025900 01  lOP|OЊz   PIC S9(13) COMP-3.
026000 01  lOP|敪               PIC  X(1).
026100 01  lOP|RX[}@l敪     PIC  X(1).
026200 01  lOP|\A               PIC S9(4) COMP-3.
026300 01  lOP|cΏۊOtO   PIC  X(1).
026400 01  lOP|OԃtO         PIC  X(1).
026500 01  lOP|               PIC S9(3) COMP-3.
026600 01  lOP|               PIC S9(3) COMP-3.
026700 01  lOP|kyNQ PIC  X(6).
026800 01  lOP|kyNQ PIC  X(6).
026900 01  lOP|kyNQ PIC  X(6).
027000 01  lOP|kyNQ PIC  X(6).
027100 01  lOP|\         PIC  X(8).
027200 01  lOP|O{\z݌v PIC S9(13) COMP-3.
027300 01  lOP|O\z݌v PIC S9(13) COMP-3.
027400 01  lOP|ŐVΊO_ԍ       PIC  X(15).
027500 01  lOP|               PIC S9(13) COMP-3.
027600 01  lOP|           PIC S9(13) COMP-3.
027700 01  lOP|         PIC S9(13) COMP-3.
027800 01  lOP|ő     PIC S9(13) COMP-3.
027900 01  lOP|OЍŐV_񑍊z   PIC S9(13) COMP-3.
028000 01  lOP|OЍŐVőz PIC S9(13) COMP-3.
028100 01  lOP|O{c     PIC S9(13) COMP-3.
028200 01  lOP|Oc     PIC S9(13) COMP-3.
028300 01  lOP|O{z݌v PIC S9(13) COMP-3.
028400 01  lOP|Oz݌v PIC S9(13) COMP-3.
028500 01  lOP|O{c     PIC S9(13) COMP-3.
028600 01  lOP|Oc     PIC S9(13) COMP-3.
028700 01  lOP|VK{z   PIC S9(13) COMP-3.
028800 01  lOP|VKz   PIC S9(13) COMP-3.
028900 01  lOP|{z     PIC S9(13) COMP-3.
029000 01  lOP|z     PIC S9(13) COMP-3.
029100 01  lOP|{c     PIC S9(13) COMP-3.
029200 01  lOP|c     PIC S9(13) COMP-3.
029300 01  lOP|{\z݌v PIC S9(13) COMP-3.
029400 01  lOP|\z݌v PIC S9(13) COMP-3.
029500 01  lOP|\z     PIC S9(13) COMP-3.
029600 01  lOP|{o߃[X PIC S9(13) COMP-3.
029700 01  lOP|o߃[X PIC S9(13) COMP-3.
029800 01  lOP|{[X   PIC S9(13) COMP-3.
029900 01  lOP|[X   PIC S9(13) COMP-3.
030000 01  lOP|O󃊁[Xz PIC S9(13) COMP-3.
030100 01  lOP|O󃊁[Xz PIC S9(13) COMP-3.
030200 01  lOP|{O         PIC S9(13) COMP-3.
030300 01  lOP|O         PIC S9(13) COMP-3.
030400 01  lOP|Gg         PIC  X(8).
030500 01  lOP|O㑍ză[X   PIC S9(13) COMP-3.
030600 01  lOP|㑍ză[X       PIC S9(13) COMP-3.
030700 01  lOP|Oz݌vă[X PIC S9(13) COMP-3.
030800 01  lOP|ză[X     PIC S9(13) COMP-3.
030900 01  lOP|z݌vă[X PIC S9(13) COMP-3.
031000 01  lOP|z݌vă[X PIC S9(13) COMP-3.
031100 01  lOP|ky㑝ză[X PIC S9(13) COMP-3.
031200 01  lOP|ky㌸ză[X PIC S9(13) COMP-3.
031300 01  lOP|Oz݌vă[X PIC S9(13) COMP-3.
031400 01  lOP|ă[X敪   PIC  X(1).
031500 01  lOP|că[X PIC S9(13) COMP-3.
031600 01  lOP|Ocă[X PIC S9(13) COMP-3.
031700 01  lOP|Oőz     PIC S9(13) COMP-3.
031800 01  lOP|O󃊁[Xz PIC S9(13) COMP-3.
031900 01  lOP|Oz   PIC S9(13) COMP-3.
032000 01  lOP|O󃊁[Xc PIC S9(13) COMP-3.
032100 01  lOP|ݓ|zz   PIC S9(13) COMP-3.
032200 01  lOP|op_敪       PIC  X(1).
032300 01  lOP|z   PIC S9(13) COMP-3.
032400 01  lOP|z PIC S9(13) COMP-3.
032500 01  lOP|Gg     PIC  X(8).
032600 01  lOP|Oz       PIC S9(13) COMP-3.
032700 01  lOP|Oz   PIC S9(13) COMP-3.
032800 01  lOP|Oc       PIC S9(13) COMP-3.
032900 01  lOP|Oc   PIC S9(13) COMP-3.
033000 01  lOP|GgN   PIC  X(6).
033100 01  lOP|䒠|z     PIC S9(13) COMP-3.
033200 01  lOP|䒠|z PIC S9(13) COMP-3.
033300 01  lOP|䒠|Oz     PIC S9(13) COMP-3.
033400 01  lOP|䒠|Oz PIC S9(13) COMP-3.
033500 01  lOP|Sۋ敪               PIC  X(1).
033600 01  lOP|TCg         PIC S9(02) COMP-3.
033700 01  lOP|vN         PIC  X(8).
033800 01  lOP|_e|񏈗N PIC  X(6).
033900 01  lOP||񏈗N     PIC  X(6).
034000 01  lOP|񗚗|ݓ|z   PIC  S9(13) COMP-3.
034100 01  lOP|񗚗|ݓ|zvz PIC S9(13) COMP-3.
034200 01  lOP|ŗ       PIC S9(2)V9(7) COMP-3.
000780     
      *    EXEC  SQL  END  DECLARE          SECTION  END-EXEC.
000790*                                                                 
000800*----------------------------------------------------------------*
000810*    vnqjGA                                              *
000820*----------------------------------------------------------------*
000830 01  vnqj|GA.    
000840*----------------------------------------------------------------*
000850*77  cVO|ob`pƖN  PIC X(6).
000860 77  -1   PIC  X(060).
000870 77  -2   PIC  X(060).
000880 01   TEMPTALBE COPY M40MAB.CBL.
000890*--< G[p >                                               
000900     03  v|G[R[h             PIC S9(04).                 
000910*                                                                 
000920*--< tOAA >                                               
000930     03  tOAA.                                            
000940         05  v|I|tO         PIC  X(01).                 
000950         05  v|ُI|tO     PIC  X(01).                 
000960*                                                                 
000970*--< GA >                                                 
000980     03  GA.                                              
000990         05  v|́|           PIC  9(09).                 
001000         05  v|ó|           PIC  9(09).                 
001010*--< ʏ >                                                   
001020 01  v|ʏ.                                                
001030     03  v|VXet.                                        
001040         05  v|I                 PIC  X(02) VALUE  "20".     
001050         05  v|N               PIC  X(06).                 
001060     03  v|VXe             PIC  X(08).                 
001070     03  v|S                   PIC  X(08) VALUE "IKOPG   ".
001080*                                                                 
001090*----------------------------------------------------------------*
001100*    Tu[`                                              *
001110*----------------------------------------------------------------*
001120 01  CALL-AREA.                                                   
001130*--< ʃOTu[` >                                       
001140     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001150     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001160*                                                                 
001170*----------------------------------------------------------------*
001180*    bnoẍ                                                *
001190*----------------------------------------------------------------*
001200*--< ʃOpp[^ >                                       
001210 01  IF-CHOCO001.                                                 
001220     COPY  CHOCO001  REPLACING  ==()==  BY  ==P|==.           
001230*                                                                 
001240*----------------------------------------------------------------*
001250*    hmht@CǍTu[`pp^̈                *
001260*----------------------------------------------------------------*
001270 01  PARA-AREA.                                                   
001280     COPY CPBCO001.                                               
001290******************************************************************
001300*    萔pf[^`GA                                      *
001310******************************************************************
001320 CONSTANT                             SECTION.                    
001330 01  萔̈.                                                    
001340     03  萔|vOhc         PIC  X(08) VALUE "AAASED25".
001350     03  萔|vO           PIC  X(80)                  
001360                                      VALUE  "o".        
001370     03  萔|rpknj             PIC S9(04)  VALUE  ZERO.    
001380     03  萔|rpkdmc           PIC S9(04)  VALUE  0100.    
001390     03  萔|               PIC S9(04)  VALUE  ZERO.    
001400     03  萔|ُ               PIC S9(04)  VALUE  0009.    
001410******************************************************************
001420*    oqnbdctqd            chuhrhnm              *
001430******************************************************************
001440 PROCEDURE                            DIVISION.                   
001450*                                                                 
001460     PERFORM  .                                           
001470*                                                                 
001480     PERFORM  又  UNTIL  v|I|tO  =  "Y".            
001490*                                                                 
001500     PERFORM  I.                                           
001510*                                                                 
001520     STOP     RUN.                                                
001530*                                                                 
001540******************************************************************
001550*                                                        *
001560******************************************************************
001570                              SECTION.                    
001580 |rs`qs.                                            
001590*                                                                 
001600*----------------------------------------------------------------*
001610*    JnbZ[Wo͏                                      *
001620*----------------------------------------------------------------*
001630     INITIALIZE                       IF-CHOCO001.                
001640     MOVE  "3"                        TO  P|Cxg.     
001650     MOVE  萔|vOhc       TO  P|\[Xhc.       
001660     MOVE  "0"                        TO  P|AR[h.       
001670     MOVE  "START"                    TO  P|.         
001680     MOVE  萔|vO         TO  P|̑bZ[W. 
001690     CALL  CLOCO001                USING  IF-CHOCO001.            
001700*                                                                 
001710*----------------------------------------------------------------*
001720*    Ɨ̈̏l                                        *
001730*----------------------------------------------------------------*
001740     MOVE  SPACE                      TO  vnqj|GA.       
001750     INITIALIZE                           vnqj|GA.       
001760*                                                                               
001770*                                                                 
001780*--< bott擾 >                                           
001790     ACCEPT  v|N               FROM  DATE.                 
001800*                                                                 
001810*--< bot擾 >                                           
001820     ACCEPT  v|VXe         FROM  TIME.                 
001830*                                                                 
001840*--< nq`bkdڑ >                                           
001850     PERFORM   nq`bkdڑ.                                  
001860*                                                                 
001870*--< e[uJ[\` >                                   
001880     PERFORM  e[uJ[\`.                           
001890*                                                                 
001900*--< e[uJ[\Ǎ(P) >                           
001910     PERFORM  e[uJ[\Ǎ.                           
001920*                                                                 
001930 |dwhs.                                              
001940     EXIT.                                                        
001950******************************************************************
001960*    nq`bkdڑ                                            *
001970******************************************************************
001980 nq`bkdڑ                     SECTION.                    
001990 nq`bkdڑ|rs`qs.                                    
002000*                                                                 
002010*--< caڑp擾 >                                   
002020     CALL  COBCO001                USING  PARA-AREA.              
002030*                                                                 
002040     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002050     MOVE  PARA-USERNAME              TO  USERNAME.               
002060     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002070*                                                                 
002080*----------------------------------------------------------------*
002090*    Jnڑ                                                    *
002100*----------------------------------------------------------------*
002110     IF    DB-STRING  =  SPACE                                    
002120        
      *       EXEC SQL                                                  
002130*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002140*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002150     ELSE                                                         
002160        
      *       EXEC SQL                                                  
002170*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002180*            USING  :DB-STRING                                    
002190*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002200     END-IF.                                                      
002210*                                                                 
002220*----------------------------------------------------------------*
002230*    ڑmF                                                    *
002240*----------------------------------------------------------------*
002250     EVALUATE  SQLCODE                                            
002260        WHEN   萔|rpknj                                   
002270           CONTINUE                                               
002280        WHEN   OTHER                                              
002290*--<       ڑG[ >                                           
002300           MOVE     -10               TO  v|G[R[h        
002310           PERFORM  G[菈                                
002320     END-EVALUATE.                                                
002330*                                                                 
002340 nq`bkdڑ|dwhs.                                      
002350     EXIT.                                                        
002360******************************************************************
002370*        e[uJ[\`                                *
002380******************************************************************
002390 e[uJ[\`             SECTION.                    
002400 e[uJ[\`|rs`qs.                            
002410*                                                                 
002420*----------------------------------------------------------------*
002430*    J[\nodm                                        *
002440*----------------------------------------------------------------*
002450       
      *      EXEC SQL                                                     
002460*       SELECT     ob`pƖN@
002470*   @     INTO    :cVO|ob`pƖN    
002480*         FROM     D70GYM_TBL                                           
002490*        WHERE     ƖǗhc = 'GYMKNRRC'
002500*     END-EXEC.
             CALL "SQLADR" USING SQ0001 SQL-STMT
             MOVE 1 TO SQL-ITERS
             MOVE 67 TO SQL-OFFSET
             MOVE 0 TO SQL-OCCURS
             MOVE 1 TO SQL-SELERR
             CALL "SQLADR" USING
                 SQLCUD
                 SQL-CUD
             CALL "SQLADR" USING
                 SQLCA
                 SQL-SQLEST
             MOVE 256 TO SQL-SQLETY
             CALL "SQLADR" USING
                 cVO|ob`pƖN
                 SQL-SQHSTV(1)
             MOVE 6 TO SQL-SQHSTL(1)
             MOVE 0 TO SQL-SQHSTS(1)
             MOVE 0 TO SQL-SQINDV(1)
             MOVE 0 TO SQL-SQINDS(1)
             MOVE 0 TO SQL-SQHARM(1)
             CALL "SQLADR" USING
                 SQL-SQHSTV(1)
                 SQL-SQPHSV
             CALL "SQLADR" USING
                 SQL-SQHSTL(1)
                 SQL-SQPHSL
             CALL "SQLADR" USING
                 SQL-SQHSTS(1)
                 SQL-SQPHSS
             CALL "SQLADR" USING
                 SQL-SQINDV(1)
                 SQL-SQPIND
             CALL "SQLADR" USING
                 SQL-SQINDS(1)
                 SQL-SQPINS
             CALL "SQLADR" USING
                 SQL-SQHARM(1)
                 SQL-SQPARM
             CALL "SQLADR" USING
                 SQL-SQHARC(1)
                 SQL-SQPARC

             CALL "SQLBEX" USING
                 SQLCTX
                 SQLEXD
                 SQLFPN

             CALL "SQLGSS" USING
                SQLSTATE
                 .
002510
002520*---------------------------------------------------------------*
002530*    J[\nodmmF                             
002540    EVALUATE  SQLCODE                                            
002550        WHEN  0                                    
002560*--<        >                                                 
002570           CONTINUE                                               
002580        WHEN  OTHER                                               
002590*--<       J[\nodmG[ >                                      
002600           PERFORM  G[菈                                
002610     END-EVALUATE.                                                
002620*                                                                 
002630 e[uJ[\`|dwhs.                              
002640     EXIT.
002650*----------------------------------------------------------------*
002660*    J[\nodm                                        *
002670*----------------------------------------------------------------*
002680      
      *     EXEC SQL
002690
002700*     DECLARE CUR1 CURSOR FOR
002710
002720*     SELECT
002730*             M40MAB_TBL.R[h敪
002740
002750* 	   ,M40MAB_TBL.op_敪
002760
002770* 	   ,M40MAB_TBL.ڋq敪
002780
002790* 	   ,D01TRS_TBL.񂹃R[h
002800
002810* 	   ,M40MAB_TBL.R[h
002820
002830* 	   ,M40MAB_TBL.R[h
002840
002850* 	   ,M40MAB_TBL._ԍ
002860
002870* 	   ,M40MAB_TBL._
002880
002910* 	   ,M40MAB_TBL.SۃR[h
002920
002930* 	   ,M40MAB_TBL.ă[X
002940
002950* 	   ,M40MAB_TBL.[JnN
002960
002970* 	   ,M40MAB_TBL.[
002980
002990* 	   ,M40MAB_TBL.O@
003000
003010* 	   ,M40MAB_TBL.
003020
003030* 	   ,M40MAB_TBL.敪
003040
003050* 	   ,D01TRS_TBL.於
003060
003070* 	   ,D02SQS_TBL.於
003080
003090* 	   ,M40MAB_TBL.Oc
003100
003110* 	   ,M40MAB_TBL.z
003120
003130* 	   ,M40MAB_TBL.z
003140
003150* 	   ,M40MAB_TBL.c
003160
003170*     FROM  M40MAB_TBL
003180
003190*          ,D02SQS_TBL
003200
003210* 	 ,D01TRS_TBL
003220
003230*     WHERE
003240*          M40MAB_TBL.O󕥎c\ΏۃtO = '1'
003250
003260*      AND M40MAB_TBL.R[h = D01TRS_TBL.R[h(+)
003270
003280*      AND M40MAB_TBL.R[h = D02SQS_TBL.R[h(+)
003290
003300*      AND M40MAB_TBL.R[h = D02SQS_TBL.R[h(+)
003310
003320*     ORDER BY
003330*           M40MAB_TBL.R[h敪
003340
003350* 	 ,M40MAB_TBL._ԍ
003360*
003370*      END-EXEC.
003380*----------------------------------------------------------------*
003390*    J[\nodm                                        *
003400*----------------------------------------------------------------*
003410 J[\nodm.   
      *              EXEC  SQL                                                    
003420*                      OPEN  CUR1                                                
003430*                      END-EXEC.
            CALL "SQLADR" USING SQ0002 SQL-STMT
            MOVE 1 TO SQL-ITERS
            MOVE 86 TO SQL-OFFSET
            MOVE 0 TO SQL-OCCURS
            MOVE 1 TO SQL-SELERR
            CALL "SQLADR" USING
                SQLCUD
                SQL-CUD
            CALL "SQLADR" USING
                SQLCA
                SQL-SQLEST
            MOVE 256 TO SQL-SQLETY

            CALL "SQLBEX" USING
                SQLCTX
                SQLEXD
                SQLFPN

            CALL "SQLGSS" USING
               SQLSTATE
                .
003440*                                                                 
003450*----------------------------------------------------------------*
003460*    J[\nodmmF                                        *
003470*----------------------------------------------------------------*
003480     EVALUATE  SQLCODE                                            
003490        WHEN  萔|rpknj                                    
003500*--<        >                                                 
003510           CONTINUE                                               
003520        WHEN  OTHER                                               
003530*--<       J[\nodmG[ >                               
003540           MOVE -20                   TO  v|G[R[h        
003550           PERFORM  G[菈                                
003560     END-EVALUATE.                                                
003570*                                                                
003580 e[uJ[\`|dwhs.                              
003590     EXIT.                                                        
003600******************************************************************
003610*    e[uJ[\Ǎ                                    *
003620******************************************************************
003630 e[uJ[\Ǎ             SECTION.                    
003640 e[uJ[\Ǎ|rs`qs.                            
003650*                                                                 
003660*--< e[uJ[\Ǎ >                                   
003670     
      *    EXEC SQL 
003680
003690*        FETCH  CUR1  
003700
003710*         INTO
003720
003730*            :lSO|R[h敪
003740
003750* 	   ,:lSO|op_敪
003760
003770* 	   ,:lSO|ڋq敪
003780
003790* 	   ,:cOP|񂹃R[h
003800
003810* 	   ,:lSO|R[h
003820
003830* 	   ,:lSO|R[h
003840
003850* 	   ,:lSO|_ԍ
003860
003870* 	   ,:lSO|_
003880
003890* 	   ,:cVO|ob`pƖN
003900
003910* 	   ,:lSO|SۃR[h	
003920
003930* 	   ,:lSO|ă[X
003940
003950* 	   ,:lSO|[JnN
003960
003970* 	   ,:lSO|[
003980
003990* 	   ,:lSO|O@
004000
004010* 	   ,:lSO|
004020
004030* 	   ,:lSO|敪
004040
004050* 	   ,:cOP|於
004060
004070* 	   ,:cOQ|於
004080
004090* 	   ,:lSO|Oc
004100
004110* 	   ,:lSO|z
004120
004130* 	   ,:lSO|z
004140
004150* 	   ,:lSO|c
004160
004170*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 101 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               lSO|R[h敪
               SQL-SQHSTV(1)
           MOVE 1 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               lSO|op_敪
               SQL-SQHSTV(2)
           MOVE 1 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               lSO|ڋq敪
               SQL-SQHSTV(3)
           MOVE 2 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               cOP|񂹃R[h IN
               }X^
               SQL-SQHSTV(4)
           MOVE 40 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               lSO|R[h
               SQL-SQHSTV(5)
           MOVE 9 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               lSO|R[h
               SQL-SQHSTV(6)
           MOVE 5 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               lSO|_ԍ
               SQL-SQHSTV(7)
           MOVE 15 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               lSO|_
               SQL-SQHSTV(8)
           MOVE 3 TO SQL-SQHSTL(8)
           MOVE 0 TO SQL-SQHSTS(8)
           MOVE 0 TO SQL-SQINDV(8)
           MOVE 0 TO SQL-SQINDS(8)
           MOVE 0 TO SQL-SQHARM(8)
           CALL "SQLADR" USING
               cVO|ob`pƖN
               SQL-SQHSTV(9)
           MOVE 6 TO SQL-SQHSTL(9)
           MOVE 0 TO SQL-SQHSTS(9)
           MOVE 0 TO SQL-SQINDV(9)
           MOVE 0 TO SQL-SQINDS(9)
           MOVE 0 TO SQL-SQHARM(9)
           CALL "SQLADR" USING
               lSO|SۃR[h
               SQL-SQHSTV(10)
           MOVE 4 TO SQL-SQHSTL(10)
           MOVE 0 TO SQL-SQHSTS(10)
           MOVE 0 TO SQL-SQINDV(10)
           MOVE 0 TO SQL-SQINDS(10)
           MOVE 0 TO SQL-SQHARM(10)
           CALL "SQLADR" USING
               lSO|ă[X
               SQL-SQHSTV(11)
           MOVE 2 TO SQL-SQHSTL(11)
           MOVE 0 TO SQL-SQHSTS(11)
           MOVE 0 TO SQL-SQINDV(11)
           MOVE 0 TO SQL-SQINDS(11)
           MOVE 0 TO SQL-SQHARM(11)
           CALL "SQLADR" USING
               lSO|[JnN
               SQL-SQHSTV(12)
           MOVE 6 TO SQL-SQHSTL(12)
           MOVE 0 TO SQL-SQHSTS(12)
           MOVE 0 TO SQL-SQINDV(12)
           MOVE 0 TO SQL-SQINDS(12)
           MOVE 0 TO SQL-SQHARM(12)
           CALL "SQLADR" USING
               lSO|[
               SQL-SQHSTV(13)
           MOVE 2 TO SQL-SQHSTL(13)
           MOVE 0 TO SQL-SQHSTS(13)
           MOVE 0 TO SQL-SQINDV(13)
           MOVE 0 TO SQL-SQINDS(13)
           MOVE 0 TO SQL-SQHARM(13)
           CALL "SQLADR" USING
               lSO|O@
               SQL-SQHSTV(14)
           MOVE 1 TO SQL-SQHSTL(14)
           MOVE 0 TO SQL-SQHSTS(14)
           MOVE 0 TO SQL-SQINDV(14)
           MOVE 0 TO SQL-SQINDS(14)
           MOVE 0 TO SQL-SQHARM(14)
           CALL "SQLADR" USING
               lSO|
               SQL-SQHSTV(15)
           MOVE 8 TO SQL-SQHSTL(15)
           MOVE 0 TO SQL-SQHSTS(15)
           MOVE 0 TO SQL-SQINDV(15)
           MOVE 0 TO SQL-SQINDS(15)
           MOVE 0 TO SQL-SQHARM(15)
           CALL "SQLADR" USING
               lSO|敪
               SQL-SQHSTV(16)
           MOVE 2 TO SQL-SQHSTL(16)
           MOVE 0 TO SQL-SQHSTS(16)
           MOVE 0 TO SQL-SQINDV(16)
           MOVE 0 TO SQL-SQINDS(16)
           MOVE 0 TO SQL-SQHARM(16)
           CALL "SQLADR" USING
               cOP|於 IN
               }X^
               SQL-SQHSTV(17)
           MOVE 80 TO SQL-SQHSTL(17)
           MOVE 0 TO SQL-SQHSTS(17)
           MOVE 0 TO SQL-SQINDV(17)
           MOVE 0 TO SQL-SQINDS(17)
           MOVE 0 TO SQL-SQHARM(17)
           CALL "SQLADR" USING
               cOQ|於 IN
               }X^
               SQL-SQHSTV(18)
           MOVE 80 TO SQL-SQHSTL(18)
           MOVE 0 TO SQL-SQHSTS(18)
           MOVE 0 TO SQL-SQINDV(18)
           MOVE 0 TO SQL-SQINDS(18)
           MOVE 0 TO SQL-SQHARM(18)
           CALL "SQLADR" USING
               lSO|Oc
               SQL-SQHSTV(19)
           MOVE 7 TO SQL-SQHSTL(19)
           MOVE 0 TO SQL-SQHSTS(19)
           MOVE 0 TO SQL-SQINDV(19)
           MOVE 0 TO SQL-SQINDS(19)
           MOVE 0 TO SQL-SQHARM(19)
           CALL "SQLADR" USING
               lSO|z
               SQL-SQHSTV(20)
           MOVE 7 TO SQL-SQHSTL(20)
           MOVE 0 TO SQL-SQHSTS(20)
           MOVE 0 TO SQL-SQINDV(20)
           MOVE 0 TO SQL-SQINDS(20)
           MOVE 0 TO SQL-SQHARM(20)
           CALL "SQLADR" USING
               lSO|z
               SQL-SQHSTV(21)
           MOVE 7 TO SQL-SQHSTL(21)
           MOVE 0 TO SQL-SQHSTS(21)
           MOVE 0 TO SQL-SQINDV(21)
           MOVE 0 TO SQL-SQINDS(21)
           MOVE 0 TO SQL-SQHARM(21)
           CALL "SQLADR" USING
               lSO|c
               SQL-SQHSTV(22)
           MOVE 7 TO SQL-SQHSTL(22)
           MOVE 0 TO SQL-SQHSTS(22)
           MOVE 0 TO SQL-SQINDV(22)
           MOVE 0 TO SQL-SQINDS(22)
           MOVE 0 TO SQL-SQHARM(22)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004180*                                                                 
004190*----------------------------------------------------------------*
004200*    e[uJ[\ǍmF                              *
004210*----------------------------------------------------------------*
004220     EVALUATE   SQLCODE                                           
004230        WHEN   萔|rpknj                                   
004240*--<        >                                                                 
004250           COMPUTE  v|́|  =  v|́|  +  1       
004260        WHEN   萔|rpkdmc                                 
004270*--<       ǍI >                                             
004280           MOVE  "Y"                  TO  v|I|tO        
004290        WHEN   OTHER                                              
004300*--<       ǍG[ >                                           
004310           MOVE     -30               TO  v|G[R[h        
004320           PERFORM  G[菈                                
004330     END-EVALUATE.                                                
004340*                                                                 
004350 e[uJ[\Ǎ|dwhs.                              
004360     EXIT.                                                        
004370******************************************************************
004380*    又                                                      *
004390******************************************************************
004400 又                               SECTION.                    
004410 又|rs`qs.                                              
004420*                                                                 
004430     PERFORM  又-1.                                       
004440*                      
004450                                                            
004460     PERFORM  又-2.
004470*                          
004480*
004490     PERFORM  又-3.
004500*   
004510*                                                                 
004520     PERFORM  又-4.
004530*   
004540*                                                                 
004550     PERFORM  又-5.                                       
004560*   
004570*   
004580*--< e[uJ[\ǍiQڈȍ~j >                     
004590     PERFORM  e[uJ[\Ǎ.                           
004600*                                                                 
004610     IF  v|I|tO  =  "Y"                                 
004620*--<    ̓f[^I鎞Ōo͏ >                          
004630        PERFORM  o͏                                         
004640     END-IF.                                                      
004650*                                                                                                                
004660******************************************************************
004670*     又-1                                               *
004680******************************************************************
004690 又-1                         SECTION.                    
004700 又-1|rs`qs.                                        
004710*    
004720     EXEC-SQL
004730
004740     OPEN D19MSY_TBL.
004750      
004760	   SELECT 
004770	   INTO -1
004780	   FROM D19MSY_TBL
004790     WHERE ږ̃}X^.R[hmn  = :ORW: 
004800       AND SUBSTR(ږ̃}X^.R[h,1,1) = Oca.op_敪
004810
004820     SELECT 
004830	   INTO -2
004840     WHERE  ږ̃}X^.R[hmn  = :OOT:
004850
004860     AND SUBSTR(ږ̃}X^.R[h,1,2)=Oca.ڋq敪
004870
004880	    EXEC-END.  
004890
004900*----------------------------------------------------------------*
004910*       又-2                                              *
004920*----------------------------------------------------------------*
004930     IF M01SAJ_TBL.R[h敪 = '1'
004940
004950    AND M01SAJ_TBL._ԍ = M40MAB_TBL._ԍ
004960
004970	  AND M01SAJ_TBL.ă[X = M40MAB_TBL.ă[X
004980
004990	  AND M01SAJ_TBL._ = M40MAB_TBL._
005000
005010     MOVE M40MAB_TBL.ԃtO TO TEMPTABLE.ԃtO
005020
005030	   MOVE M40MAB_TBL._񌏖 TO TEMPTABLE._񌏖
005040
005050	   MOVE M40MAB_TBL.Sۋ敪 TO TEMPTABLE.Sۋ敪.
005060*                                                                 
005070*----------------------------------------=------------------------*
005080*       又-3                                             *
005090*----------------------------------------------------------------*
005100*       
005110        IF M01SAJ_TBL.Sۋ敪 NOT = 'P'
005120
005130	      PERFORM 又-4-1
005140
005150	      ELSE 
005160
005170	      PERFORM 又-4-2.
005180*----------------------------------------=------------------------*
005190*       又-4                                             *
005200*----------------------------------------------------------------*
005210  又-4-1.
005220	   IF M40MAB_TBL.敪 = 'Q'
005230
005240        PERFORM Е  .
005250
005260	      MOVE M40MAB_TBL.op_敪 TO FIRST-_敪
005270
005280	      MOVE M40MAB_TBL.ڋq敪 TO FIRST-A敪
005290
005300	      MOVE D01TRS_TBL.񂹃R[h TO FIRST-񂹃R[h
005310
005320        MOVE M40MAB_TBL.R[hR[h敪 TO FIRST-R[h
005330
005340	      MOVE M40MAB_TBL.R[h TO FIRST-R[h
005350
005360	      MOVE M40MAB_TBL._ԍ TO FIRST-_ԍ
005370
005380	      MOVE M40MAB_TBL._ TO FIRST-_
005390
005400	      MOVE cVO|ob`pƖN TO FIRST-ƖN
005410
005420	      MOVE M40MAB_TBL.SۃR[h TO FIRST-SۃR[h
005430
005440	      MOVE TEMPTABLE._񌏖 TO FIRST-_񌏖
005450
005460	      MOVE M40MAB_TBL.ă[X TO FIRST-ă[X
005470
005480	      MOVE M40MAB_TBL.[JnN TO FIRST-[JnN
005490
005500	      MOVE M40MAB_TBL.[ TO FIRST-[
005510
005520	      MOVE M40MAB_TBL.O@ TO FIRST-O@
005530
005540	      MOVE M40MAB_TBL. TO FIRST-
005550
005560	      MOVE M40MAB_TBL.敪 TO FIRST-敪
005570
005580	      MOVE D01TRS_TBL.於 TO FIRST-於
005590
005600	      MOVE D02SQS_TBL.於 TO FIRST-於
005610
005620	      MOVE -1 TO FIRST-_敪
005630
005640	      MOVE -2 TO FIRST-A敪
005650
005660	      MOVE M40MAB_TBL.Oc TO FIRST-Oc
005670
005680	      MOVE M40MAB_TBL.z TO FIRST-z
005690
005700	      MOVE M40MAB_TBL.z TO FIRST-z
005710
005720	      MOVE M40MAB_TBL.c TO FIRST-c
005730
005740	      IF FIRST-Oc NOT = 0
005750	      
005760	      OR FIRST-z NOT = 0
005770
005780	      OR FIRST-z NOT = 0
005790
005800	      OR FIRST-c NOT = 0
005810
005820        WRITE ó|R[h.
005830
005840	      ELSE
005850
005860	      NEXT SENTENCE
005870	                                                                                                      
005880        ELSE
005890*--------------------------------------------------------------------*
005900*                 SECOND PART                                        *
005910*--------------------------------------------------------------------*
005920又-4-2.
005930	      PERFORM Е  .
005940	      	      
005950	      MOVE M40MAB_TBL.R[h敪 TO FIRST-O敪
005960
005970	      MOVE M40MAB_TBL.op_敪 TO FIRST-_敪
005980
005990	      MOVE M40MAB_TBL.ڋq敪 TO FIRST-A敪
006000
006010	      MOVE D01TRS_TBL.񂹃R[h TO FIRST-񂹃R[h
006020
006030        MOVE M40MAB_TBL.R[hR[h敪 TO FIRST-R[h
006040
006050	      MOVE M40MAB_TBL.R[h TO FIRST-R[h
006060
006070	      MOVE M40MAB_TBL._ԍ TO FIRST-_ԍ
006080
006090	      MOVE M40MAB_TBL._ TO FIRST-_
006100
006110	      MOVE D70GYM_TBL.ob`pƖN TO FIRST-ƖN
006120
006130	      MOVE M40MAB_TBL.SۃR[h TO FIRST-SۃR[h
006140
006150	      MOVE TEMPTABLE._񌏖 TO FIRST-_񌏖
006160
006170	      MOVE M40MAB_TBL.ă[X TO FIRST-ă[X
006180
006190	      MOVE M40MAB_TBL.[JnN TO FIRST-[JnN
006200
006210	      MOVE M40MAB_TBL.[ TO FIRST-[
006220
006230	      MOVE M40MAB_TBL.O@ TO FIRST-O@
006240
006250	      MOVE M40MAB_TBL. TO FIRST-
006260
006270	      MOVE M40MAB_TBL.敪 TO FIRST-敪
006280
006290	      MOVE D01TRS_TBL.於 TO FIRST-於
006300
006310	      MOVE D02SQS_TBL.於 TO FIRST-於
006320
006330	      MOVE -1 TO FIRST-_敪
006340
006350	      MOVE -2 TO FIRST-A敪
006360
006370	      MOVE M40MAB_TBL.Oc TO FIRST-Oc
006380
006390	      MOVE M40MAB_TBL.z TO FIRST-z
006400
006410	      COMPUTE FIRST-z = M40MAB_TBL.z 
006420	                              + M40MAB_TBL.Љ񕪗 
006430		                      + M40MAB_TBL.Љ񕪏 
006440		
006450	      COMPUTE FIRST-c = M40MAB_TBL.c
006460	                               -M40MAB_TBL.Љ񕪗
006470		                       -M40MAB_TBL.Љ񕪏
006480		
006490
006500	      IF FIRST-Oc NOT = 0
006510	      
006520	      OR FIRST-z NOT = 0
006530
006540	      OR FIRST-z NOT = 0
006550
006560	      OR FIRST-c NOT = 0
006570
006580        WRITE ó|R[h
006590
006600	      ELSE
006610
006620	      NEXT SENTENCE.
006630
006640	    
006650******************************************************************
006660*     又-5                                              *
006670******************************************************************
006680     又|dwhs.                                              
006690     PERFORM J[\nodm.
006700     PERFORM e[uJ[\Ǎ.
006710                         
006720******************************************************************
006730*    I                                                    *
006740******************************************************************
006750 I                             SECTION.                    
006760 I|rs`qs.                                            
006770*                                                                 
006780     PERFORM  caN[Y.                                   
006790*                                                                 
006800     PERFORM  t@CN[Y.    
006810
006820     PERFORM  bZ[Wo.
006830*                                                                 
006840     PERFORM  IbZ[Wo.                                 
006850*                                                                 
006860*--< vOI >                                         
006870     MOVE  萔|             TO  PROGRAM-STATUS.         
006880*                                                                 
006890 I|dwhs.                                              
006900     EXIT.                                                        
006910******************************************************************
006920*    IbZ[Wo                                          *
006930******************************************************************
006940 IbZ[Wo                   SECTION.                    
006950 IbZ[Wó|rs`qs.                                  
006960*                                                                 
006970*----------------------------------------------------------------*
006980*    bZ[Wo͏                                      *
006990*----------------------------------------------------------------*
007000     INITIALIZE                       IF-CHOCO001.                
007010     MOVE  "3"                        TO  P|Cxg.     
007020     MOVE  萔|vOhc       TO  P|\[Xhc.       
007030     MOVE  "0"                        TO  P|AR[h.       
007040     MOVE  "D411STK"                  TO  P|e[uhc. 
007050     MOVE  "COUNT"                    TO  P|.         
007060     MOVE  v|́|             TO  P|f[^e.       
007070     MOVE  "xAbvWJ͌"                         
007080                                      TO  P|̑bZ[W. 
007090     CALL  CLOCO001                USING  IF-CHOCO001.            
007100*                                                                 
007110     INITIALIZE                       IF-CHOCO001.                
007120     MOVE  "3"                        TO  P|Cxg.     
007130     MOVE  萔|vOhc       TO  P|\[Xhc.       
007140     MOVE  "0"                        TO  P|AR[h.       
007150     MOVE  "D34HNS"                   TO  P|e[uhc. 
007160     MOVE  "COUNT"                    TO  P|.         
007170     MOVE  v|ó|             TO  P|f[^e.       
007180     MOVE  "ϑDBo͌"         TO  P|̑bZ[W. 
007190     CALL  CLOCO001                USING  IF-CHOCO001.            
007200*                                                                 
007210*----------------------------------------------------------------*
007220*    IbZ[Wo                                          *
007230*----------------------------------------------------------------*
007240     INITIALIZE                       IF-CHOCO001.                
007250     MOVE  "3"                        TO  P|Cxg.     
007260     MOVE  萔|vOhc       TO  P|\[Xhc.       
007270     MOVE  "0"                        TO  P|AR[h.       
007280     MOVE  "END"                      TO  P|.         
007290     MOVE  萔|vO         TO  P|̑bZ[W. 
007300     CALL  CLOCO001                USING  IF-CHOCO001.            
007310*                                                                 
007320 IbZ[Wó|dwhs.                                    
007330     EXIT.                                                        
007340******************************************************************
007350*    caN[Y                                                *
007360******************************************************************
007370 caN[Y                     SECTION.                    
007380 caN[Y|rs`qs.                                    
007390*                                                                 
007400*--< J[\ N[Y >                                          
007410     
      *    EXEC SQL                                                     
007420*       CLOSE  CUR1                                               
007430*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 204 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007440*                                                                 
007450 caN[Y|dwhs.                                      
007460     EXIT.                                                        
007470******************************************************************
007480*    t@CN[Y                                           *
007490******************************************************************
007500 t@CN[Y                    SECTION.                    
007510 t@CN[Y|rs`qs.                                    
007520*                                                                 
007530     CLOSE Е,Е-IPED,Е-IPED,Е.                                                             
007540 caR~bg|dwhs.                                      
007550     EXIT.                                                        
007560******************************************************************
007570*    ca[obN                                        *
007580******************************************************************
007590 ca[obN                 SECTION.                    
007600 ca[obN|rs`qs.                                
007610*                                                                 
007620     
      *    EXEC  SQL                                                    
007630*       ROLLBACK WORK  RELEASE                                    
007640*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 219 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007650*                                                                 
007660     INITIALIZE                       IF-CHOCO001.                
007670     MOVE  "1"                        TO  P|Cxg.     
007680     MOVE  萔|vOhc       TO  P|\[Xhc.       
007690     MOVE  "9"                        TO  P|AR[h.       
007700     MOVE  "ROLLBACK"                 TO  P|.         
007710     MOVE  "[obN{"         TO  P|̑bZ[W. 
007720     CALL  CLOCO001                USING  IF-CHOCO001.            
007730*                                                                 
007740 ca[obN|dwhs.                                  
007750     EXIT.                     
007760******************************************************************
007770*       Е  IF                                      *
007780******************************************************************
007790  Е  .
007800	Е  START
007810  IF TEMPTABLE.ԃtO < 3
007820
007830        MOVE 4 TO Е.Ћ敪
007840	      
007850	      ELSE
007860	      
007870        MOVE 2 TO Е.Ћ敪.
007880	 EXIT.
007890******************************************************************
007900*       Е  IF                                     *
007910******************************************************************.
007920 Е  .
007930   Е   START
007940   IF iʁjca.ԃtO < 3
007950	   MOVE 3 TO Ћ敪
007960	 ELSE
007970	   MOVE 1 TO Ћ敪.
007980	 EXIT
007990*    G[                                                  *
008000******************************************************************
008010 G[菈                       SECTION.                    
008020 G[菈|rs`qs.                                      
008030*                                                                 
008040     MOVE  "Y"                        TO v|ُI|tO.    
008050     INITIALIZE                           IF-CHOCO001.            
008060*                                                                 
008070     EVALUATE  v|G[R[h                                   
008080        WHEN  -10                                                 
008090*--<       nq`bkdڑs >                                 
008100           MOVE  "1"                  TO  P|Cxg      
008110           MOVE  萔|vOhc TO  P|\[Xhc        
008120           MOVE  "9"                  TO  P|AR[h        
008130           MOVE  "CONNECT"            TO  P|          
008140           MOVE  SQLCODE              TO  P|f[^e        
008150           MOVE  SQLERRMC             TO  P|̑bZ[W  
008160           CALL  CLOCO001          USING  IF-CHOCO001             
008170*                                                                 
008180        WHEN  -20                                                 
008190*--<       e[uJ[\I[vs >                     
008200           MOVE  "1"                  TO  P|Cxg      
008210           MOVE  萔|vOhc TO  P|\[Xhc        
008220           MOVE  "9"                  TO  P|AR[h        
008230           MOVE  "D32SAK"             TO  P|e[uhc  
008240           MOVE  "OPEN"               TO  P|          
008250           MOVE  SQLCODE              TO  P|f[^e        
008260           MOVE  SQLERRMC             TO  P|̑bZ[W  
008270           CALL  CLOCO001          USING  IF-CHOCO001             
008280*                                                                 
008290        WHEN  -30                                                 
008300*--<       e[uǍs >                                 
008310           MOVE  "1"                  TO  P|Cxg      
008320           MOVE  萔|vOhc TO  P|\[Xhc        
008330           MOVE  "9"                  TO  P|AR[h        
008340           MOVE  "D11STK"             TO  P|e[uhc  
008350           MOVE  "FETCH"              TO  P|          
008360           MOVE  SQLCODE              TO  P|f[^e        
008370           MOVE  SQLERRMC             TO  P|̑bZ[W  
008380           CALL  CLOCO001          USING  IF-CHOCO001             
008390*                                                                 
008400        WHEN  -40                                                 
008410*--<       ϑcaǉs >                                   
008420           MOVE  "1"                  TO  P|Cxg      
008430           MOVE  萔|vOhc TO  P|\[Xhc        
008440           MOVE  "9"                  TO  P|AR[h        
008450           MOVE  "D34HNS"             TO  P|e[uhc  
008460           MOVE  "INSERT"             TO  P|          
008470           MOVE  SQLCODE              TO  P|f[^e        
008480           MOVE  SQLERRMC             TO  P|̑bZ[W  
008490           CALL  CLOCO001          USING  IF-CHOCO001             
008500*                                                                 
008510        WHEN  OTHER                                               
008520           MOVE  "N"                  TO v|ُI|tO     
008530     END-EVALUATE.                                                
008540*                                                                 
008550     IF v|ُI|tO  =  "Y"                              
008560        PERFORM  ca[obN                             
008570*                                                                 
008580        PERFORM  IbZ[Wo                               
008590*                                                                 
008600*--<    vOُĨ^[R[h >                      
008610        MOVE  萔|ُ          TO  PROGRAM-STATUS          
008620*                                                                 
008630        EXIT  PROGRAM                                             
008640     END-IF.                                                      
008650*                                                                 
008660 G[|dwhs.                                            
008670     EXIT.                                                        
008680******************************************************************
008690*                  END OF PROGRAM                                *
008700******************************************************************
