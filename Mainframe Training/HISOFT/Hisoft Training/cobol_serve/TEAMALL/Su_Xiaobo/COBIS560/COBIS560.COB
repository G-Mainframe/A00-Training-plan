000010******************************************************************
000020*         ÅÉäCãPìÓåè(ëÂòA)ÅÑ                                     *
000030*      1. ÉvÉçÉOÉâÉÄñº  : ïœë•ï•à⁄çsèàóù                         *
000040*      2. ÉvÉçÉOÉâÉÄID  : COBIS560                               *
000050*      3. èàóùäTóv      : à⁄çså„ÅiÉåÉxÉãÉAÉbÉvÅjÇÃç¬å†ìWäJÇÊÇËÅA *
000060*                         ïœë•ï•ÇcÇaÇçÏê¨Ç∑ÇÈÅB                 *
000070*      4. çÏê¨é“        : ëh  ã≈  îé                             *
000080*      5. çÏê¨ì˙        : 2005.04.04                             *
000090******************************************************************
000100*                                                                 
000110******************************************************************
000120*    ÇhÇcÇdÇmÇsÇhÇeÇhÇbÇ`ÇsÇhÇnÇm  ÇcÇhÇuÇhÇrÇhÇnÇm              *
000130******************************************************************
000140 IDENTIFICATION                       DIVISION.                   
000150*                                                                 
000160 PROGRAM-ID.                          COBIS560.                   
000170******************************************************************
000180*    ÇdÇmÇuÇhÇqÇnÇmÇlÇdÇmÇs        ÇcÇhÇuÇhÇrÇhÇnÇm              *
000190******************************************************************
000200 ENVIRONMENT                          DIVISION.                   
000210******************************************************************
000220*    ÇcÇ`ÇsÇ`                      ÇcÇhÇuÇhÇrÇhÇnÇm              *
000230******************************************************************
000240 DATA                                 DIVISION.                   
000250******************************************************************
000260*  ÇvÇnÇqÇjÇhÇmÇfÅ|ÇrÇsÇnÇqÇ`ÇfÇd  ÇrÇdÇbÇsÇhÇnÇm                *
000270******************************************************************
000280  WORKING-STORAGE                     SECTION.                    
000290*----------------------------------------------------------------*
000300*    ÉzÉXÉgïœêîíËã`ÉGÉäÉA                                        *
000310*----------------------------------------------------------------*
000320     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +34.
           02  SQLFPN-FILENAME PIC X(34) VALUE "C:\COB97\SOC\COBIS560\CO
      -    "BIS560.PCO".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(160) VALUE "insert into D511HJS_TBL(å_ñÒî‘çÜ
      -     ",å_ñÒéÌóﬁ,ï®åèî‘çÜ,òAî‘,ëóã‡òAî‘,çƒÉäÅ[ÉXâÒêî,ëóã‡êÊÉRÅ[Éh,
      -    "ëóã‡êÊñº,ëóã‡äz,ìoò^îNåéì˙,ìoò^éûä‘,ìoò^íSìñé“,çXêVîNåéì˙,çX
      -    "êVéûä‘,çX".

           02  FILLER PIC X(102) VALUE "êVé“,ì¸óÕíSìñé“ÉRÅ[Éh) values (:
      -    "b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,
      -    ":b15,:b16)".

       01  SQ0003 GLOBAL.
           02  FILLER PIC X(136) VALUE "select å_ñÒéÌóﬁ  ,çƒÉäÅ[ÉXâÒêî  
      -     " into :b1,:b2  from IKOTBL002 where ((å_ñÒÇmÇn=:b3 and çƒÉä
      -    "Å[ÉXÉRÅ[Éh=:b4) and ãåç¬å†ä®íËèàóùÉRÅ[Éh=:b5)".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +148377852.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +16.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 16 TIMES.


       01  SQ0001 GLOBAL.
           02  FILLER PIC X(159) VALUE "select å_ñÒÇmÇn  ,çƒÉäÅ[ÉXÉRÅ[Éh
      -    "  ,ä®íËèàóùÉRÅ[Éh  ,ï®åèé}î‘  ,ëóã‡êÊÉRÅ[ÉhÇP  ,ëóã‡êÊÉRÅ[Éh
      -    "ÇQ  ,ëóã‡êÊÉRÅ[ÉhÇR  ,ëóã‡êÊñºÇP  ,ëóã‡êÊñºÇQ  ,ëóã‡êÊñºÇR  
      -    ",ëóã‡äz".

           02  FILLER PIC X(50) VALUE "ÇP  ,ëóã‡äzÇQ  ,ëóã‡äzÇR   from L
      -    "TRHJK            ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +189.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +193.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +209.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +244.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +82.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +270.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +149.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +262.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +364.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +228.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +136.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +422.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +263.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +581.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +278.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +12.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +593.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +293.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +14.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +32.
           02     FILLER PIC S9(4) COMP-5 VALUE +613.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000330*                                                                 
000340*--< ÇnÇqÇ`ÇbÇkÇdã§í ïœêî >                                       
000350     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
000360*                                                                 
000370*--< ÇnÇqÇ`ÇbÇkÇd  ÇrÇpÇké¿çsèÓïÒ >                               
000010*--ÅÉÇrÇpÇkã§í ïœêîÅÑ
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000380     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000390*                                                                 
000400*--< ï€åØéñåÃÉ}ÉXÉ^Åiï€åØã‡êøãÅì¸ã‡⁄∫∞ƒﬁÅj>                       
000410     
      *    EXEC  SQL  INCLUDE  LTRHJK.CBL            END-EXEC.
000420*                                                                 
000430*--< å_ñÒéÌóﬁìôïœä∑ÉeÅ[ÉuÉã>                                      
000010************************************************
000020* ï€åØéñåÃÉ}ÉXÉ^Åiï€åØã‡êøãÅì¸ã‡)(LTRHJK)
000030************************************************
000040 01  ÇkÇsÇqÇgÇiÇjÅ|å_ñÒÇmÇn PIC  X(009).
000050 01  ÇkÇsÇqÇgÇiÇjÅ|ï®åèé}î‘ PIC S9(003) COMP-3.
000060 01  ÇkÇsÇqÇgÇiÇjÅ|çƒÉäÅ[ÉXÉRÅ[Éh PIC S9(001) COMP-3.
000070 01  ÇkÇsÇqÇgÇiÇjÅ|éñåÃì˙ïtÅ|ê¢ãI PIC S9(001) COMP-3.
000080 01  ÇkÇsÇqÇgÇiÇjÅ|éñåÃì˙ïtÅ|ì˙ït PIC  X(006).
000090 01  ÇkÇsÇqÇgÇiÇjÅ|éñåÃì˙ïtÅ|éûçèÇgÇgÇlÇl PIC  X(004).
000100 01  ÇkÇsÇqÇgÇiÇjÅ|ï®åèñº PIC  X(030).
000110 01  ÇkÇsÇqÇgÇiÇjÅ|ÉäÅ[ÉXäJénì˙Å|ê¢ãI PIC S9(001) COMP-3.
000120 01  ÇkÇsÇqÇgÇiÇjÅ|ÉäÅ[ÉXäJénì˙Å|ì˙ït PIC  X(006).
000130 01  ÇkÇsÇqÇgÇiÇjÅ|ÉäÅ[ÉXèIóπì˙Å|ê¢ãI PIC S9(001) COMP-3.
000140 01  ÇkÇsÇqÇgÇiÇjÅ|ÉäÅ[ÉXèIóπì˙Å|ì˙ït PIC  X(006).
000150 01  ÇkÇsÇqÇgÇiÇjÅ|ä˙ä‘ PIC S9(003) COMP-3.
000160 01  ÇkÇsÇqÇgÇiÇjÅ|çwì¸ã‡äz PIC S9(013) COMP-3.
000170 01  ÇkÇsÇqÇgÇiÇjÅ|ÉÜÅ[ÉUÅ[ÉRÅ[Éh PIC  X(008).
000180 01  ÇkÇsÇqÇgÇiÇjÅ|ÉÜÅ[ÉUÅ[ÉäÉtÉ@ÉåÉìÉX PIC  X(012).
000190 01  ÇkÇsÇqÇgÇiÇjÅ|ê›íuèÍèä PIC  X(020).
000200 01  ÇkÇsÇqÇgÇiÇjÅ|ì]ÉäÅ[ÉXíÒågêÊÉRÅ[Éh PIC  X(002).
000210 01  ÇkÇsÇqÇgÇiÇjÅ|åpë±ÉäÅ[ÉXèûãpëŒè€äz PIC S9(013) COMP-3.
000220 01  ÇkÇsÇqÇgÇiÇjÅ|ä®íËèàóùÉRÅ[Éh PIC  X(002).
000230 01  ÇkÇsÇqÇgÇiÇjÅ|ä«óùÇmÇn PIC  X(015).
000240 01  ÇkÇsÇqÇgÇiÇjÅ|ìÆëçï€åØÉRÅ[Éh PIC  X(004).
000250 01  ÇkÇsÇqÇgÇiÇjÅ|ê”îCä˙ä‘é©Å|ê¢ãI PIC S9(001) COMP-3.
000260 01  ÇkÇsÇqÇgÇiÇjÅ|ê”îCä˙ä‘é©Å|ì˙ït PIC  X(006).
000270 01  ÇkÇsÇqÇgÇiÇjÅ|ê”îCä˙ä‘éäÅ|ê¢ãI PIC S9(001) COMP-3.
000280 01  ÇkÇsÇqÇgÇiÇjÅ|ê”îCä˙ä‘éäÅ|ì˙ït PIC  X(006).
000290 01  ÇkÇsÇqÇgÇiÇjÅ|ï€åØèÿåîî‘çÜ PIC  X(011).
000300 01  ÇkÇsÇqÇgÇiÇjÅ|ìÆëçï€åØâøäi PIC S9(013) COMP-3.
000310 01  ÇkÇsÇqÇgÇiÇjÅ|çƒÉäÅ[ÉXïtï€ó¶ PIC S9(002) COMP-3.
000320 01  ÇkÇsÇqÇgÇiÇjÅ|É_É~Å[ÇOÇOÇP PIC  X(012).
000330 01  ÇkÇsÇqÇgÇiÇjÅ|éñåÃêøãÅìoò^ì˙Å|ê¢ãI PIC S9(001) COMP-3.
000340 01  ÇkÇsÇqÇgÇiÇjÅ|éñåÃêøãÅìoò^ì˙Å|ì˙ït PIC  X(006).
000350 01  ÇkÇsÇqÇgÇiÇjÅ|éñåÃãÊï™ PIC  X(001).
000360 01  ÇkÇsÇqÇgÇiÇjÅ|éñåÃå¥àˆ PIC  X(001).
000370 01  ÇkÇsÇqÇgÇiÇjÅ|îÌç–ï®åèã‡äz PIC S9(013) COMP-3.
000380 01  ÇkÇsÇqÇgÇiÇjÅ|îÌç–ï®åèécâøäz PIC S9(013) COMP-3.
000390 01  ÇkÇsÇqÇgÇiÇjÅ|É_É~Å[ÇOÇOÇQ PIC  X(017).
000400 01  ÇkÇsÇqÇgÇiÇjÅ|êøãÅîNåéì˙Å|ê¢ãI PIC S9(001) COMP-3.
000410 01  ÇkÇsÇqÇgÇiÇjÅ|êøãÅîNåéì˙Å|ì˙ït PIC  X(006).
000420 01  ÇkÇsÇqÇgÇiÇjÅ|êøãÅÇqÇdÇeÇmÇn PIC  X(008).
000430 01  ÇkÇsÇqÇgÇiÇjÅ|êøãÅï€åØã‡ PIC S9(013) COMP-3.
000440 01  ÇkÇsÇqÇgÇiÇjÅ|ó’éûîÔópï€åØã‡ PIC S9(013) COMP-3.
000450 01  ÇkÇsÇqÇgÇiÇjÅ|ï€åØã‡êøãÅäz PIC S9(013) COMP-3.
000460 01  ÇkÇsÇqÇgÇiÇjÅ|É_É~Å[ÇOÇOÇR PIC  X(014).
000470 01  ÇkÇsÇqÇgÇiÇjÅ|ì¸ëóã‡ìoò^ì˙Å|ê¢ãI PIC S9(001) COMP-3.
000480 01  ÇkÇsÇqÇgÇiÇjÅ|ì¸ëóã‡ìoò^ì˙Å|ì˙ït PIC  X(006).
000490 01  ÇkÇsÇqÇgÇiÇjÅ|ì¸ã‡ì˙Å|ê¢ãI PIC S9(001) COMP-3.
000500 01  ÇkÇsÇqÇgÇiÇjÅ|ì¸ã‡ì˙Å|ì˙ït PIC  X(006).
000510 01  ÇkÇsÇqÇgÇiÇjÅ|ì¸ã‡äz PIC S9(013) COMP-3.
000520 01  ÇkÇsÇqÇgÇiÇjÅ|ï€åØã‡èàóùãÊï™ PIC  X(001).
000530 01  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇP PIC S9(002) COMP-3.
000540 01  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇP PIC  X(040).
000550 01  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇP PIC S9(013) COMP-3.
000560 01  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇQ PIC S9(002) COMP-3.
000570 01  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇQ PIC  X(040).
000580 01  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇQ PIC S9(013) COMP-3.
000590 01  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇR PIC S9(002) COMP-3.
000600 01  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇR PIC  X(040).
000610 01  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇR PIC S9(013) COMP-3.
000620 01  ÇkÇsÇqÇgÇiÇjÅ|É_É~Å[ÇOÇOÇS PIC  X(011).
000630 01  ÇkÇsÇqÇgÇiÇjÅ|É_É~Å[ÇOÇOÇT PIC  X(021).
000640 01  ÇkÇsÇqÇgÇiÇjÅ|ã§í èÓïÒ PIC  X(035).
000440     
      *    EXEC  SQL  INCLUDE  IKOTBL002.CBL         END-EXEC.
000450*                                                                 
000460*--< à⁄çså„_ç¬å†ìWäJ >                                            
000010************************************************
000020* å_ñÒéÌóﬁìôïœä∑ÉeÅ[ÉuÉã(IKOTBL002)
000030************************************************
000040 01  ÇhÇjÇnÇOÇOÇQÅ|å_ñÒÇmÇn PIC  X(009).
000050 01  ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXÉRÅ[Éh PIC S9(001) COMP-3.
000060 01  ÇhÇjÇnÇOÇOÇQÅ|ãåç¬å†ä®íËèàóùÉRÅ[Éh PIC S9(002) COMP-3.
000070 01  ÇhÇjÇnÇOÇOÇQÅ|ãåç¬ñ±ä®íËèàóùÉRÅ[Éh PIC S9(002) COMP-3.
000080 01  ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXâÒêî PIC S9(002) COMP-3.
000090 01  ÇhÇjÇnÇOÇOÇQÅ|ç¬å†ä®íËèàóùÉRÅ[Éh PIC S9(002) COMP-3.
000100 01  ÇhÇjÇnÇOÇOÇQÅ|ç¬ñ±ä®íËèàóùÉRÅ[Éh PIC S9(002) COMP-3.
000110 01  ÇhÇjÇnÇOÇOÇQÅ|å_ñÒéÌóﬁ PIC  X(003).
000120 01  ÇhÇjÇnÇOÇOÇQÅ|éÂå_ñÒãÊï™ PIC  X(001).
000130 01  ÇhÇjÇnÇOÇOÇQÅ|âÒé˚éËèá PIC  X(001).
000470     
      *    EXEC  SQL  INCLUDE  D511HJS.CBL           END-EXEC.
000480*                                                                 
      *****************************************************************
      *   ï€åØéñåÃëóã‡(D511HJS_TBL)
      *****************************************************************
       01  ï€åØéñåÃëóã‡.
           03  ÇcÇTÇPÇPÅ|å_ñÒî‘çÜ    PIC  X(010).
           03  ÇcÇTÇPÇPÅ|å_ñÒéÌóﬁ    PIC  X(003).
           03  ÇcÇTÇPÇPÅ|ï®åèî‘çÜ    PIC S9(004) PACKED-DECIMAL.
           03  ÇcÇTÇPÇPÅ|òAî‘        PIC S9(003) PACKED-DECIMAL.
           03  ÇcÇTÇPÇPÅ|ëóã‡òAî‘    PIC S9(002) PACKED-DECIMAL.
           03  ÇcÇTÇPÇPÅ|çƒÉäÅ[ÉXâÒêî
                                     PIC S9(002) PACKED-DECIMAL.
           03  ÇcÇTÇPÇPÅ|ëóã‡êÊÉRÅ[Éh
                                     PIC  X(002).
           03  ÇcÇTÇPÇPÅ|ëóã‡êÊñº    PIC  X(040).
           03  ÇcÇTÇPÇPÅ|ëóã‡äz      PIC S9(013) PACKED-DECIMAL.
           03  ÇcÇTÇPÇPÅ|ìoò^îNåéì˙  PIC  X(008).
           03  ÇcÇTÇPÇPÅ|ìoò^éûä‘    PIC  X(008).
           03  ÇcÇTÇPÇPÅ|ìoò^íSìñé“  PIC  X(008).
           03  ÇcÇTÇPÇPÅ|çXêVîNåéì˙  PIC  X(008).
           03  ÇcÇTÇPÇPÅ|çXêVéûä‘    PIC  X(008).
           03  ÇcÇTÇPÇPÅ|çXêVé“      PIC  X(008).
           03  ÇcÇTÇPÇPÅ|ì¸óÕíSìñé“ÉRÅ[Éh
                                     PIC  X(008).
000490     
      *    EXEC  SQL  END  DECLARE          SECTION  END-EXEC.
000500*                                                                 
000510*----------------------------------------------------------------*
000520*    ÇvÇnÇqÇjÉGÉäÉA                                              *
000530*----------------------------------------------------------------*
000540*--< ÉGÉâÅ[îªíË&TEMPóp>                                           
000550*--<TEMPóp>                                                       
000560 01  ÇvÅ|ÉJÉEÉìÉ^                     PIC  9(03)   VALUE  1.      
000570 01  ÇvÅ|ÉtÉâÉO                       PIC  X(01)   VALUE  "N".    
000580 01  ÇvÇnÇqÇjÅ|ÉGÉäÉA.                                            
000590*--< ÉGÉâÅ[îªíËóp >                                               
000600     03  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             PIC S9(04).                 
000610                                                                  
000620*--< ÉtÉâÉOÉAÉäÉA >                                               
000630     03  ÉtÉâÉOÉAÉäÉA.                                            
000640         05  ÇvÅ|èIóπÅ|ÉtÉâÉO         PIC  X(01).                 
000650         05  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     PIC  X(01).                 
000660*                                                                 
000670*--< åèêîÉGÉäÉA >                                                 
000680     03  åèêîÉGÉäÉA.                                              
000690         05  ÇvÅ|ì¸óÕÅ|åèêî           PIC  9(09).                 
000700         05  ÇvÅ|èoóÕÅ|åèêî           PIC  9(09).                 
000710*                                                                 
000720*--< òAî‘èàóùÇÃÉGÉäÉA >                                           
000730     03  òAî‘èàóù.                                                
000740          05  ÇnÇkÇcå_ñÒî‘çÜ          PIC  X(010)  VALUE SPACE.   
000750          05  ÇnÇkÇcå_ñÒéÌóﬁ          PIC  X(003)  VALUE SPACE.   
000760          05  ÇnÇkÇcï®åèî‘çÜ          PIC  S9(004)  VALUE ZERO.   
000770*                                                                 
000780*--< ã§í èÓïÒ >                                                   
000790 01  ÇvÅ|ã§í èÓïÒ.                                                
000800     03  ÇvÅ|ÉVÉXÉeÉÄì˙ït.                                        
000810         05  ÇvÅ|ê¢ãI                 PIC  X(02) VALUE  "20".     
000820         05  ÇvÅ|îNåéì˙               PIC  X(06).                 
000830     03  ÇvÅ|ÉVÉXÉeÉÄéûçè             PIC  X(08).                 
000840     03  ÇvÅ|íSìñé“                   PIC  X(08)                  
000850	                                           VALUE  "IKOPG   ".   
000860*                                                                 
000870*----------------------------------------------------------------*
000880*    ÉTÉuÉãÅ[É`Éìñº                                              *
000890*----------------------------------------------------------------*
000900 01  CALL-AREA.                                                   
000910*--< ã§í ÉçÉOÉTÉuÉãÅ[É`Éì >                                       
000920     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
000930     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
000940*                                                                 
000950*----------------------------------------------------------------*
000960*    ÇbÇnÇoÇxóÃàÊ                                                *
000970*----------------------------------------------------------------*
000980*--< ã§í ÉçÉOópÉpÉâÉÅÅ[É^ >                                       
000990 01  IF-CHOCO001.                                                 
001000     COPY  CHOCO001  REPLACING  ==()==  BY  ==ã§ÇPÅ|==.           
001010*                                                                 
001020*----------------------------------------------------------------*
001030*    ÇhÇmÇhÉtÉ@ÉCÉãì«çûÉTÉuÉãÅ[É`ÉìópÉpÉâÉÅÉ^óÃàÊ                *
001040*----------------------------------------------------------------*
001050 01  PARA-AREA.                                                   
001060     COPY CPBCO001.                                               
001070******************************************************************
001080*    íËêîópÉfÅ[É^íËã`ÉGÉäÉA                                      *
001090******************************************************************
001100 CONSTANT                             SECTION.                    
001110 01  íËêîóÃàÊ.                                                    
001120     03  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc         PIC  X(08) VALUE "COBIS560".
001130     03  íËêîÅ|ÉvÉçÉOÉâÉÄñº           PIC  X(80)                  
001140                                   VALUE  "ï€åØéñåÃëóã‡çÏê¨".     
001150     03  íËêîÅ|ÇrÇpÇkÇnÇj             PIC S9(04)  VALUE  ZERO.    
001160     03  íËêîÅ|ÇrÇpÇkÇdÇmÇc           PIC S9(04)  VALUE  0100.    
001170     03  íËêîÅ|ê≥èÌèÛë‘               PIC S9(04)  VALUE  ZERO.    
001180     03  íËêîÅ|àŸèÌèÛë‘               PIC S9(04)  VALUE  0009.    
001190******************************************************************
001200*    ÇoÇqÇnÇbÇdÇcÇtÇqÇd            ÇcÇhÇuÇhÇrÇhÇnÇm              *
001210******************************************************************
001220 PROCEDURE                            DIVISION.                   
001230*                                                                 
001240     PERFORM  èâä˙èàóù.                                           
001250*                                                                 
001260     PERFORM  éÂèàóù  UNTIL  ÇvÅ|èIóπÅ|ÉtÉâÉO  =  "Y".            
001270*                                                                 
001280     PERFORM  èIóπèàóù.                                           
001290*                                                                 
001300     STOP     RUN.                                                
001310*                                                                 
001320******************************************************************
001330*    èâä˙èàóù                                                    *
001340******************************************************************
001350 èâä˙èàóù                             SECTION.                    
001360 èâä˙èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
001370*                                                                 
001380*----------------------------------------------------------------*
001390*    äJénÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
001400*----------------------------------------------------------------*
001410     INITIALIZE                       IF-CHOCO001.                
001420     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
001430     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
001440     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
001450     MOVE  "START"                    TO  ã§ÇPÅ|èàóùéØï .         
001460     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
001470     CALL  CLOCO001                USING  IF-CHOCO001.            
001480*                                                                 
001490*----------------------------------------------------------------*
001500*    çÏã∆óÃàÊÇÃèâä˙ílèàóù                                        *
001510*----------------------------------------------------------------*
001520     MOVE  SPACE                      TO  ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001530     INITIALIZE                           ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001540*                                                                 
001550*--< ÇbÇoÇtì˙ïtÇéÊìæ >                                           
001560     ACCEPT  ÇvÅ|îNåéì˙               FROM  DATE.                 
001570*                                                                 
001580*--< ÇbÇoÇtéûçèÇéÊìæ >                                           
001590     ACCEPT  ÇvÅ|ÉVÉXÉeÉÄéûçè         FROM  TIME.                 
001600*                                                                 
001610*--< ÇnÇqÇ`ÇbÇkÇdê⁄ë± >          ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                
001620     PERFORM   ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                                  
001630*                                                                 
001640*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã` >                                   
001650     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`.                           
001660*                                                                 
001670*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû(ÇPåèñ⁄) >                           
001680     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
001690*                                                                 
001700 èâä˙èàóùÅ|ÇdÇwÇhÇs.                                              
001710     EXIT.                                                        
001720******************************************************************
001730*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
001740******************************************************************
001750 ÇnÇqÇ`ÇbÇkÇdê⁄ë±                     SECTION.                    
001760 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇrÇsÇ`ÇqÇs.                                    
001770*                                                                 
001780*--< ÇcÇaê⁄ë±ópèÓïÒÇéÊìæèàóù >                                   
001790     CALL  COBCO001                USING  PARA-AREA.              
001800*                                                                 
001810     MOVE  PARA-DBSTRING              TO  DB-STRING.              
001820     MOVE  PARA-USERNAME              TO  USERNAME.               
001830     MOVE  PARA-PASSWORD              TO  PASSWD.                 
001840*                                                                 
001850*----------------------------------------------------------------*
001860*    äJénê⁄ë±                                                    *
001870*----------------------------------------------------------------*
001880     IF    DB-STRING  =  SPACE                                    
001890        
      *       EXEC SQL                                                  
001900*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
001910*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
001920     ELSE                                                         
001930        
      *       EXEC SQL                                                  
001940*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
001950*            USING  :DB-STRING                                    
001960*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
001970     END-IF.                                                      
001980*                                                                 
001990*----------------------------------------------------------------*
002000*    ê⁄ë±ämîF                                                    *
002010*----------------------------------------------------------------*
002020     EVALUATE  SQLCODE                                            
002030        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002040           CONTINUE                                               
002050        WHEN   OTHER                                              
002060*--<       ê⁄ë±ÉGÉâÅ[ >                                           
002070           MOVE     -10               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002080           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002090     END-EVALUATE.                                                
002100*                                                                 
002110 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇdÇwÇhÇs.                                      
002120     EXIT.                                                        
002130******************************************************************
002140*        åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`                                *
002150******************************************************************
002160 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`             SECTION.                    
002170 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇrÇsÇ`ÇqÇs.                            
002180*                                                                 
002190*----------------------------------------------------------------*
002200*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
002210*----------------------------------------------------------------*
002220     
      *    EXEC SQL                                                     
002230*       DECLARE CUR1  CURSOR FOR                                  
002240*          SELECT                                                 
002250*                å_ñÒÇmÇn                                         
002260*               ,çƒÉäÅ[ÉXÉRÅ[Éh                                   
002270*               ,ä®íËèàóùÉRÅ[Éh                                   
002280*               ,ï®åèé}î‘                                         
002290*               ,ëóã‡êÊÉRÅ[ÉhÇP                                   
002300*               ,ëóã‡êÊÉRÅ[ÉhÇQ                                   
002310*               ,ëóã‡êÊÉRÅ[ÉhÇR                                   
002320*               ,ëóã‡êÊñºÇP                                       
002330*               ,ëóã‡êÊñºÇQ                                       
002340*               ,ëóã‡êÊñºÇR                                       
002350*               ,ëóã‡äzÇP                                         
002360*               ,ëóã‡äzÇQ                                         
002370*               ,ëóã‡äzÇR                                         
002380*            FROM  LTRHJK                                         
002390*    END-EXEC.
002400*                                                                 
002410*----------------------------------------------------------------*
002420*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
002430*----------------------------------------------------------------*
002440     
      *    EXEC  SQL                                                    
002450*       OPEN  CUR1                                                
002460*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
002470*                                                                 
002480*----------------------------------------------------------------*
002490*    ÉJÅ[É\ÉãÇnÇoÇdÇmämîF                                        *
002500*----------------------------------------------------------------*
002510     EVALUATE  SQLCODE                                            
002520        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
002530*--<       ê≥èÌ >                                                 
002540           CONTINUE                                               
002550        WHEN  OTHER                                               
002560*--<       ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
002570           MOVE -20                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002580           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002590     END-EVALUATE.                                                
002600*                                                                 
002610 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇdÇwÇhÇs.                              
002620     EXIT.                                                        
002630******************************************************************
002640*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                                    *
002650******************************************************************
002660 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû             SECTION.                    
002670 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇrÇsÇ`ÇqÇs.                            
002680*                                                                 
002690*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû >                                   
002700     
      *    EXEC SQL                                                     
002710*        FETCH  CUR1                                              
002720*         INTO  :ÇkÇsÇqÇgÇiÇjÅ|å_ñÒÇmÇn                           
002730*              ,:ÇkÇsÇqÇgÇiÇjÅ|çƒÉäÅ[ÉXÉRÅ[Éh                     
002740*              ,:ÇkÇsÇqÇgÇiÇjÅ|ä®íËèàóùÉRÅ[Éh                     
002750*              ,:ÇkÇsÇqÇgÇiÇjÅ|ï®åèé}î‘                           
002760*              ,:ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇP                     
002770*              ,:ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇQ                     
002780*              ,:ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇR                     
002790*              ,:ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇP                         
002800*              ,:ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇQ                         
002810*              ,:ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇR                         
002820*              ,:ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇP                           
002830*              ,:ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇQ                           
002840*              ,:ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇR                           
002850*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 82 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|å_ñÒÇmÇn
               SQL-SQHSTV(1)
           MOVE 9 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|çƒÉäÅ[ÉXÉRÅ[Éh
               SQL-SQHSTV(2)
           MOVE 1 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ä®íËèàóùÉRÅ[Éh
               SQL-SQHSTV(3)
           MOVE 2 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ï®åèé}î‘
               SQL-SQHSTV(4)
           MOVE 2 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇP
               SQL-SQHSTV(5)
           MOVE 2 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇQ
               SQL-SQHSTV(6)
           MOVE 2 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇR
               SQL-SQHSTV(7)
           MOVE 2 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇP
               SQL-SQHSTV(8)
           MOVE 40 TO SQL-SQHSTL(8)
           MOVE 0 TO SQL-SQHSTS(8)
           MOVE 0 TO SQL-SQINDV(8)
           MOVE 0 TO SQL-SQINDS(8)
           MOVE 0 TO SQL-SQHARM(8)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇQ
               SQL-SQHSTV(9)
           MOVE 40 TO SQL-SQHSTL(9)
           MOVE 0 TO SQL-SQHSTS(9)
           MOVE 0 TO SQL-SQINDV(9)
           MOVE 0 TO SQL-SQINDS(9)
           MOVE 0 TO SQL-SQHARM(9)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇR
               SQL-SQHSTV(10)
           MOVE 40 TO SQL-SQHSTL(10)
           MOVE 0 TO SQL-SQHSTS(10)
           MOVE 0 TO SQL-SQINDV(10)
           MOVE 0 TO SQL-SQINDS(10)
           MOVE 0 TO SQL-SQHARM(10)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇP
               SQL-SQHSTV(11)
           MOVE 7 TO SQL-SQHSTL(11)
           MOVE 0 TO SQL-SQHSTS(11)
           MOVE 0 TO SQL-SQINDV(11)
           MOVE 0 TO SQL-SQINDS(11)
           MOVE 0 TO SQL-SQHARM(11)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇQ
               SQL-SQHSTV(12)
           MOVE 7 TO SQL-SQHSTL(12)
           MOVE 0 TO SQL-SQHSTS(12)
           MOVE 0 TO SQL-SQINDV(12)
           MOVE 0 TO SQL-SQINDS(12)
           MOVE 0 TO SQL-SQHARM(12)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇR
               SQL-SQHSTV(13)
           MOVE 7 TO SQL-SQHSTL(13)
           MOVE 0 TO SQL-SQHSTS(13)
           MOVE 0 TO SQL-SQINDV(13)
           MOVE 0 TO SQL-SQINDS(13)
           MOVE 0 TO SQL-SQHARM(13)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
002860*                                                                 
002870*----------------------------------------------------------------*
002880*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÇämîF                              *
002890*----------------------------------------------------------------*
002900     EVALUATE   SQLCODE                                           
002910        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002920*--<       ê≥èÌ >                                                 
002930           COMPUTE  ÇvÅ|ì¸óÕÅ|åèêî  =  ÇvÅ|ì¸óÕÅ|åèêî  +  1       
002940        WHEN   íËêîÅ|ÇrÇpÇkÇdÇmÇc                                 
002950*--<       ì«çûèIóπ >                                             
002960           MOVE  "Y"                  TO  ÇvÅ|èIóπÅ|ÉtÉâÉO        
002970        WHEN   OTHER                                              
002980*--<       ì«çûÉGÉâÅ[ >                                           
002990           MOVE     -30               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003000           PERFORM  ÉGÉâÅ[îªíËèàóù                                
003010     END-EVALUATE.                                                
003020*                                                                 
003030 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇdÇwÇhÇs.                              
003040     EXIT.                                                        
003050******************************************************************
003060*    éÂèàóù                                                      *
003070******************************************************************
003080 éÂèàóù                               SECTION.                    
003090 éÂèàóùÅ|ÇrÇsÇ`ÇqÇs.                                              
003100*                                                                 
003110     PERFORM  ï“èWèoóÕèàóù.                                       
003120*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅiÇQåèñ⁄à»ç~Åj >                     
003130     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
003140*                                                                 
003150 éÂèàóùÅ|ÇdÇwÇhÇs.                                                
003160     EXIT.                                                        
003170******************************************************************
003180*     ï“èWèoóÕèàóù                                               *
003190******************************************************************
003200 ï“èWèoóÕèàóù                         SECTION.                    
003210 ï“èWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                        
003220*                                                                 
003230*---<No.01 >                                                      
003240     MOVE  ÇkÇsÇqÇgÇiÇjÅ|å_ñÒÇmÇn     TO  ÇcÇTÇPÇPÅ|å_ñÒî‘çÜ.     
003250*-- <No.02,06 >                                                   
003260     PERFORM  ïœä∑ÉeÅ[ÉuÉãèàóù.                                   
003270*-- <No.03 >                                                      
003280     MOVE  ÇkÇsÇqÇgÇiÇjÅ|ï®åèé}î‘     TO  ÇcÇTÇPÇPÅ|ï®åèî‘çÜ.     
003290*---<No.10>                                                       
003300     MOVE  ÇvÅ|îNåéì˙                 TO  ÇcÇTÇPÇPÅ|ìoò^îNåéì˙.   
003310*---<No.11>                                                       
003320     MOVE  ÇvÅ|ÉVÉXÉeÉÄéûçè           TO  ÇcÇTÇPÇPÅ|ìoò^éûä‘.     
003330*---<No.12>                                                       
003340     MOVE  ÇvÅ|íSìñé“                 TO  ÇcÇTÇPÇPÅ|ìoò^íSìñé“.   
003350*---<No.13>                                                       
003360     MOVE  ÇvÅ|îNåéì˙                 TO  ÇcÇTÇPÇPÅ|çXêVîNåéì˙.   
003370*---<No.14>                                                       
003380     MOVE  ÇvÅ|ÉVÉXÉeÉÄéûçè           TO  ÇcÇTÇPÇPÅ|çXêVéûä‘.     
003390*---<No.15>                                                       
003400     MOVE  ÇvÅ|íSìñé“                 TO  ÇcÇTÇPÇPÅ|çXêVé“.       
003410*---<No.16>                                                       
003420     MOVE  ÇvÅ|íSìñé“                 TO                          
003430                                     ÇcÇTÇPÇPÅ|ì¸óÕíSìñé“ÉRÅ[Éh.  
003440     PERFORM  ï“èWèàóù  THRU  èoóÕèàóù  3  TIMES.                 
003450******************************************************************
003460*     ï“èWèàóù                                                   *
003470******************************************************************
003480 ï“èWèàóù                             SECTION.                    
003490 ï“èWèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
003500*---<No.04>                                                       
003510     PERFORM  òAî‘ï“èWèàóù.                                       
003520*---<No.05ÅA07ÅA08ÅA09 >                                          
003530     PERFORM  ëóã‡ï“èW.                                           
003540*---<ÇvÅ|ÉJÉEÉìÉ^ èàóù >                                          
003550     PERFORM  ÉJÉEÉìÉ^èàóù.                                       
003560 ï“èWèàóùÅ|ÇdÇwÇhÇs.                                              
003570     EXIT.                                                        
003580******************************************************************
003590*    èoóÕèàóù                                                    *
003600******************************************************************
003610 èoóÕèàóù                             SECTION.                    
003620 èoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
003630*                                                                 
003640      
      *     EXEC  SQL                                                   
003650*       INSERT  INTO  D511HJS_TBL                                 
003660*          ( å_ñÒî‘çÜ                                             
003670*           ,å_ñÒéÌóﬁ                                             
003680*           ,ï®åèî‘çÜ                                             
003690*           ,òAî‘                                                 
003700*           ,ëóã‡òAî‘                                             
003710*           ,çƒÉäÅ[ÉXâÒêî                                         
003720*           ,ëóã‡êÊÉRÅ[Éh                                         
003730*           ,ëóã‡êÊñº                                             
003740*           ,ëóã‡äz                                               
003750*           ,ìoò^îNåéì˙                                           
003760*           ,ìoò^éûä‘                                             
003770*           ,ìoò^íSìñé“                                           
003780*           ,çXêVîNåéì˙                                           
003790*           ,çXêVéûä‘                                             
003800*           ,çXêVé“                                               
003810*           ,ì¸óÕíSìñé“ÉRÅ[Éh )                                   
003820*                                                                 
003830*      VALUES                                                     
003840*          ( :ÇcÇTÇPÇPÅ|å_ñÒî‘çÜ                                  
003850*           ,:ÇhÇjÇnÇOÇOÇQÅ|å_ñÒéÌóﬁ                              
003860*           ,:ÇcÇTÇPÇPÅ|ï®åèî‘çÜ                                  
003870*           ,:ÇcÇTÇPÇPÅ|òAî‘                                      
003880*           ,:ÇcÇTÇPÇPÅ|ëóã‡òAî‘                                  
003890*           ,:ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXâÒêî                          
003900*           ,:ÇcÇTÇPÇPÅ|ëóã‡êÊÉRÅ[Éh                              
003910*           ,:ÇcÇTÇPÇPÅ|ëóã‡êÊñº                                  
003920*           ,:ÇcÇTÇPÇPÅ|ëóã‡äz                                    
003930*           ,:ÇcÇTÇPÇPÅ|ìoò^îNåéì˙                                
003940*           ,:ÇcÇTÇPÇPÅ|ìoò^éûä‘                                  
003950*           ,:ÇcÇTÇPÇPÅ|ìoò^íSìñé“                                
003960*           ,:ÇcÇTÇPÇPÅ|çXêVîNåéì˙                                
003970*           ,:ÇcÇTÇPÇPÅ|çXêVéûä‘                                  
003980*           ,:ÇcÇTÇPÇPÅ|çXêVé“                                    
003990*           ,:ÇcÇTÇPÇPÅ|ì¸óÕíSìñé“ÉRÅ[Éh )                        
004000*    END-EXEC.
            CALL "SQLADR" USING SQ0002 SQL-STMT
            MOVE 1 TO SQL-ITERS
            MOVE 149 TO SQL-OFFSET
            MOVE 0 TO SQL-OCCURS
            CALL "SQLADR" USING
                SQLCUD
                SQL-CUD
            CALL "SQLADR" USING
                SQLCA
                SQL-SQLEST
            MOVE 256 TO SQL-SQLETY
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|å_ñÒî‘çÜ IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(1)
            MOVE 10 TO SQL-SQHSTL(1)
            MOVE 0 TO SQL-SQHSTS(1)
            MOVE 0 TO SQL-SQINDV(1)
            MOVE 0 TO SQL-SQINDS(1)
            MOVE 0 TO SQL-SQHARM(1)
            CALL "SQLADR" USING
                ÇhÇjÇnÇOÇOÇQÅ|å_ñÒéÌóﬁ
                SQL-SQHSTV(2)
            MOVE 3 TO SQL-SQHSTL(2)
            MOVE 0 TO SQL-SQHSTS(2)
            MOVE 0 TO SQL-SQINDV(2)
            MOVE 0 TO SQL-SQINDS(2)
            MOVE 0 TO SQL-SQHARM(2)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|ï®åèî‘çÜ IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(3)
            MOVE 3 TO SQL-SQHSTL(3)
            MOVE 0 TO SQL-SQHSTS(3)
            MOVE 0 TO SQL-SQINDV(3)
            MOVE 0 TO SQL-SQINDS(3)
            MOVE 0 TO SQL-SQHARM(3)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|òAî‘ IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(4)
            MOVE 2 TO SQL-SQHSTL(4)
            MOVE 0 TO SQL-SQHSTS(4)
            MOVE 0 TO SQL-SQINDV(4)
            MOVE 0 TO SQL-SQINDS(4)
            MOVE 0 TO SQL-SQHARM(4)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|ëóã‡òAî‘ IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(5)
            MOVE 2 TO SQL-SQHSTL(5)
            MOVE 0 TO SQL-SQHSTS(5)
            MOVE 0 TO SQL-SQINDV(5)
            MOVE 0 TO SQL-SQINDS(5)
            MOVE 0 TO SQL-SQHARM(5)
            CALL "SQLADR" USING
                ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXâÒêî
                SQL-SQHSTV(6)
            MOVE 2 TO SQL-SQHSTL(6)
            MOVE 0 TO SQL-SQHSTS(6)
            MOVE 0 TO SQL-SQINDV(6)
            MOVE 0 TO SQL-SQINDS(6)
            MOVE 0 TO SQL-SQHARM(6)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|ëóã‡êÊÉRÅ[Éh IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(7)
            MOVE 2 TO SQL-SQHSTL(7)
            MOVE 0 TO SQL-SQHSTS(7)
            MOVE 0 TO SQL-SQINDV(7)
            MOVE 0 TO SQL-SQINDS(7)
            MOVE 0 TO SQL-SQHARM(7)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|ëóã‡êÊñº IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(8)
            MOVE 40 TO SQL-SQHSTL(8)
            MOVE 0 TO SQL-SQHSTS(8)
            MOVE 0 TO SQL-SQINDV(8)
            MOVE 0 TO SQL-SQINDS(8)
            MOVE 0 TO SQL-SQHARM(8)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|ëóã‡äz IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(9)
            MOVE 7 TO SQL-SQHSTL(9)
            MOVE 0 TO SQL-SQHSTS(9)
            MOVE 0 TO SQL-SQINDV(9)
            MOVE 0 TO SQL-SQINDS(9)
            MOVE 0 TO SQL-SQHARM(9)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|ìoò^îNåéì˙ IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(10)
            MOVE 8 TO SQL-SQHSTL(10)
            MOVE 0 TO SQL-SQHSTS(10)
            MOVE 0 TO SQL-SQINDV(10)
            MOVE 0 TO SQL-SQINDS(10)
            MOVE 0 TO SQL-SQHARM(10)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|ìoò^éûä‘ IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(11)
            MOVE 8 TO SQL-SQHSTL(11)
            MOVE 0 TO SQL-SQHSTS(11)
            MOVE 0 TO SQL-SQINDV(11)
            MOVE 0 TO SQL-SQINDS(11)
            MOVE 0 TO SQL-SQHARM(11)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|ìoò^íSìñé“ IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(12)
            MOVE 8 TO SQL-SQHSTL(12)
            MOVE 0 TO SQL-SQHSTS(12)
            MOVE 0 TO SQL-SQINDV(12)
            MOVE 0 TO SQL-SQINDS(12)
            MOVE 0 TO SQL-SQHARM(12)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|çXêVîNåéì˙ IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(13)
            MOVE 8 TO SQL-SQHSTL(13)
            MOVE 0 TO SQL-SQHSTS(13)
            MOVE 0 TO SQL-SQINDV(13)
            MOVE 0 TO SQL-SQINDS(13)
            MOVE 0 TO SQL-SQHARM(13)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|çXêVéûä‘ IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(14)
            MOVE 8 TO SQL-SQHSTL(14)
            MOVE 0 TO SQL-SQHSTS(14)
            MOVE 0 TO SQL-SQINDV(14)
            MOVE 0 TO SQL-SQINDS(14)
            MOVE 0 TO SQL-SQHARM(14)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|çXêVé“ IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(15)
            MOVE 8 TO SQL-SQHSTL(15)
            MOVE 0 TO SQL-SQHSTS(15)
            MOVE 0 TO SQL-SQINDV(15)
            MOVE 0 TO SQL-SQINDS(15)
            MOVE 0 TO SQL-SQHARM(15)
            CALL "SQLADR" USING
                ÇcÇTÇPÇPÅ|ì¸óÕíSìñé“ÉRÅ[Éh IN
                ï€åØéñåÃëóã‡
                SQL-SQHSTV(16)
            MOVE 8 TO SQL-SQHSTL(16)
            MOVE 0 TO SQL-SQHSTS(16)
            MOVE 0 TO SQL-SQINDV(16)
            MOVE 0 TO SQL-SQINDS(16)
            MOVE 0 TO SQL-SQHARM(16)
            CALL "SQLADR" USING
                SQL-SQHSTV(1)
                SQL-SQPHSV
            CALL "SQLADR" USING
                SQL-SQHSTL(1)
                SQL-SQPHSL
            CALL "SQLADR" USING
                SQL-SQHSTS(1)
                SQL-SQPHSS
            CALL "SQLADR" USING
                SQL-SQINDV(1)
                SQL-SQPIND
            CALL "SQLADR" USING
                SQL-SQINDS(1)
                SQL-SQPINS
            CALL "SQLADR" USING
                SQL-SQHARM(1)
                SQL-SQPARM
            CALL "SQLADR" USING
                SQL-SQHARC(1)
                SQL-SQPARC

            CALL "SQLBEX" USING
                SQLCTX
                SQLEXD
                SQLFPN

            CALL "SQLGSS" USING
               SQLSTATE
                .
004010*                                                                 
004020*----------------------------------------------------------------*
004030*    í«â¡èàóùÇämîF                                              *
004040*----------------------------------------------------------------*
004050     EVALUATE  SQLCODE                                            
004060        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
004070*--<       í«â¡ê¨å˜ >                                             
004080           COMPUTE  ÇvÅ|èoóÕÅ|åèêî  =  ÇvÅ|èoóÕÅ|åèêî  +  1       
004090        WHEN   OTHER                                              
004100*--<       í«â¡èàóùÉGÉâÅ[ >                                       
004110           MOVE     -50               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004120           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004130     END-EVALUATE.                                                
004140*                                                                 
004150 èoóÕèàóùÅ|ÇdÇwÇhÇs.                                              
004160     EXIT.                                                        
004170******************************************************************
004180*   ïœä∑ÉeÅ[ÉuÉãèàóù                                             *
004190******************************************************************
004200 ïœä∑ÉeÅ[ÉuÉãèàóù                     SECTION.                    
004210 ïœä∑ÉeÅ[ÉuÉãèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
004220     
      *    EXEC SQL                                                     
004230*          SELECT  å_ñÒéÌóﬁ                                       
004240*                 ,çƒÉäÅ[ÉXâÒêî                                   
004250*            INTO  :ÇhÇjÇnÇOÇOÇQÅ|å_ñÒéÌóﬁ                        
004260*                 ,:ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXâÒêî         		
004270*            FROM  IKOTBL002                                      
004280*           WHERE  å_ñÒÇmÇn = :ÇkÇsÇqÇgÇiÇjÅ|å_ñÒÇmÇn             
004290*             AND  çƒÉäÅ[ÉXÉRÅ[Éh = :ÇkÇsÇqÇgÇiÇjÅ|çƒÉäÅ[ÉXÉRÅ[Éh 
004300*             AND  ãåç¬å†ä®íËèàóùÉRÅ[Éh =                         
004310*                                  :ÇkÇsÇqÇgÇiÇjÅ|ä®íËèàóùÉRÅ[Éh  
004320*    END-EXEC.
           CALL "SQLADR" USING SQ0003 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 228 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ÇhÇjÇnÇOÇOÇQÅ|å_ñÒéÌóﬁ
               SQL-SQHSTV(1)
           MOVE 3 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXâÒêî
               SQL-SQHSTV(2)
           MOVE 2 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|å_ñÒÇmÇn
               SQL-SQHSTV(3)
           MOVE 9 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|çƒÉäÅ[ÉXÉRÅ[Éh
               SQL-SQHSTV(4)
           MOVE 1 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ÇkÇsÇqÇgÇiÇjÅ|ä®íËèàóùÉRÅ[Éh
               SQL-SQHSTV(5)
           MOVE 2 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004330*----------------------------------------------------------------*
004340*   ïœä∑ÉeÅ[ÉuÉãèàóùÇämîF                                       *
004350*----------------------------------------------------------------*
004360     EVALUATE  SQLCODE                                            
004370        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
004380*--<       éÊìæê¨å˜ >                                             
004390           CONTINUE                                               
004400        WHEN   OTHER                                              
004410*--<       éÊìæÉGÉâÅ[ >                                           
004420           MOVE     -40               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004430           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004440     END-EVALUATE.                                                
004450 ïœä∑ÉeÅ[ÉuÉãèàóùÅ|ÇdÇwÇhÇs.                                      
004460     EXIT.                                                        
004470******************************************************************
004480*    òAî‘ï“èWèàóù                                                *
004490******************************************************************
004500 òAî‘ï“èWèàóù                         SECTION.                    
004510 òAî‘ï“èWèàóùÅ|ÇrÇsÇ`ÇqÇs.                                        
004520        IF ÇvÅ|ÉtÉâÉO = "N"                                       
004530           MOVE "Y"                   TO ÇvÅ|ÉtÉâÉO               
004540	         MOVE  1                    TO  ÇcÇTÇPÇPÅ|òAî‘	        
004550	      ELSE                                                      
004560           IF  ÇcÇTÇPÇPÅ|å_ñÒî‘çÜ = ÇnÇkÇcå_ñÒî‘çÜ                
004570           AND ÇcÇTÇPÇPÅ|å_ñÒéÌóﬁ = ÇnÇkÇcå_ñÒéÌóﬁ                
004580           AND ÇcÇTÇPÇPÅ|ï®åèî‘çÜ = ÇnÇkÇcï®åèî‘çÜ                
004590              COMPUTE  ÇcÇTÇPÇPÅ|òAî‘  =  ÇcÇTÇPÇPÅ|òAî‘  + 1     
004600           ELSE                                                   
004610              MOVE  1                 TO  ÇcÇTÇPÇPÅ|òAî‘          
004620           END-IF				                        
004630        END-IF.                                                   
004640 òAî‘ï“èWèàóùÅ|ÇdÇwÇhÇs.                                          
004650     EXIT.                                                        
004660******************************************************************
004670*    ëóã‡ï“èW                                                    *
004680******************************************************************
004690 ëóã‡ï“èW                             SECTION.                    
004700 ëóã‡ï“èWÅ|ÇrÇsÇ`ÇqÇs.                                            
004710     EVALUATE ÇvÅ|ÉJÉEÉìÉ^                                        
004720       WHEN  1  MOVE  1               TO  ÇcÇTÇPÇPÅ|ëóã‡òAî‘      
004730                MOVE  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇP                
004740                                      TO  ÇcÇTÇPÇPÅ|ëóã‡êÊÉRÅ[Éh  
004750                MOVE  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇP                    
004760                                      TO  ÇcÇTÇPÇPÅ|ëóã‡êÊñº      
004770                MOVE  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇP                      
004780                                      TO  ÇcÇTÇPÇPÅ|ëóã‡äz        
004790       WHEN  2  MOVE  2               TO  ÇcÇTÇPÇPÅ|ëóã‡òAî‘      
004800                MOVE  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇQ                
004810                                      TO  ÇcÇTÇPÇPÅ|ëóã‡êÊÉRÅ[Éh  
004820                MOVE  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇQ                    
004830                                      TO  ÇcÇTÇPÇPÅ|ëóã‡êÊñº      
004840                MOVE  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇQ                      
004850                                      TO  ÇcÇTÇPÇPÅ|ëóã‡äz        
004860       WHEN  3  MOVE  3               TO  ÇcÇTÇPÇPÅ|ëóã‡òAî‘      
004870                MOVE  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊÉRÅ[ÉhÇR                
004880                                      TO  ÇcÇTÇPÇPÅ|ëóã‡êÊÉRÅ[Éh  
004890                MOVE  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡êÊñºÇR                    
004900                                      TO  ÇcÇTÇPÇPÅ|ëóã‡êÊñº      
004910                MOVE  ÇkÇsÇqÇgÇiÇjÅ|ëóã‡äzÇR                      
004920                                      TO  ÇcÇTÇPÇPÅ|ëóã‡äz        
004930     END-EVALUATE.                                                
004940 ëóã‡ï“èWÅ|ÇdÇwÇhÇs.                                              
004950     EXIT.                                                        
004960******************************************************************
004970*    ÉJÉEÉìÉ^èàóù                                                *
004980******************************************************************
004990 ÉJÉEÉìÉ^èàóù                         SECTION.                    
005000 ÉJÉEÉìÉ^èàóùÅ|ÇrÇsÇ`ÇqÇs.                                        
005010*--<    NEW TO OLD>                                               
005020     MOVE  ÇcÇTÇPÇPÅ|å_ñÒî‘çÜ         TO  ÇnÇkÇcå_ñÒî‘çÜ.         
005030     MOVE  ÇcÇTÇPÇPÅ|å_ñÒéÌóﬁ         TO  ÇnÇkÇcå_ñÒéÌóﬁ.         
005040     MOVE  ÇcÇTÇPÇPÅ|ï®åèî‘çÜ         TO  ÇnÇkÇcï®åèî‘çÜ.         
005050*--<    COUNT ÇÃ  COMPUTE >                                       
005060	   IF  ÇvÅ|ÉJÉEÉìÉ^  NOT =  3                                   
005070        MOVE 1                        TO ÇvÅ|ÉJÉEÉìÉ^             
005080     ELSE                                                         
005090	      COMPUTE  ÇvÅ|ÉJÉEÉìÉ^ = ÇvÅ|ÉJÉEÉìÉ^ + 1                  
005100	   END-IF.                                                      
005110 ÉJÉEÉìÉ^èàóùÅ|ÇdÇwÇhÇs.                                          
005120     EXIT.                                                        
005130******************************************************************
005140*    èIóπèàóù                                                    *
005150******************************************************************
005160 èIóπèàóù                             SECTION.                    
005170 èIóπèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
005180*                                                                 
005190     PERFORM  ÇcÇaÉNÉçÅ[ÉYèàóù.                                   
005200*                                                                 
005210     PERFORM  ÇcÇaÉRÉ~ÉbÉgèàóù.                                   
005220*                                                                 
005230     PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ.                                 
005240*                                                                 
005250*--< ÉvÉçÉOÉâÉÄê≥èÌèIóπ >                                         
005260     MOVE  íËêîÅ|ê≥èÌèÛë‘             TO  PROGRAM-STATUS.         
005270*                                                                 
005280 èIóπèàóùÅ|ÇdÇwÇhÇs.                                              
005290     EXIT.                                                        
005300******************************************************************
005310*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
005320******************************************************************
005330 èIóπÉÅÉbÉZÅ[ÉWèoóÕ                   SECTION.                    
005340 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
005350*                                                                 
005360*----------------------------------------------------------------*
005370*    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
005380*----------------------------------------------------------------*
005390     INITIALIZE                       IF-CHOCO001.                
005400     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
005410     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
005420     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
005430     MOVE  "LTRHJK"                   TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
005440     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
005450     MOVE  ÇvÅ|ì¸óÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
005460     MOVE  "ï€åØã‡êøãÅì¸ã‡ì«çûåèêî"                               
005470                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
005480     CALL  CLOCO001                USING  IF-CHOCO001.            
005490*                                                                 
005500     INITIALIZE                       IF-CHOCO001.                
005510     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
005520     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
005530     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
005540     MOVE  "D511HJS"                  TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
005550     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
005560     MOVE  ÇvÅ|èoóÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
005570     MOVE  "ï€åØéñåÃëóã‡èoóÕåèêî"     TO                          
005580                                      ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW.     
005590     CALL  CLOCO001                USING  IF-CHOCO001.            
005600*                                                                 
005610*----------------------------------------------------------------*
005620*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
005630*----------------------------------------------------------------*
005640     INITIALIZE                       IF-CHOCO001.                
005650     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
005660     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
005670     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
005680     MOVE  "END"                      TO  ã§ÇPÅ|èàóùéØï .         
005690     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
005700     CALL  CLOCO001                USING  IF-CHOCO001.            
005710*                                                                 
005720 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
005730     EXIT.                                                        
005740******************************************************************
005750*    ÇcÇaÉNÉçÅ[ÉY                                                *
005760******************************************************************
005770 ÇcÇaÉNÉçÅ[ÉYèàóù                     SECTION.                    
005780 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
005790*                                                                 
005800*--< ÉJÅ[É\Éã ÉNÉçÅ[ÉY >                                          
005810     
      *    EXEC SQL                                                     
005820*       CLOSE  CUR1                                               
005830*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 263 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005840*                                                                 
005850 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇdÇwÇhÇs.                                      
005860     EXIT.                                                        
005870******************************************************************
005880*    ÇcÇaÉRÉ~ÉbÉgèàóù                                            *
005890******************************************************************
005900 ÇcÇaÉRÉ~ÉbÉgèàóù                     SECTION.                    
005910 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
005920*                                                                 
005930     
      *    EXEC  SQL                                                    
005940*       COMMIT  WORK  RELEASE                                     
005950*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 278 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005960*                                                                 
005970     INITIALIZE                       IF-CHOCO001.                
005980     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
005990     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
006000     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
006010     MOVE  "COMMIT"                   TO  ã§ÇPÅ|èàóùéØï .         
006020     MOVE  "ÉRÉ~ÉbÉgé¿é{"             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
006030     CALL  CLOCO001                USING  IF-CHOCO001.            
006040*                                                                 
006050 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇdÇwÇhÇs.                                      
006060     EXIT.                                                        
006070******************************************************************
006080*    ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                                        *
006090******************************************************************
006100 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                 SECTION.                    
006110 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóùÅ|ÇrÇsÇ`ÇqÇs.                                
006120*                                                                 
006130     
      *    EXEC  SQL                                                    
006140*       ROLLBACK WORK  RELEASE                                    
006150*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 293 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
006160*                                                                 
006170     INITIALIZE                       IF-CHOCO001.                
006180     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
006190     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
006200     MOVE  "9"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
006210     MOVE  "ROLLBACK"                 TO  ã§ÇPÅ|èàóùéØï .         
006220     MOVE  "ÉçÅ[ÉãÉoÉbÉNé¿é{"         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
006230     CALL  CLOCO001                USING  IF-CHOCO001.            
006240*                                                                 
006250 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóùÅ|ÇdÇwÇhÇs.                                  
006260     EXIT.                                                        
006270******************************************************************
006280*    ÉGÉâÅ[èàóù                                                  *
006290******************************************************************
006300 ÉGÉâÅ[îªíËèàóù                       SECTION.                    
006310 ÉGÉâÅ[îªíËèàóùÅ|ÇrÇsÇ`ÇqÇs.                                      
006320*                                                                 
006330     MOVE  "Y"                        TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO.    
006340     INITIALIZE                           IF-CHOCO001.            
006350*                                                                 
006360     EVALUATE  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh                                   
006370        WHEN  -10                                                 
006380*--<       ÇnÇqÇ`ÇbÇkÇdê⁄ë±é∏îs >                                 
006390           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
006400           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
006410           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
006420           MOVE  "CONNECT"            TO  ã§ÇPÅ|èàóùéØï           
006430           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
006440           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
006450           CALL  CLOCO001          USING  IF-CHOCO001             
006460*                                                                 
006470        WHEN  -20                                                 
006480*--<       åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãÉIÅ[ÉvÉìé∏îs >                     
006490           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
006500           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
006510           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
006520           MOVE  "LTRHJK"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
006530           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
006540           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
006550           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
006560           CALL  CLOCO001          USING  IF-CHOCO001             
006570*                                                                 
006580        WHEN  -30                                                 
006590*--<       åãçáÉeÅ[ÉuÉãì«çûé∏îs >                                 
006600           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
006610           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
006620           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
006630           MOVE  "LTRHJK"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
006640           MOVE  "FETCH"              TO  ã§ÇPÅ|èàóùéØï           
006650           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
006660           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
006670           CALL  CLOCO001          USING  IF-CHOCO001             
006680        WHEN  -40                                                 
006690*--<       å_ñÒéÌóﬁìôïœä∑ÉeÅ[ÉuÉãÇÃéÊìæ >                         
006700           MOVE  "1"                  TO   ã§ÇPÅ|ÉCÉxÉìÉgéÌï      
006710           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
006720           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
006730           MOVE  "LTRHJK"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
006740           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
006750           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
006760           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
006770           CALL  CLOCO001          USING  IF-CHOCO001             
006780        WHEN  -50                                                 
006790*--<       ï€åØéñåÃëóã‡í«â¡é∏îs >                                 
006800           MOVE  "1"                  TO   ã§ÇPÅ|ÉCÉxÉìÉgéÌï      
006810           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
006820           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
006830           MOVE  "D511HJS"            TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
006840           MOVE  "INSERT"             TO  ã§ÇPÅ|èàóùéØï           
006850           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
006860           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
006870           CALL  CLOCO001          USING  IF-CHOCO001             
006880*                                                                 
006890        WHEN  OTHER                                               
006900           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
006910     END-EVALUATE.                                                
006920*                                                                 
006930     IF ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO  =  "Y"                              
006940        PERFORM  ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                             
006950*                                                                 
006960        PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ                               
006970*                                                                 
006980*--<    ÉvÉçÉOÉâÉÄàŸèÌèIóπÇÃÉäÉ^Å[ÉìÉRÅ[Éh >                      
006990        MOVE  íËêîÅ|àŸèÌèÛë‘          TO  PROGRAM-STATUS          
007000*                                                                 
007010        EXIT  PROGRAM                                             
007020     END-IF.                                                      
007030*                                                                 
007040 ÉGÉâÅ[îªíËèàóùÅ|ÇdÇwÇhÇs.                                        
007050     EXIT.                                                        
007060******************************************************************
007070*                  END OF PROGRAM                                *
007080******************************************************************
