000010******************************************************************
000020*         CP(A)                                     *
000030*      1. vO  : ϑڍs                         *
000040*      2. vOID  : COBIS560                               *
000050*      3. Tv      : ڍsixAbvj̍WJA *
000060*                         ϑca쐬B                 *
000070*      4. 쐬        : h                                 *
000080*      5. 쐬        : 2005.04.04                             *
000090******************************************************************
000100*                                                                 
000110******************************************************************
000120*    hcdmshehb`shnm  chuhrhnm              *
000130******************************************************************
000140 IDENTIFICATION                       DIVISION.                   
000150*                                                                 
000160 PROGRAM-ID.                          COBIS560.                   
000170******************************************************************
000180*    dmuhqnmldms        chuhrhnm              *
000190******************************************************************
000200 ENVIRONMENT                          DIVISION.                   
000210******************************************************************
000220*    c`s`                      chuhrhnm              *
000230******************************************************************
000240 DATA                                 DIVISION.                   
000250******************************************************************
000260*  vnqjhmf|rsnq`fd  rdbshnm                *
000270******************************************************************
000280  WORKING-STORAGE                     SECTION.                    
000290*----------------------------------------------------------------*
000300*    zXgϐ`GA                                        *
000310*----------------------------------------------------------------*
000320     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +34.
           02  SQLFPN-FILENAME PIC X(34) VALUE "C:\COB97\SOC\COBIS560\CO
      -    "BIS560.PCO".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(160) VALUE "insert into D511HJS_TBL(_ԍ
      -     ",_,ԍ,A,A,ă[X,R[h,
      -    "於,z,o^N,o^,o^S,XVN,X
      -    "V,X".

           02  FILLER PIC X(102) VALUE "V,͒S҃R[h) values (:
      -    "b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,
      -    ":b15,:b16)".

       01  SQ0003 GLOBAL.
           02  FILLER PIC X(136) VALUE "select _  ,ă[X  
      -     " into :b1,:b2  from IKOTBL002 where ((_mn=:b3 and ă
      -    "[XR[h=:b4) and 菈R[h=:b5)".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +148377852.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +16.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 16 TIMES.


       01  SQ0001 GLOBAL.
           02  FILLER PIC X(159) VALUE "select _mn  ,ă[XR[h
      -    "  ,菈R[h  ,}  ,R[hP  ,R[h
      -    "Q  ,R[hR  ,於P  ,於Q  ,於R  
      -    ",z".

           02  FILLER PIC X(50) VALUE "P  ,zQ  ,zR   from L
      -    "TRHJK            ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +189.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +193.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +209.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +244.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +82.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +270.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +149.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +262.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +364.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +228.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +136.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +422.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +263.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +581.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +278.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +12.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +593.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +293.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +14.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +32.
           02     FILLER PIC S9(4) COMP-5 VALUE +613.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000330*                                                                 
000340*--< nq`bkdʕϐ >                                       
000350     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
000360*                                                                 
000370*--< nq`bkd  rpks >                               
000010*--rpkʕϐ
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000380     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000390*                                                                 
000400*--< ی̃}X^iیںށj>                       
000410     
      *    EXEC  SQL  INCLUDE  LTRHJK.CBL            END-EXEC.
000420*                                                                 
000430*--< _ޓϊe[u>                                      
000010************************************************
000020* ی̃}X^iی)(LTRHJK)
000030************************************************
000040 01  ksqgij|_mn PIC  X(009).
000050 01  ksqgij|} PIC S9(003) COMP-3.
000060 01  ksqgij|ă[XR[h PIC S9(001) COMP-3.
000070 01  ksqgij|̓t|I PIC S9(001) COMP-3.
000080 01  ksqgij|̓t|t PIC  X(006).
000090 01  ksqgij|̓t|ggll PIC  X(004).
000100 01  ksqgij| PIC  X(030).
000110 01  ksqgij|[XJn|I PIC S9(001) COMP-3.
000120 01  ksqgij|[XJn|t PIC  X(006).
000130 01  ksqgij|[XI|I PIC S9(001) COMP-3.
000140 01  ksqgij|[XI|t PIC  X(006).
000150 01  ksqgij| PIC S9(003) COMP-3.
000160 01  ksqgij|wz PIC S9(013) COMP-3.
000170 01  ksqgij|[U[R[h PIC  X(008).
000180 01  ksqgij|[U[t@X PIC  X(012).
000190 01  ksqgij|ݒuꏊ PIC  X(020).
000200 01  ksqgij|][XgR[h PIC  X(002).
000210 01  ksqgij|p[XpΏۊz PIC S9(013) COMP-3.
000220 01  ksqgij|菈R[h PIC  X(002).
000230 01  ksqgij|Ǘmn PIC  X(015).
000240 01  ksqgij|یR[h PIC  X(004).
000250 01  ksqgij|ӔCԎ|I PIC S9(001) COMP-3.
000260 01  ksqgij|ӔCԎ|t PIC  X(006).
000270 01  ksqgij|ӔCԎ|I PIC S9(001) COMP-3.
000280 01  ksqgij|ӔCԎ|t PIC  X(006).
000290 01  ksqgij|ی،ԍ PIC  X(011).
000300 01  ksqgij|یi PIC S9(013) COMP-3.
000310 01  ksqgij|ă[Xtۗ PIC S9(002) COMP-3.
000320 01  ksqgij|_~[OOP PIC  X(012).
000330 01  ksqgij|̐o^|I PIC S9(001) COMP-3.
000340 01  ksqgij|̐o^|t PIC  X(006).
000350 01  ksqgij|̋敪 PIC  X(001).
000360 01  ksqgij|̌ PIC  X(001).
000370 01  ksqgij|Еz PIC S9(013) COMP-3.
000380 01  ksqgij|Еcz PIC S9(013) COMP-3.
000390 01  ksqgij|_~[OOQ PIC  X(017).
000400 01  ksqgij|N|I PIC S9(001) COMP-3.
000410 01  ksqgij|N|t PIC  X(006).
000420 01  ksqgij|qdemn PIC  X(008).
000430 01  ksqgij|ی PIC S9(013) COMP-3.
000440 01  ksqgij|Վpی PIC S9(013) COMP-3.
000450 01  ksqgij|یz PIC S9(013) COMP-3.
000460 01  ksqgij|_~[OOR PIC  X(014).
000470 01  ksqgij|o^|I PIC S9(001) COMP-3.
000480 01  ksqgij|o^|t PIC  X(006).
000490 01  ksqgij||I PIC S9(001) COMP-3.
000500 01  ksqgij||t PIC  X(006).
000510 01  ksqgij|z PIC S9(013) COMP-3.
000520 01  ksqgij|ی敪 PIC  X(001).
000530 01  ksqgij|R[hP PIC S9(002) COMP-3.
000540 01  ksqgij|於P PIC  X(040).
000550 01  ksqgij|zP PIC S9(013) COMP-3.
000560 01  ksqgij|R[hQ PIC S9(002) COMP-3.
000570 01  ksqgij|於Q PIC  X(040).
000580 01  ksqgij|zQ PIC S9(013) COMP-3.
000590 01  ksqgij|R[hR PIC S9(002) COMP-3.
000600 01  ksqgij|於R PIC  X(040).
000610 01  ksqgij|zR PIC S9(013) COMP-3.
000620 01  ksqgij|_~[OOS PIC  X(011).
000630 01  ksqgij|_~[OOT PIC  X(021).
000640 01  ksqgij|ʏ PIC  X(035).
000440     
      *    EXEC  SQL  INCLUDE  IKOTBL002.CBL         END-EXEC.
000450*                                                                 
000460*--< ڍs_WJ >                                            
000010************************************************
000020* _ޓϊe[u(IKOTBL002)
000030************************************************
000040 01  hjnOOQ|_mn PIC  X(009).
000050 01  hjnOOQ|ă[XR[h PIC S9(001) COMP-3.
000060 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000070 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000080 01  hjnOOQ|ă[X PIC S9(002) COMP-3.
000090 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000100 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000110 01  hjnOOQ|_ PIC  X(003).
000120 01  hjnOOQ|_敪 PIC  X(001).
000130 01  hjnOOQ|菇 PIC  X(001).
000470     
      *    EXEC  SQL  INCLUDE  D511HJS.CBL           END-EXEC.
000480*                                                                 
      *****************************************************************
      *   ی̑(D511HJS_TBL)
      *****************************************************************
       01  ی̑.
           03  cTPP|_ԍ    PIC  X(010).
           03  cTPP|_    PIC  X(003).
           03  cTPP|ԍ    PIC S9(004) PACKED-DECIMAL.
           03  cTPP|A        PIC S9(003) PACKED-DECIMAL.
           03  cTPP|A    PIC S9(002) PACKED-DECIMAL.
           03  cTPP|ă[X
                                     PIC S9(002) PACKED-DECIMAL.
           03  cTPP|R[h
                                     PIC  X(002).
           03  cTPP|於    PIC  X(040).
           03  cTPP|z      PIC S9(013) PACKED-DECIMAL.
           03  cTPP|o^N  PIC  X(008).
           03  cTPP|o^    PIC  X(008).
           03  cTPP|o^S  PIC  X(008).
           03  cTPP|XVN  PIC  X(008).
           03  cTPP|XV    PIC  X(008).
           03  cTPP|XV      PIC  X(008).
           03  cTPP|͒S҃R[h
                                     PIC  X(008).
000490     
      *    EXEC  SQL  END  DECLARE          SECTION  END-EXEC.
000500*                                                                 
000510*----------------------------------------------------------------*
000520*    vnqjGA                                              *
000530*----------------------------------------------------------------*
000540*--< G[&TEMPp>                                           
000550*--<TEMPp>                                                       
000560 01  v|JE^                     PIC  9(03)   VALUE  1.      
000570 01  v|tO                       PIC  X(01)   VALUE  "N".    
000580 01  vnqj|GA.                                            
000590*--< G[p >                                               
000600     03  v|G[R[h             PIC S9(04).                 
000610                                                                  
000620*--< tOAA >                                               
000630     03  tOAA.                                            
000640         05  v|I|tO         PIC  X(01).                 
000650         05  v|ُI|tO     PIC  X(01).                 
000660*                                                                 
000670*--< GA >                                                 
000680     03  GA.                                              
000690         05  v|́|           PIC  9(09).                 
000700         05  v|ó|           PIC  9(09).                 
000710*                                                                 
000720*--< Aԏ̃GA >                                           
000730     03  Aԏ.                                                
000740          05  nkc_ԍ          PIC  X(010)  VALUE SPACE.   
000750          05  nkc_          PIC  X(003)  VALUE SPACE.   
000760          05  nkcԍ          PIC  S9(004)  VALUE ZERO.   
000770*                                                                 
000780*--< ʏ >                                                   
000790 01  v|ʏ.                                                
000800     03  v|VXet.                                        
000810         05  v|I                 PIC  X(02) VALUE  "20".     
000820         05  v|N               PIC  X(06).                 
000830     03  v|VXe             PIC  X(08).                 
000840     03  v|S                   PIC  X(08)                  
000850	                                           VALUE  "IKOPG   ".   
000860*                                                                 
000870*----------------------------------------------------------------*
000880*    Tu[`                                              *
000890*----------------------------------------------------------------*
000900 01  CALL-AREA.                                                   
000910*--< ʃOTu[` >                                       
000920     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
000930     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
000940*                                                                 
000950*----------------------------------------------------------------*
000960*    bnoẍ                                                *
000970*----------------------------------------------------------------*
000980*--< ʃOpp[^ >                                       
000990 01  IF-CHOCO001.                                                 
001000     COPY  CHOCO001  REPLACING  ==()==  BY  ==P|==.           
001010*                                                                 
001020*----------------------------------------------------------------*
001030*    hmht@CǍTu[`pp^̈                *
001040*----------------------------------------------------------------*
001050 01  PARA-AREA.                                                   
001060     COPY CPBCO001.                                               
001070******************************************************************
001080*    萔pf[^`GA                                      *
001090******************************************************************
001100 CONSTANT                             SECTION.                    
001110 01  萔̈.                                                    
001120     03  萔|vOhc         PIC  X(08) VALUE "COBIS560".
001130     03  萔|vO           PIC  X(80)                  
001140                                   VALUE  "ی̑쐬".     
001150     03  萔|rpknj             PIC S9(04)  VALUE  ZERO.    
001160     03  萔|rpkdmc           PIC S9(04)  VALUE  0100.    
001170     03  萔|               PIC S9(04)  VALUE  ZERO.    
001180     03  萔|ُ               PIC S9(04)  VALUE  0009.    
001190******************************************************************
001200*    oqnbdctqd            chuhrhnm              *
001210******************************************************************
001220 PROCEDURE                            DIVISION.                   
001230*                                                                 
001240     PERFORM  .                                           
001250*                                                                 
001260     PERFORM  又  UNTIL  v|I|tO  =  "Y".            
001270*                                                                 
001280     PERFORM  I.                                           
001290*                                                                 
001300     STOP     RUN.                                                
001310*                                                                 
001320******************************************************************
001330*                                                        *
001340******************************************************************
001350                              SECTION.                    
001360 |rs`qs.                                            
001370*                                                                 
001380*----------------------------------------------------------------*
001390*    JnbZ[Wo͏                                      *
001400*----------------------------------------------------------------*
001410     INITIALIZE                       IF-CHOCO001.                
001420     MOVE  "3"                        TO  P|Cxg.     
001430     MOVE  萔|vOhc       TO  P|\[Xhc.       
001440     MOVE  "0"                        TO  P|AR[h.       
001450     MOVE  "START"                    TO  P|.         
001460     MOVE  萔|vO         TO  P|̑bZ[W. 
001470     CALL  CLOCO001                USING  IF-CHOCO001.            
001480*                                                                 
001490*----------------------------------------------------------------*
001500*    Ɨ̈̏l                                        *
001510*----------------------------------------------------------------*
001520     MOVE  SPACE                      TO  vnqj|GA.       
001530     INITIALIZE                           vnqj|GA.       
001540*                                                                 
001550*--< bott擾 >                                           
001560     ACCEPT  v|N               FROM  DATE.                 
001570*                                                                 
001580*--< bot擾 >                                           
001590     ACCEPT  v|VXe         FROM  TIME.                 
001600*                                                                 
001610*--< nq`bkdڑ >          nq`bkdڑ.                
001620     PERFORM   nq`bkdڑ.                                  
001630*                                                                 
001640*--< e[uJ[\` >                                   
001650     PERFORM  e[uJ[\`.                           
001660*                                                                 
001670*--< e[uJ[\Ǎ(P) >                           
001680     PERFORM  e[uJ[\Ǎ.                           
001690*                                                                 
001700 |dwhs.                                              
001710     EXIT.                                                        
001720******************************************************************
001730*    nq`bkdڑ                                            *
001740******************************************************************
001750 nq`bkdڑ                     SECTION.                    
001760 nq`bkdڑ|rs`qs.                                    
001770*                                                                 
001780*--< caڑp擾 >                                   
001790     CALL  COBCO001                USING  PARA-AREA.              
001800*                                                                 
001810     MOVE  PARA-DBSTRING              TO  DB-STRING.              
001820     MOVE  PARA-USERNAME              TO  USERNAME.               
001830     MOVE  PARA-PASSWORD              TO  PASSWD.                 
001840*                                                                 
001850*----------------------------------------------------------------*
001860*    Jnڑ                                                    *
001870*----------------------------------------------------------------*
001880     IF    DB-STRING  =  SPACE                                    
001890        
      *       EXEC SQL                                                  
001900*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
001910*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
001920     ELSE                                                         
001930        
      *       EXEC SQL                                                  
001940*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
001950*            USING  :DB-STRING                                    
001960*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
001970     END-IF.                                                      
001980*                                                                 
001990*----------------------------------------------------------------*
002000*    ڑmF                                                    *
002010*----------------------------------------------------------------*
002020     EVALUATE  SQLCODE                                            
002030        WHEN   萔|rpknj                                   
002040           CONTINUE                                               
002050        WHEN   OTHER                                              
002060*--<       ڑG[ >                                           
002070           MOVE     -10               TO  v|G[R[h        
002080           PERFORM  G[菈                                
002090     END-EVALUATE.                                                
002100*                                                                 
002110 nq`bkdڑ|dwhs.                                      
002120     EXIT.                                                        
002130******************************************************************
002140*        e[uJ[\`                                *
002150******************************************************************
002160 e[uJ[\`             SECTION.                    
002170 e[uJ[\`|rs`qs.                            
002180*                                                                 
002190*----------------------------------------------------------------*
002200*    J[\nodm                                        *
002210*----------------------------------------------------------------*
002220     
      *    EXEC SQL                                                     
002230*       DECLARE CUR1  CURSOR FOR                                  
002240*          SELECT                                                 
002250*                _mn                                         
002260*               ,ă[XR[h                                   
002270*               ,菈R[h                                   
002280*               ,}                                         
002290*               ,R[hP                                   
002300*               ,R[hQ                                   
002310*               ,R[hR                                   
002320*               ,於P                                       
002330*               ,於Q                                       
002340*               ,於R                                       
002350*               ,zP                                         
002360*               ,zQ                                         
002370*               ,zR                                         
002380*            FROM  LTRHJK                                         
002390*    END-EXEC.
002400*                                                                 
002410*----------------------------------------------------------------*
002420*    J[\nodm                                        *
002430*----------------------------------------------------------------*
002440     
      *    EXEC  SQL                                                    
002450*       OPEN  CUR1                                                
002460*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
002470*                                                                 
002480*----------------------------------------------------------------*
002490*    J[\nodmmF                                        *
002500*----------------------------------------------------------------*
002510     EVALUATE  SQLCODE                                            
002520        WHEN  萔|rpknj                                    
002530*--<        >                                                 
002540           CONTINUE                                               
002550        WHEN  OTHER                                               
002560*--<       J[\nodmG[ >                               
002570           MOVE -20                   TO  v|G[R[h        
002580           PERFORM  G[菈                                
002590     END-EVALUATE.                                                
002600*                                                                 
002610 e[uJ[\`|dwhs.                              
002620     EXIT.                                                        
002630******************************************************************
002640*    e[uJ[\Ǎ                                    *
002650******************************************************************
002660 e[uJ[\Ǎ             SECTION.                    
002670 e[uJ[\Ǎ|rs`qs.                            
002680*                                                                 
002690*--< e[uJ[\Ǎ >                                   
002700     
      *    EXEC SQL                                                     
002710*        FETCH  CUR1                                              
002720*         INTO  :ksqgij|_mn                           
002730*              ,:ksqgij|ă[XR[h                     
002740*              ,:ksqgij|菈R[h                     
002750*              ,:ksqgij|}                           
002760*              ,:ksqgij|R[hP                     
002770*              ,:ksqgij|R[hQ                     
002780*              ,:ksqgij|R[hR                     
002790*              ,:ksqgij|於P                         
002800*              ,:ksqgij|於Q                         
002810*              ,:ksqgij|於R                         
002820*              ,:ksqgij|zP                           
002830*              ,:ksqgij|zQ                           
002840*              ,:ksqgij|zR                           
002850*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 82 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ksqgij|_mn
               SQL-SQHSTV(1)
           MOVE 9 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ksqgij|ă[XR[h
               SQL-SQHSTV(2)
           MOVE 1 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ksqgij|菈R[h
               SQL-SQHSTV(3)
           MOVE 2 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ksqgij|}
               SQL-SQHSTV(4)
           MOVE 2 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ksqgij|R[hP
               SQL-SQHSTV(5)
           MOVE 2 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               ksqgij|R[hQ
               SQL-SQHSTV(6)
           MOVE 2 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               ksqgij|R[hR
               SQL-SQHSTV(7)
           MOVE 2 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               ksqgij|於P
               SQL-SQHSTV(8)
           MOVE 40 TO SQL-SQHSTL(8)
           MOVE 0 TO SQL-SQHSTS(8)
           MOVE 0 TO SQL-SQINDV(8)
           MOVE 0 TO SQL-SQINDS(8)
           MOVE 0 TO SQL-SQHARM(8)
           CALL "SQLADR" USING
               ksqgij|於Q
               SQL-SQHSTV(9)
           MOVE 40 TO SQL-SQHSTL(9)
           MOVE 0 TO SQL-SQHSTS(9)
           MOVE 0 TO SQL-SQINDV(9)
           MOVE 0 TO SQL-SQINDS(9)
           MOVE 0 TO SQL-SQHARM(9)
           CALL "SQLADR" USING
               ksqgij|於R
               SQL-SQHSTV(10)
           MOVE 40 TO SQL-SQHSTL(10)
           MOVE 0 TO SQL-SQHSTS(10)
           MOVE 0 TO SQL-SQINDV(10)
           MOVE 0 TO SQL-SQINDS(10)
           MOVE 0 TO SQL-SQHARM(10)
           CALL "SQLADR" USING
               ksqgij|zP
               SQL-SQHSTV(11)
           MOVE 7 TO SQL-SQHSTL(11)
           MOVE 0 TO SQL-SQHSTS(11)
           MOVE 0 TO SQL-SQINDV(11)
           MOVE 0 TO SQL-SQINDS(11)
           MOVE 0 TO SQL-SQHARM(11)
           CALL "SQLADR" USING
               ksqgij|zQ
               SQL-SQHSTV(12)
           MOVE 7 TO SQL-SQHSTL(12)
           MOVE 0 TO SQL-SQHSTS(12)
           MOVE 0 TO SQL-SQINDV(12)
           MOVE 0 TO SQL-SQINDS(12)
           MOVE 0 TO SQL-SQHARM(12)
           CALL "SQLADR" USING
               ksqgij|zR
               SQL-SQHSTV(13)
           MOVE 7 TO SQL-SQHSTL(13)
           MOVE 0 TO SQL-SQHSTS(13)
           MOVE 0 TO SQL-SQINDV(13)
           MOVE 0 TO SQL-SQINDS(13)
           MOVE 0 TO SQL-SQHARM(13)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
002860*                                                                 
002870*----------------------------------------------------------------*
002880*    e[uJ[\ǍmF                              *
002890*----------------------------------------------------------------*
002900     EVALUATE   SQLCODE                                           
002910        WHEN   萔|rpknj                                   
002920*--<        >                                                 
002930           COMPUTE  v|́|  =  v|́|  +  1       
002940        WHEN   萔|rpkdmc                                 
002950*--<       ǍI >                                             
002960           MOVE  "Y"                  TO  v|I|tO        
002970        WHEN   OTHER                                              
002980*--<       ǍG[ >                                           
002990           MOVE     -30               TO  v|G[R[h        
003000           PERFORM  G[菈                                
003010     END-EVALUATE.                                                
003020*                                                                 
003030 e[uJ[\Ǎ|dwhs.                              
003040     EXIT.                                                        
003050******************************************************************
003060*    又                                                      *
003070******************************************************************
003080 又                               SECTION.                    
003090 又|rs`qs.                                              
003100*                                                                 
003110     PERFORM  ҏWo͏.                                       
003120*--< e[uJ[\ǍiQڈȍ~j >                     
003130     PERFORM  e[uJ[\Ǎ.                           
003140*                                                                 
003150 又|dwhs.                                                
003160     EXIT.                                                        
003170******************************************************************
003180*     ҏWo͏                                               *
003190******************************************************************
003200 ҏWo͏                         SECTION.                    
003210 ҏWo͏|rs`qs.                                        
003220*                                                                 
003230*---<No.01 >                                                      
003240     MOVE  ksqgij|_mn     TO  cTPP|_ԍ.     
003250*-- <No.02,06 >                                                   
003260     PERFORM  ϊe[u.                                   
003270*-- <No.03 >                                                      
003280     MOVE  ksqgij|}     TO  cTPP|ԍ.     
003290*---<No.10>                                                       
003300     MOVE  v|N                 TO  cTPP|o^N.   
003310*---<No.11>                                                       
003320     MOVE  v|VXe           TO  cTPP|o^.     
003330*---<No.12>                                                       
003340     MOVE  v|S                 TO  cTPP|o^S.   
003350*---<No.13>                                                       
003360     MOVE  v|N                 TO  cTPP|XVN.   
003370*---<No.14>                                                       
003380     MOVE  v|VXe           TO  cTPP|XV.     
003390*---<No.15>                                                       
003400     MOVE  v|S                 TO  cTPP|XV.       
003410*---<No.16>                                                       
003420     MOVE  v|S                 TO                          
003430                                     cTPP|͒S҃R[h.  
003440     PERFORM  ҏW  THRU  o͏  3  TIMES.                 
003450******************************************************************
003460*     ҏW                                                   *
003470******************************************************************
003480 ҏW                             SECTION.                    
003490 ҏW|rs`qs.                                            
003500*---<No.04>                                                       
003510     PERFORM  AԕҏW.                                       
003520*---<No.05A07A08A09 >                                          
003530     PERFORM  ҏW.                                           
003540*---<v|JE^  >                                          
003550     PERFORM  JE^.                                       
003560 ҏW|dwhs.                                              
003570     EXIT.                                                        
003580******************************************************************
003590*    o͏                                                    *
003600******************************************************************
003610 o͏                             SECTION.                    
003620 o͏|rs`qs.                                            
003630*                                                                 
003640      
      *     EXEC  SQL                                                   
003650*       INSERT  INTO  D511HJS_TBL                                 
003660*          ( _ԍ                                             
003670*           ,_                                             
003680*           ,ԍ                                             
003690*           ,A                                                 
003700*           ,A                                             
003710*           ,ă[X                                         
003720*           ,R[h                                         
003730*           ,於                                             
003740*           ,z                                               
003750*           ,o^N                                           
003760*           ,o^                                             
003770*           ,o^S                                           
003780*           ,XVN                                           
003790*           ,XV                                             
003800*           ,XV                                               
003810*           ,͒S҃R[h )                                   
003820*                                                                 
003830*      VALUES                                                     
003840*          ( :cTPP|_ԍ                                  
003850*           ,:hjnOOQ|_                              
003860*           ,:cTPP|ԍ                                  
003870*           ,:cTPP|A                                      
003880*           ,:cTPP|A                                  
003890*           ,:hjnOOQ|ă[X                          
003900*           ,:cTPP|R[h                              
003910*           ,:cTPP|於                                  
003920*           ,:cTPP|z                                    
003930*           ,:cTPP|o^N                                
003940*           ,:cTPP|o^                                  
003950*           ,:cTPP|o^S                                
003960*           ,:cTPP|XVN                                
003970*           ,:cTPP|XV                                  
003980*           ,:cTPP|XV                                    
003990*           ,:cTPP|͒S҃R[h )                        
004000*    END-EXEC.
            CALL "SQLADR" USING SQ0002 SQL-STMT
            MOVE 1 TO SQL-ITERS
            MOVE 149 TO SQL-OFFSET
            MOVE 0 TO SQL-OCCURS
            CALL "SQLADR" USING
                SQLCUD
                SQL-CUD
            CALL "SQLADR" USING
                SQLCA
                SQL-SQLEST
            MOVE 256 TO SQL-SQLETY
            CALL "SQLADR" USING
                cTPP|_ԍ IN
                ی̑
                SQL-SQHSTV(1)
            MOVE 10 TO SQL-SQHSTL(1)
            MOVE 0 TO SQL-SQHSTS(1)
            MOVE 0 TO SQL-SQINDV(1)
            MOVE 0 TO SQL-SQINDS(1)
            MOVE 0 TO SQL-SQHARM(1)
            CALL "SQLADR" USING
                hjnOOQ|_
                SQL-SQHSTV(2)
            MOVE 3 TO SQL-SQHSTL(2)
            MOVE 0 TO SQL-SQHSTS(2)
            MOVE 0 TO SQL-SQINDV(2)
            MOVE 0 TO SQL-SQINDS(2)
            MOVE 0 TO SQL-SQHARM(2)
            CALL "SQLADR" USING
                cTPP|ԍ IN
                ی̑
                SQL-SQHSTV(3)
            MOVE 3 TO SQL-SQHSTL(3)
            MOVE 0 TO SQL-SQHSTS(3)
            MOVE 0 TO SQL-SQINDV(3)
            MOVE 0 TO SQL-SQINDS(3)
            MOVE 0 TO SQL-SQHARM(3)
            CALL "SQLADR" USING
                cTPP|A IN
                ی̑
                SQL-SQHSTV(4)
            MOVE 2 TO SQL-SQHSTL(4)
            MOVE 0 TO SQL-SQHSTS(4)
            MOVE 0 TO SQL-SQINDV(4)
            MOVE 0 TO SQL-SQINDS(4)
            MOVE 0 TO SQL-SQHARM(4)
            CALL "SQLADR" USING
                cTPP|A IN
                ی̑
                SQL-SQHSTV(5)
            MOVE 2 TO SQL-SQHSTL(5)
            MOVE 0 TO SQL-SQHSTS(5)
            MOVE 0 TO SQL-SQINDV(5)
            MOVE 0 TO SQL-SQINDS(5)
            MOVE 0 TO SQL-SQHARM(5)
            CALL "SQLADR" USING
                hjnOOQ|ă[X
                SQL-SQHSTV(6)
            MOVE 2 TO SQL-SQHSTL(6)
            MOVE 0 TO SQL-SQHSTS(6)
            MOVE 0 TO SQL-SQINDV(6)
            MOVE 0 TO SQL-SQINDS(6)
            MOVE 0 TO SQL-SQHARM(6)
            CALL "SQLADR" USING
                cTPP|R[h IN
                ی̑
                SQL-SQHSTV(7)
            MOVE 2 TO SQL-SQHSTL(7)
            MOVE 0 TO SQL-SQHSTS(7)
            MOVE 0 TO SQL-SQINDV(7)
            MOVE 0 TO SQL-SQINDS(7)
            MOVE 0 TO SQL-SQHARM(7)
            CALL "SQLADR" USING
                cTPP|於 IN
                ی̑
                SQL-SQHSTV(8)
            MOVE 40 TO SQL-SQHSTL(8)
            MOVE 0 TO SQL-SQHSTS(8)
            MOVE 0 TO SQL-SQINDV(8)
            MOVE 0 TO SQL-SQINDS(8)
            MOVE 0 TO SQL-SQHARM(8)
            CALL "SQLADR" USING
                cTPP|z IN
                ی̑
                SQL-SQHSTV(9)
            MOVE 7 TO SQL-SQHSTL(9)
            MOVE 0 TO SQL-SQHSTS(9)
            MOVE 0 TO SQL-SQINDV(9)
            MOVE 0 TO SQL-SQINDS(9)
            MOVE 0 TO SQL-SQHARM(9)
            CALL "SQLADR" USING
                cTPP|o^N IN
                ی̑
                SQL-SQHSTV(10)
            MOVE 8 TO SQL-SQHSTL(10)
            MOVE 0 TO SQL-SQHSTS(10)
            MOVE 0 TO SQL-SQINDV(10)
            MOVE 0 TO SQL-SQINDS(10)
            MOVE 0 TO SQL-SQHARM(10)
            CALL "SQLADR" USING
                cTPP|o^ IN
                ی̑
                SQL-SQHSTV(11)
            MOVE 8 TO SQL-SQHSTL(11)
            MOVE 0 TO SQL-SQHSTS(11)
            MOVE 0 TO SQL-SQINDV(11)
            MOVE 0 TO SQL-SQINDS(11)
            MOVE 0 TO SQL-SQHARM(11)
            CALL "SQLADR" USING
                cTPP|o^S IN
                ی̑
                SQL-SQHSTV(12)
            MOVE 8 TO SQL-SQHSTL(12)
            MOVE 0 TO SQL-SQHSTS(12)
            MOVE 0 TO SQL-SQINDV(12)
            MOVE 0 TO SQL-SQINDS(12)
            MOVE 0 TO SQL-SQHARM(12)
            CALL "SQLADR" USING
                cTPP|XVN IN
                ی̑
                SQL-SQHSTV(13)
            MOVE 8 TO SQL-SQHSTL(13)
            MOVE 0 TO SQL-SQHSTS(13)
            MOVE 0 TO SQL-SQINDV(13)
            MOVE 0 TO SQL-SQINDS(13)
            MOVE 0 TO SQL-SQHARM(13)
            CALL "SQLADR" USING
                cTPP|XV IN
                ی̑
                SQL-SQHSTV(14)
            MOVE 8 TO SQL-SQHSTL(14)
            MOVE 0 TO SQL-SQHSTS(14)
            MOVE 0 TO SQL-SQINDV(14)
            MOVE 0 TO SQL-SQINDS(14)
            MOVE 0 TO SQL-SQHARM(14)
            CALL "SQLADR" USING
                cTPP|XV IN
                ی̑
                SQL-SQHSTV(15)
            MOVE 8 TO SQL-SQHSTL(15)
            MOVE 0 TO SQL-SQHSTS(15)
            MOVE 0 TO SQL-SQINDV(15)
            MOVE 0 TO SQL-SQINDS(15)
            MOVE 0 TO SQL-SQHARM(15)
            CALL "SQLADR" USING
                cTPP|͒S҃R[h IN
                ی̑
                SQL-SQHSTV(16)
            MOVE 8 TO SQL-SQHSTL(16)
            MOVE 0 TO SQL-SQHSTS(16)
            MOVE 0 TO SQL-SQINDV(16)
            MOVE 0 TO SQL-SQINDS(16)
            MOVE 0 TO SQL-SQHARM(16)
            CALL "SQLADR" USING
                SQL-SQHSTV(1)
                SQL-SQPHSV
            CALL "SQLADR" USING
                SQL-SQHSTL(1)
                SQL-SQPHSL
            CALL "SQLADR" USING
                SQL-SQHSTS(1)
                SQL-SQPHSS
            CALL "SQLADR" USING
                SQL-SQINDV(1)
                SQL-SQPIND
            CALL "SQLADR" USING
                SQL-SQINDS(1)
                SQL-SQPINS
            CALL "SQLADR" USING
                SQL-SQHARM(1)
                SQL-SQPARM
            CALL "SQLADR" USING
                SQL-SQHARC(1)
                SQL-SQPARC

            CALL "SQLBEX" USING
                SQLCTX
                SQLEXD
                SQLFPN

            CALL "SQLGSS" USING
               SQLSTATE
                .
004010*                                                                 
004020*----------------------------------------------------------------*
004030*    ǉmF                                              *
004040*----------------------------------------------------------------*
004050     EVALUATE  SQLCODE                                            
004060        WHEN   萔|rpknj                                   
004070*--<       ǉ >                                             
004080           COMPUTE  v|ó|  =  v|ó|  +  1       
004090        WHEN   OTHER                                              
004100*--<       ǉG[ >                                       
004110           MOVE     -50               TO  v|G[R[h        
004120           PERFORM  G[菈                                
004130     END-EVALUATE.                                                
004140*                                                                 
004150 o͏|dwhs.                                              
004160     EXIT.                                                        
004170******************************************************************
004180*   ϊe[u                                             *
004190******************************************************************
004200 ϊe[u                     SECTION.                    
004210 ϊe[u|rs`qs.                                    
004220     
      *    EXEC SQL                                                     
004230*          SELECT  _                                       
004240*                 ,ă[X                                   
004250*            INTO  :hjnOOQ|_                        
004260*                 ,:hjnOOQ|ă[X         		
004270*            FROM  IKOTBL002                                      
004280*           WHERE  _mn = :ksqgij|_mn             
004290*             AND  ă[XR[h = :ksqgij|ă[XR[h 
004300*             AND  菈R[h =                         
004310*                                  :ksqgij|菈R[h  
004320*    END-EXEC.
           CALL "SQLADR" USING SQ0003 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 228 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               hjnOOQ|_
               SQL-SQHSTV(1)
           MOVE 3 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               hjnOOQ|ă[X
               SQL-SQHSTV(2)
           MOVE 2 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ksqgij|_mn
               SQL-SQHSTV(3)
           MOVE 9 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ksqgij|ă[XR[h
               SQL-SQHSTV(4)
           MOVE 1 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ksqgij|菈R[h
               SQL-SQHSTV(5)
           MOVE 2 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004330*----------------------------------------------------------------*
004340*   ϊe[umF                                       *
004350*----------------------------------------------------------------*
004360     EVALUATE  SQLCODE                                            
004370        WHEN   萔|rpknj                                   
004380*--<       擾 >                                             
004390           CONTINUE                                               
004400        WHEN   OTHER                                              
004410*--<       擾G[ >                                           
004420           MOVE     -40               TO  v|G[R[h        
004430           PERFORM  G[菈                                
004440     END-EVALUATE.                                                
004450 ϊe[u|dwhs.                                      
004460     EXIT.                                                        
004470******************************************************************
004480*    AԕҏW                                                *
004490******************************************************************
004500 AԕҏW                         SECTION.                    
004510 AԕҏW|rs`qs.                                        
004520        IF v|tO = "N"                                       
004530           MOVE "Y"                   TO v|tO               
004540	         MOVE  1                    TO  cTPP|A	        
004550	      ELSE                                                      
004560           IF  cTPP|_ԍ = nkc_ԍ                
004570           AND cTPP|_ = nkc_                
004580           AND cTPP|ԍ = nkcԍ                
004590              COMPUTE  cTPP|A  =  cTPP|A  + 1     
004600           ELSE                                                   
004610              MOVE  1                 TO  cTPP|A          
004620           END-IF				                        
004630        END-IF.                                                   
004640 AԕҏW|dwhs.                                          
004650     EXIT.                                                        
004660******************************************************************
004670*    ҏW                                                    *
004680******************************************************************
004690 ҏW                             SECTION.                    
004700 ҏW|rs`qs.                                            
004710     EVALUATE v|JE^                                        
004720       WHEN  1  MOVE  1               TO  cTPP|A      
004730                MOVE  ksqgij|R[hP                
004740                                      TO  cTPP|R[h  
004750                MOVE  ksqgij|於P                    
004760                                      TO  cTPP|於      
004770                MOVE  ksqgij|zP                      
004780                                      TO  cTPP|z        
004790       WHEN  2  MOVE  2               TO  cTPP|A      
004800                MOVE  ksqgij|R[hQ                
004810                                      TO  cTPP|R[h  
004820                MOVE  ksqgij|於Q                    
004830                                      TO  cTPP|於      
004840                MOVE  ksqgij|zQ                      
004850                                      TO  cTPP|z        
004860       WHEN  3  MOVE  3               TO  cTPP|A      
004870                MOVE  ksqgij|R[hR                
004880                                      TO  cTPP|R[h  
004890                MOVE  ksqgij|於R                    
004900                                      TO  cTPP|於      
004910                MOVE  ksqgij|zR                      
004920                                      TO  cTPP|z        
004930     END-EVALUATE.                                                
004940 ҏW|dwhs.                                              
004950     EXIT.                                                        
004960******************************************************************
004970*    JE^                                                *
004980******************************************************************
004990 JE^                         SECTION.                    
005000 JE^|rs`qs.                                        
005010*--<    NEW TO OLD>                                               
005020     MOVE  cTPP|_ԍ         TO  nkc_ԍ.         
005030     MOVE  cTPP|_         TO  nkc_.         
005040     MOVE  cTPP|ԍ         TO  nkcԍ.         
005050*--<    COUNT   COMPUTE >                                       
005060	   IF  v|JE^  NOT =  3                                   
005070        MOVE 1                        TO v|JE^             
005080     ELSE                                                         
005090	      COMPUTE  v|JE^ = v|JE^ + 1                  
005100	   END-IF.                                                      
005110 JE^|dwhs.                                          
005120     EXIT.                                                        
005130******************************************************************
005140*    I                                                    *
005150******************************************************************
005160 I                             SECTION.                    
005170 I|rs`qs.                                            
005180*                                                                 
005190     PERFORM  caN[Y.                                   
005200*                                                                 
005210     PERFORM  caR~bg.                                   
005220*                                                                 
005230     PERFORM  IbZ[Wo.                                 
005240*                                                                 
005250*--< vOI >                                         
005260     MOVE  萔|             TO  PROGRAM-STATUS.         
005270*                                                                 
005280 I|dwhs.                                              
005290     EXIT.                                                        
005300******************************************************************
005310*    IbZ[Wo                                          *
005320******************************************************************
005330 IbZ[Wo                   SECTION.                    
005340 IbZ[Wó|rs`qs.                                  
005350*                                                                 
005360*----------------------------------------------------------------*
005370*    bZ[Wo͏                                      *
005380*----------------------------------------------------------------*
005390     INITIALIZE                       IF-CHOCO001.                
005400     MOVE  "3"                        TO  P|Cxg.     
005410     MOVE  萔|vOhc       TO  P|\[Xhc.       
005420     MOVE  "0"                        TO  P|AR[h.       
005430     MOVE  "LTRHJK"                   TO  P|e[uhc. 
005440     MOVE  "COUNT"                    TO  P|.         
005450     MOVE  v|́|             TO  P|f[^e.       
005460     MOVE  "یǍ"                               
005470                                      TO  P|̑bZ[W. 
005480     CALL  CLOCO001                USING  IF-CHOCO001.            
005490*                                                                 
005500     INITIALIZE                       IF-CHOCO001.                
005510     MOVE  "3"                        TO  P|Cxg.     
005520     MOVE  萔|vOhc       TO  P|\[Xhc.       
005530     MOVE  "0"                        TO  P|AR[h.       
005540     MOVE  "D511HJS"                  TO  P|e[uhc. 
005550     MOVE  "COUNT"                    TO  P|.         
005560     MOVE  v|ó|             TO  P|f[^e.       
005570     MOVE  "ی̑o͌"     TO                          
005580                                      P|̑bZ[W.     
005590     CALL  CLOCO001                USING  IF-CHOCO001.            
005600*                                                                 
005610*----------------------------------------------------------------*
005620*    IbZ[Wo                                          *
005630*----------------------------------------------------------------*
005640     INITIALIZE                       IF-CHOCO001.                
005650     MOVE  "3"                        TO  P|Cxg.     
005660     MOVE  萔|vOhc       TO  P|\[Xhc.       
005670     MOVE  "0"                        TO  P|AR[h.       
005680     MOVE  "END"                      TO  P|.         
005690     MOVE  萔|vO         TO  P|̑bZ[W. 
005700     CALL  CLOCO001                USING  IF-CHOCO001.            
005710*                                                                 
005720 IbZ[Wó|dwhs.                                    
005730     EXIT.                                                        
005740******************************************************************
005750*    caN[Y                                                *
005760******************************************************************
005770 caN[Y                     SECTION.                    
005780 caN[Y|rs`qs.                                    
005790*                                                                 
005800*--< J[\ N[Y >                                          
005810     
      *    EXEC SQL                                                     
005820*       CLOSE  CUR1                                               
005830*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 263 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005840*                                                                 
005850 caN[Y|dwhs.                                      
005860     EXIT.                                                        
005870******************************************************************
005880*    caR~bg                                            *
005890******************************************************************
005900 caR~bg                     SECTION.                    
005910 caR~bg|rs`qs.                                    
005920*                                                                 
005930     
      *    EXEC  SQL                                                    
005940*       COMMIT  WORK  RELEASE                                     
005950*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 278 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005960*                                                                 
005970     INITIALIZE                       IF-CHOCO001.                
005980     MOVE  "3"                        TO  P|Cxg.     
005990     MOVE  萔|vOhc       TO  P|\[Xhc.       
006000     MOVE  "0"                        TO  P|AR[h.       
006010     MOVE  "COMMIT"                   TO  P|.         
006020     MOVE  "R~bg{"             TO  P|̑bZ[W. 
006030     CALL  CLOCO001                USING  IF-CHOCO001.            
006040*                                                                 
006050 caR~bg|dwhs.                                      
006060     EXIT.                                                        
006070******************************************************************
006080*    ca[obN                                        *
006090******************************************************************
006100 ca[obN                 SECTION.                    
006110 ca[obN|rs`qs.                                
006120*                                                                 
006130     
      *    EXEC  SQL                                                    
006140*       ROLLBACK WORK  RELEASE                                    
006150*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 293 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
006160*                                                                 
006170     INITIALIZE                       IF-CHOCO001.                
006180     MOVE  "3"                        TO  P|Cxg.     
006190     MOVE  萔|vOhc       TO  P|\[Xhc.       
006200     MOVE  "9"                        TO  P|AR[h.       
006210     MOVE  "ROLLBACK"                 TO  P|.         
006220     MOVE  "[obN{"         TO  P|̑bZ[W. 
006230     CALL  CLOCO001                USING  IF-CHOCO001.            
006240*                                                                 
006250 ca[obN|dwhs.                                  
006260     EXIT.                                                        
006270******************************************************************
006280*    G[                                                  *
006290******************************************************************
006300 G[菈                       SECTION.                    
006310 G[菈|rs`qs.                                      
006320*                                                                 
006330     MOVE  "Y"                        TO v|ُI|tO.    
006340     INITIALIZE                           IF-CHOCO001.            
006350*                                                                 
006360     EVALUATE  v|G[R[h                                   
006370        WHEN  -10                                                 
006380*--<       nq`bkdڑs >                                 
006390           MOVE  "1"                  TO  P|Cxg      
006400           MOVE  萔|vOhc TO  P|\[Xhc        
006410           MOVE  "9"                  TO  P|AR[h        
006420           MOVE  "CONNECT"            TO  P|          
006430           MOVE  SQLCODE              TO  P|f[^e        
006440           MOVE  SQLERRMC             TO  P|̑bZ[W  
006450           CALL  CLOCO001          USING  IF-CHOCO001             
006460*                                                                 
006470        WHEN  -20                                                 
006480*--<       e[uJ[\I[vs >                     
006490           MOVE  "1"                  TO  P|Cxg      
006500           MOVE  萔|vOhc TO  P|\[Xhc        
006510           MOVE  "9"                  TO  P|AR[h        
006520           MOVE  "LTRHJK"             TO  P|e[uhc  
006530           MOVE  "OPEN"               TO  P|          
006540           MOVE  SQLCODE              TO  P|f[^e        
006550           MOVE  SQLERRMC             TO  P|̑bZ[W  
006560           CALL  CLOCO001          USING  IF-CHOCO001             
006570*                                                                 
006580        WHEN  -30                                                 
006590*--<       e[uǍs >                                 
006600           MOVE  "1"                  TO  P|Cxg      
006610           MOVE  萔|vOhc TO  P|\[Xhc        
006620           MOVE  "9"                  TO  P|AR[h        
006630           MOVE  "LTRHJK"             TO  P|e[uhc  
006640           MOVE  "FETCH"              TO  P|          
006650           MOVE  SQLCODE              TO  P|f[^e        
006660           MOVE  SQLERRMC             TO  P|̑bZ[W  
006670           CALL  CLOCO001          USING  IF-CHOCO001             
006680        WHEN  -40                                                 
006690*--<       _ޓϊe[u̎擾 >                         
006700           MOVE  "1"                  TO   P|Cxg     
006710           MOVE  萔|vOhc TO  P|\[Xhc        
006720           MOVE  "9"                  TO  P|AR[h        
006730           MOVE  "LTRHJK"             TO  P|e[uhc  
006740           MOVE  "SELECT"             TO  P|          
006750           MOVE  SQLCODE              TO  P|f[^e        
006760           MOVE  SQLERRMC             TO  P|̑bZ[W  
006770           CALL  CLOCO001          USING  IF-CHOCO001             
006780        WHEN  -50                                                 
006790*--<       ی̑ǉs >                                 
006800           MOVE  "1"                  TO   P|Cxg     
006810           MOVE  萔|vOhc TO  P|\[Xhc        
006820           MOVE  "9"                  TO  P|AR[h        
006830           MOVE  "D511HJS"            TO  P|e[uhc  
006840           MOVE  "INSERT"             TO  P|          
006850           MOVE  SQLCODE              TO  P|f[^e        
006860           MOVE  SQLERRMC             TO  P|̑bZ[W  
006870           CALL  CLOCO001          USING  IF-CHOCO001             
006880*                                                                 
006890        WHEN  OTHER                                               
006900           MOVE  "N"                  TO v|ُI|tO     
006910     END-EVALUATE.                                                
006920*                                                                 
006930     IF v|ُI|tO  =  "Y"                              
006940        PERFORM  ca[obN                             
006950*                                                                 
006960        PERFORM  IbZ[Wo                               
006970*                                                                 
006980*--<    vOُĨ^[R[h >                      
006990        MOVE  萔|ُ          TO  PROGRAM-STATUS          
007000*                                                                 
007010        EXIT  PROGRAM                                             
007020     END-IF.                                                      
007030*                                                                 
007040 G[菈|dwhs.                                        
007050     EXIT.                                                        
007060******************************************************************
007070*                  END OF PROGRAM                                *
007080******************************************************************
