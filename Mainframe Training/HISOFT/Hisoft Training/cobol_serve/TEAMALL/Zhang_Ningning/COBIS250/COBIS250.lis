Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

t@C: Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCOI[v
     1  000010******************************************************************
     2  000020*         CP(A)                                     *
     3  000030*      1. vO  : Yރ}X^ڍs                 *
     4  000040*      2. vOID  : COBIS250                               *
     5  000050*      3. Tv      : ̌`ԁEgpړIEނ\ *
     6  000060*                         i@ϗpNƃNj               *
     7  000070*                                                                *
     8  000080*      4. 쐬        : JJ                                 *
     9  000090*      5. 쐬        : 2005.04.10                             *
    10  000100******************************************************************
    11  000110*                                                                 
    12  000120******************************************************************
    13  000130*    hcdmshehb`shnm  chuhrhnm              *
    14  000140******************************************************************
    15  000150 IDENTIFICATION                       DIVISION.                   
    16  000160*                                                                 
    17  000170 PROGRAM-ID.                          COBIS250.                   
    18  000180******************************************************************
    19  000190*    dmuhqnmldms        chuhrhnm              *
    20  000200******************************************************************
    21  000210 ENVIRONMENT                          DIVISION.                   
    22  000220******************************************************************
    23  000230*    hmots|ntsots      rdbshnm                *
    24  000240******************************************************************
    25  000250 INPUT-OUTPUT                         SECTION.                    
    26  000260 FILE-CONTROL.                                                    
    27  000270*                                                                 
    28  000280     SELECT         ̓t@C      ASSIGN    TO   U01          
    29  000290     FILE STATUS    IS     v|                               
    30  000300     ORGANIZATION   IS     LINE       SEQUENTIAL.                 
    31  000310*                                                                 
    32  000320******************************************************************
    33  000330*    c`s`                      chuhrhnm              *
    34  000340******************************************************************
    35  000350 DATA                                 DIVISION.                   
    36  000360******************************************************************
    37  000370*    ehkd                      rdbshnm                *
    38  000380******************************************************************
    39  000390 FILE                                 SECTION.                    
    40  000400*----------------------------------------------------------------*
    41  000410*    ̓t@C                                                *
    42  000420*----------------------------------------------------------------*
    43  000430 FD  ̓t@C                                                 
    44  000440     LABEL  RECORD    IS              STANDARD                    
    45  000450     BLOCK  CONTAINS  0               RECORDS.                    
    46  000460*                                                                 
    47  000470 01  ́|R[h.                                              
    48  000480     COPY   CPBIS122   REPLACING      ==()==  BY  ==́|==.     
    49  000490*                                                                 
    50  000500******************************************************************
    51  000510*  vnqjhmf|rsnq`fd  rdbshnm                *
    52  000520******************************************************************
    53  000530 WORKING-STORAGE                      SECTION.                    
    54  000540*----------------------------------------------------------------*
    55  000550*    zXgϐ`GA                                        *
    56  000560*----------------------------------------------------------------*
    57  000570     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
    58  000580*                                                                 
    59  000590*--< nq`bkdʕϐ >                                       
    60  000600     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
    61  000610*                                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    62  000620*--< R[h}X^(ϗpN) >                                     
t@C: Z:\COB97\COPYLIB_DB\SQLCOM.CBLI[v
     1  000010*--rpkʕϐ
     2  000030   01  SQLSTATE                      PIC  X(005).
     3  000040   01  DB-STRING                     PIC  X(020).
     4  000050   01  USERNAME                      PIC  X(010).
     5  000060   01  PASSWD                        PIC  X(010).
     6  000070*
t@C: Z:\COB97\COPYLIB_DB\SQLCOM.CBLN[Y
    63  000630     EXEC  SQL  INCLUDE  LTRCDM0010.CBL        END-EXEC.          
    64  000640*                                                                 
    65  000650*--< Yރ}X^>                                              
t@C: Z:\COB97\COPYLIB_DB\LTRCDM0010.CBLI[v
     1  000010************************************************
     2  000020* R[h}X^(ϗpN)(LTRCDM0010)
     3  000030************************************************
     4  000040 01  ksqbclOOPO|ʃR[h PIC  X(004).
     5  000050 01  ksqbclOOPO|YR[h PIC  X(007).
     6  000060 01  ksqbclOOPO|_~[OOP PIC  X(004).
     7  000070 01  ksqbclOOPO|KpNeqnl|IP 
     8                                               PIC S9(001) COMP-3.
     9  000080 01  ksqbclOOPO|KpNeqnl|NP 
    10                                               PIC  X(006).
    11  000090 01  ksqbclOOPO|ϗpNP PIC S9(002) COMP-3.
    12  000100 01  ksqbclOOPO|_~[P PIC  X(021).
    13  000110 01  ksqbclOOPO|KpNeqnl|IQ 
    14                                               PIC S9(001) COMP-3.
    15  000120 01  ksqbclOOPO|KpNeqnl|NQ 
    16                                               PIC  X(006).
    17  000130 01  ksqbclOOPO|ϗpNQ PIC S9(002) COMP-3.
    18  000140 01  ksqbclOOPO|_~[Q PIC  X(021).
    19  000150 01  ksqbclOOPO|KpNeqnl|IR 
    20                                               PIC S9(001) COMP-3.
    21  000160 01  ksqbclOOPO|KpNeqnl|NR 
    22                                               PIC  X(006).
    23  000170 01  ksqbclOOPO|ϗpNR PIC S9(002) COMP-3.
    24  000180 01  ksqbclOOPO|_~[R PIC  X(021).
    25  000190 01  ksqbclOOPO|KpNeqnl|IS 
    26                                               PIC S9(001) COMP-3.
    27  000200 01  ksqbclOOPO|KpNeqnl|NS 
    28                                               PIC  X(006).
    29  000210 01  ksqbclOOPO|ϗpNS PIC S9(002) COMP-3.
    30  000220 01  ksqbclOOPO|_~[S PIC  X(021).
    31  000230 01  ksqbclOOPO|KpNeqnl|IT 
    32                                               PIC S9(001) COMP-3.
    33  000240 01  ksqbclOOPO|KpNeqnl|NT 
    34                                               PIC  X(006).
    35  000250 01  ksqbclOOPO|ϗpNT PIC S9(002) COMP-3.
    36  000260 01  ksqbclOOPO|_~[T PIC  X(021).
    37  000270 01  ksqbclOOPO|ʏ PIC  X(035).
t@C: Z:\COB97\COPYLIB_DB\LTRCDM0010.CBLN[Y
    66  000660     EXEC  SQL  INCLUDE  D12SIB.CBL            END-EXEC.          
    67  000670*                                                                 
    68  000680*--< nq`bkd rpks (SQLCA) >                        
t@C: Z:\COB97\COPYLIB_DB\D12SIB.CBLI[v
     1        *****************************************************************
     2        *   Yރ}X^(D12SIB_TBL)
     3        *****************************************************************
     4         01  Yރ}X^.
     5             03  cPQ|Y      PIC  X(007).
     6             03  cPQ|KpN    PIC  X(008).
     7             03  cPQ|Y啪ޖ
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

     8                                       PIC  X(040).
     9             03  cPQ|Y      PIC  X(060).
    10             03  cPQ|ϗpN      PIC S9(002) PACKED-DECIMAL.
    11             03  cPQ|Ŗ@敪      PIC  X(001).
    12             03  cPQ|XV      PIC  X(016).
    13             03  cPQ|XV        PIC  X(008).
    14             03  cPQ|\pR[h
    15                                       PIC  X(001).
    16             03  cPQ|JpR[h
    17                                       PIC  X(001).
    18             03  cPQ|NvpR[h
    19                                       PIC  X(001).
    20             03  cPQ|͒S҃R[h
    21                                       PIC  X(008).
    22             03  cPQ|ỸJi  PIC  X(040).
    23             03  cPQ|Y      PIC  X(010).
    24             03  cPQ|ỸJi  PIC  X(012).
    25             03  cPQ|o^N    PIC  X(008).
    26             03  cPQ|o^      PIC  X(008).
    27             03  cPQ|o^S    PIC  X(008).
    28             03  cPQ|XVN    PIC  X(008).
    29             03  cPQ|XV      PIC  X(008).
t@C: Z:\COB97\COPYLIB_DB\D12SIB.CBLN[Y
    69  000690     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
    70  000700*                                                                 
    71  000710     EXEC  SQL  END      DECLARE      SECTION  END-EXEC.          
    72  000720*----------------------------------------------------------------*
    73  000730*   Ɨ̈`                                                 *
    74  000740*----------------------------------------------------------------*
    75  000750 01  vnqj|GA.                                            
    76  000760*                                                                 
    77  000770*--< G[R[h >                                               
    78  000780     03  v|G[R[h             PIC S9(04).                 
    79  000790*                                                                 
    80  000800*--< v|>                                                    
    81  000810     03  v|                     PIC  X(02).                 
    82  000820*                                                                 
    83  000830*--< GA >                                                 
    84  000840     03  GA.                                              
    85  000850         05  v|́|P         PIC  9(09).                 
    86  000860         05  v|́|Q         PIC  9(09).                 
    87  000870         05  v|ó|           PIC  9(09).                 
    88  000880*                                                                 
    89  000890*--< tOAA >                                               
    90  000900     03  tO|GA.                                          
    91  000910         05  v|I|tOP       PIC  X(01).                 
    92  000920         05  v|I|tOQ       PIC  X(01).                 
    93  000930         05  v|ُI|tO     PIC  X(01).                 
    94  000940*                                                                 
    95  000950*--< L[GA >                                                 
    96  000960     03  jdx|GA.                                          
    97  000970        05   v|L[P.                                          
    98  000980            07  v|YR[hP      PIC  X(07).                 
    99  000990            07  v|ʃR[hP      PIC  X(04).                 
   100  001000        05   v|L[Q.                                          
   101  001010            07  v|YR[hQ      PIC  X(07).                 
   102  001020            07  v|ʃR[hQ      PIC  X(04).                 
   103  001030*                                                                 
   104  001040*--< KpNϗpNGA >                                   
   105  001050     03  v|K  OCCURS  5.                                     
   106  001060        05   v|KpNeqnl.                              
   107  001070            07  v|KϐI           PIC  X(02).                
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   108  001080            07  v|KϔN         PIC  X(06).                
   109  001090        05   v|ϗpN              PIC  X(02).                
   110  001100        05   v|Il                PIC  9(01).                
   111  001110*                                                                 
   112  001120*--< ԃGA >                                                 
   113  001130     03  v|Yޖ̂ek`f     PIC  X(01).                 
   114  001140     03  v|KpN               PIC  X(08).                 
   115  001150     03  v|ϗpNl               PIC  X(02).                 
   116  001160     03  v|Y啪ޖ           PIC  X(40).                 
   117  001170     03  I                            PIC  9(01).                 
   118  001180*----------------------------------------------------------------*
   119  001190*   Ԓ`                                                 *
   120  001200*----------------------------------------------------------------*
   121  001210*--< ʏ >                                                   
   122  001220 01  v|ʏ.                                                
   123  001230     03  v|VXet.                                        
   124  001240         05  v|I                 PIC  X(02) VALUE  "20".     
   125  001250         05  v|N               PIC  X(06).                 
   126  001260     03  v|VXe             PIC  X(08).                 
   127  001270     03  v|XV                   PIC  X(08) VALUE "IKOPG   ".
   128  001280     03  v|S                   PIC  X(08) VALUE "IKOPG   ".
   129  001290     03  v|o^S               PIC  X(08) VALUE "IKOPG   ".
   130  001300*----------------------------------------------------------------*
   131  001310*    Tu[`                                              *
   132  001320*----------------------------------------------------------------*
   133  001330 01  CALL-AREA.                                                   
   134  001340*--< ʃOTu[` >                                       
   135  001350     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
   136  001360     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
   137  001370*----------------------------------------------------------------*
   138  001380*--< ʃOpp[^ >                                       
   139  001390 01  IF-CHOCO001.                                                 
   140  001400     COPY  CHOCO001  REPLACING  ==()==  BY  ==P|==.           
   141  001410*                                                                 
   142  001420*----------------------------------------------------------------*
   143  001430*    hmht@CǍTu[`pp^̈                *
   144  001440*----------------------------------------------------------------*
   145  001450 01  PARA-AREA.                                                   
   146  001460     COPY CPBCO001.                                               
   147  001470******************************************************************
   148  001480*    萔pf[^`GA                                      *
   149  001490******************************************************************
   150  001500 CONSTANT                             SECTION.                    
   151  001510 01  萔̈.                                                    
   152  001520     03  萔|vOhc         PIC  X(08) VALUE "COBIS250".
   153  001530     03  萔|vO           PIC  X(80)                  
   154  001540                                VALUE  "Yރ}X^ڍs".  
   155  001550     03  萔|rpknj             PIC  9(04)  VALUE  0000.    
   156  001560     03  萔|rpkdmc           PIC  9(04)  VALUE  0100.    
   157  001570     03  萔|               PIC  9(04)  VALUE  ZERO.    
   158  001580     03  萔|ُ               PIC  9(04)  VALUE  0009.    
   159  001590******************************************************************
   160  001600*    oqnbdctqd            chuhrhnm              *
   161  001610******************************************************************
   162  001620 PROCEDURE                            DIVISION.                   
   163  001630*                                                                 
   164  001640     PERFORM   .                                          
   165  001650*                                                                 
   166  001660     PERFORM   又    UNTIL    v|I|tOP = "Y"        
   167  001670*                           AND  (v|I|tOQ = "Y").       
   168  001680*                                                                 
   169  001690     PERFORM   I.                                          
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   170  001700*                                                                 
   171  001710     STOP RUN.                                                    
   172  001720*                                                                 
   173  001730******************************************************************
   174  001740*                                                        *
   175  001750******************************************************************
   176  001760                              SECTION.                    
   177  001770 |rs`qs.                                            
   178  001780*                                                                 
   179  001790*----------------------------------------------------------------*
   180  001800*    JnbZ[Wo                                          *
   181  001810*----------------------------------------------------------------*
   182  001820     INITIALIZE                       IF-CHOCO001.                
   183  001830     MOVE  "3"                        TO  P|Cxg.     
   184  001840     MOVE  萔|vOhc       TO  P|\[Xhc.       
   185  001850     MOVE  "0"                        TO  P|AR[h.       
   186  001860     MOVE  "START"                    TO  P|.         
   187  001870     MOVE  萔|vO         TO  P|̑bZ[W. 
   188  001880     CALL  CLOCO001                USING  IF-CHOCO001.            
   189  001890*                                                                 
   190  001900*----------------------------------------------------------------*
   191  001910*    Ɨ̈̏lݒ                                        *
   192  001920*----------------------------------------------------------------*
   193  001930     MOVE  SPACE                      TO  vnqj|GA.       
   194  001940     INITIALIZE                           vnqj|GA.       
   195  001950*                                                                 
   196  001960*--< bott擾 >                                           
   197  001970     ACCEPT  v|N               FROM  DATE.                 
   198  001980*                                                                 
   199  001990*--< bot擾 >                                           
   200  002000     ACCEPT  v|VXe         FROM  TIME.                 
   201  002010*                                                                 
   202  002020*--< nq`bkdڑ >                                           
   203  002030     PERFORM   nq`bkdڑ.                                  
   204  002040*                                                                 
   205  002050*--< t@CI[v >                                           
   206  002060     PERFORM  t@CI[v.                                   
   207  002070*                                                                 
   208  002080*--< ̃}X^(Y)t@CǍ(P) >                     
   209  002090     PERFORM  ̓t@CǍ.                                   
   210  002100*                                                                 
   211  002110*--< e[uJ[\` >                                       
   212  002120     PERFORM  e[uJ[\`.                               
   213  002130*                                                                 
   214  002140*--< e[uJ[\Ǎ(P) >                               
   215  002150     PERFORM  e[uJ[\Ǎ.                               
   216  002160*                                                                 
   217  002170 |dwhs.                                              
   218  002180     EXIT.                                                        
   219  002190******************************************************************
   220  002200*   又                                                       *
   221  002210******************************************************************
   222  002220 又                               SECTION.                    
   223  002230 又|rs`qs.                                              
   224  002240*                                                                 
   225  002250     EVALUATE  TRUE                                               
   226  002260*--<    ̃}X^(Y)t@Ĉ݂̏ꍇ >                    
   227  002270        WHEN  v|YR[hP         >   v|YR[hQ       
   228  002280           PERFORM  e[uJ[\Ǎ                          
   229  002290*                                                                 
   230  002300*--<    }b`Ȍꍇ >                                        
   231  002310        WHEN  v|YR[hP        =   v|YR[hQ        
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   232  002320*                                                                 
   233  002330           PERFORM   ҏWo͏                                 
   234  002340*                                                                 
   235  002350           PERFORM   ̓t@CǍ                             
   236  002360*                                                                 
   237  002370           PERFORM   e[uJ[\Ǎ                         
   238  002380*--<    R[h}X^(ϗpN)݂̂̏ꍇ >                        
   239  002390        WHEN   v|YR[hP       <   v|YR[hQ        
   240  002400           MOVE  ZERO                 TO  cPQ|KpN      
   241  002410*                                                                 
   242  002420           MOVE   -50                 TO  v|G[R[h        
   243  002430           PERFORM  G[                                    
   244  002440*                                                                 
   245  002450           PERFORM   ̓t@CǍ                             
   246  002460     END-EVALUATE.                                                
   247  002470*                                                                 
   248  002480 又|dwhs.                                                
   249  002490     EXIT.                                                        
   250  002500******************************************************************
   251  002510*    I                                                    *
   252  002520******************************************************************
   253  002530 I                             SECTION.                    
   254  002540 I|rs`qs.                                            
   255  002550*                                                                 
   256  002560     PERFORM  caN[Y.                                   
   257  002570*                                                                 
   258  002580     PERFORM  caR~bg.                                   
   259  002590*                                                                 
   260  002600     CLOSE  ̓t@C.                                         
   261  002610*                                                                 
   262  002620     PERFORM  IbZ[Wo͏.                             
   263  002630*                                                                 
   264  002640*--< vOI >                                         
   265  002650     MOVE  萔|             TO  PROGRAM-STATUS.         
   266  002660*                                                                 
   267  002670 I|dwhs.                                              
   268  002680     EXIT.                                                        
   269  002690******************************************************************
   270  002700*    nq`bkdڑ                                            *
   271  002710******************************************************************
   272  002720 nq`bkdڑ                     SECTION.                    
   273  002730 nq`bkdڑ|rs`qs.                                    
   274  002740*                                                                 
   275  002750*--< caڑp擾 >                                   
   276  002760     CALL  COBCO001                USING  PARA-AREA.              
   277  002770*                                                                 
   278  002780     MOVE  PARA-DBSTRING              TO  DB-STRING.              
   279  002790     MOVE  PARA-USERNAME              TO  USERNAME.               
   280  002800     MOVE  PARA-PASSWORD              TO  PASSWD.                 
   281  002810*                                                                 
   282  002820*----------------------------------------------------------------*
   283  002830*    Jnڑ                                                    *
   284  002840*----------------------------------------------------------------*
   285  002850     IF    DB-STRING  =  SPACE                                    
   286  002860        EXEC SQL                                                  
   287  002870           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   288  002880        END-EXEC                                                  
   289  002890     ELSE                                                         
   290  002900        EXEC SQL                                                  
   291  002910           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   292  002920             USING  :DB-STRING                                    
   293  002930        END-EXEC                                                  
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   294  002940     END-IF.                                                      
   295  002950*                                                                 
   296  002960*----------------------------------------------------------------*
   297  002970*    ڑmF                                                    *
   298  002980*----------------------------------------------------------------*
   299  002990     EVALUATE  SQLCODE                                            
   300  003000        WHEN   萔|rpknj                                   
   301  003010           CONTINUE                                               
   302  003020        WHEN   OTHER                                              
   303  003030*--<       ڑG[ >                                           
   304  003040           MOVE     -10               TO  v|G[R[h        
   305  003050           PERFORM  G[                                    
   306  003060     END-EVALUATE.                                                
   307  003070*                                                                 
   308  003080 nq`bkdڑ|dwhs.                                      
   309  003090     EXIT.                                                        
   310  003100******************************************************************
   311  003110*    t@CI[v                                            *
   312  003120******************************************************************
   313  003130 t@CI[v             SECTION.                            
   314  003140 t@CI[v|rs`qs.                                    
   315  003150*                                                                 
   316  003160     OPEN  INPUT   ̓t@C.                                  
   317  003170*                                                                 
   318  003180*----------------------------------------------------------------*
   319  003190*    v|Ԕ                                                *
   320  003200*----------------------------------------------------------------*
   321  003210     EVALUATE  v|                                           
   322  003220        WHEN  ZERO                                                
   323  003230           CONTINUE                                               
   324  003240        WHEN  OTHER                                               
   325  003250*--<       t@CI[vG[ >                               
   326  003260           MOVE     1                 TO  v|G[R[h        
   327  003270           PERFORM  G[                                    
   328  003280     END-EVALUATE.                                                
   329  003290*                                                                 
   330  003300 t@CI[v|dwhs.                                      
   331  003310     EXIT.                                                        
   332  003320******************************************************************
   333  003330*   ̃}X^(Y)t@CǍ                           *
   334  003340******************************************************************
   335  003350 ̓t@CǍ                     SECTION.                    
   336  003360 ̓t@CǍ|rs`qs.                                    
   337  003370     READ  ̓t@C                                           
   338  003380        AT  END                                                   
   339  003390            MOVE  "Y"  TO  v|I|tOP                     
   340  003400            GO  TO  ̓t@CǍ|dwhs                    
   341  003410     END-READ.                                                    
   342  003420*--< t@CǍԔ>                                        
   343  003430     EVALUATE v|                                            
   344  003440        WHEN ZERO                                                 
   345  003450*--<        >                                                 
   346  003460           MOVE  ́|YR[h     TO  v|YR[hP        
   347  003470           MOVE  ́|ʃR[h     TO  v|ʃR[hP        
   348  003480*--<       t@C͌Z>                                
   349  003490           COMPUTE  v|́|P =  v|́|P + 1      
   350  003500        WHEN OTHER                                                
   351  003510*--<       t@CǍG[>                                    
   352  003520           MOVE 2                     TO v|G[R[h         
   353  003530           PERFORM G[                                     
   354  003540     END-EVALUATE.                                                
   355  003550*                                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   356  003560*--<  擾菈 >                                              
   357  003570     IF  v|ʃR[hP = "0010"                                
   358  003580        CONTINUE                                                  
   359  003590     ELSE                                                         
   360  003600        PERFORM  ̓t@CǍ                                 
   361  003610     END-IF.                                                      
   362  003620 ̓t@CǍ|dwhs.                                      
   363  003630     EXIT.                                                        
   364  003640******************************************************************
   365  003650*    e[uJ[\`                                        *
   366  003660******************************************************************
   367  003670 e[uJ[\`                 SECTION.                    
   368  003680 e[uJ[\`|rs`qs.                                
   369  003690*                                                                 
   370  003700*----------------------------------------------------------------*
   371  003710*    J[\nodm                                        *
   372  003720*----------------------------------------------------------------*
   373  003730     EXEC SQL                                                     
   374  003740        DECLARE CUR1  CURSOR FOR                                  
   375  003750           SELECT  LTRCDM0010.YR[h                          
   376  003760                  ,LTRCDM0010.ʃR[h                          
   377  003770                  ,KpNeqnlQNP                   
   378  003780                  ,KpNeqnlQNQ                   
   379  003790                  ,LTRCDM0010.KpNeqnlQNR        
   380  003800                  ,LTRCDM0010.KpNeqnlQNS        
   381  003810                  ,LTRCDM0010.KpNeqnlQNT        
   382  003820                  ,LTRCDM0010.KpNeqnlQIP          
   383  003830                  ,LTRCDM0010.KpNeqnlQIQ          
   384  003840                  ,LTRCDM0010.KpNeqnlQIR          
   385  003850                  ,LTRCDM0010.KpNeqnlQIS          
   386  003860                  ,LTRCDM0010.KpNeqnlQIT          
   387  003870                  ,LTRCDM0010.ϗpNP                          
   388  003880                  ,LTRCDM0010.ϗpNQ                          
   389  003890                  ,LTRCDM0010.ϗpNR                          
   390  003900                  ,LTRCDM0010.ϗpNS                          
   391  003910                  ,LTRCDM0010.ϗpNT                          
   392  003920            FROM   LTRCDM0010                                     
   393  003930           WHERE   LTRCDM0010.ʃR[h = '0010'                 
   394  003940        ORDER BY   LTRCDM0010.YR[h                          
   395  003950      END-EXEC.                                                   
   396  003960*                                                                 
   397  003970*----------------------------------------------------------------*
   398  003980*    J[\nodm                                        *
   399  003990*----------------------------------------------------------------*
   400  004000     EXEC  SQL                                                    
   401  004010        OPEN  CUR1                                                
   402  004020     END-EXEC.                                                    
   403  004030*                                                                 
   404  004040*----------------------------------------------------------------*
   405  004050*    J[\nodmmF                                        *
   406  004060*----------------------------------------------------------------*
   407  004070*                                                                 
   408  004080     EVALUATE  SQLCODE                                            
   409  004090        WHEN  萔|rpknj                                    
   410  004100*--<        >                                                 
   411  004110           CONTINUE                                               
   412  004120        WHEN  OTHER                                               
   413  004130*--<       J[\nodmG[ >                               
   414  004140           MOVE -20                   TO  v|G[R[h        
   415  004150           PERFORM  G[                                    
   416  004160     END-EVALUATE.                                                
   417  004170 e[uJ[\`|dwhs.                                  
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   418  004180     EXIT.                                                        
   419  004190******************************************************************
   420  004200*    e[uJ[\Ǎ                                        *
   421  004210******************************************************************
   422  004220 e[uJ[\Ǎ                 SECTION.                    
   423  004230 e[uJ[\Ǎ|rs`qs.                                
   424  004240*                                                                 
   425  004250*--< e[uJ[\Ǎ >                                       
   426  004260     EXEC SQL                                                     
   427  004270         FETCH  CUR1                                              
   428  004280          INTO :ksqbclOOPO|YR[h                  
   429  004290              ,:ksqbclOOPO|ʃR[h                  
   430  004300              ,:ksqbclOOPO|KpNeqnl|NP
   431  004310              ,:ksqbclOOPO|KpNeqnl|NQ
   432  004320              ,:ksqbclOOPO|KpNeqnl|NR
   433  004330              ,:ksqbclOOPO|KpNeqnl|NS
   434  004340              ,:ksqbclOOPO|KpNeqnl|NT
   435  004350              ,:ksqbclOOPO|KpNeqnl|IP  
   436  004360              ,:ksqbclOOPO|KpNeqnl|IQ  
   437  004370              ,:ksqbclOOPO|KpNeqnl|IR  
   438  004380              ,:ksqbclOOPO|KpNeqnl|IS  
   439  004390              ,:ksqbclOOPO|KpNeqnl|IT  
   440  004400              ,:ksqbclOOPO|ϗpNP                  
   441  004410              ,:ksqbclOOPO|ϗpNQ                  
   442  004420              ,:ksqbclOOPO|ϗpNR                  
   443  004430              ,:ksqbclOOPO|ϗpNS                  
   444  004440              ,:ksqbclOOPO|ϗpNT                  
   445  004450      END-EXEC.                                                   
   446  004460*                                                                 
   447  004470*----------------------------------------------------------------*
   448  004480*    e[uJ[\ǍmF                                  *
   449  004490*----------------------------------------------------------------*
   450  004500     EVALUATE  SQLCODE                                            
   451  004510        WHEN  萔|rpknj                                    
   452  004520*--<        >                                                 
   453  004530           MOVE  ksqbclOOPO|YR[h                 
   454  004540                                      TO  v|YR[hQ        
   455  004550           MOVE  ksqbclOOPO|ʃR[h                 
   456  004560                                      TO  v|ʃR[hQ        
   457  004570*--<       ͌Z>                                        
   458  004580           COMPUTE  v|́|Q =  v|́|Q + 1      
   459  004590        WHEN   萔|rpkdmc                                 
   460  004600*--<       ǍI >                                             
   461  004610           MOVE  "Y"                  TO  v|I|tOQ      
   462  004620           MOVE  HIGH-VALUE           TO  v|YR[hQ        
   463  004630        WHEN  OTHER                                               
   464  004640*--<       J[\ǍG[ >                                   
   465  004650           MOVE -30                   TO  v|G[R[h        
   466  004660           PERFORM  G[                                    
   467  004670     END-EVALUATE.                                                
   468  004680 e[uJ[\Ǎ|dwhs.                                  
   469  004690     EXIT.                                                        
   470  004700******************************************************************
   471  004710*    ҏWo͏                                                *
   472  004720******************************************************************
   473  004730 ҏWo͏                         SECTION.                    
   474  004740 ҏWo͏|rs`qs.                                        
   475  004750*                                                                 
   476  004760     PERFORM  Yޖ̎擾.                               
   477  004770*                                                                 
   478  004780*--< v|KϔNAv|ϗpNڎ擾 >                       
   479  004790     MOVE  ksqbclOOPO|KpNeqnl|NP     
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   480  004800                                      TO  v|KϔN(1).      
   481  004810     MOVE  ksqbclOOPO|KpNeqnl|NQ     
   482  004820                                      TO  v|KϔN(2).      
   483  004830     MOVE  ksqbclOOPO|KpNeqnl|NR     
   484  004840                                      TO  v|KϔN(3).      
   485  004850     MOVE  ksqbclOOPO|KpNeqnl|NS     
   486  004860                                      TO  v|KϔN(4).      
   487  004870     MOVE  ksqbclOOPO|KpNeqnl|NT     
   488  004880                                      TO  v|KϔN(5).      
   489  004890     MOVE  ksqbclOOPO|KpNeqnl|IP       
   490  004900                                      TO  v|Il(1).          
   491  004910     MOVE  ksqbclOOPO|KpNeqnl|IQ       
   492  004920                                      TO  v|Il(2).          
   493  004930     MOVE  ksqbclOOPO|KpNeqnl|IR       
   494  004940                                      TO  v|Il(3).          
   495  004950     MOVE  ksqbclOOPO|KpNeqnl|IS       
   496  004960                                      TO  v|Il(4).          
   497  004970     MOVE  ksqbclOOPO|KpNeqnl|IT       
   498  004980                                      TO  v|Il(5).          
   499  004990     MOVE  ksqbclOOPO|ϗpNP                       
   500  005000                                      TO  v|ϗpN(1).        
   501  005010     MOVE  ksqbclOOPO|ϗpNQ                       
   502  005020                                      TO  v|ϗpN(2).        
   503  005030     MOVE  ksqbclOOPO|ϗpNR                       
   504  005040                                      TO  v|ϗpN(3).        
   505  005050     MOVE  ksqbclOOPO|ϗpNS                       
   506  005060                                      TO  v|ϗpN(4).        
   507  005070     MOVE  ksqbclOOPO|ϗpNT                       
   508  005080                                      TO  v|ϗpN(5).        
   509  005090*                                                                 
   510  005100*--<  >                                                 
   511  005110     MOVE  SPACE                 TO  Yރ}X^.              
   512  005120     INITIALIZE                      Yރ}X^.              
   513  005130*                                                                 
   514  005140     PERFORM  Yރ}X^ڕҏWo͏        VARYING       
   515  005150                                      I FROM 1 BY 1 UNTIL I > 5.  
   516  005160*                                                                 
   517  005170 ҏWo͏|dwhs.                                          
   518  005180     EXIT.                                                        
   519  005190******************************************************************
   520  005200*    Yރ}X^ڕҏWo͏                              *
   521  005210******************************************************************
   522  005220 Yރ}X^ڕҏWo͏       SECTION.                    
   523  005230 Yރ}X^ڕҏWo͏|rs`qs.                      
   524  005240*                                                                 
   525  005250*----------------------------------------------------------------*
   526  005260*    t                                                    *
   527  005270*----------------------------------------------------------------*
   528  005280     IF  v|KϔN(I)            =   ZERO                    
   529  005290        MOVE  ZERO                     TO                         
   530  005300                                         v|KpNeqnl(I)
   531  005310     ELSE                                                         
   532  005320        IF v|Il(I)              =   0                       
   533  005330           MOVE  "19"                 TO  v|KϐI(I)         
   534  005340        ELSE                                                      
   535  005350           MOVE  "20"                 TO  v|KϐI(I)         
   536  005360     END-IF.                                                      
   537  005370     MOVE  v|KpNeqnl(I)  TO  v|KpN.         
   538  005380*                                                                 
   539  005390     MOVE  v|ϗpN(I)            TO  v|ϗpNl.         
   540  005400*                                                                 
   541  005410*----------------------------------------------------------------*
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   542  005420*    Yރ}X^ڕҏW                                  *
   543  005430*----------------------------------------------------------------*
   544  005440*--< No.01 >                                                      
   545  005450     MOVE  ́|YR[h           TO  cPQ|Y.       
   546  005460*                                                                 
   547  005470*--< No.02 >                                                      
   548  005480     MOVE  v|KpN             TO  cPQ|KpN.     
   549  005490*                                                                 
   550  005500*--< No.03 >                                                      
   551  005510     MOVE  v|Y啪ޖ         TO  cPQ|Y啪ޖ. 
   552  005520*                                                                 
   553  005530*--< No.04 >                                                      
   554  005540     MOVE  ́|                 TO  cPQ|Y.       
   555  005550*                                                                 
   556  005560*--< No.05 >                                                      
   557  005570     MOVE   v|ϗpNl            TO   cPQ|ϗpN.      
   558  005580*                                                                 
   559  005590*--< No.06 >                                                      
   560  005600     MOVE  ZERO                       TO  cPQ|Ŗ@敪.       
   561  005610*                                                                 
   562  005620*--< No.07 >                                                      
   563  005630     MOVE  ZERO                       TO  cPQ|XV.       
   564  005640*                                                                 
   565  005650*--< No.08 >                                                      
   566  005660     MOVE  v|XV                 TO  cPQ|XV.         
   567  005670*                                                                 
   568  005680*--< No.09 >                                                      
   569  005690     MOVE  ZERO                       TO  cPQ|\pR[h.
   570  005700*                                                                 
   571  005710*--< No.10 >                                                      
   572  005720     MOVE  ZERO                       TO  cPQ|JpR[h.
   573  005730*                                                                 
   574  005740*--< No.11 >                                                      
   575  005750     MOVE  ZERO                       TO                          
   576  005760                                      cPQ|NvpR[h.
   577  005770*                                                                 
   578  005780*--< No.12 >                                                      
   579  005790     MOVE  v|S                 TO  cPQ|͒S҃R[h.
   580  005800*                                                                 
   581  005810*--< No.13 >                                                      
   582  005820     MOVE  ́|̃Ji             TO  cPQ|ỸJi.   
   583  005830*                                                                 
   584  005840*--< No.14 >                                                      
   585  005850     MOVE  ́|                 TO  cPQ|Y.       
   586  005860*                                                                 
   587  005870*--< No.15 >                                                      
   588  005880     MOVE  ́|̃Ji             TO  cPQ|ỸJi.   
   589  005890*                                                                 
   590  005900*--< No.16 >                                                      
   591  005910     MOVE  v|VXet           TO  cPQ|o^N.     
   592  005920*                                                                 
   593  005930*--< No.17 >                                                      
   594  005940     MOVE  v|VXe           TO  cPQ|o^.       
   595  005950*                                                                 
   596  005960*--< No.18 >                                                      
   597  005970     MOVE  v|o^S             TO  cPQ|o^S.     
   598  005980*                                                                 
   599  005990*--< No.19 >                                                      
   600  006000     MOVE  v|VXet           TO  cPQ|XVN.     
   601  006010*                                                                 
   602  006020*--< No.20 >                                                      
   603  006030     MOVE  v|VXe           TO  cPQ|XV.       
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   604  006040*----------------------------------------------------------------*
   605  006050*    Yރ}X^ڏo͏                                  *
   606  006060*----------------------------------------------------------------*
   607  006070*                                                                 
   608  006080     IF  cPQ|KpN  NOT =  ZERO                          
   609  006090        PERFORM  o͏                                         
   610  006100     END-IF.                                                      
   611  006110 Yރ}X^ڕҏWo͏|dwhs.                        
   612  006120     EXIT.                                                        
   613  006130******************************************************************
   614  006140*    No.03.Yޖ̎擾                                  *
   615  006150******************************************************************
   616  006160 Yޖ̎擾                 SECTION.                    
   617  006170 Yޖ̎擾|rs`qs.                                
   618  006180*                                                                 
   619  006190     MOVE ́|YR[h            TO v|Yޖ̂ek`f.
   620  006200     EVALUATE   v|Yޖ̂ek`f                          
   621  006210*                                                                 
   622  006220        WHEN  "0"                                                 
   623  006230           MOVE  "`Y"      TO  v|Y啪ޖ           
   624  006240*                                                                 
   625  006250        WHEN  "1"                                                 
   626  006260           MOVE  ""          TO  v|Y啪ޖ           
   627  006270*                                                                 
   628  006280        WHEN  "2"                                                 
   629  006290           MOVE  "tݔ"  TO  v|Y啪ޖ           
   630  006300*                                                                 
   631  006310        WHEN  "3"                                                 
   632  006320            MOVE  "\z"        TO  v|Y啪ޖ          
   633  006330*                                                                 
   634  006340        WHEN  "4"                                                 
   635  006350           MOVE  "D"          TO  v|Y啪ޖ           
   636  006360*                                                                 
   637  006370        WHEN  "5"                                                 
   638  006380           MOVE  "q@"        TO  v|Y啪ޖ           
   639  006390*                                                                 
   640  006400        WHEN  "6"                                                 
   641  006410           MOVE "ԗyщ^" TO  v|Y啪ޖ           
   642  006420*                                                                 
   643  006430        WHEN  "7"                                                 
   644  006440           MOVE  "H"          TO  v|Y啪ޖ           
   645  006450*                                                                 
   646  006460        WHEN  "8"                                                 
   647  006470           MOVE  "yєi"  TO  v|Y啪ޖ           
   648  006480*                                                                 
   649  006490        WHEN  OTHER                                               
   650  006500           MOVE  SPACE           TO  v|Y啪ޖ           
   651  006510     END-EVALUATE.                                                
   652  006520 Yޖ̎擾|dwhs.                                  
   653  006530     EXIT.                                                        
   654  006540******************************************************************
   655  006550*    o͏                                                    *
   656  006560******************************************************************
   657  006570 o͏               SECTION.                                  
   658  006580 o͏|rs`qs.                                            
   659  006590*                                                                 
   660  006600       EXEC  SQL                                                  
   661  006610        INSERT  INTO  D12SIB_TBL                                  
   662  006620           ( Y                                             
   663  006630            ,KpN                                           
   664  006640            ,Y啪ޖ                                       
   665  006650            ,Y                                             
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   666  006660            ,ϗpN                                             
   667  006670            ,Ŗ@敪                                             
   668  006680            ,XV                                             
   669  006690            ,XV                                               
   670  006700            ,\pR[h                                     
   671  006710            ,JpR[h                                     
   672  006720            ,NvpR[h                                 
   673  006730            ,͒S҃R[h                                     
   674  006740            ,ỸJi                                         
   675  006750            ,Y                                             
   676  006760            ,ỸJi                                         
   677  006770            ,o^N                                           
   678  006780            ,o^                                             
   679  006790            ,o^S                                           
   680  006800            ,XVN                                           
   681  006810            ,XV)                                            
   682  006820       VALUES                                                     
   683  006830           ( :cPQ|Y                                    
   684  006840            ,:cPQ|KpN                                  
   685  006850            ,:cPQ|Y啪ޖ                              
   686  006860            ,:cPQ|Y                                    
   687  006870            ,:cPQ|ϗpN                                    
   688  006880            ,:cPQ|Ŗ@敪                                    
   689  006890            ,:cPQ|XV                                    
   690  006900            ,:cPQ|XV                                      
   691  006910            ,:cPQ|\pR[h                            
   692  006920            ,:cPQ|JpR[h                            
   693  006930            ,:cPQ|NvpR[h                        
   694  006940            ,:cPQ|͒S҃R[h                            
   695  006950            ,:cPQ|ỸJi                                
   696  006960            ,:cPQ|Y                                    
   697  006970            ,:cPQ|ỸJi                                
   698  006980            ,:cPQ|o^N                                  
   699  006990            ,:cPQ|o^                                    
   700  007000            ,:cPQ|o^S                                  
   701  007010            ,:cPQ|XVN                                  
   702  007020            ,:cPQ|XV)                                   
   703  007030     END-EXEC.                                                    
   704  007040*                                                                 
   705  007050*----------------------------------------------------------------*
   706  007060*    ǉmF                                              *
   707  007070*----------------------------------------------------------------*
   708  007080     EVALUATE  SQLCODE                                            
   709  007090        WHEN   萔|rpknj                                   
   710  007100*--<       ǉ >                                             
   711  007110           COMPUTE  v|ó|  =  v|ó|  +  1       
   712  007120        WHEN   OTHER                                              
   713  007130*--<       ǉG[ >                                       
   714  007140           MOVE     -40               TO  v|G[R[h        
   715  007150           PERFORM  G[                                    
   716  007160     END-EVALUATE.                                                
   717  007170*                                                                 
   718  007180 o͏|dwhs.                                              
   719  007190     EXIT.                                                        
   720  007200******************************************************************
   721  007210*    caN[Y                                            *
   722  007220******************************************************************
   723  007230 caN[Y                     SECTION.                    
   724  007240 caN[Y|rs`qs.                                    
   725  007250*                                                                 
   726  007260*--< J[\̃N[Y >                                         
   727  007270     EXEC  SQL                                                    
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   728  007280        CLOSE  CUR1                                               
   729  007290     END-EXEC.                                                    
   730  007300*                                                                 
   731  007310 caN[Y|dwhs.                                      
   732  007320     EXIT.                                                        
   733  007330******************************************************************
   734  007340*    caR~bg                                            *
   735  007350******************************************************************
   736  007360 caR~bg                     SECTION.                    
   737  007370 caR~bg|rs`qs.                                    
   738  007380*                                                                 
   739  007390     EXEC  SQL                                                    
   740  007400        COMMIT  WORK  RELEASE                                     
   741  007410     END-EXEC.                                                    
   742  007420*                                                                 
   743  007430     INITIALIZE                       IF-CHOCO001.                
   744  007440     MOVE  "3"                        TO  P|Cxg.     
   745  007450     MOVE  萔|vOhc       TO  P|\[Xhc.       
   746  007460     MOVE  "0"                        TO  P|AR[h.       
   747  007470     MOVE  "COMMIT"                   TO  P|.         
   748  007480     MOVE  "R~bg{"             TO  P|̑bZ[W. 
   749  007490     CALL  CLOCO001                USING  IF-CHOCO001.            
   750  007500*                                                                 
   751  007510 caR~bg|dwhs.                                      
   752  007520     EXIT.                                                        
   753  007530******************************************************************
   754  007540*    ca[obN                                        *
   755  007550******************************************************************
   756  007560 ca[obN                 SECTION.                    
   757  007570 ca[obN|rs`qs.                                
   758  007580*                                                                 
   759  007590     EXEC  SQL                                                    
   760  007600        ROLLBACK WORK  RELEASE                                    
   761  007610     END-EXEC.                                                    
   762  007620*                                                                 
   763  007630     INITIALIZE                       IF-CHOCO001.                
   764  007640     MOVE  "1"                        TO  P|Cxg.     
   765  007650     MOVE  萔|vOhc       TO  P|\[Xhc.       
   766  007660     MOVE  "9"                        TO  P|AR[h.       
   767  007670     MOVE  "ROLLBACK"                 TO  P|.         
   768  007680     MOVE  "[obN{"         TO  P|̑bZ[W. 
   769  007690     CALL  CLOCO001                USING  IF-CHOCO001.            
   770  007700*                                                                 
   771  007710 ca[obN|dwhs.                                  
   772  007720     EXIT.                                                        
   773  007730******************************************************************
   774  007740*    IbZ[Wo͏                                      *
   775  007750******************************************************************
   776  007760 IbZ[Wo͏               SECTION.                    
   777  007770 IbZ[Wo͏|rs`qs.                              
   778  007780*                                                                 
   779  007790*----------------------------------------------------------------*
   780  007800*   ̃}X^(Y)Ǎ                                   *
   781  007810*----------------------------------------------------------------*
   782  007820     INITIALIZE                       IF-CHOCO001.                
   783  007830     MOVE  "3"                        TO  P|Cxg.     
   784  007840     MOVE  萔|vOhc       TO  P|\[Xhc.       
   785  007850     MOVE  "0"                        TO  P|AR[h.       
   786  007860     MOVE  "FFUIS250"                 TO  P|e[uhc. 
   787  007870     MOVE  "COUNT"                    TO  P|.         
   788  007880     MOVE  v|́|P           TO  P|f[^e.       
   789  007890     MOVE  "̃}X^(Y)Ǎ"                           
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   790  007900                                      TO  P|̑bZ[W. 
   791  007910     CALL  CLOCO001                USING  IF-CHOCO001.            
   792  007920*                                                                 
   793  007930*----------------------------------------------------------------*
   794  007940*    R[h}X^(ϗpN)Ǎ                              *
   795  007950*----------------------------------------------------------------*
   796  007960     INITIALIZE                       IF-CHOCO001.                
   797  007970     MOVE  "3"                        TO  P|Cxg.     
   798  007980     MOVE  萔|vOhc       TO  P|\[Xhc.       
   799  007990     MOVE  "0"                        TO  P|AR[h.       
   800  008000     MOVE  "LTRCDM"                   TO  P|e[uhc. 
   801  008010     MOVE  "COUNT"                    TO  P|.         
   802  008020     MOVE  v|́|Q           TO  P|f[^e.       
   803  008030     MOVE  "R[h}X^(ϗpN)Ǎ"                        
   804  008040                                      TO  P|̑bZ[W. 
   805  008050     CALL  CLOCO001                USING  IF-CHOCO001.            
   806  008060*                                                                 
   807  008070*----------------------------------------------------------------*
   808  008080*    Yޏo͌                                            *
   809  008090*----------------------------------------------------------------*
   810  008100     INITIALIZE                       IF-CHOCO001.                
   811  008110     MOVE  "3"                        TO  P|Cxg.     
   812  008120     MOVE  萔|vOhc       TO  P|\[Xhc.       
   813  008130     MOVE  "0"                        TO  P|AR[h.       
   814  008140     MOVE  "D12SIB"                   TO  P|e[uhc. 
   815  008150     MOVE  "COUNT"                    TO  P|.         
   816  008160     MOVE  v|ó|             TO  P|f[^e.       
   817  008170     MOVE  "Yޏo͌"         TO  P|̑bZ[W. 
   818  008180     CALL  CLOCO001                USING  IF-CHOCO001.            
   819  008190*                                                                 
   820  008200*----------------------------------------------------------------*
   821  008210*    IbZ[W o                                         *
   822  008220*----------------------------------------------------------------*
   823  008230     INITIALIZE                       IF-CHOCO001.                
   824  008240     MOVE  "3"                        TO  P|Cxg.     
   825  008250     MOVE  萔|vOhc       TO  P|\[Xhc.       
   826  008260     MOVE  "0"                        TO  P|AR[h.       
   827  008270     MOVE  "END"                      TO  P|.         
   828  008280     MOVE  萔|vO         TO  P|̑bZ[W. 
   829  008290     CALL  CLOCO001                USING  IF-CHOCO001.            
   830  008300*                                                                 
   831  008310 IbZ[Wo͏|dwhs.                                
   832  008320     EXIT.                                                        
   833  008330******************************************************************
   834  008340*    G[                                                  *
   835  008350******************************************************************
   836  008360 G[                           SECTION.                    
   837  008370 G[|rs`qs.                                          
   838  008380*                                                                 
   839  008390     MOVE  "Y"                        TO  v|ُI|tO.   
   840  008400     INITIALIZE                       IF-CHOCO001.                
   841  008410*                                                                 
   842  008420     EVALUATE  v|G[R[h                                   
   843  008430        WHEN  1                                                   
   844  008440*--<       t@CI[vG[ >                               
   845  008450           MOVE  "1"                  TO  P|Cxg      
   846  008460           MOVE  萔|vOhc TO  P|\[Xhc        
   847  008470           MOVE  "9"                  TO  P|AR[h        
   848  008480           MOVE  "FFUIS250"           TO  P|e[uhc  
   849  008490           MOVE  "OPEN"               TO  P|          
   850  008500           MOVE  v|             TO  P|f[^e        
   851  008510           MOVE  "̃}X^(Y)" TO  P|̑bZ[W  
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   852  008520           CALL  CLOCO001          USING  IF-CHOCO001             
   853  008530*                                                                 
   854  008540        WHEN  2                                                   
   855  008550*--<       t@Co̓G[ >                                   
   856  008560           MOVE  "1"                  TO  P|Cxg      
   857  008570           MOVE  萔|vOhc TO  P|\[Xhc        
   858  008580           MOVE  "9"                  TO  P|AR[h        
   859  008590           MOVE  "FFUIS250"           TO  P|e[uhc  
   860  008600           MOVE  "READ"               TO  P|          
   861  008610           MOVE  v|             TO  P|f[^e        
   862  008620           MOVE  "̃}X^(Y)" TO  P|̑bZ[W  
   863  008630           CALL  CLOCO001          USING  IF-CHOCO001             
   864  008640*                                                                 
   865  008650        WHEN  -10                                                 
   866  008660*--<       nq`bkdڑs >                                 
   867  008670           MOVE  "1"                  TO  P|Cxg      
   868  008680           MOVE  萔|vOhc TO  P|\[Xhc        
   869  008690           MOVE  "9"                  TO  P|AR[h        
   870  008700           MOVE  "CONNECT"            TO  P|          
   871  008710           MOVE  SQLCODE              TO  P|f[^e        
   872  008720           MOVE  SQLERRMC             TO  P|̑bZ[W  
   873  008730           CALL  CLOCO001          USING  IF-CHOCO001             
   874  008740*                                                                 
   875  008750        WHEN  -20                                                 
   876  008760*--<       e[uJ[\I[vs >                         
   877  008770           MOVE  "1"                  TO  P|Cxg      
   878  008780           MOVE  萔|vOhc TO  P|\[Xhc        
   879  008790           MOVE  "9"                  TO  P|AR[h        
   880  008800           MOVE  "LTRCDM"             TO  P|e[uhc  
   881  008810           MOVE  "OPEN"               TO  P|          
   882  008820           MOVE  SQLCODE              TO  P|f[^e        
   883  008830           MOVE  SQLERRMC             TO  P|̑bZ[W  
   884  008840           CALL  CLOCO001          USING  IF-CHOCO001             
   885  008850*                                                                 
   886  008860        WHEN  -30                                                 
   887  008870*--<       e[uJ[\I[vs >                         
   888  008880           MOVE  "1"                  TO  P|Cxg      
   889  008890           MOVE  萔|vOhc TO  P|\[Xhc        
   890  008900           MOVE  "9"                  TO  P|AR[h        
   891  008910           MOVE  "LTRCDM"             TO  P|e[uhc  
   892  008920           MOVE  "FETCH"              TO  P|          
   893  008930           MOVE  SQLCODE              TO  P|f[^e        
   894  008940           MOVE  SQLERRMC             TO  P|̑bZ[W  
   895  008950           CALL  CLOCO001          USING  IF-CHOCO001             
   896  008960*                                                                 
   897  008970        WHEN  -40                                                 
   898  008980*--<       Yރ}X^caǉs >                           
   899  008990           MOVE  "1"                  TO  P|Cxg      
   900  009000           MOVE  萔|vOhc TO  P|\[Xhc        
   901  009010           MOVE  "9"                  TO  P|AR[h        
   902  009020           MOVE  "D12SIB"             TO  P|e[uhc  
   903  009030           MOVE  "INSERT"             TO  P|          
   904  009040           MOVE  SQLCODE              TO  P|f[^e        
   905  009050           MOVE  SQLERRMC             TO  P|̑bZ[W  
   906  009060           CALL  CLOCO001          USING  IF-CHOCO001             
   907  009070*                                                                 
   908  009080        WHEN  -50                                                 
   909  009090*--<       ϗpN擾Ȃ >                            
   910  009100           MOVE  "2"                  TO  P|Cxg      
   911  009110           MOVE  萔|vOhc TO  P|\[Xhc        
   912  009120           MOVE  "9"                  TO  P|AR[h        
   913  009130           MOVE  "LTRCDM"             TO  P|e[uhc  
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   914  009140           MOVE  "SELECT"             TO  P|          
   915  009150           MOVE  "ϗpN擾Ȃ"                       
   916  009160                                      TO  P|̑bZ[W  
   917  009170           CALL  CLOCO001          USING  IF-CHOCO001             
   918  009180           MOVE  "N"                  TO v|ُI|tO     
   919  009190*                                                                 
   920  009200        WHEN  OTHER                                               
   921  009210           MOVE  "N"                  TO v|ُI|tO     
   922  009220     END-EVALUATE.                                                
   923  009230*                                                                 
   924  009240     IF v|ُI|tO  =  "Y"                              
   925  009250        PERFORM  ca[obN                             
   926  009260*                                                                 
   927  009270        PERFORM  IbZ[Wo͏                           
   928  009280*                                                                 
   929  009290*--<    vOُĨ^[R[h >                      
   930  009300        MOVE  萔|ُ          TO  PROGRAM-STATUS          
   931  009310*                                                                 
   932  009320        EXIT  PROGRAM                                             
   933  009330     END-IF.                                                      
   934  009340*                                                                 
   935  009350 G[|dwhs.                                            
   936  009360      EXIT.                                                       
   937  009370******************************************************************
   938  009380*                  END OF PROGRAM                                *
   939  009390******************************************************************
t@C: Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCON[Y
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


zXgϐ
--------------

01  DB-STRING                                           Charf(20)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      3
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    292

01  PASSWD                                              Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      5
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    287    291

01  SQLSTATE                                            Charf(5)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      2
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    286    290    400    426    660    727    739    759

01  USERNAME                                            Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      4
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    287    291

03  cPQ|JpR[h OF Yރ}X            Charf(1)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     16
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    692

03  cPQ|XV OF Yރ}X^                  Charf(8)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     29
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    702

03  cPQ|XV OF Yރ}X^                    Charf(8)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     13
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    690

03  cPQ|XV OF Yރ}X^                  Charf(16)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     12
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    689

03  cPQ|XVN OF Yރ}X^                Charf(8)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     28
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    701

03  cPQ|Y OF Yރ}X^                  Charf(7)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL      5
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    683

03  cPQ|Y啪ޖ OF Yރ}X^            Charf(40)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL      7
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    685

03  cPQ|Y OF Yރ}X^                  Charf(60)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL      9
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    686

03  cPQ|ỸJi OF Yރ}X^              Charf(40)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     22
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    695

03  cPQ|Y OF Yރ}X^                  Charf(10)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     23
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    696

03  cPQ|ỸJi OF Yރ}X^              Charf(12)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     24
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    697

03  cPQ|\pR[h OF Yރ}X            Charf(1)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     14
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    691

03  cPQ|Ŗ@敪 OF Yރ}X^                  Charf(1)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     11
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    688

03  cPQ|ϗpN OF Yރ}X^                  Decimal(2,0)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     10
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    687

03  cPQ|KpN OF Yރ}X^                Charf(8)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL      6
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    684

03  cPQ|o^ OF Yރ}X^                  Charf(8)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     26
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    699

03  cPQ|o^S OF Yރ}X^                Charf(8)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     27
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    700

03  cPQ|o^N OF Yރ}X^                Charf(8)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     25
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    698

03  cPQ|͒S҃R[h OF Yރ}X            Charf(8)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     20
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    694

03  cPQ|NvpR[h OF Y            Charf(1)
  Z:\COB97\COPYLIB_DB\D12SIB.CBL     18
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    693

01  ksqbclOOPO|YR[h                    Charf(7)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL      5
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    428

01  ksqbclOOPO|ʃR[h                    Charf(4)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL      4
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    429

01  ksqbclOOPO|ϗpNP                    Decimal(2,0)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     11
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    440

01  ksqbclOOPO|ϗpNQ                    Decimal(2,0)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     17
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    441

01  ksqbclOOPO|ϗpNR                    Decimal(2,0)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     23
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    442

01  ksqbclOOPO|ϗpNS                    Decimal(2,0)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     29
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    443

Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

01  ksqbclOOPO|ϗpNT                    Decimal(2,0)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     35
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    444

01  ksqbclOOPO|KpNeqnl            Decimal(1,0)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL      7
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    435

01  ksqbclOOPO|KpNeqnl            Decimal(1,0)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     13
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    436

01  ksqbclOOPO|KpNeqnl            Decimal(1,0)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     19
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    437

01  ksqbclOOPO|KpNeqnl            Decimal(1,0)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     25
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    438

01  ksqbclOOPO|KpNeqnl            Decimal(1,0)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     31
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    439

01  ksqbclOOPO|KpNeqnl            Charf(6)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL      9
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    430

01  ksqbclOOPO|KpNeqnl            Charf(6)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     15
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    431

01  ksqbclOOPO|KpNeqnl            Charf(6)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     21
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    432

01  ksqbclOOPO|KpNeqnl            Charf(6)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     27
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    433

01  ksqbclOOPO|KpNeqnl            Charf(6)
  Z:\COB97\COPYLIB_DB\LTRCDM0010.CBL     33
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    434

Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


SQLʎq
---------------

CUR1                  CURSOR                        
  Z:\TEAMALL\ZHANG_NINGNING\COBIS250\COBIS250.PCO    374    401    427    728    374

Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.



                              vRpCEIvV
-------------------------------------------------------------------------------
IvV   ݂̐ݒl         ݒ
-------------------------------------------------------------------------------
asacc             no                ftHg                                  
assume_sqlcode    no                ftHg                                  
auto_connect      no                ftHg                                  
close_on_commit   yes               mode                                        
comp5             yes               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
config            default config    ftHg                                  
date_format       local             ftHg                                  
dbms              native            ftHg                                  
declare_section   yes               mode                                        
define            *Ȃ*            ftHg                                  
dynamic           ansi              mode                                        
end_of_fetch      100               mode                                        
eol_padding       yes               ftHg                                  
errors            yes               ftHg                                  
fips              no                ftHg                                  
format            ansi              ftHg                                  
hold_cursor       no                ftHg                                  
host              cobol             ftHg                                  
iname             Z:\TEAMALL\ZHANG_NR}hC50\COBIS250.PCO               
include           Z:\COB97\COPYLIB  D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
                  Z:\COB97\COPYLIB_DD:\oracle\ora90\precomp\admin\pcbcfg.cfg    
                  *Ȃ*            D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
ireclen           132               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
litdelim          quote             ftHg                                  
lname             *Ȃ*            ftHg                                  
lreclen           132               ftHg                                  
ltype             long              ftHg                                  
maxliteral        160               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
maxopencursors    10                ftHg                                  
mode              ANSI              D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
nested            yes               ftHg                                  
nls_local         yes               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
oname             COBIS250.COB      R}hC                              
oraca             no                ftHg                                  
oreclen           80                ftHg                                  
pagelen           66                ftHg                                  
picx              charf             ftHg                                  
prefetch          1                 ftHg                                  
release_cursor    no                ftHg                                  
select_error      yes               ftHg                                  
sqlcheck          FULL              D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
threads           no                ftHg                                  
type_code         ansi              mode                                        
unsafe_null       no                ftHg                                  
userid            ZHANGNN/ZNN@FIP   D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
varchar           no                ftHg                                  
xref              yes               ftHg                                  
Pro*COBOL: Release 9.2.0.1.0 - Production on  Apr 8 12:52:01 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


v\
----------

^[ER[h: 0
dv Ił̃bZ[W: 0
dv Wł̃bZ[W: 0
dv Eł̃bZ[W: 0
dv Fł̃bZ[W: 0
̓C̐: 1011
錾ꂽzXgϐ̐: 49
J[\̐: 1
̐: 0
gpő僁[(oCg): 175676
