000010******************************************************************
000020*         ÅÉäCãPìÓåè(ëÂòA)ÅÑ                                     *
000030*      1. ÉvÉçÉOÉâÉÄñº  : éëéYéÌóﬁÉ}ÉXÉ^à⁄çsèàóù                 *
000040*      2. ÉvÉçÉOÉâÉÄID  : COBIS250                               *
000050*      3. èàóùäTóv      : ï®åèÇÃå`ë‘ÅEégópñ⁄ìIÅEéÌóﬁÇï\ÇµÇΩÇ‡ÇÃ *
000060*                         Åiñ@íËëœópîNêîÇ∆ÉäÉìÉNÅj               *
000070*                                                                *
000080*      4. çÏê¨é“        : í£îJîJ                                 *
000090*      5. çÏê¨ì˙        : 2005.04.10                             *
000100******************************************************************
000110*                                                                 
000120******************************************************************
000130*    ÇhÇcÇdÇmÇsÇhÇeÇhÇbÇ`ÇsÇhÇnÇm  ÇcÇhÇuÇhÇrÇhÇnÇm              *
000140******************************************************************
000150 IDENTIFICATION                       DIVISION.                   
000160*                                                                 
000170 PROGRAM-ID.                          COBIS250.                   
000180******************************************************************
000190*    ÇdÇmÇuÇhÇqÇnÇmÇlÇdÇmÇs        ÇcÇhÇuÇhÇrÇhÇnÇm              *
000200******************************************************************
000210 ENVIRONMENT                          DIVISION.                   
000220******************************************************************
000230*    ÇhÇmÇoÇtÇsÅ|ÇnÇtÇsÇoÇtÇs      ÇrÇdÇbÇsÇhÇnÇm                *
000240******************************************************************
000250 INPUT-OUTPUT                         SECTION.                    
000260 FILE-CONTROL.                                                    
000270*                                                                 
000280     SELECT         ì¸óÕÉtÉ@ÉCÉã      ASSIGN    TO   U01          
000290     FILE STATUS    IS     ÇvÅ|èÛë‘                               
000300     ORGANIZATION   IS     LINE       SEQUENTIAL.                 
000310*                                                                 
000320******************************************************************
000330*    ÇcÇ`ÇsÇ`                      ÇcÇhÇuÇhÇrÇhÇnÇm              *
000340******************************************************************
000350 DATA                                 DIVISION.                   
000360******************************************************************
000370*    ÇeÇhÇkÇd                      ÇrÇdÇbÇsÇhÇnÇm                *
000380******************************************************************
000390 FILE                                 SECTION.                    
000400*----------------------------------------------------------------*
000410*    ì¸óÕÉtÉ@ÉCÉã                                                *
000420*----------------------------------------------------------------*
000430 FD  ì¸óÕÉtÉ@ÉCÉã                                                 
000440     LABEL  RECORD    IS              STANDARD                    
000450     BLOCK  CONTAINS  0               RECORDS.                    
000460*                                                                 
000470 01  ì¸óÕÅ|ÉåÉRÅ[Éh.                                              
000480     COPY   CPBIS122   REPLACING      ==()==  BY  ==ì¸óÕÅ|==.     
000490*                                                                 
000500******************************************************************
000510*  ÇvÇnÇqÇjÇhÇmÇfÅ|ÇrÇsÇnÇqÇ`ÇfÇd  ÇrÇdÇbÇsÇhÇnÇm                *
000520******************************************************************
000530 WORKING-STORAGE                      SECTION.                    
000540*----------------------------------------------------------------*
000550*    ÉzÉXÉgïœêîíËã`ÉGÉäÉA                                        *
000560*----------------------------------------------------------------*
000570     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +47.
           02  SQLFPN-FILENAME PIC X(47) VALUE "Z:\TEAMALL\ZHANG_NINGNIN
      -    "G\COBIS250\COBIS250.PCO".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(160) VALUE "insert into D12SIB_TBL(éëéYéÌóﬁ,
      -     "ìKópîNåéì˙,éëéYëÂï™óﬁñºèÃ,éëéYñºèÃ,ëœópîNêî,ê≈ñ@ãÊï™,çXêVì˙
      -    "éû,çXêVé“,ê\çêópîªíËÉRÅ[Éh,äJé¶ópîªíËÉRÅ[Éh,îNéüìùåvópîªíËÉR
      -     "Å[Éh,ì¸óÕ".

           02  FILLER PIC X(160) VALUE "íSìñé“ÉRÅ[Éh,éëéYñºèÃÉJÉi,éëéYó™
      -    "èÃ,éëéYó™èÃÉJÉi,ìoò^îNåéì˙,ìoò^éûä‘,ìoò^íSìñé“,çXêVîNåéì˙,çX
      -    "êVéûä‘) values (:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b1
      -    "1,:b12,:".

           02  FILLER PIC X(39) VALUE "b13,:b14,:b15,:b16,:b17,:b18,:b19
      -    ",:b20)".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +309369382.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +20.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 20 TIMES.


       01  SQ0001 GLOBAL.
           02  FILLER PIC X(160) VALUE "select LTRCDM0010.éëéYÉRÅ[Éh  ,L
      -    "TRCDM0010.éØï ÉRÅ[Éh  ,ìKópîNåéì˙ÇeÇqÇnÇlÅQîNåéì˙ÇP  ,ìKópîN
      -    "åéì˙ÇeÇqÇnÇlÅQîNåéì˙ÇQ  ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQîNåé
      -    "ì˙ÇR  ,L".

           02  FILLER PIC X(160) VALUE "TRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQîN
      -    "åéì˙ÇS  ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQîNåéì˙ÇT  ,LTRCDM001
      -    "0.ìKópîNåéì˙ÇeÇqÇnÇlÅQê¢ãIÇP  ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇl
      -    "ÅQê¢ãIÇQ".

           02  FILLER PIC X(160) VALUE "  ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇl
      -    "ÅQê¢ãIÇR  ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQê¢ãIÇS  ,LTRCDM001
      -    "0.ìKópîNåéì˙ÇeÇqÇnÇlÅQê¢ãIÇT  ,LTRCDM0010.ëœópîNêîÇP  ,LTRCD
      -    "M0010.ëœ".

           02  FILLER PIC X(160) VALUE "ópîNêîÇQ  ,LTRCDM0010.ëœópîNêîÇR
      -    "  ,LTRCDM0010.ëœópîNêîÇS  ,LTRCDM0010.ëœópîNêîÇT   from LTRC
      -    "DM0010 where LTRCDM0010.éØï ÉRÅ[Éh='0010' order by LTRCDM001
      -    "0.éëéYÉR".

           02  FILLER PIC X(15) VALUE "Å[Éh           ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +286.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +290.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +655.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +400.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +82.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +426.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +17.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +165.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +359.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +660.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +20.
           02     FILLER PIC S9(4) COMP-5 VALUE +20.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +260.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +727.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +275.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +12.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +739.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +290.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +14.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +32.
           02     FILLER PIC S9(4) COMP-5 VALUE +759.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000580*                                                                 
000590*--< ÇnÇqÇ`ÇbÇkÇdã§í ïœêî >                                       
000600     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
000610*                                                                 
000620*--< ÉRÅ[ÉhÉ}ÉXÉ^(ëœópîNêî) >                                     
000010*--ÅÉÇrÇpÇkã§í ïœêîÅÑ
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000630     
      *    EXEC  SQL  INCLUDE  LTRCDM0010.CBL        END-EXEC.
000640*                                                                 
000650*--< éëéYéÌóﬁÉ}ÉXÉ^>                                              
000010************************************************
000020* ÉRÅ[ÉhÉ}ÉXÉ^(ëœópîNêî)(LTRCDM0010)
000030************************************************
000040 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|éØï ÉRÅ[Éh PIC  X(004).
000050 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|éëéYÉRÅ[Éh PIC  X(007).
000060 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|É_É~Å[ÇOÇOÇP PIC  X(004).
000070 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇP 
                                             PIC S9(001) COMP-3.
000080 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇP 
                                             PIC  X(006).
000090 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇP PIC S9(002) COMP-3.
000100 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|É_É~Å[ÇP PIC  X(021).
000110 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇQ 
                                             PIC S9(001) COMP-3.
000120 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇQ 
                                             PIC  X(006).
000130 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇQ PIC S9(002) COMP-3.
000140 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|É_É~Å[ÇQ PIC  X(021).
000150 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇR 
                                             PIC S9(001) COMP-3.
000160 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇR 
                                             PIC  X(006).
000170 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇR PIC S9(002) COMP-3.
000180 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|É_É~Å[ÇR PIC  X(021).
000190 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇS 
                                             PIC S9(001) COMP-3.
000200 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇS 
                                             PIC  X(006).
000210 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇS PIC S9(002) COMP-3.
000220 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|É_É~Å[ÇS PIC  X(021).
000230 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇT 
                                             PIC S9(001) COMP-3.
000240 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇT 
                                             PIC  X(006).
000250 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇT PIC S9(002) COMP-3.
000260 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|É_É~Å[ÇT PIC  X(021).
000270 01  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ã§í èÓïÒ PIC  X(035).
000660     
      *    EXEC  SQL  INCLUDE  D12SIB.CBL            END-EXEC.
000670*                                                                 
000680*--< ÇnÇqÇ`ÇbÇkÇd ÇrÇpÇké¿çsèÓïÒ (SQLCA) >                        
      *****************************************************************
      *   éëéYéÌóﬁÉ}ÉXÉ^(D12SIB_TBL)
      *****************************************************************
       01  éëéYéÌóﬁÉ}ÉXÉ^.
           03  ÇcÇPÇQÅ|éëéYéÌóﬁ      PIC  X(007).
           03  ÇcÇPÇQÅ|ìKópîNåéì˙    PIC  X(008).
           03  ÇcÇPÇQÅ|éëéYëÂï™óﬁñºèÃ
                                     PIC  X(040).
           03  ÇcÇPÇQÅ|éëéYñºèÃ      PIC  X(060).
           03  ÇcÇPÇQÅ|ëœópîNêî      PIC S9(002) PACKED-DECIMAL.
           03  ÇcÇPÇQÅ|ê≈ñ@ãÊï™      PIC  X(001).
           03  ÇcÇPÇQÅ|çXêVì˙éû      PIC  X(016).
           03  ÇcÇPÇQÅ|çXêVé“        PIC  X(008).
           03  ÇcÇPÇQÅ|ê\çêópîªíËÉRÅ[Éh
                                     PIC  X(001).
           03  ÇcÇPÇQÅ|äJé¶ópîªíËÉRÅ[Éh
                                     PIC  X(001).
           03  ÇcÇPÇQÅ|îNéüìùåvópîªíËÉRÅ[Éh
                                     PIC  X(001).
           03  ÇcÇPÇQÅ|ì¸óÕíSìñé“ÉRÅ[Éh
                                     PIC  X(008).
           03  ÇcÇPÇQÅ|éëéYñºèÃÉJÉi  PIC  X(040).
           03  ÇcÇPÇQÅ|éëéYó™èÃ      PIC  X(010).
           03  ÇcÇPÇQÅ|éëéYó™èÃÉJÉi  PIC  X(012).
           03  ÇcÇPÇQÅ|ìoò^îNåéì˙    PIC  X(008).
           03  ÇcÇPÇQÅ|ìoò^éûä‘      PIC  X(008).
           03  ÇcÇPÇQÅ|ìoò^íSìñé“    PIC  X(008).
           03  ÇcÇPÇQÅ|çXêVîNåéì˙    PIC  X(008).
           03  ÇcÇPÇQÅ|çXêVéûä‘      PIC  X(008).
000690     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000700*                                                                 
000710     
      *    EXEC  SQL  END      DECLARE      SECTION  END-EXEC.
000720*----------------------------------------------------------------*
000730*   çÏã∆óÃàÊíËã`                                                 *
000740*----------------------------------------------------------------*
000750 01  ÇvÇnÇqÇjÅ|ÉGÉäÉA.                                            
000760*                                                                 
000770*--< ÉGÉâÅ[ÉRÅ[Éh >                                               
000780     03  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             PIC S9(04).                 
000790*                                                                 
000800*--< ÇvÅ|èÛë‘>                                                    
000810     03  ÇvÅ|èÛë‘                     PIC  X(02).                 
000820*                                                                 
000830*--< åèêîÉGÉäÉA >                                                 
000840     03  åèêîÉGÉäÉA.                                              
000850         05  ÇvÅ|ì¸óÕÅ|åèêîÇP         PIC  9(09).                 
000860         05  ÇvÅ|ì¸óÕÅ|åèêîÇQ         PIC  9(09).                 
000870         05  ÇvÅ|èoóÕÅ|åèêî           PIC  9(09).                 
000880*                                                                 
000890*--< ÉtÉâÉOÉAÉäÉA >                                               
000900     03  ÉtÉâÉOÅ|ÉGÉäÉA.                                          
000910         05  ÇvÅ|èIóπÅ|ÉtÉâÉOÇP       PIC  X(01).                 
000920         05  ÇvÅ|èIóπÅ|ÉtÉâÉOÇQ       PIC  X(01).                 
000930         05  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     PIC  X(01).                 
000940*                                                                 
000950*--< ÉLÅ[ÉGÉäÉA >                                                 
000960     03  ÇjÇdÇxÅ|ÉGÉäÉA.                                          
000970        05   ÇvÅ|ÉLÅ[ÇP.                                          
000980            07  ÇvÅ|éëéYÉRÅ[ÉhÇP      PIC  X(07).                 
000990            07  ÇvÅ|éØï ÉRÅ[ÉhÇP      PIC  X(04).                 
001000        05   ÇvÅ|ÉLÅ[ÇQ.                                          
001010            07  ÇvÅ|éëéYÉRÅ[ÉhÇQ      PIC  X(07).                 
001020            07  ÇvÅ|éØï ÉRÅ[ÉhÇQ      PIC  X(04).                 
001030*                                                                 
001040*--< ìKópîNåéì˙ëœópîNêîÉGÉäÉA >                                   
001050     03  ÇvÅ|ìKëœ  OCCURS  5.                                     
001060        05   ÇvÅ|ìKópîNåéì˙ÇeÇqÇnÇl.                              
001070            07  ÇvÅ|ìKëœê¢ãI           PIC  X(02).                
001080            07  ÇvÅ|ìKëœîNåéì˙         PIC  X(06).                
001090        05   ÇvÅ|ëœópîNêî              PIC  X(02).                
001100        05   ÇvÅ|ê¢ãIÇl                PIC  9(01).                
001110*                                                                 
001120*--< íÜä‘ÉGÉäÉA >                                                 
001130     03  ÇvÅ|éëéYï™óﬁñºèÃÇeÇkÇ`Çf     PIC  X(01).                 
001140     03  ÇvÅ|ìKópîNåéì˙               PIC  X(08).                 
001150     03  ÇvÅ|ëœópîNêîÇl               PIC  X(02).                 
001160     03  ÇvÅ|éëéYëÂï™óﬁñºèÃ           PIC  X(40).                 
001170     03  I                            PIC  9(01).                 
001180*----------------------------------------------------------------*
001190*   èàóùéûä‘íËã`                                                 *
001200*----------------------------------------------------------------*
001210*--< ã§í èÓïÒ >                                                   
001220 01  ÇvÅ|ã§í èÓïÒ.                                                
001230     03  ÇvÅ|ÉVÉXÉeÉÄì˙ït.                                        
001240         05  ÇvÅ|ê¢ãI                 PIC  X(02) VALUE  "20".     
001250         05  ÇvÅ|îNåéì˙               PIC  X(06).                 
001260     03  ÇvÅ|ÉVÉXÉeÉÄéûçè             PIC  X(08).                 
001270     03  ÇvÅ|çXêVé“                   PIC  X(08) VALUE "IKOPG   ".
001280     03  ÇvÅ|íSìñé“                   PIC  X(08) VALUE "IKOPG   ".
001290     03  ÇvÅ|ìoò^íSìñé“               PIC  X(08) VALUE "IKOPG   ".
001300*----------------------------------------------------------------*
001310*    ÉTÉuÉãÅ[É`Éìñº                                              *
001320*----------------------------------------------------------------*
001330 01  CALL-AREA.                                                   
001340*--< ã§í ÉçÉOÉTÉuÉãÅ[É`Éì >                                       
001350     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001360     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001370*----------------------------------------------------------------*
001380*--< ã§í ÉçÉOópÉpÉâÉÅÅ[É^ >                                       
001390 01  IF-CHOCO001.                                                 
001400     COPY  CHOCO001  REPLACING  ==()==  BY  ==ã§ÇPÅ|==.           
001410*                                                                 
001420*----------------------------------------------------------------*
001430*    ÇhÇmÇhÉtÉ@ÉCÉãì«çûÉTÉuÉãÅ[É`ÉìópÉpÉâÉÅÉ^óÃàÊ                *
001440*----------------------------------------------------------------*
001450 01  PARA-AREA.                                                   
001460     COPY CPBCO001.                                               
001470******************************************************************
001480*    íËêîópÉfÅ[É^íËã`ÉGÉäÉA                                      *
001490******************************************************************
001500 CONSTANT                             SECTION.                    
001510 01  íËêîóÃàÊ.                                                    
001520     03  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc         PIC  X(08) VALUE "COBIS250".
001530     03  íËêîÅ|ÉvÉçÉOÉâÉÄñº           PIC  X(80)                  
001540                                VALUE  "éëéYéÌóﬁÉ}ÉXÉ^à⁄çsèàóù".  
001550     03  íËêîÅ|ÇrÇpÇkÇnÇj             PIC  9(04)  VALUE  0000.    
001560     03  íËêîÅ|ÇrÇpÇkÇdÇmÇc           PIC  9(04)  VALUE  0100.    
001570     03  íËêîÅ|ê≥èÌèÛë‘               PIC  9(04)  VALUE  ZERO.    
001580     03  íËêîÅ|àŸèÌèÛë‘               PIC  9(04)  VALUE  0009.    
001590******************************************************************
001600*    ÇoÇqÇnÇbÇdÇcÇtÇqÇd            ÇcÇhÇuÇhÇrÇhÇnÇm              *
001610******************************************************************
001620 PROCEDURE                            DIVISION.                   
001630*                                                                 
001640     PERFORM   èâä˙èàóù.                                          
001650*                                                                 
001660     PERFORM   éÂèàóù    UNTIL    ÇvÅ|èIóπÅ|ÉtÉâÉOÇP = "Y"        
001670*                           AND  (ÇvÅ|èIóπÅ|ÉtÉâÉOÇQ = "Y").       
001680*                                                                 
001690     PERFORM   èIóπèàóù.                                          
001700*                                                                 
001710     STOP RUN.                                                    
001720*                                                                 
001730******************************************************************
001740*    èâä˙èàóù                                                    *
001750******************************************************************
001760 èâä˙èàóù                             SECTION.                    
001770 èâä˙èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
001780*                                                                 
001790*----------------------------------------------------------------*
001800*    äJénÉÅÉbÉZÅ[ÉWèoóÕ                                          *
001810*----------------------------------------------------------------*
001820     INITIALIZE                       IF-CHOCO001.                
001830     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
001840     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
001850     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
001860     MOVE  "START"                    TO  ã§ÇPÅ|èàóùéØï .         
001870     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
001880     CALL  CLOCO001                USING  IF-CHOCO001.            
001890*                                                                 
001900*----------------------------------------------------------------*
001910*    çÏã∆óÃàÊÇÃèâä˙ílê›íË                                        *
001920*----------------------------------------------------------------*
001930     MOVE  SPACE                      TO  ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001940     INITIALIZE                           ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001950*                                                                 
001960*--< ÇbÇoÇtì˙ïtÇéÊìæ >                                           
001970     ACCEPT  ÇvÅ|îNåéì˙               FROM  DATE.                 
001980*                                                                 
001990*--< ÇbÇoÇtéûçèÇéÊìæ >                                           
002000     ACCEPT  ÇvÅ|ÉVÉXÉeÉÄéûçè         FROM  TIME.                 
002010*                                                                 
002020*--< ÇnÇqÇ`ÇbÇkÇdê⁄ë± >                                           
002030     PERFORM   ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                                  
002040*                                                                 
002050*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉì >                                           
002060     PERFORM  ÉtÉ@ÉCÉãÉIÅ[ÉvÉì.                                   
002070*                                                                 
002080*--< ñºèÃÉ}ÉXÉ^(éëéYñº)ÉtÉ@ÉCÉãì«çû(ÇPåèñ⁄) >                     
002090     PERFORM  ì¸óÕÉtÉ@ÉCÉãì«çû.                                   
002100*                                                                 
002110*--< ÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã` >                                       
002120     PERFORM  ÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`.                               
002130*                                                                 
002140*--< ÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû(ÇPåèñ⁄) >                               
002150     PERFORM  ÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                               
002160*                                                                 
002170 èâä˙èàóùÅ|ÇdÇwÇhÇs.                                              
002180     EXIT.                                                        
002190******************************************************************
002200*   éÂèàóù                                                       *
002210******************************************************************
002220 éÂèàóù                               SECTION.                    
002230 éÂèàóùÅ|ÇrÇsÇ`ÇqÇs.                                              
002240*                                                                 
002250     EVALUATE  TRUE                                               
002260*--<    ñºèÃÉ}ÉXÉ^(éëéYñº)ÉtÉ@ÉCÉãÇÃÇ›ÇÃèÍçá >                    
002270        WHEN  ÇvÅ|éëéYÉRÅ[ÉhÇP         >   ÇvÅ|éëéYÉRÅ[ÉhÇQ       
002280           PERFORM  ÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                          
002290*                                                                 
002300*--<    É}ÉbÉ`ÉìÉOÇÃèÍçá >                                        
002310        WHEN  ÇvÅ|éëéYÉRÅ[ÉhÇP        =   ÇvÅ|éëéYÉRÅ[ÉhÇQ        
002320*                                                                 
002330           PERFORM   ï“èWèoóÕèàóù                                 
002340*                                                                 
002350           PERFORM   ì¸óÕÉtÉ@ÉCÉãì«çû                             
002360*                                                                 
002370           PERFORM   ÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                         
002380*--<    ÉRÅ[ÉhÉ}ÉXÉ^(ëœópîNêî)ÇÃÇ›ÇÃèÍçá >                        
002390        WHEN   ÇvÅ|éëéYÉRÅ[ÉhÇP       <   ÇvÅ|éëéYÉRÅ[ÉhÇQ        
002400           MOVE  ZERO                 TO  ÇcÇPÇQÅ|ìKópîNåéì˙      
002410*                                                                 
002420           MOVE   -50                 TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002430           PERFORM  ÉGÉâÅ[èàóù                                    
002440*                                                                 
002450           PERFORM   ì¸óÕÉtÉ@ÉCÉãì«çû                             
002460     END-EVALUATE.                                                
002470*                                                                 
002480 éÂèàóùÅ|ÇdÇwÇhÇs.                                                
002490     EXIT.                                                        
002500******************************************************************
002510*    èIóπèàóù                                                    *
002520******************************************************************
002530 èIóπèàóù                             SECTION.                    
002540 èIóπèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
002550*                                                                 
002560     PERFORM  ÇcÇaÉNÉçÅ[ÉYèàóù.                                   
002570*                                                                 
002580     PERFORM  ÇcÇaÉRÉ~ÉbÉgèàóù.                                   
002590*                                                                 
002600     CLOSE  ì¸óÕÉtÉ@ÉCÉã.                                         
002610*                                                                 
002620     PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕèàóù.                             
002630*                                                                 
002640*--< ÉvÉçÉOÉâÉÄê≥èÌèIóπ >                                         
002650     MOVE  íËêîÅ|ê≥èÌèÛë‘             TO  PROGRAM-STATUS.         
002660*                                                                 
002670 èIóπèàóùÅ|ÇdÇwÇhÇs.                                              
002680     EXIT.                                                        
002690******************************************************************
002700*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
002710******************************************************************
002720 ÇnÇqÇ`ÇbÇkÇdê⁄ë±                     SECTION.                    
002730 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇrÇsÇ`ÇqÇs.                                    
002740*                                                                 
002750*--< ÇcÇaê⁄ë±ópèÓïÒÇéÊìæèàóù >                                   
002760     CALL  COBCO001                USING  PARA-AREA.              
002770*                                                                 
002780     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002790     MOVE  PARA-USERNAME              TO  USERNAME.               
002800     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002810*                                                                 
002820*----------------------------------------------------------------*
002830*    äJénê⁄ë±                                                    *
002840*----------------------------------------------------------------*
002850     IF    DB-STRING  =  SPACE                                    
002860        
      *       EXEC SQL                                                  
002870*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002880*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002890     ELSE                                                         
002900        
      *       EXEC SQL                                                  
002910*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002920*            USING  :DB-STRING                                    
002930*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002940     END-IF.                                                      
002950*                                                                 
002960*----------------------------------------------------------------*
002970*    ê⁄ë±ämîF                                                    *
002980*----------------------------------------------------------------*
002990     EVALUATE  SQLCODE                                            
003000        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
003010           CONTINUE                                               
003020        WHEN   OTHER                                              
003030*--<       ê⁄ë±ÉGÉâÅ[ >                                           
003040           MOVE     -10               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003050           PERFORM  ÉGÉâÅ[èàóù                                    
003060     END-EVALUATE.                                                
003070*                                                                 
003080 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇdÇwÇhÇs.                                      
003090     EXIT.                                                        
003100******************************************************************
003110*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                                            *
003120******************************************************************
003130 ÉtÉ@ÉCÉãÉIÅ[ÉvÉì             SECTION.                            
003140 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇrÇsÇ`ÇqÇs.                                    
003150*                                                                 
003160     OPEN  INPUT   ì¸óÕÉtÉ@ÉCÉã.                                  
003170*                                                                 
003180*----------------------------------------------------------------*
003190*    ÇvÅ|èÛë‘îªíË                                                *
003200*----------------------------------------------------------------*
003210     EVALUATE  ÇvÅ|èÛë‘                                           
003220        WHEN  ZERO                                                
003230           CONTINUE                                               
003240        WHEN  OTHER                                               
003250*--<       ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                               
003260           MOVE     1                 TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003270           PERFORM  ÉGÉâÅ[èàóù                                    
003280     END-EVALUATE.                                                
003290*                                                                 
003300 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇdÇwÇhÇs.                                      
003310     EXIT.                                                        
003320******************************************************************
003330*   ñºèÃÉ}ÉXÉ^(éëéYñº)ÉtÉ@ÉCÉãì«çûèàóù                           *
003340******************************************************************
003350 ì¸óÕÉtÉ@ÉCÉãì«çû                     SECTION.                    
003360 ì¸óÕÉtÉ@ÉCÉãì«çûÅ|ÇrÇsÇ`ÇqÇs.                                    
003370     READ  ì¸óÕÉtÉ@ÉCÉã                                           
003380        AT  END                                                   
003390            MOVE  "Y"  TO  ÇvÅ|èIóπÅ|ÉtÉâÉOÇP                     
003400            GO  TO  ì¸óÕÉtÉ@ÉCÉãì«çûÅ|ÇdÇwÇhÇs                    
003410     END-READ.                                                    
003420*--< ÉtÉ@ÉCÉãì«çûèÛë‘îªíË>                                        
003430     EVALUATE ÇvÅ|èÛë‘                                            
003440        WHEN ZERO                                                 
003450*--<       ê≥èÌ >                                                 
003460           MOVE  ì¸óÕÅ|éëéYÉRÅ[Éh     TO  ÇvÅ|éëéYÉRÅ[ÉhÇP        
003470           MOVE  ì¸óÕÅ|éØï ÉRÅ[Éh     TO  ÇvÅ|éØï ÉRÅ[ÉhÇP        
003480*--<       ÉtÉ@ÉCÉãì¸óÕåèêîÇâ¡éZ>                                
003490           COMPUTE  ÇvÅ|ì¸óÕÅ|åèêîÇP =  ÇvÅ|ì¸óÕÅ|åèêîÇP + 1      
003500        WHEN OTHER                                                
003510*--<       ÉtÉ@ÉCÉãì«çûÉGÉâÅ[>                                    
003520           MOVE 2                     TO ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh         
003530           PERFORM ÉGÉâÅ[èàóù                                     
003540     END-EVALUATE.                                                
003550*                                                                 
003560*--<  éÊìæîªíËèàóù >                                              
003570     IF  ÇvÅ|éØï ÉRÅ[ÉhÇP = "0010"                                
003580        CONTINUE                                                  
003590     ELSE                                                         
003600        PERFORM  ì¸óÕÉtÉ@ÉCÉãì«çû                                 
003610     END-IF.                                                      
003620 ì¸óÕÉtÉ@ÉCÉãì«çûÅ|ÇdÇwÇhÇs.                                      
003630     EXIT.                                                        
003640******************************************************************
003650*    ÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`                                        *
003660******************************************************************
003670 ÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`                 SECTION.                    
003680 ÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇrÇsÇ`ÇqÇs.                                
003690*                                                                 
003700*----------------------------------------------------------------*
003710*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
003720*----------------------------------------------------------------*
003730     
      *    EXEC SQL                                                     
003740*       DECLARE CUR1  CURSOR FOR                                  
003750*          SELECT  LTRCDM0010.éëéYÉRÅ[Éh                          
003760*                 ,LTRCDM0010.éØï ÉRÅ[Éh                          
003770*                 ,ìKópîNåéì˙ÇeÇqÇnÇlÅQîNåéì˙ÇP                   
003780*                 ,ìKópîNåéì˙ÇeÇqÇnÇlÅQîNåéì˙ÇQ                   
003790*                 ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQîNåéì˙ÇR        
003800*                 ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQîNåéì˙ÇS        
003810*                 ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQîNåéì˙ÇT        
003820*                 ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQê¢ãIÇP          
003830*                 ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQê¢ãIÇQ          
003840*                 ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQê¢ãIÇR          
003850*                 ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQê¢ãIÇS          
003860*                 ,LTRCDM0010.ìKópîNåéì˙ÇeÇqÇnÇlÅQê¢ãIÇT          
003870*                 ,LTRCDM0010.ëœópîNêîÇP                          
003880*                 ,LTRCDM0010.ëœópîNêîÇQ                          
003890*                 ,LTRCDM0010.ëœópîNêîÇR                          
003900*                 ,LTRCDM0010.ëœópîNêîÇS                          
003910*                 ,LTRCDM0010.ëœópîNêîÇT                          
003920*           FROM   LTRCDM0010                                     
003930*          WHERE   LTRCDM0010.éØï ÉRÅ[Éh = '0010'                 
003940*       ORDER BY   LTRCDM0010.éëéYÉRÅ[Éh                          
003950*     END-EXEC.
003960*                                                                 
003970*----------------------------------------------------------------*
003980*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
003990*----------------------------------------------------------------*
004000     
      *    EXEC  SQL                                                    
004010*       OPEN  CUR1                                                
004020*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004030*                                                                 
004040*----------------------------------------------------------------*
004050*    ÉJÅ[É\ÉãÇnÇoÇdÇmämîF                                        *
004060*----------------------------------------------------------------*
004070*                                                                 
004080     EVALUATE  SQLCODE                                            
004090        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
004100*--<       ê≥èÌ >                                                 
004110           CONTINUE                                               
004120        WHEN  OTHER                                               
004130*--<       ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
004140           MOVE -20                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004150           PERFORM  ÉGÉâÅ[èàóù                                    
004160     END-EVALUATE.                                                
004170 ÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇdÇwÇhÇs.                                  
004180     EXIT.                                                        
004190******************************************************************
004200*    ÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                                        *
004210******************************************************************
004220 ÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                 SECTION.                    
004230 ÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇrÇsÇ`ÇqÇs.                                
004240*                                                                 
004250*--< ÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû >                                       
004260     
      *    EXEC SQL                                                     
004270*        FETCH  CUR1                                              
004280*         INTO :ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|éëéYÉRÅ[Éh                  
004290*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|éØï ÉRÅ[Éh                  
004300*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇP
004310*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇQ
004320*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇR
004330*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇS
004340*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇT
004350*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇP  
004360*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇQ  
004370*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇR  
004380*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇS  
004390*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇT  
004400*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇP                  
004410*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇQ                  
004420*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇR                  
004430*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇS                  
004440*             ,:ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇT                  
004450*     END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 82 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|éëéYÉRÅ[Éh
               SQL-SQHSTV(1)
           MOVE 7 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|éØï ÉRÅ[Éh
               SQL-SQHSTV(2)
           MOVE 4 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇP
               SQL-SQHSTV(3)
           MOVE 6 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇQ
               SQL-SQHSTV(4)
           MOVE 6 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇR
               SQL-SQHSTV(5)
           MOVE 6 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇS
               SQL-SQHSTV(6)
           MOVE 6 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇT
               SQL-SQHSTV(7)
           MOVE 6 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇP
               SQL-SQHSTV(8)
           MOVE 1 TO SQL-SQHSTL(8)
           MOVE 0 TO SQL-SQHSTS(8)
           MOVE 0 TO SQL-SQINDV(8)
           MOVE 0 TO SQL-SQINDS(8)
           MOVE 0 TO SQL-SQHARM(8)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇQ
               SQL-SQHSTV(9)
           MOVE 1 TO SQL-SQHSTL(9)
           MOVE 0 TO SQL-SQHSTS(9)
           MOVE 0 TO SQL-SQINDV(9)
           MOVE 0 TO SQL-SQINDS(9)
           MOVE 0 TO SQL-SQHARM(9)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇR
               SQL-SQHSTV(10)
           MOVE 1 TO SQL-SQHSTL(10)
           MOVE 0 TO SQL-SQHSTS(10)
           MOVE 0 TO SQL-SQINDV(10)
           MOVE 0 TO SQL-SQINDS(10)
           MOVE 0 TO SQL-SQHARM(10)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇS
               SQL-SQHSTV(11)
           MOVE 1 TO SQL-SQHSTL(11)
           MOVE 0 TO SQL-SQHSTS(11)
           MOVE 0 TO SQL-SQINDV(11)
           MOVE 0 TO SQL-SQINDS(11)
           MOVE 0 TO SQL-SQHARM(11)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇT
               SQL-SQHSTV(12)
           MOVE 1 TO SQL-SQHSTL(12)
           MOVE 0 TO SQL-SQHSTS(12)
           MOVE 0 TO SQL-SQINDV(12)
           MOVE 0 TO SQL-SQINDS(12)
           MOVE 0 TO SQL-SQHARM(12)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇP
               SQL-SQHSTV(13)
           MOVE 2 TO SQL-SQHSTL(13)
           MOVE 0 TO SQL-SQHSTS(13)
           MOVE 0 TO SQL-SQINDV(13)
           MOVE 0 TO SQL-SQINDS(13)
           MOVE 0 TO SQL-SQHARM(13)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇQ
               SQL-SQHSTV(14)
           MOVE 2 TO SQL-SQHSTL(14)
           MOVE 0 TO SQL-SQHSTS(14)
           MOVE 0 TO SQL-SQINDV(14)
           MOVE 0 TO SQL-SQINDS(14)
           MOVE 0 TO SQL-SQHARM(14)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇR
               SQL-SQHSTV(15)
           MOVE 2 TO SQL-SQHSTL(15)
           MOVE 0 TO SQL-SQHSTS(15)
           MOVE 0 TO SQL-SQINDV(15)
           MOVE 0 TO SQL-SQINDS(15)
           MOVE 0 TO SQL-SQHARM(15)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇS
               SQL-SQHSTV(16)
           MOVE 2 TO SQL-SQHSTL(16)
           MOVE 0 TO SQL-SQHSTS(16)
           MOVE 0 TO SQL-SQINDV(16)
           MOVE 0 TO SQL-SQINDS(16)
           MOVE 0 TO SQL-SQHARM(16)
           CALL "SQLADR" USING
               ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇT
               SQL-SQHSTV(17)
           MOVE 2 TO SQL-SQHSTL(17)
           MOVE 0 TO SQL-SQHSTS(17)
           MOVE 0 TO SQL-SQINDV(17)
           MOVE 0 TO SQL-SQINDS(17)
           MOVE 0 TO SQL-SQHARM(17)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004460*                                                                 
004470*----------------------------------------------------------------*
004480*    ÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÇämîF                                  *
004490*----------------------------------------------------------------*
004500     EVALUATE  SQLCODE                                            
004510        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
004520*--<       ê≥èÌ >                                                 
004530           MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|éëéYÉRÅ[Éh                 
004540                                      TO  ÇvÅ|éëéYÉRÅ[ÉhÇQ        
004550           MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|éØï ÉRÅ[Éh                 
004560                                      TO  ÇvÅ|éØï ÉRÅ[ÉhÇQ        
004570*--<       ì¸óÕåèêîÇâ¡éZ>                                        
004580           COMPUTE  ÇvÅ|ì¸óÕÅ|åèêîÇQ =  ÇvÅ|ì¸óÕÅ|åèêîÇQ + 1      
004590        WHEN   íËêîÅ|ÇrÇpÇkÇdÇmÇc                                 
004600*--<       ì«çûèIóπ >                                             
004610           MOVE  "Y"                  TO  ÇvÅ|èIóπÅ|ÉtÉâÉOÇQ      
004620           MOVE  HIGH-VALUE           TO  ÇvÅ|éëéYÉRÅ[ÉhÇQ        
004630        WHEN  OTHER                                               
004640*--<       ÉJÅ[É\Éãì«çûÉGÉâÅ[ >                                   
004650           MOVE -30                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004660           PERFORM  ÉGÉâÅ[èàóù                                    
004670     END-EVALUATE.                                                
004680 ÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇdÇwÇhÇs.                                  
004690     EXIT.                                                        
004700******************************************************************
004710*    ï“èWèoóÕèàóù                                                *
004720******************************************************************
004730 ï“èWèoóÕèàóù                         SECTION.                    
004740 ï“èWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                        
004750*                                                                 
004760     PERFORM  éëéYï™óﬁñºèÃéÊìæèàóù.                               
004770*                                                                 
004780*--< ÇvÅ|ìKëœîNåéì˙ÅAÇvÅ|ëœópîNêîçÄñ⁄éÊìæ >                       
004790     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇP     
004800                                      TO  ÇvÅ|ìKëœîNåéì˙(1).      
004810     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇQ     
004820                                      TO  ÇvÅ|ìKëœîNåéì˙(2).      
004830     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇR     
004840                                      TO  ÇvÅ|ìKëœîNåéì˙(3).      
004850     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇS     
004860                                      TO  ÇvÅ|ìKëœîNåéì˙(4).      
004870     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙ÇT     
004880                                      TO  ÇvÅ|ìKëœîNåéì˙(5).      
004890     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇP       
004900                                      TO  ÇvÅ|ê¢ãIÇl(1).          
004910     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇQ       
004920                                      TO  ÇvÅ|ê¢ãIÇl(2).          
004930     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇR       
004940                                      TO  ÇvÅ|ê¢ãIÇl(3).          
004950     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇS       
004960                                      TO  ÇvÅ|ê¢ãIÇl(4).          
004970     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãIÇT       
004980                                      TO  ÇvÅ|ê¢ãIÇl(5).          
004990     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇP                       
005000                                      TO  ÇvÅ|ëœópîNêî(1).        
005010     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇQ                       
005020                                      TO  ÇvÅ|ëœópîNêî(2).        
005030     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇR                       
005040                                      TO  ÇvÅ|ëœópîNêî(3).        
005050     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇS                       
005060                                      TO  ÇvÅ|ëœópîNêî(4).        
005070     MOVE  ÇkÇsÇqÇbÇcÇlÇOÇOÇPÇOÅ|ëœópîNêîÇT                       
005080                                      TO  ÇvÅ|ëœópîNêî(5).        
005090*                                                                 
005100*--< èâä˙âªèàóù >                                                 
005110     MOVE  SPACE                 TO  éëéYéÌóﬁÉ}ÉXÉ^.              
005120     INITIALIZE                      éëéYéÌóﬁÉ}ÉXÉ^.              
005130*                                                                 
005140     PERFORM  éëéYéÌóﬁÉ}ÉXÉ^çÄñ⁄ï“èWèoóÕèàóù        VARYING       
005150                                      I FROM 1 BY 1 UNTIL I > 5.  
005160*                                                                 
005170 ï“èWèoóÕèàóùÅ|ÇdÇwÇhÇs.                                          
005180     EXIT.                                                        
005190******************************************************************
005200*    éëéYéÌóﬁÉ}ÉXÉ^çÄñ⁄ï“èWèoóÕèàóù                              *
005210******************************************************************
005220 éëéYéÌóﬁÉ}ÉXÉ^çÄñ⁄ï“èWèoóÕèàóù       SECTION.                    
005230 éëéYéÌóﬁÉ}ÉXÉ^çÄñ⁄ï“èWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                      
005240*                                                                 
005250*----------------------------------------------------------------*
005260*    ì˙ïtèàóù                                                    *
005270*----------------------------------------------------------------*
005280     IF  ÇvÅ|ìKëœîNåéì˙(I)            =   ZERO                    
005290        MOVE  ZERO                     TO                         
005300                                         ÇvÅ|ìKópîNåéì˙ÇeÇqÇnÇl(I)
005310     ELSE                                                         
005320        IF ÇvÅ|ê¢ãIÇl(I)              =   0                       
005330           MOVE  "19"                 TO  ÇvÅ|ìKëœê¢ãI(I)         
005340        ELSE                                                      
005350           MOVE  "20"                 TO  ÇvÅ|ìKëœê¢ãI(I)         
005360     END-IF.                                                      
005370     MOVE  ÇvÅ|ìKópîNåéì˙ÇeÇqÇnÇl(I)  TO  ÇvÅ|ìKópîNåéì˙.         
005380*                                                                 
005390     MOVE  ÇvÅ|ëœópîNêî(I)            TO  ÇvÅ|ëœópîNêîÇl.         
005400*                                                                 
005410*----------------------------------------------------------------*
005420*    éëéYéÌóﬁÉ}ÉXÉ^çÄñ⁄ï“èWèàóù                                  *
005430*----------------------------------------------------------------*
005440*--< No.01 >                                                      
005450     MOVE  ì¸óÕÅ|éëéYÉRÅ[Éh           TO  ÇcÇPÇQÅ|éëéYéÌóﬁ.       
005460*                                                                 
005470*--< No.02 >                                                      
005480     MOVE  ÇvÅ|ìKópîNåéì˙             TO  ÇcÇPÇQÅ|ìKópîNåéì˙.     
005490*                                                                 
005500*--< No.03 >                                                      
005510     MOVE  ÇvÅ|éëéYëÂï™óﬁñºèÃ         TO  ÇcÇPÇQÅ|éëéYëÂï™óﬁñºèÃ. 
005520*                                                                 
005530*--< No.04 >                                                      
005540     MOVE  ì¸óÕÅ|ñºèÃ                 TO  ÇcÇPÇQÅ|éëéYñºèÃ.       
005550*                                                                 
005560*--< No.05 >                                                      
005570     MOVE   ÇvÅ|ëœópîNêîÇl            TO   ÇcÇPÇQÅ|ëœópîNêî.      
005580*                                                                 
005590*--< No.06 >                                                      
005600     MOVE  ZERO                       TO  ÇcÇPÇQÅ|ê≈ñ@ãÊï™.       
005610*                                                                 
005620*--< No.07 >                                                      
005630     MOVE  ZERO                       TO  ÇcÇPÇQÅ|çXêVì˙éû.       
005640*                                                                 
005650*--< No.08 >                                                      
005660     MOVE  ÇvÅ|çXêVé“                 TO  ÇcÇPÇQÅ|çXêVé“.         
005670*                                                                 
005680*--< No.09 >                                                      
005690     MOVE  ZERO                       TO  ÇcÇPÇQÅ|ê\çêópîªíËÉRÅ[Éh.
005700*                                                                 
005710*--< No.10 >                                                      
005720     MOVE  ZERO                       TO  ÇcÇPÇQÅ|äJé¶ópîªíËÉRÅ[Éh.
005730*                                                                 
005740*--< No.11 >                                                      
005750     MOVE  ZERO                       TO                          
005760                                      ÇcÇPÇQÅ|îNéüìùåvópîªíËÉRÅ[Éh.
005770*                                                                 
005780*--< No.12 >                                                      
005790     MOVE  ÇvÅ|íSìñé“                 TO  ÇcÇPÇQÅ|ì¸óÕíSìñé“ÉRÅ[Éh.
005800*                                                                 
005810*--< No.13 >                                                      
005820     MOVE  ì¸óÕÅ|ñºèÃÉJÉi             TO  ÇcÇPÇQÅ|éëéYñºèÃÉJÉi.   
005830*                                                                 
005840*--< No.14 >                                                      
005850     MOVE  ì¸óÕÅ|ó™èÃ                 TO  ÇcÇPÇQÅ|éëéYó™èÃ.       
005860*                                                                 
005870*--< No.15 >                                                      
005880     MOVE  ì¸óÕÅ|ó™èÃÉJÉi             TO  ÇcÇPÇQÅ|éëéYó™èÃÉJÉi.   
005890*                                                                 
005900*--< No.16 >                                                      
005910     MOVE  ÇvÅ|ÉVÉXÉeÉÄì˙ït           TO  ÇcÇPÇQÅ|ìoò^îNåéì˙.     
005920*                                                                 
005930*--< No.17 >                                                      
005940     MOVE  ÇvÅ|ÉVÉXÉeÉÄéûçè           TO  ÇcÇPÇQÅ|ìoò^éûä‘.       
005950*                                                                 
005960*--< No.18 >                                                      
005970     MOVE  ÇvÅ|ìoò^íSìñé“             TO  ÇcÇPÇQÅ|ìoò^íSìñé“.     
005980*                                                                 
005990*--< No.19 >                                                      
006000     MOVE  ÇvÅ|ÉVÉXÉeÉÄì˙ït           TO  ÇcÇPÇQÅ|çXêVîNåéì˙.     
006010*                                                                 
006020*--< No.20 >                                                      
006030     MOVE  ÇvÅ|ÉVÉXÉeÉÄéûçè           TO  ÇcÇPÇQÅ|çXêVéûä‘.       
006040*----------------------------------------------------------------*
006050*    éëéYéÌóﬁÉ}ÉXÉ^çÄñ⁄èoóÕèàóù                                  *
006060*----------------------------------------------------------------*
006070*                                                                 
006080     IF  ÇcÇPÇQÅ|ìKópîNåéì˙  NOT =  ZERO                          
006090        PERFORM  èoóÕèàóù                                         
006100     END-IF.                                                      
006110 éëéYéÌóﬁÉ}ÉXÉ^çÄñ⁄ï“èWèoóÕèàóùÅ|ÇdÇwÇhÇs.                        
006120     EXIT.                                                        
006130******************************************************************
006140*    No.03.éëéYï™óﬁñºèÃéÊìæèàóù                                  *
006150******************************************************************
006160 éëéYï™óﬁñºèÃéÊìæèàóù                 SECTION.                    
006170 éëéYï™óﬁñºèÃéÊìæèàóùÅ|ÇrÇsÇ`ÇqÇs.                                
006180*                                                                 
006190     MOVE ì¸óÕÅ|éëéYÉRÅ[Éh            TO ÇvÅ|éëéYï™óﬁñºèÃÇeÇkÇ`Çf.
006200     EVALUATE   ÇvÅ|éëéYï™óﬁñºèÃÇeÇkÇ`Çf                          
006210*                                                                 
006220        WHEN  "0"                                                 
006230           MOVE  "ñ≥å`éëéY"      TO  ÇvÅ|éëéYëÂï™óﬁñºèÃ           
006240*                                                                 
006250        WHEN  "1"                                                 
006260           MOVE  "åöï®"          TO  ÇvÅ|éëéYëÂï™óﬁñºèÃ           
006270*                                                                 
006280        WHEN  "2"                                                 
006290           MOVE  "åöï®ïtëÆê›îı"  TO  ÇvÅ|éëéYëÂï™óﬁñºèÃ           
006300*                                                                 
006310        WHEN  "3"                                                 
006320            MOVE  "ç\ízï®"        TO  ÇvÅ|éëéYëÂï™óﬁñºèÃ          
006330*                                                                 
006340        WHEN  "4"                                                 
006350           MOVE  "ëDîï"          TO  ÇvÅ|éëéYëÂï™óﬁñºèÃ           
006360*                                                                 
006370        WHEN  "5"                                                 
006380           MOVE  "çqãÛã@"        TO  ÇvÅ|éëéYëÂï™óﬁñºèÃ           
006390*                                                                 
006400        WHEN  "6"                                                 
006410           MOVE "é‘óºãyÇ—â^î¿ãÔ" TO  ÇvÅ|éëéYëÂï™óﬁñºèÃ           
006420*                                                                 
006430        WHEN  "7"                                                 
006440           MOVE  "çHãÔ"          TO  ÇvÅ|éëéYëÂï™óﬁñºèÃ           
006450*                                                                 
006460        WHEN  "8"                                                 
006470           MOVE  "äÌãÔãyÇ—îıïi"  TO  ÇvÅ|éëéYëÂï™óﬁñºèÃ           
006480*                                                                 
006490        WHEN  OTHER                                               
006500           MOVE  SPACE           TO  ÇvÅ|éëéYëÂï™óﬁñºèÃ           
006510     END-EVALUATE.                                                
006520 éëéYï™óﬁñºèÃéÊìæèàóùÅ|ÇdÇwÇhÇs.                                  
006530     EXIT.                                                        
006540******************************************************************
006550*    èoóÕèàóù                                                    *
006560******************************************************************
006570 èoóÕèàóù               SECTION.                                  
006580 èoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
006590*                                                                 
006600       
      *      EXEC  SQL                                                  
006610*       INSERT  INTO  D12SIB_TBL                                  
006620*          ( éëéYéÌóﬁ                                             
006630*           ,ìKópîNåéì˙                                           
006640*           ,éëéYëÂï™óﬁñºèÃ                                       
006650*           ,éëéYñºèÃ                                             
006660*           ,ëœópîNêî                                             
006670*           ,ê≈ñ@ãÊï™                                             
006680*           ,çXêVì˙éû                                             
006690*           ,çXêVé“                                               
006700*           ,ê\çêópîªíËÉRÅ[Éh                                     
006710*           ,äJé¶ópîªíËÉRÅ[Éh                                     
006720*           ,îNéüìùåvópîªíËÉRÅ[Éh                                 
006730*           ,ì¸óÕíSìñé“ÉRÅ[Éh                                     
006740*           ,éëéYñºèÃÉJÉi                                         
006750*           ,éëéYó™èÃ                                             
006760*           ,éëéYó™èÃÉJÉi                                         
006770*           ,ìoò^îNåéì˙                                           
006780*           ,ìoò^éûä‘                                             
006790*           ,ìoò^íSìñé“                                           
006800*           ,çXêVîNåéì˙                                           
006810*           ,çXêVéûä‘)                                            
006820*      VALUES                                                     
006830*          ( :ÇcÇPÇQÅ|éëéYéÌóﬁ                                    
006840*           ,:ÇcÇPÇQÅ|ìKópîNåéì˙                                  
006850*           ,:ÇcÇPÇQÅ|éëéYëÂï™óﬁñºèÃ                              
006860*           ,:ÇcÇPÇQÅ|éëéYñºèÃ                                    
006870*           ,:ÇcÇPÇQÅ|ëœópîNêî                                    
006880*           ,:ÇcÇPÇQÅ|ê≈ñ@ãÊï™                                    
006890*           ,:ÇcÇPÇQÅ|çXêVì˙éû                                    
006900*           ,:ÇcÇPÇQÅ|çXêVé“                                      
006910*           ,:ÇcÇPÇQÅ|ê\çêópîªíËÉRÅ[Éh                            
006920*           ,:ÇcÇPÇQÅ|äJé¶ópîªíËÉRÅ[Éh                            
006930*           ,:ÇcÇPÇQÅ|îNéüìùåvópîªíËÉRÅ[Éh                        
006940*           ,:ÇcÇPÇQÅ|ì¸óÕíSìñé“ÉRÅ[Éh                            
006950*           ,:ÇcÇPÇQÅ|éëéYñºèÃÉJÉi                                
006960*           ,:ÇcÇPÇQÅ|éëéYó™èÃ                                    
006970*           ,:ÇcÇPÇQÅ|éëéYó™èÃÉJÉi                                
006980*           ,:ÇcÇPÇQÅ|ìoò^îNåéì˙                                  
006990*           ,:ÇcÇPÇQÅ|ìoò^éûä‘                                    
007000*           ,:ÇcÇPÇQÅ|ìoò^íSìñé“                                  
007010*           ,:ÇcÇPÇQÅ|çXêVîNåéì˙                                  
007020*           ,:ÇcÇPÇQÅ|çXêVéûä‘)                                   
007030*    END-EXEC.
             CALL "SQLADR" USING SQ0002 SQL-STMT
             MOVE 1 TO SQL-ITERS
             MOVE 165 TO SQL-OFFSET
             MOVE 0 TO SQL-OCCURS
             CALL "SQLADR" USING
                 SQLCUD
                 SQL-CUD
             CALL "SQLADR" USING
                 SQLCA
                 SQL-SQLEST
             MOVE 256 TO SQL-SQLETY
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|éëéYéÌóﬁ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(1)
             MOVE 7 TO SQL-SQHSTL(1)
             MOVE 0 TO SQL-SQHSTS(1)
             MOVE 0 TO SQL-SQINDV(1)
             MOVE 0 TO SQL-SQINDS(1)
             MOVE 0 TO SQL-SQHARM(1)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|ìKópîNåéì˙ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(2)
             MOVE 8 TO SQL-SQHSTL(2)
             MOVE 0 TO SQL-SQHSTS(2)
             MOVE 0 TO SQL-SQINDV(2)
             MOVE 0 TO SQL-SQINDS(2)
             MOVE 0 TO SQL-SQHARM(2)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|éëéYëÂï™óﬁñºèÃ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(3)
             MOVE 40 TO SQL-SQHSTL(3)
             MOVE 0 TO SQL-SQHSTS(3)
             MOVE 0 TO SQL-SQINDV(3)
             MOVE 0 TO SQL-SQINDS(3)
             MOVE 0 TO SQL-SQHARM(3)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|éëéYñºèÃ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(4)
             MOVE 60 TO SQL-SQHSTL(4)
             MOVE 0 TO SQL-SQHSTS(4)
             MOVE 0 TO SQL-SQINDV(4)
             MOVE 0 TO SQL-SQINDS(4)
             MOVE 0 TO SQL-SQHARM(4)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|ëœópîNêî IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(5)
             MOVE 2 TO SQL-SQHSTL(5)
             MOVE 0 TO SQL-SQHSTS(5)
             MOVE 0 TO SQL-SQINDV(5)
             MOVE 0 TO SQL-SQINDS(5)
             MOVE 0 TO SQL-SQHARM(5)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|ê≈ñ@ãÊï™ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(6)
             MOVE 1 TO SQL-SQHSTL(6)
             MOVE 0 TO SQL-SQHSTS(6)
             MOVE 0 TO SQL-SQINDV(6)
             MOVE 0 TO SQL-SQINDS(6)
             MOVE 0 TO SQL-SQHARM(6)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|çXêVì˙éû IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(7)
             MOVE 16 TO SQL-SQHSTL(7)
             MOVE 0 TO SQL-SQHSTS(7)
             MOVE 0 TO SQL-SQINDV(7)
             MOVE 0 TO SQL-SQINDS(7)
             MOVE 0 TO SQL-SQHARM(7)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|çXêVé“ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(8)
             MOVE 8 TO SQL-SQHSTL(8)
             MOVE 0 TO SQL-SQHSTS(8)
             MOVE 0 TO SQL-SQINDV(8)
             MOVE 0 TO SQL-SQINDS(8)
             MOVE 0 TO SQL-SQHARM(8)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|ê\çêópîªíËÉRÅ[Éh IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(9)
             MOVE 1 TO SQL-SQHSTL(9)
             MOVE 0 TO SQL-SQHSTS(9)
             MOVE 0 TO SQL-SQINDV(9)
             MOVE 0 TO SQL-SQINDS(9)
             MOVE 0 TO SQL-SQHARM(9)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|äJé¶ópîªíËÉRÅ[Éh IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(10)
             MOVE 1 TO SQL-SQHSTL(10)
             MOVE 0 TO SQL-SQHSTS(10)
             MOVE 0 TO SQL-SQINDV(10)
             MOVE 0 TO SQL-SQINDS(10)
             MOVE 0 TO SQL-SQHARM(10)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|îNéüìùåvópîªíËÉRÅ[Éh IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(11)
             MOVE 1 TO SQL-SQHSTL(11)
             MOVE 0 TO SQL-SQHSTS(11)
             MOVE 0 TO SQL-SQINDV(11)
             MOVE 0 TO SQL-SQINDS(11)
             MOVE 0 TO SQL-SQHARM(11)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|ì¸óÕíSìñé“ÉRÅ[Éh IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(12)
             MOVE 8 TO SQL-SQHSTL(12)
             MOVE 0 TO SQL-SQHSTS(12)
             MOVE 0 TO SQL-SQINDV(12)
             MOVE 0 TO SQL-SQINDS(12)
             MOVE 0 TO SQL-SQHARM(12)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|éëéYñºèÃÉJÉi IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(13)
             MOVE 40 TO SQL-SQHSTL(13)
             MOVE 0 TO SQL-SQHSTS(13)
             MOVE 0 TO SQL-SQINDV(13)
             MOVE 0 TO SQL-SQINDS(13)
             MOVE 0 TO SQL-SQHARM(13)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|éëéYó™èÃ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(14)
             MOVE 10 TO SQL-SQHSTL(14)
             MOVE 0 TO SQL-SQHSTS(14)
             MOVE 0 TO SQL-SQINDV(14)
             MOVE 0 TO SQL-SQINDS(14)
             MOVE 0 TO SQL-SQHARM(14)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|éëéYó™èÃÉJÉi IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(15)
             MOVE 12 TO SQL-SQHSTL(15)
             MOVE 0 TO SQL-SQHSTS(15)
             MOVE 0 TO SQL-SQINDV(15)
             MOVE 0 TO SQL-SQINDS(15)
             MOVE 0 TO SQL-SQHARM(15)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|ìoò^îNåéì˙ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(16)
             MOVE 8 TO SQL-SQHSTL(16)
             MOVE 0 TO SQL-SQHSTS(16)
             MOVE 0 TO SQL-SQINDV(16)
             MOVE 0 TO SQL-SQINDS(16)
             MOVE 0 TO SQL-SQHARM(16)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|ìoò^éûä‘ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(17)
             MOVE 8 TO SQL-SQHSTL(17)
             MOVE 0 TO SQL-SQHSTS(17)
             MOVE 0 TO SQL-SQINDV(17)
             MOVE 0 TO SQL-SQINDS(17)
             MOVE 0 TO SQL-SQHARM(17)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|ìoò^íSìñé“ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(18)
             MOVE 8 TO SQL-SQHSTL(18)
             MOVE 0 TO SQL-SQHSTS(18)
             MOVE 0 TO SQL-SQINDV(18)
             MOVE 0 TO SQL-SQINDS(18)
             MOVE 0 TO SQL-SQHARM(18)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|çXêVîNåéì˙ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(19)
             MOVE 8 TO SQL-SQHSTL(19)
             MOVE 0 TO SQL-SQHSTS(19)
             MOVE 0 TO SQL-SQINDV(19)
             MOVE 0 TO SQL-SQINDS(19)
             MOVE 0 TO SQL-SQHARM(19)
             CALL "SQLADR" USING
                 ÇcÇPÇQÅ|çXêVéûä‘ IN
                 éëéYéÌóﬁÉ}ÉXÉ^
                 SQL-SQHSTV(20)
             MOVE 8 TO SQL-SQHSTL(20)
             MOVE 0 TO SQL-SQHSTS(20)
             MOVE 0 TO SQL-SQINDV(20)
             MOVE 0 TO SQL-SQINDS(20)
             MOVE 0 TO SQL-SQHARM(20)
             CALL "SQLADR" USING
                 SQL-SQHSTV(1)
                 SQL-SQPHSV
             CALL "SQLADR" USING
                 SQL-SQHSTL(1)
                 SQL-SQPHSL
             CALL "SQLADR" USING
                 SQL-SQHSTS(1)
                 SQL-SQPHSS
             CALL "SQLADR" USING
                 SQL-SQINDV(1)
                 SQL-SQPIND
             CALL "SQLADR" USING
                 SQL-SQINDS(1)
                 SQL-SQPINS
             CALL "SQLADR" USING
                 SQL-SQHARM(1)
                 SQL-SQPARM
             CALL "SQLADR" USING
                 SQL-SQHARC(1)
                 SQL-SQPARC

             CALL "SQLBEX" USING
                 SQLCTX
                 SQLEXD
                 SQLFPN

             CALL "SQLGSS" USING
                SQLSTATE
                 .
007040*                                                                 
007050*----------------------------------------------------------------*
007060*    í«â¡èàóùÇämîF                                              *
007070*----------------------------------------------------------------*
007080     EVALUATE  SQLCODE                                            
007090        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
007100*--<       í«â¡ê¨å˜ >                                             
007110           COMPUTE  ÇvÅ|èoóÕÅ|åèêî  =  ÇvÅ|èoóÕÅ|åèêî  +  1       
007120        WHEN   OTHER                                              
007130*--<       í«â¡èàóùÉGÉâÅ[ >                                       
007140           MOVE     -40               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
007150           PERFORM  ÉGÉâÅ[èàóù                                    
007160     END-EVALUATE.                                                
007170*                                                                 
007180 èoóÕèàóùÅ|ÇdÇwÇhÇs.                                              
007190     EXIT.                                                        
007200******************************************************************
007210*    ÇcÇaÉNÉçÅ[ÉYèàóù                                            *
007220******************************************************************
007230 ÇcÇaÉNÉçÅ[ÉYèàóù                     SECTION.                    
007240 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
007250*                                                                 
007260*--< ÉJÅ[É\ÉãÇÃÉNÉçÅ[ÉY >                                         
007270     
      *    EXEC  SQL                                                    
007280*       CLOSE  CUR1                                               
007290*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 260 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007300*                                                                 
007310 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇdÇwÇhÇs.                                      
007320     EXIT.                                                        
007330******************************************************************
007340*    ÇcÇaÉRÉ~ÉbÉgèàóù                                            *
007350******************************************************************
007360 ÇcÇaÉRÉ~ÉbÉgèàóù                     SECTION.                    
007370 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
007380*                                                                 
007390     
      *    EXEC  SQL                                                    
007400*       COMMIT  WORK  RELEASE                                     
007410*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 275 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007420*                                                                 
007430     INITIALIZE                       IF-CHOCO001.                
007440     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007450     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007460     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007470     MOVE  "COMMIT"                   TO  ã§ÇPÅ|èàóùéØï .         
007480     MOVE  "ÉRÉ~ÉbÉgé¿é{"             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007490     CALL  CLOCO001                USING  IF-CHOCO001.            
007500*                                                                 
007510 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇdÇwÇhÇs.                                      
007520     EXIT.                                                        
007530******************************************************************
007540*    ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                                        *
007550******************************************************************
007560 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                 SECTION.                    
007570 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóùÅ|ÇrÇsÇ`ÇqÇs.                                
007580*                                                                 
007590     
      *    EXEC  SQL                                                    
007600*       ROLLBACK WORK  RELEASE                                    
007610*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 290 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007620*                                                                 
007630     INITIALIZE                       IF-CHOCO001.                
007640     MOVE  "1"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007650     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007660     MOVE  "9"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007670     MOVE  "ROLLBACK"                 TO  ã§ÇPÅ|èàóùéØï .         
007680     MOVE  "ÉçÅ[ÉãÉoÉbÉNé¿é{"         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007690     CALL  CLOCO001                USING  IF-CHOCO001.            
007700*                                                                 
007710 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóùÅ|ÇdÇwÇhÇs.                                  
007720     EXIT.                                                        
007730******************************************************************
007740*    èIóπÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
007750******************************************************************
007760 èIóπÉÅÉbÉZÅ[ÉWèoóÕèàóù               SECTION.                    
007770 èIóπÉÅÉbÉZÅ[ÉWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                              
007780*                                                                 
007790*----------------------------------------------------------------*
007800*   ñºèÃÉ}ÉXÉ^(éëéYñº)ì«çûåèêî                                   *
007810*----------------------------------------------------------------*
007820     INITIALIZE                       IF-CHOCO001.                
007830     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007840     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007850     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007860     MOVE  "FFUIS250"                 TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007870     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007880     MOVE  ÇvÅ|ì¸óÕÅ|åèêîÇP           TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007890     MOVE  "ñºèÃÉ}ÉXÉ^(éëéYñº)ì«çûåèêî"                           
007900                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007910     CALL  CLOCO001                USING  IF-CHOCO001.            
007920*                                                                 
007930*----------------------------------------------------------------*
007940*    ÉRÅ[ÉhÉ}ÉXÉ^(ëœópîNêî)ì«çûåèêî                              *
007950*----------------------------------------------------------------*
007960     INITIALIZE                       IF-CHOCO001.                
007970     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007980     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007990     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
008000     MOVE  "LTRCDM"                   TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
008010     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
008020     MOVE  ÇvÅ|ì¸óÕÅ|åèêîÇQ           TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
008030     MOVE  "ÉRÅ[ÉhÉ}ÉXÉ^(ëœópîNêî)ì«çûåèêî"                        
008040                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008050     CALL  CLOCO001                USING  IF-CHOCO001.            
008060*                                                                 
008070*----------------------------------------------------------------*
008080*    éëéYéÌóﬁèoóÕåèêî                                            *
008090*----------------------------------------------------------------*
008100     INITIALIZE                       IF-CHOCO001.                
008110     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
008120     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
008130     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
008140     MOVE  "D12SIB"                   TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
008150     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
008160     MOVE  ÇvÅ|èoóÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
008170     MOVE  "éëéYéÌóﬁèoóÕåèêî"         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008180     CALL  CLOCO001                USING  IF-CHOCO001.            
008190*                                                                 
008200*----------------------------------------------------------------*
008210*    èIóπÉÅÉbÉZÅ[ÉW èoóÕ                                         *
008220*----------------------------------------------------------------*
008230     INITIALIZE                       IF-CHOCO001.                
008240     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
008250     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
008260     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
008270     MOVE  "END"                      TO  ã§ÇPÅ|èàóùéØï .         
008280     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008290     CALL  CLOCO001                USING  IF-CHOCO001.            
008300*                                                                 
008310 èIóπÉÅÉbÉZÅ[ÉWèoóÕèàóùÅ|ÇdÇwÇhÇs.                                
008320     EXIT.                                                        
008330******************************************************************
008340*    ÉGÉâÅ[èàóù                                                  *
008350******************************************************************
008360 ÉGÉâÅ[èàóù                           SECTION.                    
008370 ÉGÉâÅ[èàóùÅ|ÇrÇsÇ`ÇqÇs.                                          
008380*                                                                 
008390     MOVE  "Y"                        TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO.   
008400     INITIALIZE                       IF-CHOCO001.                
008410*                                                                 
008420     EVALUATE  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh                                   
008430        WHEN  1                                                   
008440*--<       ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                               
008450           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008460           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008470           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008480           MOVE  "FFUIS250"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008490           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008500           MOVE  ÇvÅ|èÛë‘             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008510           MOVE  "ñºèÃÉ}ÉXÉ^(éëéYñº)" TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008520           CALL  CLOCO001          USING  IF-CHOCO001             
008530*                                                                 
008540        WHEN  2                                                   
008550*--<       ÉtÉ@ÉCÉãèoóÕÉGÉâÅ[ >                                   
008560           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008570           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008580           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008590           MOVE  "FFUIS250"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008600           MOVE  "READ"               TO  ã§ÇPÅ|èàóùéØï           
008610           MOVE  ÇvÅ|èÛë‘             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008620           MOVE  "ñºèÃÉ}ÉXÉ^(éëéYñº)" TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008630           CALL  CLOCO001          USING  IF-CHOCO001             
008640*                                                                 
008650        WHEN  -10                                                 
008660*--<       ÇnÇqÇ`ÇbÇkÇdê⁄ë±é∏îs >                                 
008670           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008680           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008690           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008700           MOVE  "CONNECT"            TO  ã§ÇPÅ|èàóùéØï           
008710           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008720           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008730           CALL  CLOCO001          USING  IF-CHOCO001             
008740*                                                                 
008750        WHEN  -20                                                 
008760*--<       ÉeÅ[ÉuÉãÉJÅ[É\ÉãÉIÅ[ÉvÉìé∏îs >                         
008770           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008780           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008790           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008800           MOVE  "LTRCDM"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008810           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008820           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008830           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008840           CALL  CLOCO001          USING  IF-CHOCO001             
008850*                                                                 
008860        WHEN  -30                                                 
008870*--<       ÉeÅ[ÉuÉãÉJÅ[É\ÉãÉIÅ[ÉvÉìé∏îs >                         
008880           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008890           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008900           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008910           MOVE  "LTRCDM"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008920           MOVE  "FETCH"              TO  ã§ÇPÅ|èàóùéØï           
008930           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008940           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008950           CALL  CLOCO001          USING  IF-CHOCO001             
008960*                                                                 
008970        WHEN  -40                                                 
008980*--<       éëéYéÌóﬁÉ}ÉXÉ^ÇcÇaí«â¡é∏îs >                           
008990           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009000           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009010           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009020           MOVE  "D12SIB"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009030           MOVE  "INSERT"             TO  ã§ÇPÅ|èàóùéØï           
009040           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009050           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009060           CALL  CLOCO001          USING  IF-CHOCO001             
009070*                                                                 
009080        WHEN  -50                                                 
009090*--<       ëœópîNêîÇéÊìæÇ≥ÇπÇÈÇ»Ç¢ >                            
009100           MOVE  "2"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009110           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009120           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009130           MOVE  "LTRCDM"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009140           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
009150           MOVE  "ëœópîNêîÇéÊìæÇ≥ÇπÇÈÇ»Ç¢"                       
009160                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009170           CALL  CLOCO001          USING  IF-CHOCO001             
009180           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
009190*                                                                 
009200        WHEN  OTHER                                               
009210           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
009220     END-EVALUATE.                                                
009230*                                                                 
009240     IF ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO  =  "Y"                              
009250        PERFORM  ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                             
009260*                                                                 
009270        PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕèàóù                           
009280*                                                                 
009290*--<    ÉvÉçÉOÉâÉÄàŸèÌèIóπÇÃÉäÉ^Å[ÉìÉRÅ[Éh >                      
009300        MOVE  íËêîÅ|àŸèÌèÛë‘          TO  PROGRAM-STATUS          
009310*                                                                 
009320        EXIT  PROGRAM                                             
009330     END-IF.                                                      
009340*                                                                 
009350 ÉGÉâÅ[èàóùÅ|ÇdÇwÇhÇs.                                            
009360      EXIT.                                                       
009370******************************************************************
009380*                  END OF PROGRAM                                *
009390******************************************************************
