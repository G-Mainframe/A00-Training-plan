000010******************************************************************
000020*         ÅÉÇmÇmÇmÇmÇmÅÑ                                         *
000030*      1. ÉvÉçÉOÉâÉÄñº    ÅFëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉãçÏê¨           *
000040*      2. ÉvÉçÉOÉâÉÄID    ÅFAAASED25                             *
000050*      3. èàóùäTóv        ÅFåoóùí˜èàóùÅií†ï[çÏê¨Åj               *
000060*                           ÅiÉäÅ[ÉXëOéÛä÷òAí†ï[íäèoÅj           *
000070*                                                                *
000080*      4. çÏê¨é“          ÅFcuilin                               *
000090*      5. çÏê¨ì˙          ÅFXXXX.XX.XX                           *
000100                                                                  
000110******************************************************************
000120*    ÇhÇcÇdÇmÇsÇhÇeÇhÇbÇ`ÇsÇhÇnÇm  ÇcÇhÇuÇhÇrÇhÇnÇm              *
000130******************************************************************
000140 IDENTIFICATION                       DIVISION.                   
000150*                                                                 
000160 PROGRAM-ID.                            AAASED25.                 
000170                                                                  
000180******************************************************************
000190*    ÇdÇmÇuÇhÇqÇnÇmÇlÇdÇmÇs        ÇcÇhÇuÇhÇrÇhÇnÇm              *
000200******************************************************************
000210 ENVIRONMENT                          DIVISION.                   
000220******************************************************************
000230******************************************************************
000240*    ÇhÇmÇoÇtÇsÅ|ÇnÇtÇsÇoÇtÇs      ÇrÇdÇbÇsÇhÇnÇm                *
000250******************************************************************
000260 INPUT-OUTPUT                         SECTION.                    
000270 FILE-CONTROL.                                                    
000280*                                                                 
000290     SELECT         èoóÕÉtÉ@ÉCÉã  ASSIGN        TO   U11          
000300     FILE STATUS    IS     ÉtÉ@ÉCÉãèÛë‘                           
000310     ORGANIZATION   IS     LINE       SEQUENTIAL.                 
000320*                                                                 
000330******************************************************************
000340*    ÇcÇ`ÇsÇ`                      ÇcÇhÇuÇhÇrÇhÇnÇm              *
000350******************************************************************
000360 DATA                                 DIVISION.                   
000370******************************************************************
000380*    ÇeÇhÇkÇd                      ÇrÇdÇbÇsÇhÇnÇm                *
000390******************************************************************
000400 FILE                                 SECTION.                    
000410*----------------------------------------------------------------*
000420*  ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉã                                    *
000430*----------------------------------------------------------------*
000440 FD  èoóÕÉtÉ@ÉCÉã                                                 
000450     LABEL  RECORD    IS              STANDARD                    
000460     BLOCK  CONTAINS  0               RECORDS.                    
000470*                                                                 
000480 01  OUT-FILE.                                                    
000490     COPY   CPSCE50   REPLACING      ==()==  BY  ==èoóÕÅ|==.      
000500                                                                  
000510******************************************************************
000520*  ÇvÇnÇqÇjÇhÇmÇfÅ|ÇrÇsÇnÇqÇ`ÇfÇd  ÇrÇdÇbÇsÇhÇnÇm                *
000530******************************************************************
000540 WORKING-STORAGE                     SECTION.                     
000550                                                                  
000560                                                                  
000570*----------------------------------------------------------------*
000580*    ÉzÉXÉgïœêîíËã`ÉGÉäÉA                                        *
000590*----------------------------------------------------------------*
000600     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
000610*                                                                 
000620*--< ÇnÇqÇ`ÇbÇkÇdã§í ïœêî >                                       
000630     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
000640*                                                                 
000650*--< ÇnÇqÇ`ÇbÇkÇd  ÇrÇpÇké¿çsèÓïÒ >                               
000660     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
000670*                                                                 
000680*--< ëOéÛèÓïÒÇcÇa >                                               
000690     EXEC  SQL  INCLUDE  M40MAB.CBL           END-EXEC.           
000700*                                                                 
000710*--< ã∆ñ±ä«óùÉeÅ[ÉuÉã >                                           
000720     EXEC  SQL  INCLUDE  D70GYM.CBL            END-EXEC.          
000730*                                                                 
000740*--< éÊà¯êÊÉ}ÉXÉ^>                                                
000750     EXEC  SQL  INCLUDE  D01TRS.CBL            END-EXEC.          
000760                                                                  
000770*--< êøãÅêÊÉ}ÉXÉ^>                                                
000780     EXEC  SQL  INCLUDE  D02SQS.CBL            END-EXEC.          
000790                                                                  
000800*--< çÄñ⁄ñºèÃÉ}ÉXÉ^>                                              
000810     EXEC  SQL  INCLUDE  D19MSY.CBL            END-EXEC.          
000820                                                                  
000830*--< ç¬å†èÓïÒÅiàÍî ÅjÇcÇa>                                        
000840     EXEC  SQL  INCLUDE  M01SAJ.CBL            END-EXEC.          
000850 01  ÇvÇrÅ|ñºèÃÇP         PIC  X(60).                             
000860 01  ÇvÇrÅ|ñºèÃÇQ         PIC  X(60).                             
000870                                                                  
000880 01  ÇvÇrÅ|ã∆ñ±ä«óùÇhÇc   PIC  X(08)  VALUE 'GYMKNRRC'.           
000890 01  ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇP   PIC  X(03)  VALUE '038'.                
000900 01  ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇQ   PIC  X(03)  VALUE '005'.                
000910                                                                  
000920     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
000930*                                                                 
000940                                                                  
000950*----------------------------------------------------------------*
000960*    ÇvÇnÇqÇjÉGÉäÉA                                              *
000970*----------------------------------------------------------------*
000980 01  ÇvÇnÇqÇjÅ|ÉGÉäÉA.                                            
000990*--< ÉGÉâÅ[îªíËóp >                                               
001000     03  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             PIC S9(04).                 
001010*                                                                 
001020*--< ÉtÉ@ÉCÉãèÛë‘ >                                               
001030     03  ÉtÉ@ÉCÉãèÛë‘                 PIC  X(02).                 
001040                                                                  
001050*--< ÉtÉâÉOÉAÉäÉA >                                               
001060     03  ÉtÉâÉOÉAÉäÉA.                                            
001070         05  ÇvÅ|èIóπÅ|ÉtÉâÉO         PIC  X(01).                 
001080         05  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     PIC  X(01).                 
001090*                                                                 
001100*--< åèêîÉGÉäÉA >                                                 
001110     03  åèêîÉGÉäÉA.                                              
001120         05  ÇvÅ|ì¸óÕÅ|åèêî           PIC  9(09).                 
001130         05  ÇvÅ|èoóÕÅ|åèêî           PIC  9(09).                 
001140                                                                  
001150*                                                                 
001160                                                                  
001170*--< ã§í èÓïÒ >                                                   
001180 01  ÇvÅ|ã§í èÓïÒ.                                                
001190     03  ÇvÅ|ÉVÉXÉeÉÄì˙ït.                                        
001200         05  ÇvÅ|ê¢ãI                 PIC  X(02) VALUE  "20".     
001210         05  ÇvÅ|îNåéì˙               PIC  X(06).                 
001220     03  ÇvÅ|ÉVÉXÉeÉÄéûçè             PIC  X(08).                 
001230     03  ÇvÅ|íSìñé“                   PIC  X(08) VALUE "IKOPG   ".
001240*                                                                 
001250*----------------------------------------------------------------*
001260*    ÉTÉuÉãÅ[É`Éìñº                                              *
001270*----------------------------------------------------------------*
001280 01  CALL-AREA.                                                   
001290*--< ã§í ÉçÉOÉTÉuÉãÅ[É`Éì >                                       
001300     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001310     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001320*                                                                 
001330*----------------------------------------------------------------*
001340*    ÇbÇnÇoÇxóÃàÊ                                                *
001350*----------------------------------------------------------------*
001360*--< ã§í ÉçÉOópÉpÉâÉÅÅ[É^ >                                       
001370 01  IF-CHOCO001.                                                 
001380     COPY  CHOCO001  REPLACING  ==()==  BY  ==ã§ÇPÅ|==.           
001390*                                                                 
001400*----------------------------------------------------------------*
001410*    ÇhÇmÇhÉtÉ@ÉCÉãì«çûÉTÉuÉãÅ[É`ÉìópÉpÉâÉÅÉ^óÃàÊ                *
001420*----------------------------------------------------------------*
001430 01  PARA-AREA.                                                   
001440     COPY CPBCO001.                                               
001450******************************************************************
001460*    íËêîópÉfÅ[É^íËã`ÉGÉäÉA                                      *
001470******************************************************************
001480 CONSTANT                             SECTION.                    
001490 01  íËêîóÃàÊ.                                                    
001500     03  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc         PIC  X(08) VALUE "AAASED25".
001510     03  íËêîÅ|ÉvÉçÉOÉâÉÄñº           PIC  X(80)                  
001520                                      VALUE  "ïœë•ï•à⁄çs".        
001530     03  íËêîÅ|ÇrÇpÇkÇnÇj             PIC S9(04)  VALUE  ZERO.    
001540     03  íËêîÅ|ÇrÇpÇkÇdÇmÇc           PIC S9(04)  VALUE  0100.    
001550     03  íËêîÅ|ê≥èÌèÛë‘               PIC S9(04)  VALUE  ZERO.    
001560     03  íËêîÅ|àŸèÌèÛë‘               PIC S9(04)  VALUE  0009.    
001570******************************************************************
001580*    ÇoÇqÇnÇbÇdÇcÇtÇqÇd            ÇcÇhÇuÇhÇrÇhÇnÇm              *
001590******************************************************************
001600 PROCEDURE                            DIVISION.                   
001610*                                                                 
001620     PERFORM  èâä˙èàóù.                                           
001630*                                                                 
001640     PERFORM  éÂèàóù  UNTIL  ÇvÅ|èIóπÅ|ÉtÉâÉO  =  "Y".            
001650*                                                                 
001660     PERFORM  èIóπèàóù.                                           
001670*                                                                 
001680     STOP     RUN.                                                
001690*                                                                 
001700******************************************************************
001710*    èâä˙èàóù                                                    *
001720******************************************************************
001730 èâä˙èàóù                             SECTION.                    
001740 èâä˙èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
001750*                                                                 
001760*----------------------------------------------------------------*
001770*    äJénÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
001780*----------------------------------------------------------------*
001790     INITIALIZE                       IF-CHOCO001.                
001800     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
001810     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
001820     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
001830     MOVE  "START"                    TO  ã§ÇPÅ|èàóùéØï .         
001840     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
001850     CALL  CLOCO001                USING  IF-CHOCO001.            
001860*                                                                 
001870*----------------------------------------------------------------*
001880*    çÏã∆óÃàÊÇÃèâä˙ílèàóù                                        *
001890*----------------------------------------------------------------*
001900     MOVE  SPACE                      TO  ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001910     INITIALIZE                           ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001920                                                                  
001930*--< ÇnÇqÇ`ÇbÇkÇdê⁄ë± >                                           
001940     PERFORM   ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                                  
001950*--<  ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû  >                                     
001960     PERFORM ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû.                                
001970*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã` >                                   
001980     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`.                           
001990*--<         ÉtÉ@ÉCÉãÉIÅ[ÉvÉì >                                   
002000     PERFORM ÉtÉ@ÉCÉãÉIÅ[ÉvÉì.                                    
002010*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû(ÇPåèñ⁄) >                           
002020     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
002030*                                                                 
002040 èâä˙èàóùÅ|ÇdÇwÇhÇs.                                              
002050     EXIT.                                                        
002060******************************************************************
002070*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
002080******************************************************************
002090 ÇnÇqÇ`ÇbÇkÇdê⁄ë±                     SECTION.                    
002100 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇrÇsÇ`ÇqÇs.                                    
002110*                                                                 
002120*--< ÇcÇaê⁄ë±ópèÓïÒÇéÊìæèàóù >                                   
002130     CALL  COBCO001                USING  PARA-AREA.              
002140*                                                                 
002150     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002160     MOVE  PARA-USERNAME              TO  USERNAME.               
002170     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002180*                                                                 
002190*----------------------------------------------------------------*
002200*    äJénê⁄ë±                                                    *
002210*----------------------------------------------------------------*
002220     IF    DB-STRING  =  SPACE                                    
002230        EXEC SQL                                                  
002240           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002250        END-EXEC                                                  
002260     ELSE                                                         
002270        EXEC SQL                                                  
002280           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002290             USING  :DB-STRING                                    
002300        END-EXEC                                                  
002310     END-IF.                                                      
002320*                                                                 
002330*----------------------------------------------------------------*
002340*    ê⁄ë±ämîF                                                    *
002350*----------------------------------------------------------------*
002360     EVALUATE  SQLCODE                                            
002370        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002380           CONTINUE                                               
002390        WHEN   OTHER                                              
002400*--<       ê⁄ë±ÉGÉâÅ[ >                                           
002410           MOVE     -10               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002420           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002430     END-EVALUATE.                                                
002440*                                                                 
002450 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇdÇwÇhÇs.                                      
002460     EXIT.                                                        
002470******************************************************************
002480*        åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`                                *
002490******************************************************************
002500 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`             SECTION.                    
002510 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇrÇsÇ`ÇqÇs.                            
002520*                                                                 
002530*----------------------------------------------------------------*
002540*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
002550*----------------------------------------------------------------*
002560     EXEC SQL                                                     
002570        DECLARE CUR1  CURSOR FOR                                  
002580           SELECT  M40MAB_TBL.ã¶í≤ãÊï™                            
002590                  ,M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™                        
002600                  ,M40MAB_TBL.åoóùópéÂå_ñÒãÊï™                    
002610                  ,M40MAB_TBL.å⁄ãqãÊï™                            
002620                  ,NVL(D01TRS_TBL.ñºäÒÇπÉRÅ[Éh,RPAD(' ',40,' '))  
002630                  ,M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh                  
002640                  ,M40MAB_TBL.êøãÅêÊÉRÅ[Éh                        
002650                  ,M40MAB_TBL.å_ñÒî‘çÜ                            
002660                  ,M40MAB_TBL.å_ñÒéÌóﬁ                            
002670                  ,M40MAB_TBL.íSìñïîâ€ÉRÅ[Éh                      
002680                  ,M40MAB_TBL.çƒÉäÅ[ÉXâÒêî                        
002690                  ,M40MAB_TBL.è[ìñäJénîNåé                        
002700                  ,M40MAB_TBL.è[ìñåéêî                            
002710                  ,M40MAB_TBL.ëOï•âÒé˚ï˚ñ@                        
002720                  ,M40MAB_TBL.ì¸ã‡ì˙                              
002730                  ,M40MAB_TBL.ì¸ã‡ãÊï™                            
002740                  ,NVL(D01TRS_TBL.éÊà¯êÊñºèÃ,RPAD(' ',80,' '))    
002750                  ,NVL(D02SQS_TBL.êøãÅêÊñºèÃ,RPAD(' ',80,' '))    
002760                  ,M40MAB_TBL.ëOåéññécçÇ                          
002770                  ,M40MAB_TBL.ìñåéâÒé˚äz                          
002780                  ,M40MAB_TBL.ìñåéè¡âªäz                          
002790                  ,M40MAB_TBL.ìñåéññécçÇ                          
002800                  ,M40MAB_TBL.ëOåéññécçÇëºé–                      
002810                  ,M40MAB_TBL.ìñåéâÒé˚äzëºé–                      
002820                  ,M40MAB_TBL.ìñåéè¡âªäzëºé–                      
002830                  ,M40MAB_TBL.ìñåéëºé–âñÒï™óøã‡                  
002840                  ,M40MAB_TBL.ìñåéëºé–âñÒï™è¡îÔê≈                
002850                  ,M40MAB_TBL.ìñåéññécçÇëºé–                      
002860             FROM  M40MAB_TBL                                     
002870                  ,D01TRS_TBL                                     
002880                  ,D02SQS_TBL                                     
002890            WHERE  M40MAB_TBL.ëOéÛã‡éÛï•écçÇï\ëŒè€ÉtÉâÉO  =  '1'  
002900              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh                  
002910                              = D01TRS_TBL.éÊà¯êÊÉRÅ[Éh(+)        
002920              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh                  
002930                              = D02SQS_TBL.éÊà¯êÊÉRÅ[Éh(+)        
002940              AND  M40MAB_TBL.êøãÅêÊÉRÅ[Éh                        
002950                              = D02SQS_TBL.êøãÅêÊÉRÅ[Éh(+)        
002960         ORDER BY  M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™                        
002970                  ,M40MAB_TBL.å_ñÒî‘çÜ                            
002980     END-EXEC.                                                    
002990*                                                                 
003000
003010*----------------------------------------------------------------*
003020*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
003030*----------------------------------------------------------------*
003040     EXEC  SQL                                                    
003050        OPEN  CUR1                                                
003060     END-EXEC.                                                    
003070*                                                                 
003080*----------------------------------------------------------------*
003090*    ÉJÅ[É\ÉãÇnÇoÇdÇmämîF                                        *
003100*----------------------------------------------------------------*
003110     EVALUATE  SQLCODE                                            
003120        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
003130*--<       ê≥èÌ >                                                 
003140           CONTINUE                                               
003150        WHEN  OTHER                                               
003160*--<       ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
003170           MOVE -20                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003180           PERFORM  ÉGÉâÅ[îªíËèàóù                                
003190     END-EVALUATE.                                                
003200*                                                                 
003210 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇdÇwÇhÇs.                              
003220     EXIT.                                                        
003230
003240******************************************************************
003250*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                                            *
003260******************************************************************
003270 ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                     SECTION.                    
003280 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇrÇsÇ`ÇqÇs.                                    
003290*                                                                 
003300*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉì ÇnÇoÇdÇm >                                  
003310     OPEN  OUTPUT  èoóÕÉtÉ@ÉCÉã.                                  
003320*                                                                 
003330*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉìèÛë‘îªíË >                                   
003340     EVALUATE    ÉtÉ@ÉCÉãèÛë‘                                     
003350        WHEN  ZERO                                                
003360*--<       ÉtÉ@ÉCÉãÉIÅ[ÉvÉìê≥èÌ >                                 
003370           CONTINUE                                               
003380        WHEN  OTHER                                               
003390*--<       ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                               
003400           MOVE  SPACE                TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO    
003410           MOVE  -40                  TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003420           PERFORM  ÉGÉâÅ[îªíËèàóù                                
003430     END-EVALUATE.                                                
003440*                                                                 
003450 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇdÇwÇhÇs.                                      
003460     EXIT.                                                        
003470*                                                                 
003480                                                                  
003490******************************************************************
003500*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                                    *
003510******************************************************************
003520 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû             SECTION.                    
003530 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇrÇsÇ`ÇqÇs.                            
003540*                                                                 
003550*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû >                                   
003560     EXEC SQL                                                     
003570         FETCH  CUR1                                              
003580          INTO  :ÇlÇSÇOÅ|ã¶í≤ãÊï™                                 
003590               ,:ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™                             
003600               ,:ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™                         
003610               ,:ÇlÇSÇOÅ|å⁄ãqãÊï™                                 
003620               ,:ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh                             
003630               ,:ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh                       
003640               ,:ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh                             
003650               ,:ÇlÇSÇOÅ|å_ñÒî‘çÜ                                 
003660               ,:ÇlÇSÇOÅ|å_ñÒéÌóﬁ                                 
003670               ,:ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh                           
003680               ,:ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî                             
003690               ,:ÇlÇSÇOÅ|è[ìñäJénîNåé                             
003700               ,:ÇlÇSÇOÅ|è[ìñåéêî                                 
003710               ,:ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@                             
003720               ,:ÇlÇSÇOÅ|ì¸ã‡ì˙                                   
003730               ,:ÇlÇSÇOÅ|ì¸ã‡ãÊï™                                 
003740               ,:ÇcÇOÇPÅ|éÊà¯êÊñºèÃ                               
003750               ,:ÇcÇOÇQÅ|êøãÅêÊñºèÃ                               
003760               ,:ÇlÇSÇOÅ|ëOåéññécçÇ                               
003770               ,:ÇlÇSÇOÅ|ìñåéâÒé˚äz                               
003780               ,:ÇlÇSÇOÅ|ìñåéè¡âªäz                               
003790               ,:ÇlÇSÇOÅ|ìñåéññécçÇ                               
003800               ,:ÇlÇSÇOÅ|ëOåéññécçÇëºé–                           
003810               ,:ÇlÇSÇOÅ|ìñåéâÒé˚äzëºé–                           
003820               ,:ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–                           
003830               ,:ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡                       
003840               ,:ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈                     
003850               ,:ÇlÇSÇOÅ|ìñåéññécçÇëºé–                           
003860                                                                  
003870     END-EXEC.                                                    
003880*                                                                 
003890*----------------------------------------------------------------*
003900*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÇämîF                              *
003910*----------------------------------------------------------------*
003920     EVALUATE   SQLCODE                                           
003930        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
003940*--<       ê≥èÌ >                                                 
003950*--<  ì¸óÕÅ|åèêî>                                                 
003960           COMPUTE  ÇvÅ|ì¸óÕÅ|åèêî  =  ÇvÅ|ì¸óÕÅ|åèêî  +  1       
003970        WHEN   íËêîÅ|ÇrÇpÇkÇdÇmÇc                                 
003980*--<       ì«çûèIóπ >                                             
003990           MOVE  "Y"                  TO  ÇvÅ|èIóπÅ|ÉtÉâÉO        
004000        WHEN   OTHER                                              
004010*--<       ì«çûÉGÉâÅ[ >                                           
004020           MOVE     -30               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004030           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004040     END-EVALUATE.                                                
004050                                                                  
004060     PERFORM çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù.                    
004070*                                                                 
004080     PERFORM ç¬å†èÓïÒÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù.                      
004090 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇdÇwÇhÇs.                              
004100     EXIT.                                                        
004110                                                                  
004120                                                                  
004130******************************************************************
004140*    çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù                            *
004150******************************************************************
004160                                                                  
004170 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù            SECTION.             
004180 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóùÅ|ÇrÇsÇ`ÇqÇs.                    
004190*                                                                 
004200*--< çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù >                           
004210     EXEC SQL                                                     
004220           SELECT  ñºèÃ                                           
004230             INTO  :ÇvÇrÅ|ñºèÃÇP                                  
004240             FROM  D19MSY_TBL                                     
004250            WHERE  D19MSY_TBL.ÉRÅ[ÉhÇmÇn = :ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇP    
004260              AND  SUBSTR(D19MSY_TBL.ÉRÅ[Éh,1,1) =                
004270                                    :ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™     
004280     END-EXEC.                                                    
004290                                                                  
004300*--<       SQLCODEîªíËèàóù >                                      
004310     EVALUATE  SQLCODE                                            
004320        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
004330*--<       ê≥èÌ >                                                 
004340           CONTINUE                                               
004350        WHEN  OTHER                                               
004360*--<       ÇsÇ`ÇaÇkÇd  ÇrÇdÇkÇdÇbÇs  ÉGÉâÅ[ >                     
004370           MOVE -60                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004380           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004390     END-EVALUATE.                                                
004400                                                                  
004410     EXEC SQL                                                     
004420           SELECT  D19MSY_TBL.ñºèÃ INTO  :ÇvÇrÅ|ñºèÃÇQ            
004430             FROM  D19MSY_TBL                                     
004440                                                                  
004450            WHERE  D19MSY_TBL.ÉRÅ[ÉhÇmÇn  =  :ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇQ  
004460              AND  SUBSTR(D19MSY_TBL.ÉRÅ[Éh,1,2)    =             
004470                                           :ÇlÇSÇOÅ|å⁄ãqãÊï™      
004480     END-EXEC.                                                    
004490                                                                  
004500*--<       SQLCODEîªíËèàóù >                                      
004510     EVALUATE  SQLCODE                                            
004520        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
004530*--<       ê≥èÌ >                                                 
004540           CONTINUE                                               
004550        WHEN  OTHER                                               
004560*--<       ÇsÇ`ÇaÇkÇd  ÇrÇdÇkÇdÇbÇs  ÉGÉâÅ[ >                     
004570           MOVE -60              TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             
004580           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004590     END-EVALUATE.                                                
004600                                                                  
004610 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóùÅ|ÇdÇwÇhÇs.                      
004620     EXIT.                                                        
004630******************************************************************
004640*    ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù                      *
004650******************************************************************
004660                                                                  
004670 ç¬å†èÓïÒÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù            SECTION.               
004680 ç¬å†èÓïÒÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóùÅ|ÇrÇsÇ`ÇqÇs.                      
004690*                                                                 
004700*--< ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù >                     
004710     EXEC SQL                                                     
004720           SELECT  M01SAJ_TBL.èÛë‘ÉtÉâÉO                          
004730                  ,M01SAJ_TBL.ç¬å†å_ñÒåèñº                        
004740                  ,M01SAJ_TBL.íSï€ãÊï™                            
004750             INTO :ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO                             
004760                  ,:ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº                          
004770                  ,:ÇlÇOÇPÅ|íSï€ãÊï™                              
004780             FROM  M01SAJ_TBL                                     
004790            WHERE  M01SAJ_TBL.ÉåÉRÅ[ÉhãÊï™ =  '1'                 
004800              AND  M01SAJ_TBL.å_ñÒî‘çÜ                            
004810                              =  :ÇlÇSÇOÅ|å_ñÒî‘çÜ                
004820              AND  M01SAJ_TBL.çƒÉäÅ[ÉXâÒêî                        
004830                              =  :ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî            
004840              AND  M01SAJ_TBL.å_ñÒéÌóﬁ                            
004850                              =  :ÇlÇSÇOÅ|å_ñÒéÌóﬁ                
004860     END-EXEC.                                                    
004870                                                                  
004880*--<       SQLCODEîªíËèàóù >                                      
004890     EVALUATE  SQLCODE                                            
004900        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
004910*--<       ê≥èÌ >                                                 
004920           CONTINUE                                               
004930        WHEN  OTHER                                               
004940*--<       ÇsÇ`ÇaÇkÇd  ÇrÇdÇkÇdÇbÇs  ÉGÉâÅ[ >                     
004950           MOVE -70                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004960           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004970     END-EVALUATE.                                                
004980                                                                  
004990 ç¬å†èÓïÒÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóùÅ|ÇdÇwÇhÇs.                        
005000     EXIT.                                                        
005010                                                                  
005020******************************************************************
005030*    éÂèàóù                                                      *
005040******************************************************************
005050 éÂèàóù                               SECTION.                    
005060 éÂèàóùÅ|ÇrÇsÇ`ÇqÇs.                                              
005070*                                                                 
005080*--<     ëOéÛã‡èoóÕèàóù >                                         
005090     IF  ÇlÇSÇOÅ|ëOåéññécçÇ  =  ZERO      AND                     
005100         ÇlÇSÇOÅ|ìñåéâÒé˚äz  =  ZERO      AND                     
005110         ÇlÇSÇOÅ|ìñåéè¡âªäz  =  ZERO      AND                     
005120         ÇlÇSÇOÅ|ìñåéññécçÇ  =  ZERO                              
005130        CONTINUE                                                  
005140     ELSE                                                         
005150                                                                  
005160         PERFORM  ï“èWèoóÕèàóùÇP                                  
005170         PERFORM  èoóÕèàóù                                        
005180       IF ÇlÇOÇPÅ|íSï€ãÊï™  NOT = '1' AND  ÇlÇSÇOÅ|ã¶í≤ãÊï™ = '2' 
005190         PERFORM  ï“èWèoóÕèàóùÇQ                                  
005200         PERFORM  èoóÕèàóù                                        
005210       END-IF                                                     
005220     END-IF.                                                      
005230*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅiÇQåèñ⁄à»ç~Åj >                     
005240     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
005250*                                                                 
005260*                                                                 
005270 éÂèàóùÅ|ÇdÇwÇhÇs.                                                
005280     EXIT.                                                        
005290******************************************************************
005300*     ï“èWèoóÕèàóùÇP                                             *
005310******************************************************************
005320 ï“èWèoóÕèàóùÇP                         SECTION.                  
005330 ï“èWèoóÕèàóùÇPÅ|ÇrÇsÇ`ÇqÇs.                                      
005340*                                                                 
005350*----------------------------------------------------------------*
005360*       èâä˙âªèàóù                                               *
005370*----------------------------------------------------------------*
005380*        MOVE  SPACE                   TO  ïœë•ï•                 
005390*        INITIALIZE                        ïœë•ï•                 
005400*                                                                 
005410*----------------------------------------------------------------*
005420*       çÄñ⁄ï“èWèàóù                                             *
005430*----------------------------------------------------------------*
005440                                                                  
005450      IF  ÇlÇOÇPÅ|íSï€ãÊï™  NOT =  '1'                            
005460        IF  ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO < '3'                              
005470*--<    No.01 >                                                   
005480            MOVE  3  TO  èoóÕÅ|é©ëºé–ãÊï™                         
005490        ELSE                                                      
005500            MOVE  1  TO  èoóÕÅ|é©ëºé–ãÊï™                         
005510*       END-IF                                                    
005520*--<    No.02>                                                    
005530        MOVE  ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™       TO  èoóÕÅ|ëOéÛãÊï™       
005540                                                                  
005550*--<    No.03>                                                    
005560        MOVE  ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™   TO  èoóÕÅ|éÂå_ñÒãÊï™     
005570*                                                                 
005580*--<    No.04>                                                    
005590        MOVE  ÇlÇSÇOÅ|å⁄ãqãÊï™           TO  èoóÕÅ|òAåããÊï™       
005600*                                                                 
005610*--<    No.05>                                                    
005620        MOVE  ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh       TO  èoóÕÅ|ñºäÒÇπÉRÅ[Éh   
005630*                                                                 
005640*--<    No.06>                                                    
005650        MOVE  ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh TO  èoóÕÅ|éÊà¯êÊÉRÅ[Éh   
005660*                                                                 
005670*--<    No.07>                                                    
005680        MOVE  ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh     TO   èoóÕÅ|êøãÅêÊÉRÅ[Éh    
005690*                                                                 
005700*--<    No.08>                                                    
005710        MOVE  ÇlÇSÇOÅ|å_ñÒî‘çÜ         TO   èoóÕÅ|å_ñÒî‘çÜ        
005720*                                                                 
005730*--<    No.09>                                                    
005740        MOVE  ÇlÇSÇOÅ|å_ñÒéÌóﬁ         TO   èoóÕÅ|å_ñÒéÌóﬁ        
005750*                                                                 
005760*--<    No.10>                                                    
005770        MOVE  ÇcÇVÇOÅ|ÉoÉbÉ`ópã∆ñ±îNåé  TO   èoóÕÅ|ã∆ñ±îNåé       
005780*--<    No.11>                                                    
005790        MOVE  ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh  TO   èoóÕÅ|íSìñïîâ€ÉRÅ[Éh   
005800*--<    No.12>                                                    
005810        MOVE  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº    TO   èoóÕÅ|å_ñÒåèñº         
005820*--<    No.13>                                                    
005830        MOVE  ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî    TO   èoóÕÅ|çƒÉäÅ[ÉXâÒêî     
005840*--<    No.14>                                                    
005850        MOVE  ÇlÇSÇOÅ|è[ìñäJénîNåé    TO   èoóÕÅ|è[ìñäJénîNåé     
005860*--<    No.15>                                                    
005870        MOVE  ÇlÇSÇOÅ|è[ìñåéêî        TO   èoóÕÅ|è[ìñåéêî         
005880*--<    No.16>                                                    
005890        MOVE  ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@    TO   èoóÕÅ|ëOï•âÒé˚ï˚ñ@     
005900*--<    No.17>                                                    
005910        MOVE  ÇlÇSÇOÅ|ì¸ã‡ì˙          TO   èoóÕÅ|ì¸ã‡ì˙           
005920*--<    No.18>                                                    
005930        MOVE  ÇlÇSÇOÅ|ì¸ã‡ãÊï™        TO   èoóÕÅ|ì¸ã‡ãÊï™         
005940*--<    No.19>                                                    
005950        MOVE  ÇcÇOÇPÅ|éÊà¯êÊñºèÃ      TO   èoóÕÅ|éÊà¯êÊñºèÃ       
005960*--<    No.20>                                                    
005970        MOVE  ÇcÇOÇQÅ|êøãÅêÊñºèÃ      TO   èoóÕÅ|êøãÅêÊñºèÃ       
005980*--<    No.21>                                                    
005990        MOVE  ÇvÇrÅ|ñºèÃÇP            TO   èoóÕÅ|éÂå_ñÒãÊï™ñºèÃ   
006000*--<    No.22>                                                    
006010        MOVE  ÇvÇrÅ|ñºèÃÇQ           TO   èoóÕÅ|òAåããÊï™ñºèÃ      
006020*--<    No.23>                                                    
006030        MOVE  ÇlÇSÇOÅ|ëOåéññécçÇ      TO   èoóÕÅ|ëOåéññécçÇ       
006040*--<    No.24>                                                    
006050        MOVE  ÇlÇSÇOÅ|ìñåéâÒé˚äz      TO   èoóÕÅ|ìñåéì¸ã‡äz       
006060*--<    No.25>                                                    
006070        MOVE  ÇlÇSÇOÅ|ìñåéè¡âªäz      TO   èoóÕÅ|ìñåéè¡âªäz       
006080*--<    No.26>                                                    
006090        MOVE  ÇlÇSÇOÅ|ìñåéññécçÇ      TO   èoóÕÅ|ìñåéññécçÇ       
006100                                                                  
006110     END-IF.                                                      
006120                                                                  
006130 ï“èWèoóÕèàóùÇPÅ|ÇdÇwÇhÇs.                                        
006140     EXIT.                                                        
006150                                                                  
006160                                                                  
006170******************************************************************
006180*     ï“èWèoóÕèàóùÇQ                                             *
006190******************************************************************
006200 ï“èWèoóÕèàóùÇQ                         SECTION.                  
006210 ï“èWèoóÕèàóùÇQÅ|ÇrÇsÇ`ÇqÇs.                                      
006220*                                                                 
006230*----------------------------------------------------------------*
006240*       èâä˙âªèàóù                                               *
006250*----------------------------------------------------------------*
006260*        MOVE  SPACE                   TO  ïœë•ï•                 
006270*        INITIALIZE                        ïœë•ï•                 
006280*                                                                 
006290*----------------------------------------------------------------*
006300*       çÄñ⁄ï“èWèàóù                                             *
006310*----------------------------------------------------------------*
006320                                                                  
006330      IF  ÇlÇOÇPÅ|íSï€ãÊï™  NOT =  '1'                            
006340        IF  ÇlÇSÇOÅ|ã¶í≤ãÊï™ = '2'                                
006350          IF  ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO < '3'                            
006360*--<      No.01 >                                                 
006370              MOVE  4  TO  èoóÕÅ|é©ëºé–ãÊï™                       
006380          ELSE                                                    
006390              MOVE  2  TO  èoóÕÅ|é©ëºé–ãÊï™                       
006400*         END-IF                                                  
006410*                                                                 
006420*--<      No.02>                                                  
006430          MOVE  ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™       TO  èoóÕÅ|ëOéÛãÊï™     
006440                                                                  
006450*--<      No.03>                                                  
006460          MOVE  ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™   TO  èoóÕÅ|éÂå_ñÒãÊï™   
006470*                                                                 
006480*--<      No.04>                                                  
006490          MOVE  ÇlÇSÇOÅ|å⁄ãqãÊï™           TO  èoóÕÅ|òAåããÊï™     
006500*                                                                 
006510*--<      No.05>                                                  
006520          MOVE  ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh       TO  èoóÕÅ|ñºäÒÇπÉRÅ[Éh 
006530*                                                                 
006540*--<      No.06>                                                  
006550          MOVE  ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh TO  èoóÕÅ|éÊà¯êÊÉRÅ[Éh 
006560*                                                                 
006570*--<      No.07>                                                  
006580          MOVE  ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh     TO   èoóÕÅ|êøãÅêÊÉRÅ[Éh  
006590*                                                                 
006600*--<      No.08>                                                  
006610          MOVE  ÇlÇSÇOÅ|å_ñÒî‘çÜ         TO   èoóÕÅ|å_ñÒî‘çÜ      
006620*                                                                 
006630*--<      No.09>                                                  
006640          MOVE  ÇlÇSÇOÅ|å_ñÒéÌóﬁ         TO   èoóÕÅ|å_ñÒéÌóﬁ      
006650*                                                                 
006660*--<      No.10>                                                  
006670          MOVE  ÇcÇVÇOÅ|ÉoÉbÉ`ópã∆ñ±îNåé  TO   èoóÕÅ|ã∆ñ±îNåé     
006680*--<      No.11>                                                  
006690          MOVE  ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh  TO   èoóÕÅ|íSìñïîâ€ÉRÅ[Éh 
006700*--<      No.12>                                                  
006710          MOVE  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº    TO   èoóÕÅ|å_ñÒåèñº       
006720*--<      No.13>                                                  
006730          MOVE  ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî    TO   èoóÕÅ|çƒÉäÅ[ÉXâÒêî   
006740*--<      No.14>                                                  
006750          MOVE  ÇlÇSÇOÅ|è[ìñäJénîNåé    TO   èoóÕÅ|è[ìñäJénîNåé   
006760*--<      No.15>                                                  
006770          MOVE  ÇlÇSÇOÅ|è[ìñåéêî        TO   èoóÕÅ|è[ìñåéêî       
006780*--<      No.16>                                                  
006790          MOVE  ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@    TO   èoóÕÅ|ëOï•âÒé˚ï˚ñ@   
006800*--<      No.17>                                                  
006810          MOVE  ÇlÇSÇOÅ|ì¸ã‡ì˙          TO   èoóÕÅ|ì¸ã‡ì˙         
006820*--<      No.18>                                                  
006830          MOVE  ÇlÇSÇOÅ|ì¸ã‡ãÊï™        TO   èoóÕÅ|ì¸ã‡ãÊï™       
006840*--<      No.19>                                                  
006850          MOVE  ÇcÇOÇPÅ|éÊà¯êÊñºèÃ      TO   èoóÕÅ|éÊà¯êÊñºèÃ     
006860*--<      No.20>                                                  
006870          MOVE  ÇcÇOÇQÅ|êøãÅêÊñºèÃ      TO   èoóÕÅ|êøãÅêÊñºèÃ     
006880*--<      No.21>                                                  
006890          MOVE  ÇvÇrÅ|ñºèÃÇP            TO   èoóÕÅ|éÂå_ñÒãÊï™ñºèÃ 
006900*--<      No.22>                                                  
006910          MOVE  ÇvÇrÅ|ñºèÃÇQ            TO   èoóÕÅ|òAåããÊï™ñºèÃ   
006920*--<      No.23>                                                  
006930          MOVE  ÇlÇSÇOÅ|ëOåéññécçÇëºé–    TO   èoóÕÅ|ëOåéññécçÇ   
006940*--<      No.24>                                                  
006950          MOVE  ÇlÇSÇOÅ|ìñåéâÒé˚äzëºé–    TO   èoóÕÅ|ìñåéì¸ã‡äz   
006960*--<      No.25>                                                  
006970                                                                  
006980          COMPUTE  èoóÕÅ|ìñåéè¡âªäz = ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–      
006990                                    + ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡  
007000                                    + ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈
007010*--<      No.26>                                                  
007020          COMPUTE  èoóÕÅ|ìñåéññécçÇ = ÇlÇSÇOÅ|ìñåéññécçÇëºé–      
007030                                    + ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡  
007040                                    + ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈
007050       END-IF                                                     
007060     END-IF.                                                      
007070                                                                  
007080 ï“èWèoóÕèàóùÇQÅ|ÇdÇwÇhÇs.                                        
007090     EXIT.                                                        
007100                                                                  
007110******************************************************************
007120*    èoóÕèàóù                                                    *
007130******************************************************************
007140 èoóÕèàóù                             SECTION.                    
007150 èoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
007160*                                                                 
007170     WRITE OUT-FILE.                                              
007180*----------------------------------------------------------------*
007190*    í«â¡èàóùÇämîF                                              *
007200*----------------------------------------------------------------*
007210     EVALUATE  ÉtÉ@ÉCÉãèÛë‘                                       
007220        WHEN  ZERO                                                
007230*                                                                 
007240*--<       í«â¡ê¨å˜ >                                             
007250     COMPUTE  ÇvÅ|èoóÕÅ|åèêî  =  ÇvÅ|èoóÕÅ|åèêî  +  1             
007260        WHEN  OTHER                                               
007270*                                                                 
007280*--<       ÉtÉ@ÉCÉãèoóÕÉGÉâÅ[ >                                   
007290           MOVE  SPACE             TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO       
007300           MOVE  -50               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh           
007310           PERFORM  ÉGÉâÅ[îªíËèàóù                                
007320     END-EVALUATE.                                                
007330*                                                                 
007340 èoóÕèàóùÅ|ÇdÇwÇhÇs.                                              
007350     EXIT.                                                        
007360                                                                  
007370                                                                  
007380******************************************************************
007390*    ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû                                        *
007400******************************************************************
007410 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû                     SECTION.                
007420 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇrÇsÇ`ÇqÇs.                                
007430*                                                                 
007440     EXEC SQL                                                     
007450     SELECT  ÉoÉbÉ`ópã∆ñ±îNåé  INTO  :ÇcÇVÇOÅ|ÉoÉbÉ`ópã∆ñ±îNåé    
007460       FROM  D70GYM_TBL                                           
007470      WHERE  ã∆ñ±ä«óùÇhÇc = :ÇvÇrÅ|ã∆ñ±ä«óùÇhÇc                   
007480     END-EXEC.                                                    
007490                                                                  
007500     EVALUATE  SQLCODE                                            
007510        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
007520*--<       ê≥èÌ >                                                 
007530           CONTINUE                                               
007540        WHEN  OTHER                                               
007550*--<       ÇsÇ`ÇaÇkÇd  ÇrÇdÇkÇdÇbÇs  ÉGÉâÅ[ >                     
007560           MOVE -80                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
007570           PERFORM  ÉGÉâÅ[îªíËèàóù                                
007580     END-EVALUATE.                                                
007590                                                                  
007600                                                                  
007610 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇdÇwÇhÇs.                                  
007620     EXIT.                                                        
007630                                                                  
007640                                                                  
007650******************************************************************
007660*    èIóπèàóù                                                    *
007670******************************************************************
007680 èIóπèàóù                             SECTION.                    
007690 èIóπèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
007700*                                                                 
007710     PERFORM  ÇcÇaÉNÉçÅ[ÉYèàóù.                                   
007720*                                                                 
007730     PERFORM  ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóù.                               
007740                                                                  
007750     PERFORM  åèêîÉÅÉbÉZÅ[ÉWèoóÕ.                                 
007760                                                                  
007770     PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ.                                 
007780*                                                                 
007790*--< ÉvÉçÉOÉâÉÄê≥èÌèIóπ >                                         
007800     MOVE  íËêîÅ|ê≥èÌèÛë‘             TO  PROGRAM-STATUS.         
007810*                                                                 
007820 èIóπèàóùÅ|ÇdÇwÇhÇs.                                              
007830     EXIT.                                                        
007840                                                                  
007850******************************************************************
007860*    åèêîÉÅÉbÉZÅ[ÉWèoóÕ                                          *
007870******************************************************************
007880 åèêîÉÅÉbÉZÅ[ÉWèoóÕ                   SECTION.                    
007890 åèêîÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
007900*                                                                 
007910*----------------------------------------------------------------*
007920*    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
007930*----------------------------------------------------------------*
007940     INITIALIZE                       IF-CHOCO001.                
007950     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007960     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007970     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007980     MOVE  "M40MAB"                   TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007990     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
008000     MOVE  ÇvÅ|ì¸óÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
008010     MOVE  "ÉåÉxÉãÉAÉbÉvç¬å†ìWäJì¸óÕåèêî"                         
008020                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008030     CALL  CLOCO001                USING  IF-CHOCO001.            
008040*                                                                 
008050     INITIALIZE                       IF-CHOCO001.                
008060     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
008070     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
008080     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
008090     MOVE  "SFHSED25"                 TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
008100     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
008110     MOVE  ÇvÅ|èoóÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
008120     MOVE  "ïœë•ï•DBèoóÕåèêî"         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008130     CALL  CLOCO001                USING  IF-CHOCO001.            
008140*                                                                 
008150 åèêîÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
008160     EXIT.                                                        
008170******************************************************************
008180*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
008190******************************************************************
008200 èIóπÉÅÉbÉZÅ[ÉWèoóÕ                   SECTION.                    
008210 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
008220*                                                                 
008230*----------------------------------------------------------------*
008240*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
008250*----------------------------------------------------------------*
008260     INITIALIZE                       IF-CHOCO001.                
008270     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
008280     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
008290     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
008300     MOVE  "END"                      TO  ã§ÇPÅ|èàóùéØï .         
008310     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008320     CALL  CLOCO001                USING  IF-CHOCO001.            
008330*                                                                 
008340 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
008350     EXIT.                                                        
008360******************************************************************
008370*    ÇcÇaÉNÉçÅ[ÉY                                                *
008380******************************************************************
008390 ÇcÇaÉNÉçÅ[ÉYèàóù                     SECTION.                    
008400 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
008410*                                                                 
008420*--< ÉJÅ[É\Éã ÉNÉçÅ[ÉY >                                          
008430     EXEC SQL                                                     
008440        CLOSE  CUR1                                               
008450     END-EXEC.                                                    
008460*                                                                 
008470 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇdÇwÇhÇs.                                      
008480     EXIT.                                                        
008490                                                                  
008500******************************************************************
008510*    ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóù                                        *
008520******************************************************************
008530 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóù                  SECTION.                   
008540 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùÅ|ÇrÇsÇ`ÇqÇs.                                
008550                                                                  
008560*--<       ÉtÉ@ÉCÉãÉNÉçÅ[ÉY >                                     
008570     CLOSE èoóÕÉtÉ@ÉCÉã.                                          
008580*                                                                 
008590 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùÅ|ÇdÇwÇhÇs.                                  
008600     EXIT.                                                        
008610******************************************************************
008620*    ÉGÉâÅ[èàóù                                                  *
008630******************************************************************
008640 ÉGÉâÅ[îªíËèàóù                       SECTION.                    
008650 ÉGÉâÅ[îªíËèàóùÅ|ÇrÇsÇ`ÇqÇs.                                      
008660*                                                                 
008670     MOVE  "Y"                        TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO.    
008680     INITIALIZE                           IF-CHOCO001.            
008690*                                                                 
008700     EVALUATE  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh                                   
008710        WHEN  -10                                                 
008720*--<       ÇnÇqÇ`ÇbÇkÇdê⁄ë±é∏îs >                                 
008730           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008740           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008750           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008760           MOVE  "CONNECT"            TO  ã§ÇPÅ|èàóùéØï           
008770           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008780           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008790           CALL  CLOCO001          USING  IF-CHOCO001             
008800*                                                                 
008810        WHEN  -20                                                 
008820*--<       åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãÉIÅ[ÉvÉìé∏îs >                     
008830           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008840           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008850           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008860           MOVE  "D32SAK"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008870           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008880           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008890           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008900           CALL  CLOCO001          USING  IF-CHOCO001             
008910*                                                                 
008920        WHEN  -30                                                 
008930*--<       åãçáÉeÅ[ÉuÉãì«çûé∏îs >                                 
008940           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008950           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008960           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008970           MOVE  "M40MAB"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008980           MOVE  "FETCH"              TO  ã§ÇPÅ|èàóùéØï           
008990           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009000           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009010           CALL  CLOCO001          USING  IF-CHOCO001             
009020*                                                                 
009030        WHEN  -40                                                 
009040*--<       ÉtÉ@ÉCÉãèÛë‘OPENé∏îs >                                 
009050           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009060           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009070           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009080*          MOVE  "D34HNS"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009090           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
009100*          MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009110           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009120           CALL  CLOCO001          USING  IF-CHOCO001             
009130*                                                                 
009140        WHEN  -50                                                 
009150*--<       ÉtÉ@ÉCÉãèÛë‘WRITEé∏îs >                                
009160           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009170           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009180           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009190*          MOVE  "D34HNS"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009200           MOVE  "WRITE"              TO  ã§ÇPÅ|èàóùéØï           
009210*          MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009220           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009230           CALL  CLOCO001          USING  IF-CHOCO001             
009240                                                                  
009250        WHEN  -60                                                 
009260*--<       åãçáÉeÅ[ÉuÉã çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóùé∏îs >    
009270           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009280           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009290           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009300           MOVE  "D19MSY"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009310           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
009320           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009330           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009340           CALL  CLOCO001          USING  IF-CHOCO001             
009350                                                                  
009360        WHEN  -70                                                 
009370*--<       åãçáÉeÅ[ÉuÉã ç¬å†èÓïÒÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóùé∏îs >      
009380           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009390           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009400           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009410           MOVE  "M01SAJ"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009420           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
009430           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009440           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009450           CALL  CLOCO001          USING  IF-CHOCO001             
009460                                                                  
009470        WHEN  -80                                                 
009480*--<       ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûèàóùé∏îs >                         
009490           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009500           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009510           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009520           MOVE  "D70GYM"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009530           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
009540           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009550           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009560           CALL  CLOCO001          USING  IF-CHOCO001             
009570                                                                  
009580        WHEN  OTHER                                               
009590           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
009600     END-EVALUATE.                                                
009610*                                                                 
009620     IF ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO  =  "Y"                              
009630        PERFORM  ÇcÇaÉNÉçÅ[ÉYèàóù                                 
009640*                                                                 
009650        PERFORM  ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóù                             
009660                                                                  
009670        PERFORM  åèêîÉÅÉbÉZÅ[ÉWèoóÕ                               
009680                                                                  
009690        PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ                               
009700*                                                                 
009710*--<    ÉvÉçÉOÉâÉÄàŸèÌèIóπÇÃÉäÉ^Å[ÉìÉRÅ[Éh >                      
009720        MOVE  íËêîÅ|àŸèÌèÛë‘          TO  PROGRAM-STATUS          
009730*                                                                 
009740        EXIT  PROGRAM                                             
009750     END-IF.                                                      
009760*                                                                 
009770 ÉGÉâÅ[èàóùÅ|ÇdÇwÇhÇs.                                            
009780     EXIT.                                                        
009790******************************************************************
009800*                  END OF PROGRAM                                *
009810******************************************************************
