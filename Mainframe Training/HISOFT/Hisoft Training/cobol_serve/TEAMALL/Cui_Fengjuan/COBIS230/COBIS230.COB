000010******************************************************************
000020*         ÅÉäCãPìÓåè(ëÂòA)ÅÑ                                     *
000030*      1. ÉvÉçÉOÉâÉÄñº  : ï€åØóøó¶É}ÉXÉ^à⁄çsèàóù                 *
000040*      2. ÉvÉçÉOÉâÉÄID  : COBIS230                               *
000050*      3. èàóùäTóv      : SUMMITÉRÅ[ÉhÉ}ÉXÉ^(ìÆéYëççáï€åØóøó¶)ëS *
000060*                         åèÇéÂëÃÇ∆ÇµÇƒÅAï€åØóøó¶É}ÉXÉ^ÇçÏê¨   *
000070*                         Ç∑ÇÈÅB                                 *
000080*                                                                *
000090*      4. çÏê¨é“        : õ¡ñPõN                                 *
000100*      5. çÏê¨ì˙        : 2005.4.01                              *
000110******************************************************************
000120*                                                                 
000130******************************************************************
000140******************************************************************
000150*                                                                 
000160******************************************************************
000170*    ÇhÇcÇdÇmÇsÇhÇeÇhÇbÇ`ÇsÇhÇnÇm  ÇcÇhÇuÇhÇrÇhÇnÇm              *
000180******************************************************************
000190 IDENTIFICATION                       DIVISION.                   
000200*                                                                 
000210 PROGRAM-ID.                          COBIS230.                   
000220******************************************************************
000230*    ÇdÇmÇuÇhÇqÇnÇmÇlÇdÇmÇs        ÇcÇhÇuÇhÇrÇhÇnÇm              *
000240******************************************************************
000250 ENVIRONMENT                          DIVISION.                   
000260******************************************************************
000270*    INPUT-OUTPUT                     SECTION                    *
000280******************************************************************
000290 INPUT-OUTPUT                         SECTION.                    
000300*                                                                 
000310 FILE-CONTROL.                                                    
000320     SELECT  ì¸óÕÉtÉ@ÉCÉã             ASSIGN     TO       U01     
000330     FILE    STATUS         IS        ÇvÅ|èÛë‘                    
000340     ORGANIZATION           IS        LINE        SEQUENTIAL.     
000350******************************************************************
000360*    ÇcÇ`ÇsÇ`                      ÇcÇhÇuÇhÇrÇhÇnÇm              *
000370******************************************************************
000380 DATA                                 DIVISION.                   
000390******************************************************************
000400*            ì¸óÕÉtÉ@ÉCÉã                                        *
000410******************************************************************
000420 FILE                                 SECTION.                    
000430 FD  ì¸óÕÉtÉ@ÉCÉã                                                 
000440     LABEL    RECORD        IS        STANDARD                    
000450     BLOCK   CONTAINS       0         RECORDS.                    
000460*                                                                 
000470 01  ì¸óÕÅ[ÉåÉRÅ[Éh.                                              
000480    COPY   CPBIS018   REPLACING   ==()==  BY  ==ì¸óÕÅ[==.         
000490******************************************************************
000500*  ÇvÇnÇqÇjÇhÇmÇfÅ|ÇrÇsÇnÇqÇ`ÇfÇd  ÇrÇdÇbÇsÇhÇnÇm                *
000510******************************************************************
000520  WORKING-STORAGE                     SECTION.                    
000530*----------------------------------------------------------------*
000540*    ÉzÉXÉgïœêîíËã`ÉGÉäÉA                                        *
000550*----------------------------------------------------------------*
000560*                                                                 
000570     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +34.
           02  SQLFPN-FILENAME PIC X(34) VALUE "C:\COB97\SOC\COBIS230\CO
      -    "BIS230.PCO".

       01  SQ0001 GLOBAL.
           02  FILLER PIC X(64) VALUE "select ï®åèñº   into :b1  from MS
      -    "T_DOSO where ìÆëçï€åØÉRÅ[Éh=:b2".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(160) VALUE  "insert into D10HKR_TBL(ï€åØâÔé–
      -    "ãÊï™,ìKópäJénì˙,ï€åØóøó¶,ï€åØâÔé–ãÊï™ñºèÃ,çXêVì˙éû,çXêVé“,ì¸
      -    "óÕíSìñé“ÉRÅ[Éh,åóì‡ãÊï™,ï∂åæòAî‘,ï€åØâÔé–éØï ÉRÅ[Éh,ì¡íËéÊà¯
      -    "êÊÉRÅ[Éh,".

           02  FILLER PIC X(131) VALUE  "ìoò^îNåéì˙,ìoò^éûä‘,ìoò^íSìñé“,
      -    "çXêVîNåéì˙,çXêVéûä‘) values (:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8
      -    ",:b9,:b10,:b11,:b12,:b13,:b14,:b15,:b16)".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +148525596.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +16.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 16 TIMES.


       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +237.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +241.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +64.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +320.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +90.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +291.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +420.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +169.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +12.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +498.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +184.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +14.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +32.
           02     FILLER PIC S9(4) COMP-5 VALUE +568.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000580*                                                                 
000590 01  ÇvÇrÅ|çXêVì˙éû                   PIC  X(16)  VALUE  ZERO.    
000600 01  ÇvÇrÅ|åóì‡ãÊï™                   PIC  X(01)  VALUE  ZERO.    
000610 01  ÇvÇrÅ|ï∂åæòAî‘                   PIC S9(03)  VALUE  ZERO.    
000620*--< ÇnÇqÇ`ÇbÇkÇdã§í ïœêî >                                       
000630     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
000640*                                                                 
000650*--< ÇnÇqÇ`ÇbÇkÇd  ÇrÇpÇké¿çsèÓïÒ >                               
000010*--ÅÉÇrÇpÇkã§í ïœêîÅÑ
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000660     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000670*                                                                 
000680*--< ï€åØÉ}ÉXÉ^_ìÆëç>                                             
000690     
      *    EXEC  SQL  INCLUDE  MST_DOSO.CBL          END-EXEC.
000700*                                                                 
000710*--< ï€åØóøó¶É}ÉXÉ^ >                                             
000010************************************************
000020* (MST_DOSO)
000030************************************************
000040 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìÆëçï€åØÉRÅ[Éh PIC  X(004).
000050 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìKópì˙Å|ÇP PIC  X(008).
000060 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìÆëçï€åØóøó¶Å|ÇP PIC S9(002)V9(8) COMP-3.
000070 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìKópì˙Å|ÇQ PIC  X(008).
000080 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìÆëçï€åØóøó¶Å|ÇQ PIC S9(002)V9(8) COMP-3.
000090 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìKópì˙Å|ÇR PIC  X(008).
000100 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìÆëçï€åØóøó¶Å|ÇR PIC S9(002)V9(8) COMP-3.
000110 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìKópì˙Å|ÇS PIC  X(008).
000120 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìÆëçï€åØóøó¶Å|ÇS PIC S9(002)V9(8) COMP-3.
000130 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìKópì˙Å|ÇT PIC  X(008).
000140 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìÆëçï€åØóøó¶Å|ÇT PIC S9(002)V9(8) COMP-3.
000150 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìoò^ì˙ PIC  X(008).
000160 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìoò^éûçè PIC  X(006).
000170 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìoò^íSìñé“ÉRÅ[Éh PIC  X(004).
000180 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|çXêVì˙ PIC  X(008).
000190 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|çXêVéûçè PIC  X(006).
000200 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|çXêVíSìñé“ÉRÅ[Éh PIC  X(004).
000210 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|éÊà¯êÊãÊï™ PIC  X(001).
000220 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ï€åØâÔé–ñº PIC  X(040).
000230 01  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ï®åèñº PIC  X(060).
000720     
      *    EXEC  SQL  INCLUDE  D10HKR.CBL            END-EXEC.
000730*                                                                 
      *****************************************************************
      *   ï€åØóøó¶É}ÉXÉ^(D10HKR_TBL)
      *****************************************************************
       01  ï€åØóøó¶É}ÉXÉ^.
           03  ÇcÇPÇOÅ|ï€åØâÔé–ãÊï™  PIC  X(004).
           03  ÇcÇPÇOÅ|ìKópäJénì˙    PIC  X(008).
           03  ÇcÇPÇOÅ|ï€åØóøó¶      PIC S9(002)V9(008) PACKED-DECIMAL.
           03  ÇcÇPÇOÅ|ï€åØâÔé–ãÊï™ñºèÃ
                                     PIC  X(080).
           03  ÇcÇPÇOÅ|çXêVì˙éû      PIC  X(016).
           03  ÇcÇPÇOÅ|çXêVé“        PIC  X(008).
           03  ÇcÇPÇOÅ|ì¸óÕíSìñé“ÉRÅ[Éh
                                     PIC  X(008).
           03  ÇcÇPÇOÅ|åóì‡ãÊï™      PIC  X(001).
           03  ÇcÇPÇOÅ|ï∂åæòAî‘      PIC S9(003) PACKED-DECIMAL.
           03  ÇcÇPÇOÅ|ï€åØâÔé–éØï ÉRÅ[Éh
                                     PIC  X(002).
           03  ÇcÇPÇOÅ|ì¡íËéÊà¯êÊÉRÅ[Éh
                                     PIC  X(002).
           03  ÇcÇPÇOÅ|ìoò^îNåéì˙    PIC  X(008).
           03  ÇcÇPÇOÅ|ìoò^éûä‘      PIC  X(008).
           03  ÇcÇPÇOÅ|ìoò^íSìñé“    PIC  X(008).
           03  ÇcÇPÇOÅ|çXêVîNåéì˙    PIC  X(008).
           03  ÇcÇPÇOÅ|çXêVéûä‘      PIC  X(008).
000740     
      *    EXEC  SQL  END  DECLARE          SECTION  END-EXEC.
000750*                                                                 
000760*----------------------------------------------------------------*
000770*    ÇvÇnÇqÇjÉGÉäÉA                                              *
000780*----------------------------------------------------------------*
000790*                                                                 
000800 01  W-FLAG                           PIC  9(02).                 
000810 01  W-VINT                           PIC  9(02).                 
000820*                                                                 
000830 01  ÇvÇnÇqÇjÅ|ÉGÉäÉA.                                            
000840*--< ÉGÉâÅ[îªíËóp >                                               
000850     03  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             PIC S9(04).                 
000860     03  ÇvÅ|èÛë‘                     PIC X(02).                  
000870*                                                                 
000880*--< ÉtÉâÉOÉAÉäÉA >                                               
000890     03  ÉtÉâÉOÉAÉäÉA.                                            
000900         05  ÇvÅ|èIóπÅ|ÉtÉâÉO         PIC  X(01).                 
000910         05  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     PIC  X(01).                 
000920*                                                                 
000930*--< åèêîÉGÉäÉA >                                                 
000940     03  åèêîÉGÉäÉA.                                              
000950         05  ÇvÅ|ì¸óÕÅ|åèêî           PIC  9(09).                 
000960         05  ÇvÅ|èoóÕÅ|åèêî           PIC  9(09).                 
000970*----------------------------------------------------------------*
000980*   èàóùéûä‘íËã`                                                 *
000990*----------------------------------------------------------------*
001000*--< ã§í èÓïÒ >                                                   
001010 01  ÇvÅ|ã§í èÓïÒ.                                                
001020     03  ÇvÅ|ÉVÉXÉeÉÄì˙ït.                                        
001030         05  ÇvÅ|ê¢ãI                 PIC  X(02) VALUE  "20".     
001040         05  ÇvÅ|îNåéì˙               PIC  X(06).                 
001050     03  ÇvÅ|ÉVÉXÉeÉÄéûçè             PIC  X(08).                 
001060     03  ÇvÅ|íSìñé“                   PIC  X(08) VALUE "IKOPG   ".
001070*                                                                 
001080*----------------------------------------------------------------*
001090*    ÉTÉuÉãÅ[É`Éìñº                                              *
001100*----------------------------------------------------------------*
001110 01  CALL-AREA.                                                   
001120*--< ã§í ÉçÉOÉTÉuÉãÅ[É`Éì >                                       
001130     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001140     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001150*                                                                 
001160*----------------------------------------------------------------*
001170*    ÇbÇnÇoÇxóÃàÊ                                                *
001180*----------------------------------------------------------------*
001190*--< ã§í ÉçÉOópÉpÉâÉÅÅ[É^ >                                       
001200 01  IF-CHOCO001.                                                 
001210     COPY  CHOCO001  REPLACING  ==()==  BY  ==ã§ÇPÅ|==.           
001220*                                                                 
001230*----------------------------------------------------------------*
001240*    ÇhÇmÇhÉtÉ@ÉCÉãì«çûÉTÉuÉãÅ[É`ÉìópÉpÉâÉÅÉ^óÃàÊ                *
001250*----------------------------------------------------------------*
001260 01  PARA-AREA.                                                   
001270     COPY CPBCO001.                                               
001280******************************************************************
001290*    íËêîópÉfÅ[É^íËã`ÉGÉäÉA                                      *
001300******************************************************************
001310 CONSTANT                             SECTION.                    
001320 01  íËêîóÃàÊ.                                                    
001330     03  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc         PIC  X(08) VALUE "COBIS230".
001340     03  íËêîÅ|ÉvÉçÉOÉâÉÄñº           PIC  X(80)                  
001350                                  VALUE  "ï€åØóøó¶É}ÉXÉ^à⁄çsèàóù".
001360     03  íËêîÅ|ÇrÇpÇkÇnÇj             PIC S9(04)  VALUE  ZERO.    
001370     03  íËêîÅ|ÇrÇpÇkÇdÇmÇc           PIC S9(04)  VALUE  0100.    
001380     03  íËêîÅ|ê≥èÌèÛë‘               PIC S9(04)  VALUE  ZERO.    
001390     03  íËêîÅ|àŸèÌèÛë‘               PIC S9(04)  VALUE  0009.    
001400******************************************************************
001410*    ÇoÇqÇnÇbÇdÇcÇtÇqÇd            ÇcÇhÇuÇhÇrÇhÇnÇm              *
001420******************************************************************
001430 PROCEDURE                            DIVISION.                   
001440*                                                                 
001450     PERFORM  èâä˙èàóù.                                           
001460*                                                                 
001470     PERFORM  éÂèàóù  UNTIL  ÇvÅ|èIóπÅ|ÉtÉâÉO  =  "Y".            
001480*                                                                 
001490     PERFORM  èIóπèàóù.                                           
001500*                                                                 
001510     STOP     RUN.                                                
001520*                                                                 
001530******************************************************************
001540*    èâä˙èàóù                                                    *
001550******************************************************************
001560 èâä˙èàóù                             SECTION.                    
001570 èâä˙èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
001580*                                                                 
001590*--< äJénÉÅÉbÉZÅ[ÉWèoóÕ >                                         
001600     PERFORM   äJénÉÅÉbÉZÅ[ÉWèoóÕ.                                
001610*                                                                 
001620*----------------------------------------------------------------*
001630*    çÏã∆óÃàÊÇÃèâä˙ílê›íË                                        *
001640*----------------------------------------------------------------*
001650     MOVE  SPACE                      TO  ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001660     INITIALIZE                           ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001670     MOVE  ZERO                       TO  ÇvÅ|ì¸óÕÅ|åèêî.         
001680     MOVE  ZERO                       TO  ÇvÅ|èoóÕÅ|åèêî.         
001690     MOVE  "N"                        TO  ÇvÅ|èIóπÅ|ÉtÉâÉO.       
001700*                                                                 
001710*--< ÇbÇoÇtì˙ïtÇéÊìæ >                                           
001720     ACCEPT  ÇvÅ|îNåéì˙               FROM  DATE.                 
001730*                                                                 
001740*--< ÇbÇoÇtéûçèÇéÊìæ >                                           
001750     ACCEPT  ÇvÅ|ÉVÉXÉeÉÄéûçè         FROM  TIME.                 
001760*                                                                 
001770*--< ÇnÇqÇ`ÇbÇkÇdê⁄ë± >                                           
001780     PERFORM  ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                                   
001790*                                                                 
001800*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉì >                                           
001810     OPEN  INPUT  ì¸óÕÉtÉ@ÉCÉã.                                   
001820*                                                                 
001830*----------------------------------------------------------------*
001840*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉìèÛë‘îªíË                                    *
001850*----------------------------------------------------------------*
001860     EVALUATE  ÇvÅ|èÛë‘                                           
001870        WHEN  ZERO                                                
001880           CONTINUE                                               
001890        WHEN  OTHER                                               
001900*--<       ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                               
001910           MOVE     -20               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
001920           PERFORM  ÉGÉâÅ[îªíËèàóù                                
001930     END-EVALUATE.                                                
001940*                                                                 
001950*----------------------------------------------------------------*
001960*    ÉRÅ[ÉhÉ}ÉXÉ^ìÆéYëççáï€åØóøó¶ì«çûèàóù(ÇPåèñ⁄)                *
001970*----------------------------------------------------------------*
001980     PERFORM   ìÆéYëççáï€åØóøó¶ì«çûèàóù.                          
001990*                                                                 
002000 èâä˙èàóùÅ|ÇdÇwÇhÇs.                                              
002010     EXIT.                                                        
002020*                                                                 
002030******************************************************************
002040*    äJénÉÅÉbÉZÅ[ÉWèoóÕ                                          *
002050******************************************************************
002060 äJénÉÅÉbÉZÅ[ÉWèoóÕ                   SECTION.                    
002070 äJénÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
002080*                                                                 
002090     INITIALIZE                       IF-CHOCO001.                
002100     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
002110     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
002120     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
002130     MOVE  "START"                    TO  ã§ÇPÅ|èàóùéØï .         
002140     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
002150     CALL  CLOCO001                USING  IF-CHOCO001.            
002160*                                                                 
002170 äJénÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
002180     EXIT.                                                        
002190*                                                                 
002200******************************************************************
002210*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
002220******************************************************************
002230 ÇnÇqÇ`ÇbÇkÇdê⁄ë±                     SECTION.                    
002240 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇrÇsÇ`ÇqÇs.                                    
002250*                                                                 
002260*--< ÇcÇaê⁄ë±ópèÓïÒÇéÊìæèàóù >                                   
002270     CALL  COBCO001                USING  PARA-AREA.              
002280*                                                                 
002290     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002300     MOVE  PARA-USERNAME              TO  USERNAME.               
002310     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002320*                                                                 
002330*----------------------------------------------------------------*
002340*    äJénê⁄ë±                                                    *
002350*----------------------------------------------------------------*
002360     IF    DB-STRING  =  SPACE                                    
002370        
      *       EXEC SQL                                                  
002380*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002390*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002400     ELSE                                                         
002410        
      *       EXEC SQL                                                  
002420*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002430*            USING  :DB-STRING                                    
002440*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002450     END-IF.                                                      
002460*                                                                 
002470*----------------------------------------------------------------*
002480*    ê⁄ë±ämîF                                                    *
002490*----------------------------------------------------------------*
002500     EVALUATE  SQLCODE                                            
002510        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002520           CONTINUE                                               
002530        WHEN   OTHER                                              
002540*--<       ê⁄ë±ÉGÉâÅ[ >                                           
002550           MOVE     -10               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002560           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002570     END-EVALUATE.                                                
002580*                                                                 
002590 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇdÇwÇhÇs.                                      
002600     EXIT.                                                        
002610*                                                                 
002620******************************************************************
002630*    ìÆéYëççáï€åØóøó¶ì«çûèàóù                                    *
002640******************************************************************
002650 ìÆéYëççáï€åØóøó¶ì«çûèàóù             SECTION.                    
002660 ìÆéYëççáï€åØóøó¶ì«çûèàóùÅ|ÇrÇsÇ`ÇqÇs.                            
002670*                                                                 
002680*--<    ìÆéYëççáï€åØóøó¶ì«çû >                                    
002690        READ  ì¸óÕÉtÉ@ÉCÉã                                        
002700           AT  END                                                
002710*--<          ì«çûèIóπ >                                          
002720              MOVE  "Y"               TO  ÇvÅ|èIóπÅ|ÉtÉâÉO        
002730              GO  TO  ìÆéYëççáï€åØóøó¶ì«çûèàóùÅ|ÇdÇwÇhÇs          
002740           NOT  AT  END                                           
002750              COMPUTE  ÇvÅ|ì¸óÕÅ|åèêî = ÇvÅ|ì¸óÕÅ|åèêî + 1        
002760        END-READ.                                                 
002770*                                                                 
002780*----------------------------------------------------------------*
002790*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉìèÛë‘îªíË                                    *
002800*----------------------------------------------------------------*
002810     EVALUATE  ÇvÅ|èÛë‘                                           
002820        WHEN  ZERO                                                
002830           CONTINUE                                               
002840        WHEN  OTHER                                               
002850*--<       ì«Ç›çûÇ›ÉGÉâÅ[ >                                       
002860           MOVE     -30               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002870           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002880     END-EVALUATE.                                                
002890*                                                                 
002900 ìÆéYëççáï€åØóøó¶ì«çûèàóùÅ|ÇdÇwÇhÇs.                              
002910     EXIT.                                                        
002920*                                                                 
002930******************************************************************
002940*    éÂèàóù                                                      *
002950******************************************************************
002960 éÂèàóù                               SECTION.                    
002970 éÂèàóùÅ|ÇrÇsÇ`ÇqÇs.                                              
002980*                                                                 
002990*--< ï€åØÉ}ÉXÉ^_ìÆëçSELECT >                                      
003000     PERFORM  ï€åØÉ}ÉXÉ^ìÆëçì«çûèàóù.                             
003010*                                                                 
003020*--< ï€åØóøó¶É}ÉXÉ^ï“èWèoóÕèàóù >                                 
003030     PERFORM  ï€åØóøó¶É}ÉXÉ^ï“èWèoóÕèàóù.                         
003040*                                                                 
003050*--<ìÆéYëççáï€åØóøó¶ì«çûèàóùÅiÇQåèñ⁄à»ç~) >                       
003060     PERFORM  ìÆéYëççáï€åØóøó¶ì«çûèàóù.                           
003070*                                                                 
003080 éÂèàóùÅ|ÇdÇwÇhÇs.                                                
003090     EXIT.                                                        
003100*                                                                 
003110******************************************************************
003120*    ï€åØÉ}ÉXÉ^_ìÆëçì«çûèàóù                                     *
003130******************************************************************
003140 ï€åØÉ}ÉXÉ^ìÆëçì«çûèàóù               SECTION.                    
003150 ï€åØÉ}ÉXÉ^ìÆëçì«çûèàóùÅ|ÇrÇsÇ`ÇqÇs.                              
003160     MOVE  SPACE                      TO ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ï®åèñº.
003170     MOVE  ì¸óÕÅ[ìÆëçï€åØÉRÅ[Éh       TO                          
003180                                 ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìÆëçï€åØÉRÅ[Éh.
003190*--< ï€åØÉ}ÉXÉ^_ìÆëçì«çû >                                        
003200     
      *    EXEC SQL                                                     
003210*       SELECT  ï®åèñº                                            
003220*         INTO  :ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ï®åèñº                         
003230*         FROM  MST_DOSO                                          
003240*        WHERE  ìÆëçï€åØÉRÅ[Éh = :ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìÆëçï€åØÉRÅ[Éh
003250*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ï®åèñº
               SQL-SQHSTV(1)
           MOVE 60 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ìÆëçï€åØÉRÅ[Éh
               SQL-SQHSTV(2)
           MOVE 4 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
003260*                                                                 
003270     EVALUATE  SQLCODE                                            
003280        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
003290*--<       ê≥èÌ >                                                 
003300           CONTINUE                                               
003310        WHEN  OTHER                                               
003320*--<       ë∂ç›ÇµÇ»Ç¢ >                                           
003330            MOVE     -50              TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003340            PERFORM  ÉGÉâÅ[îªíËèàóù                               
003350     END-EVALUATE.                                                
003360*                                                                 
003370 ìÆéYëççáï€åØóøó¶ì«çûèàóùÅ|ÇdÇwÇhÇs.                              
003380     EXIT.                                                        
003390*                                                                 
003400******************************************************************
003410*    ï€åØóøó¶É}ÉXÉ^ï“èWèoóÕèàóù                                  *
003420******************************************************************
003430 ï€åØóøó¶É}ÉXÉ^ï“èWèoóÕèàóù           SECTION.                    
003440 ï€åØóøó¶É}ÉXÉ^ï“èWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                          
003450     MOVE 1                           TO  W-FLAG.                 
003460*--< NO.1 >                                                       
003470     MOVE  ì¸óÕÅ[ìÆëçï€åØÉRÅ[Éh       TO  ÇcÇPÇOÅ|ï€åØâÔé–ãÊï™.   
003480*--< NO.4 >                                                       
003490     MOVE  ÇlÇrÇsÅ|ÇcÇnÇrÇnÅ|ï®åèñº   TO                          
003500                                    ÇcÇPÇOÅ|ï€åØâÔé–ãÊï™ñºèÃ.     
003510*--< NO.5 >                                                       
003520     MOVE  ÇvÇrÅ|çXêVì˙éû             TO  ÇcÇPÇOÅ|çXêVì˙éû.       
003530*--< NO.6 >                                                       
003540     MOVE  ÇvÅ|íSìñé“                 TO  ÇcÇPÇOÅ|çXêVé“.         
003550*--< NO.7 >                                                       
003560     MOVE  ÇvÅ|íSìñé“                 TO                          
003570                                    ÇcÇPÇOÅ|ì¸óÕíSìñé“ÉRÅ[Éh.     
003580*--< NO.8 >                                                       
003590     MOVE  ÇvÇrÅ|åóì‡ãÊï™             TO  ÇcÇPÇOÅ|åóì‡ãÊï™.       
003600*--< NO.9 >                                                       
003610     MOVE  ÇvÇrÅ|ï∂åæòAî‘             TO  ÇcÇPÇOÅ|ï∂åæòAî‘.       
003620*--< NO.10 >                                                      
003630     MOVE  ì¸óÕÅ[ï€åØâÔé–ÉRÅ[Éh       TO                          
003640                                    ÇcÇPÇOÅ|ï€åØâÔé–éØï ÉRÅ[Éh.   
003650*--< NO.11 >                                                      
003660     MOVE  ZERO                       TO                          
003670                                    ÇcÇPÇOÅ|ì¡íËéÊà¯êÊÉRÅ[Éh.     
003680*--< NO.12 >                                                      
003690     MOVE  ÇvÅ|ÉVÉXÉeÉÄì˙ït           TO  ÇcÇPÇOÅ|ìoò^îNåéì˙.     
003700*--< NO.13 >                                                      
003710     MOVE  ÇvÅ|ÉVÉXÉeÉÄéûçè           TO  ÇcÇPÇOÅ|ìoò^éûä‘.       
003720*--< NO.14 >                                                      
003730     MOVE  ÇvÅ|íSìñé“                 TO  ÇcÇPÇOÅ|ìoò^íSìñé“.     
003740*--< NO.15 >                                                      
003750     MOVE  ÇvÅ|ÉVÉXÉeÉÄì˙ït           TO  ÇcÇPÇOÅ|çXêVîNåéì˙.     
003760*--< NO.16 >                                                      
003770     MOVE  ÇvÅ|ÉVÉXÉeÉÄéûçè           TO  ÇcÇPÇOÅ|çXêVéûä‘.       
003780*                                                                 
003790     PERFORM  ì¸óÕÅ[ìKópîNåéì˙ï“èWèàóù  VARYING  W-VINT  FROM  1  
003800                                        BY  1  UNTIL  W-VINT > 5. 
003810*                                                                 
003820 ï€åØóøó¶É}ÉXÉ^ï“èWèoóÕèàóùÅ|ÇdÇwÇhÇs.                            
003830     EXIT.                                                        
003840*                                                                 
003850******************************************************************
003860*    ì¸óÕÅ[ìKópîNåéì˙ï“èWèàóù                                    *
003870******************************************************************
003880 ì¸óÕÅ[ìKópîNåéì˙ï“èWèàóù             SECTION.                    
003890 ì¸óÕÅ[ìKópîNåéì˙ï“èWèàóùÅ|ÇrÇsÇ`ÇqÇs.                            
003900*                                                                 
003910     MOVE ZERO                        TO  ÇcÇPÇOÅ|ìKópäJénì˙.     
003920*                                                                 
003930     IF ì¸óÕÅ[ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙(W-FLAG) NOT = "000000"   
003940*--<    NO.2 >                                                    
003950        IF  ì¸óÕÅ[ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãI(W-FLAG) = ZERO         
003960           MOVE  "19"                 TO  ÇcÇPÇOÅ|ìKópäJénì˙(1:2) 
003970        ELSE IF  ì¸óÕÅ[ìKópîNåéì˙ÇeÇqÇnÇlÅ|ê¢ãI(W-FLAG) = "1"     
003980           MOVE  "20"                 TO  ÇcÇPÇOÅ|ìKópäJénì˙(1:2) 
003990           END-IF                                                 
004000        END-IF                                                    
004010        MOVE  ì¸óÕÅ[ìKópîNåéì˙ÇeÇqÇnÇlÅ|îNåéì˙(W-FLAG)            
004020                                      TO  ÇcÇPÇOÅ|ìKópäJénì˙(3:6) 
004030*--<    NO.3 >                                                    
004040        MOVE  ì¸óÕÅ[ï€åØóøó¶(W-FLAG)  TO  ÇcÇPÇOÅ|ï€åØóøó¶        
004050*                                                                 
004060        PERFORM  ï€åØóøó¶É}ÉXÉ^èoóÕèàóù                           
004070*                                                                 
004080     END-IF.                                                      
004090     COMPUTE  W-FLAG = W-FLAG + 1.                                
004100*                                                                 
004110 ì¸óÕÅ[ìKópîNåéì˙ï“èWèàóùÅ|ÇdÇwÇhÇs.                              
004120     EXIT.                                                        
004130*                                                                 
004140******************************************************************
004150*    ï€åØóøó¶É}ÉXÉ^èoóÕèàóù                                      *
004160******************************************************************
004170 ï€åØóøó¶É}ÉXÉ^èoóÕèàóù               SECTION.                    
004180 ï€åØóøó¶É}ÉXÉ^èoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                              
004190*                                                                 
004200     
      *    EXEC SQL                                                     
004210*       INSERT INTO  D10HKR_TBL                                   
004220*          (ï€åØâÔé–ãÊï™                                          
004230*          ,ìKópäJénì˙                                            
004240*          ,ï€åØóøó¶                                              
004250*          ,ï€åØâÔé–ãÊï™ñºèÃ                                      
004260*          ,çXêVì˙éû                                              
004270*          ,çXêVé“                                                
004280*          ,ì¸óÕíSìñé“ÉRÅ[Éh                                      
004290*          ,åóì‡ãÊï™                                              
004300*          ,ï∂åæòAî‘                                              
004310*          ,ï€åØâÔé–éØï ÉRÅ[Éh                                    
004320*          ,ì¡íËéÊà¯êÊÉRÅ[Éh                                      
004330*          ,ìoò^îNåéì˙                                            
004340*          ,ìoò^éûä‘                                              
004350*          ,ìoò^íSìñé“                                            
004360*          ,çXêVîNåéì˙                                            
004370*          ,çXêVéûä‘)                                             
004380*       VALUES                                                    
004390*          (:ÇcÇPÇOÅ|ï€åØâÔé–ãÊï™                                 
004400*          ,:ÇcÇPÇOÅ|ìKópäJénì˙                                   
004410*          ,:ÇcÇPÇOÅ|ï€åØóøó¶                                     
004420*          ,:ÇcÇPÇOÅ|ï€åØâÔé–ãÊï™ñºèÃ                             
004430*          ,:ÇcÇPÇOÅ|çXêVì˙éû                                     
004440*          ,:ÇcÇPÇOÅ|çXêVé“                                       
004450*          ,:ÇcÇPÇOÅ|ì¸óÕíSìñé“ÉRÅ[Éh                             
004460*          ,:ÇcÇPÇOÅ|åóì‡ãÊï™                                     
004470*          ,:ÇcÇPÇOÅ|ï∂åæòAî‘                                     
004480*          ,:ÇcÇPÇOÅ|ï€åØâÔé–éØï ÉRÅ[Éh                           
004490*          ,:ÇcÇPÇOÅ|ì¡íËéÊà¯êÊÉRÅ[Éh                             
004500*          ,:ÇcÇPÇOÅ|ìoò^îNåéì˙                                   
004510*          ,:ÇcÇPÇOÅ|ìoò^éûä‘                                     
004520*          ,:ÇcÇPÇOÅ|ìoò^íSìñé“                                   
004530*          ,:ÇcÇPÇOÅ|çXêVîNåéì˙                                   
004540*          ,:ÇcÇPÇOÅ|çXêVéûä‘)                                    
004550*    END-EXEC.
           CALL "SQLADR" USING SQ0002 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 90 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|ï€åØâÔé–ãÊï™ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(1)
           MOVE 4 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|ìKópäJénì˙ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(2)
           MOVE 8 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|ï€åØóøó¶ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(3)
           MOVE 6 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|ï€åØâÔé–ãÊï™ñºèÃ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(4)
           MOVE 80 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|çXêVì˙éû IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(5)
           MOVE 16 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|çXêVé“ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(6)
           MOVE 8 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|ì¸óÕíSìñé“ÉRÅ[Éh IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(7)
           MOVE 8 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|åóì‡ãÊï™ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(8)
           MOVE 1 TO SQL-SQHSTL(8)
           MOVE 0 TO SQL-SQHSTS(8)
           MOVE 0 TO SQL-SQINDV(8)
           MOVE 0 TO SQL-SQINDS(8)
           MOVE 0 TO SQL-SQHARM(8)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|ï∂åæòAî‘ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(9)
           MOVE 2 TO SQL-SQHSTL(9)
           MOVE 0 TO SQL-SQHSTS(9)
           MOVE 0 TO SQL-SQINDV(9)
           MOVE 0 TO SQL-SQINDS(9)
           MOVE 0 TO SQL-SQHARM(9)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|ï€åØâÔé–éØï ÉRÅ[Éh IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(10)
           MOVE 2 TO SQL-SQHSTL(10)
           MOVE 0 TO SQL-SQHSTS(10)
           MOVE 0 TO SQL-SQINDV(10)
           MOVE 0 TO SQL-SQINDS(10)
           MOVE 0 TO SQL-SQHARM(10)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|ì¡íËéÊà¯êÊÉRÅ[Éh IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(11)
           MOVE 2 TO SQL-SQHSTL(11)
           MOVE 0 TO SQL-SQHSTS(11)
           MOVE 0 TO SQL-SQINDV(11)
           MOVE 0 TO SQL-SQINDS(11)
           MOVE 0 TO SQL-SQHARM(11)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|ìoò^îNåéì˙ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(12)
           MOVE 8 TO SQL-SQHSTL(12)
           MOVE 0 TO SQL-SQHSTS(12)
           MOVE 0 TO SQL-SQINDV(12)
           MOVE 0 TO SQL-SQINDS(12)
           MOVE 0 TO SQL-SQHARM(12)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|ìoò^éûä‘ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(13)
           MOVE 8 TO SQL-SQHSTL(13)
           MOVE 0 TO SQL-SQHSTS(13)
           MOVE 0 TO SQL-SQINDV(13)
           MOVE 0 TO SQL-SQINDS(13)
           MOVE 0 TO SQL-SQHARM(13)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|ìoò^íSìñé“ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(14)
           MOVE 8 TO SQL-SQHSTL(14)
           MOVE 0 TO SQL-SQHSTS(14)
           MOVE 0 TO SQL-SQINDV(14)
           MOVE 0 TO SQL-SQINDS(14)
           MOVE 0 TO SQL-SQHARM(14)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|çXêVîNåéì˙ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(15)
           MOVE 8 TO SQL-SQHSTL(15)
           MOVE 0 TO SQL-SQHSTS(15)
           MOVE 0 TO SQL-SQINDV(15)
           MOVE 0 TO SQL-SQINDS(15)
           MOVE 0 TO SQL-SQHARM(15)
           CALL "SQLADR" USING
               ÇcÇPÇOÅ|çXêVéûä‘ IN
               ï€åØóøó¶É}ÉXÉ^
               SQL-SQHSTV(16)
           MOVE 8 TO SQL-SQHSTL(16)
           MOVE 0 TO SQL-SQHSTS(16)
           MOVE 0 TO SQL-SQINDV(16)
           MOVE 0 TO SQL-SQINDS(16)
           MOVE 0 TO SQL-SQHARM(16)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004560*                                                                 
004570*----------------------------------------------------------------*
004580*--< ÇcÇaí«â¡èàóùÇämîF >                                        *
004590*----------------------------------------------------------------*
004600*                                                                 
004610     EVALUATE  SQLCODE                                            
004620*                                                                 
004630*--<    í«â¡ê¨å˜ >                                                
004640        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
004650           COMPUTE  ÇvÅ|èoóÕÅ|åèêî = ÇvÅ|èoóÕÅ|åèêî + 1           
004660*                                                                 
004670*--<    í«â¡é∏îs>                                                 
004680        WHEN  OTHER                                               
004690           MOVE     -40               TO     ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh     
004700           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004710     END-EVALUATE.                                                
004720*                                                                 
004730 ï€åØóøó¶É}ÉXÉ^èoóÕèàóùÅ|ÇdÇwÇhÇs.                                
004740     EXIT.                                                        
004750******************************************************************
004760*    èIóπèàóù                                                    *
004770******************************************************************
004780 èIóπèàóù                             SECTION.                    
004790 èIóπèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
004800*                                                                 
004810*--< ÇcÇaÉRÉ~ÉbÉgèàóù >                                           
004820     PERFORM  ÇcÇaÉRÉ~ÉbÉgèàóù.                                   
004830*                                                                 
004840     PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ.                                 
004850*                                                                 
004860*--< ÉvÉçÉOÉâÉÄê≥èÌèIóπ >                                         
004870     MOVE  íËêîÅ|ê≥èÌèÛë‘             TO  PROGRAM-STATUS.         
004880*                                                                 
004890 èIóπèàóùÅ|ÇdÇwÇhÇs.                                              
004900     EXIT.                                                        
004910*                                                                 
004920******************************************************************
004930*    ÇcÇaÉRÉ~ÉbÉgèàóù                                            *
004940******************************************************************
004950 ÇcÇaÉRÉ~ÉbÉgèàóù                     SECTION.                    
004960 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
004970*                                                                 
004980     
      *    EXEC  SQL                                                    
004990*       COMMIT  WORK  RELEASE                                     
005000*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 169 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005010*                                                                 
005020     INITIALIZE                       IF-CHOCO001.                
005030     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
005040     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
005050     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
005060     MOVE  "COMMIT"                   TO  ã§ÇPÅ|èàóùéØï .         
005070     MOVE  "ÉRÉ~ÉbÉgé¿é{"             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
005080     CALL  CLOCO001                USING  IF-CHOCO001.            
005090*                                                                 
005100 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇdÇwÇhÇs.                                      
005110     EXIT.                                                        
005120*                                                                 
005130******************************************************************
005140*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
005150******************************************************************
005160 èIóπÉÅÉbÉZÅ[ÉWèoóÕ                   SECTION.                    
005170 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
005180*                                                                 
005190*--<ÉtÉ@ÉCÉãÉNÉçÅ[ÉY >                                           *
005200*                                                                 
005210     CLOSE    ì¸óÕÉtÉ@ÉCÉã.                                       
005220*                                                                 
005230*----------------------------------------------------------------*
005240*    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
005250*----------------------------------------------------------------*
005260*                                                                 
005270     INITIALIZE                       IF-CHOCO001.                
005280     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
005290     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
005300     MOVE  ZERO                       TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
005310     MOVE  "FFUIS230"                 TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
005320     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
005330     MOVE  ÇvÅ|ì¸óÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
005340     MOVE  "ÉRÅ[ÉhÉ}ÉXÉ^ìÆéYëççáï€åØóøó¶ì«çûåèêî"                 
005350                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
005360     CALL  CLOCO001                USING  IF-CHOCO001.            
005370*                                                                 
005380     INITIALIZE                       IF-CHOCO001.                
005390     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
005400     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
005410     MOVE  ZERO                       TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
005420     MOVE  "D10HKR_TBL"               TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
005430     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
005440     MOVE  ÇvÅ|èoóÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
005450     MOVE  "ï€åØóøó¶É}ÉXÉ^èoóÕåèêî"   TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
005460     CALL  CLOCO001                USING  IF-CHOCO001.            
005470*                                                                 
005480*----------------------------------------------------------------*
005490*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
005500*----------------------------------------------------------------*
005510     INITIALIZE                       IF-CHOCO001.                
005520     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
005530     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
005540     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
005550     MOVE  "END"                      TO  ã§ÇPÅ|èàóùéØï .         
005560     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
005570     CALL  CLOCO001                USING  IF-CHOCO001.            
005580*                                                                 
005590 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
005600     EXIT.                                                        
005610*                                                                 
005620******************************************************************
005630*    ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                                        *
005640******************************************************************
005650 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                 SECTION.                    
005660 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóùÅ|ÇrÇsÇ`ÇqÇs.                                
005670*                                                                 
005680     
      *    EXEC  SQL                                                    
005690*       ROLLBACK WORK  RELEASE                                    
005700*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 184 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005710*                                                                 
005720     INITIALIZE                       IF-CHOCO001.                
005730     MOVE  "1"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
005740     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
005750     MOVE  "9"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
005760     MOVE  "ROLLBACK"                 TO  ã§ÇPÅ|èàóùéØï .         
005770     MOVE  "ÉçÅ[ÉãÉoÉbÉNé¿é{"         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
005780     CALL  CLOCO001                USING  IF-CHOCO001.            
005790*                                                                 
005800 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóùÅ|ÇdÇwÇhÇs.                                  
005810     EXIT.                                                        
005820*                                                                 
005830******************************************************************
005840*    ÉGÉâÅ[èàóù                                                  *
005850******************************************************************
005860 ÉGÉâÅ[îªíËèàóù                       SECTION.                    
005870 ÉGÉâÅ[îªíËèàóùÅ|ÇrÇsÇ`ÇqÇs.                                      
005880*                                                                 
005890     MOVE  "Y"                        TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO.   
005900     INITIALIZE                           IF-CHOCO001.            
005910*                                                                 
005920     EVALUATE  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh                                   
005930        WHEN  -10                                                 
005940*--<       ÇnÇqÇ`ÇbÇkÇdê⁄ë±é∏îs >                                 
005950           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
005960           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
005970           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
005980           MOVE  "CONNECT"            TO  ã§ÇPÅ|èàóùéØï           
005990           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
006000           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
006010           CALL  CLOCO001          USING  IF-CHOCO001             
006020*                                                                 
006030        WHEN  -20                                                 
006040*--<       ì¸óÕÉtÉ@ÉCÉãÉIÅ[ÉvÉìé∏îs >                             
006050           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
006060           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
006070           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
006080           MOVE  "FFUIS230"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
006090           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
006100           MOVE  ÇvÅ|èÛë‘             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
006110           MOVE  "ì¸óÕÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ["                     
006120                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
006130           CALL  CLOCO001          USING  IF-CHOCO001             
006140*                                                                 
006150        WHEN  -30                                                 
006160*--<       ì¸ÉJÅ[É\ÉãÉIÅ[ÉvÉìé∏îs >                               
006170           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
006180           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
006190           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
006200           MOVE  "FFUIS230"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
006210           MOVE  "READ"               TO  ã§ÇPÅ|èàóùéØï           
006220           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
006230           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
006240           CALL  CLOCO001          USING  IF-CHOCO001             
006250*                                                                 
006260        WHEN  -40                                                 
006270*--<       ï€åØóøó¶É}ÉXÉ^í«â¡é∏îs >                               
006280           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
006290           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
006300           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
006310           MOVE  "D10HKR"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
006320           MOVE  "INSERT"             TO  ã§ÇPÅ|èàóùéØï           
006330           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
006340           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
006350           CALL  CLOCO001          USING  IF-CHOCO001             
006360*                                                                 
006370        WHEN  -50                                                 
006380*--<       ï€åØÉ}ÉXÉ^_ìÆëçì«çûèàóùé∏îs >                          
006390           MOVE  "2"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
006400           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
006410           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
006420           MOVE  "MST_DOSO"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
006430           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
006440           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
006450           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
006460           CALL  CLOCO001          USING  IF-CHOCO001             
006470           MOVE  "N"                  TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO    
006480*                                                                 
006490        WHEN  OTHER                                               
006500           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
006510     END-EVALUATE.                                                
006520*                                                                 
006530     IF ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO  =  "Y"                              
006540        PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ                               
006550*                                                                 
006560*--< ÉçÅ[ÉãÉoÉbÉNèàóù>                                            
006570     PERFORM  ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                                
006580*                                                                 
006590*--<    ÉvÉçÉOÉâÉÄàŸèÌèIóπÇÃÉäÉ^Å[ÉìÉRÅ[Éh >                      
006600        MOVE  íËêîÅ|àŸèÌèÛë‘          TO  PROGRAM-STATUS          
006610*                                                                 
006620        EXIT  PROGRAM                                             
006630*                                                                 
006640     END-IF.                                                      
006650*                                                                 
006660 ÉGÉâÅ[èàóùÅ|ÇdÇwÇhÇs.                                            
006670     EXIT.                                                        
006680******************************************************************
006690*                  END OF PROGRAM                                *
006700******************************************************************
