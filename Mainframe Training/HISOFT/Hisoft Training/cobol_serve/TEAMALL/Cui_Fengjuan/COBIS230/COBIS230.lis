Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

ファイル: C:\COB97\SOC\COBIS230\COBIS230.PCOをオープン
     1  000010******************************************************************
     2  000020*         ＜海輝軟件(大連)＞                                     *
     3  000030*      1. プログラム名  : 保険料率マスタ移行処理                 *
     4  000040*      2. プログラムID  : COBIS230                               *
     5  000050*      3. 処理概要      : SUMMITコードマスタ(動産総合保険料率)全 *
     6  000060*                         件を主体として、保険料率マスタを作成   *
     7  000070*                         する。                                 *
     8  000080*                                                                *
     9  000090*      4. 作成者        : 崔鳳娟                                 *
    10  000100*      5. 作成日        : 2005.4.01                              *
    11  000110******************************************************************
    12  000120*                                                                 
    13  000130******************************************************************
    14  000140******************************************************************
    15  000150*                                                                 
    16  000160******************************************************************
    17  000170*    ＩＤＥＮＴＩＦＩＣＡＴＩＯＮ  ＤＩＶＩＳＩＯＮ              *
    18  000180******************************************************************
    19  000190 IDENTIFICATION                       DIVISION.                   
    20  000200*                                                                 
    21  000210 PROGRAM-ID.                          COBIS230.                   
    22  000220******************************************************************
    23  000230*    ＥＮＶＩＲＯＮＭＥＮＴ        ＤＩＶＩＳＩＯＮ              *
    24  000240******************************************************************
    25  000250 ENVIRONMENT                          DIVISION.                   
    26  000260******************************************************************
    27  000270*    INPUT-OUTPUT                     SECTION                    *
    28  000280******************************************************************
    29  000290 INPUT-OUTPUT                         SECTION.                    
    30  000300*                                                                 
    31  000310 FILE-CONTROL.                                                    
    32  000320     SELECT  入力ファイル             ASSIGN     TO       U01     
    33  000330     FILE    STATUS         IS        Ｗ−状態                    
    34  000340     ORGANIZATION           IS        LINE        SEQUENTIAL.     
    35  000350******************************************************************
    36  000360*    ＤＡＴＡ                      ＤＩＶＩＳＩＯＮ              *
    37  000370******************************************************************
    38  000380 DATA                                 DIVISION.                   
    39  000390******************************************************************
    40  000400*            入力ファイル                                        *
    41  000410******************************************************************
    42  000420 FILE                                 SECTION.                    
    43  000430 FD  入力ファイル                                                 
    44  000440     LABEL    RECORD        IS        STANDARD                    
    45  000450     BLOCK   CONTAINS       0         RECORDS.                    
    46  000460*                                                                 
    47  000470 01  入力ーレコード.                                              
    48  000480    COPY   CPBIS018   REPLACING   ==()==  BY  ==入力ー==.         
    49  000490******************************************************************
    50  000500*  ＷＯＲＫＩＮＧ−ＳＴＯＲＡＧＥ  ＳＥＣＴＩＯＮ                *
    51  000510******************************************************************
    52  000520  WORKING-STORAGE                     SECTION.                    
    53  000530*----------------------------------------------------------------*
    54  000540*    ホスト変数定義エリア                                        *
    55  000550*----------------------------------------------------------------*
    56  000560*                                                                 
    57  000570     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
    58  000580*                                                                 
    59  000590 01  ＷＳ−更新日時                   PIC  X(16)  VALUE  ZERO.    
    60  000600 01  ＷＳ−圏内区分                   PIC  X(01)  VALUE  ZERO.    
    61  000610 01  ＷＳ−文言連番                   PIC S9(03)  VALUE  ZERO.    
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    62  000620*--< ＯＲＡＣＬＥ共通変数 >                                       
    63  000630     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
    64  000640*                                                                 
    65  000650*--< ＯＲＡＣＬＥ  ＳＱＬ実行情報 >                               
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをオープン
     1  000010*--＜ＳＱＬ共通変数＞
     2  000030   01  SQLSTATE                      PIC  X(005).
     3  000040   01  DB-STRING                     PIC  X(020).
     4  000050   01  USERNAME                      PIC  X(010).
     5  000060   01  PASSWD                        PIC  X(010).
     6  000070*
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをクローズ
    66  000660     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
    67  000670*                                                                 
    68  000680*--< 保険マスタ_動総>                                             
    69  000690     EXEC  SQL  INCLUDE  MST_DOSO.CBL          END-EXEC.          
    70  000700*                                                                 
    71  000710*--< 保険料率マスタ >                                             
ファイル: Z:\COB97\COPYLIB_DB\MST_DOSO.CBLをオープン
     1  000010************************************************
     2  000020* (MST_DOSO)
     3  000030************************************************
     4  000040 01  ＭＳＴ−ＤＯＳＯ−動総保険コード PIC  X(004).
     5  000050 01  ＭＳＴ−ＤＯＳＯ−適用日−１ PIC  X(008).
     6  000060 01  ＭＳＴ−ＤＯＳＯ−動総保険料率−１ PIC S9(002)V9(8) COMP-3.
     7  000070 01  ＭＳＴ−ＤＯＳＯ−適用日−２ PIC  X(008).
     8  000080 01  ＭＳＴ−ＤＯＳＯ−動総保険料率−２ PIC S9(002)V9(8) COMP-3.
     9  000090 01  ＭＳＴ−ＤＯＳＯ−適用日−３ PIC  X(008).
    10  000100 01  ＭＳＴ−ＤＯＳＯ−動総保険料率−３ PIC S9(002)V9(8) COMP-3.
    11  000110 01  ＭＳＴ−ＤＯＳＯ−適用日−４ PIC  X(008).
    12  000120 01  ＭＳＴ−ＤＯＳＯ−動総保険料率−４ PIC S9(002)V9(8) COMP-3.
    13  000130 01  ＭＳＴ−ＤＯＳＯ−適用日−５ PIC  X(008).
    14  000140 01  ＭＳＴ−ＤＯＳＯ−動総保険料率−５ PIC S9(002)V9(8) COMP-3.
    15  000150 01  ＭＳＴ−ＤＯＳＯ−登録日 PIC  X(008).
    16  000160 01  ＭＳＴ−ＤＯＳＯ−登録時刻 PIC  X(006).
    17  000170 01  ＭＳＴ−ＤＯＳＯ−登録担当者コード PIC  X(004).
    18  000180 01  ＭＳＴ−ＤＯＳＯ−更新日 PIC  X(008).
    19  000190 01  ＭＳＴ−ＤＯＳＯ−更新時刻 PIC  X(006).
    20  000200 01  ＭＳＴ−ＤＯＳＯ−更新担当者コード PIC  X(004).
    21  000210 01  ＭＳＴ−ＤＯＳＯ−取引先区分 PIC  X(001).
    22  000220 01  ＭＳＴ−ＤＯＳＯ−保険会社名 PIC  X(040).
    23  000230 01  ＭＳＴ−ＤＯＳＯ−物件名 PIC  X(060).
ファイル: Z:\COB97\COPYLIB_DB\MST_DOSO.CBLをクローズ
    72  000720     EXEC  SQL  INCLUDE  D10HKR.CBL            END-EXEC.          
    73  000730*                                                                 
ファイル: Z:\COB97\COPYLIB_DB\D10HKR.CBLをオープン
     1        *****************************************************************
     2        *   保険料率マスタ(D10HKR_TBL)
     3        *****************************************************************
     4         01  保険料率マスタ.
     5             03  Ｄ１０−保険会社区分  PIC  X(004).
     6             03  Ｄ１０−適用開始日    PIC  X(008).
     7             03  Ｄ１０−保険料率      PIC S9(002)V9(008) PACKED-DECIMAL.
     8             03  Ｄ１０−保険会社区分名称
     9                                       PIC  X(080).
    10             03  Ｄ１０−更新日時      PIC  X(016).
    11             03  Ｄ１０−更新者        PIC  X(008).
    12             03  Ｄ１０−入力担当者コード
    13                                       PIC  X(008).
    14             03  Ｄ１０−圏内区分      PIC  X(001).
    15             03  Ｄ１０−文言連番      PIC S9(003) PACKED-DECIMAL.
    16             03  Ｄ１０−保険会社識別コード
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    17                                       PIC  X(002).
    18             03  Ｄ１０−特定取引先コード
    19                                       PIC  X(002).
    20             03  Ｄ１０−登録年月日    PIC  X(008).
    21             03  Ｄ１０−登録時間      PIC  X(008).
    22             03  Ｄ１０−登録担当者    PIC  X(008).
    23             03  Ｄ１０−更新年月日    PIC  X(008).
    24             03  Ｄ１０−更新時間      PIC  X(008).
ファイル: Z:\COB97\COPYLIB_DB\D10HKR.CBLをクローズ
    74  000740     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
    75  000750*                                                                 
    76  000760*----------------------------------------------------------------*
    77  000770*    ＷＯＲＫエリア                                              *
    78  000780*----------------------------------------------------------------*
    79  000790*                                                                 
    80  000800 01  W-FLAG                           PIC  9(02).                 
    81  000810 01  W-VINT                           PIC  9(02).                 
    82  000820*                                                                 
    83  000830 01  ＷＯＲＫ−エリア.                                            
    84  000840*--< エラー判定用 >                                               
    85  000850     03  Ｗ−エラーコード             PIC S9(04).                 
    86  000860     03  Ｗ−状態                     PIC X(02).                  
    87  000870*                                                                 
    88  000880*--< フラグアリア >                                               
    89  000890     03  フラグアリア.                                            
    90  000900         05  Ｗ−終了−フラグ         PIC  X(01).                 
    91  000910         05  Ｗ−異常終了−フラグ     PIC  X(01).                 
    92  000920*                                                                 
    93  000930*--< 件数エリア >                                                 
    94  000940     03  件数エリア.                                              
    95  000950         05  Ｗ−入力−件数           PIC  9(09).                 
    96  000960         05  Ｗ−出力−件数           PIC  9(09).                 
    97  000970*----------------------------------------------------------------*
    98  000980*   処理時間定義                                                 *
    99  000990*----------------------------------------------------------------*
   100  001000*--< 共通情報 >                                                   
   101  001010 01  Ｗ−共通情報.                                                
   102  001020     03  Ｗ−システム日付.                                        
   103  001030         05  Ｗ−世紀                 PIC  X(02) VALUE  "20".     
   104  001040         05  Ｗ−年月日               PIC  X(06).                 
   105  001050     03  Ｗ−システム時刻             PIC  X(08).                 
   106  001060     03  Ｗ−担当者                   PIC  X(08) VALUE "IKOPG   ".
   107  001070*                                                                 
   108  001080*----------------------------------------------------------------*
   109  001090*    サブルーチン名                                              *
   110  001100*----------------------------------------------------------------*
   111  001110 01  CALL-AREA.                                                   
   112  001120*--< 共通ログサブルーチン >                                       
   113  001130     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
   114  001140     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
   115  001150*                                                                 
   116  001160*----------------------------------------------------------------*
   117  001170*    ＣＯＰＹ領域                                                *
   118  001180*----------------------------------------------------------------*
   119  001190*--< 共通ログ用パラメータ >                                       
   120  001200 01  IF-CHOCO001.                                                 
   121  001210     COPY  CHOCO001  REPLACING  ==()==  BY  ==共１−==.           
   122  001220*                                                                 
   123  001230*----------------------------------------------------------------*
   124  001240*    ＩＮＩファイル読込サブルーチン用パラメタ領域                *
   125  001250*----------------------------------------------------------------*
   126  001260 01  PARA-AREA.                                                   
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   127  001270     COPY CPBCO001.                                               
   128  001280******************************************************************
   129  001290*    定数用データ定義エリア                                      *
   130  001300******************************************************************
   131  001310 CONSTANT                             SECTION.                    
   132  001320 01  定数領域.                                                    
   133  001330     03  定数−プログラムＩＤ         PIC  X(08) VALUE "COBIS230".
   134  001340     03  定数−プログラム名           PIC  X(80)                  
   135  001350                                  VALUE  "保険料率マスタ移行処理".
   136  001360     03  定数−ＳＱＬＯＫ             PIC S9(04)  VALUE  ZERO.    
   137  001370     03  定数−ＳＱＬＥＮＤ           PIC S9(04)  VALUE  0100.    
   138  001380     03  定数−正常状態               PIC S9(04)  VALUE  ZERO.    
   139  001390     03  定数−異常状態               PIC S9(04)  VALUE  0009.    
   140  001400******************************************************************
   141  001410*    ＰＲＯＣＥＤＵＲＥ            ＤＩＶＩＳＩＯＮ              *
   142  001420******************************************************************
   143  001430 PROCEDURE                            DIVISION.                   
   144  001440*                                                                 
   145  001450     PERFORM  初期処理.                                           
   146  001460*                                                                 
   147  001470     PERFORM  主処理  UNTIL  Ｗ−終了−フラグ  =  "Y".            
   148  001480*                                                                 
   149  001490     PERFORM  終了処理.                                           
   150  001500*                                                                 
   151  001510     STOP     RUN.                                                
   152  001520*                                                                 
   153  001530******************************************************************
   154  001540*    初期処理                                                    *
   155  001550******************************************************************
   156  001560 初期処理                             SECTION.                    
   157  001570 初期処理−ＳＴＡＲＴ.                                            
   158  001580*                                                                 
   159  001590*--< 開始メッセージ出力 >                                         
   160  001600     PERFORM   開始メッセージ出力.                                
   161  001610*                                                                 
   162  001620*----------------------------------------------------------------*
   163  001630*    作業領域の初期値設定                                        *
   164  001640*----------------------------------------------------------------*
   165  001650     MOVE  SPACE                      TO  ＷＯＲＫ−エリア.       
   166  001660     INITIALIZE                           ＷＯＲＫ−エリア.       
   167  001670     MOVE  ZERO                       TO  Ｗ−入力−件数.         
   168  001680     MOVE  ZERO                       TO  Ｗ−出力−件数.         
   169  001690     MOVE  "N"                        TO  Ｗ−終了−フラグ.       
   170  001700*                                                                 
   171  001710*--< ＣＰＵ日付を取得 >                                           
   172  001720     ACCEPT  Ｗ−年月日               FROM  DATE.                 
   173  001730*                                                                 
   174  001740*--< ＣＰＵ時刻を取得 >                                           
   175  001750     ACCEPT  Ｗ−システム時刻         FROM  TIME.                 
   176  001760*                                                                 
   177  001770*--< ＯＲＡＣＬＥ接続 >                                           
   178  001780     PERFORM  ＯＲＡＣＬＥ接続.                                   
   179  001790*                                                                 
   180  001800*--< ファイルオープン >                                           
   181  001810     OPEN  INPUT  入力ファイル.                                   
   182  001820*                                                                 
   183  001830*----------------------------------------------------------------*
   184  001840*    ファイルオープン状態判定                                    *
   185  001850*----------------------------------------------------------------*
   186  001860     EVALUATE  Ｗ−状態                                           
   187  001870        WHEN  ZERO                                                
   188  001880           CONTINUE                                               
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   189  001890        WHEN  OTHER                                               
   190  001900*--<       ファイルオープンエラー >                               
   191  001910           MOVE     -20               TO  Ｗ−エラーコード        
   192  001920           PERFORM  エラー判定処理                                
   193  001930     END-EVALUATE.                                                
   194  001940*                                                                 
   195  001950*----------------------------------------------------------------*
   196  001960*    コードマスタ動産総合保険料率読込処理(１件目)                *
   197  001970*----------------------------------------------------------------*
   198  001980     PERFORM   動産総合保険料率読込処理.                          
   199  001990*                                                                 
   200  002000 初期処理−ＥＸＩＴ.                                              
   201  002010     EXIT.                                                        
   202  002020*                                                                 
   203  002030******************************************************************
   204  002040*    開始メッセージ出力                                          *
   205  002050******************************************************************
   206  002060 開始メッセージ出力                   SECTION.                    
   207  002070 開始メッセージ出力−ＳＴＡＲＴ.                                  
   208  002080*                                                                 
   209  002090     INITIALIZE                       IF-CHOCO001.                
   210  002100     MOVE  "3"                        TO  共１−イベント種別.     
   211  002110     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   212  002120     MOVE  "0"                        TO  共１−復帰コード.       
   213  002130     MOVE  "START"                    TO  共１−処理識別.         
   214  002140     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
   215  002150     CALL  CLOCO001                USING  IF-CHOCO001.            
   216  002160*                                                                 
   217  002170 開始メッセージ出力−ＥＸＩＴ.                                    
   218  002180     EXIT.                                                        
   219  002190*                                                                 
   220  002200******************************************************************
   221  002210*    ＯＲＡＣＬＥ接続                                            *
   222  002220******************************************************************
   223  002230 ＯＲＡＣＬＥ接続                     SECTION.                    
   224  002240 ＯＲＡＣＬＥ接続−ＳＴＡＲＴ.                                    
   225  002250*                                                                 
   226  002260*--< ＤＢ接続用情報を取得処理 >                                   
   227  002270     CALL  COBCO001                USING  PARA-AREA.              
   228  002280*                                                                 
   229  002290     MOVE  PARA-DBSTRING              TO  DB-STRING.              
   230  002300     MOVE  PARA-USERNAME              TO  USERNAME.               
   231  002310     MOVE  PARA-PASSWORD              TO  PASSWD.                 
   232  002320*                                                                 
   233  002330*----------------------------------------------------------------*
   234  002340*    開始接続                                                    *
   235  002350*----------------------------------------------------------------*
   236  002360     IF    DB-STRING  =  SPACE                                    
   237  002370        EXEC SQL                                                  
   238  002380           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   239  002390        END-EXEC                                                  
   240  002400     ELSE                                                         
   241  002410        EXEC SQL                                                  
   242  002420           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   243  002430             USING  :DB-STRING                                    
   244  002440        END-EXEC                                                  
   245  002450     END-IF.                                                      
   246  002460*                                                                 
   247  002470*----------------------------------------------------------------*
   248  002480*    接続確認                                                    *
   249  002490*----------------------------------------------------------------*
   250  002500     EVALUATE  SQLCODE                                            
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   251  002510        WHEN   定数−ＳＱＬＯＫ                                   
   252  002520           CONTINUE                                               
   253  002530        WHEN   OTHER                                              
   254  002540*--<       接続エラー >                                           
   255  002550           MOVE     -10               TO  Ｗ−エラーコード        
   256  002560           PERFORM  エラー判定処理                                
   257  002570     END-EVALUATE.                                                
   258  002580*                                                                 
   259  002590 ＯＲＡＣＬＥ接続−ＥＸＩＴ.                                      
   260  002600     EXIT.                                                        
   261  002610*                                                                 
   262  002620******************************************************************
   263  002630*    動産総合保険料率読込処理                                    *
   264  002640******************************************************************
   265  002650 動産総合保険料率読込処理             SECTION.                    
   266  002660 動産総合保険料率読込処理−ＳＴＡＲＴ.                            
   267  002670*                                                                 
   268  002680*--<    動産総合保険料率読込 >                                    
   269  002690        READ  入力ファイル                                        
   270  002700           AT  END                                                
   271  002710*--<          読込終了 >                                          
   272  002720              MOVE  "Y"               TO  Ｗ−終了−フラグ        
   273  002730              GO  TO  動産総合保険料率読込処理−ＥＸＩＴ          
   274  002740           NOT  AT  END                                           
   275  002750              COMPUTE  Ｗ−入力−件数 = Ｗ−入力−件数 + 1        
   276  002760        END-READ.                                                 
   277  002770*                                                                 
   278  002780*----------------------------------------------------------------*
   279  002790*    ファイルオープン状態判定                                    *
   280  002800*----------------------------------------------------------------*
   281  002810     EVALUATE  Ｗ−状態                                           
   282  002820        WHEN  ZERO                                                
   283  002830           CONTINUE                                               
   284  002840        WHEN  OTHER                                               
   285  002850*--<       読み込みエラー >                                       
   286  002860           MOVE     -30               TO  Ｗ−エラーコード        
   287  002870           PERFORM  エラー判定処理                                
   288  002880     END-EVALUATE.                                                
   289  002890*                                                                 
   290  002900 動産総合保険料率読込処理−ＥＸＩＴ.                              
   291  002910     EXIT.                                                        
   292  002920*                                                                 
   293  002930******************************************************************
   294  002940*    主処理                                                      *
   295  002950******************************************************************
   296  002960 主処理                               SECTION.                    
   297  002970 主処理−ＳＴＡＲＴ.                                              
   298  002980*                                                                 
   299  002990*--< 保険マスタ_動総SELECT >                                      
   300  003000     PERFORM  保険マスタ動総読込処理.                             
   301  003010*                                                                 
   302  003020*--< 保険料率マスタ編集出力処理 >                                 
   303  003030     PERFORM  保険料率マスタ編集出力処理.                         
   304  003040*                                                                 
   305  003050*--<動産総合保険料率読込処理（２件目以降) >                       
   306  003060     PERFORM  動産総合保険料率読込処理.                           
   307  003070*                                                                 
   308  003080 主処理−ＥＸＩＴ.                                                
   309  003090     EXIT.                                                        
   310  003100*                                                                 
   311  003110******************************************************************
   312  003120*    保険マスタ_動総読込処理                                     *
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   313  003130******************************************************************
   314  003140 保険マスタ動総読込処理               SECTION.                    
   315  003150 保険マスタ動総読込処理−ＳＴＡＲＴ.                              
   316  003160     MOVE  SPACE                      TO ＭＳＴ−ＤＯＳＯ−物件名.
   317  003170     MOVE  入力ー動総保険コード       TO                          
   318  003180                                 ＭＳＴ−ＤＯＳＯ−動総保険コード.
   319  003190*--< 保険マスタ_動総読込 >                                        
   320  003200     EXEC SQL                                                     
   321  003210        SELECT  物件名                                            
   322  003220          INTO  :ＭＳＴ−ＤＯＳＯ−物件名                         
   323  003230          FROM  MST_DOSO                                          
   324  003240         WHERE  動総保険コード = :ＭＳＴ−ＤＯＳＯ−動総保険コード
   325  003250     END-EXEC.                                                    
   326  003260*                                                                 
   327  003270     EVALUATE  SQLCODE                                            
   328  003280        WHEN  定数−ＳＱＬＯＫ                                    
   329  003290*--<       正常 >                                                 
   330  003300           CONTINUE                                               
   331  003310        WHEN  OTHER                                               
   332  003320*--<       存在しない >                                           
   333  003330            MOVE     -50              TO  Ｗ−エラーコード        
   334  003340            PERFORM  エラー判定処理                               
   335  003350     END-EVALUATE.                                                
   336  003360*                                                                 
   337  003370 動産総合保険料率読込処理−ＥＸＩＴ.                              
   338  003380     EXIT.                                                        
   339  003390*                                                                 
   340  003400******************************************************************
   341  003410*    保険料率マスタ編集出力処理                                  *
   342  003420******************************************************************
   343  003430 保険料率マスタ編集出力処理           SECTION.                    
   344  003440 保険料率マスタ編集出力処理−ＳＴＡＲＴ.                          
   345  003450     MOVE 1                           TO  W-FLAG.                 
   346  003460*--< NO.1 >                                                       
   347  003470     MOVE  入力ー動総保険コード       TO  Ｄ１０−保険会社区分.   
   348  003480*--< NO.4 >                                                       
   349  003490     MOVE  ＭＳＴ−ＤＯＳＯ−物件名   TO                          
   350  003500                                    Ｄ１０−保険会社区分名称.     
   351  003510*--< NO.5 >                                                       
   352  003520     MOVE  ＷＳ−更新日時             TO  Ｄ１０−更新日時.       
   353  003530*--< NO.6 >                                                       
   354  003540     MOVE  Ｗ−担当者                 TO  Ｄ１０−更新者.         
   355  003550*--< NO.7 >                                                       
   356  003560     MOVE  Ｗ−担当者                 TO                          
   357  003570                                    Ｄ１０−入力担当者コード.     
   358  003580*--< NO.8 >                                                       
   359  003590     MOVE  ＷＳ−圏内区分             TO  Ｄ１０−圏内区分.       
   360  003600*--< NO.9 >                                                       
   361  003610     MOVE  ＷＳ−文言連番             TO  Ｄ１０−文言連番.       
   362  003620*--< NO.10 >                                                      
   363  003630     MOVE  入力ー保険会社コード       TO                          
   364  003640                                    Ｄ１０−保険会社識別コード.   
   365  003650*--< NO.11 >                                                      
   366  003660     MOVE  ZERO                       TO                          
   367  003670                                    Ｄ１０−特定取引先コード.     
   368  003680*--< NO.12 >                                                      
   369  003690     MOVE  Ｗ−システム日付           TO  Ｄ１０−登録年月日.     
   370  003700*--< NO.13 >                                                      
   371  003710     MOVE  Ｗ−システム時刻           TO  Ｄ１０−登録時間.       
   372  003720*--< NO.14 >                                                      
   373  003730     MOVE  Ｗ−担当者                 TO  Ｄ１０−登録担当者.     
   374  003740*--< NO.15 >                                                      
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   375  003750     MOVE  Ｗ−システム日付           TO  Ｄ１０−更新年月日.     
   376  003760*--< NO.16 >                                                      
   377  003770     MOVE  Ｗ−システム時刻           TO  Ｄ１０−更新時間.       
   378  003780*                                                                 
   379  003790     PERFORM  入力ー適用年月日編集処理  VARYING  W-VINT  FROM  1  
   380  003800                                        BY  1  UNTIL  W-VINT > 5. 
   381  003810*                                                                 
   382  003820 保険料率マスタ編集出力処理−ＥＸＩＴ.                            
   383  003830     EXIT.                                                        
   384  003840*                                                                 
   385  003850******************************************************************
   386  003860*    入力ー適用年月日編集処理                                    *
   387  003870******************************************************************
   388  003880 入力ー適用年月日編集処理             SECTION.                    
   389  003890 入力ー適用年月日編集処理−ＳＴＡＲＴ.                            
   390  003900*                                                                 
   391  003910     MOVE ZERO                        TO  Ｄ１０−適用開始日.     
   392  003920*                                                                 
   393  003930     IF 入力ー適用年月日ＦＲＯＭ−年月日(W-FLAG) NOT = "000000"   
   394  003940*--<    NO.2 >                                                    
   395  003950        IF  入力ー適用年月日ＦＲＯＭ−世紀(W-FLAG) = ZERO         
   396  003960           MOVE  "19"                 TO  Ｄ１０−適用開始日(1:2) 
   397  003970        ELSE IF  入力ー適用年月日ＦＲＯＭ−世紀(W-FLAG) = "1"     
   398  003980           MOVE  "20"                 TO  Ｄ１０−適用開始日(1:2) 
   399  003990           END-IF                                                 
   400  004000        END-IF                                                    
   401  004010        MOVE  入力ー適用年月日ＦＲＯＭ−年月日(W-FLAG)            
   402  004020                                      TO  Ｄ１０−適用開始日(3:6) 
   403  004030*--<    NO.3 >                                                    
   404  004040        MOVE  入力ー保険料率(W-FLAG)  TO  Ｄ１０−保険料率        
   405  004050*                                                                 
   406  004060        PERFORM  保険料率マスタ出力処理                           
   407  004070*                                                                 
   408  004080     END-IF.                                                      
   409  004090     COMPUTE  W-FLAG = W-FLAG + 1.                                
   410  004100*                                                                 
   411  004110 入力ー適用年月日編集処理−ＥＸＩＴ.                              
   412  004120     EXIT.                                                        
   413  004130*                                                                 
   414  004140******************************************************************
   415  004150*    保険料率マスタ出力処理                                      *
   416  004160******************************************************************
   417  004170 保険料率マスタ出力処理               SECTION.                    
   418  004180 保険料率マスタ出力処理−ＳＴＡＲＴ.                              
   419  004190*                                                                 
   420  004200     EXEC SQL                                                     
   421  004210        INSERT INTO  D10HKR_TBL                                   
   422  004220           (保険会社区分                                          
   423  004230           ,適用開始日                                            
   424  004240           ,保険料率                                              
   425  004250           ,保険会社区分名称                                      
   426  004260           ,更新日時                                              
   427  004270           ,更新者                                                
   428  004280           ,入力担当者コード                                      
   429  004290           ,圏内区分                                              
   430  004300           ,文言連番                                              
   431  004310           ,保険会社識別コード                                    
   432  004320           ,特定取引先コード                                      
   433  004330           ,登録年月日                                            
   434  004340           ,登録時間                                              
   435  004350           ,登録担当者                                            
   436  004360           ,更新年月日                                            
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   437  004370           ,更新時間)                                             
   438  004380        VALUES                                                    
   439  004390           (:Ｄ１０−保険会社区分                                 
   440  004400           ,:Ｄ１０−適用開始日                                   
   441  004410           ,:Ｄ１０−保険料率                                     
   442  004420           ,:Ｄ１０−保険会社区分名称                             
   443  004430           ,:Ｄ１０−更新日時                                     
   444  004440           ,:Ｄ１０−更新者                                       
   445  004450           ,:Ｄ１０−入力担当者コード                             
   446  004460           ,:Ｄ１０−圏内区分                                     
   447  004470           ,:Ｄ１０−文言連番                                     
   448  004480           ,:Ｄ１０−保険会社識別コード                           
   449  004490           ,:Ｄ１０−特定取引先コード                             
   450  004500           ,:Ｄ１０−登録年月日                                   
   451  004510           ,:Ｄ１０−登録時間                                     
   452  004520           ,:Ｄ１０−登録担当者                                   
   453  004530           ,:Ｄ１０−更新年月日                                   
   454  004540           ,:Ｄ１０−更新時間)                                    
   455  004550     END-EXEC.                                                    
   456  004560*                                                                 
   457  004570*----------------------------------------------------------------*
   458  004580*--< ＤＢ追加処理を確認 >                                        *
   459  004590*----------------------------------------------------------------*
   460  004600*                                                                 
   461  004610     EVALUATE  SQLCODE                                            
   462  004620*                                                                 
   463  004630*--<    追加成功 >                                                
   464  004640        WHEN  定数−ＳＱＬＯＫ                                    
   465  004650           COMPUTE  Ｗ−出力−件数 = Ｗ−出力−件数 + 1           
   466  004660*                                                                 
   467  004670*--<    追加失敗>                                                 
   468  004680        WHEN  OTHER                                               
   469  004690           MOVE     -40               TO     Ｗ−エラーコード     
   470  004700           PERFORM  エラー判定処理                                
   471  004710     END-EVALUATE.                                                
   472  004720*                                                                 
   473  004730 保険料率マスタ出力処理−ＥＸＩＴ.                                
   474  004740     EXIT.                                                        
   475  004750******************************************************************
   476  004760*    終了処理                                                    *
   477  004770******************************************************************
   478  004780 終了処理                             SECTION.                    
   479  004790 終了処理−ＳＴＡＲＴ.                                            
   480  004800*                                                                 
   481  004810*--< ＤＢコミット処理 >                                           
   482  004820     PERFORM  ＤＢコミット処理.                                   
   483  004830*                                                                 
   484  004840     PERFORM  終了メッセージ出力.                                 
   485  004850*                                                                 
   486  004860*--< プログラム正常終了 >                                         
   487  004870     MOVE  定数−正常状態             TO  PROGRAM-STATUS.         
   488  004880*                                                                 
   489  004890 終了処理−ＥＸＩＴ.                                              
   490  004900     EXIT.                                                        
   491  004910*                                                                 
   492  004920******************************************************************
   493  004930*    ＤＢコミット処理                                            *
   494  004940******************************************************************
   495  004950 ＤＢコミット処理                     SECTION.                    
   496  004960 ＤＢコミット処理−ＳＴＡＲＴ.                                    
   497  004970*                                                                 
   498  004980     EXEC  SQL                                                    
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   499  004990        COMMIT  WORK  RELEASE                                     
   500  005000     END-EXEC.                                                    
   501  005010*                                                                 
   502  005020     INITIALIZE                       IF-CHOCO001.                
   503  005030     MOVE  "3"                        TO  共１−イベント種別.     
   504  005040     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   505  005050     MOVE  "0"                        TO  共１−復帰コード.       
   506  005060     MOVE  "COMMIT"                   TO  共１−処理識別.         
   507  005070     MOVE  "コミット実施"             TO  共１−その他メッセージ. 
   508  005080     CALL  CLOCO001                USING  IF-CHOCO001.            
   509  005090*                                                                 
   510  005100 ＤＢコミット処理−ＥＸＩＴ.                                      
   511  005110     EXIT.                                                        
   512  005120*                                                                 
   513  005130******************************************************************
   514  005140*    終了メッセージ出力                                          *
   515  005150******************************************************************
   516  005160 終了メッセージ出力                   SECTION.                    
   517  005170 終了メッセージ出力−ＳＴＡＲＴ.                                  
   518  005180*                                                                 
   519  005190*--<ファイルクローズ >                                           *
   520  005200*                                                                 
   521  005210     CLOSE    入力ファイル.                                       
   522  005220*                                                                 
   523  005230*----------------------------------------------------------------*
   524  005240*    件数メッセージ出力処理                                      *
   525  005250*----------------------------------------------------------------*
   526  005260*                                                                 
   527  005270     INITIALIZE                       IF-CHOCO001.                
   528  005280     MOVE  "3"                        TO  共１−イベント種別.     
   529  005290     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   530  005300     MOVE  ZERO                       TO  共１−復帰コード.       
   531  005310     MOVE  "FFUIS230"                 TO  共１−処理テーブルＩＤ. 
   532  005320     MOVE  "COUNT"                    TO  共１−処理識別.         
   533  005330     MOVE  Ｗ−入力−件数             TO  共１−データ内容.       
   534  005340     MOVE  "コードマスタ動産総合保険料率読込件数"                 
   535  005350                                      TO  共１−その他メッセージ. 
   536  005360     CALL  CLOCO001                USING  IF-CHOCO001.            
   537  005370*                                                                 
   538  005380     INITIALIZE                       IF-CHOCO001.                
   539  005390     MOVE  "3"                        TO  共１−イベント種別.     
   540  005400     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   541  005410     MOVE  ZERO                       TO  共１−復帰コード.       
   542  005420     MOVE  "D10HKR_TBL"               TO  共１−処理テーブルＩＤ. 
   543  005430     MOVE  "COUNT"                    TO  共１−処理識別.         
   544  005440     MOVE  Ｗ−出力−件数             TO  共１−データ内容.       
   545  005450     MOVE  "保険料率マスタ出力件数"   TO  共１−その他メッセージ. 
   546  005460     CALL  CLOCO001                USING  IF-CHOCO001.            
   547  005470*                                                                 
   548  005480*----------------------------------------------------------------*
   549  005490*    終了メッセージ出力                                          *
   550  005500*----------------------------------------------------------------*
   551  005510     INITIALIZE                       IF-CHOCO001.                
   552  005520     MOVE  "3"                        TO  共１−イベント種別.     
   553  005530     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   554  005540     MOVE  "0"                        TO  共１−復帰コード.       
   555  005550     MOVE  "END"                      TO  共１−処理識別.         
   556  005560     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
   557  005570     CALL  CLOCO001                USING  IF-CHOCO001.            
   558  005580*                                                                 
   559  005590 終了メッセージ出力−ＥＸＩＴ.                                    
   560  005600     EXIT.                                                        
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   561  005610*                                                                 
   562  005620******************************************************************
   563  005630*    ＤＢロールバック処理                                        *
   564  005640******************************************************************
   565  005650 ＤＢロールバック処理                 SECTION.                    
   566  005660 ＤＢロールバック処理−ＳＴＡＲＴ.                                
   567  005670*                                                                 
   568  005680     EXEC  SQL                                                    
   569  005690        ROLLBACK WORK  RELEASE                                    
   570  005700     END-EXEC.                                                    
   571  005710*                                                                 
   572  005720     INITIALIZE                       IF-CHOCO001.                
   573  005730     MOVE  "1"                        TO  共１−イベント種別.     
   574  005740     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   575  005750     MOVE  "9"                        TO  共１−復帰コード.       
   576  005760     MOVE  "ROLLBACK"                 TO  共１−処理識別.         
   577  005770     MOVE  "ロールバック実施"         TO  共１−その他メッセージ. 
   578  005780     CALL  CLOCO001                USING  IF-CHOCO001.            
   579  005790*                                                                 
   580  005800 ＤＢロールバック処理−ＥＸＩＴ.                                  
   581  005810     EXIT.                                                        
   582  005820*                                                                 
   583  005830******************************************************************
   584  005840*    エラー処理                                                  *
   585  005850******************************************************************
   586  005860 エラー判定処理                       SECTION.                    
   587  005870 エラー判定処理−ＳＴＡＲＴ.                                      
   588  005880*                                                                 
   589  005890     MOVE  "Y"                        TO  Ｗ−異常終了−フラグ.   
   590  005900     INITIALIZE                           IF-CHOCO001.            
   591  005910*                                                                 
   592  005920     EVALUATE  Ｗ−エラーコード                                   
   593  005930        WHEN  -10                                                 
   594  005940*--<       ＯＲＡＣＬＥ接続失敗 >                                 
   595  005950           MOVE  "1"                  TO  共１−イベント種別      
   596  005960           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   597  005970           MOVE  "9"                  TO  共１−復帰コード        
   598  005980           MOVE  "CONNECT"            TO  共１−処理識別          
   599  005990           MOVE  SQLCODE              TO  共１−データ内容        
   600  006000           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   601  006010           CALL  CLOCO001          USING  IF-CHOCO001             
   602  006020*                                                                 
   603  006030        WHEN  -20                                                 
   604  006040*--<       入力ファイルオープン失敗 >                             
   605  006050           MOVE  "1"                  TO  共１−イベント種別      
   606  006060           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   607  006070           MOVE  "9"                  TO  共１−復帰コード        
   608  006080           MOVE  "FFUIS230"           TO  共１−処理テーブルＩＤ  
   609  006090           MOVE  "OPEN"               TO  共１−処理識別          
   610  006100           MOVE  Ｗ−状態             TO  共１−データ内容        
   611  006110           MOVE  "入力ファイルオープンエラー"                     
   612  006120                                      TO  共１−その他メッセージ  
   613  006130           CALL  CLOCO001          USING  IF-CHOCO001             
   614  006140*                                                                 
   615  006150        WHEN  -30                                                 
   616  006160*--<       入カーソルオープン失敗 >                               
   617  006170           MOVE  "1"                  TO  共１−イベント種別      
   618  006180           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   619  006190           MOVE  "9"                  TO  共１−復帰コード        
   620  006200           MOVE  "FFUIS230"           TO  共１−処理テーブルＩＤ  
   621  006210           MOVE  "READ"               TO  共１−処理識別          
   622  006220           MOVE  SQLCODE              TO  共１−データ内容        
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   623  006230           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   624  006240           CALL  CLOCO001          USING  IF-CHOCO001             
   625  006250*                                                                 
   626  006260        WHEN  -40                                                 
   627  006270*--<       保険料率マスタ追加失敗 >                               
   628  006280           MOVE  "1"                  TO  共１−イベント種別      
   629  006290           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   630  006300           MOVE  "9"                  TO  共１−復帰コード        
   631  006310           MOVE  "D10HKR"             TO  共１−処理テーブルＩＤ  
   632  006320           MOVE  "INSERT"             TO  共１−処理識別          
   633  006330           MOVE  SQLCODE              TO  共１−データ内容        
   634  006340           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   635  006350           CALL  CLOCO001          USING  IF-CHOCO001             
   636  006360*                                                                 
   637  006370        WHEN  -50                                                 
   638  006380*--<       保険マスタ_動総読込処理失敗 >                          
   639  006390           MOVE  "2"                  TO  共１−イベント種別      
   640  006400           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   641  006410           MOVE  "9"                  TO  共１−復帰コード        
   642  006420           MOVE  "MST_DOSO"           TO  共１−処理テーブルＩＤ  
   643  006430           MOVE  "SELECT"             TO  共１−処理識別          
   644  006440           MOVE  SQLCODE              TO  共１−データ内容        
   645  006450           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   646  006460           CALL  CLOCO001          USING  IF-CHOCO001             
   647  006470           MOVE  "N"                  TO  Ｗ−異常終了−フラグ    
   648  006480*                                                                 
   649  006490        WHEN  OTHER                                               
   650  006500           MOVE  "N"                  TO Ｗ−異常終了−フラグ     
   651  006510     END-EVALUATE.                                                
   652  006520*                                                                 
   653  006530     IF Ｗ−異常終了−フラグ  =  "Y"                              
   654  006540        PERFORM  終了メッセージ出力                               
   655  006550*                                                                 
   656  006560*--< ロールバック処理>                                            
   657  006570     PERFORM  ＤＢロールバック処理                                
   658  006580*                                                                 
   659  006590*--<    プログラム異常終了のリターンコード >                      
   660  006600        MOVE  定数−異常状態          TO  PROGRAM-STATUS          
   661  006610*                                                                 
   662  006620        EXIT  PROGRAM                                             
   663  006630*                                                                 
   664  006640     END-IF.                                                      
   665  006650*                                                                 
   666  006660 エラー処理−ＥＸＩＴ.                                            
   667  006670     EXIT.                                                        
   668  006680******************************************************************
   669  006690*                  END OF PROGRAM                                *
   670  006700******************************************************************
ファイル: C:\COB97\SOC\COBIS230\COBIS230.PCOをクローズ
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


ホスト変数
--------------

01  DB-STRING                                           Charf(20)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      3
  C:\COB97\SOC\COBIS230\COBIS230.PCO    243

01  PASSWD                                              Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      5
  C:\COB97\SOC\COBIS230\COBIS230.PCO    238    242

01  SQLSTATE                                            Charf(5)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      2
  C:\COB97\SOC\COBIS230\COBIS230.PCO    237    241    320    420    498    568

01  USERNAME                                            Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      4
  C:\COB97\SOC\COBIS230\COBIS230.PCO    238    242

03  Ｄ１０−圏内区分 OF 保険料率マスタ                  Charf(1)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     14
  C:\COB97\SOC\COBIS230\COBIS230.PCO    446

03  Ｄ１０−更新時間 OF 保険料率マスタ                  Charf(8)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     24
  C:\COB97\SOC\COBIS230\COBIS230.PCO    454

03  Ｄ１０−更新者 OF 保険料率マスタ                    Charf(8)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     11
  C:\COB97\SOC\COBIS230\COBIS230.PCO    444

03  Ｄ１０−更新日時 OF 保険料率マスタ                  Charf(16)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     10
  C:\COB97\SOC\COBIS230\COBIS230.PCO    443

03  Ｄ１０−更新年月日 OF 保険料率マスタ                Charf(8)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     23
  C:\COB97\SOC\COBIS230\COBIS230.PCO    453

03  Ｄ１０−適用開始日 OF 保険料率マスタ                Charf(8)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL      6
  C:\COB97\SOC\COBIS230\COBIS230.PCO    440

03  Ｄ１０−登録時間 OF 保険料率マスタ                  Charf(8)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     21
  C:\COB97\SOC\COBIS230\COBIS230.PCO    451

03  Ｄ１０−登録担当者 OF 保険料率マスタ                Charf(8)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     22
  C:\COB97\SOC\COBIS230\COBIS230.PCO    452

03  Ｄ１０−登録年月日 OF 保険料率マスタ                Charf(8)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     20
  C:\COB97\SOC\COBIS230\COBIS230.PCO    450

03  Ｄ１０−特定取引先コード OF 保険料率マス            Charf(2)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     18
  C:\COB97\SOC\COBIS230\COBIS230.PCO    449

03  Ｄ１０−入力担当者コード OF 保険料率マス            Charf(8)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     12
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  C:\COB97\SOC\COBIS230\COBIS230.PCO    445

03  Ｄ１０−文言連番 OF 保険料率マスタ                  Decimal(3,0)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     15
  C:\COB97\SOC\COBIS230\COBIS230.PCO    447

03  Ｄ１０−保険会社区分 OF 保険料率マスタ              Charf(4)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL      5
  C:\COB97\SOC\COBIS230\COBIS230.PCO    439

03  Ｄ１０−保険会社区分名称 OF 保険料率マス            Charf(80)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL      8
  C:\COB97\SOC\COBIS230\COBIS230.PCO    442

03  Ｄ１０−保険会社識別コード OF 保険料率マ            Charf(2)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL     16
  C:\COB97\SOC\COBIS230\COBIS230.PCO    448

03  Ｄ１０−保険料率 OF 保険料率マスタ                  Decimal(10,8)
  Z:\COB97\COPYLIB_DB\D10HKR.CBL      7
  C:\COB97\SOC\COBIS230\COBIS230.PCO    441

01  ＭＳＴ−ＤＯＳＯ−動総保険コード                    Charf(4)
  Z:\COB97\COPYLIB_DB\MST_DOSO.CBL      4
  C:\COB97\SOC\COBIS230\COBIS230.PCO    324

01  ＭＳＴ−ＤＯＳＯ−物件名                            Charf(60)
  Z:\COB97\COPYLIB_DB\MST_DOSO.CBL     23
  C:\COB97\SOC\COBIS230\COBIS230.PCO    322

Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.



                              プリコンパイラ・オプション
-------------------------------------------------------------------------------
オプション名   現在の設定値         設定先
-------------------------------------------------------------------------------
asacc             no                デフォルト                                  
assume_sqlcode    no                デフォルト                                  
auto_connect      no                デフォルト                                  
close_on_commit   yes               mode                                        
comp5             yes               D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
config            default config    デフォルト                                  
date_format       local             デフォルト                                  
dbms              native            デフォルト                                  
declare_section   yes               mode                                        
define            *なし*            デフォルト                                  
dynamic           ansi              mode                                        
end_of_fetch      100               mode                                        
eol_padding       yes               デフォルト                                  
errors            yes               デフォルト                                  
fips              no                デフォルト                                  
format            ansi              デフォルト                                  
hold_cursor       no                デフォルト                                  
host              cobol             デフォルト                                  
iname             C:\COB97\SOC\COBISコマンドラインCO                            
include           Z:\COB97\COPYLIB  D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
                  Z:\COB97\COPYLIB_DD:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
                  *なし*            D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
ireclen           132               D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
litdelim          quote             デフォルト                                  
lname             *なし*            デフォルト                                  
lreclen           132               デフォルト                                  
ltype             long              デフォルト                                  
maxliteral        160               D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
maxopencursors    10                デフォルト                                  
mode              ANSI              D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
nested            yes               デフォルト                                  
nls_local         yes               D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
oname             COBIS230.COB      コマンドライン                              
oraca             no                デフォルト                                  
oreclen           80                デフォルト                                  
pagelen           66                デフォルト                                  
picx              charf             デフォルト                                  
prefetch          1                 デフォルト                                  
release_cursor    no                デフォルト                                  
select_error      yes               デフォルト                                  
sqlcheck          FULL              D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
threads           no                デフォルト                                  
type_code         ansi              mode                                        
unsafe_null       no                デフォルト                                  
userid            CUIFJ/CFJ@FIP     D:\ORACLE\ORA90\precomp\admin\pcbcfg.cfg    
varchar           no                デフォルト                                  
xref              yes               デフォルト                                  
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 13:42:52 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


統計表示
----------

リターン・コード: 0
重要性 Iでのメッセージ数: 0
重要性 Wでのメッセージ数: 0
重要性 Eでのメッセージ数: 0
重要性 Fでのメッセージ数: 0
入力ラインの数: 723
宣言されたホスト変数の数: 44
カーソル名の数: 0
文名の数: 0
使用される最大メモリー(バイト): 142525
