000010******************************************************************
000020*         CP(A)                                     *
000030*      1. vO  : Ǘڍs                       *
000040*      2. vOID  : COBISAOO                               *
000050*      3. Tv      : Ǘ({)ʔԂ *
000060*                         PʂœǍ݁AǗA           *
000070*                         Ǘ_ׂ쐬B      *
000080*      4. 쐬        : ≓                                 *
000090*      5. 쐬        : 2005.04.02                             *
000100******************************************************************
000110*                                                                 
000111******************************************************************
000112*    hcdmshehb`shnm  chuhrhnm              *
000113******************************************************************
000114 IDENTIFICATION                       DIVISION.                   
000115*                                                                 
000116 PROGRAM-ID.                          COBISAOO.                   
000117******************************************************************
000118*    dmuhqnmldms        chuhrhnm              *
000119******************************************************************
000120 ENVIRONMENT                          DIVISION.                   
000121******************************************************************
000122*    c`s`                      chuhrhnm              *
000123******************************************************************
000124 DATA                                 DIVISION.                   
000125******************************************************************
000126*  vnqjhmf|rsnq`fd  rdbshnm                *
000127******************************************************************
000128  WORKING-STORAGE                     SECTION.                    
000129*----------------------------------------------------------------*
000130*    zXgϐ`GA                                        *
000131*----------------------------------------------------------------*
000132     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
000133 01  v|z       PIC       9(02).                              
000134 01  v|ϐ       PIC       9(01).                              
000135*                                                                 
000136*--< nq`bkdʕϐ >                                       
000137     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
000138*                                                                 
000139*--< nq`bkd  rpks >                               
000140     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
000141*                                                                 
000142*--< Ǘ({)>                                  
000143     EXEC  SQL  INCLUDE  LTRNKK.CBL            END-EXEC.          
000144*                                                                 
000145*--< Ǘ >                                               
000146     EXEC  SQL  INCLUDE  D57NKK.CBL           END-EXEC.           
000147*                                                                 
000148*--< Ǘ_>                                       
000149     EXEC  SQL  INCLUDE  D57NKM.CBL           END-EXEC.           
000150*                                                                 
000151*--< dZkR[hϊe[u>                              
000152     EXEC  SQL  INCLUDE  IKOTBL008.CBL        END-EXEC.           
000153*                                                                 
000154     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
000155*                                                                 
000156*----------------------------------------------------------------*
000157*    vnqjGA                                              *
000158*----------------------------------------------------------------*
000159 01  vnqj|GA.                                            
000160*--< G[p >                                               
000161     03  v|G[R[h             PIC S9(04).                 
000162*                                                                 
000163*--< tOAA >                                               
000164     03  tOAA.                                            
000165         05  v|I|tO         PIC  X(01).                 
000166         05  v|ُI|tO     PIC  X(01).                 
000167*                                                                 
000168*--< GA >                                                 
000169     03  GA.                                              
000170         05  v|́|           PIC  9(09).                 
000171         05  v|ó|P         PIC  9(09).                 
000172         05  v|ó|Q         PIC  9(09).                 
000173*                                                                 
000182*--< ʏ >                                                   
000183 01  v|ʏ.                                                
000184     03  v|VXet.                                        
000185         05  v|I                 PIC  X(02) VALUE  "20".     
000186         05  v|N               PIC  X(06).                 
000187     03  v|VXe             PIC  X(08).                 
000188     03  v|S                   PIC  X(08) VALUE "IKOPG   ".
000189*                                                                 
000190                                                                  
000191*----------------------------------------------------------------*
000192*    Tu[`                                              *
000193*----------------------------------------------------------------*
000194 01  CALL-AREA.                                                   
000195*--< ʃOTu[` >                                       
000196     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
000197     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
000198*                                                                 
000199*----------------------------------------------------------------*
000200*    bnoẍ                                                *
000201*----------------------------------------------------------------*
000202*--< ʃOpp[^ >                                       
000203 01  IF-CHOCO001.                                                 
000204     COPY  CHOCO001  REPLACING  ==()==  BY  ==P|==.           
000205*                                                                 
000206*----------------------------------------------------------------*
000207*    hmht@CǍTu[`pp^̈                *
000208*----------------------------------------------------------------*
000209 01  PARA-AREA.                                                   
000210     COPY CPBCO001.                                               
000211******************************************************************
000212*    萔pf[^`GA                                      *
000213******************************************************************
000214 CONSTANT                             SECTION.                    
000215 01  萔̈.                                                    
000216     03  萔|vOhc         PIC  X(08) VALUE "COBISAOO".
000217     03  萔|vO           PIC  X(80)                  
000218                                      VALUE  "Ǘڍs ". 
000219     03  萔|rpknj             PIC S9(04)  VALUE  ZERO.    
000220     03  萔|rpkdmc           PIC S9(04)  VALUE  0100.    
000221     03  萔|               PIC S9(04)  VALUE  ZERO.    
000222     03  萔|ُ               PIC S9(04)  VALUE  0009.    
000223******************************************************************
000224*    oqnbdctqd            chuhrhnm              *
000225******************************************************************
000226 PROCEDURE                            DIVISION.                   
000227*                                                                 
000228     PERFORM  .                                           
000229*                                                                 
000230     PERFORM  又  UNTIL  v|I|tO  =  "Y".            
000231*                                                                 
000232     PERFORM  I.                                           
000233*                                                                 
000234     STOP     RUN.                                                
000235*                                                                 
000236******************************************************************
000237*                                                        *
000238******************************************************************
000239                              SECTION.                    
000240 |rs`qs.                                            
000241*                                                                 
000242*----------------------------------------------------------------*
000243*    JnbZ[Wo͏                                      *
000244*----------------------------------------------------------------*
000245     INITIALIZE                       IF-CHOCO001.                
000246     MOVE  "3"                        TO  P|Cxg.     
000247     MOVE  萔|vOhc       TO  P|\[Xhc.       
000248     MOVE  "0"                        TO  P|AR[h.       
000249     MOVE  "START"                    TO  P|.         
000250     MOVE  萔|vO         TO  P|̑bZ[W. 
000251     CALL  CLOCO001                USING  IF-CHOCO001.            
000252*                                                                 
000253*----------------------------------------------------------------*
000254*    Ɨ̈̏l                                        *
000255*----------------------------------------------------------------*
000256     MOVE  SPACE                      TO  vnqj|GA.       
000257     INITIALIZE                           vnqj|GA.       
000259*                                                                 
000260*--< bott擾 >                                           
000261     ACCEPT  v|N               FROM  DATE.                 
000262*                                                                 
000263*--< bot擾 >                                           
000264     ACCEPT  v|VXe         FROM  TIME.                 
000265*                                                                 
000266*--< nq`bkdڑ >                                           
000267     PERFORM   nq`bkdڑ.                                  
000268*                                                                 
000269*--< e[uJ[\` >                                   
000270     PERFORM  e[uJ[\`.                           
000271*                                                                 
000272*--< e[uJ[\Ǎ(P) >                           
000273     PERFORM  e[uJ[\Ǎ.                           
000274*                                                                 
000275 |dwhs.                                              
000276     EXIT.                                                        
000277******************************************************************
000278*    nq`bkdڑ                                            *
000279******************************************************************
000280 nq`bkdڑ                     SECTION.                    
000281 nq`bkdڑ|rs`qs.                                    
000282*                                                                 
000283*--< caڑp擾 >                                   
000284     CALL  COBCO001                USING  PARA-AREA.              
000285*                                                                 
000286     MOVE  PARA-DBSTRING              TO  DB-STRING.              
000287     MOVE  PARA-USERNAME              TO  USERNAME.               
000288     MOVE  PARA-PASSWORD              TO  PASSWD.                 
000289*                                                                 
000290*----------------------------------------------------------------*
000291*    Jnڑ                                                    *
000292*----------------------------------------------------------------*
000293     IF    DB-STRING  =  SPACE                                    
000294        EXEC SQL                                                  
000295           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
000296        END-EXEC                                                  
000297     ELSE                                                         
000298        EXEC SQL                                                  
000299           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
000300             USING  :DB-STRING                                    
000301        END-EXEC                                                  
000302     END-IF.                                                      
000303*                                                                 
000304*----------------------------------------------------------------*
000305*    ڑmF                                                    *
000306*----------------------------------------------------------------*
000307     EVALUATE  SQLCODE                                            
000308        WHEN   萔|rpknj                                   
000309           CONTINUE                                               
000310        WHEN   OTHER                                              
000311*--<       ڑG[ >                                           
000312           MOVE     -10               TO  v|G[R[h        
000313           PERFORM  G[菈                                
000314     END-EVALUATE.                                                
000315*                                                                 
000316 nq`bkdڑ|dwhs.                                      
000317     EXIT.                                                        
000318******************************************************************
000319*        e[uJ[\`                                *
000320******************************************************************
000321 e[uJ[\`             SECTION.                    
000322 e[uJ[\`|rs`qs.                            
000323*                                                                 
000324*----------------------------------------------------------------*
000325*    J[\nodm                                        *
000326*----------------------------------------------------------------*
000327     EXEC SQL                                                     
000328        DECLARE CUR1  CURSOR FOR                                  
000329           SELECT  LTRNKK.ʔ                                
000330                  ,LTRNKK.                                  
000331                  ,LTRNKK.dZkR[h                          
000334                  ,LTRNKK.Ev                                    
000335                  ,LTRNKK.zP                                  
000336                  ,LTRNKK.zQ                                  
000337                  ,LTRNKK.zR                                  
000338                  ,LTRNKK.zS                                  
000339                  ,LTRNKK.zT                                  
000340                  ,LTRNKK.zU                                  
000341                  ,LTRNKK.zV                                  
000342                  ,LTRNKK.zW                                  
000343                  ,LTRNKK.zX                                  
000344                  ,LTRNKK.zPO                                
000345                  ,LTRNKK.ʔԂP                              
000346                  ,LTRNKK.ʔԂQ                              
000347                  ,LTRNKK.ʔԂR                              
000348                  ,LTRNKK.ʔԂS                              
000349                  ,LTRNKK.ʔԂT                              
000350                  ,LTRNKK.ʔԂU                              
000351                  ,LTRNKK.ʔԂV                              
000352                  ,LTRNKK.ʔԂW                              
000353                  ,LTRNKK.ʔԂX                              
000354                  ,LTRNKK.ʔԂPO                            
000358             FROM  LTRNKK                                         
000369     END-EXEC.                                                    
000370*                                                                 
000371*----------------------------------------------------------------*
000372*    J[\nodm                                        *
000373*----------------------------------------------------------------*
000374     EXEC  SQL                                                    
000375        OPEN  CUR1                                                
000376     END-EXEC.                                                    
000377*                                                                 
000378*----------------------------------------------------------------*
000379*    J[\nodmmF                                        *
000380*----------------------------------------------------------------*
000381     EVALUATE  SQLCODE                                            
000382        WHEN  萔|rpknj                                    
000383*--<        >                                                 
000384           CONTINUE                                               
000385        WHEN  OTHER                                               
000386*--<       J[\nodmG[ >                               
000387           MOVE -20                   TO  v|G[R[h        
000388           PERFORM  G[菈                                
000389     END-EVALUATE.                                                
000390*                                                                 
000391 e[uJ[\`|dwhs.                              
000392     EXIT.                                                        
000393******************************************************************
000394*    e[uJ[\Ǎ                                    *
000395******************************************************************
000396 e[uJ[\Ǎ             SECTION.                    
000397 e[uJ[\Ǎ|rs`qs.                            
000398*                                                                 
000399*--< e[uJ[\Ǎ >                                   
000400     EXEC SQL                                                     
000401         FETCH  CUR1                                              
000402          INTO  :ksqmjj|ʔ                           
000403               ,:ksqmjj|                             
000404               ,:ksqmjj|dZkR[h                     
000407               ,:ksqmjj|Ev                               
000408               ,:ksqmjj|zP                             
000409               ,:ksqmjj|zQ                             
000410               ,:ksqmjj|zR                             
000411               ,:ksqmjj|zS                             
000412               ,:ksqmjj|zT                             
000413               ,:ksqmjj|zU                             
000414               ,:ksqmjj|zV                             
000415               ,:ksqmjj|zW                             
000416               ,:ksqmjj|zX                             
000417               ,:ksqmjj|zPO                           
000418               ,:ksqmjj|ʔԂP                         
000419               ,:ksqmjj|ʔԂQ                         
000420               ,:ksqmjj|ʔԂR                         
000421               ,:ksqmjj|ʔԂS                         
000422                                                                  
000423     END-EXEC.                                                    
000424*                                                                 
000425*----------------------------------------------------------------*
000426*    e[uJ[\ǍmF                              *
000427*----------------------------------------------------------------*
000428     EVALUATE   SQLCODE                                           
000429        WHEN   萔|rpknj                                   
000430*--<        >                                                 
000436*                                                                 
000437           COMPUTE  v|́|  =  v|́|  +  1       
000438        WHEN   萔|rpkdmc                                 
000439*--<       ǍI >                                             
000440           MOVE  "Y"                  TO  v|I|tO        
000441        WHEN   OTHER                                              
000442*--<       ǍG[ >                                           
000443           MOVE     -30               TO  v|G[R[h        
000444           PERFORM  G[菈                                
000445     END-EVALUATE.                                                
000446*                                                                 
000447 e[uJ[\Ǎ|dwhs.                              
000448     EXIT.                                                        
000449******************************************************************
000450*    又                                                      *
000451******************************************************************
000452 又                               SECTION.                    
000453 又|rs`qs.                                              
000454*--< ǗҏWo >                                       
000456     PERFORM  ǗҏWo.                               
000457*                                                                 
000458*--< Ǘ_וҏWo >                              
000460     PERFORM  ǗוҏWo.                      
000461*                                                                 
000471*--< e[uJ[\ǍiQڈȍ~j >                     
000472     PERFORM  e[uJ[\Ǎ.                           
000474*                                                                 
000475 又|dwhs.                                                
000476     EXIT.                                                        
000477******************************************************************
000478*     ǗҏWo                                       *
000479******************************************************************
000480 ǗҏWo                     SECTION.                
000481 ǗҏWó|rs`qs.                                
000482*                                                                 
000500*----------------------------------------------------------------*
000501*       ǗڕҏW                                 *
000502*----------------------------------------------------------------*
000503*--< No.01 >                                                      
000504     MOVE  ksqmjj|ʔ     TO  cTVmjj|ʔ. 
000505*                                                                 
000506*--< No.02 >                                                      
000507     MOVE  ZERO                       TO                          
000508                                      cTVmjj|R[h敪. 
000510*--< No.03 >                                                      
000511     MOVE  ksqmjj|       TO                          
000512                                      cTVmjj|N.   
000513*                                                                 
000514*--< No.04 >                                                      
000515     MOVE  ZERO                       TO  cTVmjj|. 
000516*                                                                 
000517*--< No.05 >                                                      
000518     MOVE  SPACE                      TO                          
000519                                      cTVmjj|S.   
000521*                                                                 
000522*--< No.06 >                                                      
000523     EXEC SQL                                                     
000524        SELECT   VdZkR[h                             
000525          INTO  :hjnOOW|VdZkR[h               
000526          FROM   IKOTBL008                                        
000527         WHERE   dZkR[h  =                          
000528                                   :ksqmjj|dZkR[h  
000529     END-EXEC.                                                    
000530     EVALUATE   SQLCODE                                           
000531         WHEN   萔|rpknj                                  
000532*--<        >                                                 
000533         MOVE  hjnOOW|VdZkR[h TO              
000534                                      cTVmjj|dZkR[h
000538        WHEN   OTHER                                              
000539*--<       caȂ>                                              
000540         MOVE     ZERO               TO                           
000541                                  cTVmjj|dZkR[h    
000542     DISPLAY "dZkR[hϊe[uȂ dZkR[h:" 
000543                       ksqmjj|dZkR[h               
000545     END-EVALUATE.                                                
000549*                                                                 
000550*--< No.07 >                                                      
000551     MOVE  ksqmjj|Ev         TO  cTVmjj|Ev.     
000552*                                                                 
000553*--< No.08 >                                                      
000554     MOVE  ZERO                       TO                          
000555                                      cTVmjj|敪. 
000556*                                                                 
000560*--< No.09 >                                                      
000561     MOVE  v|VXet        TO cTVmjj|o^N.   
000563*                                                                 
000564*--< No.10 >                                                      
000565     MOVE  v|VXe        TO  cTVmjj|o^.    
000566*                                                                 
000567*--< No.11 >                                                      
000568     MOVE  v|S              TO  cTVmjj|o^S.  
000569*                                                                 
000570*--< No.12 >                                                      
000571     MOVE  v|VXet        TO  cTVmjj|XVN.  
000572*                                                                 
000573*--< No.13 >                                                      
000574     MOVE  v|VXe        TO  cTVmjj|XV.    
000575*                                                                 
000576*--< No.14 >                                                      
000577     MOVE  v|S              TO  cTVmjj|XV.      
000578*                                                                 
000579*--< No.15 >                                                      
000580     MOVE  v|S              TO                             
000581                                   cTVmjj|͒S҃R[h.
000582*--< Ǘo >                                           
000583     PERFORM  Ǘo.                                   
000587 ǗҏWó|dwhs.                                  
000588     EXIT.                                                        
000589                                                                  
000590******************************************************************
000591*   Ǘ_וҏWo                                *
000592******************************************************************
000593 ǗוҏWo            SECTION.                
000594 ǗוҏWó|rs`qs.                       
000595*--< ʔԏΏۊzҏW >                                     
000596     PERFORM  ʔԏΏۊzҏW                              
000597     VARYING  v|z  FROM 1 BY 1 UNTIL   v|z > 10       
000599     END-PERFORM.                                                
000600 ǗוҏWó|dwhs.                         
000601     EXIT.                                                        
000602******************************************************************
000603*   ʔԏΏۊzҏW                                       *
000604******************************************************************
000605 ʔԏΏۊzҏW               SECTION.                    
000606 ʔԏΏۊzҏW|rs`qs.                              
000607     MOVE      ZERO     TO    v|ϐ .                          
000609     EVALUATE   v|z                                          
000610*----------------------------------------------------------------*
000611*       zP                                                   *
000612*----------------------------------------------------------------*
000614         WHEN 1                                                   
000615           IF  ksqmjj|zP NOT = ZERO
000616*--< No.02 > 
000617       MOVE  ksqmjj|ʔԂP  TO 
000618                                          cTVmjl|ʔ  
000619*--< No.03 >
000620       MOVE  ksqmjj|zP  TO  cTVmjl|Ώۊz
000621            END-IF
000622     MOVE   1                         TO  v|ϐ
000623*----------------------------------------------------------------*
000624*       zQ                                                   *
000625*----------------------------------------------------------------*
000627     WHEN 2
000628     IF  ksqmjj|zQ NOT = ZERO
000629*--< No.02 >
000630       MOVE  ksqmjj|ʔԂQ  TO 
000631                                          cTVmjl|ʔ  
000632*--< No.03 >
000633       MOVE  ksqmjj|zQ  TO  cTVmjl|Ώۊz
000634     END-IF
000635     MOVE   1                         TO  v|ϐ
000636*----------------------------------------------------------------*
000637*       zR                                                   *
000638*----------------------------------------------------------------*
000640     WHEN 3
000641     IF  ksqmjj|zR NOT = ZERO
000642*--< No.02 >
000643       MOVE  ksqmjj|ʔԂR  TO 
000644                                          cTVmjl|ʔ  
000645*--< No.03 >
000646       MOVE  ksqmjj|zR  TO  cTVmjl|Ώۊz
000647     END-IF
000648      MOVE   1                         TO  v|ϐ
000649*----------------------------------------------------------------*
000650*       zS                                                   *
000651*----------------------------------------------------------------*
000653       WHEN 4
000654     IF  ksqmjj|zS NOT = ZERO
000655*--< No.02 >
000656       MOVE  ksqmjj|ʔԂS  TO 
000657                                          cTVmjl|ʔ  
000658*--< No.03 >
000659       MOVE  ksqmjj|zS  TO  cTVmjl|Ώۊz
000660     END-IF
000661     MOVE   1                         TO  v|ϐ
000662*----------------------------------------------------------------*
000663*       zT                                                   *
000664*----------------------------------------------------------------*
000666     WHEN 5
000667     IF  ksqmjj|zT NOT = ZERO
000668*--< No.02 >
000669       MOVE  ksqmjj|ʔԂT  TO 
000670                                          cTVmjl|ʔ  
000671*--< No.03 >
000672       MOVE  ksqmjj|zT  TO  cTVmjl|Ώۊz
000673     END-IF
000674     MOVE   1                         TO  v|ϐ
000675*----------------------------------------------------------------*
000676*       zU                                                   *
000677*----------------------------------------------------------------*
000679     WHEN 6
000680     IF  ksqmjj|zU NOT = ZERO
000681*--< No.02 >
000682       MOVE  ksqmjj|ʔԂU  TO 
000683                                          cTVmjl|ʔ  
000684*--< No.03 >
000685       MOVE  ksqmjj|zU  TO  cTVmjl|Ώۊz
000686     END-IF
000687     MOVE   1                         TO  v|ϐ
000688*----------------------------------------------------------------*
000689*       zV                                                   *
000690*----------------------------------------------------------------*
000692     WHEN 7
000693     IF  ksqmjj|zV NOT = ZERO
000694*--< No.02 >
000695       MOVE  ksqmjj|ʔԂV  TO 
000696                                          cTVmjl|ʔ  
000697*--< No.03 >
000698       MOVE  ksqmjj|zV  TO  cTVmjl|Ώۊz
000699     END-IF
000700     MOVE   1                         TO  v|ϐ
000701*----------------------------------------------------------------*
000702*       zW                                                   *
000703*----------------------------------------------------------------*
000705     WHEN 8
000706     IF  ksqmjj|zW NOT = ZERO
000707*--< No.02 >
000708       MOVE  ksqmjj|ʔԂW  TO 
000709                                          cTVmjl|ʔ  
000710*--< No.03 >
000711       MOVE  ksqmjj|zW  TO  cTVmjl|Ώۊz
000712     END-IF
000713     MOVE   1                         TO  v|ϐ
000714*----------------------------------------------------------------*
000715*       zX                                                   *
000716*----------------------------------------------------------------*
000718     WHEN 9
000719     IF  ksqmjj|zX NOT = ZERO
000720*--< No.02 >
000721       MOVE  ksqmjj|ʔԂX  TO 
000722                                          cTVmjl|ʔ  
000723*--< No.03 >
000724       MOVE  ksqmjj|zX  TO  cTVmjl|Ώۊz
000725     END-IF
000726     MOVE   1                         TO  v|ϐ
000727*----------------------------------------------------------------*
000728*       zPO                                                   *
000729*----------------------------------------------------------------*
000731     WHEN 10
000732     IF  ksqmjj|zPO NOT = ZERO
000733*--< No.02 >
000734       MOVE  ksqmjj|ʔԂPO  TO 
000735                                          cTVmjl|ʔ  
000736*--< No.03 >
000737       MOVE  ksqmjj|zPO  TO  cTVmjl|Ώۊz
000738     END-IF
000739     MOVE   1                         TO  v|ϐ
000740     END-EVALUATE.
000741*
000742     IF   v|ϐ = 1
000743*--< ҏW >
000744     PERFORM  ҏW
000745*--< Ǘ_׏o >
000746     PERFORM  Ǘ׏o
000747*                                                                 
000748     END-IF.
000749 ʔԏΏۊzҏW|dwhs.                                          
000750     EXIT.  
000751******************************************************************
000752*   ҏW                                                       *
000753******************************************************************
000754 ҏW                             SECTION.                    
000755 ҏW|rs`qs.    
000756*--< No.01 > 
000757     MOVE  ksqmjj|ʔ   TO  cTVmjl|ʔ .
000758*--< No.04 > 
000759     MOVE  ZERO                     TO  cTVmjl|敪.
000760*--< No.05 >                                                   
000761     MOVE  v|VXet        TO cTVmjl|o^N.   
000762*                                                                 
000763*--< No.06 >                                                   
000764     MOVE  v|VXe        TO  cTVmjl|o^  .         
000765*                                                                 
000766*--< No.07 >                                                   
000767     MOVE  v|S              TO  cTVmjl|o^S.        
000768*                                                                 
000769*--< No.08 >                                                   
000770     MOVE  v|VXet        TO  cTVmjl|XVN.
000771*                                                                
000772*--< No.09 >                                                   
000773     MOVE  v|VXe        TO  cTVmjl|XV .    
000774*                                                                 
000775*--< No.10 >                                                      
000776     MOVE  v|S              TO  cTVmjl|XV   .      
000777*                                                                 
000778*--< No.11 >                                                   
000779     MOVE  v|S              TO 
000780                                    cTVmjl|͒S҃R[.
000781 ҏW|dwhs.                                          
000782     EXIT. 
000783******************************************************************
000784*   Ǘo                                             *
000785******************************************************************
000786 Ǘo                     SECTION.                    
000787 Ǘó|rs`qs.                           
000788*                                                                 
000789       EXEC  SQL                                                  
000790        INSERT  INTO  D57NKK_TBL                                  
000791           ( ʔ                                             
000792            ,R[h敪                                         
000793            ,N                                           
000794            ,                                              
000795            ,S                                             
000796            ,dZkR[h                                               
000797            ,Ev                                             
000798            ,敪                                                 
000799            ,o^N                                              
000800            ,o^                                           
000801            ,o^S                                              
000802            ,XVN                                               
000803            ,XV                                      
000804            ,XV                                         
000805            ,͒S҃R[h)                                             
000806        VALUES                                                     
000807           ( :cTVmjj|ʔ                                      
000808            ,:cTVmjj|R[h敪                             
000809            ,:cTVmjj|N                                   
000810            ,:cTVmjj|                                      
000811            ,:cTVmjj|S                                       
000812            ,:cTVmjj|dZkR[h                                    
000813            ,:cTVmjj|Ev                                        
000814            ,:cTVmjj|敪                                        
000815            ,:cTVmjj|o^N                                     
000816            ,:cTVmjj|o^                                 
000817            ,:cTVmjj|o^S                               
000818            ,:cTVmjj|XVN                                      
000819            ,:cTVmjj|XV                           
000820            ,:cTVmjj|XV                                  
000821            ,:cTVmjj|͒S҃R[h )                                   
000822     END-EXEC.                                                    
000823*                                                                 
000824*----------------------------------------------------------------*
000825*    ǉmF                                              *
000826*----------------------------------------------------------------*
000827     EVALUATE  SQLCODE                                            
000828        WHEN   萔|rpknj                                   
000829*--<       ǉ >                                             
000830           COMPUTE  v|ó|P  =  v|ó|P +  1    
000831        WHEN   OTHER                                              
000832*--<       ǉG[ >                                       
000833           MOVE     -40               TO  v|G[R[h        
000834           PERFORM  G[菈                                
000835     END-EVALUATE.                                                
000836*                                                                 
000837 o͏|dwhs.                                              
000838     EXIT.                                                        
000839******************************************************************
000840*   Ǘ_׏o                                    *
000841******************************************************************
000842 Ǘ׏o            SECTION.                    
000843 Ǘ׏ó|rs`qs.                           
000844     EXEC  SQL                                                  
000845        INSERT  INTO  D57NKM_TBL                               
000846           ( ʔ                                               
000847            ,ʔ                                          
000848            ,Ώۊz                                               
000849            ,敪                                              
000850            ,o^N                                               
000851            ,o^                                                 
000852            ,o^S                                             
000853            ,XVN                                                 
000854            ,XV                                              
000855            ,XV                                           
000856            ,͒S҃R[h)                                                
000857        VALUES                                                     
000858           ( :cTVmjl|ʔ                                       
000859            ,:cTVmjl|ʔ                             
000860            ,:cTVmjl|Ώۊz                                  
000861            ,:cTVmjl|敪                                      
000862            ,:cTVmjl|o^N                                        
000863            ,:cTVmjl|o^                                     
000864            ,:cTVmjl|o^S                                      
000865            ,:cTVmjl|XVN                                        
000866            ,:cTVmjl|XV                                      
000867            ,:cTVmjl|XV                                     
000868            ,:cTVmjl|͒S҃R[h )                            
000869     END-EXEC.  
000870*----------------------------------------------------------------*
000871*    ǉmF                                              *
000872*----------------------------------------------------------------*
000873     EVALUATE  SQLCODE                                            
000874        WHEN   萔|rpknj                                   
000875*--<       ǉ >                                             
000876           COMPUTE  v|ó|Q =  v|ó|Q  +  1    
000877        WHEN   OTHER                                              
000878*--<       ǉG[ >                                       
000879           MOVE     -50               TO  v|G[R[h        
000880           PERFORM  G[菈                                
000881     END-EVALUATE.                                                
000882*                                                                 
000883 o͏|dwhs.                                              
000884     EXIT.                                                        
000885
000886******************************************************************
000887*    I                                                    *
000888******************************************************************
000889 I                             SECTION.                    
000890 I|rs`qs.                                            
000891*                                                                 
000892     PERFORM  caN[Y.                                   
000893*                                                                 
000894     PERFORM  caR~bg.                                   
000895*                                                                 
000896     PERFORM  IbZ[Wo.                                 
000897*                                                                 
000898*--< vOI >                                         
000899     MOVE  萔|             TO  PROGRAM-STATUS.         
000900*                                                                 
000901 I|dwhs.                                              
000902     EXIT.                                                        
000903******************************************************************
000904*    IbZ[Wo                                          *
000905******************************************************************
000906 IbZ[Wo                   SECTION.                    
000907 IbZ[Wó|rs`qs.                                  
000908*                                                                 
000909*----------------------------------------------------------------*
000910*    bZ[Wo͏                                      *
000911*----------------------------------------------------------------*
000912     INITIALIZE                       IF-CHOCO001.                
000913     MOVE  "3"                        TO  P|Cxg.     
000914     MOVE  萔|vOhc       TO  P|\[Xhc.       
000915     MOVE  "0"                        TO  P|AR[h.       
000916     MOVE  "LTRNKK"                   TO  P|e[uhc. 
000917     MOVE  "COUNT"                    TO  P|.         
000918     MOVE  v|́|             TO  P|f[^e.       
000919     MOVE  "Ǘi{jǍ"                         
000920                                      TO  P|̑bZ[W. 
000921     CALL  CLOCO001                USING  IF-CHOCO001.            
000922*                                                                 
000923     INITIALIZE                       IF-CHOCO001.                
000924     MOVE  "3"                        TO  P|Cxg.     
000925     MOVE  萔|vOhc       TO  P|\[Xhc.       
000926     MOVE  "0"                        TO  P|AR[h.       
000927     MOVE  "D57NKK"                   TO  P|e[uhc. 
000928     MOVE  "COUNT"                    TO  P|.         
000929     MOVE  v|ó|P           TO  P|f[^e.       
000930     MOVE  "Ǘo͌"         TO  P|̑bZ[W. 
000931     CALL  CLOCO001                USING  IF-CHOCO001.            
000932*                                                                 
000933     INITIALIZE                       IF-CHOCO001.                
000934     MOVE  "3"                        TO  P|Cxg.     
000935     MOVE  萔|vOhc       TO  P|\[Xhc.       
000936     MOVE  "0"                        TO  P|AR[h.       
000937     MOVE  "D57NKM"                   TO  P|e[uhc. 
000938     MOVE  "COUNT"                    TO  P|.         
000939     MOVE  v|ó|Q          TO  P|f[^e.       
000940     MOVE  "Ǘ_׏o͌"       
000941                                      TO  P|̑bZ[W. 
000942     CALL  CLOCO001                USING  IF-CHOCO001.            
000943
000944*                                                                 
000945*----------------------------------------------------------------*
000946*    IbZ[Wo                                          *
000947*----------------------------------------------------------------*
000948     INITIALIZE                       IF-CHOCO001.                
000949     MOVE  "3"                        TO  P|Cxg.     
000950     MOVE  萔|vOhc       TO  P|\[Xhc.       
000951     MOVE  "0"                        TO  P|AR[h.       
000952     MOVE  "END"                      TO  P|.         
000953     MOVE  萔|vO         TO  P|̑bZ[W. 
000954     CALL  CLOCO001                USING  IF-CHOCO001.            
000955*                                                                 
000956 IbZ[Wó|dwhs.                                    
000957     EXIT.                                                        
000958******************************************************************
000959*    caN[Y                                                *
000960******************************************************************
000961 caN[Y                     SECTION.                    
000962 caN[Y|rs`qs.                                    
000963*                                                                 
000964*--< J[\ N[Y >                                          
000965     EXEC SQL                                                     
000966        CLOSE  CUR1                                               
000967     END-EXEC.                                                    
000968*                                                                 
000969 caN[Y|dwhs.                                      
000970     EXIT.                                                        
000971******************************************************************
000972*    caR~bg                                            *
000973******************************************************************
000974 caR~bg                     SECTION.                    
000975 caR~bg|rs`qs.                                    
000976*                                                                 
000977     EXEC  SQL                                                    
000978        COMMIT  WORK  RELEASE                                     
000979     END-EXEC.                                                    
000980*                                                                 
000981     INITIALIZE                       IF-CHOCO001.                
000982     MOVE  "3"                        TO  P|Cxg.     
000983     MOVE  萔|vOhc       TO  P|\[Xhc.       
000984     MOVE  "0"                        TO  P|AR[h.       
000985     MOVE  "COMMIT"                   TO  P|.         
000986     MOVE  "R~bg{"             TO  P|̑bZ[W. 
000987     CALL  CLOCO001                USING  IF-CHOCO001.            
000988*                                                                 
000989 caR~bg|dwhs.                                      
000990     EXIT.                                                        
000991******************************************************************
000992*    ca[obN                                        *
000993******************************************************************
000994 ca[obN                 SECTION.                    
000995 ca[obN|rs`qs.                                
000996*                                                                 
000997     EXEC  SQL                                                    
000998        ROLLBACK WORK  RELEASE                                    
000999     END-EXEC.                                                    
001000*                                                                 
001001     INITIALIZE                       IF-CHOCO001.                
001002     MOVE  "1"                        TO  P|Cxg.     
001003     MOVE  萔|vOhc       TO  P|\[Xhc.       
001004     MOVE  "9"                        TO  P|AR[h.       
001005     MOVE  "ROLLBACK"                 TO  P|.         
001006     MOVE  "[obN{"         TO  P|̑bZ[W. 
001007     CALL  CLOCO001                USING  IF-CHOCO001.            
001008*                                                                 
001009 ca[obN|dwhs.                                  
001010     EXIT.                                                        
001011******************************************************************
001012*    G[                                                  *
001013******************************************************************
001014 G[菈                       SECTION.                    
001015 G[菈|rs`qs.                                      
001016*                                                                 
001017     MOVE  "Y"                        TO v|ُI|tO.    
001018     INITIALIZE                           IF-CHOCO001.            
001019*                                                                 
001020     EVALUATE  v|G[R[h                                   
001021        WHEN  -10                                                 
001022*--<       nq`bkdڑs >                                 
001023           MOVE  "1"                  TO  P|Cxg      
001024           MOVE  萔|vOhc TO  P|\[Xhc        
001025           MOVE  "9"                  TO  P|AR[h        
001026           MOVE  "CONNECT"            TO  P|          
001027           MOVE  SQLCODE              TO  P|f[^e        
001028           MOVE  SQLERRMC             TO  P|̑bZ[W  
001029           CALL  CLOCO001          USING  IF-CHOCO001             
001030*                                                                 
001031        WHEN  -20                                                 
001032*--<       e[uJ[\I[vs >                     
001033           MOVE  "1"                  TO  P|Cxg      
001034           MOVE  萔|vOhc TO  P|\[Xhc        
001035           MOVE  "9"                  TO  P|AR[h        
001036           MOVE  "LTRNKK"             TO  P|e[uhc  
001037           MOVE  "OPEN"               TO  P|          
001038           MOVE  SQLCODE              TO  P|f[^e        
001039           MOVE  SQLERRMC             TO  P|̑bZ[W  
001040           CALL  CLOCO001          USING  IF-CHOCO001             
001041*                                                                 
001042        WHEN  -30                                                 
001043*--<       e[uǍs >                                 
001044           MOVE  "1"                  TO  P|Cxg      
001045           MOVE  萔|vOhc TO  P|\[Xhc        
001046           MOVE  "9"                  TO  P|AR[h        
001047           MOVE  "LTRNKK"             TO  P|e[uhc  
001048           MOVE  "FETCH"              TO  P|          
001049           MOVE  SQLCODE              TO  P|f[^e        
001050           MOVE  SQLERRMC             TO  P|̑bZ[W  
001051           CALL  CLOCO001          USING  IF-CHOCO001             
001052*                                                                 
001053        WHEN  -40                                                 
001054*--<       Ǘǉs >                                   
001055           MOVE  "1"                  TO  P|Cxg      
001056           MOVE  萔|vOhc TO  P|\[Xhc        
001057           MOVE  "9"                  TO  P|AR[h        
001058           MOVE  "D57NKK"             TO  P|e[uhc  
001059           MOVE  "INSERT"             TO  P|          
001060           MOVE  SQLCODE              TO  P|f[^e        
001061           MOVE  SQLERRMC             TO  P|̑bZ[W  
001062           CALL  CLOCO001          USING  IF-CHOCO001             
001063*                                                                 
001064        WHEN  -50                                                 
001065*--<       Ǘ|גǉs >                       
001066           MOVE  "1"                  TO  P|Cxg      
001067           MOVE  萔|vOhc TO  P|\[Xhc        
001068           MOVE  "9"                  TO  P|AR[h        
001069           MOVE  "D57NKM"             TO  P|e[uhc  
001070           MOVE  "INSERT"             TO  P|          
001071           MOVE  SQLCODE              TO  P|f[^e        
001072           MOVE  SQLERRMC             TO  P|̑bZ[W  
001073           CALL  CLOCO001          USING  IF-CHOCO001             
001074                                                                  
001075*                                                                 
001076        WHEN  OTHER                                               
001077           MOVE  "N"                  TO v|ُI|tO     
001078     END-EVALUATE.                                                
001079*                                                                 
001080     IF v|ُI|tO  =  "Y"                              
001081        PERFORM  ca[obN                             
001082*                                                                 
001083        PERFORM  IbZ[Wo                               
001084*                                                                 
001085*--<    vOُĨ^[R[h >                      
001086        MOVE  萔|ُ          TO  PROGRAM-STATUS          
001087*                                                                 
001088        EXIT  PROGRAM                                             
001089     END-IF.                                                      
001090*                                                                 
001091 G[|dwhs.                                            
001092     EXIT.                                                        
001093******************************************************************
001094*                  END OF PROGRAM                                *
001095******************************************************************
