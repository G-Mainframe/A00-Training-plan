000010******************************************************************
000020*         CP(A)                                     *
000030*      1. vO  : ]pe[u             *
000040*                        iD346KTB_TBL)                          *
000050*      2. vOID  : COBIS420                               *
000060*      3. Tv      : EDB.{ADB.ׂ   *
000070*                          A_mnEă[XR[h        *
000080*                            KEYƂAJOINŎw                 *
000090*                           DB.׏̌      *
000100*                           ڍsڑΔ\̈ڍsQ   *
000110*      4. 쐬        : G                                 *
000120*      5. 쐬        : 2005.04.6                              *
000130******************************************************************
000140*                                                                 
000150******************************************************************
000160*    hcdmshehb`shnm  chuhrhnm              *
000170******************************************************************
000180 IDENTIFICATION                       DIVISION.                   
000190*                                                                 
000200 PROGRAM-ID.                          COBIS420.                   
000210******************************************************************
000220*    dmuhqnmldms        chuhrhnm              *
000230******************************************************************
000240 ENVIRONMENT                          DIVISION.                   
000250******************************************************************
000260*    hmots|ntsots      rdbshnm                *
000270******************************************************************
000280 INPUT-OUTPUT                         SECTION.                    
000290 FILE-CONTROL.                                                    
000300     SELECT         ̓t@C      ASSIGN    TO      U01       
000310     FILE      STATUS     IS          v|                    
000320     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000330*                                                                 
000340     SELECT         o̓t@C      ASSIGN    TO     U11        
000350     FILE      STATUS     IS          v|                    
000360     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000370******************************************************************
000380*    c`s`                      chuhrhnm              *
000390******************************************************************
000400 DATA                                 DIVISION.                   
000410******************************************************************
000420*    ehkd                      rdbshnm                *
000430******************************************************************
000440 FILE                                 SECTION.                    
000450*----------------------------------------------------------------*
000460*    ̓t@C Kpt@C                             *
000470*----------------------------------------------------------------*
000480 FD  ̓t@C                                                 
000490     LABEL  RECORD    IS              STANDARD                    
000500     BLOCK  CONTAINS  0               RECORDS.                    
000510*                                                                 
000520 01  ́|R[h.                                              
000530     COPY   CISPF001   REPLACING      ==()==  BY  ==́|==.     
000540*----------------------------------------------------------------*
000550*    o̓t@C  ]pt@C                     
000560*----------------------------------------------------------------*
000570 FD  o̓t@C                                                 
000580     LABEL     RECORD     IS          STANDARD                    
000590     BLOCK     CONTAINS   0           RECORDS.                    
000600*                                                                 
000610 01  ó|R[h.                                              
000620     COPY  CISUF421    REPLACING      ==()==  BY  ==ó|==.     
000630******************************************************************
000640*    vnqjhmf|rsnq`fd  rdbshnm              *
000650******************************************************************
000660 WORKING-STORAGE                      SECTION.                    
000670*----------------------------------------------------------------*
000680*    zXgϐ`GA                                        *
000690*----------------------------------------------------------------*
000700     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +12.
           02  SQLFPN-FILENAME PIC X(12) VALUE "COBIS420.PCO".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(151) VALUE "select ă[X  ,_  
      -     ",_敪   into :b1,:b2,:b3  from IKOTBL002 where ((_
      -    "mn=:b4 and ă[XR[h=:b5) and 菈R[h=:b6)
      -    "".

       01  SQ0003 GLOBAL.
           02  FILLER PIC X(82) VALUE "select VR[h  ,}   in
      -    "to :b1,:b2  from IKOTBL001 where R[h=:b3".

       01  SQ0004 GLOBAL.
           02  FILLER PIC X(160) VALUE "select z  ,QI  
      -    ",QN  ,ʔ   into :b1,:b2,:b3,:b4  from LTRS
      -     "KM where (((_ԍ=:b5 and ă[XR[h=:b6) and 
      -    "R[h=".

           02  FILLER PIC X(28) VALUE ":b7) and ˍσtO=null )".

       01  SQ0005 GLOBAL.
           02  FILLER PIC X(77) VALUE "select R[h   into :b
      -    "1  from IKOTBL005 where VR[h=:b2".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +287813.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +20.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 20 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 20 TIMES.


       01  SQ0001 GLOBAL.
           02  FILLER PIC X(160) VALUE "select LTRSMK._mn  ,LTR
      -    "SMK.ă[XR[h  ,LTRSMK.菈R[h  ,LTRSMM.
      -    "R[h  ,LTRSMM.QI  ,LTRSMM.
      -    "QN".

           02  FILLER PIC X(160) VALUE "  ,LTRSMM.[XJnQI
      -    "  ,LTRSMM.[XJnQN  ,LTRSMM.z  ,LTRSM
      -    "M.  ,LTRSMM._mn  ,LTRSMM.f[^쐬
      -    "QI  ".

           02  FILLER PIC X(160) VALUE ",LTRSMM.f[^쐬QN
      -    "  ,LTRSMM.R[h  ,LTRSMM.ă[XR[h  ,LTRSMM.
      -    "菈R[h  ,LTRSMM.R[h  ,LTRSMM.
      -    "  ,LTRSM".

           02  FILLER PIC X(159) VALUE "M._񖾍ׂmn  ,LTRSMM.R[h
      -     "V[PX   from LTRSMK ,LTRSMM where (((LTRSMM._m
      -    "n=LTRSMK._mn and LTRSMM.ă[XR[h=LTRSMK.ă
      -    "[XR[".

           02  FILLER PIC X(147) VALUE "h) and ((SUBSTR(LTRSMM.
      -    "R[h,1,1)=:b1 or LTRSMM.R[h=:b2) or LTRSMM.
      -    "R[h=:b3)) and LTRSMM.z<>0)           ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +277.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +281.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +786.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +346.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +94.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +414.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +20.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +189.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +151.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +645.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +6.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +228.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +82.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +706.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +255.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +188.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +818.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +298.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +77.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +1067.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +321.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +1159.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000710 01 vr|R[hP            PIC  X(01) VALUE "1".       
000720 01 vr|R[hQ            PIC  X(02) VALUE "46".      
000730 01 vr|R[hR            PIC  X(02) VALUE "56".      
000740 01 vr|_mn                PIC  X(10).                 
000750 01 vr|A                        PIC  9(03) VALUE 0.         
000760 01 vr||N          PIC  9(04).                 
000770 01 vr||          PIC  9(02).                 
000780 01 vr||          PIC  9(02).                 
000790 01 vr||N        PIC  9(06).                 
000800 01 vr|              PIC  9(08).                 
000810 01 vr|[XJn|N            PIC  9(04).                 
000820 01 vr|[XJn|            PIC  9(02).                 
000830 01 vr|                        PIC  S9(02).                
000840 01 vr||N                PIC  9(06).                 
000850*--< R[h >                                             
000860 01 vr|U                        PIC  9(01) VALUE 0.         
000870 01 vr|@U                PIC  X(01) VALUE "1".       
000880 01 vr|`                        PIC  9(01) VALUE 2.         
000890 01 vr|񑩎`                    PIC  X(01) VALUE "5".       
000900 01 vr|                    PIC  9(01) VALUE 3.         
000910 01 vr|@            PIC  X(01) VALUE "3".       
000920 01 vr|ler㗝              PIC  9(01) VALUE 4.         
000930 01 vr|㗝                    PIC  X(01) VALUE "4".       
000940*--< _(No.3)̏1  >                                     
000950 01 vr|_                    PIC  X(01) VALUE "6".       
000960 01 vr|_ނP                PIC  X(01).                 
000970*--< sσtO >                                         
000980 01 vr|                      PIC  9(8).                  
000990 01 vr|f[^쐬|N    PIC  9(8).                  
001000*--< \P  >                                            
001010 01 vr|\PI          PIC  X(02).                 
001020 01 vr|o͐R[h          PIC  X(03).                 
001021*                                                                 
001030*--< nq`bkdʕϐ >                                       
001040     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
001050*                        M40MAB.CBL                               
001060*--< nq`bkd  rpks >                               
000010*--rpkʕϐ
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
001070     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
001080*                                                                 
001090*--< { e[u >                                          
001100     
      *    EXEC  SQL   INCLUDE  LTRSMK.CBL            END-EXEC.
001110*                                                                 
001120*--<  e[u >                                          
000010************************************************
000020* i{j(LTRSMK)
000030************************************************
000040 01  ksqrlj|_mn PIC  X(010).
000050 01  ksqrlj|ă[XR[h PIC S9(001) COMP-3.
000060 01  ksqrlj|ƏR[h PIC S9(004) COMP-3.
000070 01  ksqrlj|S҃R[h PIC S9(004) COMP-3.
000080 01  ksqrlj|_|zP PIC S9(013) COMP-3.
000090 01  ksqrlj|_|_zP PIC S9(013) COMP-3.
000100 01  ksqrlj|_|zQ PIC S9(013) COMP-3.
000110 01  ksqrlj|_|_zQ PIC S9(013) COMP-3.
000120 01  ksqrlj|_|zR PIC S9(013) COMP-3.
000130 01  ksqrlj|_|_zR PIC S9(013) COMP-3.
000140 01  ksqrlj|_|zS PIC S9(013) COMP-3.
000150 01  ksqrlj|_|_zS PIC S9(013) COMP-3.
000160 01  ksqrlj|_|zT PIC S9(013) COMP-3.
000170 01  ksqrlj|_|_zT PIC S9(013) COMP-3.
000180 01  ksqrlj|_|zU PIC S9(013) COMP-3.
000190 01  ksqrlj|_|_zU PIC S9(013) COMP-3.
000200 01  ksqrlj|_|zV PIC S9(013) COMP-3.
000210 01  ksqrlj|_|_zV PIC S9(013) COMP-3.
000220 01  ksqrlj|_|zW PIC S9(013) COMP-3.
000230 01  ksqrlj|_|_zW PIC S9(013) COMP-3.
000240 01  ksqrlj|_|zX PIC S9(013) COMP-3.
000250 01  ksqrlj|_|_zX PIC S9(013) COMP-3.
000260 01  ksqrlj|_|zPO PIC S9(013) COMP-3.
000270 01  ksqrlj|_|_zPO PIC S9(013) COMP-3.
000280 01  ksqrlj|菈R[h PIC S9(002) COMP-3.
000290 01  ksqrlj|S|I PIC S9(001) COMP-3.
000300 01  ksqrlj|S|N PIC  X(006).
000310 01  ksqrlj|SN|I PIC S9(001) COMP-3.
000320 01  ksqrlj|SN|N PIC  X(004).
000330 01  ksqrlj|_mn PIC  X(010).
000340 01  ksqrlj|V_mn PIC  X(010).
000350 01  ksqrlj|R[hV[PXP PIC S9(001) COMP-3.
000360 01  ksqrlj|R[hV[PXQ PIC S9(001) COMP-3.
000370 01  ksqrlj|R[hV[PXR PIC S9(001) COMP-3.
000380 01  ksqrlj|R[hV[PXS PIC S9(001) COMP-3.
000390 01  ksqrlj|R[hV[PXT PIC S9(001) COMP-3.
000400 01  ksqrlj|R[hV[PXU PIC S9(001) COMP-3.
000410 01  ksqrlj|R[hV[PXV PIC S9(001) COMP-3.
000420 01  ksqrlj|R[hV[PXW PIC S9(001) COMP-3.
000430 01  ksqrlj|R[hV[PXX PIC S9(001) COMP-3.
000440 01  ksqrlj|R[hV[PXPO PIC S9(001) COMP-3.
000450 01  ksqrlj|_~[OOP PIC  X(022).
000460 01  ksqrlj|ʏ PIC  X(035).
001130     
      *    EXEC  SQL  INCLUDE  LTRSMM.CBL            END-EXEC.
001140*                                                                 
001150*--< ׏ e[u >                                      
000010************************************************
000020* iׁj(LTRSMM)
000030************************************************
000040 01  ksqrll|_mn PIC  X(010).
000050 01  ksqrll|ă[XR[h PIC S9(001) COMP-3.
000060 01  ksqrll|_񖾍ׂmn PIC S9(002) COMP-3.
000070 01  ksqrll|R[hV[PX PIC S9(001) COMP-3.
000080 01  ksqrll|R[h PIC  X(008).
000090 01  ksqrll|R[h PIC  X(002).
000100 01  ksqrll|qdeԍ PIC  X(016).
000110 01  ksqrll|_|I PIC S9(001) COMP-3.
000120 01  ksqrll|_|N PIC  X(006).
000130 01  ksqrll||I PIC S9(001) COMP-3.
000140 01  ksqrll||N PIC  X(006).
000150 01  ksqrll||I PIC S9(001) COMP-3.
000160 01  ksqrll||N PIC  X(006).
000170 01  ksqrll|eύX|I PIC S9(001) COMP-3.
000180 01  ksqrll|eύX|N PIC  X(006).
000190 01  ksqrll|Nx|I PIC S9(001) COMP-3.
000200 01  ksqrll|Nx|N PIC  X(004).
000210 01  ksqrll|_~[OOP PIC  X(010).
000220 01  ksqrll|z PIC S9(013) COMP-3.
000230 01  ksqrll| PIC S9(013) COMP-3.
000240 01  ksqrll||I PIC S9(001) COMP-3.
000250 01  ksqrll||N PIC  X(006).
000260 01  ksqrll|R[h PIC S9(001) COMP-3.
000270 01  ksqrll|őE敪 PIC S9(001) COMP-3.
000280 01  ksqrll|f[^쐬|I PIC S9(001) COMP-3.
000290 01  ksqrll|f[^쐬|N PIC  X(006).
000300 01  ksqrll|_~[OOQ PIC  X(010).
000310 01  ksqrll|[XJn|I PIC S9(001) COMP-3.
000320 01  ksqrll|[XJn|N PIC  X(006).
000330 01  ksqrll|[XI|I PIC S9(001) COMP-3.
000340 01  ksqrll|[XI|N PIC  X(006).
000350 01  ksqrll|[X PIC S9(003) COMP-3.
000360 01  ksqrll|t@CiXJn|I PIC S9(001) COMP-3.
000370 01  ksqrll|t@CiXJn|N PIC  X(006).
000380 01  ksqrll|t@CiX|I PIC S9(001) COMP-3.
000390 01  ksqrll|t@CiX|N PIC  X(006).
000400 01  ksqrll|t@CiX PIC S9(003) COMP-3.
000410 01  ksqrll|菈R[h PIC S9(002) COMP-3.
000420 01  ksqrll|[X PIC S9(013) COMP-3.
000430 01  ksqrll|xTCN PIC S9(002) COMP-3.
000440 01  ksqrll|x PIC S9(003) COMP-3.
000450 01  ksqrll|x PIC S9(002) COMP-3.
000460 01  ksqrll|vZ PIC S9(001) COMP-3.
000470 01  ksqrll|u PIC S9(003) COMP-3.
000480 01  ksqrll|adfhm PIC S9(001) COMP-3.
000490 01  ksqrll|P񃊁[XxI 
000491                                              PIC S9(001) COMP-3.
000500 01  ksqrll|P񃊁[XxN PIC  X(006).
000510 01  ksqrll|P񃊁[Xx|I PIC S9(001) COMP-3.
000520 01  ksqrll|P񃊁[Xx|N PIC  X(006).
000530 01  ksqrll|O[Xx|I PIC S9(001) COMP-3.
000540 01  ksqrll|O[Xx|N PIC  X(006).
000550 01  ksqrll|O[X PIC S9(013) COMP-3.
000560 01  ksqrll|O[X PIC S9(013) COMP-3.
000570 01  ksqrll|O[Xxz PIC S9(013) COMP-3.
000580 01  ksqrll|O[Xp PIC S9(013) COMP-3.
000590 01  ksqrll|O[X[JnNI 
000591                                              PIC S9(001) COMP-3.
000600 01  ksqrll|O[X[JnNN PIC  X(004).
000610 01  ksqrll|O[X[INI  
000611                                              PIC S9(001) COMP-3.
000620 01  ksqrll|O[X[INN PIC  X(004).
000630 01  ksqrll|O[ PIC S9(003) COMP-3.
000640 01  ksqrll|{ PIC S9(002)V9(9) COMP-3.
000650 01  ksqrll| PIC S9(002)V9(9) COMP-3.
000660 01  ksqrll|xz PIC S9(013) COMP-3.
000670 01  ksqrll|v PIC S9(013) COMP-3.
000680 01  ksqrll|ev PIC S9(013) COMP-3.
000690 01  ksqrll|őz PIC S9(013) COMP-3.
000700 01  ksqrll|Ŏx敪 PIC S9(001) COMP-3.
000710 01  ksqrll|Őŗ PIC S9(002)V9(1) COMP-3.
000720 01  ksqrll|ŃR[h PIC S9(002) COMP-3.
000730 01  ksqrll|pŒ莑Y PIC S9(013) COMP-3.
000740 01  ksqrll|pی PIC S9(013) COMP-3.
000750 01  ksqrll|pێ痿 PIC S9(013) COMP-3.
000760 01  ksqrll|p̂P PIC S9(013) COMP-3.
000770 01  ksqrll|p̂Q PIC S9(013) COMP-3.
000780 01  ksqrll|p敪 PIC S9(001) COMP-3.
000790 01  ksqrll|xR[h PIC  X(004).
000800 01  ksqrll|sR[h PIC  X(007).
000810 01  ksqrll|ԍ PIC  X(007).
000820 01  ksqrll|a PIC  X(001).
000830 01  ksqrll|xm|I PIC S9(001) COMP-3.
000840 01  ksqrll|xm|N PIC  X(006).
000850 01  ksqrll|xmNx|I PIC S9(001) COMP-3.
000860 01  ksqrll|xmNx|N PIC  X(004).
000870 01  ksqrll|S҃R[h PIC  X(004).
000880 01  ksqrll|xFTuVXe敪 PIC  X(001).
000890 01  ksqrll|xFV[PX PIC S9(005) COMP-3.
000900 01  ksqrll|xFxF|I 
000901                                              PIC S9(001) COMP-3.
000910 01  ksqrll|xFxF|N PIC  X(006).
000920 01  ksqrll|xFS҃R[h PIC S9(004) COMP-3.
000930 01  ksqrll|cxFTuVXe敪 PIC  X(001).
000940 01  ksqrll|cxFV[PX PIC S9(005) COMP-3.
000950 01  ksqrll|cxFxF|I 
000951                                              PIC S9(001) COMP-3.
000960 01  ksqrll|cxFxF|N PIC  X(006).
000970 01  ksqrll|cxFS҃R[h PIC S9(004) COMP-3.
000980 01  ksqrll|Oc PIC S9(013) COMP-3.
000990 01  ksqrll|O{c PIC S9(013) COMP-3.
001000 01  ksqrll|OŎc PIC S9(013) COMP-3.
001010 01  ksqrll|cz PIC S9(013) COMP-3.
001020 01  ksqrll|cx|I PIC S9(001) COMP-3.
001030 01  ksqrll|cx|N PIC  X(006).
001040 01  ksqrll|_~[OOR PIC  X(024).
001050 01  ksqrll|[X PIC S9(013) COMP-3.
001060 01  ksqrll|mds[X PIC S9(013) COMP-3.
001070 01  ksqrll|񗘑 PIC S9(013) COMP-3.
001080 01  ksqrll|񌳖{xz PIC S9(013) COMP-3.
001090 01  ksqrll|񌳖{c PIC S9(013) COMP-3.
001100 01  ksqrll|c PIC S9(013) COMP-3.
001110 01  ksqrll|Ŋz PIC S9(013) COMP-3.
001120 01  ksqrll|Ŏc PIC S9(013) COMP-3.
001130 01  ksqrll|񏔔p PIC S9(013) COMP-3.
001140 01  ksqrll|xz PIC S9(013) COMP-3.
001150 01  ksqrll|ŗ PIC S9(002)V9(1) COMP-3.
001160 01  ksqrll|_~[ PIC  X(014).
001170 01  ksqrll|xf[^쐬|I PIC S9(001) COMP-3.
001180 01  ksqrll|xf[^쐬|N PIC  X(006).
001190 01  ksqrll|f[^쐬|IQ PIC S9(001) COMP-3.
001200 01  ksqrll|f[^쐬|NQ PIC  X(006).
001210 01  ksqrll|df[^쐬|I PIC S9(001) COMP-3.
001220 01  ksqrll|df[^쐬|N PIC  X(006).
001230 01  ksqrll|_~[OOS PIC  X(018).
001240 01  ksqrll|ʏ PIC  X(035).
001160     
      *    EXEC  SQL  INCLUDE  LTRSKM.CBL            END-EXEC.
001170*                                                                 
001180*--< ϊe[u >                                               
000010************************************************
000020* i׏j(LTRSKM)
000030************************************************
000040 01  ksqrjl|jdxڐR[h PIC  X(008).
000050 01  ksqrjl|_ԍ PIC  X(009).
000060 01  ksqrjl|ă[XR[h PIC S9(001) COMP-3.
000070 01  ksqrjl|\ PIC  X(007).
000080 01  ksqrjl|R[h PIC  X(003).
000090 01  ksqrjl|x PIC S9(003) COMP-3.
000100 01  ksqrjl|[ PIC S9(003) COMP-3.
000110 01  ksqrjl| PIC S9(001) COMP-3.
000120 01  ksqrjl|Z敪 PIC S9(001) COMP-3.
000130 01  ksqrjl|ƏR[h PIC S9(004) COMP-3.
000140 01  ksqrjl|s|I PIC S9(001) COMP-3.
000150 01  ksqrjl|s|N PIC  X(006).
000160 01  ksqrjl|菈R[h PIC S9(002) COMP-3.
000170 01  ksqrjl|ʔ PIC S9(009) COMP-3.
000180 01  ksqrjl||I PIC S9(001) COMP-3.
000190 01  ksqrjl||N PIC  X(006).
000200 01  ksqrjl|Ł|敪 PIC S9(001) COMP-3.
000210 01  ksqrjl|Ł|z PIC S9(013) COMP-3.
000220 01  ksqrjl|Ł|ŃR[h PIC S9(002) COMP-3.
000230 01  ksqrjl|[X PIC S9(013) COMP-3.
000240 01  ksqrjl|z PIC S9(013) COMP-3.
000250 01  ksqrjl|z PIC S9(013) COMP-3.
000260 01  ksqrjl|敪 PIC S9(001) COMP-3.
000270 01  ksqrjl|sbc PIC S9(007) COMP-3.
000280 01  ksqrjl|R[h PIC  X(003).
000290 01  ksqrjl|[UR[h PIC  X(008).
000300 01  ksqrjl|R[h PIC  X(002).
000310 01  ksqrjl|ˍσtO PIC  X(001).
000320 01  ksqrjl|_~[OOP PIC  X(005).
000330 01  ksqrjl|ʏ PIC  X(035).
001190     
      *    EXEC  SQL  INCLUDE  IKOTBL001.CBL         END-EXEC.
001200*                                                                 
001210*--< _ޓϊe[u >                                     
000010************************************************
000020* ϊe[u(IKOTBL001)
000030************************************************
000040 01  hjnOOP|R[h PIC  X(008).
000050 01  hjnOOP|ړIbc PIC  X(001).
000060 01  hjnOOP|VR[h PIC  X(007).
000070 01  hjnOOP|} PIC  X(003).
000080 01  hjnOOP|^MR[h PIC  X(007).
000090 01  hjnOOP|񂹃R[h PIC  X(008).
000100 01  hjnOOP|[UR[h PIC  X(008).
000110 01  hjnOOP|ʂbc PIC  X(001).
001220     
      *    EXEC  SQL  INCLUDE  IKOTBL002.CBL         END-EXEC.
001230*                                                                 
001240*--< R[hϊe[u >                                 
000010************************************************
000020* _ޓϊe[u(IKOTBL002)
000030************************************************
000040 01  hjnOOQ|_mn PIC  X(009).
000050 01  hjnOOQ|ă[XR[h PIC S9(001) COMP-3.
000060 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000070 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000080 01  hjnOOQ|ă[X PIC S9(002) COMP-3.
000090 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000100 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000110 01  hjnOOQ|_ PIC  X(003).
000120 01  hjnOOQ|_敪 PIC  X(001).
000130 01  hjnOOQ|菇 PIC  X(001).
001250     
      *    EXEC  SQL  INCLUDE  IKOTBL005.CBL         END-EXEC.
001260*                                                                 
000010************************************************
000020* R[hϊe[u(IKOTBL005)
000030************************************************
000040 01  hjnOOT|R[h PIC  X(003).
000050 01  hjnOOT|ANZX敪 PIC  X(001).
000060 01  hjnOOT|菈R[h PIC  X(002).
000070 01  hjnOOT|ŃR[h PIC  X(002).
000080 01  hjnOOT|Z敪 PIC S9(001) COMP-3.
000090 01  hjnOOT|萔R[h PIC  X(002).
000100 01  hjnOOT|ă[XR[h PIC S9(001) COMP-3.
000110 01  hjnOOT|v敪 PIC S9(001) COMP-3.
000120 01  hjnOOT|敪P PIC S9(001) COMP-3.
000130 01  hjnOOT|P PIC  X(001).
000140 01  hjnOOT|敪Q PIC  X(001).
000150 01  hjnOOT|_ޏP PIC S9(001) COMP-3.
000160 01  hjnOOT|VR[h PIC  X(003).
000170 01  hjnOOT|VR[hQ PIC  X(003).
001270     
      *    EXEC  SQL  END  DECLARE          SECTION  END-EXEC.
001280*                                                                 
001290*----------------------------------------------------------------*
001300*    vnqjGA                                              *
001310*----------------------------------------------------------------*
001320 01  vnqj|GA.                                            
001330*--< G[p >                                               
001340     03  v|G[R[h             PIC S9(04).                 
001350*                                                                 
001360*--< tOAA >                                               
001370     03  tOAA.                                            
001380         05  v|I|tO         PIC  X(01).                 
001390         05  v|ُI|tO     PIC  X(01).                 
001400*--< t@C >                                               
001410     03  v|ԃGA.                                          
001420         05  v|                 PIC  X(02).                 
001430*                                                                 
001440*--< GA >                                                 
001450     03  GA.                                              
001460         05  v|́|           PIC  9(09).                 
001470         05  v|́|Q         PIC  9(09).                 
001480         05  v|́|XV       PIC  9(09).                 
001490         05  v|ó|           PIC  9(09).                 
001500*--< L[GA >                                                 
001510     03  jdx|GA.                                          
001520        05  mdvL[.                                           
001530            07 m|_ԍ           PIC  X(10).                 
001540            07 m|ă[X       PIC  9(02).                 
001550            07 m|_           PIC  X(03).                 
001560        05  nkcL[.                                           
001570            07 n|_ԍ           PIC  X(10).                 
001580            07 n|ă[X       PIC  9(02).                 
001590            07 n|_           PIC  X(03).                 
001600*----------------------------------------------------------------*
001610*    Ԓ`                                                *
001620*----------------------------------------------------------------*
001630*--< ʏ >                                                   
001640 01  v|ʏ.                                                
001650     03  v|VXet.                                        
001660         05  v|I                 PIC  X(02) VALUE  "20".     
001670         05  v|N               PIC  X(06).                 
001680     03  v|VXe             PIC  X(08).                 
001690     03  v|S                   PIC  X(08) VALUE "IKOPG   ".
001700*----------------------------------------------------------------*
001710*    Tu[`                                              *
001720*----------------------------------------------------------------*
001730 01  CALL-AREA.                                                   
001740*--< ʃOTu[` >                                       
001750     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001760     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001770*                                                                 
001780*----------------------------------------------------------------*
001790*    bnoẍ                                                *
001800*----------------------------------------------------------------*
001810*--< ʃOpp[^ >                                       
001820 01  IF-CHOCO001.                                                 
001830     COPY  CHOCO001  REPLACING ==()== BY  ==P|==.             
001840*                                                                 
001850*----------------------------------------------------------------*
001860*    hmht@CǍTu[`pp^̈                *
001870*----------------------------------------------------------------*
001880 01  PARA-AREA.                                                   
001890     COPY CPBCO001.                                               
001900******************************************************************
001910*    萔pf[^`GA                                      *
001920******************************************************************
001930 CONSTANT                             SECTION.                    
001940 01  萔̈.                                                    
001950     03  萔|vOhc         PIC  X(08) VALUE "COBIS420".
001960     03  萔|vO           PIC  X(80)                  
001970                               VALUE "]pڍs".
001980     03  萔|rpknj             PIC S9(04)  VALUE  ZERO.    
001990     03  萔|rpkdmc           PIC S9(04)  VALUE  0100.    
002000     03  萔|               PIC S9(04)  VALUE  ZERO.    
002010     03  萔|ُ               PIC S9(04)  VALUE  0009.    
002020******************************************************************
002030*    oqnbdctqd            chuhrhnm              *
002040******************************************************************
002050 PROCEDURE                            DIVISION.                   
002060*                                                                 
002070     PERFORM  .                                           
002080*                                                                 
002090     PERFORM  又  UNTIL  v|I|tO  =  "Y".            
002100*                                                                 
002110     PERFORM  I.                                           
002120*                                                                 
002130     STOP     RUN.                                                
002140*                                                                 
002150******************************************************************
002160*                                                        *
002170******************************************************************
002180                              SECTION.                    
002190 |rs`qs.                                            
002200*                                                                 
002210*----------------------------------------------------------------*
002220*    JnbZ[Wo͏                                      *
002230*----------------------------------------------------------------*
002240     INITIALIZE                       IF-CHOCO001.                
002250     MOVE  "3"                        TO  P|Cxg.     
002260     MOVE  萔|vOhc       TO  P|\[Xhc.       
002270     MOVE  "0"                        TO  P|AR[h.       
002280     MOVE  "START"                    TO  P|.         
002290     MOVE  萔|vO         TO  P|̑bZ[W. 
002300     CALL  CLOCO001                USING  IF-CHOCO001.            
002310*                                                                 
002320*----------------------------------------------------------------*
002330*    Ɨ̈̏l                                        *
002340*----------------------------------------------------------------*
002350     MOVE  SPACE                      TO  vnqj|GA.       
002360     INITIALIZE                           vnqj|GA.       
002370*--< bott擾 >                                           
002380     ACCEPT  v|N               FROM  DATE.                 
002390*                                                                 
002400*--< bot擾 >                                           
002410     ACCEPT  v|VXe         FROM  TIME.                 
002420*                                                                 
002430*--< nq`bkdڑ >                                           
002440     PERFORM   nq`bkdڑ.                                  
002450*                                                                 
002460*--< e[uJ[\錾 >                                   
002470     PERFORM  e[uJ[\`.                           
002480*                                                                 
002490*--< t@CI[v >                                           
002500     PERFORM  t@CI[v.                                   
002510*                                                                 
002520*--< e[uJ[\Ǎ(P) >                           
002530     PERFORM  e[uJ[\Ǎ.                           
002540*                                                                 
002550*--< KpǍ(P) >                                 
002560     PERFORM   KpǍ.                                
002570 |dwhs.                                              
002580     EXIT.                                                        
002590******************************************************************
002600*    nq`bkdڑ                                            *
002610******************************************************************
002620 nq`bkdڑ                     SECTION.                    
002630 nq`bkdڑ|rs`qs.                                    
002640*                                                                 
002650*--< caڑp擾 >                                   
002660     CALL  COBCO001                USING  PARA-AREA.              
002670*                                                                 
002680     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002690     MOVE  PARA-USERNAME              TO  USERNAME.               
002700     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002710*                                                                 
002720*----------------------------------------------------------------*
002730*    Jnڑ                                                    *
002740*----------------------------------------------------------------*
002750     IF    DB-STRING  =  SPACE                                    
002760        
      *       EXEC SQL                                                  
002770*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002780*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002790     ELSE                                                         
002800        
      *       EXEC SQL                                                  
002810*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002820*            USING  :DB-STRING                                    
002830*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002840     END-IF.                                                      
002850*                                                                 
002860*----------------------------------------------------------------*
002870*    ڑmF                                                    *
002880*----------------------------------------------------------------*
002890     EVALUATE  SQLCODE                                            
002900        WHEN   萔|rpknj                                   
002910           CONTINUE                                               
002920        WHEN   OTHER                                              
002930*--< ڑG[ >                                                 
002940           MOVE     -10               TO  v|G[R[h        
002950           PERFORM  G[菈                                
002960     END-EVALUATE.                                                
002970*                                                                 
002980 nq`bkdڑ|dwhs.                                      
002990     EXIT.                                                        
003000******************************************************************
003010 e[uJ[\`             SECTION.                    
003020 e[uJ[\`|rs`qs.                            
003030*                                                                 
003040*----------------------------------------------------------------*
003050*    J[\`                                            *
003060*----------------------------------------------------------------*
003070     
      *    EXEC SQL                                                     
003080*       DECLARE CUR1  CURSOR FOR                                  
003090*          SELECT  LTRSMK._mn                            
003100*                 ,LTRSMK.ă[XR[h                          
003110*                 ,LTRSMK.菈R[h                      
003120*                 ,LTRSMM.R[h                          
003130*                 ,LTRSMM.QI                    
003140*                 ,LTRSMM.QN                  
003150*                 ,LTRSMM.[XJnQI                      
003160*                 ,LTRSMM.[XJnQN                    
003170*                 ,LTRSMM.z                            
003180*                 ,LTRSMM.                              
003190*                 ,LTRSMM._mn                            
003200*                 ,LTRSMM.f[^쐬QI                  
003210*                 ,LTRSMM.f[^쐬QN                
003220*                 ,LTRSMM.R[h                          
003230*                 ,LTRSMM.ă[XR[h                          
003240*                 ,LTRSMM.菈R[h                      
003250*                 ,LTRSMM.R[h                          
003260*                 ,LTRSMM.                              
003270*                 ,LTRSMM._񖾍ׂmn                            
003280*                 ,LTRSMM.R[hV[PX                      
003290*          FROM  LTRSMK                                           
003300*               ,LTRSMM                                           
003310*          WHERE LTRSMM._mn   = LTRSMK._mn      
003320*          AND   LTRSMM.ă[XR[h = LTRSMK.ă[XR[h    
003330*          AND   ( SUBSTR (LTRSMM.R[h,1,1) =           
003340*                                          :vr|R[hP
003350*                  OR LTRSMM.R[h =                     
003360*                                          :vr|R[hQ
003370*                  OR LTRSMM.R[h =                     
003380*                                          :vr|R[hR
003390*                 )                                               
003400*          AND   LTRSMM.z <> 0                         
003410*    END-EXEC.
003420*----------------------------------------------------------------*
003430*    J[\nodm                                        *
003440*----------------------------------------------------------------*
003450     
      *    EXEC  SQL                                                    
003460*       OPEN  CUR1                                                
003470*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               vr|R[hP
               SQL-SQHSTV(1)
           MOVE 1 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               vr|R[hQ
               SQL-SQHSTV(2)
           MOVE 2 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               vr|R[hR
               SQL-SQHSTV(3)
           MOVE 2 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
003480*                                                                 
003490*----------------------------------------------------------------*
003500*    J[\nodmmF                                        *
003510*----------------------------------------------------------------*
003520     EVALUATE  SQLCODE                                            
003530        WHEN  萔|rpknj                                    
003540*--<  >                                                       
003550           CONTINUE                                               
003560        WHEN  OTHER                                               
003570*--< J[\nodmG[ >                                     
003580           MOVE -20                   TO  v|G[R[h        
003590           PERFORM  G[菈                                
003600     END-EVALUATE.                                                
003610*                                                                 
003620 e[uJ[\`|dwhs.                              
003630     EXIT.                                                        
003640*                                                                 
003650******************************************************************
003660*    t@CI[v                                            *
003670******************************************************************
003680 t@CI[v                     SECTION.                    
003690 t@CI[v|rs`qs.                                    
003700*----------------------------------------------------------------*
003710*    t@CI[v nodm                                   *
003720*----------------------------------------------------------------*
003730*--<  ̓t@CI[v >                                       
003740     OPEN  INPUT  ̓t@C.                                   
003750*                                                                 
003760*----------------------------------------------------------------*
003770*    t@CI[vԔ                                    *
003780*----------------------------------------------------------------*
003790     EVALUATE  v|                                           
003800        WHEN  ZERO                                                
003810           CONTINUE                                               
003820        WHEN  OTHER                                               
003830*--< t@CI[vG[ >                                     
003840           MOVE     -30               TO  v|G[R[h        
003850           PERFORM  G[菈                                
003860     END-EVALUATE.                                                
003870*                                                                 
003880*--< o̓t@CI[v >                                       
003890     OPEN  OUTPUT   o̓t@C.                                 
003900*----------------------------------------------------------------*
003910*    t@CI[vԔ                                    *
003920*----------------------------------------------------------------*
003930     EVALUATE  v|                                           
003940        WHEN  ZERO                                                
003950*--< t@CI[v >                                       
003960           CONTINUE                                               
003970        WHEN  OTHER                                               
003980*--< t@CI[vG[ >                                     
003990           MOVE     -40               TO  v|G[R[h        
004000           PERFORM  G[菈                                
004010     END-EVALUATE.                                                
004020*                                                                 
004030 t@CI[v|dwhs.                                      
004040     EXIT.                                                        
004050*                                                                 
004060******************************************************************
004070*    e[uJ[\Ǎ                                    *
004080******************************************************************
004090 e[uJ[\Ǎ             SECTION.                    
004100 e[uJ[\Ǎ|rs`qs.                            
004110*                                                                 
004120*--< e[uJ[\Ǎ >                                   
004130     
      *    EXEC SQL                                                     
004140*        FETCH  CUR1                                              
004150*         INTO  :ksqrlj|_mn                       
004160* 	     ,:ksqrlj|ă[XR[h                     
004170*              ,:ksqrlj|菈R[h                 
004180*              ,:ksqrll|R[h                     
004190*              ,:ksqrll||I               
004200* 	     ,:ksqrll||N             
004210* 	     ,:ksqrll|[XJn|I                 
004220* 	     ,:ksqrll|[XJn|N               
004230* 	     ,:ksqrll|z                       
004240* 	     ,:ksqrll|                         
004250* 	     ,:ksqrll|_mn                       
004260*              ,:ksqrll|f[^쐬|I             
004270* 	     ,:ksqrll|f[^쐬|N           
004280* 	     ,:ksqrll|R[h                     
004290* 	     ,:ksqrll|ă[XR[h                     
004300* 	     ,:ksqrll|菈R[h                 
004310* 	     ,:ksqrll|R[h                     
004320* 	     ,:ksqrll|                         
004330*              ,:ksqrll|_񖾍ׂmn                       
004340*              ,:ksqrll|R[hV[PX                 
004350*                                                                 
004360*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 94 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ksqrlj|_mn
               SQL-SQHSTV(1)
           MOVE 10 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ksqrlj|ă[XR[h
               SQL-SQHSTV(2)
           MOVE 1 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ksqrlj|菈R[h
               SQL-SQHSTV(3)
           MOVE 2 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ksqrll|R[h
               SQL-SQHSTV(4)
           MOVE 8 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ksqrll||I
               SQL-SQHSTV(5)
           MOVE 1 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               ksqrll||N
               SQL-SQHSTV(6)
           MOVE 6 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               ksqrll|[XJn|I
               SQL-SQHSTV(7)
           MOVE 1 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               ksqrll|[XJn|N
               SQL-SQHSTV(8)
           MOVE 6 TO SQL-SQHSTL(8)
           MOVE 0 TO SQL-SQHSTS(8)
           MOVE 0 TO SQL-SQINDV(8)
           MOVE 0 TO SQL-SQINDS(8)
           MOVE 0 TO SQL-SQHARM(8)
           CALL "SQLADR" USING
               ksqrll|z
               SQL-SQHSTV(9)
           MOVE 7 TO SQL-SQHSTL(9)
           MOVE 0 TO SQL-SQHSTS(9)
           MOVE 0 TO SQL-SQINDV(9)
           MOVE 0 TO SQL-SQINDS(9)
           MOVE 0 TO SQL-SQHARM(9)
           CALL "SQLADR" USING
               ksqrll|
               SQL-SQHSTV(10)
           MOVE 7 TO SQL-SQHSTL(10)
           MOVE 0 TO SQL-SQHSTS(10)
           MOVE 0 TO SQL-SQINDV(10)
           MOVE 0 TO SQL-SQINDS(10)
           MOVE 0 TO SQL-SQHARM(10)
           CALL "SQLADR" USING
               ksqrll|_mn
               SQL-SQHSTV(11)
           MOVE 10 TO SQL-SQHSTL(11)
           MOVE 0 TO SQL-SQHSTS(11)
           MOVE 0 TO SQL-SQINDV(11)
           MOVE 0 TO SQL-SQINDS(11)
           MOVE 0 TO SQL-SQHARM(11)
           CALL "SQLADR" USING
               ksqrll|f[^쐬|I
               SQL-SQHSTV(12)
           MOVE 1 TO SQL-SQHSTL(12)
           MOVE 0 TO SQL-SQHSTS(12)
           MOVE 0 TO SQL-SQINDV(12)
           MOVE 0 TO SQL-SQINDS(12)
           MOVE 0 TO SQL-SQHARM(12)
           CALL "SQLADR" USING
               ksqrll|f[^쐬|N
               SQL-SQHSTV(13)
           MOVE 6 TO SQL-SQHSTL(13)
           MOVE 0 TO SQL-SQHSTS(13)
           MOVE 0 TO SQL-SQINDV(13)
           MOVE 0 TO SQL-SQINDS(13)
           MOVE 0 TO SQL-SQHARM(13)
           CALL "SQLADR" USING
               ksqrll|R[h
               SQL-SQHSTV(14)
           MOVE 1 TO SQL-SQHSTL(14)
           MOVE 0 TO SQL-SQHSTS(14)
           MOVE 0 TO SQL-SQINDV(14)
           MOVE 0 TO SQL-SQINDS(14)
           MOVE 0 TO SQL-SQHARM(14)
           CALL "SQLADR" USING
               ksqrll|ă[XR[h
               SQL-SQHSTV(15)
           MOVE 1 TO SQL-SQHSTL(15)
           MOVE 0 TO SQL-SQHSTS(15)
           MOVE 0 TO SQL-SQINDV(15)
           MOVE 0 TO SQL-SQINDS(15)
           MOVE 0 TO SQL-SQHARM(15)
           CALL "SQLADR" USING
               ksqrll|菈R[h
               SQL-SQHSTV(16)
           MOVE 2 TO SQL-SQHSTL(16)
           MOVE 0 TO SQL-SQHSTS(16)
           MOVE 0 TO SQL-SQINDV(16)
           MOVE 0 TO SQL-SQINDS(16)
           MOVE 0 TO SQL-SQHARM(16)
           CALL "SQLADR" USING
               ksqrll|R[h
               SQL-SQHSTV(17)
           MOVE 2 TO SQL-SQHSTL(17)
           MOVE 0 TO SQL-SQHSTS(17)
           MOVE 0 TO SQL-SQINDV(17)
           MOVE 0 TO SQL-SQINDS(17)
           MOVE 0 TO SQL-SQHARM(17)
           CALL "SQLADR" USING
               ksqrll|
               SQL-SQHSTV(18)
           MOVE 7 TO SQL-SQHSTL(18)
           MOVE 0 TO SQL-SQHSTS(18)
           MOVE 0 TO SQL-SQINDV(18)
           MOVE 0 TO SQL-SQINDS(18)
           MOVE 0 TO SQL-SQHARM(18)
           CALL "SQLADR" USING
               ksqrll|_񖾍ׂmn
               SQL-SQHSTV(19)
           MOVE 2 TO SQL-SQHSTL(19)
           MOVE 0 TO SQL-SQHSTS(19)
           MOVE 0 TO SQL-SQINDV(19)
           MOVE 0 TO SQL-SQINDS(19)
           MOVE 0 TO SQL-SQHARM(19)
           CALL "SQLADR" USING
               ksqrll|R[hV[PX
               SQL-SQHSTV(20)
           MOVE 1 TO SQL-SQHSTL(20)
           MOVE 0 TO SQL-SQHSTS(20)
           MOVE 0 TO SQL-SQINDV(20)
           MOVE 0 TO SQL-SQINDS(20)
           MOVE 0 TO SQL-SQHARM(20)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004370*                                                                 
004380*------------------------------------------------------------- --*
004390*    e[uJ[\ǍmF                              *
004400*----------------------------------------------------------------*
004410     EVALUATE   SQLCODE                                           
004420        WHEN   萔|rpknj                                   
004430*--<  >                                                       
004440         COMPUTE  v|́|   =  v|́|   +  1       
004450         COMPUTE  v|́|Q =  v|́|Q +  1       
004460        WHEN   萔|rpkdmc                                 
004470*--< ǍI >                                                   
004480           MOVE  "Y"                  TO  v|I|tO        
004490        WHEN   OTHER                                              
004500*--< ǍG[ >                                                 
004510           MOVE     -50               TO  v|G[R[h        
004520           PERFORM  G[菈                                
004530     END-EVALUATE.                                                
004540*                                                                 
004550 e[uJ[\Ǎ|dwhs.                              
004560     EXIT.                                                        
004570******************************************************************
004580*    KpǍ(P)                                  *
004590******************************************************************
004600 KpǍ                   SECTION.                    
004610 KpǍ|rs`qs.                                  
004620*--< KpǍ >                                             
004630     READ  ̓t@C                                           
004640           AT  END                                                
004650*--< ǍI >                                                   
004660              GO  TO  KpǍ|dwhs                
004670     END-READ.                                                    
004680*                                                                 
004690*----------------------------------------------------------------*
004700*    t@CI[vԔ                                    *
004710*----------------------------------------------------------------*
004720     EVALUATE  v|                                           
004730        WHEN  ZERO                                                
004740           MOVE  ́|(1:6)    TO  vr||N      
004750        WHEN  OTHER                                               
004760*--< ǂݍ݃G[ >                                             
004770           MOVE     -60               TO  v|G[R[h        
004780           PERFORM  G[菈                                
004790     END-EVALUATE.                                                
004800*                                                                 
004810 KpǍ|dwhs.                                    
004820     EXIT.                                                        
004830******************************************************************
004840*    又                                                      *
004850******************************************************************
004860 又                               SECTION.                    
004870 又|rs`qs.                                              
004880*--< ]pt@C >                                 
004890     PERFORM  ]pڕҏW.                         
004900*                                                                 
004910*                                                                 
004920*--< ]pt@Co͏ >                         
004930	   PERFORM  ]po͏.                         
004940*                                                                 
004950*--< e[uJ[\ǍiQڈȍ~j >                     
004960     PERFORM  e[uJ[\Ǎ.                           
004970*                                                                 
004980*                                                                 
004990 又|dwhs.                                                
005000     EXIT.                                                        
005010******************************************************************
005020*     ]pڕҏW                             *
005030******************************************************************
005040 ]pڕҏW           SECTION.                    
005050 ]ڕҏW|rs`qs.                            
005060*                                                                 
005070*----------------------------------------------------------------*
005080*    ]pڕҏWڍs                          *
005090*----------------------------------------------------------------*
005100*--< No.01 _ԍ >                                             
005110     PERFORM  _ԍڍs.                                   
005120*                                                                 
005130*--< No.02 ă[X,No.03 _ >                          
005140     PERFORM  ă[X񐔌_ވڍs.                       
005150*                                                                 
005160*--< No.04 A >                                                 
005170     PERFORM  AԈڍs.                                       
005180*                                                                 
005190*--< No.05 R[h No.06 R[h >                      
005200     PERFORM  R[hR[hڍs.                   
005210*--< No.07 TCg >                                           
005220     PERFORM  TCgڍs.                                 
005230*                                                                 
005240*--< No.08  >                                               
005250     PERFORM  ڍs.                                     
005260*                                                                 
005270*--< No.09 \ >                                           
005280     PERFORM  \ڍs.                                 
005290*                                                                 
005300*--< No.10 p >                                             
005310     MOVE  ksqrll|z TO  ó|p.         
005320*                                                                 
005330*--< No.11 p >                                       
005340     MOVE  ksqrll|   TO  ó|p.   
005350*                                                                 
005360*--< No.12 p萔 >                                         
005370     MOVE  ZERO                       TO  ó|p萔.     
005380*                                                                 
005390*--< No.13 p㑍z >                                           
005400     MOVE  ó|p             TO  ó|p㑍z.       
005410*                                                                 
005420*--< No.14 p㑍z >                                     
005430     MOVE  ó|p       TO  ó|p㑍z. 
005440*                                                                 
005450*--< No.32 R[h >                                       
005460     PERFORM  R[hڍs.                             
005470*                                                                 
005480*--< No.15z,No.16z,No.17N,               
005490*    No.33 ʔ, No.35 N   >                         
005500     PERFORM  ׋ʈڍs.                               
005510*                                                                 
005520*--< No.18 z >                                             
005530     COMPUTE  ó|z =  ó|p㑍z       +          
005540                                ó|p㑍z -          
005550                                ó|z           -          
005560                                ó|z.               
005570*                                                                 
005580*--< No.19 sσtO >                                   
005590     PERFORM  sσtOڍs.                         
005600*                                                                 
005610*--< No.20 sσtO >                               
005620     MOVE   ZERO                      TO                          
005630                                     ó|sσtO.
005640*                                                                 
005650*--< No.21 ԍ >                                           
005660     MOVE   ZERO                      TO  ó|ԍ.       
005670*                                                                 
005680*--< No.22 XVN >                                           
005690     MOVE   v|I                  TO  ó|XVN(1:2).  
005700     MOVE   v|N                TO  ó|XVN(3:6).  
005710*                                                                 
005720*--< No.23 XV >                                             
005730     MOVE   v|VXe          TO  ó|XV.         
005740*                                                                 
005750*--< No.24 XV >                                               
005760     MOVE   v|S                TO  ó|XV.           
005770*                                                                 
005780*--< No.25 ͒S҃R[h >                                     
005790     MOVE   v|S                TO  ó|͒S҃R[h. 
005800*                                                                 
005810*--< No.26 @>                                              
005820     PERFORM  @ڍs.                                   
005830*                                                                 
005840*--< No.27 \tgp>                                        
005850     PERFORM  \tgpڍs.                             
005860*                                                                 
005870*--< No.28 \tgp>                                  
005880     PERFORM  \tgpňڍs.                       
005890*                                                                 
005900*--< No.29 o^N >                                           
005910     MOVE   v|I                  TO  ó|o^N(1:2).  
005920     MOVE   v|N                TO  ó|o^N(3:6).  
005930*                                                                 
005940*--< No.30 o^ >                                             
005950     MOVE   v|VXe          TO  ó|o^.         
005960*                                                                 
005970*--< No.31 o^S >                                           
005980     MOVE   v|S                TO  ó|o^S.       
005990*                                                                 
006000*--< No.34  >                                           
006010     MOVE   ó|N          TO  ó|.       
006020*                                                                 
006030*--< No.36 ŗ >                                             
006040     PERFORM  ŗڍs.                                   
006050*                                                                 
006060*--< No.37 ŗ敪 >                                         
006070     PERFORM  ŗ敪ڍs.                               
006080*                                                                 
006090*--< No.38 ă[XR[hP >                                   
006100     MOVE  ksqrll|ă[XR[h                           
006110                                      TO                          
006120                                         ó|ă[XR[hP.
006130*                                                                 
006140*--< No.39 R[hP >                                   
006150     PERFORM  R[hPڍs.                         
006160*                                                                 
006170*--< No.40 \P >                                       
006180     PERFORM  \Pڍs.                             
006190*                                                                 
006200 ]ڕҏW|dwhs.                              
006210     EXIT.                                                        
006220******************************************************************
006230*    ڂ̈ڍs ҏW                                         *
006240*******************************************************************                                                                 
006250*----------------------------------------------------------------*
006260*    No1  _ԍڍs.                                      *
006270*----------------------------------------------------------------*
006280 _ԍڍs                     SECTION.                    
006290 _ԍڍs|rs`qs.                                    
006300*                                                                 
006310     MOVE ksqrlj|_mn(2:9)                         
006320                                      TO   ó|_ԍ         
006330                                           vr|_mn     
006340                                           m|_ԍ.          
006350 _ԍڍs|dwhs.                                      
006360     EXIT.                                                        
006370*                                                                 
006380*----------------------------------------------------------------*
006390*    NO2 ă[X񐔈ڍs,No3 _ވڍs               *
006400*----------------------------------------------------------------*
006410 ă[X񐔌_ވڍs         SECTION.                    
006420 ă[X񐔌_ވڍs|rs`qs.                        
006430*                                                                 
006440      
      *     EXEC SQL                                                    
006450*          SELECT  ă[X                                   
006460*                  ,_                                      
006470*                  ,_敪                                    
006480*            INTO  :hjnOOQ|ă[X                    
006490*                  ,:hjnOOQ|_                       
006500*                  ,:hjnOOQ|_敪                     
006510*            FROM  IKOTBL002                                      
006520*           WHERE  _mn        = :vr|_mn          
006530*             AND  ă[XR[h  = :ksqrlj|ă[XR[h
006540*             AND  菈R[h =                           
006550*                                :ksqrlj|菈R[h
006560*     END-EXEC.
            CALL "SQLADR" USING SQ0002 SQL-STMT
            MOVE 1 TO SQL-ITERS
            MOVE 189 TO SQL-OFFSET
            MOVE 0 TO SQL-OCCURS
            MOVE 1 TO SQL-SELERR
            CALL "SQLADR" USING
                SQLCUD
                SQL-CUD
            CALL "SQLADR" USING
                SQLCA
                SQL-SQLEST
            MOVE 256 TO SQL-SQLETY
            CALL "SQLADR" USING
                hjnOOQ|ă[X
                SQL-SQHSTV(1)
            MOVE 2 TO SQL-SQHSTL(1)
            MOVE 0 TO SQL-SQHSTS(1)
            MOVE 0 TO SQL-SQINDV(1)
            MOVE 0 TO SQL-SQINDS(1)
            MOVE 0 TO SQL-SQHARM(1)
            CALL "SQLADR" USING
                hjnOOQ|_
                SQL-SQHSTV(2)
            MOVE 3 TO SQL-SQHSTL(2)
            MOVE 0 TO SQL-SQHSTS(2)
            MOVE 0 TO SQL-SQINDV(2)
            MOVE 0 TO SQL-SQINDS(2)
            MOVE 0 TO SQL-SQHARM(2)
            CALL "SQLADR" USING
                hjnOOQ|_敪
                SQL-SQHSTV(3)
            MOVE 1 TO SQL-SQHSTL(3)
            MOVE 0 TO SQL-SQHSTS(3)
            MOVE 0 TO SQL-SQINDV(3)
            MOVE 0 TO SQL-SQINDS(3)
            MOVE 0 TO SQL-SQHARM(3)
            CALL "SQLADR" USING
                vr|_mn
                SQL-SQHSTV(4)
            MOVE 10 TO SQL-SQHSTL(4)
            MOVE 0 TO SQL-SQHSTS(4)
            MOVE 0 TO SQL-SQINDV(4)
            MOVE 0 TO SQL-SQINDS(4)
            MOVE 0 TO SQL-SQHARM(4)
            CALL "SQLADR" USING
                ksqrlj|ă[XR[h
                SQL-SQHSTV(5)
            MOVE 1 TO SQL-SQHSTL(5)
            MOVE 0 TO SQL-SQHSTS(5)
            MOVE 0 TO SQL-SQINDV(5)
            MOVE 0 TO SQL-SQINDS(5)
            MOVE 0 TO SQL-SQHARM(5)
            CALL "SQLADR" USING
                ksqrlj|菈R[h
                SQL-SQHSTV(6)
            MOVE 2 TO SQL-SQHSTL(6)
            MOVE 0 TO SQL-SQHSTS(6)
            MOVE 0 TO SQL-SQINDV(6)
            MOVE 0 TO SQL-SQINDS(6)
            MOVE 0 TO SQL-SQHARM(6)
            CALL "SQLADR" USING
                SQL-SQHSTV(1)
                SQL-SQPHSV
            CALL "SQLADR" USING
                SQL-SQHSTL(1)
                SQL-SQPHSL
            CALL "SQLADR" USING
                SQL-SQHSTS(1)
                SQL-SQPHSS
            CALL "SQLADR" USING
                SQL-SQINDV(1)
                SQL-SQPIND
            CALL "SQLADR" USING
                SQL-SQINDS(1)
                SQL-SQPINS
            CALL "SQLADR" USING
                SQL-SQHARM(1)
                SQL-SQPARM
            CALL "SQLADR" USING
                SQL-SQHARC(1)
                SQL-SQPARC

            CALL "SQLBEX" USING
                SQLCTX
                SQLEXD
                SQLFPN

            CALL "SQLGSS" USING
               SQLSTATE
                .
006570*----------------------------------------------------------------*
006580*    ă[X񐔈ڍsmF                                    *
006590*----------------------------------------------------------------*
006600      EVALUATE  SQLCODE                                           
006610        WHEN  萔|rpknj                                    
006620*--< ă[X񐔈ڍs >                                       
006630        MOVE hjnOOQ|ă[X                           
006640                                      TO   ó|ă[X     
006650                                              m|ă[X    
006660*--< No3 _ވڍs >                                       
006670        MOVE hjnOOQ|_   TO      ó|_      
006680                                              m|_        
006690*--< 擾G[ >                                                 
006700        WHEN  OTHER                                               
006710                                                                  
006720*--< ă[X񐔈ڍs >                                       
006730           MOVE  ZERO                 TO      ó|ă[X  
006740*--< No3 _ވڍs >                                       
006750           MOVE  ZERO                 TO      ó|_      
006760           MOVE -70                   TO      v|G[R[h    
006770           PERFORM  G[菈                                
006780                                                                  
006790      END-EVALUATE.                                               
006800 ă[X񐔌_ވڍs|dwhs.                          
006810     EXIT.                                                        
006820*                                                                 
006830*----------------------------------------------------------------*
006840*    NO4  AԈڍs.                                          *
006850*----------------------------------------------------------------*
006860 AԈڍs                         SECTION.                    
006870 AԈڍs|rs`qs.                                        
006880*                                                                 
006890     IF mdvL[ NOT   =  nkcL[                            
006900     MOVE    1                        TO   vr|A             
006910     MOVE   mdvL[                TO   nkcL[             
006920     ELSE                                                         
006930     COMPUTE vr|A  =  vr|A + 1                        
006940     END-IF.                                                      
006950     MOVE vr|A                  TO  ó|A.             
006960 AԈڍs|dwhs.                                          
006970     EXIT.                                                        
006980*                                                                 
006990*----------------------------------------------------------------*
007000*    NO5  R[hڍs.NO6  R[hڍs.        *
007010*----------------------------------------------------------------*
007020 R[hR[hڍs     SECTION.                    
007030 R[hR[hڍs|rs`qs.                    
007040*                                                                 
007050      
      *     EXEC SQL                                                    
007060*          SELECT  VR[h                                 
007070*                 ,}                                           
007080*            INTO  :hjnOOP|VR[h                  
007090*                 ,:hjnOOP|}                            
007100*            FROM  IKOTBL001                                      
007110*           WHERE  R[h    = :ksqrll|R[h
007120*     END-EXEC.
            CALL "SQLADR" USING SQ0003 SQL-STMT
            MOVE 1 TO SQL-ITERS
            MOVE 228 TO SQL-OFFSET
            MOVE 0 TO SQL-OCCURS
            MOVE 1 TO SQL-SELERR
            CALL "SQLADR" USING
                SQLCUD
                SQL-CUD
            CALL "SQLADR" USING
                SQLCA
                SQL-SQLEST
            MOVE 256 TO SQL-SQLETY
            CALL "SQLADR" USING
                hjnOOP|VR[h
                SQL-SQHSTV(1)
            MOVE 7 TO SQL-SQHSTL(1)
            MOVE 0 TO SQL-SQHSTS(1)
            MOVE 0 TO SQL-SQINDV(1)
            MOVE 0 TO SQL-SQINDS(1)
            MOVE 0 TO SQL-SQHARM(1)
            CALL "SQLADR" USING
                hjnOOP|}
                SQL-SQHSTV(2)
            MOVE 3 TO SQL-SQHSTL(2)
            MOVE 0 TO SQL-SQHSTS(2)
            MOVE 0 TO SQL-SQINDV(2)
            MOVE 0 TO SQL-SQINDS(2)
            MOVE 0 TO SQL-SQHARM(2)
            CALL "SQLADR" USING
                ksqrll|R[h
                SQL-SQHSTV(3)
            MOVE 8 TO SQL-SQHSTL(3)
            MOVE 0 TO SQL-SQHSTS(3)
            MOVE 0 TO SQL-SQINDV(3)
            MOVE 0 TO SQL-SQINDS(3)
            MOVE 0 TO SQL-SQHARM(3)
            CALL "SQLADR" USING
                SQL-SQHSTV(1)
                SQL-SQPHSV
            CALL "SQLADR" USING
                SQL-SQHSTL(1)
                SQL-SQPHSL
            CALL "SQLADR" USING
                SQL-SQHSTS(1)
                SQL-SQPHSS
            CALL "SQLADR" USING
                SQL-SQINDV(1)
                SQL-SQPIND
            CALL "SQLADR" USING
                SQL-SQINDS(1)
                SQL-SQPINS
            CALL "SQLADR" USING
                SQL-SQHARM(1)
                SQL-SQPARM
            CALL "SQLADR" USING
                SQL-SQHARC(1)
                SQL-SQPARC

            CALL "SQLBEX" USING
                SQLCTX
                SQLEXD
                SQLFPN

            CALL "SQLGSS" USING
               SQLSTATE
                .
007130*----------------------------------------------------------------*
007140*    R[hR[hڍsmF                        *
007150*----------------------------------------------------------------*
007160      EVALUATE  SQLCODE                                           
007170        WHEN  萔|rpknj                                    
007180*--< R[hڍs >                                       
007190           MOVE hjnOOP|VR[h                      
007200                                      TO                          
007210                                          ó|R[h      
007220*--< R[hڍs >                                       
007230           MOVE hjnOOP|}    TO  ó|R[h      
007240*--< 擾G[ >                                                 
007250        WHEN  OTHER                                               
007260*--< R[hڍsG[ >                                 
007270           MOVE  ZERO                 TO  ó|R[h      
007280*--< R[hڍsG[ >                                 
007290           MOVE  ZERO                 TO  ó|R[h      
007300           MOVE -80                   TO  v|G[R[h        
007310           PERFORM  G[菈                                
007320      END-EVALUATE.                                               
007330 R[hR[hڍs|dwhs.                      
007340     EXIT.                                                        
007350*                                                                 
007360*----------------------------------------------------------------*
007370*    NO7  TCgڍs.                                    *
007380*----------------------------------------------------------------*
007390 TCgڍs                   SECTION.                    
007400 TCgڍs|rs`qs.                                  
007410*--< |I >                                   
007420     IF ksqrll||I = 1                    
007430        MOVE  "20"                    TO                          
007440                                     vr||N(1:2)
007450     ELSE                                                         
007460        MOVE  "19"                    TO                          
007470                                     vr||N(1:2)
007480     END-IF.                                                      
007490*--< |I >                                   
007500     MOVE ksqrll||N(1:2)               
007510                                      TO                          
007520                                    vr||N(3:2).
007530     MOVE ksqrll||N(3:2)               
007540                                      TO                          
007550                                         vr||.
007560*--< [XJnQI >                                     
007570     IF ksqrll|[XJn|I = 1                      
007580        MOVE  "20"                    TO                          
007590                                     vr|[XJn|N(1:2)  
007600     ELSE                                                         
007610        MOVE  "19"                    TO                          
007620                                      vr|[XJn|N(1:2) 
007630     END-IF.                                                      
007640*                                                                 
007650     MOVE ksqrll|[XJn|N(1:2)                 
007660                                      TO                          
007670                                      vr|[XJn|N(3:2).
007680     MOVE ksqrll|[XJn|N(3:2)                 
007690                                      TO  vr|[XJn|. 
007700*--< vZ >                                                 @
007710     COMPUTE vr|  = (vr||N     -        
007720                                     vr|[XJn|N) * 12 
007730                            +  vr||  -        
007740                               vr|[XJn|.            
007750     MOVE vr|                  TO  ó|TCg.       
007760 TCgڍs|dwhs.                                    
007770     EXIT.                                                        
007780*                                                                 
007790*----------------------------------------------------------------*
007800*    NO8  ڍs.                                        *
007810*----------------------------------------------------------------*
007820 ڍs                       SECTION.                    
007830 ڍs|rs`qs.                                      
007840*--< ڍs >                                             
007850      MOVE ksqrll||N(5:2)              
007860                                      TO                          
007870                                     vr||.    
007880      MOVE  vr||  TO  ó|.           
007890 ڍs|dwhs.                                        
007900     EXIT.                                                        
007910*                                                                 
007920*----------------------------------------------------------------*
007930*    NO9  \ڍs.                                    *
007940*----------------------------------------------------------------*
007950 \ڍs                   SECTION.                    
007960 \ڍs|rs`qs.                                  
007970*--< \ڍs >                                         
007980      MOVE vr||N   TO                          
007990                                        vr|(1:4).
008000      MOVE vr||   TO                          
008010                                        vr|(5:2).
008020      MOVE vr||   TO                          
008030                                        vr|(7:2).
008040      MOVE vr|       TO                          
008050                                        ó|\.         
008060 \ڍs|dwhs.                                    
008070     EXIT.                                                        
008080*                                                                 
008090*----------------------------------------------------------------*
008100*    N15z,N16z,N17N N033 N035 ڍs  *
008110*----------------------------------------------------------------*
008120 ׋ʈڍs                 SECTION.                    
008130 ׋ʈڍs|rs`qs.                                
008140*                                                                 
008150     MOVE ksqrll|_mn(2:9)                         
008160                                      TO  vr|_mn      
008170     
      *    EXEC SQL                                                     
008180*          SELECT  z                                       
008190*                 ,QI                                   
008200*                 ,QN                                 
008210*                 ,ʔ                                       
008220*            INTO  :ksqrjl|z                        
008230*                 ,:ksqrjl||I                    
008240*                 ,:ksqrjl||N                  
008250*                 ,:ksqrjl|ʔ                        
008260*           FROM  LTRSKM                                          
008270*           WHERE  _ԍ = :vr|_mn                 
008280*             AND  ă[XR[h  = :ksqrll|ă[XR[h
008290*             AND  R[h  = :vr|o͐R[h    
008300*             AND  ˍσtO    = NULL                         
008310*    END-EXEC.
           CALL "SQLADR" USING SQ0004 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 255 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ksqrjl|z
               SQL-SQHSTV(1)
           MOVE 7 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ksqrjl||I
               SQL-SQHSTV(2)
           MOVE 1 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ksqrjl||N
               SQL-SQHSTV(3)
           MOVE 6 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ksqrjl|ʔ
               SQL-SQHSTV(4)
           MOVE 5 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               vr|_mn
               SQL-SQHSTV(5)
           MOVE 10 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               ksqrll|ă[XR[h
               SQL-SQHSTV(6)
           MOVE 1 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               vr|o͐R[h
               SQL-SQHSTV(7)
           MOVE 3 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
008320*----------------------------------------------------------------*
008330*    ׋ʈڍsmF                                    *
008340*----------------------------------------------------------------*
008350     EVALUATE  SQLCODE                                            
008360*--< ׏ɊYf[^݂ꍇ>                      
008370        WHEN  萔|rpknj                                    
008380*--< N033 ʔԈڍs >                                      
008390          MOVE  ksqrjl|ʔ                            
008400                                      TO   ó|ʔ         
008410*--< N035 Nڍs >                                    
008420          IF ksqrjl||I = 1                       
008430            MOVE  "20"                TO  ó|N(1:2)   
008440          ELSE                                                    
008450            MOVE  "19"                TO  ó|N(1:2)   
008460          END-IF                                                  
008470          MOVE  ksqrjl||N                      
008480                                      TO                          
008490                                        ó|N(3:6)     
008500*                                                                 
008510          IF ksqrjl|z   >  ZERO                     
008520*--< N015zڍs >                                         
008530            MOVE  ó|p      TO   ó|z           
008540*--< N016zňڍs >                                   
008550            MOVE  ó|p                            
008560                                      TO  ó|z      
008570*--< N017Nڍs >                                     
008580*                                                                 
008590*--< |I >                                           
008600          IF ksqrjl||I = 1                       
008610            MOVE  "20"                TO   ó|N(1:2)  
008620            ELSE                                                  
008630            MOVE  "19"                TO   ó|N(1:2)  
008640            END-IF                                                
008650            MOVE  ksqrjl||N                    
008660                                      TO                          
008670                                           ó|N(3:6)  
008680           ELSE                                                   
008690            MOVE  ZERO                TO   ó|z           
008700            MOVE  ZERO                TO   ó|z     
008710            MOVE  ZERO                TO   ó|N       
008720          END-IF                                                  
008730*                                                                 
008740*--< ׏ɊYf[^݂Ȃꍇ >                   
008750        WHEN  OTHER                                               
008760*--< N033 ʔԈڍs >                                      
008770          MOVE  ZERO                  TO   ó|ʔ         
008780*--< N035 Nڍs >                                    
008790          MOVE  ZERO                  TO   ó|N       
008800*--< N015zڍs >                                         
008810          MOVE vr||N                           
008820                                      TO                          
008830                                   vr||N(1:4)
008840          MOVE vr||                           
008850                                      TO                          
008860                                   vr||N(5:2)
008870*                                                                 
008880          IF vr||N > vr||N      
008890            MOVE  ó|p      TO   ó|z           
008900*--< N016zňڍs >                                   
008910            MOVE  ó|p                            
008920                                      TO   ó|z     
008930*--< N017Nڍs >                                     
008940            MOVE  ó|\    TO   ó|N       
008950          ELSE                                                    
008960            MOVE  ZERO                TO   ó|z           
008970            MOVE  ZERO                TO   ó|z     
008980            MOVE  ZERO                TO   ó|N       
008990          END-IF                                                  
009000*--< ǂݍ݃G[ >                                             
009010          MOVE -90                    TO  v|G[R[h        
009020          PERFORM  G[菈                                 
009030     END-EVALUATE.                                                
009040 ׋ʈڍs|dwhs.                                  
009050     EXIT.                                                        
009060*                                                                 
009070*----------------------------------------------------------------*
009080*    No19  sσtOڍs.                           *
009090*----------------------------------------------------------------*
009100 sσtOڍs           SECTION.                    
009110 sσtOڍs|rs`qs.                          
009120*                                                                 
009130     IF ksqrll|f[^쐬|I = 1                  
009140        MOVE  "20"                    TO                          
009150                             vr|f[^쐬|N(1:2)  
009160     ELSE                                                         
009170        MOVE  "19"                    TO                          
009180                             vr|f[^쐬|N(1:2)  
009190            END-IF                                                
009200     MOVE  ksqrll|f[^쐬|N   TO            
009210                             vr|f[^쐬|N(3:6). 
009220     MOVE  ́|               TO  vr|.           
009230     IF  vr|f[^쐬|N  <  vr|          
009240        MOVE   "1"                    TO  ó|sσtO
009250     ELSE                                                         
009260        MOVE   "0"                    TO  ó|sσtO
009270     END-IF.                                                      
009280 sσtOڍs|dwhs.                            
009290     EXIT.                                                        
009300*                                                                 
009310*----------------------------------------------------------------*
009320*    N26  @ڍs.                                        *
009330*----------------------------------------------------------------*
009340 @ڍs                     SECTION.                    
009350 @ڍs|rs`qs.                                    
009360*                                                                 
009370     EVALUATE  ksqrll|R[h                       
009380        WHEN  vr|U                                          
009390           MOVE  vr|@U   TO   ó|@         
009400        WHEN  vr|`                                          
009410           MOVE  vr|񑩎`       TO   ó|@         
009420        WHEN  vr|                                      
009430           MOVE  vr|@                           
009440                                      TO   ó|@         
009450        WHEN  vr|ler㗝                                
009460           MOVE  vr|㗝       TO   ó|@         
009470        WHEN OTHER                                                
009480           MOVE  "0"                  TO   ó|@         
009490     END-EVALUATE.                                                
009500 R[hڍs|dwhs.                                  
009510     EXIT.                                                        
009520*                                                                 
009530*----------------------------------------------------------------*
009540*    No27  \tgpڍs.                               *
009550*----------------------------------------------------------------*
009560 \tgpڍs               SECTION.                    
009570 \tgpڍs|rs`qs.                              
009580*                                                                 
009590     MOVE   ó|_(1:1)       TO  vr|_ނP      
009600     IF     vr|_ނP  =   vr|_                
009610         MOVE   ó|p        TO  ó|\tgp    
009620     ELSE                                                         
009630         MOVE   ZERO                  TO  ó|\tgp    
009640     END-IF.                                                      
009650 \tgpڍs|dwhs.                                
009660     EXIT.                                                        
009670*                                                                 
009680*----------------------------------------------------------------*
009690*    No28  \tgpňڍs.                         *
009700*----------------------------------------------------------------*
009710 \tgpňڍs         SECTION.                    
009720 \tgpňڍs|rs`qs.                        
009730*                                                                 
009740     MOVE   ó|_(1:1)       TO  vr|_ނP      
009750     IF     vr|_ނP  =   vr|_                
009760       MOVE   ó|p    TO                          
009770                                      ó|\tgp  
009780     ELSE                                                         
009790       MOVE   ZERO                    TO                          
009800                                      ó|\tgp  
009810     END-IF.                                                      
009820 \tgpňڍs|dwhs.                          
009830     EXIT.                                                        
009840*----------------------------------------------------------------*
009850*    N32 R[hڍs                                  *
009860*----------------------------------------------------------------*
009870 R[hڍs               SECTION.                    
009880 R[hڍs|rs`qs.                              
009890*                                                                 
009900     IF  ksqrll|菈R[h   = 89                  
009910       MOVE    "U00"                  TO  ó|R[h    
009920     ELSE IF (ksqrll|菈R[h  = 52   OR         
009930              ksqrll|菈R[h  = 62)  AND        
009940              ksqrll|R[h      = "56" AND        
009950              hjnOOQ|_敪    =  "5"       AND        
009960              ó|_(1:1)     NOT  =  "6"                 
009970       MOVE    "W01"                  TO  ó|R[h    
009980     ELSE IF (ksqrll|菈R[h  = 52   OR         
009990              ksqrll|菈R[h  = 62)  AND        
010000              ksqrll|R[h      = "56" AND        
010010              hjnOOQ|_敪    =  "5"       AND        
010020              ó|_(1:1)          =  "6"                 
010030       MOVE    "W02"                  TO  ó|R[h    
010040     ELSE IF (ksqrll|菈R[h  = 52   OR         
010050              ksqrll|菈R[h  = 62)  AND        
010060              ksqrll|R[h      = "56" AND        
010070              hjnOOQ|_敪    =  "0"                  
010080       MOVE    "W51"                  TO  ó|R[h    
010090     ELSE IF (ksqrll|菈R[h  = 51   OR         
010100              ksqrll|菈R[h  = 61)  AND        
010110              ksqrll|R[h      = "56" AND        
010120              hjnOOQ|_敪    =  "0"                  
010130       MOVE    "W52"                  TO  ó|R[h    
010140     ELSE IF  ksqrll|菈R[h  = 39   AND        
010150              ksqrll|R[h      = "46" AND        
010160              hjnOOQ|_敪    =  "5"       AND        
010170              ó|_(1:1)         NOT =  "6"              
010180       MOVE    "V01"                  TO  ó|R[h    
010190     ELSE IF  ksqrll|菈R[h  = 39   AND        
010200              ksqrll|R[h      = "46" AND        
010210              hjnOOQ|_敪    =  "5"       AND        
010220              ó|_(1:1)         =  "6"                  
010230       MOVE    "V02"                  TO  ó|R[h    
010240     ELSE                                                         
010250       MOVE    ZERO                   TO  ó|R[h    
010260     END-IF.                                                      
010270     MOVE     ó|R[h    TO                          
010280                                         vr|o͐R[h.
010290 R[hڍs|dwhs.                                
010300     EXIT.                                                        
010310*                                                                 
010320*----------------------------------------------------------------*
010330*    No36  ŗڍs.                                     *
010340*----------------------------------------------------------------*
010350 ŗڍs                     SECTION.                    
010360 ŗڍs|rs`qs.                                    
010370*                                                                 
010380     IF    ksqrll| NOT =  ZERO                   
010390       MOVE  0.05                     TO  ó|ŗ          
010400     ELSE                                                         
010410       MOVE  ZERO                     TO  ó|ŗ          
010420     END-IF.                                                      
010430 ŗڍs|dwhs.                                      
010440     EXIT.                                                        
010450*                                                                 
010460*----------------------------------------------------------------*
010470*    No37  ŗ敪ڍs.                                 *
010480*----------------------------------------------------------------*
010490 ŗ敪ڍs                 SECTION.                    
010500 ŗ敪ڍs|rs`qs.                                
010510*                                                                 
010520     IF    ó|ŗ  =  ZERO                                
010530       MOVE  "00"                     TO  ó|ŗ敪      
010540     ELSE                                                         
010550       MOVE  "12"                     TO  ó|ŗ敪      
010560     END-IF.                                                      
010570 ŗ敪ڍs|dwhs.                                  
010580     EXIT.                                                        
010590*                                                                 
010600*----------------------------------------------------------------*
010610*    No39 R[hPڍs                             *
010620*----------------------------------------------------------------*
010630 R[hPڍs           SECTION.                    
010640 R[hPڍs|rs`qs.                          
010650*                                                                 
010660     
      *    EXEC SQL                                                     
010670*          SELECT  R[h                               
010680*            INTO  :hjnOOT|R[h                
010690*            FROM  IKOTBL005                                      
010700*           WHERE  VR[h  = :vr|o͐R[h  
010710*    END-EXEC.
           CALL "SQLADR" USING SQ0005 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 298 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               hjnOOT|R[h
               SQL-SQHSTV(1)
           MOVE 3 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               vr|o͐R[h
               SQL-SQHSTV(2)
           MOVE 3 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
010720*----------------------------------------------------------------*
010730*    R[hPڍs mF                             *
010740*----------------------------------------------------------------*
010750     EVALUATE  SQLCODE                                            
010760        WHEN  萔|rpknj                                    
010770*--<  >                                                       
010780           MOVE  hjnOOT|R[h                   
010790                                      TO  ó|R[hP
010800        WHEN  OTHER                                               
010810*--< 擾G[ >                                                 
010820           MOVE  ZERO                 TO  ó|R[hP
010830*--< ǂݍ݃G[ >                                             
010840          MOVE -100                   TO  v|G[R[h        
010850          PERFORM  G[菈                                 
010860*                                                                 
010870     END-EVALUATE.                                                
010880 R[hPڍs|dwhs.                            
010890     EXIT.                                                        
010900*                                                                 
010910*----------------------------------------------------------------*
010920*    No40  \Pڍs.                               *
010930*----------------------------------------------------------------*
010940 \Pڍs               SECTION.                    
010950 \Pڍs|rs`qs.                              
010960*                                                                 
010970     MOVE  ó|\(1:2)      TO                          
010980                                        vr|\PI. 
010990     IF  vr|\PI  =  "20"                        
011000       MOVE  "1"                      TO                          
011001                                         ó|\P(1:1)
011010     ELSE                                                         
011020       MOVE  "0"                      TO                          
011021                                         ó|\P(1:1)
011030     END-IF.                                                      
011040     MOVE  ó|\(3:6)      TO                          
011050                                        ó|\P(2:6).
011060 \Pڍs|dwhs.                                
011070     EXIT.                                                        
011080*                                                                 
011090******************************************************************
011100*    ]t@Co͏                            *
011110******************************************************************
011120 ]po͏           SECTION.                    
011130 ]po͏|rs`qs.                          
011140*--< ]t@Co >                               
011150     WRITE  ó|R[h.                                       
011160*                                                                 
011170*--< ]o͂̏Ԕ >                             
011180     EVALUATE  v|                                           
011190        WHEN  ZERO                                                
011200*--< ʏo͌̉Z >                                         
011210           COMPUTE  v|ó| =  v|ó| + 1          
011220        WHEN  OTHER                                               
011230*--< t@Co̓G[ >                                         
011240           MOVE     -110               TO  v|G[R[h       
011250           PERFORM  G[菈                                
011260     END-EVALUATE.                                                
011270*                                                                 
011280 ]po͏|dwhs.                            
011290     EXIT.                                                        
011300******************************************************************
011310*    I                                                    *
011320******************************************************************
011330 I                             SECTION.                    
011340 I|rs`qs.                                            
011350*                                                                 
011360     PERFORM  caN[Y.                                   
011370*                                                                 
011380     PERFORM  t@CN[Y.                               
011390*                                                                 
011400     PERFORM  bZ[Wo.                                 
011410*                                                                 
011420     PERFORM  IbZ[Wo.                                 
011430*                                                                 
011440*--< vOI >                                         
011450     MOVE  萔|             TO  PROGRAM-STATUS.         
011460*                                                                 
011470 I|dwhs.                                              
011480     EXIT.                                                        
011490******************************************************************
011500*    caN[Y                                                *
011510******************************************************************
011520 caN[Y                     SECTION.                    
011530 caN[Y|rs`qs.                                    
011540*                                                                 
011550*--< J[\ N[Y >                                          
011560     
      *    EXEC SQL                                                     
011570*       CLOSE  CUR1                                               
011580*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 321 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
011590*                                                                 
011600 caN[Y|dwhs.                                      
011610     EXIT.                                                        
011620******************************************************************
011630*    t@CN[Y                                            *
011640******************************************************************
011650 t@CN[Y                 SECTION.                    
011660 t@CN[Y|rs`qs.                                
011670*                                                                 
011680     CLOSE  ̓t@C.                                         
011690     CLOSE  o̓t@C.                                         
011700*                                                                 
011710 t@CN[Y|dwhs.                                  
011720     EXIT.                                                        
011730*                                                                 
011740******************************************************************
011750*    bZ[Wo͏                                      *
011760******************************************************************
011770 bZ[Wo                   SECTION.                    
011780 bZ[Wó|rs`qs.                                  
011790*----------------------------------------------------------------*
011800*    bZ[Wo͏                                      *
011810*----------------------------------------------------------------*
011820     INITIALIZE                       IF-CHOCO001.                
011830     MOVE  "3"                        TO  P|Cxg.     
011840     MOVE  萔|vOhc       TO  P|\[Xhc.       
011850     MOVE  "0"                        TO  P|AR[h.       
011860     MOVE  "LTRSMK"                   TO  P|e[uhc. 
011870     MOVE  "COUNT"                    TO  P|.         
011880     MOVE  v|́|             TO  P|f[^e.       
011890     MOVE  " {Ǎ"        TO  P|̑bZ[W. 
011900     CALL  CLOCO001                   USING  IF-CHOCO001.         
011910*                                                                 
011920     INITIALIZE                       IF-CHOCO001.                
011930     MOVE  "3"                        TO  P|Cxg.     
011940     MOVE  萔|vOhc       TO  P|\[Xhc.       
011950     MOVE  "0"                        TO  P|AR[h.       
011960     MOVE  "LTRSMM"                   TO  P|e[uhc. 
011970     MOVE  "COUNT"                    TO  P|.         
011980     MOVE  v|́|Q           TO  P|f[^e.       
011990     MOVE  "דǍ"         TO  P|̑bZ[W. 
012000     CALL  CLOCO001                   USING  IF-CHOCO001.         
012010*                                                                 
012020     INITIALIZE                       IF-CHOCO001.                
012030     MOVE  "3"                        TO  P|Cxg.     
012040     MOVE  萔|vOhc       TO  P|\[Xhc.       
012050     MOVE  "0"                        TO  P|AR[h.       
012060     MOVE  "FFUIS420.TMP"             TO  P|e[uhc. 
012070     MOVE  "COUNT"                    TO  P|.         
012080     MOVE  v|ó|             TO  P|f[^e.       
012090     MOVE  "]po͌"                           
012100                                      TO  P|̑bZ[W. 
012110     CALL  CLOCO001                   USING  IF-CHOCO001.         
012120 bZ[Wó|dwhs.                                    
012130     EXIT.                                                        
012140*                                                                 
012150******************************************************************
012160*    IbZ[Wo                                          *
012170******************************************************************
012180 IbZ[Wo                   SECTION.                    
012190 IbZ[Wó|rs`qs.                                  
012200*                                                                 
012210*                                                                 
012220*----------------------------------------------------------------*
012230*    IbZ[Wo                                          *
012240*----------------------------------------------------------------*
012250     INITIALIZE                       IF-CHOCO001.                
012260     MOVE  "3"                        TO  P|Cxg.     
012270     MOVE  萔|vOhc       TO  P|\[Xhc.       
012280     MOVE  "0"                        TO  P|AR[h.       
012290     MOVE  "END"                      TO  P|.         
012300     MOVE  萔|vO         TO  P|̑bZ[W. 
012310     CALL  CLOCO001                   USING  IF-CHOCO001.         
012320*                                                                 
012330 IbZ[Wó|dwhs.                                    
012340     EXIT.                                                        
012350******************************************************************
012360*    G[                                                  *
012370******************************************************************
012380 G[菈                       SECTION.                    
012390 G[菈|rs`qs.                                      
012400*                                                                 
012410     MOVE  "Y"                        TO  v|ُI|tO.   
012420     INITIALIZE                           IF-CHOCO001.            
012430*                                                                 
012440     EVALUATE  v|G[R[h                                   
012450        WHEN  -10                                                 
012460*--< nq`bkdڑs >                                       
012470           MOVE  "1"                  TO  P|Cxg      
012480           MOVE  萔|vOhc TO  P|\[Xhc        
012490           MOVE  "9"                  TO  P|AR[h        
012500           MOVE  "CONNECT"            TO  P|          
012510           MOVE  SQLCODE              TO  P|f[^e        
012520           MOVE  SQLERRMC             TO  P|̑bZ[W  
012530           CALL  CLOCO001             USING  IF-CHOCO001          
012540*                                                                 
012550        WHEN  -20                                                 
012560*--< e[uJ[\`s >                           
012570           MOVE  "1"                  TO  P|Cxg      
012580           MOVE  萔|vOhc TO  P|\[Xhc        
012590           MOVE  "9"                  TO  P|AR[h        
012600           MOVE  "LTRSMM"             TO  P|e[uhc  
012610           MOVE  "SELECT"             TO  P|          
012620           MOVE  SQLCODE              TO  P|f[^e        
012630           MOVE  SQLERRMC             TO  P|̑bZ[W  
012640           CALL  CLOCO001             USING  IF-CHOCO001          
012650                                                                  
012660         WHEN  -30                                                
012670*--< t@CI[vs >                                       
012680           MOVE  "1"                  TO  P|Cxg      
012690           MOVE  萔|vOhc TO  P|\[Xhc        
012700           MOVE  "9"                  TO  P|AR[h        
012710           MOVE  "FFUISA01"           TO  P|e[uhc  
012720           MOVE  "OPEN"               TO  P|          
012730           MOVE  v|             TO  P|f[^e        
012740           CALL  CLOCO001             USING  IF-CHOCO001          
012750*                                                                 
012760        WHEN  -40                                                 
012770*--< t@CI[vs >                                       
012780           MOVE  "1"                  TO  P|Cxg      
012790           MOVE  萔|vOhc TO  P|\[Xhc        
012800           MOVE  "9"                  TO  P|AR[h        
012810           MOVE  "FFUIS420"           TO  P|e[uhc  
012820           MOVE  "OPEN"               TO  P|          
012830           MOVE  v|             TO  P|f[^e        
012840           CALL  CLOCO001             USING  IF-CHOCO001          
012850*                                                                 
012860           WHEN  -50                                              
012870*--< e[uJ[\Ǎs >                               
012880           MOVE  "1"                  TO  P|Cxg      
012890           MOVE  萔|vOhc TO  P|\[Xhc        
012900           MOVE  "9"                  TO  P|AR[h        
012910           MOVE  "LTRSMM"             TO  P|e[uhc  
012920           MOVE  "FETCH"              TO  P|          
012930           MOVE  SQLCODE              TO  P|f[^e        
012940           MOVE  SQLERRMC             TO  P|̑bZ[W  
012950           CALL  CLOCO001             USING  IF-CHOCO001          
012960*                                                                 
012970           WHEN  -60                                              
012980*--< KpǍ̒omFs>                            
012990           MOVE  "1"                  TO  P|Cxg      
013000           MOVE  萔|vOhc TO  P|\[Xhc        
013010           MOVE  "9"                  TO  P|AR[h        
013020           MOVE  "FFUISA01"           TO  P|e[uhc  
013030           MOVE  "READ"               TO  P|          
013040           MOVE  v|             TO  P|f[^e        
013050           CALL  CLOCO001             USING  IF-CHOCO001          
013060*                                                                 
013070           WHEN  -70                                              
013080*--< ă[X񐔌_ވڍs̒os >                     
013090           MOVE  "2"                  TO  P|Cxg      
013100           MOVE  萔|vOhc TO  P|\[Xhc        
013110           MOVE  "9"                  TO  P|AR[h        
013120           MOVE  "IKOTBL2"            TO  P|e[uhc  
013130           MOVE  "SELECT"             TO  P|          
013140           MOVE  SQLCODE              TO  P|f[^e        
013150           MOVE  SQLERRMC             TO  P|̑bZ[W  
013160           CALL  CLOCO001             USING  IF-CHOCO001          
013170           MOVE  "N"                  TO v|ُI|tO     
013180           DISPLAY  "_ޓϊe[u݂Ȃ"          
013190                    "._m  "                     
013200                                      ksqrll|_mn  
013210                    ".ă[XR[h  "                 
013220                                      ksqrll|ă[XR[h
013230                    "._񖾍ׂmn  "                   
013240                                      ksqrll|_񖾍ׂmn  
013250                    ".R[hV[PX  "             
013260                                  ksqrll|R[hV[PX
013270*                                                                 
013280           WHEN  -80                                              
013290*--< R[h,R[hڍs̒omF s >               
013300           MOVE  "2"                  TO  P|Cxg      
013310           MOVE  萔|vOhc TO  P|\[Xhc        
013320           MOVE  "9"                  TO  P|AR[h        
013330           MOVE  "IKOTBL1 "           TO  P|e[uhc  
013340           MOVE  "SELECT"             TO  P|          
013350           MOVE  SQLCODE              TO  P|f[^e        
013360           MOVE  SQLERRMC             TO  P|̑bZ[W  
013370           CALL  CLOCO001             USING  IF-CHOCO001          
013380           MOVE  "N"                  TO v|ُI|tO     
013390           DISPLAY  "ϊe[u݂Ȃ"                    
013400                    "._m  "                     
013410                                      ksqrll|_mn  
013420                    ".ă[XR[h  "                 
013430                                      ksqrll|ă[XR[h
013440                    "._񖾍ׂmn  "                   
013450                                      ksqrll|_񖾍ׂmn  
013460                    ".R[hV[PX  "             
013470                                  ksqrll|R[hV[PX
013480*                                                                 
013490           WHEN  -90                                              
013500*--< ׋ʈڍs̒omF s >                        
013510           MOVE  "2"                  TO  P|Cxg      
013520           MOVE  萔|vOhc TO  P|\[Xhc        
013530           MOVE  "9"                  TO  P|AR[h        
013540           MOVE  "LTRSKM "            TO  P|e[uhc  
013550           MOVE  "SELECT"             TO  P|          
013560           MOVE  SQLCODE              TO  P|f[^e        
013570           MOVE  SQLERRMC             TO  P|̑bZ[W  
013580           CALL  CLOCO001             USING  IF-CHOCO001          
013590           MOVE  "N"                  TO v|ُI|tO     
013600           DISPLAY  "׏񂪑݂Ȃ"                    
013610                    "._m  "                     
013620                                      ksqrll|_mn  
013630                    ".ă[XR[h  "                 
013640                                      ksqrll|ă[XR[h
013650                    "._񖾍ׂmn  "                   
013660                                      ksqrll|_񖾍ׂmn  
013670                    ".R[hV[PX  "             
013680                                  ksqrll|R[hV[PX
013690*                                                                 
013700           WHEN  -100                                             
013710*--< R[hPڍs̒omF s >                      
013720           MOVE  "2"                  TO  P|Cxg      
013730           MOVE  萔|vOhc TO  P|\[Xhc        
013740           MOVE  "9"                  TO  P|AR[h        
013750           MOVE  "IKOTBL5 "           TO  P|e[uhc  
013760           MOVE  "SELECT"             TO  P|          
013770           MOVE  SQLCODE              TO  P|f[^e        
013780           MOVE  SQLERRMC             TO  P|̑bZ[W  
013790           CALL  CLOCO001             USING  IF-CHOCO001          
013800           MOVE  "N"                  TO v|ُI|tO     
013810*                                                                 
013820           WHEN  -110                                             
013830*--< ]t@Co͏s >                       
013840           MOVE  "1"                  TO  P|Cxg      
013850           MOVE  萔|vOhc TO  P|\[Xhc        
013860           MOVE  "9"                  TO  P|AR[h        
013870           MOVE  "FFUIS420"           TO  P|e[uhc  
013880           MOVE  "WRITE"              TO  P|          
013890           MOVE  SQLCODE              TO  P|f[^e        
013900           MOVE  SQLERRMC             TO  P|̑bZ[W  
013910           CALL  CLOCO001             USING  IF-CHOCO001          
013920           WHEN  OTHER                                            
013930*                                                                 
013940           MOVE  "N"                  TO v|ُI|tO     
013950     END-EVALUATE.                                                
013960*                                                                 
013970     IF v|ُI|tO  =  "Y"                              
013980*                                                                 
013990*--< bZ[Wo͏ >                                     
014000        PERFORM  bZ[Wo                               
014010*--< IbZ[Wo͏ >                                     
014020        PERFORM  IbZ[Wo                               
014030*                                                                 
014040*--< vOُĨ^[R[h >                         
014050        MOVE  萔|ُ          TO  PROGRAM-STATUS          
014060*                                                                 
014070        EXIT  PROGRAM                                             
014080     END-IF.                                                      
014090*                                                                 
014100 G[|dwhs.                                            
014110     EXIT.                                                        
014120******************************************************************
014130*                  END OF PROGRAM                                *
014140******************************************************************
