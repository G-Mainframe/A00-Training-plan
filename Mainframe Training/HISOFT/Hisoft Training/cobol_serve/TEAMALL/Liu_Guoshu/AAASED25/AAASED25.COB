000010******************************************************************
000020*         ＜海輝軟件(大連)＞                                     *
000030*      1. プログラム名  : 前受金受払残高ファイル作成             *
000040*      2. プログラムID  : AAASED25                               *
000050*      3. 処理概要      : 前受情報ＤＢをメインに、               *
000060*                         マスタと表結合して読込み、             *
000070*                         前受金受払残高中間ファイルを作成する。 *
000080*                                                                *
000090*      4. 作成者        : 劉国舒                                 *
000100*      5. 作成日        : 2005.03.28                             *
000110******************************************************************
000120*                                                                 
000130******************************************************************
000140*    ＩＤＥＮＴＩＦＩＣＡＴＩＯＮ  ＤＩＶＩＳＩＯＮ              *
000150******************************************************************
000160 IDENTIFICATION                       DIVISION.                   
000170*                                                                 
000180 PROGRAM-ID.                          AAASED25.                   
000190*                                                                 
000200******************************************************************
000210*    ＥＮＶＩＲＯＮＭＥＮＴ        ＤＩＶＩＳＩＯＮ              *
000220******************************************************************
000230 ENVIRONMENT                          DIVISION.                   
000240*                                                                 
000250******************************************************************
000260*    ＩＮＰＵＴ−ＯＵＴＰＵＴ      ＳＥＣＴＩＯＮ                *
000270******************************************************************
000280 INPUT-OUTPUT                         SECTION.                    
000290*                                                                 
000300 FILE-CONTROL.                                                    
000310     SELECT    出力ファイル           ASSIGN    TO     U11        
000320     FILE      STATUS     IS          Ｗ−ファイル状態            
000330     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000340*                                                                 
000350******************************************************************
000360*    ＤＡＴＡ                      ＤＩＶＩＳＩＯＮ              *
000370******************************************************************
000380 DATA                                 DIVISION.                   
000390*                                                                 
000400******************************************************************
000410*    ＦＩＬＥ                      ＳＥＣＴＩＯＮ                *
000420******************************************************************
000430 FILE                                 SECTION.                    
000440*                                                                 
000450*----------------------------------------------------------------*
000460*    出力ファイル                                                *
000470*----------------------------------------------------------------*
000480 FD  出力ファイル                                                 
000490     LABEL     RECORD     IS          STANDARD                    
000500     BLOCK     CONTAINS   0           RECORDS.                    
000510*                                                                 
000520 01  出力−レコード.                                              
000530     COPY  CPSCE50  REPLACING  ==()==  BY  ==出力−==.            
000540*                                                                 
000550******************************************************************
000560*  ＷＯＲＫＩＮＧ−ＳＴＯＲＡＧＥ  ＳＥＣＴＩＯＮ                *
000570******************************************************************
000580 WORKING-STORAGE                      SECTION.                    
000590*                                                                 
000600*----------------------------------------------------------------*
000610*    ホスト変数定義エリア                                        *
000620*----------------------------------------------------------------*
000630     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +34.
           02  SQLFPN-FILENAME PIC X(34) VALUE "C:\COB97\SOC\AAASED25\AA
      -    "ASED25.PCO".

       01  SQ0001 GLOBAL.
           02  FILLER PIC X(74) VALUE "select バッチ用業務年月   into :b
      -    "1  from D70GYM_TBL where 業務管理ＩＤ=:b2".

       01  SQ0003 GLOBAL.
           02  FILLER PIC X(89) VALUE "select 名称   into :b1  from D19M
      -    "SY_TBL where (コードＮＯ=:b2 and SUBSTR(コード,1,1)=:b3)".

       01  SQ0004 GLOBAL.
           02  FILLER PIC X(89) VALUE "select 名称   into :b1  from D19M
      -    "SY_TBL where (コードＮＯ=:b2 and SUBSTR(コード,1,2)=:b3)".

       01  SQ0005 GLOBAL.
           02  FILLER PIC X(160) VALUE "select 状態フラグ  ,債権契約件名
      -     "  ,担保区分   into :b1,:b2,:b3  from M01SAJ_TBL where (((レ
      -     "コード区分='1' and 契約番号=:b4) and 再リース回数=:b5) and 
      -    "契約種類=:".

           02  FILLER PIC X(3) VALUE "b6)".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +157234284.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +30.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 30 TIMES.


       01  SQ0002 GLOBAL.
           02  FILLER PIC X(160) VALUE "select M40MAB_TBL.レコード区分  
      -    ",M40MAB_TBL.経理用主契約区分  ,M40MAB_TBL.顧客区分  ,NVL(D01
      -    "TRS_TBL.名寄せコード,RPAD(' ',40,' '))  ,M40MAB_TBL.請求先取
      -    "引先コー".

           02  FILLER PIC X(160) VALUE "ド  ,M40MAB_TBL.請求先コード  ,M
      -    "40MAB_TBL.契約番号  ,M40MAB_TBL.契約種類  ,M40MAB_TBL.担当部
      -    "課コード  ,M40MAB_TBL.再リース回数  ,M40MAB_TBL.充当開始年月
      -    "  ,M40MA".

           02  FILLER PIC X(160) VALUE "B_TBL.充当月数  ,M40MAB_TBL.前払
      -    "回収方法  ,M40MAB_TBL.入金日  ,M40MAB_TBL.入金区分  ,NVL(D01
      -    "TRS_TBL.取引先名称,RPAD(' ',80,' '))  ,NVL(D02SQS_TBL.請求先
      -    "名称,RPA".

           02  FILLER PIC X(160) VALUE "D(' ',80,' '))  ,M40MAB_TBL.前月
      -    "末残高  ,M40MAB_TBL.当月回収額  ,M40MAB_TBL.当月消化額  ,M40
      -    "MAB_TBL.前月末残高他社  ,M40MAB_TBL.当月消化額他社  ,M40MAB_
      -    "TBL.当月".

           02  FILLER PIC X(160) VALUE "他社解約分料金  ,M40MAB_TBL.当月
      -    "他社解約分消費税  ,M40MAB_TBL.当月末残高他社  ,M40MAB_TBL.協
      -    "調区分  ,M40MAB_TBL.当月末残高  ,M40MAB_TBL.当月回収額他社  
      -    ",M40MAB_".

           02  FILLER PIC X(159) VALUE "TBL.仮受金入金日  ,M40MAB_TBL.仮
      -    "受金ＳＥＱ＿ＮＯ   from M40MAB_TBL ,D01TRS_TBL ,D02SQS_TBL w
      -    "here (((M40MAB_TBL.前受金受払残高表対象フラグ='1' and M40MAB
      -    "_TBL.請".

           02  FILLER PIC X(160) VALUE "求先取引先コード=D01TRS_TBL.取引
      -    "先コード(+)) and M40MAB_TBL.請求先取引先コード=D02SQS_TBL.取
      -    "引先コード(+)) and M40MAB_TBL.請求先コード=D02SQS_TBL.請求先
      -     "コード(+".

           02  FILLER PIC X(66) VALUE ")) order by M40MAB_TBL.レコード区
      -    "分,M40MAB_TBL.契約番号           ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +258.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +262.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +74.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +289.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +90.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1185.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +364.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +105.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +412.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +6.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +240.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +89.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +499.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +267.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +89.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +522.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +294.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +163.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +552.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +6.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1120.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +333.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +815.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000640*                                                                 
000650*--< 業務管理ＩＤ >                                               
000660 01  ＷＳ−業務管理ＩＤ               PIC X(08)                   
000670                                      VALUE  "GYMKNRRC".          
000680*                                                                 
000690*--< 主契約区分名称 >                                             
000700 01  ＷＳ−主契約区分名称             PIC X(12)                   
000710                                      VALUE  "038".               
000720*                                                                 
000730*--< 顧客区分名称 >                                               
000740 01  ＷＳ−顧客区分名称               PIC X(03)                   
000750                                      VALUE  "005".               
000760*                                                                 
000770*--< ＯＲＡＣＬＥ共通変数 >                                       
000780     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
000790*                                                                 
000800*--< ＯＲＡＣＬＥ  ＳＱＬ実行情報 >                               
000010*--＜ＳＱＬ共通変数＞
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000810     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000820*                                                                 
000830*--< 前受情報ＤＢ >                                               
000840     
      *    EXEC  SQL  INCLUDE  M40MAB.CBL            END-EXEC.
000850*                                                                 
000860*--< 業務管理テーブル >                                           
000010************************************************
000020* 前受情報(M40MAB)
000030************************************************
000040 01  Ｍ４０−レコード区分           PIC  X(1).
000050 01  Ｍ４０−契約番号               PIC  X(15).
000060 01  Ｍ４０−再リース回数           PIC S9(2) COMP-3.
000070 01  Ｍ４０−契約種類               PIC  X(3).
000080 01  Ｍ４０−仮受金入金日           PIC  X(8).
000090 01  Ｍ４０−仮受金ＳＥＱ−ＮＯ     PIC S9(6) COMP-3.
000100 01  Ｍ４０−前払回収方法           PIC  X(1).
000110 01  Ｍ４０−前払回収サイト         PIC S9(2) COMP-3.
000120 01  Ｍ４０−前払回収日             PIC  X(2).
000130 01  Ｍ４０−充当開始回             PIC S9(3) COMP-3.
000140 01  Ｍ４０−充当月数               PIC S9(3) COMP-3.
000150 01  Ｍ４０−充当開始年月           PIC  X(6).
000160 01  Ｍ４０−振込手数料             PIC S9(13) COMP-3.
000170 01  Ｍ４０−前払金額               PIC S9(13) COMP-3.
000180 01  Ｍ４０−前払金額消費税         PIC S9(13) COMP-3.
000190 01  Ｍ４０−他社前払金額           PIC S9(13) COMP-3.
000200 01  Ｍ４０−他社前払金額消費税     PIC S9(13) COMP-3.
000210 01  Ｍ４０−解約分料金累計         PIC S9(13) COMP-3.
000220 01  Ｍ４０−解約分消費税累計       PIC S9(13) COMP-3.
000230 01  Ｍ４０−他社解約分料金累計     PIC S9(13) COMP-3.
000240 01  Ｍ４０−他社解約分消費税累計   PIC S9(13) COMP-3.
000250 01  Ｍ４０−未回収額               PIC S9(13) COMP-3.
000260 01  Ｍ４０−他社未回収額           PIC S9(13) COMP-3.
000270 01  Ｍ４０−状態コード             PIC  N(2).
000280 01  Ｍ４０−銀行コード             PIC  X(4).
000290 01  Ｍ４０−支店コード             PIC  X(4).
000300 01  Ｍ４０−振込依頼人名           PIC  X(48).
000310 01  Ｍ４０−前受金受払残高表対象フラグ PIC  X(1).
000320 01  Ｍ４０−仮受金内訳表対象フラグ PIC  X(1).
000330 01  Ｍ４０−会計部門コード         PIC  X(2).
000340 01  Ｍ４０−仕訳フラグ−振替前受リース料 PIC  X(1).
000350 01  Ｍ４０−仕訳フラグ−振替前受   PIC  X(1).
000360 01  Ｍ４０−仕訳フラグ−振替仮受   PIC  X(1).
000370 01  Ｍ４０−契約開始日             PIC  X(8).
000380 01  Ｍ４０−請求先取引先コード     PIC  X(9).
000390 01  Ｍ４０−顧客区分               PIC  X(2).
000400 01  Ｍ４０−ＴＡＳＳコード         PIC  X(7).
000410 01  Ｍ４０−貸倒年月日             PIC  X(8).
000420 01  Ｍ４０−特定取引先区分         PIC  X(1).
000430 01  Ｍ４０−最大督促回数           PIC  X(1).
000440 01  Ｍ４０−請求先コード           PIC  X(5).
000450 01  Ｍ４０−契約先取引先コード     PIC  X(9).
000460 01  Ｍ４０−契約先コード           PIC  X(5).
000470 01  Ｍ４０−担当部課コード         PIC  X(4).
000480 01  Ｍ４０−担当者コード           PIC  X(8).
000490 01  Ｍ４０−協調区分               PIC  X(1).
000500 01  Ｍ４０−管理債権レベル         PIC  X(1).
000510 01  Ｍ４０−主契約区分             PIC  X(1).
000520 01  Ｍ４０−経理用主契約区分       PIC  X(1).
000530 01  Ｍ４０−取消区分               PIC  X(1).
000540 01  Ｍ４０−前月末残高             PIC S9(13) COMP-3.
000550 01  Ｍ４０−前月末残高他社         PIC S9(13) COMP-3.
000560 01  Ｍ４０−前月迄解約分料金累計   PIC S9(13) COMP-3.
000570 01  Ｍ４０−前月迄解約分消費税累計 PIC S9(13) COMP-3.
000580 01  Ｍ４０−前月迄他社解約分料金累計 PIC S9(13) COMP-3.
000590 01  Ｍ４０−前月迄他社解約分消費税累計 PIC S9(13) COMP-3.
000600 01  Ｍ４０−前月迄消化額累計       PIC S9(13) COMP-3.
000610 01  Ｍ４０−前月迄消化額累計他社   PIC S9(13) COMP-3.
000620 01  Ｍ４０−前月迄振替額累計       PIC S9(13) COMP-3.
000630 01  Ｍ４０−前月迄振替額累計他社   PIC S9(13) COMP-3.
000640 01  Ｍ４０−当月解約分料金         PIC S9(13) COMP-3.
000650 01  Ｍ４０−当月解約分消費税       PIC S9(13) COMP-3.
000660 01  Ｍ４０−当月他社解約分料金     PIC S9(13) COMP-3.
000670 01  Ｍ４０−当月他社解約分消費税   PIC S9(13) COMP-3.
000680 01  Ｍ４０−回収額                 PIC S9(13) COMP-3.
000690 01  Ｍ４０−他社回収額             PIC S9(13) COMP-3.
000700 01  Ｍ４０−他社回収額消費税       PIC S9(13) COMP-3.
000710 01  Ｍ４０−入金日                 PIC  X(8).
000720 01  Ｍ４０−費目                   PIC  X(1).
000730 01  Ｍ４０−入金区分               PIC  X(2).
000740 01  Ｍ４０−当月回収額             PIC S9(13) COMP-3.
000750 01  Ｍ４０−当月回収額他社         PIC S9(13) COMP-3.
000760 01  Ｍ４０−当月消化額             PIC S9(13) COMP-3.
000770 01  Ｍ４０−当月消化額他社         PIC S9(13) COMP-3.
000780 01  Ｍ４０−消化額累計             PIC S9(13) COMP-3.
000790 01  Ｍ４０−消化額累計他社         PIC S9(13) COMP-3.
000800 01  Ｍ４０−消化日                 PIC  X(8).
000810 01  Ｍ４０−当月振替額             PIC S9(13) COMP-3.
000820 01  Ｍ４０−当月振替額他社         PIC S9(13) COMP-3.
000830 01  Ｍ４０−振替日                 PIC  X(8).
000840 01  Ｍ４０−振替額累計             PIC S9(13) COMP-3.
000850 01  Ｍ４０−振替額累計他社         PIC S9(13) COMP-3.
000860 01  Ｍ４０−当月末残高             PIC S9(13) COMP-3.
000870 01  Ｍ４０−当月末残高他社         PIC S9(13) COMP-3.
000880 01  Ｍ４０−残前受月数             PIC S9(3)V9(2) COMP-3.
000870     
      *    EXEC  SQL  INCLUDE  D70GYM.CBL            END-EXEC.
000880*                                                                 
000890*--< 取引先マスタ>                                                
000010************************************************
000020* 業務管理(D70GYM)
000030************************************************
000040 01  Ｄ７０−業務管理ＩＤ           PIC  X(8).
000050 01  Ｄ７０−業務年月               PIC  X(6).
000060 01  Ｄ７０−期首年月               PIC  X(6).
000070 01  Ｄ７０−期末年月               PIC  X(6).
000080 01  Ｄ７０−旬処理日               PIC  X(8).
000090 01  Ｄ７０−旬次締日               PIC  X(8).
000100 01  Ｄ７０−旬次処理日             PIC  X(8).
000110 01  Ｄ７０−口振締日１             PIC  X(2).
000120 01  Ｄ７０−口振日１               PIC  X(8).
000130 01  Ｄ７０−口振仮締日１           PIC  X(8).
000140 01  Ｄ７０−口振本締日１           PIC  X(8).
000150 01  Ｄ７０−口振締日２             PIC  X(2).
000160 01  Ｄ７０−口振日２               PIC  X(8).
000170 01  Ｄ７０−口振仮締日２           PIC  X(8).
000180 01  Ｄ７０−口振本締日２           PIC  X(8).
000190 01  Ｄ７０−月次締日               PIC  X(8).
000200 01  Ｄ７０−月次処理日             PIC  X(8).
000210 01  Ｄ７０−年末締日               PIC  X(8).
000220 01  Ｄ７０−年末処理日             PIC  X(8).
000230 01  Ｄ７０−期末締日               PIC  X(8).
000240 01  Ｄ７０−期末処理日             PIC  X(8).
000250 01  Ｄ７０−最新請求書番号         PIC S9(7) COMP-3.
000260 01  Ｄ７０−更新年月日             PIC  X(8).
000270 01  Ｄ７０−更新時間               PIC  X(8).
000280 01  Ｄ７０−更新者                 PIC  X(8).
000290 01  Ｄ７０−入力担当者コード       PIC  X(8).
000300 01  Ｄ７０−バッチ用業務年月       PIC  X(6).
000310 01  Ｄ７０−バッチ用期首年月       PIC  X(6).
000320 01  Ｄ７０−バッチ用期末年月       PIC  X(6).
000330 01  Ｄ７０−督促処理年月日         PIC  X(8).
000340 01  Ｄ７０−チェックリスト処理年月日 PIC  X(8).
000350 01  Ｄ７０−最高支払依頼番号       PIC S9(10) COMP-3.
000360 01  Ｄ７０−月次処理開始年月日     PIC  X(8).
000370 01  Ｄ７０−月次処理開始時刻       PIC  X(8).
000380 01  Ｄ７０−月次処理終了年月日     PIC  X(8).
000390 01  Ｄ７０−月次処理終了時刻       PIC  X(8).
000400 01  Ｄ７０−前回督促処理年月日     PIC  X(8).
000410 01  Ｄ７０−バッチ処理状況フラグ   PIC  X(1).
000900     
      *    EXEC  SQL  INCLUDE  D01TRS.CBL            END-EXEC.
000910*                                                                 
000920*--< 請求先マスタ >                                               
      *****************************************************************
      *   取引先マスタ(D01TRS_TBL)
      *****************************************************************
       01  取引先マスタ.
           03  Ｄ０１−取引先コード  PIC  X(009).
           03  Ｄ０１−名寄せコード  PIC  X(040).
           03  Ｄ０１−取引先名称    PIC  X(080).
           03  Ｄ０１−取引先短名称  PIC  X(016).
           03  Ｄ０１−取引先カナ名称
                                     PIC  X(040).
           03  Ｄ０１−郵便番号      PIC  X(007).
           03  Ｄ０１−納付先コード  PIC  X(011).
           03  Ｄ０１−住所１        PIC  X(060).
           03  Ｄ０１−住所２        PIC  X(060).
           03  Ｄ０１−住所３        PIC  X(060).
           03  Ｄ０１−電話番号      PIC  X(015).
           03  Ｄ０１−旧社名        PIC  X(080).
           03  Ｄ０１−資本金        PIC S9(013) PACKED-DECIMAL.
           03  Ｄ０１−設立年        PIC S9(004) PACKED-DECIMAL.
           03  Ｄ０１−設立月        PIC S9(002) PACKED-DECIMAL.
           03  Ｄ０１−顧客区分      PIC  X(002).
           03  Ｄ０１−企業区分      PIC  X(001).
           03  Ｄ０１−従業員数      PIC S9(006) PACKED-DECIMAL.
           03  Ｄ０１−業種コード    PIC  X(005).
           03  Ｄ０１−格付ランク    PIC  X(003).
           03  Ｄ０１−現担当者      PIC  X(008).
           03  Ｄ０１−請求先最終番号
                                     PIC S9(005) PACKED-DECIMAL.
           03  Ｄ０１−支払先最終番号
                                     PIC S9(005) PACKED-DECIMAL.
           03  Ｄ０１−主担当部課コード
                                     PIC  X(004).
           03  Ｄ０１−格付ランク２  PIC  X(003).
           03  Ｄ０１−代表者名称    PIC  X(020).
           03  Ｄ０１−アドレス      PIC  X(040).
           03  Ｄ０１−顧客使用不可フラグ
                                     PIC  X(001).
           03  Ｄ０１−与信括りコード
                                     PIC  X(007).
           03  Ｄ０１−初回請求据置区分
                                     PIC  X(001).
           03  Ｄ０１−満了案内送付区分
                                     PIC  X(001).
           03  Ｄ０１−再リース自動継続区分
                                     PIC  X(001).
           03  Ｄ０１−特定取引先区分
                                     PIC  X(001).
           03  Ｄ０１−事業所名称    PIC  X(080).
           03  Ｄ０１−事業所郵便番号
                                     PIC  X(007).
           03  Ｄ０１−事業所住所コード
                                     PIC  X(011).
           03  Ｄ０１−事業所住所２  PIC  X(060).
           03  Ｄ０１−事業所電話番号
                                     PIC  X(015).
           03  Ｄ０１−生年月日      PIC  X(008).
           03  Ｄ０１−管理債権レベル
                                     PIC  X(001).
           03  Ｄ０１−貸倒年月日    PIC  X(008).
           03  Ｄ０１−貸倒金額      PIC S9(013) PACKED-DECIMAL.
           03  Ｄ０１−貸倒理由コード
                                     PIC  X(002).
           03  Ｄ０１−貸倒コメント  PIC  X(100).
           03  Ｄ０１−貸倒申請年月日
                                     PIC  X(008).
           03  Ｄ０１−自動請求データ作成要否
                                     PIC  X(001).
           03  Ｄ０１−開示帳票取得価格区分
                                     PIC  X(001).
           03  Ｄ０１−取引開始年月  PIC  X(006).
           03  Ｄ０１−創業年月      PIC  X(006).
           03  Ｄ０１−系列          PIC  X(030).
           03  Ｄ０１−販売先        PIC  X(030).
           03  Ｄ０１−仕入先        PIC  X(030).
           03  Ｄ０１−主要株主      PIC  X(020).
           03  Ｄ０１−主要株主持率  PIC S9(003)V9(003) PACKED-DECIMAL.
           03  Ｄ０１−保証人管理債権レベル
                                     PIC  X(001).
           03  Ｄ０１−過去最高督促段階
                                     PIC  X(001).
           03  Ｄ０１−過去最高督促段階更新日
                                     PIC  X(008).
           03  Ｄ０１−現在最高督促段階
                                     PIC  X(001).
           03  Ｄ０１−現在最高督促段階更新日
                                     PIC  X(008).
           03  Ｄ０１−売却現在最高督促段階
                                     PIC  X(001).
           03  Ｄ０１−売却現在最高督促段階更新日
                                     PIC  X(008).
           03  Ｄ０１−リース督促交渉出力フラグ
                                     PIC  X(001).
           03  Ｄ０１−中途解約督促交渉出力フラグ
                                     PIC  X(001).
           03  Ｄ０１−売却督促交渉出力フラグ
                                     PIC  X(001).
           03  Ｄ０１−銀行コード    PIC  X(004).
           03  Ｄ０１−支店コード    PIC  X(003).
           03  Ｄ０１−代表者役職名  PIC  X(020).
           03  Ｄ０１−従業種名      PIC  X(020).
           03  Ｄ０１−住所名カナ    PIC  X(040).
           03  Ｄ０１−コメント欄    PIC  X(120).
           03  Ｄ０１−帝国コード    PIC  X(009).
           03  Ｄ０１−主要株主持株数
                                     PIC S9(010) PACKED-DECIMAL.
           03  Ｄ０１−株主数        PIC S9(010) PACKED-DECIMAL.
           03  Ｄ０１−全国業界順位  PIC S9(007) PACKED-DECIMAL.
           03  Ｄ０１−全国業界会社数
                                     PIC S9(007) PACKED-DECIMAL.
           03  Ｄ０１−県内業界順位  PIC S9(007) PACKED-DECIMAL.
           03  Ｄ０１−県内業界会社数
                                     PIC S9(007) PACKED-DECIMAL.
           03  Ｄ０１−事業所数      PIC S9(005) PACKED-DECIMAL.
           03  Ｄ０１−主要事業所名  PIC  X(120).
           03  Ｄ０１−利用リース会社名
                                     PIC  X(040).
           03  Ｄ０１−スコアリング評点
                                     PIC S9(003) PACKED-DECIMAL.
           03  Ｄ０１−帝国評点      PIC S9(003) PACKED-DECIMAL.
           03  Ｄ０１−格付申請中フラグ
                                     PIC  X(001).
           03  Ｄ０１−格付調整申請理由
                                     PIC  X(200).
           03  Ｄ０１−格付日        PIC  X(008).
           03  Ｄ０１−与信限度額適用日
                                     PIC  X(008).
           03  Ｄ０１−当社取引開始経緯
                                     PIC  X(160).
           03  Ｄ０１−企業目的      PIC  X(100).
           03  Ｄ０１−表示単位区分  PIC  X(001).
           03  Ｄ０１−ＢＴＭ取引区分
                                     PIC  X(001).
           03  Ｄ０１−ＢＴＭ担当支店コード
                                     PIC  X(003).
           03  Ｄ０１−情報交換通知区分
                                     PIC  X(001).
           03  Ｄ０１−情報交換通知設定日
                                     PIC  X(008).
           03  Ｄ０１−ＢＴＭ連結対象区分
                                     PIC  X(001).
           03  Ｄ０１−ＢＯＴＬ連結対象区分
                                     PIC  X(001).
           03  Ｄ０１−親密先区分    PIC  X(001).
           03  Ｄ０１−ＮＥＴＬＥＡＳＩＮＧ利用対象区分
                                     PIC  X(001).
           03  Ｄ０１−転リース提携先コード
                                     PIC  X(003).
           03  Ｄ０１−事業所住所１  PIC  X(060).
           03  Ｄ０１−事業所住所３  PIC  X(060).
           03  Ｄ０１−企業決算月    PIC  X(002).
           03  Ｄ０１−一般大口区分  PIC  X(001).
           03  Ｄ０１−借入金識別区分
                                     PIC  X(001).
           03  Ｄ０１−借入先種別    PIC  X(002).
           03  Ｄ０１−担保差入率    PIC S9(003) PACKED-DECIMAL.
           03  Ｄ０１−旧名寄せコード
                                     PIC  X(008).
           03  Ｄ０１−更新年月日    PIC  X(008).
           03  Ｄ０１−更新時間      PIC  X(008).
           03  Ｄ０１−更新者        PIC  X(008).
           03  Ｄ０１−登録年月日    PIC  X(008).
           03  Ｄ０１−登録時間      PIC  X(008).
           03  Ｄ０１−登録担当者    PIC  X(008).
           03  Ｄ０１−入力担当者コード
                                     PIC  X(008).
000930     
      *    EXEC  SQL  INCLUDE  D02SQS.CBL            END-EXEC.
000940*                                                                 
000950*--< 項目名称マスタ >                                             
      *****************************************************************
      *   請求先マスタ(D02SQS_TBL)
      *****************************************************************
       01  請求先マスタ.
           03  Ｄ０２−取引先コード  PIC  X(009).
           03  Ｄ０２−請求先コード  PIC  X(005).
           03  Ｄ０２−請求先名称    PIC  X(080).
           03  Ｄ０２−部門名称      PIC  X(060).
           03  Ｄ０２−担当者名称    PIC  X(020).
           03  Ｄ０２−請求書表示    PIC  X(001).
           03  Ｄ０２−振込人名      PIC  X(040).
           03  Ｄ０２−郵便番号      PIC  X(007).
           03  Ｄ０２−納付先コード  PIC  X(011).
           03  Ｄ０２−住所２        PIC  X(060).
           03  Ｄ０２−住所３        PIC  X(060).
           03  Ｄ０２−電話番号      PIC  X(015).
           03  Ｄ０２−一括入金コード
                                     PIC  X(005).
           03  Ｄ０２−送付先名称    PIC  X(060).
           03  Ｄ０２−送付先部門    PIC  X(060).
           03  Ｄ０２−送付先担当者  PIC  X(020).
           03  Ｄ０２−送付先カナ名称
                                     PIC  X(040).
           03  Ｄ０２−送付先郵便番号
                                     PIC  X(007).
           03  Ｄ０２−送付先市町村コード
                                     PIC  X(011).
           03  Ｄ０２−送付先住所２  PIC  X(060).
           03  Ｄ０２−送付先住所３  PIC  X(060).
           03  Ｄ０２−送付先電話番号
                                     PIC  X(015).
           03  Ｄ０２−自動マッチング対象外区分
                                     PIC  X(001).
           03  Ｄ０２−回収サイト    PIC S9(002) PACKED-DECIMAL.
           03  Ｄ０２−回収日        PIC  X(002).
           03  Ｄ０２−回収方法      PIC  X(001).
           03  Ｄ０２−回収間隔      PIC S9(002) PACKED-DECIMAL.
           03  Ｄ０２−請求サイト    PIC S9(002) PACKED-DECIMAL.
           03  Ｄ０２−請求締日      PIC  X(002).
           03  Ｄ０２−請求間隔      PIC S9(002) PACKED-DECIMAL.
           03  Ｄ０２−請求基準月    PIC S9(002) PACKED-DECIMAL.
           03  Ｄ０２−作成通数      PIC S9(002) PACKED-DECIMAL.
           03  Ｄ０２−作成単位      PIC  X(001).
           03  Ｄ０２−請求書作成区分
                                     PIC  X(001).
           03  Ｄ０２−請求指定様式区分
                                     PIC  X(001).
           03  Ｄ０２−送付区分      PIC  X(001).
           03  Ｄ０２−受取側金融機関コード
                                     PIC  X(004).
           03  Ｄ０２−受取側支店コード
                                     PIC  X(003).
           03  Ｄ０２−受取側口座種類
                                     PIC  X(001).
           03  Ｄ０２−受取側口座番号
                                     PIC  X(010).
           03  Ｄ０２−口振銀行コード
                                     PIC  X(004).
           03  Ｄ０２−口振支店コード
                                     PIC  X(003).
           03  Ｄ０２−口振口座種類  PIC  X(001).
           03  Ｄ０２−口振口座番号  PIC  X(010).
           03  Ｄ０２−口振名義人    PIC  X(030).
           03  Ｄ０２−請求宛名印刷  PIC  X(001).
           03  Ｄ０２−請求日付印刷  PIC  X(001).
           03  Ｄ０２−回収期限印刷  PIC  X(001).
           03  Ｄ０２−使用月印刷    PIC  X(001).
           03  Ｄ０２−内訳印刷      PIC  X(001).
           03  Ｄ０２−請求番号印刷  PIC  X(001).
           03  Ｄ０２−摘要欄印刷    PIC  X(001).
           03  Ｄ０２−摘要欄        PIC  X(060).
           03  Ｄ０２−備考欄印刷    PIC  X(001).
           03  Ｄ０２−口振ご案内書作成区分
                                     PIC  X(001).
           03  Ｄ０２−集約区分      PIC  X(001).
           03  Ｄ０２−更新日時      PIC  X(016).
           03  Ｄ０２−更新者        PIC  X(008).
           03  Ｄ０２−送付先コード  PIC  X(003).
           03  Ｄ０２−仮想口座連番  PIC S9(003) PACKED-DECIMAL.
           03  Ｄ０２−顧客使用不可フラグ
                                     PIC  X(001).
           03  Ｄ０２−コメント欄    PIC  X(060).
           03  Ｄ０２−入力担当者コード
                                     PIC  X(008).
           03  Ｄ０２−部門カナ名称  PIC  X(030).
           03  Ｄ０２−契約先コード  PIC  X(005).
           03  Ｄ０２−共有フラグ    PIC  X(001).
           03  Ｄ０２−住所１        PIC  X(060).
           03  Ｄ０２−住所カナ名称  PIC  X(060).
           03  Ｄ０２−ＦＡＸ番号    PIC  X(015).
           03  Ｄ０２−振替銀行コード
                                     PIC  X(004).
           03  Ｄ０２−自振引落日    PIC  X(002).
           03  Ｄ０２−受取側口座コード
                                     PIC  X(002).
           03  Ｄ０２−振込手数料負担区分
                                     PIC  X(001).
           03  Ｄ０２−現担当者      PIC  X(008).
           03  Ｄ０２−主担当部課コード
                                     PIC  X(004).
           03  Ｄ０２−登録年月日    PIC  X(008).
           03  Ｄ０２−登録時間      PIC  X(008).
           03  Ｄ０２−登録担当者    PIC  X(008).
           03  Ｄ０２−更新年月日    PIC  X(008).
           03  Ｄ０２−更新時間      PIC  X(008).
           03  Ｄ０２−旧請求先コード
                                     PIC  X(008).
           03  Ｄ０２−口座引落依頼書受領日
                                     PIC  X(008).
           03  Ｄ０２−口座引落開始日
                                     PIC  X(008).
000960     
      *    EXEC  SQL  INCLUDE  D19MSY.CBL            END-EXEC.
000970*                                                                 
000980*--< 債権情報（一般）ＤＢ>                                        
      *****************************************************************
      *   項目名称マスタ(D19MSY_TBL)
      *****************************************************************
       01  項目名称マスタ.
           03  Ｄ１９−コードＮＯ    PIC  X(012).
           03  Ｄ１９−コード        PIC  X(005).
           03  Ｄ１９−コード名      PIC  X(040).
           03  Ｄ１９−名称          PIC  X(060).
           03  Ｄ１９−更新日時      PIC  X(016).
           03  Ｄ１９−更新者        PIC  X(008).
           03  Ｄ１９−デフォルト区分
                                     PIC  X(001).
           03  Ｄ１９−パスワード入力区分
                                     PIC  X(001).
           03  Ｄ１９−ソート順      PIC S9(003) PACKED-DECIMAL.
           03  Ｄ１９−入力担当者コード
                                     PIC  X(008).
           03  Ｄ１９−登録年月日    PIC  X(008).
           03  Ｄ１９−登録時間      PIC  X(008).
           03  Ｄ１９−登録担当者    PIC  X(008).
           03  Ｄ１９−更新年月日    PIC  X(008).
           03  Ｄ１９−更新時間      PIC  X(008).
000990     
      *    EXEC  SQL  INCLUDE  M01SAJ.CBL            END-EXEC.
001000*                                                                 
000100************************************************
000200* 債権情報(一般)(M01SAJ)
000300************************************************
000400 01  Ｍ０１−レコード区分           PIC  X(1).
000500 01  Ｍ０１−契約番号               PIC  X(15).
000600 01  Ｍ０１−再リース回数           PIC S9(2) COMP-3.
000700 01  Ｍ０１−契約種類               PIC  X(3).
000800 01  Ｍ０１−連番                   PIC S9(3) COMP-3.
000900 01  Ｍ０１−請求区分               PIC  X(1).
001000 01  Ｍ０１−解約売却取消区分       PIC  X(1).
001100 01  Ｍ０１−処理年月               PIC  X(6).
001200 01  Ｍ０１−請求先取引先コード     PIC  X(9).
001300 01  Ｍ０１−顧客区分               PIC  X(2).
001400 01  Ｍ０１−ＴＡＳＳコード         PIC  X(7).
001500 01  Ｍ０１−貸倒年月日             PIC  X(8).
001600 01  Ｍ０１−特定取引先区分         PIC  X(1).
001700 01  Ｍ０１−最大督促回数           PIC  X(1).
001800 01  Ｍ０１−契約日                 PIC  X(8).
001900 01  Ｍ０１−引渡年月日             PIC  X(8).
002000 01  Ｍ０１−契約開始日             PIC  X(8).
002100 01  Ｍ０１−契約終了日             PIC  X(8).
002200 01  Ｍ０１−期間                   PIC S9(3) COMP-3.
002300 01  Ｍ０１−契約区分               PIC  X(1).
002400 01  Ｍ０１−リース開始区分         PIC  X(1).
002500 01  Ｍ０１−担当部課コード         PIC  X(4).
002600 01  Ｍ０１−担当者コード           PIC  X(8).
002700 01  Ｍ０１−協調区分               PIC  X(1).
002800 01  Ｍ０１−状態フラグ             PIC  X(1).
002900 01  Ｍ０１−主契約区分             PIC  X(1).
003000 01  Ｍ０１−遡及処理区分           PIC  X(1).
003100 01  Ｍ０１−遡及処理年月           PIC  X(6).
003200 01  Ｍ０１−成約年月               PIC  X(6).
003300 01  Ｍ０１−成約取消年月           PIC  X(6).
003400 01  Ｍ０１−検収処理年月           PIC  X(6).
003500 01  Ｍ０１−検収取消日             PIC  X(8).
003600 01  Ｍ０１−検収取消処理年月       PIC  X(6).
003700 01  Ｍ０１−最新回収期間           PIC S9(3) COMP-3.
003800 01  Ｍ０１−総回収回数             PIC S9(3) COMP-3.
003900 01  Ｍ０１−請求間隔               PIC S9(2) COMP-3.
004000 01  Ｍ０１−回収間隔               PIC S9(2) COMP-3.
004100 01  Ｍ０１−制度転登録年月         PIC  X(6).
004200 01  Ｍ０１−制度転確定フラグ       PIC  X(1).
004300 01  Ｍ０１−回収サイト             PIC S9(2) COMP-3.
004400 01  Ｍ０１−回収方法               PIC  X(1).
004500 01  Ｍ０１−再リース区分           PIC  X(1).
004600 01  Ｍ０１−管理債権レベル         PIC  X(1).
004700 01  Ｍ０１−前払フラグ             PIC  X(1).
004800 01  Ｍ０１−督促回数               PIC S9(1) COMP-3.
004900 01  Ｍ０１−請求先コード           PIC  X(5).
005000 01  Ｍ０１−契約先取引先コード     PIC  X(9).
005100 01  Ｍ０１−契約先コード           PIC  X(5).
005200 01  Ｍ０１−支払取引先コード       PIC  X(9).
005300 01  Ｍ０１−支払先コード           PIC  X(5).
005400 01  Ｍ０１−雑費販促費             PIC S9(13) COMP-3.
005500 01  Ｍ０１−最新月額料金           PIC S9(13) COMP-3.
005600 01  Ｍ０１−最新消費率             PIC S9(2)V9(7) COMP-3.
005700 01  Ｍ０１−最新消費税額           PIC S9(13) COMP-3.
005800 01  Ｍ０１−当初契約総額           PIC S9(13) COMP-3.
005900 01  Ｍ０１−当初消費税総額         PIC S9(13) COMP-3.
006000 01  Ｍ０１−最新契約総額           PIC S9(13) COMP-3.
006100 01  Ｍ０１−最新消費税総額         PIC S9(13) COMP-3.
006200 01  Ｍ０１−保守無償期間           PIC S9(3) COMP-3.
006300 01  Ｍ０１−回収額                 PIC S9(13) COMP-3.
006400 01  Ｍ０１−消費税回収額           PIC S9(13) COMP-3.
006500 01  Ｍ０１−最新回収日             PIC  X(8).
006600 01  Ｍ０１−割賦原価総額           PIC S9(13) COMP-3.
006700 01  Ｍ０１−割賦利益総額           PIC S9(13) COMP-3.
006800 01  Ｍ０１−当初取得価額           PIC S9(13) COMP-3.
006900 01  Ｍ０１−満了フラグ             PIC  X(1).
007000 01  Ｍ０１−満了日                 PIC  X(8).
007100 01  Ｍ０１−資産種類               PIC  X(5).
007200 01  Ｍ０１−合算先契約種類         PIC  X(3).
007300 01  Ｍ０１−貸付利率               PIC S9(2)V9(7) COMP-3.
007400 01  Ｍ０１−再リース手数料         PIC S9(13) COMP-3.
007500 01  Ｍ０１−委託保守区分           PIC  X(1).
007600 01  Ｍ０１−委託保守相当月額       PIC S9(13) COMP-3.
007700 01  Ｍ０１−制度転支払月額         PIC S9(13) COMP-3.
007800 01  Ｍ０１−前払月数               PIC S9(3) COMP-3.
007900 01  Ｍ０１−その他契約種類区分     PIC  X(1).
008000 01  Ｍ０１−契約種類区分           PIC  X(1).
008100 01  Ｍ０１−契約種類内部コード     PIC  X(2).
008200 01  Ｍ０１−支払利息               PIC S9(13) COMP-3.
008300 01  Ｍ０１−原価調整額             PIC S9(13) COMP-3.
008400 01  Ｍ０１−固定資産税             PIC S9(13) COMP-3.
008500 01  Ｍ０１−年利回り               PIC S9(2)V9(3) COMP-3.
008600 01  Ｍ０１−運用利回り             PIC S9(2)V9(3) COMP-3.
008700 01  Ｍ０１−粗利益額               PIC S9(13) COMP-3.
008800 01  Ｍ０１−粗利益額−表           PIC S9(13) COMP-3.
008900 01  Ｍ０１−粗利益額−裏           PIC S9(13) COMP-3.
009000 01  Ｍ０１−規定損害金基本額       PIC S9(13) COMP-3.
009100 01  Ｍ０１−信用保険料             PIC S9(13) COMP-3.
009200 01  Ｍ０１−動産保険料             PIC S9(13) COMP-3.
009300 01  Ｍ０１−保守料                 PIC S9(13) COMP-3.
009400 01  Ｍ０１−その他雑費             PIC S9(13) COMP-3.
009500 01  Ｍ０１−手数料                 PIC S9(13) COMP-3.
009600 01  Ｍ０１−手形受取日             PIC  X(8).
009700 01  Ｍ０１−手形枚数               PIC S9(3) COMP-3.
009800 01  Ｍ０１−格付区分               PIC  X(2).
009900 01  Ｍ０１−取得価額               PIC S9(13) COMP-3.
010000 01  Ｍ０１−自社分月額料金         PIC S9(13) COMP-3.
010100 01  Ｍ０１−自社分月額消費税       PIC S9(13) COMP-3.
010200 01  Ｍ０１−自社分契約総額         PIC S9(13) COMP-3.
010300 01  Ｍ０１−自社分消費税総額       PIC S9(13) COMP-3.
010400 01  Ｍ０１−他社購入額             PIC S9(13) COMP-3.
010500 01  Ｍ０１−残価設定額             PIC S9(13) COMP-3.
010600 01  Ｍ０１−他社残価設定額         PIC S9(13) COMP-3.
010700 01  Ｍ０１−他社回収額             PIC S9(13) COMP-3.
010800 01  Ｍ０１−他社回収額消費税       PIC S9(13) COMP-3.
010900 01  Ｍ０１−他社割賦原価総額       PIC S9(13) COMP-3.
011000 01  Ｍ０１−他社割賦利益総額       PIC S9(13) COMP-3.
011100 01  Ｍ０１−解約フラグ             PIC  X(1).
011200 01  Ｍ０１−解約日                 PIC  X(8).
011300 01  Ｍ０１−解約回数               PIC S9(3) COMP-3.
011400 01  Ｍ０１−解約区分               PIC  X(1).
011500 01  Ｍ０１−解約理由               PIC  X(2).
011600 01  Ｍ０１−解約処理年月           PIC  X(6).
011700 01  Ｍ０１−取消区分               PIC  X(1).
011800 01  Ｍ０１−解約取消処理年月       PIC  X(6).
011900 01  Ｍ０１−解約年月               PIC  X(6).
012000 01  Ｍ０１−解約月数               PIC S9(3) COMP-3.
012100 01  Ｍ０１−前月債権総額           PIC S9(13) COMP-3.
012200 01  Ｍ０１−前月売上総額           PIC S9(13) COMP-3.
012300 01  Ｍ０１−前月売上総額他社       PIC S9(13) COMP-3.
012400 01  Ｍ０１−前月消費税総額         PIC S9(13) COMP-3.
012500 01  Ｍ０１−前月消費税総額他社     PIC S9(13) COMP-3.
012600 01  Ｍ０１−売上総額               PIC S9(13) COMP-3.
012700 01  Ｍ０１−売上総額他社           PIC S9(13) COMP-3.
012800 01  Ｍ０１−売上消費税総額         PIC S9(13) COMP-3.
012900 01  Ｍ０１−売上消費税総額他社     PIC S9(13) COMP-3.
013000 01  Ｍ０１−前期末未実現残高       PIC S9(13) COMP-3.
013100 01  Ｍ０１−前期末未実現残高他社   PIC S9(13) COMP-3.
013200 01  Ｍ０１−前期迄売上額累計       PIC S9(13) COMP-3.
013300 01  Ｍ０１−前期迄売上額累計他社   PIC S9(13) COMP-3.
013400 01  Ｍ０１−前期迄消費税額累計     PIC S9(13) COMP-3.
013500 01  Ｍ０１−前期迄消費税額累計他社 PIC S9(13) COMP-3.
013600 01  Ｍ０１−当月売上額             PIC S9(13) COMP-3.
013700 01  Ｍ０１−当月売上額２           PIC S9(13) COMP-3.
013800 01  Ｍ０１−当月売上額他社         PIC S9(13) COMP-3.
013900 01  Ｍ０１−当月消費税相当額       PIC S9(13) COMP-3.
014000 01  Ｍ０１−当月消費税相当額２     PIC S9(13) COMP-3.
014100 01  Ｍ０１−当月消費税相当額他社   PIC S9(13) COMP-3.
014200 01  Ｍ０１−当月消費税率           PIC S9(2)V9(7) COMP-3.
014300 01  Ｍ０１−当月消費税率２         PIC S9(2)V9(7) COMP-3.
014400 01  Ｍ０１−当月消費税率他社       PIC S9(2)V9(7) COMP-3.
014500 01  Ｍ０１−当月迄売上額累計       PIC S9(13) COMP-3.
014600 01  Ｍ０１−当月迄売上額累計他社   PIC S9(13) COMP-3.
014700 01  Ｍ０１−当月迄消費税額累計     PIC S9(13) COMP-3.
014800 01  Ｍ０１−当月迄消費税額累計他社 PIC S9(13) COMP-3.
014900 01  Ｍ０１−当期売上額累計         PIC S9(13) COMP-3.
015000 01  Ｍ０１−当期売上額累計他社     PIC S9(13) COMP-3.
015100 01  Ｍ０１−当月末未実現残高       PIC S9(13) COMP-3.
015200 01  Ｍ０１−当月末未実現残高他社   PIC S9(13) COMP-3.
015300 01  Ｍ０１−当月売上増加額         PIC S9(13) COMP-3.
015400 01  Ｍ０１−当月売上増加額他社     PIC S9(13) COMP-3.
015500 01  Ｍ０１−当月消費税増加額       PIC S9(13) COMP-3.
015600 01  Ｍ０１−当月消費税増加額他社   PIC S9(13) COMP-3.
015700 01  Ｍ０１−当月売上減少額         PIC S9(13) COMP-3.
015800 01  Ｍ０１−当月売上減少額他社     PIC S9(13) COMP-3.
015900 01  Ｍ０１−当月消費税減少額       PIC S9(13) COMP-3.
016000 01  Ｍ０１−当月消費税減少額他社   PIC S9(13) COMP-3.
016100 01  Ｍ０１−当月遡及分増加自売上年月 PIC  X(6).
016200 01  Ｍ０１−当月遡及分増加至売上年月 PIC  X(6).
016300 01  Ｍ０１−当月遡及分売上増加額   PIC S9(13) COMP-3.
016400 01  Ｍ０１−当月遡及分売上増加額２ PIC S9(13) COMP-3.
016500 01  Ｍ０１−当月遡及分売上増加額他社 PIC S9(13) COMP-3.
016600 01  Ｍ０１−当月遡及分消費税増加額 PIC S9(13) COMP-3.
016700 01  Ｍ０１−当月遡及分消費税増加額２ PIC S9(13) COMP-3.
016800 01  Ｍ０１−当月遡及分消費税増加額他社 PIC S9(13) COMP-3.
016900 01  Ｍ０１−当月遡及分減少自売上年月 PIC  X(6).
017000 01  Ｍ０１−当月遡及分減少至売上年月 PIC  X(6).
017100 01  Ｍ０１−当月遡及分売上減少額   PIC S9(13) COMP-3.
017200 01  Ｍ０１−当月遡及分売上減少額２ PIC S9(13) COMP-3.
017300 01  Ｍ０１−当月遡及分売上減少額他社 PIC S9(13) COMP-3.
017400 01  Ｍ０１−当月遡及分消費税減少額 PIC S9(13) COMP-3.
017500 01  Ｍ０１−当月遡及分消費税減少額２ PIC S9(13) COMP-3.
017600 01  Ｍ０１−当月遡及分消費税減少額他社 PIC S9(13) COMP-3.
017700 01  Ｍ０１−当月遡及分消費税率     PIC S9(2)V9(7) COMP-3.
017800 01  Ｍ０１−当月遡及分消費税率２   PIC S9(2)V9(7) COMP-3.
017900 01  Ｍ０１−前月売上額             PIC S9(13) COMP-3.
018000 01  Ｍ０１−前月売上額２           PIC S9(13) COMP-3.
018100 01  Ｍ０１−前月売上額他社         PIC S9(13) COMP-3.
018200 01  Ｍ０１−前月消費税相当額       PIC S9(13) COMP-3.
018300 01  Ｍ０１−前月消費税相当額２     PIC S9(13) COMP-3.
018400 01  Ｍ０１−前月消費税相当額他社   PIC S9(13) COMP-3.
018500 01  Ｍ０１−前月迄売上額累計       PIC S9(13) COMP-3.
018600 01  Ｍ０１−前月迄売上額累計他社   PIC S9(13) COMP-3.
018700 01  Ｍ０１−前月迄消費税額累計     PIC S9(13) COMP-3.
018800 01  Ｍ０１−前月迄消費税額累計他社 PIC S9(13) COMP-3.
018900 01  Ｍ０１−前期末元本残高         PIC S9(13) COMP-3.
019000 01  Ｍ０１−前期末利息残高         PIC S9(13) COMP-3.
019100 01  Ｍ０１−前月迄元本回収額累計   PIC S9(13) COMP-3.
019200 01  Ｍ０１−前月迄利息回収額累計   PIC S9(13) COMP-3.
019300 01  Ｍ０１−前月末元本残高         PIC S9(13) COMP-3.
019400 01  Ｍ０１−前月末利息残高         PIC S9(13) COMP-3.
019500 01  Ｍ０１−新規増加分元本額       PIC S9(13) COMP-3.
019600 01  Ｍ０１−新規増加分利息額       PIC S9(13) COMP-3.
019700 01  Ｍ０１−当月元本入金額         PIC S9(13) COMP-3.
019800 01  Ｍ０１−当月利息入金額         PIC S9(13) COMP-3.
019900 01  Ｍ０１−当月末元本残高         PIC S9(13) COMP-3.
020000 01  Ｍ０１−当月末利息残高         PIC S9(13) COMP-3.
020100 01  Ｍ０１−当月迄元本収入予定額累計 PIC S9(13) COMP-3.
020200 01  Ｍ０１−当月迄利息収入予定額累計 PIC S9(13) COMP-3.
020300 01  Ｍ０１−当月迄元本回収額累計   PIC S9(13) COMP-3.
020400 01  Ｍ０１−当月迄利息回収額累計   PIC S9(13) COMP-3.
020500 01  Ｍ０１−当月迄元本回収額累計他社 PIC S9(13) COMP-3.
020600 01  Ｍ０１−当月迄利息回収額累計他社 PIC S9(13) COMP-3.
020700 01  Ｍ０１−当月回収予定額         PIC S9(13) COMP-3.
020800 01  Ｍ０１−元本未経過リース料     PIC S9(13) COMP-3.
020900 01  Ｍ０１−利息未経過リース料     PIC S9(13) COMP-3.
021000 01  Ｍ０１−元本未収リース料       PIC S9(13) COMP-3.
021100 01  Ｍ０１−利息未収リース料       PIC S9(13) COMP-3.
021200 01  Ｍ０１−当月前受リース料入金額 PIC S9(13) COMP-3.
021300 01  Ｍ０１−当月迄前受リース料入金額 PIC S9(13) COMP-3.
021400 01  Ｍ０１−当月前受リース料消化額 PIC S9(13) COMP-3.
021500 01  Ｍ０１−当月前受金消化額       PIC S9(13) COMP-3.
021600 01  Ｍ０１−元本前受金             PIC S9(13) COMP-3.
021700 01  Ｍ０１−利息前受金             PIC S9(13) COMP-3.
021800 01  Ｍ０１−当月末前受リース料残高 PIC S9(13) COMP-3.
021900 01  Ｍ０１−貸倒損失額             PIC S9(13) COMP-3.
022000 01  Ｍ０１−現在簿価               PIC S9(13) COMP-3.
022100 01  Ｍ０１−耐用年数               PIC S9(2) COMP-3.
022200 01  Ｍ０１−保険料率               PIC S9(2) COMP-3.
022300 01  Ｍ０１−拘束期間後当月レンタル料 PIC S9(13) COMP-3.
022400 01  Ｍ０１−当月売上対象フラグ     PIC  X(1).
022500 01  Ｍ０１−新契約番号             PIC  X(15).
022600 01  Ｍ０１−当月売上調整フラグ     PIC  X(1).
022700 01  Ｍ０１−当月条件変更フラグ     PIC  X(1).
022800 01  Ｍ０１−営業概要契約抽出フラグ PIC  X(1).
022900 01  Ｍ０１−営業概要検収抽出フラグ PIC  X(1).
023000 01  Ｍ０１−営業所区分             PIC  X(1).
023100 01  Ｍ０１−契約内容契約件名       PIC  N(20).
023200 01  Ｍ０１−債権契約件名           PIC  N(20).
023300 01  Ｍ０１−成約日                 PIC  X(8).
023400 01  Ｍ０１−社内金利               PIC S9(2)V9(3) COMP-3.
023500 01  Ｍ０１−年粗利率               PIC S9(2)V9(3) COMP-3.
023600 01  Ｍ０１−販売促進費             PIC S9(13) COMP-3.
023700 01  Ｍ０１−雑費                   PIC S9(13) COMP-3.
023800 01  Ｍ０１−最終回収予定日         PIC  X(8).
023900 01  Ｍ０１−会計部門コード         PIC  X(2).
024000 01  Ｍ０１−満了売却フラグ         PIC  X(1).
024100 01  Ｍ０１−債権譲渡支払額         PIC S9(13) COMP-3.
024200 01  Ｍ０１−仕訳フラグ−売上       PIC  X(1).
024300 01  Ｍ０１−仕訳フラグ−検収       PIC  X(1).
024400 01  Ｍ０１−再リース取消エントリ日 PIC  X(8).
024500 01  Ｍ０１−消費税区分             PIC  X(2).
024600 01  Ｍ０１−当初他社購入額         PIC S9(13) COMP-3.
024700 01  Ｍ０１−他社最新契約総額       PIC S9(13) COMP-3.
024800 01  Ｍ０１−他社最新消費税総額     PIC S9(13) COMP-3.
024900 01  Ｍ０１−他社契約総額           PIC S9(13) COMP-3.
025000 01  Ｍ０１−成約取消エントリ日     PIC  X(8).
025100 01  Ｍ０１−売廃フラグ             PIC  X(1).
025200 01  Ｍ０１−再リース処理年月       PIC  X(6).
025300 01  Ｍ０１−再リース自動継続区分   PIC  X(1).
025400 01  Ｍ０１−再リース申請書有無区分 PIC  X(1).
025500 01  Ｍ０１−再リース申請フラグ     PIC  X(1).
025600 01  Ｍ０１−解約申請フラグ         PIC  X(1).
025700 01  Ｍ０１−自動請求区分           PIC  X(1).
025800 01  Ｍ０１−前月割賦原価総額       PIC S9(13) COMP-3.
025900 01  Ｍ０１−前月他社割賦原価総額   PIC S9(13) COMP-3.
026000 01  Ｍ０１−頭金区分               PIC  X(1).
026100 01  Ｍ０１−コンスーマ法人区分     PIC  X(1).
026200 01  Ｍ０１−申請連番               PIC S9(4) COMP-3.
026300 01  Ｍ０１−未収残高対象外フラグ   PIC  X(1).
026400 01  Ｍ０１−前月状態フラグ         PIC  X(1).
026500 01  Ｍ０１−入金回数               PIC S9(3) COMP-3.
026600 01  Ｍ０１−実現回数               PIC S9(3) COMP-3.
026700 01  Ｍ０１−当月遡及分増加自売上年月２ PIC  X(6).
026800 01  Ｍ０１−当月遡及分増加至売上年月２ PIC  X(6).
026900 01  Ｍ０１−当月遡及分減少自売上年月２ PIC  X(6).
027000 01  Ｍ０１−当月遡及分減少至売上年月２ PIC  X(6).
027100 01  Ｍ０１−初回回収予定日         PIC  X(8).
027200 01  Ｍ０１−前月迄元本収入予定額累計 PIC S9(13) COMP-3.
027300 01  Ｍ０１−前月迄利息収入予定額累計 PIC S9(13) COMP-3.
027400 01  Ｍ０１−最新対外契約番号       PIC  X(15).
027500 01  Ｍ０１−割賦頭金               PIC S9(13) COMP-3.
027600 01  Ｍ０１−割賦頭金他社           PIC S9(13) COMP-3.
027700 01  Ｍ０１−割賦頭金消費税         PIC S9(13) COMP-3.
027800 01  Ｍ０１−割賦頭金消費税他社     PIC S9(13) COMP-3.
027900 01  Ｍ０１−前月他社最新契約総額   PIC S9(13) COMP-3.
028000 01  Ｍ０１−前月他社最新消費税総額 PIC S9(13) COMP-3.
028100 01  Ｍ０１−前期末元本残高他社     PIC S9(13) COMP-3.
028200 01  Ｍ０１−前期末利息残高他社     PIC S9(13) COMP-3.
028300 01  Ｍ０１−前月迄元本回収額累計他社 PIC S9(13) COMP-3.
028400 01  Ｍ０１−前月迄利息回収額累計他社 PIC S9(13) COMP-3.
028500 01  Ｍ０１−前月末元本残高他社     PIC S9(13) COMP-3.
028600 01  Ｍ０１−前月末利息残高他社     PIC S9(13) COMP-3.
028700 01  Ｍ０１−新規増加分元本額他社   PIC S9(13) COMP-3.
028800 01  Ｍ０１−新規増加分利息額他社   PIC S9(13) COMP-3.
028900 01  Ｍ０１−当月元本入金額他社     PIC S9(13) COMP-3.
029000 01  Ｍ０１−当月利息入金額他社     PIC S9(13) COMP-3.
029100 01  Ｍ０１−当月末元本残高他社     PIC S9(13) COMP-3.
029200 01  Ｍ０１−当月末利息残高他社     PIC S9(13) COMP-3.
029300 01  Ｍ０１−当月迄元本収入予定額累計他社 PIC S9(13) COMP-3.
029400 01  Ｍ０１−当月迄利息収入予定額累計他社 PIC S9(13) COMP-3.
029500 01  Ｍ０１−当月回収予定額他社     PIC S9(13) COMP-3.
029600 01  Ｍ０１−元本未経過リース料他社 PIC S9(13) COMP-3.
029700 01  Ｍ０１−利息未経過リース料他社 PIC S9(13) COMP-3.
029800 01  Ｍ０１−元本未収リース料他社   PIC S9(13) COMP-3.
029900 01  Ｍ０１−利息未収リース料他社   PIC S9(13) COMP-3.
030000 01  Ｍ０１−当月前受リース料入金額他社 PIC S9(13) COMP-3.
030100 01  Ｍ０１−当月迄前受リース料入金額他社 PIC S9(13) COMP-3.
030200 01  Ｍ０１−元本前受金他社         PIC S9(13) COMP-3.
030300 01  Ｍ０１−利息前受金他社         PIC S9(13) COMP-3.
030400 01  Ｍ０１−検収エントリ日         PIC  X(8).
030500 01  Ｍ０１−前月売上総額再リース   PIC S9(13) COMP-3.
030600 01  Ｍ０１−売上総額再リース       PIC S9(13) COMP-3.
030700 01  Ｍ０１−前期迄売上額累計再リース PIC S9(13) COMP-3.
030800 01  Ｍ０１−当月売上額再リース     PIC S9(13) COMP-3.
030900 01  Ｍ０１−当月迄売上額累計再リース PIC S9(13) COMP-3.
031000 01  Ｍ０１−当期売上額累計再リース PIC S9(13) COMP-3.
031100 01  Ｍ０１−当月遡及分売上増加額再リース PIC S9(13) COMP-3.
031200 01  Ｍ０１−当月遡及分売上減少額再リース PIC S9(13) COMP-3.
031300 01  Ｍ０１−前月迄売上額累計再リース PIC S9(13) COMP-3.
031400 01  Ｍ０１−今回再リース料金区分   PIC  X(1).
031500 01  Ｍ０１−当月末未実現残高再リース PIC S9(13) COMP-3.
031600 01  Ｍ０１−前期末未実現残高再リース PIC S9(13) COMP-3.
031700 01  Ｍ０１−前月債権消費税総額     PIC S9(13) COMP-3.
031800 01  Ｍ０１−当月前受リース料消化額他社 PIC S9(13) COMP-3.
031900 01  Ｍ０１−当月前受金消化額他社   PIC S9(13) COMP-3.
032000 01  Ｍ０１−当月末前受リース料残高他社 PIC S9(13) COMP-3.
032100 01  Ｍ０１−貸倒損失額利息相当額   PIC S9(13) COMP-3.
032200 01  Ｍ０１−経理用主契約区分       PIC  X(1).
032300 01  Ｍ０１−違約金分割回収売上額   PIC S9(13) COMP-3.
032400 01  Ｍ０１−違約金分割回収売上額消費税 PIC S9(13) COMP-3.
032500 01  Ｍ０１−検収取消エントリ日     PIC  X(8).
032600 01  Ｍ０１−当月前受金入金額       PIC S9(13) COMP-3.
032700 01  Ｍ０１−当月前受金入金額他社   PIC S9(13) COMP-3.
032800 01  Ｍ０１−当月末前受金残高       PIC S9(13) COMP-3.
032900 01  Ｍ０１−当月末前受金残高他社   PIC S9(13) COMP-3.
033000 01  Ｍ０１−検収エントリ処理年月   PIC  X(6).
033100 01  Ｍ０１−台帳−当月入金回収額     PIC S9(13) COMP-3.
033200 01  Ｍ０１−台帳−当月入金回収額他社 PIC S9(13) COMP-3.
033300 01  Ｍ０１−台帳−当月入金前受額     PIC S9(13) COMP-3.
033400 01  Ｍ０１−台帳−当月入金前受額他社 PIC S9(13) COMP-3.
033500 01  Ｍ０１−担保区分               PIC  X(1).
033600 01  Ｍ０１−頭金回収サイト         PIC S9(02) COMP-3.
033700 01  Ｍ０１−頭金計上年月日         PIC  X(8).
033800 01  Ｍ０１−契約内容−解約処理年月 PIC  X(6).
033900 01  Ｍ０１−債権−解約処理年月     PIC  X(6).
034000 01  Ｍ０１−解約履歴−貸倒損失額   PIC  S9(13) COMP-3.
034100 01  Ｍ０１−解約履歴−貸倒損失額利益相当額 PIC S9(13) COMP-3.
034200 01  Ｍ０１−割賦頭金消費税率       PIC S9(2)V9(7) COMP-3.
001010     
      *    EXEC  SQL  END  DECLARE          SECTION  END-EXEC.
001020*                                                                 
001030*----------------------------------------------------------------*
001040*    ＷＯＲＫエリア                                              *
001050*----------------------------------------------------------------
001060 01  ＷＯＲＫ−エリア.                                            
001070*--< エラー判定用 >                                               
001080     03  Ｗ−エラーコード             PIC S9(04).                 
001090*                                                                 
001100*--< 件数エリア >                                                 
001110     03  件数エリア.                                              
001120         05  Ｗ−入力−件数           PIC  9(09).                 
001130         05  Ｗ−出力−件数           PIC  9(09).                 
001140*                                                                 
001150*--< フラグアリア >                                               
001160     03  フラグアリア.                                            
001170         05  Ｗ−終了−フラグ         PIC  X(01).                 
001180         05  Ｗ−異常終了−フラグ     PIC  X(01).                 
001190*                                                                 
001200*--< ファイル状態 >                                               
001210     03  Ｗ−ファイル状態             PIC  X(02).                 
001220*                                                                 
001230*--< 区分名称エリア >                                             
001240     03  区分名称エリア.                                          
001250         05  Ｗ−主契約区分名称       PIC  X(60).                 
001260         05  Ｗ−顧客区分名称         PIC  X(60).                 
001270*                                                                 
001280*----------------------------------------------------------------*
001290*    サブルーチン名                                              *
001300*----------------------------------------------------------------*
001310 01  CALL-AREA.                                                   
001320*--< 共通ログサブルーチン >                                       
001330     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001340     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001350*                                                                 
001360*----------------------------------------------------------------*
001370*    ＣＯＰＹ領域                                                *
001380*----------------------------------------------------------------*
001390*--< 共通ログ用パラメータ >                                       
001400 01  IF-CHOCO001.                                                 
001410     COPY  CHOCO001  REPLACING  ==()==  BY  ==共１−==.           
001420*                                                                 
001430*----------------------------------------------------------------*
001440*    ＩＮＩファイル読込サブルーチン用パラメタ領域                *
001450*----------------------------------------------------------------*
001460 01  PARA-AREA.                                                   
001470     COPY CPBCO001.                                               
001480*                                                                 
001490*----------------------------------------------------------------*
001500*    レコード初期化領域                                          *
001510*----------------------------------------------------------------*
001520 01  初期化レコード.                                              
001530     COPY  CPSCE50   REPLACING  ==()==  BY  ==初期化−==.         
001540*                                                                 
001550*----------------------------------------------------------------*
001560*    定数用データ定義エリア                                      *
001570*----------------------------------------------------------------*
001580 CONSTANT                             SECTION.                    
001590 01  定数領域.                                                    
001600     03  定数−プログラムＩＤ         PIC  X(08) VALUE "AAASED25".
001610     03  定数−プログラム名           PIC  X(80)                  
001620                              VALUE  "前受金受払残高ファイル作成".
001630     03  定数−ＳＱＬＯＫ             PIC S9(04)  VALUE  ZERO.    
001640     03  定数−ＳＱＬＥＮＤ           PIC S9(04)  VALUE  0100.    
001650     03  定数−正常状態               PIC S9(04)  VALUE  ZERO.    
001660     03  定数−異常状態               PIC S9(04)  VALUE  0009.    
001670*                                                                 
001680******************************************************************
001690*    ＰＲＯＣＥＤＵＲＥ            ＤＩＶＩＳＩＯＮ              *
001700******************************************************************
001710 PROCEDURE                            DIVISION.                   
001720*                                                                 
001730     PERFORM  初期処理.                                           
001740*                                                                 
001750     PERFORM  主処理  UNTIL  Ｗ−終了−フラグ  =  "Y".            
001760*                                                                 
001770     PERFORM  終了処理.                                           
001780*                                                                 
001790     STOP     RUN.                                                
001800*                                                                 
001810******************************************************************
001820*    初期処理                                                    *
001830******************************************************************
001840 初期処理                             SECTION.                    
001850 初期処理−ＳＴＡＲＴ.                                            
001860*                                                                 
001870*--< 開始メッセージ出力 >                                         
001880     PERFORM   開始メッセージ出力.                                
001890*                                                                 
001900*--< 作業領域の初期値処理 >                                       
001910     PERFORM   作業領域の初期値処理.                              
001920*                                                                 
001930*--< ＯＲＡＣＬＥ接続 >                                           
001940     PERFORM   ＯＲＡＣＬＥ接続.                                  
001950*                                                                 
001960*--< 業務管理テーブル読込 >                                       
001970     PERFORM  業務管理テーブル読込.                               
001980*                                                                 
001990*--< 結合テーブルカーソル定義 >                                   
002000     PERFORM  結合テーブルカーソル定義.                           
002010*                                                                 
002020*--< ファイルオープン >                                           
002030     PERFORM  ファイルオープン.                                   
002040*                                                                 
002050*--< 結合テーブル読込（１件目）>                                  
002060     PERFORM  結合テーブル読込.                                   
002070*                                                                 
002080 初期処理−ＥＸＩＴ.                                              
002090     EXIT.                                                        
002100*                                                                 
002110******************************************************************
002120*    開始メッセージ出力                                          *
002130******************************************************************
002140 開始メッセージ出力                   SECTION.                    
002150 開始メッセージ出力−ＳＴＡＲＴ.                                  
002160*                                                                 
002170     INITIALIZE                       IF-CHOCO001.                
002180     MOVE  "3"                        TO  共１−イベント種別.     
002190     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
002200     MOVE  "0"                        TO  共１−復帰コード.       
002210     MOVE  "START"                    TO  共１−処理識別.         
002220     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
002230     CALL  CLOCO001                USING  IF-CHOCO001.            
002240*                                                                 
002250 開始メッセージ出力−ＥＸＩＴ.                                    
002260     EXIT.                                                        
002270*                                                                 
002280******************************************************************
002290*    作業領域の初期値処理                                        *
002300******************************************************************
002310 作業領域の初期値処理                 SECTION.                    
002320 作業領域の初期値処理−ＳＴＡＲＴ.                                
002330*                                                                 
002340     MOVE  SPACE                      TO  ＷＯＲＫ−エリア.       
002350     INITIALIZE                           ＷＯＲＫ−エリア.       
002360*                                                                 
002370     MOVE  SPACE                      TO  初期化レコード.         
002380     INITIALIZE                           初期化レコード.         
002390*                                                                 
002400 作業領域の初期値処理−ＥＸＩＴ.                                  
002410     EXIT.                                                        
002420*                                                                 
002430******************************************************************
002440*    ＯＲＡＣＬＥ接続                                            *
002450******************************************************************
002460 ＯＲＡＣＬＥ接続                     SECTION.                    
002470 ＯＲＡＣＬＥ接続−ＳＴＡＲＴ.                                    
002480*                                                                 
002490*--< ＤＢ接続用情報を取得処理 >                                   
002500     CALL  COBCO001                USING  PARA-AREA.              
002510*                                                                 
002520     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002530     MOVE  PARA-USERNAME              TO  USERNAME.               
002540     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002550*                                                                 
002560*--< 開始接続 >                                                   
002570     IF    DB-STRING  =  SPACE                                    
002580        
      *       EXEC SQL                                                  
002590*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002600*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002610     ELSE                                                         
002620        
      *       EXEC SQL                                                  
002630*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002640*            USING  :DB-STRING                                    
002650*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002660     END-IF.                                                      
002670*                                                                 
002680*--< 接続確認 >                                                   
002690     EVALUATE  SQLCODE                                            
002700        WHEN  定数−ＳＱＬＯＫ                                    
002710*--<       接続正常 >                                             
002720           CONTINUE                                               
002730        WHEN  OTHER                                               
002740*--<       接続エラー >                                           
002750           MOVE  -10                  TO  Ｗ−エラーコード        
002760           PERFORM  エラー判定処理                                
002770     END-EVALUATE.                                                
002780*                                                                 
002790 ＯＲＡＣＬＥ接続−ＥＸＩＴ.                                      
002800     EXIT.                                                        
002810*                                                                 
002820******************************************************************
002830*    業務管理テーブル読込                                        *
002840******************************************************************
002850 業務管理テーブル読込                 SECTION.                    
002860 業務管理テーブル読込−ＳＴＡＲＴ.                                
002870*                                                                 
002880*--< 業務管理テーブル読込 >                                       
002890     
      *    EXEC SQL                                                     
002900*       SELECT   バッチ用業務年月                                 
002910*         INTO   :Ｄ７０−バッチ用業務年月                        
002920*         FROM   D70GYM_TBL                                       
002930*        WHERE   業務管理ＩＤ  =  :ＷＳ−業務管理ＩＤ             
002940*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               Ｄ７０−バッチ用業務年月
               SQL-SQHSTV(1)
           MOVE 6 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ＷＳ−業務管理ＩＤ
               SQL-SQHSTV(2)
           MOVE 8 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
002950*                                                                 
002960*--< 業務管理テーブル読込を確認 >                                 
002970     EVALUATE   SQLCODE                                           
002980        WHEN  定数−ＳＱＬＯＫ                                    
002990*--<       読込正常 >                                             
003000           DISPLAY "業務年月  =  " Ｄ７０−バッチ用業務年月       
003010        WHEN  OTHER                                               
003020*--<       読込エラー >                                           
003030           MOVE  -20                  TO  Ｗ−エラーコード        
003040           PERFORM  エラー判定処理                                
003050     END-EVALUATE.                                                
003060*                                                                 
003070 業務管理テーブル読込−ＥＸＩＴ.                                  
003080     EXIT.                                                        
003090*                                                                 
003100******************************************************************
003110*    結合テーブルカーソル定義                                    *
003120******************************************************************
003130 結合テーブルカーソル定義             SECTION.                    
003140 結合テーブルカーソル定義−ＳＴＡＲＴ.                            
003150*                                                                 
003160*--< カーソル定義 >                                               
003170     
      *    EXEC SQL                                                     
003180*       DECLARE CUR1  CURSOR FOR                                  
003190*          SELECT  M40MAB_TBL.レコード区分                        
003200*                 ,M40MAB_TBL.経理用主契約区分                    
003210*                 ,M40MAB_TBL.顧客区分                            
003220*                 ,NVL(D01TRS_TBL.名寄せコード,RPAD(' ',40,' '))  
003230*                 ,M40MAB_TBL.請求先取引先コード                  
003240*                 ,M40MAB_TBL.請求先コード                        
003250*                 ,M40MAB_TBL.契約番号                            
003260*                 ,M40MAB_TBL.契約種類                            
003270*                 ,M40MAB_TBL.担当部課コード                      
003280*                 ,M40MAB_TBL.再リース回数                        
003290*                 ,M40MAB_TBL.充当開始年月                        
003300*                 ,M40MAB_TBL.充当月数                            
003310*                 ,M40MAB_TBL.前払回収方法                        
003320*                 ,M40MAB_TBL.入金日                              
003330*                 ,M40MAB_TBL.入金区分                            
003340*                 ,NVL(D01TRS_TBL.取引先名称,RPAD(' ',80,' '))    
003350*                 ,NVL(D02SQS_TBL.請求先名称,RPAD(' ',80,' '))    
003360*                 ,M40MAB_TBL.前月末残高                          
003370*                 ,M40MAB_TBL.当月回収額                          
003380*                 ,M40MAB_TBL.当月消化額                          
003390*                 ,M40MAB_TBL.前月末残高他社                      
003400*                 ,M40MAB_TBL.当月消化額他社                      
003410*                 ,M40MAB_TBL.当月他社解約分料金                  
003420*                 ,M40MAB_TBL.当月他社解約分消費税                
003430*                 ,M40MAB_TBL.当月末残高他社                      
003440*                 ,M40MAB_TBL.協調区分                            
003450*                 ,M40MAB_TBL.当月末残高                          
003460*                 ,M40MAB_TBL.当月回収額他社                      
003470*                 ,M40MAB_TBL.仮受金入金日                        
003480*                 ,M40MAB_TBL.仮受金ＳＥＱ＿ＮＯ                  
003490*            FROM  M40MAB_TBL                                     
003500*                 ,D01TRS_TBL                                     
003510*                 ,D02SQS_TBL                                     
003520*           WHERE  M40MAB_TBL.前受金受払残高表対象フラグ =  '1'   
003530*             AND  M40MAB_TBL.請求先取引先コード =                
003540*                                   D01TRS_TBL.取引先コード (+)   
003550*             AND  M40MAB_TBL.請求先取引先コード =                
003560*                                   D02SQS_TBL.取引先コード (+)   
003570*             AND  M40MAB_TBL.請求先コード       =                
003580*                                   D02SQS_TBL.請求先コード (+)   
003590*        ORDER BY  M40MAB_TBL.レコード区分                        
003600*                 ,M40MAB_TBL.契約番号                            
003610*    END-EXEC.
003620*                                                                 
003630*--< カーソルＯＰＥＮ処理 >                                       
003640     
      *    EXEC  SQL                                                    
003650*       OPEN  CUR1                                                
003660*    END-EXEC.
           CALL "SQLADR" USING SQ0002 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 90 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
003670*                                                                 
003680*--< カーソルＯＰＥＮ確認 >                                       
003690     EVALUATE  SQLCODE                                            
003700        WHEN  定数−ＳＱＬＯＫ                                    
003710*--<       カーソルＯＰＥＮ正常 >                                 
003720           CONTINUE                                               
003730        WHEN  OTHER                                               
003740*--<       カーソルＯＰＥＮエラー >                               
003750           MOVE  -30                  TO  Ｗ−エラーコード        
003760           PERFORM  エラー判定処理                                
003770     END-EVALUATE.                                                
003780*                                                                 
003790 結合テーブルカーソル定義−ＥＸＩＴ.                              
003800     EXIT.                                                        
003810*                                                                 
003820******************************************************************
003830*    ファイルオープン                                            *
003840******************************************************************
003850 ファイルオープン                     SECTION.                    
003860 ファイルオープン−ＳＴＡＲＴ.                                    
003870*                                                                 
003880*--< ファイルオープン ＯＰＥＮ >                                  
003890     OPEN  OUTPUT  出力ファイル.                                  
003900*                                                                 
003910*--< ファイルオープン状態判定 >                                   
003920     EVALUATE  Ｗ−ファイル状態                                   
003930        WHEN  ZERO                                                
003940*--<       ファイルオープン正常 >                                 
003950           CONTINUE                                               
003960        WHEN  OTHER                                               
003970*--<       ファイルオープンエラー >                               
003980           MOVE  -5                   TO  Ｗ−エラーコード        
003990           PERFORM  エラー判定処理                                
004000     END-EVALUATE.                                                
004010*                                                                 
004020 ファイルオープン−ＥＸＩＴ.                                      
004030     EXIT.                                                        
004040*                                                                 
004050******************************************************************
004060*    結合テーブルカーソル読込                                    *
004070******************************************************************
004080 結合テーブル読込                     SECTION.                    
004090 結合テーブル読込−ＳＴＡＲＴ.                                    
004100*                                                                 
004110*--< 結合テーブルカーソル読込 >                                   
004120     
      *    EXEC SQL                                                     
004130*        FETCH  CUR1                                              
004140*         INTO   :Ｍ４０−レコード区分                            
004150*               ,:Ｍ４０−経理用主契約区分                        
004160*               ,:Ｍ４０−顧客区分                                
004170*               ,:Ｄ０１−名寄せコード                            
004180*               ,:Ｍ４０−請求先取引先コード                      
004190*               ,:Ｍ４０−請求先コード                            
004200*               ,:Ｍ４０−契約番号                                
004210*               ,:Ｍ４０−契約種類                                
004220*               ,:Ｍ４０−担当部課コード                          
004230*               ,:Ｍ４０−再リース回数                            
004240*               ,:Ｍ４０−充当開始年月                            
004250*               ,:Ｍ４０−充当月数                                
004260*               ,:Ｍ４０−前払回収方法                            
004270*               ,:Ｍ４０−入金日                                  
004280*               ,:Ｍ４０−入金区分                                
004290*               ,:Ｄ０１−取引先名称                              
004300*               ,:Ｄ０２−請求先名称                              
004310*               ,:Ｍ４０−前月末残高                              
004320*               ,:Ｍ４０−当月回収額                              
004330*               ,:Ｍ４０−当月消化額                              
004340*               ,:Ｍ４０−前月末残高他社                          
004350*               ,:Ｍ４０−当月消化額他社                          
004360*               ,:Ｍ４０−当月他社解約分料金                      
004370*               ,:Ｍ４０−当月他社解約分消費税                    
004380*               ,:Ｍ４０−当月末残高他社                          
004390*               ,:Ｍ４０−協調区分                                
004400*               ,:Ｍ４０−当月末残高                              
004410*               ,:Ｍ４０−当月回収額他社                          
004420*               ,:Ｍ４０−仮受金入金日                            
004430*               ,:Ｍ４０−仮受金ＳＥＱ−ＮＯ                      
004440*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 105 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               Ｍ４０−レコード区分
               SQL-SQHSTV(1)
           MOVE 1 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               Ｍ４０−経理用主契約区分
               SQL-SQHSTV(2)
           MOVE 1 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               Ｍ４０−顧客区分
               SQL-SQHSTV(3)
           MOVE 2 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               Ｄ０１−名寄せコード IN
               取引先マスタ
               SQL-SQHSTV(4)
           MOVE 40 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               Ｍ４０−請求先取引先コード
               SQL-SQHSTV(5)
           MOVE 9 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               Ｍ４０−請求先コード
               SQL-SQHSTV(6)
           MOVE 5 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               Ｍ４０−契約番号
               SQL-SQHSTV(7)
           MOVE 15 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               Ｍ４０−契約種類
               SQL-SQHSTV(8)
           MOVE 3 TO SQL-SQHSTL(8)
           MOVE 0 TO SQL-SQHSTS(8)
           MOVE 0 TO SQL-SQINDV(8)
           MOVE 0 TO SQL-SQINDS(8)
           MOVE 0 TO SQL-SQHARM(8)
           CALL "SQLADR" USING
               Ｍ４０−担当部課コード
               SQL-SQHSTV(9)
           MOVE 4 TO SQL-SQHSTL(9)
           MOVE 0 TO SQL-SQHSTS(9)
           MOVE 0 TO SQL-SQINDV(9)
           MOVE 0 TO SQL-SQINDS(9)
           MOVE 0 TO SQL-SQHARM(9)
           CALL "SQLADR" USING
               Ｍ４０−再リース回数
               SQL-SQHSTV(10)
           MOVE 2 TO SQL-SQHSTL(10)
           MOVE 0 TO SQL-SQHSTS(10)
           MOVE 0 TO SQL-SQINDV(10)
           MOVE 0 TO SQL-SQINDS(10)
           MOVE 0 TO SQL-SQHARM(10)
           CALL "SQLADR" USING
               Ｍ４０−充当開始年月
               SQL-SQHSTV(11)
           MOVE 6 TO SQL-SQHSTL(11)
           MOVE 0 TO SQL-SQHSTS(11)
           MOVE 0 TO SQL-SQINDV(11)
           MOVE 0 TO SQL-SQINDS(11)
           MOVE 0 TO SQL-SQHARM(11)
           CALL "SQLADR" USING
               Ｍ４０−充当月数
               SQL-SQHSTV(12)
           MOVE 2 TO SQL-SQHSTL(12)
           MOVE 0 TO SQL-SQHSTS(12)
           MOVE 0 TO SQL-SQINDV(12)
           MOVE 0 TO SQL-SQINDS(12)
           MOVE 0 TO SQL-SQHARM(12)
           CALL "SQLADR" USING
               Ｍ４０−前払回収方法
               SQL-SQHSTV(13)
           MOVE 1 TO SQL-SQHSTL(13)
           MOVE 0 TO SQL-SQHSTS(13)
           MOVE 0 TO SQL-SQINDV(13)
           MOVE 0 TO SQL-SQINDS(13)
           MOVE 0 TO SQL-SQHARM(13)
           CALL "SQLADR" USING
               Ｍ４０−入金日
               SQL-SQHSTV(14)
           MOVE 8 TO SQL-SQHSTL(14)
           MOVE 0 TO SQL-SQHSTS(14)
           MOVE 0 TO SQL-SQINDV(14)
           MOVE 0 TO SQL-SQINDS(14)
           MOVE 0 TO SQL-SQHARM(14)
           CALL "SQLADR" USING
               Ｍ４０−入金区分
               SQL-SQHSTV(15)
           MOVE 2 TO SQL-SQHSTL(15)
           MOVE 0 TO SQL-SQHSTS(15)
           MOVE 0 TO SQL-SQINDV(15)
           MOVE 0 TO SQL-SQINDS(15)
           MOVE 0 TO SQL-SQHARM(15)
           CALL "SQLADR" USING
               Ｄ０１−取引先名称 IN
               取引先マスタ
               SQL-SQHSTV(16)
           MOVE 80 TO SQL-SQHSTL(16)
           MOVE 0 TO SQL-SQHSTS(16)
           MOVE 0 TO SQL-SQINDV(16)
           MOVE 0 TO SQL-SQINDS(16)
           MOVE 0 TO SQL-SQHARM(16)
           CALL "SQLADR" USING
               Ｄ０２−請求先名称 IN
               請求先マスタ
               SQL-SQHSTV(17)
           MOVE 80 TO SQL-SQHSTL(17)
           MOVE 0 TO SQL-SQHSTS(17)
           MOVE 0 TO SQL-SQINDV(17)
           MOVE 0 TO SQL-SQINDS(17)
           MOVE 0 TO SQL-SQHARM(17)
           CALL "SQLADR" USING
               Ｍ４０−前月末残高
               SQL-SQHSTV(18)
           MOVE 7 TO SQL-SQHSTL(18)
           MOVE 0 TO SQL-SQHSTS(18)
           MOVE 0 TO SQL-SQINDV(18)
           MOVE 0 TO SQL-SQINDS(18)
           MOVE 0 TO SQL-SQHARM(18)
           CALL "SQLADR" USING
               Ｍ４０−当月回収額
               SQL-SQHSTV(19)
           MOVE 7 TO SQL-SQHSTL(19)
           MOVE 0 TO SQL-SQHSTS(19)
           MOVE 0 TO SQL-SQINDV(19)
           MOVE 0 TO SQL-SQINDS(19)
           MOVE 0 TO SQL-SQHARM(19)
           CALL "SQLADR" USING
               Ｍ４０−当月消化額
               SQL-SQHSTV(20)
           MOVE 7 TO SQL-SQHSTL(20)
           MOVE 0 TO SQL-SQHSTS(20)
           MOVE 0 TO SQL-SQINDV(20)
           MOVE 0 TO SQL-SQINDS(20)
           MOVE 0 TO SQL-SQHARM(20)
           CALL "SQLADR" USING
               Ｍ４０−前月末残高他社
               SQL-SQHSTV(21)
           MOVE 7 TO SQL-SQHSTL(21)
           MOVE 0 TO SQL-SQHSTS(21)
           MOVE 0 TO SQL-SQINDV(21)
           MOVE 0 TO SQL-SQINDS(21)
           MOVE 0 TO SQL-SQHARM(21)
           CALL "SQLADR" USING
               Ｍ４０−当月消化額他社
               SQL-SQHSTV(22)
           MOVE 7 TO SQL-SQHSTL(22)
           MOVE 0 TO SQL-SQHSTS(22)
           MOVE 0 TO SQL-SQINDV(22)
           MOVE 0 TO SQL-SQINDS(22)
           MOVE 0 TO SQL-SQHARM(22)
           CALL "SQLADR" USING
               Ｍ４０−当月他社解約分料金
               SQL-SQHSTV(23)
           MOVE 7 TO SQL-SQHSTL(23)
           MOVE 0 TO SQL-SQHSTS(23)
           MOVE 0 TO SQL-SQINDV(23)
           MOVE 0 TO SQL-SQINDS(23)
           MOVE 0 TO SQL-SQHARM(23)
           CALL "SQLADR" USING
               Ｍ４０−当月他社解約分消費税
               SQL-SQHSTV(24)
           MOVE 7 TO SQL-SQHSTL(24)
           MOVE 0 TO SQL-SQHSTS(24)
           MOVE 0 TO SQL-SQINDV(24)
           MOVE 0 TO SQL-SQINDS(24)
           MOVE 0 TO SQL-SQHARM(24)
           CALL "SQLADR" USING
               Ｍ４０−当月末残高他社
               SQL-SQHSTV(25)
           MOVE 7 TO SQL-SQHSTL(25)
           MOVE 0 TO SQL-SQHSTS(25)
           MOVE 0 TO SQL-SQINDV(25)
           MOVE 0 TO SQL-SQINDS(25)
           MOVE 0 TO SQL-SQHARM(25)
           CALL "SQLADR" USING
               Ｍ４０−協調区分
               SQL-SQHSTV(26)
           MOVE 1 TO SQL-SQHSTL(26)
           MOVE 0 TO SQL-SQHSTS(26)
           MOVE 0 TO SQL-SQINDV(26)
           MOVE 0 TO SQL-SQINDS(26)
           MOVE 0 TO SQL-SQHARM(26)
           CALL "SQLADR" USING
               Ｍ４０−当月末残高
               SQL-SQHSTV(27)
           MOVE 7 TO SQL-SQHSTL(27)
           MOVE 0 TO SQL-SQHSTS(27)
           MOVE 0 TO SQL-SQINDV(27)
           MOVE 0 TO SQL-SQINDS(27)
           MOVE 0 TO SQL-SQHARM(27)
           CALL "SQLADR" USING
               Ｍ４０−当月回収額他社
               SQL-SQHSTV(28)
           MOVE 7 TO SQL-SQHSTL(28)
           MOVE 0 TO SQL-SQHSTS(28)
           MOVE 0 TO SQL-SQINDV(28)
           MOVE 0 TO SQL-SQINDS(28)
           MOVE 0 TO SQL-SQHARM(28)
           CALL "SQLADR" USING
               Ｍ４０−仮受金入金日
               SQL-SQHSTV(29)
           MOVE 8 TO SQL-SQHSTL(29)
           MOVE 0 TO SQL-SQHSTS(29)
           MOVE 0 TO SQL-SQINDV(29)
           MOVE 0 TO SQL-SQINDS(29)
           MOVE 0 TO SQL-SQHARM(29)
           CALL "SQLADR" USING
               Ｍ４０−仮受金ＳＥＱ−ＮＯ
               SQL-SQHSTV(30)
           MOVE 4 TO SQL-SQHSTL(30)
           MOVE 0 TO SQL-SQHSTS(30)
           MOVE 0 TO SQL-SQINDV(30)
           MOVE 0 TO SQL-SQINDS(30)
           MOVE 0 TO SQL-SQHARM(30)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004450*                                                                 
004460*--< 結合テーブル読込を確認 >                                     
004470     EVALUATE   SQLCODE                                           
004480        WHEN  定数−ＳＱＬＯＫ                                    
004490*--<       読込正常 >                                             
004500           COMPUTE  Ｗ−入力−件数  =  Ｗ−入力−件数  +  1       
004510        WHEN  定数−ＳＱＬＥＮＤ                                  
004520*--<       読込終了 >                                             
004530           MOVE  "Y"                  TO  Ｗ−終了−フラグ        
004540        WHEN  OTHER                                               
004550*--<       読込エラー >                                           
004560           MOVE  -40                  TO  Ｗ−エラーコード        
004570           PERFORM  エラー判定処理                                
004580     END-EVALUATE.                                                
004590*                                                                 
004600 結合テーブル読込−ＥＸＩＴ.                                      
004610     EXIT.                                                        
004620*                                                                 
004630******************************************************************
004640*    主処理                                                      *
004650******************************************************************
004660 主処理                               SECTION.                    
004670 主処理−ＳＴＡＲＴ.                                              
004680*                                                                 
004690*--< 項目名称マスタより項目の抽出処理 >                           
004700     PERFORM  項目名称マスタより項目の抽出処理.                   
004710*                                                                 
004720*--< 債権情報（一般）ＤＢより項目の抽出処理 >                     
004730     PERFORM  債権情報ＤＢより項目の抽出処理.                     
004740*                                                                 
004750*--< 前受金受払残高中間ファイル出力判定処理 >                     
004760     IF  Ｍ０１−担保区分  =  "1"                                 
004770        CONTINUE                                                  
004780     ELSE                                                         
004790*--<    前受金受払残高中間ファイル項目編集、出力処理 >            
004800        PERFORM  前受金項目編集出力処理                           
004810     END-IF.                                                      
004820*                                                                 
004830*--< 結合テーブル読込（２件目以降） >                             
004840     PERFORM  結合テーブル読込.                                   
004850*                                                                 
004860 主処理−ＥＸＩＴ.                                                
004870     EXIT.                                                        
004880*                                                                 
004890******************************************************************
004900*    項目名称マスタより項目の抽出処理                            *
004910******************************************************************
004920 項目名称マスタより項目の抽出処理     SECTION.                    
004930 項目名称マスタより項目の抽出処理−ＳＴＡＲＴ.                    
004940*                                                                 
004950*----------------------------------------------------------------*
004960*    項目名称マスタより主契約区分名称の抽出処理                  *
004970*----------------------------------------------------------------*
004980*--< 主契約区分名称取得 >                                         
004990     
      *    EXEC SQL                                                     
005000*       SELECT  名称                                              
005010*         INTO  :Ｄ１９−名称                                     
005020*         FROM  D19MSY_TBL                                        
005030*        WHERE  コードＮＯ            = :ＷＳ−主契約区分名称     
005040*          AND  SUBSTR(コード,1,1)    = :Ｍ４０−経理用主契約区分 
005050*    END-EXEC.
           CALL "SQLADR" USING SQ0003 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 240 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               Ｄ１９−名称 IN
               項目名称マスタ
               SQL-SQHSTV(1)
           MOVE 60 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ＷＳ−主契約区分名称
               SQL-SQHSTV(2)
           MOVE 12 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               Ｍ４０−経理用主契約区分
               SQL-SQHSTV(3)
           MOVE 1 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005060*                                                                 
005070*--< 主契約区分名称取得を確認 >                                   
005080     EVALUATE  SQLCODE                                            
005090        WHEN  定数−ＳＱＬＯＫ                                    
005100*--<       取得正常 >                                             
005110           MOVE Ｄ１９−名称          TO  Ｗ−主契約区分名称      
005120        WHEN  OTHER                                               
005130*--<       取得エラー >                                           
005140           MOVE  SPACE                TO  Ｗ−主契約区分名称      
005150           MOVE  -50                  TO  Ｗ−エラーコード        
005160     END-EVALUATE.                                                
005170*                                                                 
005180*----------------------------------------------------------------*
005190*    項目名称マスタより顧客区分名称の抽出処理                    *
005200*----------------------------------------------------------------*
005210*--< 顧客区分名称取得 >                                           
005220     
      *    EXEC SQL                                                     
005230*       SELECT  名称                                              
005240*         INTO  :Ｄ１９−名称                                     
005250*         FROM  D19MSY_TBL                                        
005260*        WHERE  コードＮＯ            =  :ＷＳ−顧客区分名称      
005270*          AND  SUBSTR(コード,1,2)    =  :Ｍ４０−顧客区分        
005280*    END-EXEC.
           CALL "SQLADR" USING SQ0004 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 267 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               Ｄ１９−名称 IN
               項目名称マスタ
               SQL-SQHSTV(1)
           MOVE 60 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ＷＳ−顧客区分名称
               SQL-SQHSTV(2)
           MOVE 3 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               Ｍ４０−顧客区分
               SQL-SQHSTV(3)
           MOVE 2 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005290*                                                                 
005300*--< 顧客区分名称取得を確認 >                                     
005310     EVALUATE  SQLCODE                                            
005320        WHEN  定数−ＳＱＬＯＫ                                    
005330*--<       取得正常 >                                             
005340           MOVE Ｄ１９−名称          TO  Ｗ−顧客区分名称        
005350        WHEN  OTHER                                               
005360*--<       取得エラー >                                           
005370           MOVE  SPACE                TO  Ｗ−顧客区分名称        
005380           MOVE  -70                  TO  Ｗ−エラーコード        
005390           PERFORM  エラー判定処理                                
005400     END-EVALUATE.                                                
005410*                                                                 
005420 項目名称マスタより項目の抽出処理−ＥＸＩＴ.                      
005430     EXIT.                                                        
005440*                                                                 
005450******************************************************************
005460*    債権情報（一般）ＤＢより項目の抽出処理                      *
005470******************************************************************
005480 債権情報ＤＢより項目の抽出処理       SECTION.                    
005490 債権情報ＤＢより項目の抽出処理−ＳＴＡＲＴ.                      
005500*                                                                 
005510*--< ＤＢより項目取得 >                                           
005520     
      *    EXEC SQL                                                     
005530*       SELECT      状態フラグ                                    
005540*                  ,債権契約件名                                  
005550*                  ,担保区分                                      
005560*         INTO      :Ｍ０１−状態フラグ                           
005570*                  ,:Ｍ０１−債権契約件名                         
005580*                  ,:Ｍ０１−担保区分                             
005590*         FROM      M01SAJ_TBL                                    
005600*          WHERE    レコード区分  =   '1'                         
005610*            AND    契約番号      =   :Ｍ４０−契約番号           
005620*            AND    再リース回数  =   :Ｍ４０−再リース回数       
005630*            AND    契約種類      =   :Ｍ４０−契約種類           
005640*    END-EXEC.
           CALL "SQLADR" USING SQ0005 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 294 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               Ｍ０１−状態フラグ
               SQL-SQHSTV(1)
           MOVE 1 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               Ｍ０１−債権契約件名
               SQL-SQHSTV(2)
           MOVE 40 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               Ｍ０１−担保区分
               SQL-SQHSTV(3)
           MOVE 1 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               Ｍ４０−契約番号
               SQL-SQHSTV(4)
           MOVE 15 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               Ｍ４０−再リース回数
               SQL-SQHSTV(5)
           MOVE 2 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               Ｍ４０−契約種類
               SQL-SQHSTV(6)
           MOVE 3 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005650*                                                                 
005660*--< ＤＢより項目取得を確認 >                                     
005670     EVALUATE   SQLCODE                                           
005680        WHEN  定数−ＳＱＬＯＫ                                    
005690*--<       取得正常 >                                             
005700           CONTINUE                                               
005710        WHEN  OTHER                                               
005720*--<       取得エラー >                                           
005730           MOVE  ZERO                 TO  Ｍ０１−状態フラグ      
005740           MOVE  SPACE                TO  Ｍ０１−債権契約件名    
005750           MOVE  ZERO                 TO  Ｍ０１−担保区分        
005760           MOVE  -60                  TO  Ｗ−エラーコード        
005770           PERFORM  エラー判定処理                                
005780     END-EVALUATE.                                                
005790*                                                                 
005800 債権情報ＤＢより項目の抽出処理−ＥＸＩＴ.                        
005810     EXIT.                                                        
005820*                                                                 
005830******************************************************************
005840*    前受金受払残高中間ファイル項目編集、出力処理                *
005850******************************************************************
005860 前受金項目編集出力処理               SECTION.                    
005870 前受金項目編集出力処理−ＳＴＡＲＴ.                              
005880*                                                                 
005890*--< 前受金受払残高中間ファイル項目編集処理（自社分）>            
005900     PERFORM  項目編集処理自社分.                                 
005910*                                                                 
005920*--< 前受金受払残高中間ファイル出力処理 >                         
005930     PERFORM  前受金出力処理.                                     
005940*                                                                 
005950     IF  Ｍ４０−協調区分         =  "2"                          
005960*--<    前受金受払残高中間ファイル項目編集処理（他社分）>         
005970        PERFORM  項目編集処理他社分                               
005980*                                                                 
005990*--<    前受金受払残高中間ファイル出力処理 >                      
006000        PERFORM  前受金出力処理                                   
006010     END-IF.                                                      
006020*                                                                 
006030 前受金項目編集出力処理−ＥＸＩＴ.                                
006040     EXIT.                                                        
006050*                                                                 
006060******************************************************************
006070*    前受金受払残高中間ファイル項目編集処理（自社分）            *
006080******************************************************************
006090 項目編集処理自社分                   SECTION.                    
006100 項目編集処理自社分−ＳＴＡＲＴ.                                  
006110*                                                                 
006120*--< 出力レコード初期化 >                                         
006130     MOVE  初期化レコード             TO  出力−レコード.         
006140*                                                                 
006150*--< 項目編集処理（自社分） >                                     
006160*--<  No.01 >                                                     
006170     IF  Ｍ０１−状態フラグ  <  "3"                               
006180        MOVE  "3"                     TO  出力−自他社区分        
006190     ELSE                                                         
006200        MOVE  "1"                     TO  出力−自他社区分        
006210     END-IF.                                                      
006220*                                                                 
006230*--< No.02 - No.22 >                                              
006240     PERFORM  ファイル項目編集.                                   
006250*                                                                 
006260*--< No.23 >                                                      
006270     MOVE  Ｍ４０−前月末残高         TO  出力−前月末残高.       
006280*                                                                 
006290*--< No.24 >                                                      
006300     MOVE  Ｍ４０−当月回収額         TO  出力−当月入金額.       
006310*                                                                 
006320*--< No.25 >                                                      
006330     MOVE  Ｍ４０−当月消化額         TO  出力−当月消化額.       
006340*                                                                 
006350*--< No.26 >                                                      
006360     MOVE  Ｍ４０−当月末残高         TO  出力−当月末残高.       
006370*                                                                 
006380 項目編集処理自社分−ＥＸＩＴ.                                    
006390     EXIT.                                                        
006400*                                                                 
006410******************************************************************
006420*    前受金受払残高中間ファイル項目編集処理（他社分）            *
006430******************************************************************
006440 項目編集処理他社分                   SECTION.                    
006450 項目編集処理他社分−ＳＴＡＲＴ.                                  
006460*                                                                 
006470*--< 出力レコード初期化 >                                         
006480     MOVE  初期化レコード             TO  出力−レコード.         
006490*                                                                 
006500*--< 項目編集処理（他社分）>                                      
006510*--< No.01 >                                                      
006520     IF  Ｍ０１−状態フラグ  <  "3"                               
006530        MOVE  "4"                     TO  出力−自他社区分        
006540     ELSE                                                         
006550        MOVE  "2"                     TO  出力−自他社区分        
006560     END-IF.                                                      
006570*                                                                 
006580*--< No.02 - No.22 >                                              
006590     PERFORM  ファイル項目編集.                                   
006600*                                                                 
006610*--< No.23 >                                                      
006620     MOVE  Ｍ４０−前月末残高他社     TO  出力−前月末残高.       
006630*                                                                 
006640*--< No.24 >                                                      
006650     MOVE  Ｍ４０−当月回収額他社     TO  出力−当月入金額.       
006660*                                                                 
006670*--< No.25 >                                                      
006680     COMPUTE  出力−当月消化額  =  Ｍ４０−当月消化額他社         
006690                                +  Ｍ４０−当月他社解約分料金     
006700                                +  Ｍ４０−当月他社解約分消費税.  
006710*                                                                 
006720*--< No.26 >                                                      
006730     COMPUTE  出力−当月末残高  =  Ｍ４０−当月末残高他社         
006740                                -  Ｍ４０−当月他社解約分料金     
006750                                -  Ｍ４０−当月他社解約分消費税.  
006760*                                                                 
006770 項目編集処理他社分−ＥＸＩＴ.                                    
006780     EXIT.                                                        
006790*                                                                 
006800******************************************************************
006810*    共通ファイル項目編集                                        *
006820******************************************************************
006830 ファイル項目編集                     SECTION.                    
006840 ファイル項目編集−ＳＴＡＲＴ.                                    
006850*                                                                 
006860*--< No.02 >                                                      
006870     MOVE  Ｍ４０−レコード区分       TO  出力−前受区分.         
006880*                                                                 
006890*--< No.03 >                                                      
006900     MOVE  Ｍ４０−経理用主契約区分   TO  出力−主契約区分.       
006910*                                                                 
006920*--< No.04 >                                                      
006930     MOVE  Ｍ４０−顧客区分           TO  出力−連結区分.         
006940*                                                                 
006950*--< No.05 >                                                      
006960     MOVE  Ｄ０１−名寄せコード       TO  出力−名寄せコード.     
006970*                                                                 
006980*--< No.06 >                                                      
006990     MOVE  Ｍ４０−請求先取引先コード TO  出力−取引先コード.     
007000*                                                                 
007010*--< No.07 >                                                      
007020     MOVE  Ｍ４０−請求先コード       TO  出力−請求先コード.     
007030*                                                                 
007040*--< No.08 >                                                      
007050     MOVE  Ｍ４０−契約番号           TO  出力−契約番号.         
007060*                                                                 
007070*--< No.09 >                                                      
007080     MOVE  Ｍ４０−契約種類           TO  出力−契約種類.         
007090*                                                                 
007100*--< No.10 >                                                      
007110     MOVE  Ｄ７０−バッチ用業務年月   TO  出力−業務年月.         
007120*                                                                 
007130*--< No.11 >                                                      
007140     MOVE  Ｍ４０−担当部課コード     TO  出力−担当部課コード.   
007150*                                                                 
007160*--< No.12 >                                                      
007170     MOVE  Ｍ０１−債権契約件名       TO  出力−契約件名.         
007180*                                                                 
007190*--< No.13 >                                                      
007200     MOVE  Ｍ４０−再リース回数       TO  出力−再リース回数.     
007210*                                                                 
007220*--< No.14 >                                                      
007230     MOVE  Ｍ４０−充当開始年月       TO  出力−充当開始年月.     
007240*                                                                 
007250*--< No.15 >                                                      
007260     MOVE  Ｍ４０−充当月数           TO  出力−充当月数.         
007270*                                                                 
007280*--< No.16 >                                                      
007290     MOVE  Ｍ４０−前払回収方法       TO  出力−前払回収方法.     
007300*                                                                 
007310*--< No.17 >                                                      
007320     MOVE  Ｍ４０−入金日             TO  出力−入金日.           
007330*                                                                 
007340*--< No.18 >                                                      
007350     MOVE  Ｍ４０−入金区分           TO  出力−入金区分.         
007360*                                                                 
007370*--< No.19 >                                                      
007380     MOVE  Ｄ０１−取引先名称         TO  出力−取引先名称.       
007390*                                                                 
007400*--< No.20 >                                                      
007410     MOVE  Ｄ０２−請求先名称         TO  出力−請求先名称.       
007420*                                                                 
007430*--< No.21 >                                                      
007440     MOVE  Ｗ−主契約区分名称         TO  出力−主契約区分名称.   
007450*                                                                 
007460*--< No.22 >                                                      
007470     MOVE  Ｗ−顧客区分名称           TO  出力−連結区分名称.     
007480*                                                                 
007490 ファイル項目編集−ＥＸＩＴ.                                      
007500     EXIT.                                                        
007510*                                                                 
007520******************************************************************
007530*    前受金受払残高中間ファイル出力処理                          *
007540******************************************************************
007550 前受金出力処理                       SECTION.                    
007560 前受金出力処理−ＳＴＡＲＴ.                                      
007570*                                                                 
007580*--<     前受金出力処理 >                                         
007590     IF  出力−前月末残高  =  ZERO      AND                       
007600         出力−当月入金額  =  ZERO      AND                       
007610         出力−当月消化額  =  ZERO      AND                       
007620         出力−当月末残高  =  ZERO                                
007630        CONTINUE                                                  
007640     ELSE                                                         
007650        WRITE  出力−レコード                                     
007660*                                                                 
007670*--<    前受金出力状態判定 >                                      
007680        EVALUATE  Ｗ−ファイル状態                                
007690           WHEN  ZERO                                             
007700*                                                                 
007710*--<          前受金出力件数加算 >                                
007720              COMPUTE  Ｗ−出力−件数 =  Ｗ−出力−件数  +  1     
007730           WHEN  OTHER                                            
007740*                                                                 
007750*--<          ファイル出力エラー >                                
007760              MOVE  -6                TO  Ｗ−エラーコード        
007770              PERFORM  エラー判定処理                             
007780        END-EVALUATE                                              
007790     END-IF.                                                      
007800*                                                                 
007810 前受金出力処理−ＥＸＩＴ.                                        
007820     EXIT.                                                        
007830*                                                                 
007840******************************************************************
007850*    終了処理                                                    *
007860******************************************************************
007870 終了処理                             SECTION.                    
007880 終了処理−ＳＴＡＲＴ.                                            
007890*                                                                 
007900*--< ＤＢクローズ >                                               
007910     PERFORM  ＤＢクローズ処理.                                   
007920*                                                                 
007930*--< ファイルクローズ >                                           
007940     CLOSE  出力ファイル.                                         
007950*                                                                 
007960*--< 件数メッセージ出力処理 >                                     
007970     PERFORM  件数メッセージ出力.                                 
007980*                                                                 
007990*--< 終了メッセージ出力処理 >                                     
008000     PERFORM  終了メッセージ出力.                                 
008010*                                                                 
008020*--< プログラム正常終了 >                                         
008030     MOVE  定数−正常状態             TO  PROGRAM-STATUS.         
008040*                                                                 
008050 終了処理−ＥＸＩＴ.                                              
008060     EXIT.                                                        
008070*                                                                 
008080******************************************************************
008090*    ＤＢクローズ                                                *
008100******************************************************************
008110 ＤＢクローズ処理                     SECTION.                    
008120 ＤＢクローズ処理−ＳＴＡＲＴ.                                    
008130*                                                                 
008140*--< カーソル クローズ >                                          
008150     
      *    EXEC SQL                                                     
008160*       CLOSE  CUR1                                               
008170*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 333 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
008180*                                                                 
008190 ＤＢクローズ処理−ＥＸＩＴ.                                      
008200     EXIT.                                                        
008210*                                                                 
008220******************************************************************
008230*    件数メッセージ出力                                          *
008240******************************************************************
008250 件数メッセージ出力                   SECTION.                    
008260 件数メッセージ出力−ＳＴＡＲＴ.                                  
008270*                                                                 
008280     INITIALIZE                       IF-CHOCO001.                
008290     MOVE  "3"                        TO  共１−イベント種別.     
008300     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
008310     MOVE  "0"                        TO  共１−復帰コード.       
008320     MOVE  "M40MAB"                   TO  共１−処理テーブルＩＤ. 
008330     MOVE  "COUNT"                    TO  共１−処理識別.         
008340     MOVE  Ｗ−入力−件数             TO  共１−データ内容.       
008350     MOVE  "前受情報テーブル（入力）"                             
008360                                      TO  共１−その他メッセージ. 
008370     CALL  CLOCO001                USING  IF-CHOCO001.            
008380*                                                                 
008390     INITIALIZE                       IF-CHOCO001.                
008400     MOVE  "3"                        TO  共１−イベント種別.     
008410     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
008420     MOVE  "0"                        TO  共１−復帰コード.       
008430     MOVE  "SFHSED25"                 TO  共１−処理テーブルＩＤ. 
008440     MOVE  "COUNT"                    TO  共１−処理識別.         
008450     MOVE  Ｗ−出力−件数             TO  共１−データ内容.       
008460     MOVE  "前受金受払残高ファイル"   TO  共１−その他メッセージ. 
008470     CALL  CLOCO001                USING  IF-CHOCO001.            
008480*                                                                 
008490 件数メッセージ出力−ＥＸＩＴ.                                    
008500     EXIT.                                                        
008510*                                                                 
008520******************************************************************
008530*    終了メッセージ出力                                          *
008540******************************************************************
008550 終了メッセージ出力                   SECTION.                    
008560 終了メッセージ出力−ＳＴＡＲＴ.                                  
008570*                                                                 
008580     INITIALIZE                       IF-CHOCO001.                
008590     MOVE  "3"                        TO  共１−イベント種別.     
008600     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
008610     MOVE  "0"                        TO  共１−復帰コード.       
008620     MOVE  "END"                      TO  共１−処理識別.         
008630     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
008640     CALL  CLOCO001                USING  IF-CHOCO001.            
008650*                                                                 
008660 終了メッセージ出力−ＥＸＩＴ.                                    
008670     EXIT.                                                        
008680*                                                                 
008690******************************************************************
008700*    エラー判定処理                                              *
008710******************************************************************
008720 エラー判定処理                       SECTION.                    
008730 エラー判定処理−ＳＴＡＲＴ.                                      
008740*                                                                 
008750     MOVE  "Y"                        TO Ｗ−異常終了−フラグ.    
008760     INITIALIZE                       IF-CHOCO001.                
008770*                                                                 
008780     EVALUATE  Ｗ−エラーコード                                   
008790*                                                                 
008800        WHEN  -5                                                  
008810*                                                                 
008820*--<       出力ファイルオープンエラー >                           
008830           MOVE  "1"                  TO  共１−イベント種別      
008840           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
008850           MOVE  "9"                  TO  共１−復帰コード        
008860           MOVE  "SFHSED25"           TO  共１−処理テーブルＩＤ  
008870           MOVE  "OPEN"               TO  共１−処理識別          
008880           MOVE  Ｗ−ファイル状態     TO  共１−データ内容        
008890           MOVE  "前受金受払残高ファイルオープンエラー "          
008900                                      TO  共１−その他メッセージ  
008910           CALL  CLOCO001          USING  IF-CHOCO001             
008920*                                                                 
008930        WHEN  -6                                                  
008940*                                                                 
008950*--<       出力処理失敗 >                                         
008960           MOVE  "1"                  TO  共１−イベント種別      
008970           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
008980           MOVE  "9"                  TO  共１−復帰コード        
008990           MOVE  "SFHSED25"           TO  共１−処理テーブルＩＤ  
009000           MOVE  "WRITE"              TO  共１−処理識別          
009010           MOVE  Ｗ−ファイル状態     TO  共１−データ内容        
009020           MOVE  "前受金受払残高ファイル出力エラー"               
009030                                      TO  共１−その他メッセージ  
009040           CALL  CLOCO001          USING  IF-CHOCO001             
009050*                                                                 
009060        WHEN  -10                                                 
009070*                                                                 
009080*--<       ＯＲＡＣＬＥ接続失敗 >                                 
009090           MOVE  "1"                  TO  共１−イベント種別      
009100           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
009110           MOVE  "9"                  TO  共１−復帰コード        
009120           MOVE  "CONNECT"            TO  共１−処理識別          
009130           MOVE  SQLCODE              TO  共１−データ内容        
009140           MOVE  SQLERRMC             TO  共１−その他メッセージ  
009150           CALL  CLOCO001          USING  IF-CHOCO001             
009160*                                                                 
009170        WHEN  -20                                                 
009180*                                                                 
009190*--<       業務管理テーブル読込失敗 >                             
009200           MOVE  "1"                  TO  共１−イベント種別      
009210           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
009220           MOVE  "9"                  TO  共１−復帰コード        
009230           MOVE  "D70GYM"             TO  共１−処理テーブルＩＤ  
009240           MOVE  "SELECT"             TO  共１−処理識別          
009250           MOVE  SQLCODE              TO  共１−データ内容        
009260           MOVE  SQLERRMC             TO  共１−その他メッセージ  
009270           CALL  CLOCO001          USING  IF-CHOCO001             
009280*                                                                 
009290        WHEN  -30                                                 
009300*                                                                 
009310*--<       結合テーブルカーソルオープン失敗 >                     
009320           MOVE  "1"                  TO  共１−イベント種別      
009330           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
009340           MOVE  "9"                  TO  共１−復帰コード        
009350           MOVE  "M40MAB"             TO  共１−処理テーブルＩＤ  
009360           MOVE  "OPEN"               TO  共１−処理識別          
009370           MOVE  SQLCODE              TO  共１−データ内容        
009380           MOVE  SQLERRMC             TO  共１−その他メッセージ  
009390           CALL  CLOCO001          USING  IF-CHOCO001             
009400*                                                                 
009410        WHEN  -40                                                 
009420*                                                                 
009430*--<       結合テーブル読込失敗 >                                 
009440           MOVE  "1"                  TO  共１−イベント種別      
009450           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
009460           MOVE  "9"                  TO  共１−復帰コード        
009470           MOVE  "M40MAB"             TO  共１−処理テーブルＩＤ  
009480           MOVE  "FETCH"              TO  共１−処理識別          
009490           MOVE  SQLCODE              TO  共１−データ内容        
009500           MOVE  SQLERRMC             TO  共１−その他メッセージ  
009510           CALL  CLOCO001          USING  IF-CHOCO001             
009520*                                                                 
009530        WHEN  -50                                                 
009540*                                                                 
009550*--<       項目名称マスタ主契約区分名称の抽出処理失敗 >           
009560           MOVE  "2"                  TO  共１−イベント種別      
009570           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
009580           MOVE  "9"                  TO  共１−復帰コード        
009590           MOVE  "D19MSY"             TO  共１−処理テーブルＩＤ  
009600           MOVE  "SELECT"             TO  共１−処理識別          
009610           MOVE  SQLCODE              TO  共１−データ内容        
009620           MOVE  SQLERRMC             TO  共１−その他メッセージ  
009630           MOVE  "N"                  TO Ｗ−異常終了−フラグ     
009640           CALL  CLOCO001          USING  IF-CHOCO001             
009650           DISPLAY  "０３８経理用主契約区分名称が存在しない"      
009660                    "前受情報ＤＢ．レコード区分 ＝ "              
009670                                       Ｍ４０−レコード区分       
009680                    "前受情報ＤＢ．契約番号 ＝ "                  
009690                                       Ｍ４０−契約番号           
009700                    "前受情報ＤＢ．再リース回数 ＝ "              
009710                                       Ｍ４０−再リース回数       
009720                    "前受情報ＤＢ．契約種類 ＝ "                  
009730                                       Ｍ４０−契約種類           
009740                    "前受情報ＤＢ．仮受金入金日 ＝ "              
009750                                       Ｍ４０−仮受金入金日       
009760                    "前受情報ＤＢ．仮受金ＳＥＱ−ＮＯ ＝ "        
009770                                       Ｍ４０−仮受金ＳＥＱ−ＮＯ 
009780*                                                                 
009790        WHEN  -60                                                 
009800*                                                                 
009810*--<       債権情報ＤＢ抽出処理失敗 >                             
009820           MOVE  "2"                  TO  共１−イベント種別      
009830           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
009840           MOVE  "9"                  TO  共１−復帰コード        
009850           MOVE  "M01SAJ"             TO  共１−処理テーブルＩＤ  
009860           MOVE  "SELECT"             TO  共１−処理識別          
009870           MOVE  SQLCODE              TO  共１−データ内容        
009880           MOVE  SQLERRMC             TO  共１−その他メッセージ  
009890           CALL  CLOCO001          USING  IF-CHOCO001             
009900           DISPLAY  "債権情報ＤＢに対象データが存在しない"        
009910                    "前受情報ＤＢ．レコード区分 ＝ "              
009920                                       Ｍ４０−レコード区分       
009930                    "前受情報ＤＢ．契約番号 ＝ "                  
009940                                       Ｍ４０−契約番号           
009950                    "前受情報ＤＢ．再リース回数 ＝ "              
009960                                       Ｍ４０−再リース回数       
009970                    "前受情報ＤＢ．契約種類 ＝ "                  
009980                                       Ｍ４０−契約種類           
009990                    "前受情報ＤＢ．仮受金入金日 ＝ "              
010000                                       Ｍ４０−仮受金入金日       
010010                    "前受情報ＤＢ．仮受金ＳＥＱ−ＮＯ ＝ "        
010020                                       Ｍ４０−仮受金ＳＥＱ−ＮＯ 
010030           MOVE  "N"                  TO  Ｗ−異常終了−フラグ    
010040*                                                                 
010050        WHEN  -70                                                 
010060*--<       項目名称マスタ顧客区分名称の抽出処理失敗 >             
010070           MOVE  "2"                  TO  共１−イベント種別      
010080           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
010090           MOVE  "9"                  TO  共１−復帰コード        
010100           MOVE  "D19MSY"             TO  共１−処理テーブルＩＤ  
010110           MOVE  "SELECT"             TO  共１−処理識別          
010120           MOVE  SQLCODE              TO  共１−データ内容        
010130           MOVE  SQLERRMC             TO  共１−その他メッセージ  
010140           MOVE  "N"                  TO Ｗ−異常終了−フラグ     
010150           CALL  CLOCO001          USING  IF-CHOCO001             
010160           DISPLAY  "００５経理用顧客区分名称が存在しない"        
010170                    "前受情報ＤＢ．レコード区分 ＝ "              
010180                                       Ｍ４０−レコード区分       
010190                    "前受情報ＤＢ．契約番号 ＝ "                  
010200                                       Ｍ４０−契約番号           
010210                    "前受情報ＤＢ．再リース回数 ＝ "              
010220                                       Ｍ４０−再リース回数       
010230                    "前受情報ＤＢ．契約種類 ＝ "                  
010240                                       Ｍ４０−契約種類           
010250                    "前受情報ＤＢ．仮受金入金日 ＝ "              
010260                                       Ｍ４０−仮受金入金日       
010270                    "前受情報ＤＢ．仮受金ＳＥＱ−ＮＯ ＝ "        
010280                                       Ｍ４０−仮受金ＳＥＱ−ＮＯ 
010290        WHEN  OTHER                                               
010300           MOVE  "N"                  TO  Ｗ−異常終了−フラグ    
010310     END-EVALUATE.                                                
010320*                                                                 
010330     IF Ｗ−異常終了−フラグ  =  "Y"                              
010340*--<    件数メッセージ出力処理 >                                  
010350        PERFORM  件数メッセージ出力                               
010360*                                                                 
010370*--<    終了メッセージ出力処理 >                                  
010380        PERFORM  終了メッセージ出力                               
010390*                                                                 
010400*--<    プログラムリターンコード >                                
010410        MOVE  定数−異常状態          TO  PROGRAM-STATUS          
010420*                                                                 
010430        EXIT  PROGRAM                                             
010440     END-IF.                                                      
010450*                                                                 
010460 エラー判定処理−ＥＸＩＴ.                                        
010470     EXIT.                                                        
010480*                                                                 
010490******************************************************************
010500*                  END OF PROGRAM                                *
010510******************************************************************
