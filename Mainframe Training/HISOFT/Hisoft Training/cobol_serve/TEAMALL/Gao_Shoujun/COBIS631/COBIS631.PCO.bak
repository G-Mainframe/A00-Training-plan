000010******************************************************************
000020*         CP(A)                                     *
000030*      1. vO  : t@N^O쐬                   *
000040*      2. vOID  : COBIS631                               *
000050*      3. Tv      : _ԍKEYƂAt@N^O      *
000060*                         ({)ƃt@N^O(`)   *
000070*                         ŌsB                     *
000080*                                                                *
000090*      4. 쐬        : R                                 *
000100*      5. 쐬        : 2005.4.5                     @        *
000110******************************************************************
000120*                                                                 
000130******************************************************************
000140*    hcdmshehb`shnm  chuhrhnm              *
000150******************************************************************
000160 IDENTIFICATION                       DIVISION.                   
000170*                                                                 
000180 PROGRAM-ID.                          COBIS631.                   
000190******************************************************************
000200*    dmuhqnmldms        chuhrhnm              *
000210******************************************************************
000220 ENVIRONMENT                          DIVISION.                   
000230******************************************************************
000240*    hmots|ntsots      rdbshnm                *
000250******************************************************************
000260 INPUT-OUTPUT                         SECTION.                    
000270 FILE-CONTROL.                                                    
000280*                                                                 
000290     SELECT         ̓t@C    ASSIGN    TO   U05            
000300     FILE STATUS    IS     v|                               
000310     ORGANIZATION   IS     LINE       SEQUENTIAL.                 
000320*                                                                 
000330******************************************************************
000340*    c`s`                      chuhrhnm              *
000350******************************************************************
000360 DATA                                 DIVISION.                   
000370******************************************************************
000380*    ehkd                      rdbshnm                *
000390******************************************************************
000400 FILE                                 SECTION.                    
000410*----------------------------------------------------------------*
000420*    ̓t@C                                                *
000430*----------------------------------------------------------------*
000440 FD  ̓t@C                                                 
000450     LABEL  RECORD    IS              STANDARD                    
000460     BLOCK  CONTAINS  0               RECORDS.                    
000470*                                                                 
000480 01  ̓R[h.                                                
000490     COPY   CISPF001   REPLACING      ==()==  BY  ==́|==.     
000500*                                                                 
000510******************************************************************
000520*  vnqjhmf|rsnq`fd  rdbshnm                *
000530******************************************************************
000540  WORKING-STORAGE                     SECTION.                    
000550*----------------------------------------------------------------*
000560*    zXgϐ`GA                                        *
000570*----------------------------------------------------------------*
000580     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
000590*                                                                 
000600*--< nq`bkdʕϐ >                                       
000610     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
000620*                                                                 
000630*--< nq`bkd  rpks >                               
000640     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
000650*                                                                 
000660*--< t@N^O({)e[u >                           
000670     EXEC  SQL  INCLUDE  LTRFCK.CBL            END-EXEC.          
000680*                                                                 
000690*--< t@N^O(`)e[u >                           
000700     EXEC  SQL  INCLUDE  LTRFCT.CBL            END-EXEC.          
000710*                                                                 
000720*--< ij}X^>                                      
000730     EXEC  SQL  INCLUDE  LTRTRI.CBL            END-EXEC.          
000740                                                                  
000750*--< `e[u>                                            
000760     EXEC  SQL  INCLUDE  D642UTG.CBL           END-EXEC.          
000770                                                                  
000780*--< `WJe[u>                                        
000790     EXEC  SQL  INCLUDE  D645UTT.CBL           END-EXEC.          
000800                                                                  
000810*--< ϊe[u(IKOTBL001)>                                     
000820     EXEC  SQL  INCLUDE  IKOTBL001.CBL         END-EXEC.          
000830                                                                  
000840*--< Kpt@C(CISPF001) >                               
000850 01   vr|                    PIC  X(05).                 
000860                                                                  
000870 01   vr|ړIbc                  PIC  X(01)   VALUE '2'.     
000880                                                                  
000890*--< ϊe[u(IKOTBL001)>                                     
000900                                                                  
000910 01   vr|VR[h            PIC  X(09).                 
000920 01   vr|}                      PIC  X(05).                 
000930 01   vr|UolR[h	    PIC  X(09).                 
000940 01   vr|Uol_R[h	    PIC  X(05).                 
000950                                                                  
000960     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
000970*                                                                 
000980*----------------------------------------------------------------*
000990*    vnqjGA                                              *
001000*----------------------------------------------------------------*
001010 01  vnqj|GA.                                            
001020*--< G[p >                                               
001030     03  v|G[R[h             PIC S9(04).                 
001040*                                                                 
001050*--< t@C >                                               
001060     03  v|                     PIC  X(02).                 
001070                                                                  
001080*--< tOAA >                                               
001090     03  tOAA.                                            
001100         05  v|I|tO         PIC  X(01).                 
001110         05  v|I|tOP       PIC  X(01).                 
001120         05  v|ُI|tO     PIC  X(01).                 
001130*                                                                 
001140*--< GA >                                                 
001150     03  GA.                                              
001160         05  v|́|P         PIC  9(09).                 
001170         05  v|́|Q         PIC  9(09).                 
001180         05  v|ó|P         PIC  9(09).                 
001190         05  v|ó|Q         PIC  9(09).                 
001200*                                                                 
001210*--< ʏ >                                                   
001220 01  v|ʏ.                                                
001230     03  v|VXet.                                        
001240         05  v|I                 PIC  X(02) VALUE  "20".     
001250         05  v|N               PIC  X(06).                 
001260     03  v|VXe             PIC  X(08).                 
001270     03  v|S                   PIC  X(08) VALUE "IKOPG   ".
001280*                                                                 
001290*----------------------------------------------------------------*
001300*    Tu[`                                              *
001310*----------------------------------------------------------------*
001320 01  CALL-AREA.                                                   
001330*--< ʃOTu[` >                                       
001340     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001350     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001360*                                                                 
001370*----------------------------------------------------------------*
001380*    bnoẍ                                                *
001390*----------------------------------------------------------------*
001400*--< ʃOpp[^ >                                       
001410 01  IF-CHOCO001.                                                 
001420     COPY  CHOCO001  REPLACING  ==()==  BY  ==P|==.           
001430                                                                  
001440*----------------------------------------------------------------*
001450*    hmht@CǍTu[`pp^̈                *
001460*----------------------------------------------------------------*
001470 01  PARA-AREA.                                                   
001480     COPY CPBCO001.                                               
001490******************************************************************
001500*    萔pf[^`GA                                      *
001510******************************************************************
001520 CONSTANT                             SECTION.                    
001530 01  萔̈.                                                    
001540     03  萔|vOhc         PIC  X(08) VALUE "COBIS631".
001550     03  萔|vO           PIC  X(80)                  
001560                                    VALUE  "t@N^O쐬".
001570     03  萔|rpknj             PIC S9(04)  VALUE  ZERO.    
001580     03  萔|rpkdmc           PIC S9(04)  VALUE  0100.    
001590     03  萔|               PIC S9(04)  VALUE  ZERO.    
001600     03  萔|ُ               PIC S9(04)  VALUE  0009.    
001610******************************************************************
001620*    oqnbdctqd            chuhrhnm              *
001630******************************************************************
001640 PROCEDURE                            DIVISION.                   
001650*                                                                 
001660     PERFORM  .                                           
001670*                                                                 
001680     PERFORM  又  UNTIL  (v|I|tO  =  "Y")           
001690                      AND    (v|I|tOP = "Y").          
001700*                                                                 
001710     PERFORM  I.                                           
001720*                                                                 
001730     STOP     RUN.                                                
001740*                                                                 
001750******************************************************************
001760*                                                        *
001770******************************************************************
001780                              SECTION.                    
001790 |rs`qs.                                            
001800*                                                                 
001810*----------------------------------------------------------------*
001820*    JnbZ[Wo͏                                      *
001830*----------------------------------------------------------------*
001840     INITIALIZE                       IF-CHOCO001.                
001850     MOVE  "3"                        TO  P|Cxg.     
001860     MOVE  萔|vOhc       TO  P|\[Xhc.       
001870     MOVE  "0"                        TO  P|AR[h.       
001880     MOVE  "START"                    TO  P|.         
001890     MOVE  萔|vO         TO  P|̑bZ[W. 
001900     CALL  CLOCO001                USING  IF-CHOCO001.            
001910*                                                                 
001920*----------------------------------------------------------------*
001930*    Ɨ̈̏l                                        *
001940*----------------------------------------------------------------*
001950     MOVE  SPACE                      TO  vnqj|GA.       
001960     INITIALIZE                           vnqj|GA.       
001970*                                                                 
001980*                                                                 
001990*--< bott擾 >                                           
002000     ACCEPT  v|N               FROM  DATE.                 
002010*                                                                 
002020*--< bot擾 >                                           
002030     ACCEPT  v|VXe         FROM  TIME.                 
002040*                                                                 
002050*--< nq`bkdڑ >                                           
002060     PERFORM   nq`bkdڑ.                                  
002070*                                                                 
002080*--< t@CI[v >                                           
002090     OPEN  INPUT  ̓t@C.                                   
002100*                                                                 
002110*----------------------------------------------------------------*
002120*    t@CI[vԔ                                    *
002130*----------------------------------------------------------------*
002140     EVALUATE  v|                                           
002150        WHEN  ZERO                                                
002160           CONTINUE                                               
002170        WHEN  OTHER                                               
002180*--<       t@CI[vG[ >                               
002190           MOVE     -70               TO  v|G[R[h        
002200           PERFORM  G[菈                                
002210     END-EVALUATE.                                                
002220                                                                  
002230*----------------------------------------------------------------*
002240*    KpǍ(P)                                  *
002250*----------------------------------------------------------------*
002260     PERFORM   Ǎ.                                    
002270                                                                  
002280*--< e[uJ[\` >                                   
002290     PERFORM  e[uJ[\`.                           
002300*                                                                 
002310*--< e[uJ[\Ǎ(P) >                           
002320     PERFORM  e[uJ[\Ǎ.                           
002330*                                                                 
002340 |dwhs.                                              
002350     EXIT.                                                        
002360******************************************************************
002370*    nq`bkdڑ                                            *
002380******************************************************************
002390 nq`bkdڑ                     SECTION.                    
002400 nq`bkdڑ|rs`qs.                                    
002410*                                                                 
002420*--< caڑp擾 >                                   
002430     CALL  COBCO001                USING  PARA-AREA.              
002440*                                                                 
002450     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002460     MOVE  PARA-USERNAME              TO  USERNAME.               
002470     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002480*                                                                 
002490*----------------------------------------------------------------*
002500*    Jnڑ                                                    *
002510*----------------------------------------------------------------*
002520     IF    DB-STRING  =  SPACE                                    
002530        EXEC SQL                                                  
002540           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002550        END-EXEC                                                  
002560     ELSE                                                         
002570        EXEC SQL                                                  
002580           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002590             USING  :DB-STRING                                    
002600        END-EXEC                                                  
002610     END-IF.                                                      
002620*                                                                 
002630*----------------------------------------------------------------*
002640*    ڑmF                                                    *
002650*----------------------------------------------------------------*
002660     EVALUATE  SQLCODE                                            
002670        WHEN   萔|rpknj                                   
002680           CONTINUE                                               
002690        WHEN   OTHER                                              
002700*--<       ڑG[ >                                           
002710           MOVE     -10               TO  v|G[R[h        
002720           PERFORM  G[菈                                
002730     END-EVALUATE.                                                
002740*                                                                 
002750 nq`bkdڑ|dwhs.                                      
002760     EXIT.                                                        
002770******************************************************************
002780*        e[uJ[\`                                *
002790******************************************************************
002800 e[uJ[\`             SECTION.                    
002810 e[uJ[\`|rs`qs.                            
002820*                                                                 
002830*----------------------------------------------------------------*
002840*    J[\nodm                                        *
002850*----------------------------------------------------------------*
002860     EXEC SQL                                                     
002870        DECLARE CUR1  CURSOR FOR                                  
002880          SELECT   LTRFCK._ԍ                                
002890                  ,LTRFCK.[U[R[h                          
002900                  ,NVL(LTRTRI.搳̎於̊        
002910                                              ,RPAD(' ',1,' '))   
002920                  ,NVL(LTRTRI.搳̎於̃Ji        
002930                                              ,RPAD(' ',1,' '))   
002940                  ,LTRFCK.ƏR[h                            
002950                  ,LTRFCK.s                                  
002960                  ,NVL(LTRFCT.`,0)                       
002970                  ,NVL(LTRFCT.,RPAD('0',7,'0'))           
002980                  ,LTRFCK.zʋz                                
002990                  ,LTRFCK.sR[h                              
003000                  ,NVL(LTRFCT.sR[h,RPAD('0',7,'0'))     
003010                  ,LTRFCK.҃R[h                          
003020                  ,NVL(LTRFCT.xl,RPAD(' ',60,' '))          
003030                  ,NVL(LTRFCT.`ԍ,RPAD('0',10,'0'))          
003040                  ,LTRFCK.                                    
003050                                                                  
003060                                                                  
003070            FROM  LTRFCK                                          
003080                 ,LTRFCT                                          
003090                 ,LTRTRI                                          
003100           WHERE  LTRFCK._ԍ       =   LTRFCT._ԍ  (+)  
003110             AND  LTRFCK.[U[R[h =   LTRTRI.R[h(+)
003120        ORDER BY  LTRFCK._ԍ                                 
003130     END-EXEC.                                                    
003140                                                                  
003150*----------------------------------------------------------------*
003160*    J[\nodm                                        *
003170*----------------------------------------------------------------*
003180     EXEC  SQL                                                    
003190        OPEN  CUR1                                                
003200     END-EXEC.                                                    
003210*                                                                 
003220*----------------------------------------------------------------*
003230*    J[\nodmmF                                        *
003240*----------------------------------------------------------------*
003250     EVALUATE  SQLCODE                                            
003260        WHEN  萔|rpknj                                    
003270*--<        >                                                 
003280           CONTINUE                                               
003290        WHEN  OTHER                                               
003300*--<       J[\nodmG[ >                               
003310           MOVE -20                   TO  v|G[R[h        
003320           PERFORM  G[菈                                
003330     END-EVALUATE.                                                
003340*                                                                 
003350 e[uJ[\`|dwhs.                              
003360     EXIT.                                                        
003370******************************************************************
003380*    e[uJ[\Ǎ                                    *
003390******************************************************************
003400 e[uJ[\Ǎ             SECTION.                    
003410 e[uJ[\Ǎ|rs`qs.                            
003420*                                                                 
003430*--< e[uJ[\Ǎ >                                   
003440     EXEC SQL                                                     
003450         FETCH  CUR1                                              
003460          INTO  :ksqebj|_ԍ                           
003470               ,:ksqebj|[U[R[h                     
003480               ,:ksqsqh|搳̎於̊       
003490               ,:ksqsqh|搳̎於̃Ji       
003500               ,:ksqebj|ƏR[h                       
003510               ,:ksqebj|s                             
003520               ,:ksqebs|`                           
003530               ,:ksqebs|                           
003540               ,:ksqebj|zʋz                           
003550               ,:ksqebj|sR[h                         
003560               ,:ksqebs|sR[h                     
003570               ,:ksqebj|҃R[h                     
003580               ,:ksqebs|xl                           
003590               ,:ksqebs|`ԍ                           
003600                                                                  
003610               ,:ksqebj|                               
003620                                                                  
003630                                                                  
003640     END-EXEC.                                                    
003650*                                                                 
003660*----------------------------------------------------------------*
003670*    e[uJ[\ǍmF                              *
003680*----------------------------------------------------------------*
003690     EVALUATE   SQLCODE                                           
003700        WHEN   萔|rpknj                                   
003710*--<        >                                                 
003720*                                                                 
003730           COMPUTE  v|́|P  =  v|́|P  +  1   
003740        WHEN   萔|rpkdmc                                 
003750*--<       ǍI >                                             
003760           MOVE  "Y"                  TO  v|I|tO        
003770        WHEN   OTHER                                              
003780*--<       ǍG[ >                                           
003790           MOVE     -30               TO  v|G[R[h        
003800           PERFORM  G[菈                                
003810     END-EVALUATE.                                                
003820*                                                                 
003830 e[uJ[\Ǎ|dwhs.                              
003840     EXIT.                                                        
003850                                                                  
003860******************************************************************
003870*    KpǍ        (CISPF001)                        *
003880******************************************************************
003890 Ǎ                   SECTION.                        
003900 Ǎ|rs`qs.                                      
003910*--<    Ǎ >                                              
003920        READ  ̓t@C                                        
003930           AT  END                                                
003940*--<          ǍI >                                          
003950              MOVE  "Y"               TO  v|I|tOP      
003960              GO  TO  Ǎ|dwhs                    
003970                                                                  
003980        END-READ.                                                 
003990*                                                                 
004000*----------------------------------------------------------------*
004010*    t@CI[vԔ                                    *
004020*----------------------------------------------------------------*
004030     EVALUATE  v|                                           
004040       WHEN  ZERO                                                 
004050             PERFORM  ͊                              
004060                                                                  
004070             MOVE  ́|(3:4)   TO  vr|(2:4)      
004080                                                                  
004090             COMPUTE  v|́|Q  =  v|́|Q + 1   
004100       WHEN  OTHER                                                
004110*--<       ǂݍ݃G[ >                                       
004120           MOVE     ZERO               TO  vr|           
004130           MOVE     -80                TO  v|G[R[h       
004140           PERFORM  G[菈                                
004150     END-EVALUATE.                                                
004160*                                                                 
004170 Ǎ|dwhs.                                        
004180     EXIT.                                                        
004190                                                                  
004200*----------------------------------------------------------------*
004210*    ͊                                              *
004220*----------------------------------------------------------------*
004230 ͊                        SECTION.                   
004240 ͊|rs`qs.                                      
004250                                                                  
004260     EVALUATE  ́| (1:2)                                 
004270             WHEN  "19"                                           
004280                 MOVE  "0"            TO  vr|(1:1)       
004290             WHEN  "20"                                           
004300                 MOVE  "1"            TO  vr|(1:1)       
004310             WHEN ZERO                                            
004320                 MOVE  ZERO           TO  vr|(1:1)       
004330     END-EVALUATE.                                                
004340                                                                  
004350 ͊|dwhs.                                        
004360     EXIT.                                                        
004370******************************************************************
004380*    又                                                      *
004390******************************************************************
004400 又                               SECTION.                    
004410 又|rs`qs.                                              
004420*                                                                 
004430     PERFORM  .                                       
004440*                                                                 
004450     PERFORM  ҏWo͏.                                       
004460*                                                                 
004470     PERFORM  o͏.                                           
004480                                                                  
004490*--< e[uJ[\ǍiQڈȍ~j >                     
004500     PERFORM  e[uJ[\Ǎ.                           
004510*                                                                 
004520*                                                                 
004530 又|dwhs.                                                
004540     EXIT.                                                        
004550*----------------------------------------------------------------*
004560*                                                    *
004570*----------------------------------------------------------------*
004580                          SECTION.                    
004590 |rs`qs.                                        
004600      IF     ksqebs|(1:5)  NOT < vr|      
004610             CONTINUE                                             
004620      ELSE                                                        
004630                                                                  
004640      MOVE   ZERO                TO  ksqebs|`       
004650      MOVE   ZERO                TO  ksqebs|       
004660      MOVE   ZERO                TO  ksqebs|sR[h 
004670      MOVE   SPACE               TO  ksqebs|xl       
004680 	    MOVE   ZERO                TO  ksqebs|`ԍ       
004690                                                                  
004700      END-IF.                                                     
004710                                                                  
004720 |dwhs.                                          
004730		EXIT.                                                   
004740                                                           
004750*---------------------------------------------------------------* 
004760*     ҏWo͏                                              * 
004770*---------------------------------------------------------------* 
004780 ҏWo͏                         SECTION.                    
004790 ҏWo͏|rs`qs.                                        
004800*                                                                 
004810     PERFORM  ڒo.                                       
004820*                                                                 
004830*----------------------------------------------------------------*
004840*       ڕҏW  `(D642UTG_TBL)                      *
004850*----------------------------------------------------------------*
004860*--<    No.01 >                                                   
004870        MOVE  ksqebj|_ԍ                              
004880                                TO  cUSQ|\_ԍ.       
004890*--<    No.02 >                                                   
004900        MOVE  '1'               TO  cUSQ|.               
004910*--<    No.03 >                                                   
004920        MOVE  vr|VR[h                                
004930                                TO  cUSQ|R[h.       
004940*--<    No.04 >                                                   
004950        MOVE  vr|}                                          
004960                                TO  cUSQ|_R[h.       
004970*--<    No.05 >                                                   
004980        MOVE  ksqsqh|搳̎於̊          
004990                                TO  cUSQ|_於.         
005000*--<    No.06 >                                                   
005010        MOVE  ksqsqh|搳̎於̃Ji          
005020                                TO  cUSQ|_於̃Ji.     
005030*--<    No.07 >                                                   
005040        MOVE  ksqebj|ƏR[h                          
005050                                TO  cUSQ|XR[h.         
005060*--<    No.8 >  	                                                
005070        MOVE  '8'               TO  cUSQ|_敪.         
005080*--<    No.9 >                                                    
005090        MOVE  '0'               TO  cUSQ|`.           
005100*--<    No.10 >                                                   
005110        MOVE  ksqebj|s                                
005120                                TO  cUSQ|.             
005130*--<    No.11 >                                                   
005140        MOVE  ksqebj|s                                
005150                                TO  cUSQ|`[s.         
005160*--<    No.12 >                                                   
005170        MOVE  ksqebs|`                              
005180                                TO  cUSQ|`.           
005190*--<    No.13 >                                                   
005200        MOVE  ksqebs|                              
005210                                TO  cUSQ|.         
005220*--<    No.14 >                                                   
005230        MOVE  '1'               TO  cUSQ|TCN.       
005240                                                                  
005250*--<    No.15 >                                                   
005260        MOVE  ksqebj|zʋz                              
005270                                TO  cUSQ|vz.         
005280*--<    No.16 >                                                   
005290        MOVE  '1'               TO  cUSQ|`.           
005300                                                                  
005310*--<    No.17 >                                                   
005320        MOVE  ksqebj|sR[h                            
005330                                TO  cUSQ|旧sR[h.     
005340*--<    No.18 >                                                   
005350        MOVE  ksqebs|sR[h                        
005360                                TO  cUSQ|xsR[h.     
005370*--<    No.19 >                                                   
005380        MOVE  ksqebj|_ԍ                              
005390                                TO  cUSQ|_ԍP.         
005400*--<    No.20 >                                                   
005410        MOVE  ZERO              TO  cUSQ|_ԍQ.         
005420*--<    No.21 >                                                   
005430        MOVE  ZERO              TO  cUSQ|_ԍR.         
005440*--<    No.22 >                                                   
005450        MOVE  ZERO              TO  cUSQ|_ԍS.         
005460*--<    No.23 >                                                   
005470        MOVE  ZERO              TO  cUSQ|_ԍT.         
005480*--<    No.24 >                                                   
005490        MOVE  ZERO              TO  cUSQ|_ԍU.         
005500*--<    No.25 >                                                   
005510        MOVE  ZERO              TO  cUSQ|_ԍV.         
005520*--<    No.26 >                                                   
005530        MOVE  ZERO              TO  cUSQ|_ԍW.         
005540*--<    No.27 >                                                   
005550        MOVE  ZERO              TO  cUSQ|_ԍX.         
005560*--<    No.28 >                                                   
005570        MOVE  ZERO              TO  cUSQ|_ԍPO.       
005580*--<    No.29 >                                                   
005590        MOVE  SPACE             TO  cUSQ|l.             
005600*--<    No.30 >                                                   
005610        MOVE  ZERO              TO  cUSQ|`e.       
005620*--<    No.31 >                                                   
005630        MOVE  v|VXet  TO  cUSQ|o^N.         
005640*--<    No.92 >                                                   
005650        MOVE  v|VXe  TO  cUSQ|o^.           
005660*--<    No.33 >                                                   
005670        MOVE  v|S        TO  cUSQ|o^S.         
005680*--<    No.34 >                                                   
005690        MOVE  v|VXet  TO  cUSQ|XVN.         
005700*--<    No.35 >                                                   
005710        MOVE  v|VXe  TO  cUSQ|XV.           
005720*--<    No.36 >                                                   
005730        MOVE  v|S        TO  cUSQ|XV.             
005740*--<    No.37 >                                                   
005750        MOVE  v|S        TO  cUSQ|͒S҃R[h.   
005760*--<    No.38>                                                    
005770        MOVE  ZERO              TO  cUSQ|p敪.       
005780*--<    No.39 >                                                   
005790        MOVE  vr|UolR[h                            
005800                                TO  cUSQ|UolR[h. 
005810*--<    No.40 >                                                   
005820        MOVE  vr|Uol_R[h                            
005830                                TO  cUSQ|Uol_R[h. 
005840*--<    No.41 >                                                   
005850        MOVE  ksqebs|xl                              
005860                                TO  cUSQ|Uol.         
005870*--<    No.42 >                                                   
005880        MOVE  SPACE             TO  cUSQ|Uol̃Ji.     
005890                                                                  
005900                                                                  
005910*----------------------------------------------------------------*
005920*       ڕҏW  `WJ(D645UTT_TBL)                  *
005930*----------------------------------------------------------------*
005940*--<    No.01 >                                                   
005950        MOVE   ksqebj|_ԍ                             
005960                                TO   cUST|\_ԍ.      
005970*--<    No.02 >                                                   
005980        MOVE   '1'              TO   cUST|.              
005990*--<    No.03 >                                                   
006000        MOVE   '1'              TO   cUST|A.              
006010*--<    No.04 >                                                   
006020        MOVE   ksqebs|`ԍ                             
006030                                TO   cUST|`ԍ.          
006040*--<    No.05 >                                                   
006050        MOVE   ksqebj|                                 
006060                                TO   cUST|.              
006070*--<    No.06 >                                                   
006080        MOVE   ksqebj|zʋz                             
006090                                TO   cUST|z.              
006100*--<    No.07 >                                                   
006110        MOVE   vr|UolR[h                           
006120                                TO   cUST|UolR[h.
006130*--<    No.08 >                                                   
006140        MOVE   vr|Uol_R[h                           
006150                                TO   cUST|Uol_R[h.
006160*--<    No.09 >                                                   
006170        MOVE   ksqebs|xl                             
006180                                TO   cUST|Uol.        
006190*--<    No.10 >                                                   
006200        MOVE   SPACE            TO   cUST|Uol̃Ji.    
006210*--<    No.11 >                                                   
006220        MOVE   v|VXet TO   cUST|o^N.        
006230*--<    No.12 >                                                   
006240        MOVE   v|VXe TO   cUST|o^.          
006250*--<    No.13 >                                                   
006260        MOVE   v|S       TO   cUST|o^S.        
006270*--<    No.14 >                                                   
006280        MOVE   v|VXet TO   cUST|XVN.        
006290*--<    No.15 >                                                   
006300        MOVE   v|VXe TO   cUST|XV.          
006310*--<    No.16 >                                                   
006320        MOVE   v|S       TO   cUST|XV.            
006330*--<    No.17 >                                                   
006340        MOVE   v|S       TO   cUST|͒S҃R[h.  
006350*--<    No.18 >                                                   
006360        MOVE   ZERO             TO   cUST|`.          
006370*                                                                 
006380 ҏWo͏|dwhs.                                          
006390     EXIT.                                                        
006400*----------------------------------------------------------------*
006410*    ڒo                                                *
006420*----------------------------------------------------------------*
006430 ڒo                         SECTION.                    
006440 ڒo|rs`qs.                                        
006450                                                                  
006460*--< VR[ha}Ԓo >                               
006470     PERFORM  VR[ha}Ԓo.                       
006480                                                                  
006490*--< UolR[haUol_R[h >                     
006500     PERFORM  UolR[haUol_R[h.             
006510                                                                  
006520 ڒo|dwhs.                                          
006530     EXIT.                                                        
006540*----------------------------------------------------------------*
006550*     VR[ha}Ԓo                               *
006560*----------------------------------------------------------------*
006570                                                                  
006580 VR[ha}Ԓo       SECTION.                      
006590 VR[ha}Ԓo|rs`qs.                        
006600*                                                                 
006610                                                                  
006620*--< VR[ha}Ԓo >                               
006630     EXEC SQL                                                     
006640           SELECT  NVL(IKOTBL001.VR[h,RPAD('0',7,'0'))  
006650                  ,NVL(IKOTBL001.},RPAD('0',3,'0'))            
006660             INTO  :vr|VR[h                          
006670                  ,:vr|}                                    
006680             FROM  IKOTBL001                                      
006690            WHERE  IKOTBL001.R[h(+)                      
006700                                 =  :ksqebj|[U[R[h 
006710              AND  IKOTBL001.ړIbc                             
006720                              =  :vr|ړIbc                  
006730     END-EXEC.                                                    
006740                                                                  
006750*--<       SQLCODE菈 >                                      
006760     EVALUATE  SQLCODE                                            
006770        WHEN  萔|rpknj                                    
006780*--<        >                                                 
006790           CONTINUE                                               
006800        WHEN  OTHER                                               
006810*--<        G[ >                                              
006820           MOVE -50                   TO  v|G[R[h        
006830           PERFORM  G[菈                                
006840     END-EVALUATE.                                                
006850                                                                  
006860 VR[ha}Ԓo|dwhs.                          
006870     EXIT.                                                        
006880                                                                  
006890*----------------------------------------------------------------*
006900*   ϊe[u(IKOTBL001)UolR[haUol_R[h*
006910*----------------------------------------------------------------*
006920                                                                  
006930 UolR[haUol_R[h        SECTION.           
006940 UolR[haUol_R[h|rs`qs.              
006950*                                                                 
006960*--< Uol_R[haUol_R[ho >             
006970     EXEC SQL                                                     
006980           SELECT  NVL(IKOTBL001.VR[h,RPAD('0',7,'0'))  
006990                  ,NVL(IKOTBL001.},RPAD('0',3,'0'))            
007000             INTO  :vr|UolR[h                      
007010                  ,:vr|Uol_R[h                      
007020             FROM  IKOTBL001                                      
007030            WHERE  IKOTBL001.R[h(+)                      
007040                                 =  :ksqebj|҃R[h 
007050              AND  IKOTBL001.ړIbc                             
007060                                 =  :vr|ړIbc               
007070     END-EXEC.                                                    
007080                                                                  
007090*--<       SQLCODE菈 >                                      
007100     EVALUATE  SQLCODE                                            
007110        WHEN  萔|rpknj                                    
007120*--<        >                                                 
007130           CONTINUE                                               
007140        WHEN  OTHER                                               
007150*--<       G[ >                                               
007160           MOVE -60                   TO  v|G[R[h        
007170           PERFORM  G[菈                                
007180     END-EVALUATE.                                                
007190                                                                  
007200 UolR[haUol_R[h|dwhs.                
007210     EXIT.                                                        
007220                                                                  
007230******************************************************************
007240*    o͏                                                    *
007250******************************************************************
007260 o͏                             SECTION.                    
007270 o͏|rs`qs.                                            
007280*                                                                 
007290*----------------------------------------------------------------*
007300*       ڏ  `(D642UTG_TBL)                          *
007310*----------------------------------------------------------------*
007320       EXEC  SQL                                                  
007330        INSERT  INTO  D642UTG_TBL                                 
007340           (  \_ԍ                                        
007350             ,                                                
007360             ,R[h                                        
007370             ,_R[h                                        
007380             ,_於                                          
007390             ,_於̃Ji                                      
007400             ,XR[h                                          
007410             ,_敪                                          
007420             ,`                                            
007430             ,                                              
007440             ,`[s                                          
007450             ,`                                            
007460             ,                                          
007470             ,TCN                                        
007480             ,vz                                          
007490             ,`                                            
007500             ,旧sR[h                                      
007510             ,xsR[h                                      
007520             ,_ԍP                                          
007530             ,_ԍQ                                          
007540             ,_ԍR                                          
007550             ,_ԍS                                          
007560             ,_ԍT                                          
007570             ,_ԍU                                          
007580             ,_ԍV                                          
007590             ,_ԍW                                          
007600             ,_ԍX                                          
007610             ,_ԍPO                                        
007620             ,l                                              
007630             ,`e                                        
007640             ,o^N                                          
007650             ,o^                                            
007660             ,o^S                                          
007670             ,XVN                                          
007680             ,XV                                            
007690             ,XV                                              
007700             ,͒S҃R[h                                    
007710             ,p敪                                        
007720             ,UolR[h                                  
007730             ,Uol_R[h                                  
007740             ,Uol                                          
007750             ,Uol̃Ji)                                     
007760       VALUES                                                     
007770           (  :cUSQ|\_ԍ                             
007780             ,:cUSQ|                                     
007790             ,:cUSQ|R[h                             
007800             ,:cUSQ|_R[h                             
007810             ,:cUSQ|_於                               
007820             ,:cUSQ|_於̃Ji                           
007830             ,:cUSQ|XR[h                               
007840             ,:cUSQ|_敪                               
007850             ,:cUSQ|`                                 
007860             ,:cUSQ|                                   
007870             ,:cUSQ|`[s                               
007880             ,:cUSQ|`                                 
007890             ,:cUSQ|                               
007900             ,:cUSQ|TCN                             
007910             ,:cUSQ|vz                               
007920             ,:cUSQ|`                                 
007930             ,:cUSQ|旧sR[h                           
007940             ,:cUSQ|xsR[h                           
007950             ,:cUSQ|_ԍP                               
007960             ,:cUSQ|_ԍQ                               
007970             ,:cUSQ|_ԍR                               
007980             ,:cUSQ|_ԍS                               
007990             ,:cUSQ|_ԍT                               
008000             ,:cUSQ|_ԍU                               
008010             ,:cUSQ|_ԍV                               
008020             ,:cUSQ|_ԍW                               
008030             ,:cUSQ|_ԍX                               
008040             ,:cUSQ|_ԍPO                             
008050             ,:cUSQ|l                                   
008060             ,:cUSQ|`e                             
008070             ,:cUSQ|o^N                               
008080             ,:cUSQ|o^                                 
008090             ,:cUSQ|o^S                               
008100             ,:cUSQ|XVN                               
008110             ,:cUSQ|XV                                 
008120             ,:cUSQ|XV                                   
008130             ,:cUSQ|͒S҃R[h                         
008140             ,:cUSQ|p敪                             
008150             ,:cUSQ|UolR[h                       
008160             ,:cUSQ|Uol_R[h                       
008170             ,:cUSQ|Uol                               
008180             ,:cUSQ|Uol̃Ji)                          
008190     END-EXEC.                                                    
008200*----------------------------------------------------------------*
008210*    ǉmF`(D642UTG_TBL)                         *
008220*----------------------------------------------------------------*
008230     EVALUATE  SQLCODE                                            
008240        WHEN   萔|rpknj                                   
008250*--<       ǉ >                                             
008260            COMPUTE  v|ó|P  =  v|ó|P  +  1  
008270        WHEN   OTHER                                              
008280*--<       ǉG[ >                                       
008290           MOVE     -40               TO  v|G[R[h        
008300           PERFORM  G[菈                                
008310     END-EVALUATE.                                                
008320*----------------------------------------------------------------*
008330*       ڏ  `WJ(D645UTT_TBL)                      *
008340*----------------------------------------------------------------*
008350*                                                                 
008360       EXEC  SQL                                                  
008370        INSERT  INTO  D645UTT_TBL                                 
008380           (  \_ԍ                                        
008390             ,                                                
008400             ,A                                                
008410             ,`ԍ                                            
008420             ,                                                
008430             ,z                                                
008440             ,UolR[h                                  
008450             ,Uol_R[h                                  
008460             ,Uol                                          
008470             ,Uol̃Ji                                      
008480             ,o^N                                          
008490             ,o^                                            
008500             ,o^S                                          
008510             ,XVN                                          
008520             ,XV                                            
008530             ,XV                                              
008540             ,͒S҃R[h                                    
008550             ,`)                                           
008560       VALUES                                                     
008570           (  :cUST|\_ԍ                             
008580             ,:cUST|                                     
008590             ,:cUST|A                                     
008600             ,:cUST|`ԍ                                 
008610             ,:cUST|                                     
008620             ,:cUST|z                                     
008630             ,:cUST|UolR[h                       
008640             ,:cUST|Uol_R[h                       
008650             ,:cUST|Uol                               
008660             ,:cUST|Uol̃Ji                           
008670             ,:cUST|o^N                               
008680             ,:cUST|o^                                 
008690             ,:cUST|o^S                               
008700             ,:cUST|XVN                               
008710             ,:cUST|XV                                 
008720             ,:cUST|XV                                   
008730             ,:cUST|͒S҃R[h                         
008740             ,:cUST|`)                                
008750     END-EXEC.                                                    
008760*                                                                 
008770*----------------------------------------------------------------*
008780*    ǉmF  `WJ(D645UTT_TBL)                   *
008790*----------------------------------------------------------------*
008800     EVALUATE  SQLCODE                                            
008810        WHEN   萔|rpknj                                   
008820*--<       ǉ >                                             
008830           COMPUTE  v|ó|Q  =  v|ó|Q  +  1   
008840        WHEN   OTHER                                              
008850*--<       ǉG[ >                                       
008860           MOVE     -45               TO  v|G[R[h        
008870           PERFORM  G[菈                                
008880     END-EVALUATE.                                                
008890*                                                                 
008900 o͏|dwhs.                                              
008910     EXIT.                                                        
008920******************************************************************
008930*    I                                                    *
008940******************************************************************
008950 I                             SECTION.                    
008960 I|rs`qs.                                            
008970                                                                  
008980     CLOSE    ̓t@C.                                       
008990*                                                                 
009000     PERFORM  caN[Y.                                   
009010*                                                                 
009020     PERFORM  caR~bg.                                   
009030*                                                                 
009040     PERFORM  IbZ[Wo.                                 
009050*                                                                 
009060*--< vOI >                                         
009070     MOVE  萔|             TO  PROGRAM-STATUS.         
009080*                                                                 
009090 I|dwhs.                                              
009100     EXIT.                                                        
009110******************************************************************
009120*    IbZ[Wo                                          *
009130******************************************************************
009140 IbZ[Wo                   SECTION.                    
009150 IbZ[Wó|rs`qs.                                  
009160*                                                                 
009170*----------------------------------------------------------------*
009180*    t@N^O{ǍbZ[Wo͏                 
009190*----------------------------------------------------------------*
009200     INITIALIZE                       IF-CHOCO001.                
009210     MOVE  "3"                        TO  P|Cxg.     
009220     MOVE  萔|vOhc       TO  P|\[Xhc.       
009230     MOVE  "0"                        TO  P|AR[h.       
009240     MOVE  "LTRFCK"                   TO  P|e[uhc. 
009250     MOVE  "COUNT"                    TO  P|.         
009260     MOVE  v|́|P           TO  P|f[^e.       
009270     MOVE  "t@N^O{Ǎ"                           
009280                                      TO  P|̑bZ[W. 
009290     CALL  CLOCO001                USING  IF-CHOCO001.            
009300*----------------------------------------------------------------*
009310*    KpǍbZ[Wo͏                         
009320*----------------------------------------------------------------*
009330     INITIALIZE                       IF-CHOCO001.                
009340     MOVE  "3"                        TO  P|Cxg.     
009350     MOVE  萔|vOhc       TO  P|\[Xhc.       
009360     MOVE  "0"                        TO  P|AR[h.       
009370     MOVE  "FFUISA01"                 TO  P|e[uhc. 
009380     MOVE  "COUNT"                    TO  P|.         
009390     MOVE  v|́|Q           TO  P|f[^e.       
009400     MOVE  "KpǍ"       TO  P|̑bZ[W. 
009410     CALL  CLOCO001                USING  IF-CHOCO001.            
009420*----------------------------------------------------------------*
009430*    `o͌bZ[Wo                               
009440*----------------------------------------------------------------*
009450     INITIALIZE                       IF-CHOCO001.                
009460     MOVE  "3"                        TO  P|Cxg.     
009470     MOVE  萔|vOhc       TO  P|\[Xhc.       
009480     MOVE  "0"                        TO  P|AR[h.       
009490     MOVE  "D642UTG"                  TO  P|e[uhc. 
009500     MOVE  "COUNT"                    TO  P|.         
009510     MOVE  v|ó|P            TO  P|f[^e.      
009520     MOVE  "`o͌"         TO  P|̑bZ[W. 
009530     CALL  CLOCO001                USING  IF-CHOCO001.            
009540*----------------------------------------------------------------*
009550*    `WJo͌bZ[Wo                           
009560*----------------------------------------------------------------*
009570     INITIALIZE                       IF-CHOCO001.                
009580     MOVE  "3"                        TO  P|Cxg.     
009590     MOVE  萔|vOhc       TO  P|\[Xhc.       
009600     MOVE  "0"                        TO  P|AR[h.       
009610     MOVE  "D645UTT"                  TO  P|e[uhc. 
009620     MOVE  "COUNT"                    TO  P|.         
009630     MOVE  v|ó|Q            TO  P|f[^e.      
009640     MOVE  "`WJo͌"     TO  P|̑bZ[W. 
009650     CALL  CLOCO001                USING  IF-CHOCO001.            
009660*                                                                 
009670*----------------------------------------------------------------*
009680*    vOIbZ[W                                 
009690*----------------------------------------------------------------*
009700     INITIALIZE                       IF-CHOCO001.                
009710     MOVE  "3"                        TO  P|Cxg.     
009720     MOVE  萔|vOhc       TO  P|\[Xhc.       
009730     MOVE  "0"                        TO  P|AR[h.       
009740     MOVE  "END"                      TO  P|.         
009750     MOVE  萔|vO         TO  P|̑bZ[W. 
009760     CALL  CLOCO001                USING  IF-CHOCO001.            
009770*                                                                 
009780 IbZ[Wó|dwhs.                                    
009790     EXIT.                                                        
009800******************************************************************
009810*    caN[Y                                                *
009820******************************************************************
009830 caN[Y                     SECTION.                    
009840 caN[Y|rs`qs.                                    
009850*                                                                 
009860*--< J[\ N[Y >                                          
009870     EXEC SQL                                                     
009880        CLOSE  CUR1                                               
009890     END-EXEC.                                                    
009900*                                                                 
009910 caN[Y|dwhs.                                      
009920     EXIT.                                                        
009930******************************************************************
009940*    caR~bg                                            *
009950******************************************************************
009960 caR~bg                     SECTION.                    
009970 caR~bg|rs`qs.                                    
009980*                                                                 
009990     EXEC  SQL                                                    
010000        COMMIT  WORK  RELEASE                                     
010010     END-EXEC.                                                    
010020*                                                                 
010030     INITIALIZE                       IF-CHOCO001.                
010040     MOVE  "3"                        TO  P|Cxg.     
010050     MOVE  萔|vOhc       TO  P|\[Xhc.       
010060     MOVE  "0"                        TO  P|AR[h.       
010070     MOVE  "COMMIT"                   TO  P|.         
010080     MOVE  "R~bg{"             TO  P|̑bZ[W. 
010090     CALL  CLOCO001                USING  IF-CHOCO001.            
010100*                                                                 
010110 caR~bg|dwhs.                                      
010120     EXIT.                                                        
010130******************************************************************
010140*    ca[obN                                        *
010150******************************************************************
010160 ca[obN                 SECTION.                    
010170 ca[obN|rs`qs.                                
010180*                                                                 
010190     EXEC  SQL                                                    
010200        ROLLBACK WORK  RELEASE                                    
010210     END-EXEC.                                                    
010220*                                                                 
010230     INITIALIZE                       IF-CHOCO001.                
010240     MOVE  "1"                        TO  P|Cxg.     
010250     MOVE  萔|vOhc       TO  P|\[Xhc.       
010260     MOVE  "9"                        TO  P|AR[h.       
010270     MOVE  "ROLLBACK"                 TO  P|.         
010280     MOVE  "[obN{"         TO  P|̑bZ[W. 
010290     CALL  CLOCO001                USING  IF-CHOCO001.            
010300*                                                                 
010310 ca[obN|dwhs.                                  
010320     EXIT.                                                        
010330******************************************************************
010340*    G[                                                  *
010350******************************************************************
010360 G[菈                       SECTION.                    
010370 G[菈|rs`qs.                                      
010380*                                                                 
010390     MOVE  "Y"                        TO v|ُI|tO.    
010400     INITIALIZE                           IF-CHOCO001.            
010410*                                                                 
010420     EVALUATE  v|G[R[h                                   
010430                                                                  
010440        WHEN  -10                                                 
010450*--<       nq`bkdڑs >                                 
010460           MOVE  "1"                  TO  P|Cxg      
010470           MOVE  萔|vOhc TO  P|\[Xhc        
010480           MOVE  "9"                  TO  P|AR[h        
010490           MOVE  "CONNECT"            TO  P|          
010500           MOVE  SQLCODE              TO  P|f[^e        
010510           MOVE  SQLERRMC             TO  P|̑bZ[W  
010520           CALL  CLOCO001          USING  IF-CHOCO001             
010530*                                                                 
010540        WHEN  -20                                                 
010550*--<       e[uJ[\I[vs >                     
010560           MOVE  "1"                  TO  P|Cxg      
010570           MOVE  萔|vOhc TO  P|\[Xhc        
010580           MOVE  "9"                  TO  P|AR[h        
010590           MOVE  "LTRFCK"             TO  P|e[uhc  
010600           MOVE  "OPEN"               TO  P|          
010610           MOVE  SQLCODE              TO  P|f[^e        
010620           MOVE  SQLERRMC             TO  P|̑bZ[W  
010630           CALL  CLOCO001          USING  IF-CHOCO001             
010640*                                                                 
010650        WHEN  -30                                                 
010660*--<       e[uǍs >                                 
010670           MOVE  "1"                  TO  P|Cxg      
010680           MOVE  萔|vOhc TO  P|\[Xhc        
010690           MOVE  "9"                  TO  P|AR[h        
010700           MOVE  "LTRFCK"             TO  P|e[uhc  
010710           MOVE  "FETCH"              TO  P|          
010720           MOVE  SQLCODE              TO  P|f[^e        
010730           MOVE  SQLERRMC             TO  P|̑bZ[W  
010740           CALL  CLOCO001          USING  IF-CHOCO001             
010750*                                                                 
010760        WHEN  -40                                                 
010770*--<       `(D642UTG_TBL)ǉs >                        
010780           MOVE  "1"                  TO  P|Cxg      
010790           MOVE  萔|vOhc TO  P|\[Xhc        
010800                                                                  
010810           MOVE  "9"                  TO  P|AR[h        
010820           MOVE  "D642UTG"            TO  P|e[uhc  
010830           MOVE  "INSERT"             TO  P|          
010840           MOVE  SQLCODE              TO  P|f[^e        
010850           MOVE  SQLERRMC             TO  P|̑bZ[W  
010860           CALL  CLOCO001          USING  IF-CHOCO001             
010870                                                                  
010880        WHEN  -45                                                 
010890                                                                  
010900*--<    `WJ(D645UTT_TBL)ǉs >                       
010910                                                                  
010920           MOVE  "1"                  TO  P|Cxg      
010930           MOVE  萔|vOhc TO  P|\[Xhc        
010940           MOVE  "9"                  TO  P|AR[h        
010950           MOVE  "D645UTG"            TO  P|e[uhc  
010960           MOVE  "INSERT"             TO  P|          
010970           MOVE  SQLCODE              TO  P|f[^e        
010980           MOVE  SQLERRMC             TO  P|̑bZ[W  
010990           CALL  CLOCO001          USING  IF-CHOCO001             
011000                                                                  
011010        WHEN  -50                                                 
011020*--<       VR[ha}Ԓo >                         
011030           MOVE  "2"                  TO  P|Cxg      
011040           MOVE  萔|vOhc TO  P|\[Xhc        
011050           MOVE  "9"                  TO  P|AR[h        
011060           MOVE  "IKO001"             TO  P|e[uhc  
011070           MOVE  "SELECT"             TO  P|          
011080           MOVE  SQLCODE              TO  P|f[^e        
011090           MOVE  SQLERRMC             TO  P|̑bZ[W  
011100           CALL  CLOCO001          USING  IF-CHOCO001             
011110           MOVE  "N"                  TO  v|ُI|tO    
011120                                                                  
011130        WHEN  -60                                                 
011140*--<       UolR[haUol_R[h >               
011150           MOVE  "1"                  TO  P|Cxg      
011160           MOVE  萔|vOhc TO  P|\[Xhc        
011170           MOVE  "9"                  TO  P|AR[h        
011180           MOVE  "IKO001"             TO  P|e[uhc  
011190           MOVE  "SELECT"             TO  P|          
011200           MOVE  SQLCODE              TO  P|f[^e        
011210           MOVE  SQLERRMC             TO  P|̑bZ[W  
011220           CALL  CLOCO001          USING  IF-CHOCO001             
011230           MOVE  "N"                  TO  v|ُI|tO    
011240                                                                  
011250	         WHEN  -70                                              
011260*--<       Kpt@CI[vG[ >                     
011270           MOVE  "1"                  TO  P|Cxg      
011280           MOVE  萔|vOhc TO  P|\[Xhc        
011290           MOVE  "9"                  TO  P|AR[h        
011300           MOVE  "CISPF001"           TO  P|e[uhc  
011310           MOVE  "OPEN"               TO  P|          
011320           MOVE  v|             TO  P|f[^e        
011330           MOVE  "Kpt@CI[vG["               
011340                                      TO  P|̑bZ[W  
011350           CALL  CLOCO001          USING  IF-CHOCO001             
011360                                                                  
011370        WHEN  -80                                                 
011380*--<       ǂݍ݃t@CG[ >                         
011390           MOVE  "1"                  TO  P|Cxg      
011400           MOVE  萔|vOhc TO  P|\[Xhc        
011410           MOVE  "9"                  TO  P|AR[h        
011420           MOVE  "CISPF001"           TO  P|e[uhc  
011430           MOVE  "READ"               TO  P|          
011440           MOVE  v|             TO  P|f[^e        
011450           MOVE  "t@Cǂݍ݃G["                   
011460                                      TO  P|̑bZ[W  
011470           CALL  CLOCO001          USING  IF-CHOCO001             
011480           MOVE  "N"                  TO  v|ُI|tO    
011490                                                                  
011500*                                                                 
011510        WHEN  OTHER                                               
011520           MOVE  "N"                  TO v|ُI|tO     
011530     END-EVALUATE.                                                
011540*                                                                 
011550     IF v|ُI|tO  =  "Y"                              
011560        PERFORM  ca[obN                             
011570*                                                                 
011580        PERFORM  IbZ[Wo                               
011590*                                                                 
011600*--<    vOُĨ^[R[h >                      
011610        MOVE  萔|ُ          TO  PROGRAM-STATUS          
011620*                                                                 
011630        EXIT  PROGRAM                                             
011640     END-IF.                                                      
011650*                                                                 
011660 G[菈|dwhs.                                        
011670     EXIT.                                                        
011680******************************************************************
011690*                  END OF PROGRAM                                *
011700******************************************************************
