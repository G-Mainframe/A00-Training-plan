000010******************************************************************
000020*         ÅÉäCãPìÓåè(ëÂòA)ÅÑ                                     *
000030*      1. ÉvÉçÉOÉâÉÄñº  : ëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉãçÏê¨             *
000040*      2. ÉvÉçÉOÉâÉÄID  : AAASED25                               *
000050*      3. èàóùäTóv      :åoóùí˜èàóùÅií†ï[çÏê¨Åj                  *
000060*                         (ÉäÅ[ÉXëOéÛä÷òAí†ï[íäèoÅj              *
000070*                                                                *
000080*      4. çÏê¨é“        : äsêVè‡                                 *
000090*      5. çÏê¨ì˙        : 2005.03.26                             *
000100******************************************************************
000110*                                                                 
000120******************************************************************
000130*    ÇhÇcÇdÇmÇsÇhÇeÇhÇbÇ`ÇsÇhÇnÇm  ÇcÇhÇuÇhÇrÇhÇnÇm              *
000140******************************************************************
000150 IDENTIFICATION                       DIVISION.                   
000160*                                                                 
000170 PROGRAM-ID.                          AAASED25.                   
000180******************************************************************
000190*    ÇdÇmÇuÇhÇqÇnÇmÇlÇdÇmÇs        ÇcÇhÇuÇhÇrÇhÇnÇm              *
000200******************************************************************
000210 ENVIRONMENT                          DIVISION.                   
000220*    ÇhÇmÇoÇtÇsÅ|ÇnÇtÇsÇoÇtÇs      ÇrÇdÇbÇsÇhÇnÇm                *
000230******************************************************************
000240 INPUT-OUTPUT                         SECTION.                    
000250 FILE-CONTROL.                                                    
000260*                                                                 
000270     SELECT         èoóÕÉtÉ@ÉCÉã      ASSIGN    TO   U11          
000280     FILE STATUS    IS                ÇvÅ|èÛë‘                    
000290     ORGANIZATION   IS     LINE       SEQUENTIAL.                 
000300*                                                                 
000310******************************************************************
000320*    ÇcÇ`ÇsÇ`                      ÇcÇhÇuÇhÇrÇhÇnÇm              *
000330******************************************************************
000340 DATA                                 DIVISION.                   
000350******************************************************************
000360*    ÇeÇhÇkÇd                      ÇrÇdÇbÇsÇhÇnÇm                *
000370******************************************************************
000380 FILE                                 SECTION.                    
000390*----------------------------------------------------------------*
000400*    èoóÕÉtÉ@ÉCÉã                                                *
000410*----------------------------------------------------------------*
000420 FD  èoóÕÉtÉ@ÉCÉã                                                 
000430     LABEL  RECORD    IS              STANDARD                    
000440     BLOCK  CONTAINS  0               RECORDS.                    
000450*                                                                 
000460 01  èoóÕÅ|ÉåÉRÅ[Éh.                                              
000470     COPY   CPSCE50   REPLACING      ==()==  BY  ==èoóÕÅ|==.      
000480*                                                                 
000490******************************************************************
000500*  ÇvÇnÇqÇjÇhÇmÇfÅ|ÇrÇsÇnÇqÇ`ÇfÇd  ÇrÇdÇbÇsÇhÇnÇm                *
000510******************************************************************
000520  WORKING-STORAGE                     SECTION.                    
000530*----------------------------------------------------------------*
000540*    ÉzÉXÉgïœêîíËã`ÉGÉäÉA                                        *
000550*----------------------------------------------------------------*
000560     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
000570 01  ÇvÇrÅ|ñºèÃÇP                       PIC  X(60).               
000580 01  ÇvÇrÅ|ñºèÃÇQ                       PIC  X(60).               
000590 01  ÇvÇrÅ|ã∆ñ±ä«óùÇhÇc                 PIC  X(8).                
000600 01  ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇOÇRÇW             PIC  X(012)  VALUE  '038'.
000610 01  ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇOÇOÇT             PIC  X(012)  VALUE  '005'.
000620*                                                                 
000630*--< ÇnÇqÇ`ÇbÇkÇdã§í ïœêî >                                       
000640     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
000650*                                                                 
000660*--< ÇnÇqÇ`ÇbÇkÇd  ÇrÇpÇké¿çsèÓïÒ >                               
000670     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
000680*                                                                 
000690*--< ëOéÛèÓïÒÇcÇa >                                               
000700     EXEC  SQL  INCLUDE  M40MAB.CBL           END-EXEC.           
000710*                                                                 
000720*--< ã∆ñ±ä«óùÉeÅ[ÉuÉã >                                           
000730     EXEC  SQL  INCLUDE  D70GYM.CBL           END-EXEC.           
000740*                                                                 
000750*--< éÊà¯êÊÉ}ÉXÉ^>                                                
000760     EXEC  SQL  INCLUDE  D01TRS.CBL            END-EXEC.          
000770*                                                                 
000780*--< êøãÅêÊÉ}ÉXÉ^>                                                
000790     EXEC  SQL  INCLUDE  D02SQS.CBL            END-EXEC.          
000800*                                                                 
000810*--< çÄñ⁄ñºèÃÉ}ÉXÉ^>                                              
000820     EXEC  SQL  INCLUDE  D19MSY.CBL           END-EXEC.           
000830*                                                                 
000840*--< ç¬å†èÓïÒÅiàÍî ÅjÇc>                                          
000850     EXEC  SQL  INCLUDE  M01SAJ.CBL            END-EXEC.          
000860*                                                                 
000870     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
000880*                                                                 
000890*----------------------------------------------------------------*
000900*    ÇvÇnÇqÇjÉGÉäÉA                                              *
000910*----------------------------------------------------------------*
000920 01  ÇvÇnÇqÇjÅ|ÉGÉäÉA.                                            
000930     03 ÇvÅ|ìñåéè¡âªäz              PIC S9(13).                   
000940	   03 ÇvÅ|ìñåéññécçÇ              PIC S9(13).                   
000950*                                                                 
000960*--< ÉtÉ@ÉCÉãèÛë‘ >                                               
000970     03  ÇvÅ|èÛë‘ÉGÉäÉA.                                          
000980         05  ÇvÅ|èÛë‘                 PIC  X(02).                 
000990*                                                                 
001000*--< ÉGÉâÅ[ÉRÅ[Éh >                                               
001010     03  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             PIC S9(03).                 
001020*                                                                 
001030*--< ÉtÉ@ÉCÉãèÛë‘ >                                               
001040     03  ÉtÉ@ÉCÉãèÛë‘                 PIC  X(02).                 
001050*                                                                 
001060*--< ÉtÉâÉOÉAÉäÉA >                                               
001070     03  ÉtÉâÉOÉAÉäÉA.                                            
001080         05  ÇvÅ|èIóπÅ|ÉtÉâÉO         PIC  X(01).                 
001090         05  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     PIC  X(01).                 
001100*                                                                 
001110*--< åèêîÉGÉäÉA >                                                 
001120     03  åèêîÉGÉäÉA.                                              
001130         05  ÇvÅ|ì¸óÕÅ|åèêî           PIC  9(09).                 
001140         05  ÇvÅ|èoóÕÅ|åèêî           PIC  9(09).                 
001150*                                                                 
001160*----------------------------------------------------------------*
001170*    ÉTÉuÉãÅ[É`Éìñº                                              *
001180*----------------------------------------------------------------*
001190 01  CALL-AREA.                                                   
001200*--< ã§í ÉçÉOÉTÉuÉãÅ[É`Éì >                                       
001210     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001220     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001230*                                                                 
001240*----------------------------------------------------------------*
001250*    ÇbÇnÇoÇxóÃàÊ                                                *
001260*----------------------------------------------------------------*
001270*--< ã§í ÉçÉOópÉpÉâÉÅÅ[É^ >                                       
001280 01  IF-CHOCO001.                                                 
001290     COPY  CHOCO001  REPLACING  ==()==  BY  ==ã§ÇPÅ|==.           
001300*                                                                 
001310*----------------------------------------------------------------*
001320*    ÇhÇmÇhÉtÉ@ÉCÉãì«çûÉTÉuÉãÅ[É`ÉìópÉpÉâÉÅÉ^óÃàÊ                *
001330*----------------------------------------------------------------*
001340 01  PARA-AREA.                                                   
001350     COPY CPBCO001.                                               
001360******************************************************************
001370*    íËêîópÉfÅ[É^íËã`ÉGÉäÉA                                      *
001380******************************************************************
001390 CONSTANT                             SECTION.                    
001400 01  íËêîóÃàÊ.                                                    
001410     03  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc         PIC  X(08) VALUE "AAASED25".
001420     03  íËêîÅ|ÉvÉçÉOÉâÉÄñº           PIC  X(80)                  
001430                         VALUE  "ëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉãçÏê¨".     
001440     03  íËêîÅ|ÇrÇpÇkÇnÇj             PIC S9(04)  VALUE  ZERO.    
001450     03  íËêîÅ|ÇrÇpÇkÇdÇmÇc           PIC S9(04)  VALUE  0100.    
001460     03  íËêîÅ|ê≥èÌèÛë‘               PIC S9(04)  VALUE  ZERO.    
001470     03  íËêîÅ|àŸèÌèÛë‘               PIC S9(04)  VALUE  0009.    
001480******************************************************************
001490*    ÇoÇqÇnÇbÇdÇcÇtÇqÇd            ÇcÇhÇuÇhÇrÇhÇnÇm              *
001500******************************************************************
001510 PROCEDURE                            DIVISION.                   
001520*                                                                 
001530     PERFORM  èâä˙èàóù.                                           
001540*                                                                 
001550     PERFORM  éÂèàóù  UNTIL  ÇvÅ|èIóπÅ|ÉtÉâÉO  =  "Y".            
001560*                                                                 
001570     PERFORM  èIóπèàóù.                                           
001580*                                                                 
001590     STOP     RUN.                                                
001600*                                                                 
001610******************************************************************
001620*    èâä˙èàóù                                                    *
001630******************************************************************
001640 èâä˙èàóù                             SECTION.                    
001650 èâä˙èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
001660*                                                                 
001670*----------------------------------------------------------------*
001680*    äJénÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
001690*----------------------------------------------------------------*
001700     INITIALIZE                       IF-CHOCO001.                
001710     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
001720     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
001730     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
001740     MOVE  "START"                    TO  ã§ÇPÅ|èàóùéØï .         
001750     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
001760     CALL  CLOCO001                USING  IF-CHOCO001.            
001770*----------------------------------------------------------------*
001780*    çÏã∆óÃàÊÇÃèâä˙ílèàóù                                        *
001790*----------------------------------------------------------------*
001800     MOVE  SPACE                      TO  ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001810     INITIALIZE                           ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001820*                                                                 
001830*----------------------------------------------------------------*
001840*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
001850*----------------------------------------------------------------*
001860*--< ÇnÇqÇ`ÇbÇkÇdê⁄ë± >                                           
001870     PERFORM   ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                                  
001880*                                                                 
001890*--< ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû >                                       
001900     PERFORM   ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû.                              
001910*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉì >                                           
001920     PERFORM  ÉtÉ@ÉCÉãÉIÅ[ÉvÉì.                                   
001930                                                                  
001940*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã` >                                   
001950     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`.                           
001960*                                                                 
001970*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû(ÇPåèñ⁄) >                           
001980     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
001990*                                                                 
002000 èâä˙èàóùÅ|ÇdÇwÇhÇs.                                              
002010     EXIT.                                                        
002020******************************************************************
002030*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
002040******************************************************************
002050 ÇnÇqÇ`ÇbÇkÇdê⁄ë±                     SECTION.                    
002060 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇrÇsÇ`ÇqÇs.                                    
002070*                                                                 
002080*--< ÇcÇaê⁄ë±ópèÓïÒÇéÊìæèàóù >                                   
002090     CALL  COBCO001                USING  PARA-AREA.              
002100*                                                                 
002110     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002120     MOVE  PARA-USERNAME              TO  USERNAME.               
002130     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002140*                                                                 
002150*----------------------------------------------------------------*
002160*    äJénê⁄ë±                                                    *
002170*----------------------------------------------------------------*
002180     IF    DB-STRING  =  SPACE                                    
002190        EXEC SQL                                                  
002200           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002210        END-EXEC                                                  
002220     ELSE                                                         
002230        EXEC SQL                                                  
002240           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002250             USING  :DB-STRING                                    
002260        END-EXEC                                                  
002270     END-IF.                                                      
002280*                                                                 
002290*----------------------------------------------------------------*
002300*    ê⁄ë±ämîF                                                    *
002310*----------------------------------------------------------------*
002320     EVALUATE  SQLCODE                                            
002330        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002340           CONTINUE                                               
002350        WHEN   OTHER                                              
002360*--<       ê⁄ë±ÉGÉâÅ[ >                                           
002370           MOVE     -10               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002380           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002390     END-EVALUATE.                                                
002400*                                                                 
002410 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇdÇwÇhÇs.                                      
002420     EXIT.                                                        
002430*                                                                 
002440******************************************************************
002450*    ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû                                        *
002460******************************************************************
002470 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû             SECTION.                        
002480 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇrÇsÇ`ÇqÇs.                                
002490     EXEC SQL                                                     
002500        SELECT  ÉoÉbÉ`ópã∆ñ±îNåé                                  
002510          INTO :ÇcÇVÇOÅ|ã∆ñ±îNåé                                  
002520          FROM  D70GYM_TBL                                        
002530          WHERE  D70GYM_TBL.ã∆ñ±ä«óùÇhÇc =  :ÇvÇrÅ|ã∆ñ±ä«óùÇhÇc   
002540     END-EXEC.                                                    
002550     EVALUATE  SQLCODE                                            
002560        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
002570*--<       ê≥èÌ >                                                 
002580           CONTINUE                                               
002590        WHEN  OTHER                                               
002600           MOVE -100                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
002610           PERFORM ÉGÉâÅ[îªíËèàóù                                 
002620      END-EVALUATE.                                               
002630 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇdÇwÇhÇs.                                  
002640     EXIT.                                                        
002650******************************************************************
002660*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉìèàóù                                         
002670******************************************************************
002680 ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                     SECTION.                    
002690 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇrÇsÇ`ÇqÇs.                                    
002700*                                                                 
002710     OPEN  OUTPUT  èoóÕÉtÉ@ÉCÉã.                                  
002720*----------------------------------------------------------------*
002730*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉìämîF                                        *
002740*----------------------------------------------------------------*
002750     EVALUATE  ÇvÅ|èÛë‘                                           
002760        WHEN  ZERO                                                
002770*--<       ê≥èÌ >                                                 
002780           CONTINUE                                               
002790        WHEN  OTHER                                               
002800*--<       ÉtÉ@ÉCÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
002810           MOVE     -40               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002820           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002830     END-EVALUATE.                                                
002840 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇdÇwÇhÇs.                                      
002850     EXIT.                                                        
002860******************************************************************
002870*        åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`                                *
002880******************************************************************
002890 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`             SECTION.                    
002900 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇrÇsÇ`ÇqÇs.                            
002910*                                                                 
002920*----------------------------------------------------------------*
002930*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
002940*----------------------------------------------------------------*
002950     EXEC SQL                                                     
002960        DECLARE CUR1  CURSOR FOR                                  
002970           SELECT 						
002980                  M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™			        
002990                 ,M40MAB_TBL.åoóùópéÂå_ñÒãÊï™			
003000                 ,M40MAB_TBL.å⁄ãqãÊï™				
003010                 ,NVL(D01TRS_TBL.ñºäÒÇπÉRÅ[Éh,RPAD(' ',40,' '))   
003020                 ,M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh			
003030                 ,M40MAB_TBL.êøãÅêÊÉRÅ[Éh			        
003040                 ,M40MAB_TBL.å_ñÒî‘çÜ				
003050                 ,M40MAB_TBL.å_ñÒéÌóﬁ				
003060                 ,M40MAB_TBL.íSìñïîâ€ÉRÅ[Éh	         	
003070                 ,M40MAB_TBL.çƒÉäÅ[ÉXâÒêî			        
003080                 ,M40MAB_TBL.è[ìñäJénîNåé			        
003090                 ,M40MAB_TBL.è[ìñåéêî				
003100                 ,M40MAB_TBL.ëOï•âÒé˚ï˚ñ@	        	        
003110                 ,M40MAB_TBL.ì¸ã‡ì˙				
003120                 ,M40MAB_TBL.ì¸ã‡ãÊï™		        	
003130                 ,NVL(D01TRS_TBL.éÊà¯êÊñºèÃ,RPAD(' ',80,' '))	
003140                 ,NVL(D02SQS_TBL.êøãÅêÊñºèÃ,RPAD(' ',80,' '))	
003150                 ,M40MAB_TBL.ëOåéññécçÇ				
003160                 ,M40MAB_TBL.ìñåéâÒé˚äz				
003170                 ,M40MAB_TBL.ìñåéè¡âªäz			        
003180                 ,M40MAB_TBL.ìñåéññécçÇ                           
003190             FROM  M40MAB_TBL                                     
003200                  ,D01TRS_TBL                                     
003210                  ,D02SQS_TBL                                     
003220            WHERE  M40MAB_TBL.ëOéÛã‡éÛï•écçÇï\ëŒè€ÉtÉâÉO          
003230                                =  '1'                            
003240              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh                  
003250                                 =  D01TRS_TBL.éÊà¯êÊÉRÅ[Éh(+)    
003260              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh                  
003270                                 =  D02SQS_TBL.éÊà¯êÊÉRÅ[Éh(+)    
003280              AND  M40MAB_TBL.êøãÅêÊÉRÅ[Éh                        
003290                                 =  D02SQS_TBL.êøãÅêÊÉRÅ[Éh(+)    
003300         ORDER BY  M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™                        
003310                  ,M40MAB_TBL.å_ñÒî‘çÜ                            
003320     END-EXEC.                                                    
003330*----------------------------------------------------------------*
003340*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
003350*----------------------------------------------------------------*
003360     EXEC  SQL                                                    
003370        OPEN  CUR1                                                
003380     END-EXEC.                                                    
003390*                                                                 
003400*----------------------------------------------------------------*
003410*    ÉJÅ[É\ÉãÇnÇoÇdÇmämîF                                        *
003420*----------------------------------------------------------------*
003430     EVALUATE  SQLCODE                                            
003440        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
003450*--<       ê≥èÌ >                                                 
003460           CONTINUE                                               
003470        WHEN  OTHER                                               
003480*--<       ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
003490           MOVE -20                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003500           PERFORM  ÉGÉâÅ[îªíËèàóù                                
003510     END-EVALUATE.                                                
003520*                                                                 
003530 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇdÇwÇhÇs.                              
003540     EXIT.                                                        
003550******************************************************************
003560*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                                    *
003570******************************************************************
003580 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû             SECTION.                    
003590 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇrÇsÇ`ÇqÇs.                            
003600*                                                                 
003610*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû >                                   
003620     EXEC SQL                                                     
003630         FETCH  CUR1                                              
003640          INTO  :ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™                             
003650               ,:ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™                         
003660               ,:ÇlÇSÇOÅ|å⁄ãqãÊï™					
003670               ,:ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh				
003680               ,:ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh			
003690               ,:ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh				
003700               ,:ÇlÇSÇOÅ|å_ñÒî‘çÜ					
003710               ,:ÇlÇSÇOÅ|å_ñÒéÌóﬁ				        
003720               ,:ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh				
003730               ,:ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî				
003740               ,:ÇlÇSÇOÅ|è[ìñäJénîNåé			        
003750               ,:ÇlÇSÇOÅ|è[ìñåéêî					
003760               ,:ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@			        
003770               ,:ÇlÇSÇOÅ|ì¸ã‡ì˙					
003780               ,:ÇlÇSÇOÅ|ì¸ã‡ãÊï™				        
003790               ,:ÇcÇOÇPÅ|éÊà¯êÊñºèÃ				
003800               ,:ÇcÇOÇQÅ|êøãÅêÊñºèÃ				
003810               ,:ÇlÇSÇOÅ|ëOåéññécçÇ				
003820               ,:ÇlÇSÇOÅ|ìñåéâÒé˚äz			        
003830               ,:ÇlÇSÇOÅ|ìñåéè¡âªäz				
003840               ,:ÇlÇSÇOÅ|ìñåéññécçÇ                               
003850     END-EXEC.                                                    
003860*----------------------------------------------------------------*
003870*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÇämîF                              *
003880*----------------------------------------------------------------*
003890     EVALUATE   SQLCODE                                           
003900        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
003910*--<       ê≥èÌ >                                                 
003920*                                                                 
003930           COMPUTE  ÇvÅ|ì¸óÕÅ|åèêî  =  ÇvÅ|ì¸óÕÅ|åèêî  +  1       
003940        WHEN   íËêîÅ|ÇrÇpÇkÇdÇmÇc                                 
003950*--<       ì«çûèIóπ >                                             
003960           MOVE  "Y"                  TO  ÇvÅ|èIóπÅ|ÉtÉâÉO        
003970        WHEN   OTHER                                              
003980*--<       ì«çûÉGÉâÅ[ >                                           
003990           MOVE     -30               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004000           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004010     END-EVALUATE.                                                
004020*                                                                 
004030 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇdÇwÇhÇs.                              
004040     EXIT.                                                        
004050******************************************************************
004060*    éÂèàóù                                                      *
004070******************************************************************
004080 éÂèàóù                               SECTION.                    
004090 éÂèàóùÅ|ÇrÇsÇ`ÇqÇs.                                              
004100     PERFORM  çÄñ⁄ñºèÃíäèoèàóù.                                   
004110                                                                  
004120     PERFORM  ç¬å†èÓïÒÇÃíäèoèàóù.                                 
004130*                                                                 
004140     IF ÇlÇOÇPÅ|íSï€ãÊï™ NOT = '1'                                
004150	      PERFORM ï“èWèoóÕèàóù                                      
004160	   END-IF.                                                      
004170*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅiÇQåèñ⁄à»ç~Åj >                     
004180     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
004190*                                                                 
004200 éÂèàóùÅ|ÇdÇwÇhÇs.                                                
004210     EXIT.                                                        
004220******************************************************************
004230*     çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù                            
004240******************************************************************
004250 çÄñ⁄ñºèÃíäèoèàóù                     SECTION.                    
004260 çÄñ⁄ñºèÃíäèoèàóùÅ[ÇrÇsÇ`ÇqÇs.                                    
004270     PERFORM éÂå_ñÒãÊï™ñºèÃÇÃíäèoèàóù.                            
004280                                                                  
004290     PERFORM å⁄ãqãÊï™ñºèÃÇÃíäèoèàóù.                              
004300                                                                  
004310 çÄñ⁄ñºèÃíäèoèàóùÅ|ÇdÇwÇhÇs.                                      
004320     EXIT.                                                        
004330******************************************************************
004340*--<çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒãÊï™ñºèÃÇÃíäèoèàóù>                   
004350 éÂå_ñÒãÊï™ñºèÃÇÃíäèoèàóù   SECTION.                              
004360                                                                  
004370 éÂå_ñÒãÊï™ñºèÃÇÃíäèoèàóùÅ[ÇrÇsÇ`ÇqÇs.                            
004380*                                                                 
004390     EXEC SQL                                                     
004400        SELECT  ñºèÃ                                              
004410          INTO :ÇvÇrÅ|ñºèÃÇP                                      
004420          FROM  D19MSY_TBL,M40MAB_TBL                             
004430        WHERE   D19MSY_TBL.ÉRÅ[ÉhÇmÇn = :ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇOÇRÇW   
004440          AND   SUBSTR ( ÉRÅ[Éh,1,1 )                             
004450		                 = :ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™            
004460     END-EXEC.                                                    
004470     EVALUATE  SQLCODE                                            
004480        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
004490*--<       ê≥èÌ >                                                 
004500           CONTINUE                                               
004510        WHEN  OTHER                                               
004520*--<       ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
004530           MOVE      SPACE            TO  ÇvÇrÅ|ñºèÃÇP            
004540           MOVE -200                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
004550           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004560     END-EVALUATE.                                                
004570*                                                                 
004580 éÂå_ñÒãÊï™ñºèÃÅ|ÇdÇwÇhÇs.                                        
004590     EXIT.                                                        
004600*--<çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËå⁄ãqãÊï™ñºèÃÇÃíäèoèàóù>                     
004610 å⁄ãqãÊï™ñºèÃÇÃíäèoèàóù   SECTION.                                
004620 å⁄ãqãÊï™ñºèÃÇÃíäèoèàóùÅ[ÇrÇsÇ`ÇqÇs.                              
004630*                                                                 
004640     EXEC SQL                                                     
004650        SELECT  ñºèÃ                                              
004660          INTO :ÇvÇrÅ|ñºèÃÇQ                                      
004670          FROM  D19MSY_TBL,M40MAB_TBL                             
004680        WHERE   D19MSY_TBL.ÉRÅ[ÉhÇmÇn = :ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇOÇOÇT   
004690          AND   SUBSTR ( ÉRÅ[Éh,1,2 )                             
004700		                 = :ÇlÇSÇOÅ|å⁄ãqãÊï™                    
004710     END-EXEC.                                                    
004720*                                                                 
004730     EVALUATE  SQLCODE                                            
004740        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
004750*--<       ê≥èÌ >                                                 
004760           CONTINUE                                               
004770        WHEN  OTHER                                               
004780*--<       ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
004790           MOVE      SPACE            TO  ÇvÇrÅ|ñºèÃÇQ            
004800           MOVE -200                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
004810           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004820     END-EVALUATE.                                                
004830*                                                                 
004840 å⁄ãqãÊï™ñºèÃÅ|ÇdÇwÇhÇs.                                          
004850     EXIT.                                                        
004860******************************************************************
004870*     ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù                      
004880******************************************************************
004890 ç¬å†èÓïÒÇÃíäèoèàóù                     SECTION.                  
004900 ç¬å†èÓïÒÇÃíäèoèàóùÅ[ÇrÇsÇ`ÇqÇs.                                  
004910     EXEC SQL                                                     
004920        SELECT  èÛë‘ÉtÉâÉO,ç¬å†å_ñÒåèñº,íSï€ãÊï™                  
004930          INTO :ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO,                               
004940                ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº,                             
004950                ÇlÇOÇPÅ|íSï€ãÊï™                                  
004960          FROM  M01SAJ_TBL,M40MAB_TBL                             
004970          WHERE M01SAJ_TBL.ÉåÉRÅ[ÉhãÊï™	= '1'	                
004980          AND   M01SAJ_TBL.å_ñÒî‘çÜ =  :ÇlÇSÇOÅ|å_ñÒî‘çÜ	        
004990          AND   M01SAJ_TBL.çƒÉäÅ[ÉXâÒêî                           
005000                               = :ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî            
005010          AND   M01SAJ_TBL.å_ñÒéÌóﬁ = :ÇlÇSÇOÅ|å_ñÒéÌóﬁ	        
005020     END-EXEC.                                                    
005030     EVALUATE  SQLCODE                                            
005040        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
005050*--<       ê≥èÌ >                                                 
005060           CONTINUE                                               
005070        WHEN  OTHER                                               
005080           MOVE     ZERO              TO  ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO      
005090           MOVE     SPACE             TO  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº    
005100           MOVE     ZERO              TO  ÇlÇOÇPÅ|íSï€ãÊï™        
005110           MOVE -300                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
005120           PERFORM ÉGÉâÅ[îªíËèàóù                                 
005130     END-EVALUATE.                                                
005140 ç¬å†èÓïÒÇÃíäèoèàóùÅ|ÇdÇwÇhÇs.                                    
005150     EXIT.                                                        
005160******************************************************************
005170*     ï“èWèoóÕèàóù                                               *
005180******************************************************************
005190 ï“èWèoóÕèàóù                         SECTION.                    
005200 ï“èWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                        
005210*                                                                 
005220         PERFORM ëºé–ï™çÄñ⁄ï“èWèàóù                               
005230         PERFORM èoóÕèàóù                                         
005240     IF  ÇlÇOÇPÅ|ã¶í≤ãÊï™  = '2'                                  
005250	       PERFORM é©é–ï™çÄñ⁄ï“èWèàóù                               
005260         PERFORM èoóÕèàóù                                         
005270     END-IF.                                                      
005280 ï“èWèoóÕèàóùÅ|ÇdÇwÇhÇs.                                          
005290     EXIT.                                                        
005300*                                                                 
005310*----------------------------------------------------------------*
005320*       èâä˙âªèàóù                                               *
005330*----------------------------------------------------------------*
005340*                                                                 
005350*----------------------------------------------------------------*
005360*       é©é–ï™çÄñ⁄ï“èWèàóù                                       *
005370*----------------------------------------------------------------*
005380 é©é–ï™çÄñ⁄ï“èWèàóù               SECTION.                        
005390 é©é–ï™çÄñ⁄ï“èWèàóùÅ|ÇrÇsÇ`ÇqÇs.                                  
005400                                                                  
005410*--<    No.01 >                                                   
005420        IF    ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO < 3                              
005430        MOVE  3 TO  èoóÕÅ|é©ëºé–ãÊï™                              
005440        ELSE                                                      
005450	      MOVE 1 TO èoóÕÅ|é©ëºé–ãÊï™                                
005460        END-IF.                                                   
005470*--<    No.02 >                                                   
005480        MOVE  ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™  TO  èoóÕÅ|ëOéÛãÊï™.           
005490                                                                  
005500*--<    No.03 >                                                   
005510        MOVE  ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™     TO  èoóÕÅ|éÂå_ñÒãÊï™.  
005520*                                                                 
005530*--<    No.04 >                                                   
005540        MOVE  ÇlÇSÇOÅ|å⁄ãqãÊï™          TO  èoóÕÅ|òAåããÊï™.       
005550*                                                                 
005560*--<    No.05 >                                                   
005570        MOVE  ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh      TO  èoóÕÅ|ñºäÒÇπÉRÅ[Éh.   
005580*                                                                 
005590*--<    No.06 >                                                   
005600        MOVE  ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh                          
005610                                      TO  èoóÕÅ|éÊà¯êÊÉRÅ[Éh.     
005620*                                                                 
005630*--<    No.07 >                                                   
005640        MOVE  ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh      TO  èoóÕÅ|êøãÅêÊÉRÅ[Éh.   
005650*                                                                 
005660*--<    No.08 >                                                   
005670        MOVE  ÇlÇSÇOÅ|å_ñÒî‘çÜ        TO  èoóÕÅ|å_ñÒî‘çÜ.         
005680*                                                                 
005690*--<    No.09 >                                                   
005700        MOVE  ÇlÇSÇOÅ|å_ñÒéÌóﬁ    TO  èoóÕÅ|å_ñÒéÌóﬁ.             
005710*                                                                 
005720*--<    No.10 >                                                   
005730        MOVE  ÇcÇVÇOÅ|ã∆ñ±îNåé        TO  èoóÕÅ|ã∆ñ±îNåé.         
005740*                                                                 
005750*--<    No.11 >                                                   
005760        MOVE  ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh                              
005770                               TO  èoóÕÅ|íSìñïîâ€ÉRÅ[Éh.          
005780*                                                                 
005790*--<    No.12 >                                                   
005800        MOVE  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº     TO  èoóÕÅ|å_ñÒåèñº.        
005810*                                                                 
005820*--<    No.13 >                                                   
005830        MOVE  ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî      TO  èoóÕÅ|çƒÉäÅ[ÉXâÒêî.   
005840*                                                                 
005850*--<    No.14 >                                                   
005860        MOVE  ÇlÇSÇOÅ|è[ìñäJénîNåé        TO  èoóÕÅ|è[ìñäJénîNåé. 
005870*                                                                 
005880*--<    No.15 >                                                   
005890        MOVE  ÇlÇSÇOÅ|è[ìñåéêî        TO  èoóÕÅ|è[ìñåéêî.         
005900*                                                                 
005910*--<    No.16 >                                                   
005920        MOVE  ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@       TO  èoóÕÅ|ëOï•âÒé˚ï˚ñ@.  
005930*                                                                 
005940*--<    No.17 >                                                   
005950        MOVE  ÇlÇSÇOÅ|ì¸ã‡ì˙              TO  èoóÕÅ|ì¸ã‡ì˙.       
005960*                                                                 
005970*--<    No.18 >                                                   
005980        MOVE  ÇlÇSÇOÅ|ì¸ã‡ãÊï™              TO  èoóÕÅ|ì¸ã‡ãÊï™.   
005990*                                                                 
006000*--<    No.19 >                                                   
006010        MOVE  ÇcÇOÇPÅ|éÊà¯êÊñºèÃ        TO  èoóÕÅ|éÊà¯êÊñºèÃ.     
006020*                                                                 
006030*--<    No.20 >                                                   
006040        MOVE  ÇcÇOÇQÅ|êøãÅêÊñºèÃ        TO  èoóÕÅ|êøãÅêÊñºèÃ.     
006050*                                                                 
006060*--<    No.21 >                                                   
006070        MOVE  ÇvÇrÅ|ñºèÃÇP             TO  èoóÕÅ|éÂå_ñÒãÊï™ñºèÃ.  
006080*                                                                 
006090*--<    No.22 >                                                   
006100        MOVE  ÇvÇrÅ|ñºèÃÇQ              TO  èoóÕÅ|òAåããÊï™ñºèÃ.   
006110*                                                                 
006120*--<    No.23 >                                                   
006130        MOVE  ÇlÇSÇOÅ|ëOåéññécçÇ          TO  èoóÕÅ|ëOåéññécçÇ.   
006140*                                                                 
006150*--<    No.24 >                                                   
006160        MOVE  ÇlÇSÇOÅ|ìñåéâÒé˚äz        TO  èoóÕÅ|ìñåéì¸ã‡äz.     
006170*                                                                 
006180*--<    No.25 >                                                   
006190        MOVE  ÇlÇSÇOÅ|ìñåéè¡âªäz        TO  èoóÕÅ|ìñåéè¡âªäz.     
006200*                                                                 
006210*--<    No.26 >                                                   
006220        MOVE  ÇlÇSÇOÅ|ìñåéññécçÇ          TO  èoóÕÅ|ìñåéññécçÇ.   
006230 é©é–ï™çÄñ⁄ï“èWèàóùÅ|ÇdÇwÇhÇs.                                    
006240     EXIT.                                                        
006250*                                                                 
006260*----------------------------------------------------------------*
006270*       ëºé–ï™çÄñ⁄ï“èWèàóù                                       *
006280*----------------------------------------------------------------*
006290 ëºé–ï™çÄñ⁄ï“èWèàóù               SECTION.                        
006300 ëºé–ï™çÄñ⁄ï“èWèàóùÅ|ÇrÇsÇ`ÇqÇs.                                  
006310*--<    No.01 >                                                   
006320        IF   ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO < '3'                             
006330        MOVE '4' TO  èoóÕÅ|é©ëºé–ãÊï™                             
006340        ELSE                                                      
006350	      MOVE '2' TO èoóÕÅ|é©ëºé–ãÊï™                              
006360        END-IF.                                                   
006370*                                                                 
006380*--<    No.02 >                                                   
006390        MOVE  ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™  TO  èoóÕÅ|ëOéÛãÊï™.           
006400                                                                  
006410*--<    No.03 >                                                   
006420        MOVE  ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™     TO  èoóÕÅ|éÂå_ñÒãÊï™.  
006430*                                                                 
006440*--<    No.04 >                                                   
006450        MOVE  ÇlÇSÇOÅ|å⁄ãqãÊï™          TO  èoóÕÅ|òAåããÊï™.       
006460*                                                                 
006470*--<    No.05 >                                                   
006480        MOVE  ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh      TO  èoóÕÅ|ñºäÒÇπÉRÅ[Éh.   
006490*                                                                 
006500*--<    No.06 >                                                   
006510        MOVE  ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh                          
006520                                     TO  èoóÕÅ|éÊà¯êÊÉRÅ[Éh.      
006530*                                                                 
006540*--<    No.07 >                                                   
006550        MOVE  ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh      TO  èoóÕÅ|êøãÅêÊÉRÅ[Éh.   
006560*                                                                 
006570*--<    No.08 >                                                   
006580        MOVE  ÇlÇSÇOÅ|å_ñÒî‘çÜ        TO  èoóÕÅ|å_ñÒî‘çÜ.         
006590*                                                                 
006600*--<    No.09 >                                                   
006610        MOVE  ÇlÇSÇOÅ|å_ñÒéÌóﬁ    TO  èoóÕÅ|å_ñÒéÌóﬁ.             
006620*                                                                 
006630*--<    No.10 >                                                   
006640        MOVE  ÇcÇVÇOÅ|ã∆ñ±îNåé        TO  èoóÕÅ|ã∆ñ±îNåé.         
006650*                                                                 
006660*--<    No.11 >                                                   
006670        MOVE  ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh                              
006680                                  TO  èoóÕÅ|íSìñïîâ€ÉRÅ[Éh.       
006690*                                                                 
006700*--<    No.12 >                                                   
006710        MOVE  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº      TO  èoóÕÅ|å_ñÒåèñº.       
006720*                                                                 
006730*--<    No.13 >                                                   
006740        MOVE  ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî      TO  èoóÕÅ|çƒÉäÅ[ÉXâÒêî.   
006750*                                                                 
006760*--<    No.14 >                                                   
006770        MOVE  ÇlÇSÇOÅ|è[ìñäJénîNåé     TO  èoóÕÅ|è[ìñäJénîNåé.    
006780*                                                                 
006790*--<    No.15 >                                                   
006800        MOVE  ÇlÇSÇOÅ|è[ìñåéêî        TO  èoóÕÅ|è[ìñåéêî.         
006810*                                                                 
006820*--<    No.16 >                                                   
006830        MOVE  ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@     TO  èoóÕÅ|ëOï•âÒé˚ï˚ñ@.    
006840*                                                                 
006850*--<    No.17 >                                                   
006860        MOVE  ÇlÇSÇOÅ|ì¸ã‡ì˙         TO  èoóÕÅ|ì¸ã‡ì˙.            
006870*                                                                 
006880*--<    No.18 >                                                   
006890        MOVE  ÇlÇSÇOÅ|ì¸ã‡ãÊï™       TO  èoóÕÅ|ì¸ã‡ãÊï™.          
006900*                                                                 
006910*--<    No.19 >                                                   
006920        MOVE  ÇcÇOÇPÅ|éÊà¯êÊñºèÃ     TO  èoóÕÅ|éÊà¯êÊñºèÃ.        
006930*                                                                 
006940*--<    No.20 >                                                   
006950        MOVE  ÇcÇOÇQÅ|êøãÅêÊñºèÃ        TO  èoóÕÅ|êøãÅêÊñºèÃ.     
006960*                                                                 
006970*--<    No.21 >                                                   
006980        MOVE  ÇvÇrÅ|ñºèÃÇP          TO  èoóÕÅ|éÂå_ñÒãÊï™ñºèÃ.     
006990*                                                                 
007000*--<    No.22 >                                                   
007010        MOVE  ÇvÇrÅ|ñºèÃÇQ              TO  èoóÕÅ|òAåããÊï™ñºèÃ.   
007020*                                                                 
007030*--<    No.23 >                                                   
007040        MOVE  ÇlÇSÇOÅ|ëOåéññécçÇëºé–   TO  èoóÕÅ|ëOåéññécçÇ.      
007050*                                                                 
007060*--<    No.24 >                                                   
007070        MOVE  ÇlÇSÇOÅ|ìñåéâÒé˚äzëºé–    TO  èoóÕÅ|ìñåéì¸ã‡äz.     
007080*                                                                 
007090*--<    No.25 >                                                   
007100        COMPUTE   ÇvÅ|ìñåéè¡âªäz = ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–         
007110            + ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡                          
007120            + ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈.                       
007130         MOVE ÇvÅ|ìñåéè¡âªäz        TO  èoóÕÅ|ìñåéè¡âªäz.         
007140*                                                                 
007150*--<    No.26 >                                                   
007160        COMPUTE  ÇvÅ|ìñåéññécçÇ = ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–          
007170                -  ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡                     
007180		      -  ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈.                  
007190	      MOVE ÇvÅ|ìñåéññécçÇ	TO  èoóÕÅ|ìñåéññécçÇ.           
007200 ëºé–ï™çÄñ⁄ï“èWèàóùÅ|ÇdÇwÇhÇs.                                    
007210     EXIT.                                                        
007220*                                                                 
007230*                                                                 
007240******************************************************************
007250*    èoóÕèàóù                                                    *
007260******************************************************************
007270 èoóÕèàóù                             SECTION.                    
007280 èoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
007290         IF  èoóÕÅ|ëOåéññécçÇ = ZERO                              
007300	       AND èoóÕÅ|ìñåéì¸ã‡äz = ZERO                              
007310         AND èoóÕÅ|ìñåéè¡âªäz = ZERO                              
007320	       AND èoóÕÅ|ìñåéññécçÇ = ZERO                              
007330            CONTINUE                                              
007340         ELSE                                                     
007350            WRITE  èoóÕÅ|ÉåÉRÅ[Éh.                                
007360*                                                                 
007370*----------------------------------------------------------------*
007380*    í«â¡èàóùÇämîF                                              *
007390*----------------------------------------------------------------*
007400     EVALUATE  ÇvÅ|èÛë‘                                           
007410        WHEN   ZERO                                               
007420*--<       í«â¡ê¨å˜ >                                             
007430           COMPUTE  ÇvÅ|èoóÕÅ|åèêî  =  ÇvÅ|èoóÕÅ|åèêî  +  1       
007440        WHEN   OTHER                                              
007450*--<       í«â¡èàóùÉGÉâÅ[ >                                       
007460           MOVE     -40               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
007470           PERFORM  ÉGÉâÅ[îªíËèàóù                                
007480     END-EVALUATE.                                                
007490*                                                                 
007500 èoóÕèàóùÅ|ÇdÇwÇhÇs.                                              
007510     EXIT.                                                        
007520******************************************************************
007530*    èIóπèàóù                                                    *
007540******************************************************************
007550 èIóπèàóù                             SECTION.                    
007560 èIóπèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
007570*                                                                 
007580     PERFORM  ÇcÇaÉNÉçÅ[ÉYèàóù.                                   
007590*                                                                 
007600     PERFORM  ÇcÇaÉRÉ~ÉbÉgèàóù.                                   
007610*                                                                 
007620     PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ.                                 
007630*                                                                 
007640*--< ÉvÉçÉOÉâÉÄê≥èÌèIóπ >                                         
007650     MOVE  íËêîÅ|ê≥èÌèÛë‘             TO  PROGRAM-STATUS.         
007660*                                                                 
007670 èIóπèàóùÅ|ÇdÇwÇhÇs.                                              
007680     EXIT.                                                        
007690******************************************************************
007700*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
007710******************************************************************
007720 èIóπÉÅÉbÉZÅ[ÉWèoóÕ                   SECTION.                    
007730 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
007740*                                                                 
007750*----------------------------------------------------------------*
007760*    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
007770*----------------------------------------------------------------*
007780*----------------------------------------------------------------*
007790*    ëOéÛèÓïÒÅiåãçáÅjÇcÇaì¸óÕåèêî                                *
007800*----------------------------------------------------------------*
007810     INITIALIZE                       IF-CHOCO001.                
007820     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007830     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007840     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007850     MOVE  "M40MAB"                   TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007860     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007870     MOVE  ÇvÅ|ì¸óÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007880     MOVE  "ëOéÛèÓïÒÉeÅ[ÉuÉãÅiì¸óÕÅj" TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007890     CALL  CLOCO001                USING  IF-CHOCO001.            
007900                                                                  
007910*----------------------------------------------------------------*
007920*    ëOéÛã‡éÛï•écçÇíÜä‘ÇeèoóÕåèêî                                *
007930*----------------------------------------------------------------*
007940     INITIALIZE                       IF-CHOCO001.                
007950     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007960     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007970     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007980     MOVE  "SFHSED25"                 TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007990     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
008000     MOVE  ÇvÅ|èoóÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
008010     MOVE  "ëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉã"   TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008020     CALL  CLOCO001                USING  IF-CHOCO001.            
008030*----------------------------------------------------------------*
008040*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
008050*----------------------------------------------------------------*
008060     INITIALIZE                       IF-CHOCO001.                
008070     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
008080     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
008090     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
008100     MOVE  "END"                      TO  ã§ÇPÅ|èàóùéØï .         
008110     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008120     CALL  CLOCO001                USING  IF-CHOCO001.            
008130*                                                                 
008140 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
008150     EXIT.                                                        
008160******************************************************************
008170*    ÇcÇaÉNÉçÅ[ÉY                                                *
008180******************************************************************
008190 ÇcÇaÉNÉçÅ[ÉYèàóù                     SECTION.                    
008200 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
008210*                                                                 
008220*--< ÉJÅ[É\Éã ÉNÉçÅ[ÉY >                                          
008230     EXEC SQL                                                     
008240        CLOSE  CUR1                                               
008250     END-EXEC.                                                    
008260*                                                                 
008270 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇdÇwÇhÇs.                                      
008280     EXIT.                                                        
008290******************************************************************
008300*    ÇcÇaÉRÉ~ÉbÉgèàóù                                            *
008310******************************************************************
008320 ÇcÇaÉRÉ~ÉbÉgèàóù                     SECTION.                    
008330 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
008340*                                                                 
008350     EXEC  SQL                                                    
008360        COMMIT  WORK  RELEASE                                     
008370     END-EXEC.                                                    
008380*                                                                 
008390     INITIALIZE                       IF-CHOCO001.                
008400     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
008410     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
008420     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
008430     MOVE  "COMMIT"                   TO  ã§ÇPÅ|èàóùéØï .         
008440     MOVE  "ÉRÉ~ÉbÉgé¿é{"             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008450     CALL  CLOCO001                USING  IF-CHOCO001.            
008460*                                                                 
008470 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇdÇwÇhÇs.                                      
008480     EXIT.                                                        
008490******************************************************************
008500*    ÉGÉâÅ[èàóù                                                  *
008510******************************************************************
008520 ÉGÉâÅ[îªíËèàóù                       SECTION.                    
008530 ÉGÉâÅ[îªíËèàóùÅ|ÇrÇsÇ`ÇqÇs.                                      
008540*                                                                 
008550     MOVE  "Y"                        TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO.    
008560     INITIALIZE                           IF-CHOCO001.            
008570*                                                                 
008580     EVALUATE  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh                                   
008590        WHEN  -10                                                 
008600*--<       ÇnÇqÇ`ÇbÇkÇdê⁄ë±é∏îs >                                 
008610           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008620           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008630           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008640           MOVE  "CONNECT"            TO  ã§ÇPÅ|èàóùéØï           
008650           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008660           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008670           CALL  CLOCO001          USING  IF-CHOCO001             
008680*                                                                 
008690        WHEN  -20                                                 
008700*--<       åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãÉIÅ[ÉvÉìé∏îs >                     
008710           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008720           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008730           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008740           MOVE  "M40MAB"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008750           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008760           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008770           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008780           CALL  CLOCO001          USING  IF-CHOCO001             
008790*                                                                 
008800        WHEN  -30                                                 
008810*--<       åãçáÉeÅ[ÉuÉãì«çûé∏îs >                                 
008820           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008830           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008840           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008850           MOVE  "M40MAB"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008860           MOVE  "FETCH"              TO  ã§ÇPÅ|èàóùéØï           
008870           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008880           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008890           CALL  CLOCO001          USING  IF-CHOCO001             
008900*                                                                 
008910        WHEN  -100                                                
008920*--<       ÉoÉbÉ`ópã∆ñ±îNåéé∏îs >                                 
008930           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008940           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008950           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008960           MOVE  "D70GYM"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008970           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008980           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008990           MOVE  "ÉoÉbÉ`ópã∆ñ±îNåéé∏îs"                           
009000                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009010           CALL  CLOCO001          USING  IF-CHOCO001             
009020        WHEN  -200                                                
009030*--<       çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒ(å⁄ãq)ãÊï™ñºèÃÇÃíäèoé∏îs >     
009040           MOVE  "2"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009050           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009060           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009070           MOVE  "D19MSY"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009080           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
009090           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009100           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009110           CALL  CLOCO001          USING  IF-CHOCO001             
009120           MOVE  "N"                  TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO    
009130*                                                                 
009140        WHEN  -300                                                
009150*--<       ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoé∏îs >               
009160           MOVE  "2"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009170           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009180           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009190           MOVE  "M01SAJ"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009200           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
009210           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009220           MOVE  "çÄñ⁄ÇÃíäèoé∏îs"                                 
009230                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009240           CALL  CLOCO001          USING  IF-CHOCO001             
009250           MOVE  "N"                  TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO    
009260        WHEN  OTHER                                               
009270           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
009280     END-EVALUATE.                                                
009290*                                                                 
009300     IF ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO  =  "Y"                              
009310*                                                                 
009320        PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ                               
009330*                                                                 
009340*--<    ÉvÉçÉOÉâÉÄàŸèÌèIóπÇÃÉäÉ^Å[ÉìÉRÅ[Éh >                      
009350        MOVE  íËêîÅ|àŸèÌèÛë‘          TO  PROGRAM-STATUS          
009360*                                                                 
009370        EXIT  PROGRAM                                             
009380     END-IF.                                                      
009390*                                                                 
009400 ÉGÉâÅ[èàóùÅ|ÇdÇwÇhÇs.                                            
009410     EXIT.                                                        
009420******************************************************************
009430*                  END OF PROGRAM                                *
009440******************************************************************
