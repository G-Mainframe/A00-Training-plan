000010******************************************************************
000020*         ÅÉäCãPìÓåè(ëÂòA)ÅÑ                                     *
000030*      1. ÉvÉçÉOÉâÉÄñº  : ëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉãçÏê¨             *
000040*      2. ÉvÉçÉOÉâÉÄID  : AAASED25                               *
000050*      3. èàóùäTóv      :åoóùí˜èàóùÅií†ï[çÏê¨Åj                  *
000060*                         (ÉäÅ[ÉXëOéÛä÷òAí†ï[íäèoÅj              *
000080*                                                                *
000090*      4. çÏê¨é“        : äsêVè‡                                 *
000100*      5. çÏê¨ì˙        : 2005.03.26                             *
000110******************************************************************
000120*                                                                 
000130******************************************************************
000140*    ÇhÇcÇdÇmÇsÇhÇeÇhÇbÇ`ÇsÇhÇnÇm  ÇcÇhÇuÇhÇrÇhÇnÇm              *
000150******************************************************************
000160 IDENTIFICATION                       DIVISION.                   
000170*                                                                 
000180 PROGRAM-ID.                          AAASED25.                   
000190******************************************************************
000200*    ÇdÇmÇuÇhÇqÇnÇmÇlÇdÇmÇs        ÇcÇhÇuÇhÇrÇhÇnÇm              *
000210******************************************************************
000220 ENVIRONMENT                          DIVISION.                   
000230*    ÇhÇmÇoÇtÇsÅ|ÇnÇtÇsÇoÇtÇs      ÇrÇdÇbÇsÇhÇnÇm                *
000240******************************************************************
000250 INPUT-OUTPUT                         SECTION.                    
000260 FILE-CONTROL.                                                    
000270*                                                                 
000280     SELECT         èoóÕÉtÉ@ÉCÉã      ASSIGN    TO   U11          
000290     FILE STATUS    IS                ÇvÅ|èÛë‘                    
000300     ORGANIZATION   IS     LINE       SEQUENTIAL.                 
000310*                                                                 
000320******************************************************************
000330*    ÇcÇ`ÇsÇ`                      ÇcÇhÇuÇhÇrÇhÇnÇm              *
000340******************************************************************
000350 DATA                                 DIVISION.                   
000360******************************************************************
000370*    ÇeÇhÇkÇd                      ÇrÇdÇbÇsÇhÇnÇm                *
000380******************************************************************
000390 FILE                                 SECTION.                    
000400*----------------------------------------------------------------*
000410*    èoóÕÉtÉ@ÉCÉã                                                *
000420*----------------------------------------------------------------*
000430 FD  èoóÕÉtÉ@ÉCÉã                                                 
000440     LABEL  RECORD    IS              STANDARD                    
000450     BLOCK  CONTAINS  0               RECORDS.                    
000460*                                                                 
000470 01  èoóÕÅ|ÉåÉRÅ[Éh.                                              
000480     COPY   CPSCE50   REPLACING      ==()==  BY  ==èoóÕÅ|==.      
000490*                                                                 
000500******************************************************************
000510*  ÇvÇnÇqÇjÇhÇmÇfÅ|ÇrÇsÇnÇqÇ`ÇfÇd  ÇrÇdÇbÇsÇhÇnÇm                *
000520******************************************************************
000530  WORKING-STORAGE                     SECTION.                    
000540*----------------------------------------------------------------*
000550*    ÉzÉXÉgïœêîíËã`ÉGÉäÉA                                        *
000560*----------------------------------------------------------------*
000570     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
000580 01  ÇvÇrÅ|ñºèÃÇP                       PIC  X(60).               
000590 01  ÇvÇrÅ|ñºèÃÇQ                       PIC  X(60).               
000600 01  ÇvÇrÅ|ã∆ñ±ä«óùÇhÇc                 PIC  X(8).                
000610 01  ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇOÇRÇW             PIC  X(012)  VALUE  '038'.
000620 01  ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇOÇOÇT             PIC  X(012)  VALUE  '005'.
000630*                                                                 
000640*--< ÇnÇqÇ`ÇbÇkÇdã§í ïœêî >                                       
000650     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
000660*                                                                 
000670*--< ÇnÇqÇ`ÇbÇkÇd  ÇrÇpÇké¿çsèÓïÒ >                               
000680     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
000690*                                                                 
000700*--< ëOéÛèÓïÒÇcÇa >                                               
000710     EXEC  SQL  INCLUDE  M40MAB.CBL           END-EXEC.           
000720*                                                                 
000730*--< ã∆ñ±ä«óùÉeÅ[ÉuÉã >                                           
000740     EXEC  SQL  INCLUDE  D70GYM.CBL           END-EXEC.           
000750*                                                                 
000760*--< éÊà¯êÊÉ}ÉXÉ^>                                                
000770     EXEC  SQL  INCLUDE  D01TRS.CBL            END-EXEC.          
000780*                                                                 
000790*--< êøãÅêÊÉ}ÉXÉ^>                                                
000800     EXEC  SQL  INCLUDE  D02SQS.CBL            END-EXEC.          
000810*                                                                 
000820*--< çÄñ⁄ñºèÃÉ}ÉXÉ^>                                              
000830     EXEC  SQL  INCLUDE  D19MSY.CBL           END-EXEC.           
000840*                                                                 
000850*--< ç¬å†èÓïÒÅiàÍî ÅjÇc>                                          
000860     EXEC  SQL  INCLUDE  M01SAJ.CBL            END-EXEC.          
000870*                                                                 
000880     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
000890*                                                                 
000900*----------------------------------------------------------------*
000910*    ÇvÇnÇqÇjÉGÉäÉA                                              *
000920*----------------------------------------------------------------*
000930 01  ÇvÇnÇqÇjÅ|ÉGÉäÉA.                                            
000940     03 ÇvÅ|ìñåéè¡âªäz              PIC S9(13).                   
000950	   03 ÇvÅ|ìñåéññécçÇ              PIC S9(13).                   
000960*                                                                 
000970*--< ÉtÉ@ÉCÉãèÛë‘ >                                               
000980     03  ÇvÅ|èÛë‘ÉGÉäÉA.                                          
000990         05  ÇvÅ|èÛë‘                 PIC  X(02).                 
001000*                                                                 
001010*--< ÉGÉâÅ[ÉRÅ[Éh >                                               
001020     03  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             PIC S9(03).                 
001030*                                                                 
001040*--< ÉtÉ@ÉCÉãèÛë‘ >                                               
001050     03  ÉtÉ@ÉCÉãèÛë‘                 PIC  X(02).                 
001060*                                                                 
001070*--< ÉtÉâÉOÉAÉäÉA >                                               
001080     03  ÉtÉâÉOÉAÉäÉA.                                            
001090         05  ÇvÅ|èIóπÅ|ÉtÉâÉO         PIC  X(01).                 
001100         05  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     PIC  X(01).                 
001110*                                                                 
001130*--< åèêîÉGÉäÉA >                                                 
001140     03  åèêîÉGÉäÉA.                                              
001150         05  ÇvÅ|ì¸óÕÅ|åèêî           PIC  9(09).                 
001160         05  ÇvÅ|èoóÕÅ|åèêî           PIC  9(09).                 
001170*                                                                 
001410*----------------------------------------------------------------*
001420*    ÉTÉuÉãÅ[É`Éìñº                                              *
001430*----------------------------------------------------------------*
001440 01  CALL-AREA.                                                   
001450*--< ã§í ÉçÉOÉTÉuÉãÅ[É`Éì >                                       
001460     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001470     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001480*                                                                 
001490*----------------------------------------------------------------*
001500*    ÇbÇnÇoÇxóÃàÊ                                                *
001510*----------------------------------------------------------------*
001520*--< ã§í ÉçÉOópÉpÉâÉÅÅ[É^ >                                       
001530 01  IF-CHOCO001.                                                 
001540     COPY  CHOCO001  REPLACING  ==()==  BY  ==ã§ÇPÅ|==.           
001550*                                                                 
001560*----------------------------------------------------------------*
001570*    ÇhÇmÇhÉtÉ@ÉCÉãì«çûÉTÉuÉãÅ[É`ÉìópÉpÉâÉÅÉ^óÃàÊ                *
001580*----------------------------------------------------------------*
001590 01  PARA-AREA.                                                   
001600     COPY CPBCO001.                                               
001610******************************************************************
001620*    íËêîópÉfÅ[É^íËã`ÉGÉäÉA                                      *
001630******************************************************************
001640 CONSTANT                             SECTION.                    
001650 01  íËêîóÃàÊ.                                                    
001660     03  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc         PIC  X(08) VALUE "AAASED25".  
001670     03  íËêîÅ|ÉvÉçÉOÉâÉÄñº           PIC  X(80)                  
001680                         VALUE  "ëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉãçÏê¨".     
001690     03  íËêîÅ|ÇrÇpÇkÇnÇj             PIC S9(04)  VALUE  ZERO.    
001700     03  íËêîÅ|ÇrÇpÇkÇdÇmÇc           PIC S9(04)  VALUE  0100.    
001710     03  íËêîÅ|ê≥èÌèÛë‘               PIC S9(04)  VALUE  ZERO.    
001720     03  íËêîÅ|àŸèÌèÛë‘               PIC S9(04)  VALUE  0009.    
001730******************************************************************
001740*    ÇoÇqÇnÇbÇdÇcÇtÇqÇd            ÇcÇhÇuÇhÇrÇhÇnÇm              *
001750******************************************************************
001760 PROCEDURE                            DIVISION.                   
001770*                                                                 
001780     PERFORM  èâä˙èàóù.                                           
001790*                                                                 
001800     PERFORM  éÂèàóù  UNTIL  ÇvÅ|èIóπÅ|ÉtÉâÉO  =  "Y".            
001810*                                                                 
001820     PERFORM  èIóπèàóù.                                           
001830*                                                                 
001840     STOP     RUN.                                                
001850*                                                                 
001860******************************************************************
001870*    èâä˙èàóù                                                    *
001880******************************************************************
001890 èâä˙èàóù                             SECTION.                    
001900 èâä˙èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
001910*                                                                 
001920*----------------------------------------------------------------*
001930*    äJénÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
001940*----------------------------------------------------------------*
001950     INITIALIZE                       IF-CHOCO001.                
001960     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
001970     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
001980     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
001990     MOVE  "START"                    TO  ã§ÇPÅ|èàóùéØï .         
002000     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
002010     CALL  CLOCO001                USING  IF-CHOCO001.            
002020*----------------------------------------------------------------*
002040*    çÏã∆óÃàÊÇÃèâä˙ílèàóù                                        *
002050*----------------------------------------------------------------*
002060     MOVE  SPACE                      TO  ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
002070     INITIALIZE                           ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
002160*                                                                 
002170*----------------------------------------------------------------*
002180*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
002190*----------------------------------------------------------------*
002200*--< ÇnÇqÇ`ÇbÇkÇdê⁄ë± >                                           
002210     PERFORM   ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                                  
002220*                                                                 
      *--< ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû >
           PERFORM   ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû.
      *--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉì >
001890     PERFORM  ÉtÉ@ÉCÉãÉIÅ[ÉvÉì.                                   

002230*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã` >                                   
002240     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`.                           
002250*                                                                 
002260*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû(ÇPåèñ⁄) >                           
002270     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
002280*                                                                 
002290 èâä˙èàóùÅ|ÇdÇwÇhÇs.                                              
002300     EXIT.                                                        
002310******************************************************************
002320*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
002330******************************************************************
002340 ÇnÇqÇ`ÇbÇkÇdê⁄ë±                     SECTION.                    
002350 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇrÇsÇ`ÇqÇs.                                    
002360*                                                                 
002370*--< ÇcÇaê⁄ë±ópèÓïÒÇéÊìæèàóù >                                   
002380     CALL  COBCO001                USING  PARA-AREA.              
002390*                                                                 
002400     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002410     MOVE  PARA-USERNAME              TO  USERNAME.               
002420     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002430*                                                                 
002440*----------------------------------------------------------------*
002450*    äJénê⁄ë±                                                    *
002460*----------------------------------------------------------------*
002470     IF    DB-STRING  =  SPACE                                    
002480        EXEC SQL                                                  
002490           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002500        END-EXEC                                                  
002510     ELSE                                                         
002520        EXEC SQL                                                  
002530           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002540             USING  :DB-STRING                                    
002550        END-EXEC                                                  
002560     END-IF.                                                      
002570*                                                                 
002580*----------------------------------------------------------------*
002590*    ê⁄ë±ämîF                                                    *
002600*----------------------------------------------------------------*
002610     EVALUATE  SQLCODE                                            
002620        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002630           CONTINUE                                               
002640        WHEN   OTHER                                              
002650*--<       ê⁄ë±ÉGÉâÅ[ >                                           
002660           MOVE     -10               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002670           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002680     END-EVALUATE.                                                
002690*                                                                 
002850 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇdÇwÇhÇs.                                      
002860     EXIT.                                                        
002870*                                                                 
002310******************************************************************
002320*    ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû                                            *
002330******************************************************************
       ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû             SECTION.                    
002930 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇrÇsÇ`ÇqÇs.
002710     EXEC SQL                                                     
002720        SELECT  ÉoÉbÉ`ópã∆ñ±îNåé                                  
002730          INTO :ÇcÇVÇOÅ|ã∆ñ±îNåé                                  
002740          FROM  D70GYM_TBL                                        
002750          WHERE  D70GYM_TBL.ã∆ñ±ä«óùÇhÇc =  :ÇvÇrÅ|ã∆ñ±ä«óùÇhÇc   
002760     END-EXEC.                                                    
002770     EVALUATE  SQLCODE                                            
002780        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
002790*--<       ê≥èÌ >                                                 
002800           CONTINUE                                               
002810        WHEN  OTHER                                               
002820           MOVE -100                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
002830           PERFORM ÉGÉâÅ[îªíËèàóù                                 
002840      END-EVALUATE.
003570 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇdÇwÇhÇs.                              
003580     EXIT.
003880******************************************************************
003890*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉìèàóù                                <1.6>   *
003900******************************************************************
003910 ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                     SECTION.                    
003920 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇrÇsÇ`ÇqÇs.                                    
003930*                                                                 
003940     OPEN  OUTPUT  èoóÕÉtÉ@ÉCÉã.                                  
003950*----------------------------------------------------------------*
003960*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉìämîF                                        *
003970*----------------------------------------------------------------*
003980     EVALUATE  ÇvÅ|èÛë‘                                           
003990        WHEN  ZERO                                                
004000*--<       ê≥èÌ >                                                 
004010           CONTINUE                                               
004020        WHEN  OTHER                                               
004030*--<       ÉtÉ@ÉCÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
004040           MOVE     -40               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004050           PERFORM  ÉGÉâÅ[èàóù                                    
004060     END-EVALUATE.                                                
004070 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇdÇwÇhÇs.                                      
004080     EXIT.            
002890******************************************************************
002900*        åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`                                *
002910******************************************************************
002920 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`             SECTION.                    
002930 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇrÇsÇ`ÇqÇs.                            
002940*                                                                 
002950*----------------------------------------------------------------*
002960*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
002970*----------------------------------------------------------------*
002980     EXEC SQL                                                     
002990        DECLARE CUR1  CURSOR FOR                                  
003000           SELECT 						
003010                  M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™			        
003020                 ,M40MAB_TBL.åoóùópéÂå_ñÒãÊï™			
003030                 ,M40MAB_TBL.å⁄ãqãÊï™				
003040                 ,NVL(D01TRS_TBL.ñºäÒÇπÉRÅ[Éh,RPAD(' ',40,' '))   
003060                 ,M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh			
003070                 ,M40MAB_TBL.êøãÅêÊÉRÅ[Éh			        
003080                 ,M40MAB_TBL.å_ñÒî‘çÜ				
003090                 ,M40MAB_TBL.å_ñÒéÌóﬁ				
003100                 ,M40MAB_TBL.íSìñïîâ€ÉRÅ[Éh	         	
003110                 ,M40MAB_TBL.çƒÉäÅ[ÉXâÒêî			        
003120                 ,M40MAB_TBL.è[ìñäJénîNåé			        
003130                 ,M40MAB_TBL.è[ìñåéêî				
003140                 ,M40MAB_TBL.ëOï•âÒé˚ï˚ñ@	        	        
003150                 ,M40MAB_TBL.ì¸ã‡ì˙				
003160                 ,M40MAB_TBL.ì¸ã‡ãÊï™		        	
003170                 ,NVL(D01TRS_TBL.éÊà¯êÊñºèÃ,RPAD(' ',80,' '))	
003180                 ,NVL(D02SQS_TBL.êøãÅêÊñºèÃ,RPAD(' ',80,' '))	
003190                 ,M40MAB_TBL.ëOåéññécçÇ				
003200                 ,M40MAB_TBL.ìñåéâÒé˚äz				
003210                 ,M40MAB_TBL.ìñåéè¡âªäz			        
003220                 ,M40MAB_TBL.ìñåéññécçÇ                           
003230             FROM  M40MAB_TBL                                     
003240                  ,D01TRS_TBL                                     
003250                  ,D02SQS_TBL                                     
003260            WHERE  M40MAB_TBL.ëOéÛã‡éÛï•écçÇï\ëŒè€ÉtÉâÉO          
003270                                =  '1'                            
003280              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh                  
003290                                 =  D01TRS_TBL.éÊà¯êÊÉRÅ[Éh(+)    
003300              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh                  
003310                                 =  D02SQS_TBL.éÊà¯êÊÉRÅ[Éh(+)    
003320              AND  M40MAB_TBL.êøãÅêÊÉRÅ[Éh                        
003330                                 =  D02SQS_TBL.êøãÅêÊÉRÅ[Éh(+)    
003340         ORDER BY  M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™                        
003350                  ,M40MAB_TBL.å_ñÒî‘çÜ                            
003360     END-EXEC.                                                    
003370*----------------------------------------------------------------*
003380*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
003390*----------------------------------------------------------------*
003400     EXEC  SQL                                                    
003410        OPEN  CUR1                                                
003420     END-EXEC.                                                    
003430*                                                                 
003440*----------------------------------------------------------------*
003450*    ÉJÅ[É\ÉãÇnÇoÇdÇmämîF                                        *
003460*----------------------------------------------------------------*
003470     EVALUATE  SQLCODE                                            
003480        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
003490*--<       ê≥èÌ >                                                 
003500           CONTINUE                                               
003510        WHEN  OTHER                                               
003520*--<       ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
003530           MOVE -20                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003540           PERFORM  ÉGÉâÅ[îªíËèàóù                                
003550     END-EVALUATE.                                                
003560*                                                                 
003570 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇdÇwÇhÇs.                              
003580     EXIT.                                                        
003590******************************************************************
003600*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                                    *
003610******************************************************************
003620 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû             SECTION.                    
003630 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇrÇsÇ`ÇqÇs.                            
003640*                                                                 
003650*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû >                                   
003660     EXEC SQL                                                     
003670         FETCH  CUR1                                              
003680          INTO  :ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™                             
003690               ,:ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™                         
003700               ,:ÇlÇSÇOÅ|å⁄ãqãÊï™					
003710               ,:ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh				
003720               ,:ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh			
003730               ,:ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh				
003740               ,:ÇlÇSÇOÅ|å_ñÒî‘çÜ					
003750               ,:ÇlÇSÇOÅ|å_ñÒéÌóﬁ				        
003760               ,:ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh				
003770               ,:ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî				
003780               ,:ÇlÇSÇOÅ|è[ìñäJénîNåé			        
003790               ,:ÇlÇSÇOÅ|è[ìñåéêî					
003800               ,:ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@			        
003810               ,:ÇlÇSÇOÅ|ì¸ã‡ì˙					
003820               ,:ÇlÇSÇOÅ|ì¸ã‡ãÊï™				        
003830               ,:ÇcÇOÇPÅ|éÊà¯êÊñºèÃ				
003840               ,:ÇcÇOÇQÅ|êøãÅêÊñºèÃ				
003850               ,:ÇlÇSÇOÅ|ëOåéññécçÇ				
003860               ,:ÇlÇSÇOÅ|ìñåéâÒé˚äz			        
003870               ,:ÇlÇSÇOÅ|ìñåéè¡âªäz				
003880               ,:ÇlÇSÇOÅ|ìñåéññécçÇ                               
003890     END-EXEC.                                                    
003910*----------------------------------------------------------------*
003920*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÇämîF                              *
003930*----------------------------------------------------------------*
003940     EVALUATE   SQLCODE                                           
003950        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
003960*--<       ê≥èÌ >                                                 
003970*                                                                 
003980           COMPUTE  ÇvÅ|ì¸óÕÅ|åèêî  =  ÇvÅ|ì¸óÕÅ|åèêî  +  1       
003990        WHEN   íËêîÅ|ÇrÇpÇkÇdÇmÇc                                 
004000*--<       ì«çûèIóπ >                                             
004010           MOVE  "Y"                  TO  ÇvÅ|èIóπÅ|ÉtÉâÉO        
004020        WHEN   OTHER                                              
004030*--<       ì«çûÉGÉâÅ[ >                                           
004040           MOVE     -30               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004050           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004060     END-EVALUATE.                                                
004070*                                                                 
004080 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇdÇwÇhÇs.                              
004090     EXIT.                                                        
004100******************************************************************
004110*    éÂèàóù                                                      *
004120******************************************************************
004130 éÂèàóù                               SECTION.                    
004140 éÂèàóùÅ|ÇrÇsÇ`ÇqÇs.                                              
004150     PERFORM  çÄñ⁄ñºèÃíäèoèàóù.                                   
004160                                                                  
004170     PERFORM  ç¬å†èÓïÒÇÃíäèoèàóù.                                 
004180*                                                                 
004190     IF ÇlÇOÇPÅ|íSï€ãÊï™ NOT = '1'                               
004200	      PERFORM ï“èWèoóÕèàóù                                      
004210	   .                                                            
004220*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅiÇQåèñ⁄à»ç~Åj >                     
004230     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
004240*                                                                 
004250 éÂèàóùÅ|ÇdÇwÇhÇs.                                                
004260     EXIT.                                                        
004270******************************************************************
004280*     çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù                            
004290******************************************************************
004300 çÄñ⁄ñºèÃíäèoèàóù                     SECTION.                    
004320 çÄñ⁄ñºèÃíäèoèàóùÅ[ÇrÇsÇ`ÇqÇs.                                    
004340     PERFORM éÂå_ñÒãÊï™ñºèÃÇÃíäèoèàóù.                            
004350                                                                  
004360     PERFORM å⁄ãqãÊï™ñºèÃÇÃíäèoèàóù.                              
004370                                                                  
004380 çÄñ⁄ñºèÃíäèoèàóùÅ|ÇdÇwÇhÇs.                                      
004390     EXIT.                                                        
004400******************************************************************
004410*--<çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒãÊï™ñºèÃÇÃíäèoèàóù>                   
004420 éÂå_ñÒãÊï™ñºèÃÇÃíäèoèàóù   SECTION.                              
004430                                                                  
004440 éÂå_ñÒãÊï™ñºèÃÇÃíäèoèàóùÅ[ÇrÇsÇ`ÇqÇs.                            
004450*                                                                 
004460     EXEC SQL                                                     
004470        SELECT  ñºèÃ                                              
004480          INTO :ÇvÇrÅ|ñºèÃÇP                                      
004490          FROM  D19MSY_TBL,M40MAB_TBL                             
004500        WHERE   D19MSY_TBL.ÉRÅ[ÉhÇmÇn = :ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇOÇRÇW   
004510          AND   SUBSTR ( ÉRÅ[Éh,1,1 )                             
004520		                 = :ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™          
004530     END-EXEC.                                                    
004540     EVALUATE  SQLCODE                                            
004550        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
004560*--<       ê≥èÌ >                                                 
004570           CONTINUE                                               
004580        WHEN  OTHER                                               
004590*--<       ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
004890           MOVE      SPACE            TO  ÇvÇrÅ|ñºèÃÇP
004600           MOVE -200                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
004610           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004620     END-EVALUATE.                                                
004630*                                                                 
004640 éÂå_ñÒãÊï™ñºèÃÅ|ÇdÇwÇhÇs.                                        
004650     EXIT.                                                        
004660*--<çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËå⁄ãqãÊï™ñºèÃÇÃíäèoèàóù>                     
004670 å⁄ãqãÊï™ñºèÃÇÃíäèoèàóù   SECTION.                                
004680 å⁄ãqãÊï™ñºèÃÇÃíäèoèàóùÅ[ÇrÇsÇ`ÇqÇs.                              
004690*                                                                 
004700     EXEC SQL                                                     
004710        SELECT  ñºèÃ                                              
004720          INTO :ÇvÇrÅ|ñºèÃÇQ                                      
004730          FROM  D19MSY_TBL,M40MAB_TBL                             
004740        WHERE   D19MSY_TBL.ÉRÅ[ÉhÇmÇn = :ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇOÇOÇT   
004750          AND   SUBSTR ( ÉRÅ[Éh,1,2 )                             
004760		                 = :ÇlÇSÇOÅ|å⁄ãqãÊï™                  
004770     END-EXEC.                                                    
004780*                                                                 
004790     EVALUATE  SQLCODE                                            
004800        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
004810*--<       ê≥èÌ >                                                 
004820           CONTINUE                                               
004830        WHEN  OTHER                                               
004840*--<       ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
005120           MOVE      SPACE            TO  ÇvÇrÅ|ñºèÃÇQ
004850           MOVE -200                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
004860           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004870     END-EVALUATE.                                                
004880*                                                                 
004890 å⁄ãqãÊï™ñºèÃÅ|ÇdÇwÇhÇs.                                          
004900     EXIT.                                                        
004910******************************************************************
004920*     ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù                      
004930******************************************************************
004940 ç¬å†èÓïÒÇÃíäèoèàóù                     SECTION.                  
004950 ç¬å†èÓïÒÇÃíäèoèàóùÅ[ÇrÇsÇ`ÇqÇs.                                  
004960     EXEC SQL                                                     
004970        SELECT  èÛë‘ÉtÉâÉO,ç¬å†å_ñÒåèñº,íSï€ãÊï™                  
004980          INTO :ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO,                               
004990                ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº,                             
005000                ÇlÇOÇPÅ|íSï€ãÊï™                                  
005010          FROM  M01SAJ_TBL,M40MAB_TBL                             
005020          WHERE M01SAJ_TBL.ÉåÉRÅ[ÉhãÊï™	= '1'	                
005030          AND   M01SAJ_TBL.å_ñÒî‘çÜ =  :ÇlÇSÇOÅ|å_ñÒî‘çÜ	
005040          AND   M01SAJ_TBL.çƒÉäÅ[ÉXâÒêî                           
005050                               = :ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî          
005060          AND   M01SAJ_TBL.å_ñÒéÌóﬁ = :ÇlÇSÇOÅ|å_ñÒéÌóﬁ	        
005070     END-EXEC.                                                    
005080     EVALUATE  SQLCODE                                            
005090        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
005100*--<       ê≥èÌ >                                                 
005110           CONTINUE                                               
005120        WHEN  OTHER                                               
005490           MOVE     ZERO              TO  ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO      
005500           MOVE     SPACE             TO  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº    
005510           MOVE     ZERO              TO  ÇlÇOÇPÅ|íSï€ãÊï™        
005130           MOVE -300                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
005140           PERFORM ÉGÉâÅ[îªíËèàóù                                 
005160     END-EVALUATE.                                                
005170 ç¬å†èÓïÒÇÃíäèoèàóùÅ|ÇdÇwÇhÇs.                                    
005180     EXIT.                                                        
005190******************************************************************
005200*     ï“èWèoóÕèàóù                                               *
005210******************************************************************
005220 ï“èWèoóÕèàóù                         SECTION.                    
005230 ï“èWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                        
005240*                                                                 
005290         PERFORM ëºé–ï™çÄñ⁄ï“èWèàóù                               
005300         PERFORM èoóÕèàóù                                         
005250     IF  ÇlÇOÇPÅ|ã¶í≤ãÊï™  = '2'
005320	       PERFORM é©é–ï™çÄñ⁄ï“èWèàóù                               
005330         PERFORM èoóÕèàóù                                         
005380     END-IF.                                                      
005390 ï“èWèoóÕèàóùÅ|ÇdÇwÇhÇs.                                          
005400     EXIT.                                                        
005410*                                                                 
005420*----------------------------------------------------------------*
005430*       èâä˙âªèàóù                                               *
005440*----------------------------------------------------------------*
005450*                                                                 
005460*----------------------------------------------------------------*
005470*       é©é–ï™çÄñ⁄ï“èWèàóù                                       *
005480*----------------------------------------------------------------*
005490 é©é–ï™çÄñ⁄ï“èWèàóù               SECTION.                        
005500 é©é–ï™çÄñ⁄ï“èWèàóùÅ|ÇrÇsÇ`ÇqÇs.                                  
005510                                                                  
005520*--<    No.01 >                                                   
005530        IF    ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO < 3                              
005540        MOVE  3 TO  èoóÕÅ|é©ëºé–ãÊï™                              
005550        ELSE                                                      
005560	      MOVE 1 TO èoóÕÅ|é©ëºé–ãÊï™                                
005570        END-IF.                                                   
005590*--<    No.02 >                                                   
005600        MOVE  ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™  TO  èoóÕÅ|ëOéÛãÊï™.           
005610                                                                  
005620*--<    No.03 >                                                   
005630        MOVE  ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™     TO  èoóÕÅ|éÂå_ñÒãÊï™.  
005640*                                                                 
005650*--<    No.04 >                                                   
005660        MOVE  ÇlÇSÇOÅ|å⁄ãqãÊï™          TO  èoóÕÅ|òAåããÊï™.       
005670*                                                                 
005680*--<    No.05 >                                                   
005690        MOVE  ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh      TO  èoóÕÅ|ñºäÒÇπÉRÅ[Éh.   
005700*                                                                 
005710*--<    No.06 >                                                   
005720        MOVE  ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh                          
005730                                      TO  èoóÕÅ|éÊà¯êÊÉRÅ[Éh.     
005740*                                                                 
005750*--<    No.07 >                                                   
005760        MOVE  ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh      TO  èoóÕÅ|êøãÅêÊÉRÅ[Éh.   
005770*                                                                 
005780*--<    No.08 >                                                   
005790        MOVE  ÇlÇSÇOÅ|å_ñÒî‘çÜ        TO  èoóÕÅ|å_ñÒî‘çÜ.         
005800*                                                                 
005810*--<    No.09 >                                                   
005820        MOVE  ÇlÇSÇOÅ|å_ñÒéÌóﬁ    TO  èoóÕÅ|å_ñÒéÌóﬁ.             
005830*                                                                 
005840*--<    No.10 >                                                   
005850        MOVE  ÇcÇVÇOÅ|ã∆ñ±îNåé        TO  èoóÕÅ|ã∆ñ±îNåé.         
005860*                                                                 
005870*--<    No.11 >                                                   
005880        MOVE  ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh                              
005890                               TO  èoóÕÅ|íSìñïîâ€ÉRÅ[Éh.          
005900*                                                                 
005910*--<    No.12 >                                                   
005920        MOVE  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº     TO  èoóÕÅ|å_ñÒåèñº.        
005930*                                                                 
005940*--<    No.13 >                                                   
005950        MOVE  ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî      TO  èoóÕÅ|çƒÉäÅ[ÉXâÒêî.   
005960*                                                                 
005970*--<    No.14 >                                                   
005980        MOVE  ÇlÇSÇOÅ|è[ìñäJénîNåé        TO  èoóÕÅ|è[ìñäJénîNåé. 
005990*                                                                 
006000*--<    No.15 >                                                   
006010        MOVE  ÇlÇSÇOÅ|è[ìñåéêî        TO  èoóÕÅ|è[ìñåéêî.         
006020*                                                                 
006030*--<    No.16 >                                                   
006040        MOVE  ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@       TO  èoóÕÅ|ëOï•âÒé˚ï˚ñ@.  
006050*                                                                 
006060*--<    No.17 >                                                   
006070        MOVE  ÇlÇSÇOÅ|ì¸ã‡ì˙              TO  èoóÕÅ|ì¸ã‡ì˙.       
006080*                                                                 
006090*--<    No.18 >                                                   
006100        MOVE  ÇlÇSÇOÅ|ì¸ã‡ãÊï™              TO  èoóÕÅ|ì¸ã‡ãÊï™.   
006110*                                                                 
006120*--<    No.19 >                                                   
006130        MOVE  ÇcÇOÇPÅ|éÊà¯êÊñºèÃ        TO  èoóÕÅ|éÊà¯êÊñºèÃ.     
006140*                                                                 
006150*--<    No.20 >                                                   
006160        MOVE  ÇcÇOÇQÅ|êøãÅêÊñºèÃ        TO  èoóÕÅ|êøãÅêÊñºèÃ.     
006170*                                                                 
006180*--<    No.21 >                                                   
006190        MOVE  ÇvÇrÅ|ñºèÃÇP             TO  èoóÕÅ|éÂå_ñÒãÊï™ñºèÃ.  
006200*                                                                 
006210*--<    No.22 >                                                   
006220        MOVE  ÇvÇrÅ|ñºèÃÇQ              TO  èoóÕÅ|òAåããÊï™ñºèÃ.   
006230*                                                                 
006240*--<    No.23 >                                                   
006250        MOVE  ÇlÇSÇOÅ|ëOåéññécçÇ          TO  èoóÕÅ|ëOåéññécçÇ.   
006260*                                                                 
006270*--<    No.24 >                                                   
006280        MOVE  ÇlÇSÇOÅ|ìñåéâÒé˚äz        TO  èoóÕÅ|ìñåéì¸ã‡äz.     
006290*                                                                 
006300*--<    No.25 >                                                   
006310        MOVE  ÇlÇSÇOÅ|ìñåéè¡âªäz        TO  èoóÕÅ|ìñåéè¡âªäz.     
006320*                                                                 
006330*--<    No.26 >                                                   
006340        MOVE  ÇlÇSÇOÅ|ìñåéññécçÇ          TO  èoóÕÅ|ìñåéññécçÇ.   
006350 é©é–ï™çÄñ⁄ï“èWèàóùÅ|ÇdÇwÇhÇs.                                    
006370     EXIT.                                                        
006380*                                                                 
006390*----------------------------------------------------------------*
006400*       ëºé–ï™çÄñ⁄ï“èWèàóù                                       *
006410*----------------------------------------------------------------*
006420 ëºé–ï™çÄñ⁄ï“èWèàóù               SECTION.                        
006430 ëºé–ï™çÄñ⁄ï“èWèàóùÅ|ÇrÇsÇ`ÇqÇs.                                  
006440*--<    No.01 >                                                   
006450        IF   ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO < '3'                               
006460        MOVE '4' TO  èoóÕÅ|é©ëºé–ãÊï™                               
006470        ELSE                                                      
006480	      MOVE '2' TO èoóÕÅ|é©ëºé–ãÊï™                                
006490        END-IF.                                                   
006500*                                                                 
006510*--<    No.02 >                                                   
006520        MOVE  ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™  TO  èoóÕÅ|ëOéÛãÊï™.           
006530                                                                  
006540*--<    No.03 >                                                   
006550        MOVE  ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™     TO  èoóÕÅ|éÂå_ñÒãÊï™.  
006560*                                                                 
006570*--<    No.04 >                                                   
006580        MOVE  ÇlÇSÇOÅ|å⁄ãqãÊï™          TO  èoóÕÅ|òAåããÊï™.       
006590*                                                                 
006600*--<    No.05 >                                                   
006610        MOVE  ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh      TO  èoóÕÅ|ñºäÒÇπÉRÅ[Éh.   
006620*                                                                 
006630*--<    No.06 >                                                   
006640        MOVE  ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh                          
006650                                     TO  èoóÕÅ|éÊà¯êÊÉRÅ[Éh.      
006660*                                                                 
006670*--<    No.07 >                                                   
006680        MOVE  ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh      TO  èoóÕÅ|êøãÅêÊÉRÅ[Éh.   
006690*                                                                 
006700*--<    No.08 >                                                   
006710        MOVE  ÇlÇSÇOÅ|å_ñÒî‘çÜ        TO  èoóÕÅ|å_ñÒî‘çÜ.         
006720*                                                                 
006730*--<    No.09 >                                                   
006740        MOVE  ÇlÇSÇOÅ|å_ñÒéÌóﬁ    TO  èoóÕÅ|å_ñÒéÌóﬁ.             
006750*                                                                 
006760*--<    No.10 >                                                   
006770        MOVE  ÇcÇVÇOÅ|ã∆ñ±îNåé        TO  èoóÕÅ|ã∆ñ±îNåé.         
006780*                                                                 
006790*--<    No.11 >                                                   
006800        MOVE  ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh                              
006810                                  TO  èoóÕÅ|íSìñïîâ€ÉRÅ[Éh.       
006820*                                                                 
006830*--<    No.12 >                                                   
006840        MOVE  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº      TO  èoóÕÅ|å_ñÒåèñº.       
006850*                                                                 
006860*--<    No.13 >                                                   
006870        MOVE  ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî      TO  èoóÕÅ|çƒÉäÅ[ÉXâÒêî.   
006880*                                                                 
006890*--<    No.14 >                                                   
006900        MOVE  ÇlÇSÇOÅ|è[ìñäJénîNåé     TO  èoóÕÅ|è[ìñäJénîNåé.    
006910*                                                                 
006920*--<    No.15 >                                                   
006930        MOVE  ÇlÇSÇOÅ|è[ìñåéêî        TO  èoóÕÅ|è[ìñåéêî.         
006940*                                                                 
006950*--<    No.16 >                                                   
006960        MOVE  ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@     TO  èoóÕÅ|ëOï•âÒé˚ï˚ñ@.    
006970*                                                                 
006980*--<    No.17 >                                                   
006990        MOVE  ÇlÇSÇOÅ|ì¸ã‡ì˙         TO  èoóÕÅ|ì¸ã‡ì˙.            
007000*                                                                 
007010*--<    No.18 >                                                   
007020        MOVE  ÇlÇSÇOÅ|ì¸ã‡ãÊï™       TO  èoóÕÅ|ì¸ã‡ãÊï™.          
007030*                                                                 
007040*--<    No.19 >                                                   
007050        MOVE  ÇcÇOÇPÅ|éÊà¯êÊñºèÃ     TO  èoóÕÅ|éÊà¯êÊñºèÃ.        
007060*                                                                 
007070*--<    No.20 >                                                   
007080        MOVE  ÇcÇOÇQÅ|êøãÅêÊñºèÃ        TO  èoóÕÅ|êøãÅêÊñºèÃ.     
007090*                                                                 
007100*--<    No.21 >                                                   
007110        MOVE  ÇvÇrÅ|ñºèÃÇP          TO  èoóÕÅ|éÂå_ñÒãÊï™ñºèÃ.     
007120*                                                                 
007130*--<    No.22 >                                                   
007140        MOVE  ÇvÇrÅ|ñºèÃÇQ              TO  èoóÕÅ|òAåããÊï™ñºèÃ.   
007150*                                                                 
007160*--<    No.23 >                                                   
007170        MOVE  ÇlÇSÇOÅ|ëOåéññécçÇëºé–   TO  èoóÕÅ|ëOåéññécçÇ.      
007180*                                                                 
007190*--<    No.24 >                                                   
007200        MOVE  ÇlÇSÇOÅ|ìñåéâÒé˚äzëºé–    TO  èoóÕÅ|ìñåéì¸ã‡äz.     
007210*                                                                 
007220*--<    No.25 >                                                   
007230        COMPUTE   ÇvÅ|ìñåéè¡âªäz = ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–         
007240            + ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡                          
007250            + ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈.                       
007260         MOVE ÇvÅ|ìñåéè¡âªäz        TO  èoóÕÅ|ìñåéè¡âªäz.         
007270*                                                                 
007280*--<    No.26 >                                                   
007290        COMPUTE  ÇvÅ|ìñåéññécçÇ = ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–          
007300                -  ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡                     
007310		      -  ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈.                  
007320	      MOVE ÇvÅ|ìñåéññécçÇ	TO  èoóÕÅ|ìñåéññécçÇ.           
007340 ëºé–ï™çÄñ⁄ï“èWèàóùÅ|ÇdÇwÇhÇs.                                    
007350     EXIT.                                                        
007360*                                                                 
007370*                                                                 
007380******************************************************************
007390*    èoóÕèàóù                                                    *
007400******************************************************************
007410 èoóÕèàóù                             SECTION.                    
007420 èoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
007430         IF  èoóÕÅ|ëOåéññécçÇ = ZERO                              
007440	       AND èoóÕÅ|ìñåéì¸ã‡äz = ZERO                              
007450         AND èoóÕÅ|ìñåéè¡âªäz = ZERO                              
007460	       AND èoóÕÅ|ìñåéññécçÇ = ZERO                              
007470            CONTINUE                                              
007480         ELSE                                                     
007490            WRITE  èoóÕÅ|ÉåÉRÅ[Éh.                                
007500*                                                                 
007510*----------------------------------------------------------------*
007520*    í«â¡èàóùÇämîF                                              *
007530*----------------------------------------------------------------*
007540     EVALUATE  ÇvÅ|èÛë‘                                    
007550        WHEN   ZERO                                   
007560*--<       í«â¡ê¨å˜ >                                             
007570           COMPUTE  ÇvÅ|èoóÕÅ|åèêî  =  ÇvÅ|èoóÕÅ|åèêî  +  1       
007580        WHEN   OTHER                                              
007590*--<       í«â¡èàóùÉGÉâÅ[ >                                       
007600           MOVE     -40               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
007610           PERFORM  ÉGÉâÅ[îªíËèàóù                                
007620     END-EVALUATE.                                                
007630*                                                                 
007640 èoóÕèàóùÅ|ÇdÇwÇhÇs.                                              
007650     EXIT.                                                        
007660******************************************************************
007670*    èIóπèàóù                                                    *
007680******************************************************************
007690 èIóπèàóù                             SECTION.                    
007700 èIóπèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
007710*                                                                 
007720     PERFORM  ÇcÇaÉNÉçÅ[ÉYèàóù.                                   
007730*                                                                 
007740     PERFORM  ÇcÇaÉRÉ~ÉbÉgèàóù.                                   
007750*                                                                 
007760     PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ.                                 
007770*                                                                 
007780*--< ÉvÉçÉOÉâÉÄê≥èÌèIóπ >                                         
007790     MOVE  íËêîÅ|ê≥èÌèÛë‘             TO  PROGRAM-STATUS.         
007800*                                                                 
007810 èIóπèàóùÅ|ÇdÇwÇhÇs.                                              
007820     EXIT.                                                        
007830******************************************************************
007840*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
007850******************************************************************
007860 èIóπÉÅÉbÉZÅ[ÉWèoóÕ                   SECTION.                    
007870 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
007880*                                                                 
007890*----------------------------------------------------------------*
007900*    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
007910*----------------------------------------------------------------*
007270*----------------------------------------------------------------*
007280*    ëOéÛèÓïÒÅiåãçáÅjÇcÇaì¸óÕåèêî                                *
007290*----------------------------------------------------------------*
007300     INITIALIZE                       IF-CHOCO001.                
007310     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007320     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007330     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007340     MOVE  "M40MAB"                   TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007350     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007360     MOVE  ÇvÅ|ì¸óÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007370     MOVE  "ëOéÛèÓïÒÉeÅ[ÉuÉãÅiì¸óÕÅj" TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007380     CALL  CLOCO001                USING  IF-CHOCO001.            
007390                                                                  
007400*----------------------------------------------------------------*
007410*    ëOéÛã‡éÛï•écçÇíÜä‘ÇeèoóÕåèêî                                *
007420*----------------------------------------------------------------*
007430     INITIALIZE                       IF-CHOCO001.                
007440     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007450     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007460     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007470     MOVE  "SFHSED25"                 TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007480     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007490     MOVE  ÇvÅ|èoóÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007500     MOVE  "ëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉã"   TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007510     CALL  CLOCO001                USING  IF-CHOCO001.            
008130*----------------------------------------------------------------*
008140*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
008150*----------------------------------------------------------------*
008160     INITIALIZE                       IF-CHOCO001.                
008170     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
008180     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
008190     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
008200     MOVE  "END"                      TO  ã§ÇPÅ|èàóùéØï .         
008210     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008220     CALL  CLOCO001                USING  IF-CHOCO001.            
008230*                                                                 
008240 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
008250     EXIT.                                                        
008260******************************************************************
008270*    ÇcÇaÉNÉçÅ[ÉY                                                *
008280******************************************************************
008290 ÇcÇaÉNÉçÅ[ÉYèàóù                     SECTION.                    
008300 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
008310*                                                                 
008320*--< ÉJÅ[É\Éã ÉNÉçÅ[ÉY >                                          
008330     EXEC SQL                                                     
008340        CLOSE  CUR1                                               
008350     END-EXEC.                                                    
008360*                                                                 
008370 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇdÇwÇhÇs.                                      
008380     EXIT.                                                        
008390******************************************************************
008400*    ÇcÇaÉRÉ~ÉbÉgèàóù                                            *
008410******************************************************************
008420 ÇcÇaÉRÉ~ÉbÉgèàóù                     SECTION.                    
008430 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
008440*                                                                 
008450     EXEC  SQL                                                    
008460        COMMIT  WORK  RELEASE                                     
008470     END-EXEC.                                                    
008480*                                                                 
008490     INITIALIZE                       IF-CHOCO001.                
008500     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
008510     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
008520     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
008530     MOVE  "COMMIT"                   TO  ã§ÇPÅ|èàóùéØï .         
008540     MOVE  "ÉRÉ~ÉbÉgé¿é{"             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
008550     CALL  CLOCO001                USING  IF-CHOCO001.            
008560*                                                                 
008570 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇdÇwÇhÇs.                                      
008580     EXIT.                                                        
008790******************************************************************
008800*    ÉGÉâÅ[èàóù                                                  *
008810******************************************************************
008820 ÉGÉâÅ[îªíËèàóù                       SECTION.                    
008830 ÉGÉâÅ[îªíËèàóùÅ|ÇrÇsÇ`ÇqÇs.                                      
008840*                                                                 
008850     MOVE  "Y"                        TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO.    
008860     INITIALIZE                           IF-CHOCO001.            
008870*                                                                 
008880     EVALUATE  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh                                   
008890        WHEN  -10                                                 
008900*--<       ÇnÇqÇ`ÇbÇkÇdê⁄ë±é∏îs >                                 
008910           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008920           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008930           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008940           MOVE  "CONNECT"            TO  ã§ÇPÅ|èàóùéØï           
008950           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008960           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008970           CALL  CLOCO001          USING  IF-CHOCO001             
008980*                                                                 
008990        WHEN  -20                                                 
009000*--<       åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãÉIÅ[ÉvÉìé∏îs >                     
009010           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009020           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009030           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009040           MOVE  "M40MAB"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009050           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
009060           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009070           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009080           CALL  CLOCO001          USING  IF-CHOCO001             
009090*                                                                 
009100        WHEN  -30                                                 
009110*--<       åãçáÉeÅ[ÉuÉãì«çûé∏îs >                                 
009120           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009130           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009140           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009150           MOVE  "M40MAB"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009160           MOVE  "FETCH"              TO  ã§ÇPÅ|èàóùéØï           
009170           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009180           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009190           CALL  CLOCO001          USING  IF-CHOCO001             
009310*                                                                 
009320        WHEN  -100                                                
009330*--<       ÉoÉbÉ`ópã∆ñ±îNåéé∏îs >                                 
009340           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009350           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009360           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009370           MOVE  "D70GYM"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009380           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
009390           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009400           MOVE  "ÉoÉbÉ`ópã∆ñ±îNåéé∏îs"                           
009410                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009420           CALL  CLOCO001          USING  IF-CHOCO001             
009430        WHEN  -200                                                
009440*--<       çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒ(å⁄ãq)ãÊï™ñºèÃÇÃíäèoé∏îs >     
009450           MOVE  "2"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009460           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009470           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009480           MOVE  "D19MSY"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009490           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
009500           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009510           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009520           CALL  CLOCO001          USING  IF-CHOCO001             
009530           MOVE  "N"                  TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO    
009540*                                                                 
009550        WHEN  -300                                                
009560*--<       ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoé∏îs >               
009570           MOVE  "2"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
009580           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
009590           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
009600           MOVE  "M01SAJ"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
009610           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
009620           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
009630           MOVE  "çÄñ⁄ÇÃíäèoé∏îs"                                 
009640                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
009650           CALL  CLOCO001          USING  IF-CHOCO001             
009660           MOVE  "N"                  TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO    
009670        WHEN  OTHER                                               
009680           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
009690     END-EVALUATE.                                                
009700*                                                                 
009710     IF ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO  =  "Y"                                                          
009730*                                                                 
009740        PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ                               
009750*                                                                 
009760*--<    ÉvÉçÉOÉâÉÄàŸèÌèIóπÇÃÉäÉ^Å[ÉìÉRÅ[Éh >                      
009770        MOVE  íËêîÅ|àŸèÌèÛë‘          TO  PROGRAM-STATUS          
009780*                                                                 
009790        EXIT  PROGRAM                                             
009800     END-IF.                                                      
009810*                                                                 
009820 ÉGÉâÅ[èàóùÅ|ÇdÇwÇhÇs.                                            
009830     EXIT.                                                        
009840******************************************************************
009850*                  END OF PROGRAM                                *
009860******************************************************************
