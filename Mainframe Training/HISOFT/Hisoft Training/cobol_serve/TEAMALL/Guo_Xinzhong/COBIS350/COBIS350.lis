Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

ファイル: C:\COB97\SOC\COBIS350\COBIS350.PCOをオープン
     1  000010******************************************************************
     2  000020*         ＜海輝軟件(大連)＞                                     *
     3  000030*      1. プログラム名  : SUMMIT検収後・履歴ｱﾝﾏｯﾁ抽出            *
     4  000040*      2. プログラムID  : COBIS350                               *
     5  000050*      3. 処理概要      : 債権明細をベースにして、債権採算検収後 *
     6  000060*                          データを抽出する。                    *
     7  000070*                                                                *
     8  000080*      4. 作成者        : 郭新鐘                                 *
     9  000090*      5. 作成日        : 2005.04.01                             *
    10  000100******************************************************************
    11  000110*                                                                 
    12  000120******************************************************************
    13  000130*    ＩＤＥＮＴＩＦＩＣＡＴＩＯＮ     ＤＩＶＩＳＩＯＮ           *
    14  000140******************************************************************
    15  000150 IDENTIFICATION                       DIVISION.                   
    16  000160*                                                                 
    17  000170 PROGRAM-ID.                          COBIS350.                   
    18  000180******************************************************************
    19  000190*    ＥＮＶＩＲＯＮＭＥＮＴ           ＤＩＶＩＳＩＯＮ           *
    20  000200******************************************************************
    21  000210 ENVIRONMENT                          DIVISION.                   
    22  000220******************************************************************
    23  000230*    ＩＮＰＵＴ−ＯＵＴＰＵＴ      ＳＥＣＴＩＯＮ                *
    24  000240******************************************************************
    25  000250 INPUT-OUTPUT                         SECTION.                    
    26  000260*                                                                 
    27  000270 FILE-CONTROL.                                                    
    28  000280     SELECT    入力ファイル         ASSIGN    TO     U01          
    29  000290     FILE      STATUS     IS          Ｗ−状態                    
    30  000300     ORGANIZATION         IS          LINE      SEQUENTIAL.       
    31  000310*                                                                 
    32  000320     SELECT    出力ファイル１         ASSIGN    TO     U11        
    33  000330     FILE      STATUS     IS          Ｗ−状態                    
    34  000340     ORGANIZATION         IS          LINE      SEQUENTIAL.       
    35  000350*                                                                 
    36  000360     SELECT    出力ファイル２           ASSIGN    TO     U12      
    37  000370     FILE      STATUS     IS          Ｗ−状態                    
    38  000380     ORGANIZATION         IS          LINE      SEQUENTIAL.       
    39  000390*                                                                 
    40  000400******************************************************************
    41  000410*    ＤＡＴＡ                      ＤＩＶＩＳＩＯＮ              *
    42  000420******************************************************************
    43  000430 DATA                                 DIVISION.                   
    44  000440******************************************************************
    45  000450*    ＦＩＬＥ                      ＳＥＣＴＩＯＮ                *
    46  000460******************************************************************
    47  000470 FILE                                 SECTION.                    
    48  000480*----------------------------------------------------------------*
    49  000490*    入力ファイル                                                *
    50  000500*----------------------------------------------------------------*
    51  000510 FD  入力ファイル                                                 
    52  000520     LABEL     RECORD     IS          STANDARD                    
    53  000530     BLOCK     CONTAINS   0           RECORDS.                    
    54  000540*                                                                 
    55  000550 01  入力−レコード.                                              
    56  000560     COPY  CPBIS161  REPLACING  ==()==  BY  ==入力−==.           
    57  000570*                                                                 
    58  000580*----------------------------------------------------------------*
    59  000590*    出力ファイル                                                *
    60  000600*----------------------------------------------------------------*
    61  000610 FD  出力ファイル１                                               
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    62  000620     LABEL     RECORD     IS          STANDARD                    
    63  000630     BLOCK     CONTAINS   0           RECORDS.                    
    64  000640*                                                                 
    65  000650 01  出力１−レコード.                                            
    66  000660     COPY  CISUF351  REPLACING  ==()==  BY  ==出力１−==.         
    67  000670*                                                                 
    68  000680*                                                                 
    69  000690 FD  出力ファイル２                                               
    70  000700     LABEL     RECORD     IS          STANDARD                    
    71  000710     BLOCK     CONTAINS   0           RECORDS.                    
    72  000720*                                                                 
    73  000730 01  出力２−レコード.                                            
    74  000740     COPY  CISUF351  REPLACING  ==()==  BY  ==出力２−==.         
    75  000750                                                                  
    76  000760******************************************************************
    77  000770*    ＷＯＲＫＩＮＧ−ＳＴＯＲＡＧＥ   ＳＥＣＴＩＯＮ             *
    78  000780******************************************************************
    79  000790 WORKING-STORAGE                      SECTION.                    
    80  000800 01  Ｗ−固定資産税                   PIC S9(13).                 
    81  000810 01  Ｗ−動総保険料                   PIC S9(13).                 
    82  000820 01  Ｗ−委託保守料                   PIC S9(13).                 
    83  000830 01  Ｗ−基本リース料１回分           PIC S9(13).                 
    84  000840 01  Ｗ−固定資産税費用総額           PIC S9(13).                 
    85  000850 01  Ｗ−動総保険料費用総額           PIC S9(13).                 
    86  000860 01  Ｗ−リース料１回分               PIC S9(13).                 
    87  000870 01  Ｗ−実質リース料１回分           PIC S9(13).                 
    88  000880 01  Ｗ−基本リース料１回分当社       PIC S9(13).                 
    89  000890 01  Ｗ−固定資産税費用総額当社       PIC S9(13).                 
    90  000900 01  Ｗ−動総保険料費用総額当社       PIC S9(13).                 
    91  000910 01  Ｗ−リース料１回分当社           PIC S9(13).                 
    92  000920 01  Ｗ−実質リース料１回分当社       PIC S9(13).                 
    93  000930 01  Ｗ−その他諸費用                 PIC S9(13).                 
    94  000940 01  Ｗ−その他諸費用現価             PIC S9(13).                 
    95  000950 01  Ｗ−その他諸費用総額             PIC S9(13).                 
    96  000960 01  Ｗ−その他諸費用１回分           PIC S9(13).                 
    97  000970 01  Ｗ−その他諸費用総額当社         PIC S9(13).                 
    98  000980 01  Ｗ−その他諸費用１回分当社       PIC S9(13).                 
    99  000990                                                                  
   100  001000*----------------------------------------------------------------*
   101  001010*    ホスト変数定義エリア                                        *
   102  001020*----------------------------------------------------------------*
   103  001030     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
   104  001040 01   ＷＳ−契約番号                  PIC  X(9).                  
   105  001050 01   ＷＳ−再リースコード            PIC  S9(1).                 
   106  001060 01   ＷＳ−勘定処理コード            PIC  S9(2).                 
   107  001070*--< ＯＲＡＣＬＥ共通変数 >                                       
   108  001080     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
   109  001090*                                                                 
   110  001100*--< ＯＲＡＣＬＥ  ＳＱＬ実行情報 >                               
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをオープン
     1  000010*--＜ＳＱＬ共通変数＞
     2  000030   01  SQLSTATE                      PIC  X(005).
     3  000040   01  DB-STRING                     PIC  X(020).
     4  000050   01  USERNAME                      PIC  X(010).
     5  000060   01  PASSWD                        PIC  X(010).
     6  000070*
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをクローズ
   111  001110     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
   112  001120*                                                                 
   113  001130*--< 契約種類等変換テーブル >                                     
   114  001140     EXEC  SQL  INCLUDE  IKOTBL002.CBL         END-EXEC.          
   115  001150*                                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

ファイル: Z:\COB97\COPYLIB_DB\IKOTBL002.CBLをオープン
     1  000010************************************************
     2  000020* 契約種類等変換テーブル(IKOTBL002)
     3  000030************************************************
     4  000040 01  ＩＫＯ００２−契約ＮＯ PIC  X(009).
     5  000050 01  ＩＫＯ００２−再リースコード PIC S9(001) COMP-3.
     6  000060 01  ＩＫＯ００２−旧債権勘定処理コード PIC S9(002) COMP-3.
     7  000070 01  ＩＫＯ００２−旧債務勘定処理コード PIC S9(002) COMP-3.
     8  000080 01  ＩＫＯ００２−再リース回数 PIC S9(002) COMP-3.
     9  000090 01  ＩＫＯ００２−債権勘定処理コード PIC S9(002) COMP-3.
    10  000100 01  ＩＫＯ００２−債務勘定処理コード PIC S9(002) COMP-3.
    11  000110 01  ＩＫＯ００２−契約種類 PIC  X(003).
    12  000120 01  ＩＫＯ００２−主契約区分 PIC  X(001).
    13  000130 01  ＩＫＯ００２−回収手順 PIC  X(001).
ファイル: Z:\COB97\COPYLIB_DB\IKOTBL002.CBLをクローズ
   116  001160     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
   117  001170*                                                                 
   118  001180*----------------------------------------------------------------*
   119  001190*   作業領域定義                                                 *
   120  001200*----------------------------------------------------------------*
   121  001210 01  ワークエリア.                                                
   122  001220*                                                                 
   123  001230*--< 件数エリア >                                                 
   124  001240     03  Ｗ−件数エリア.                                          
   125  001250         05  Ｗ−債権明細−件数       PIC  9(09).                 
   126  001260         05  Ｗ−持分以外−件数       PIC  9(09).                 
   127  001270         05  Ｗ−持分−件数           PIC  9(09).                 
   128  001280*                                                                 
   129  001290*--< ファイル状態 >                                               
   130  001300     03  Ｗ−状態エリア.                                          
   131  001310         05  Ｗ−状態                 PIC  X(02).                 
   132  001320*                                                                 
   133  001330*--< エラーコード >                                               
   134  001340     03  Ｗ−エラーコード             PIC S9(04).                 
   135  001350*                                                                 
   136  001360*--< フラグエリア >                                               
   137  001370     03  Ｗ−フラッグエリア.                                      
   138  001380         05  Ｗ−終了−フラグ         PIC  X(01).                 
   139  001390         05  Ｗ−異常終了−フラグ     PIC  X(01).                 
   140  001400*                                                                 
   141  001410*----------------------------------------------------------------*
   142  001420*   処理時間定義                                                 *
   143  001430*----------------------------------------------------------------*
   144  001440*--< 共通情報 >                                                   
   145  001450 01  Ｗ−共通情報.                                                
   146  001460     03  Ｗ−システム日付.                                        
   147  001470         05  Ｗ−世紀                 PIC  X(02) VALUE  "20".     
   148  001480         05  Ｗ−年月日               PIC  X(06).                 
   149  001490     03  Ｗ−システム時刻             PIC  X(08).                 
   150  001500     03  Ｗ−担当者                   PIC  X(08) VALUE "IKOPG   ".
   151  001510*----------------------------------------------------------------*
   152  001520*    サブルーチン名                                              *
   153  001530*----------------------------------------------------------------*
   154  001540 01  CALL-AREA.                                                   
   155  001550*--< 共通ログサブルーチン >                                       
   156  001560     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
   157  001570     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
   158  001580*                                                                 
   159  001590*----------------------------------------------------------------*
   160  001600*    ＣＯＰＹ領域                                                *
   161  001610*----------------------------------------------------------------*
   162  001620*--< 共通ログ用 >                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   163  001630 01  IF-CHOCO001.                                                 
   164  001640     COPY  CHOCO001  REPLACING  ==()==  BY  ==共通−==.           
   165  001650*                                                                 
   166  001660*----------------------------------------------------------------*
   167  001670*    ＩＮＩファイル読込サブルーチン用パラメタ領域                *
   168  001680*----------------------------------------------------------------*
   169  001690 01  PARA-AREA.                                                   
   170  001700     COPY CPBCO001.                                               
   171  001710*                                                                 
   172  001720******************************************************************
   173  001730*    定数用データ定義                                            *
   174  001740******************************************************************
   175  001750 CONSTANT                             SECTION.                    
   176  001760*                                                                 
   177  001770 01  定数領域.                                                    
   178  001780     03  定数−プログラムＩＤ         PIC  X(08) VALUE "COBIS350".
   179  001790     03  定数−プログラム名           PIC  X(80)                  
   180  001800             VALUE "SUMMIT検収後・履歴アンマッチ抽出".            
   181  001810     03  定数−ＳＱＬＯＫ             PIC S9(04)  VALUE  ZERO.    
   182  001820     03  定数−ＳＱＬＥＮＤ           PIC S9(04)  VALUE  0100.    
   183  001830     03  定数−正常状態               PIC  9(04) VALUE  ZERO.     
   184  001840     03  定数−異常状態               PIC  9(04) VALUE  0009.     
   185  001850*                                                                 
   186  001860******************************************************************
   187  001870*    ＰＲＯＣＥＤＵＲＥ               ＤＩＶＩＳＩＯＮ           *
   188  001880******************************************************************
   189  001890 PROCEDURE                            DIVISION.                   
   190  001900*                                                                 
   191  001910     PERFORM   初期処理.                                          
   192  001920*                                                                 
   193  001930     PERFORM   主処理     UNTIL  (Ｗ−終了−フラグ = "Y").        
   194  001940*                                                                 
   195  001950     PERFORM   終了処理.                                          
   196  001960*                                                                 
   197  001970     STOP RUN.                                                    
   198  001980*                                                                 
   199  001990******************************************************************
   200  002000*    初期処理                                                    *
   201  002010******************************************************************
   202  002020 初期処理                             SECTION.                    
   203  002030 初期処理−ＳＴＡＲＴ.                                            
   204  002040*                                                                 
   205  002050*----------------------------------------------------------------*
   206  002060*    開始メッセージ出力                                          *
   207  002070*----------------------------------------------------------------*
   208  002080     INITIALIZE                       IF-CHOCO001.                
   209  002090     MOVE  "3"                        TO  共通−イベント種別.     
   210  002100     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
   211  002110     MOVE  "0"                        TO  共通−復帰コード.       
   212  002120     MOVE  "START"                    TO  共通−処理識別.         
   213  002130     MOVE  定数−プログラム名         TO  共通−その他メッセージ. 
   214  002140     CALL  CLOCO001                USING  IF-CHOCO001.            
   215  002150*                                                                 
   216  002160*----------------------------------------------------------------*
   217  002170*    作業領域の初期値設定                                        *
   218  002180*----------------------------------------------------------------*
   219  002190                                                                  
   220  002200     MOVE  SPACE                      TO  ワークエリア.           
   221  002210     INITIALIZE                           ワークエリア.           
   222  002220*                                                                 
   223  002230*--< ＣＰＵ日付を取得 >                                           
   224  002240     ACCEPT  Ｗ−年月日               FROM  DATE.                 
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   225  002250*                                                                 
   226  002260*--< ＣＰＵ時刻を取得 >                                           
   227  002270     ACCEPT  Ｗ−システム時刻         FROM  TIME.                 
   228  002280*----------------------------------------------------------------*
   229  002290*    ＯＲＡＣＬＥ接続                                    <1.1>   *
   230  002300*----------------------------------------------------------------*
   231  002310     PERFORM  ＯＲＡＣＬＥ接続.                                   
   232  002320*                                                                 
   233  002330     PERFORM  ファイルオープン.                                   
   234  002340*                                                                 
   235  002350*--< 債権明細ファイル読込処理（１件目） >                         
   236  002360     PERFORM  債権明細ファイル読込処理.                           
   237  002370*                                                                 
   238  002380 初期処理−ＥＸＩＴ.                                              
   239  002390     EXIT.                                                        
   240  002400******************************************************************
   241  002410*    ＯＲＡＣＬＥ接続                                            *
   242  002420******************************************************************
   243  002430 ＯＲＡＣＬＥ接続                     SECTION.                    
   244  002440 ＯＲＡＣＬＥ接続−ＳＴＡＲＴ.                                    
   245  002450*                                                                 
   246  002460*--< ＤＢ接続用情報を取得処理 >                                   
   247  002470     CALL  COBCO001                USING  PARA-AREA.              
   248  002480*                                                                 
   249  002490     MOVE  PARA-DBSTRING              TO  DB-STRING.              
   250  002500     MOVE  PARA-USERNAME              TO  USERNAME.               
   251  002510     MOVE  PARA-PASSWORD              TO  PASSWD.                 
   252  002520*                                                                 
   253  002530*----------------------------------------------------------------*
   254  002540*    開始接続                                                    *
   255  002550*----------------------------------------------------------------*
   256  002560     IF    DB-STRING  =  SPACE                                    
   257  002570        EXEC SQL                                                  
   258  002580           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   259  002590        END-EXEC                                                  
   260  002600     ELSE                                                         
   261  002610        EXEC SQL                                                  
   262  002620           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   263  002630             USING  :DB-STRING                                    
   264  002640        END-EXEC                                                  
   265  002650     END-IF.                                                      
   266  002660*                                                                 
   267  002670*----------------------------------------------------------------*
   268  002680*    接続確認                                                    *
   269  002690*----------------------------------------------------------------*
   270  002700     EVALUATE  SQLCODE                                            
   271  002710        WHEN   定数−ＳＱＬＯＫ                                   
   272  002720           CONTINUE                                               
   273  002730        WHEN   OTHER                                              
   274  002740*--<       接続エラー >                                           
   275  002750           MOVE     -10               TO  Ｗ−エラーコード        
   276  002760           PERFORM  エラー処理                                    
   277  002770     END-EVALUATE.                                                
   278  002780*                                                                 
   279  002790 ＯＲＡＣＬＥ接続−ＥＸＩＴ.                                      
   280  002800     EXIT.                                                        
   281  002810*                                                                 
   282  002820******************************************************************
   283  002830*    主処理                                                       
   284  002840******************************************************************
   285  002850 主処理                               SECTION.                    
   286  002860 主処理−ＳＴＡＲＴ.                                              
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   287  002870*                                                                 
   288  002880      IF 入力−債協コード NOT = '2X'                                  
   289  002890           PERFORM  協調幹事持分以外編集処理                  
   290  002900      ELSE                                                        
   291  002910           PERFORM  協調幹事持分編集処理                      
   292  002920      END-IF.                                                     
   293  002930*--< 債権明細ファイル読込処理（２件目以降） >                     
   294  002940     PERFORM  債権明細ファイル読込処理.                           
   295  002950*                                                                 
   296  002960 主処理−ＥＸＩＴ.                                                
   297  002970     EXIT.                                                        
   298  002980******************************************************************
   299  002990*    終了処理                                                    *
   300  003000******************************************************************
   301  003010 終了処理                             SECTION.                    
   302  003020 終了処理−ＳＴＡＲＴ.                                            
   303  003030*                                                                 
   304  003040*----------------------------------------------------------------*
   305  003050*    ファイルクローズ                                            *
   306  003060*----------------------------------------------------------------*
   307  003070     CLOSE  入力ファイル.                                         
   308  003080     CLOSE  出力ファイル１.                                       
   309  003090     CLOSE  出力ファイル２.                                       
   310  003100*                                                                 
   311  003110*--< 終了メッセージ出力処理                                       
   312  003120     PERFORM  終了メッセージ出力.                                 
   313  003130*                                                                 
   314  003140*--< プログラム正常終了 >                                         
   315  003150     MOVE  定数−正常状態             TO  PROGRAM-STATUS.         
   316  003160*                                                                 
   317  003170 終了処理−ＥＸＩＴ.                                              
   318  003180     EXIT.                                                        
   319  003190******************************************************************
   320  003200*    ファイルオープン                                            *
   321  003210******************************************************************
   322  003220 ファイルオープン                     SECTION.                    
   323  003230 ファイルオープン−ＳＴＡＲＴ.                                    
   324  003240*                                                                 
   325  003250*----------------------------------------------------------------*
   326  003260*    債権明細ファイルのオープン                                  *
   327  003270*----------------------------------------------------------------*
   328  003280     OPEN  INPUT   入力ファイル.                                  
   329  003290*                                                                 
   330  003300*--< ファイルオープンの状態判定 >                                 
   331  003310     EVALUATE  Ｗ−状態                                           
   332  003320        WHEN  ZERO                                                
   333  003330           CONTINUE                                               
   334  003340        WHEN  OTHER                                               
   335  003350*--<       ファイルオープンエラー >                               
   336  003360           MOVE     -1                TO  Ｗ−エラーコード        
   337  003370           PERFORM  エラー処理                                    
   338  003380     END-EVALUATE.                                                
   339  003390*                                                                 
   340  003400*----------------------------------------------------------------*
   341  003410*    持分以外ファイルのオープン                                  *
   342  003420*----------------------------------------------------------------*
   343  003430     OPEN  OUTPUT   出力ファイル１.                               
   344  003440*                                                                 
   345  003450*--< ファイルオープンの状態判定 >                                 
   346  003460     EVALUATE  Ｗ−状態                                           
   347  003470        WHEN  ZERO                                                
   348  003480           CONTINUE                                               
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   349  003490        WHEN  OTHER                                               
   350  003500*--<       持分以外ファイルオープンエラー >                       
   351  003510           MOVE     -2                TO  Ｗ−エラーコード        
   352  003520           PERFORM  エラー処理                                    
   353  003530     END-EVALUATE.                                                
   354  003540*                                                                 
   355  003550*----------------------------------------------------------------*
   356  003560*    持分ファイルのオープン                                      *
   357  003570*----------------------------------------------------------------*
   358  003580     OPEN  OUTPUT   出力ファイル２.                               
   359  003590*                                                                 
   360  003600*--< ファイルオープンの状態判定 >                                 
   361  003610     EVALUATE  Ｗ−状態                                           
   362  003620        WHEN  ZERO                                                
   363  003630           CONTINUE                                               
   364  003640        WHEN  OTHER                                               
   365  003650*--<       持分ファイルオープンエラー >                           
   366  003660           MOVE     -3                TO  Ｗ−エラーコード        
   367  003670           PERFORM  エラー処理                                    
   368  003680     END-EVALUATE.                                                
   369  003690*                                                                 
   370  003700 ファイルオープン−ＥＸＩＴ.                                      
   371  003710     EXIT.                                                        
   372  003720******************************************************************
   373  003730*    債権明細ファイル読込処理                                    *
   374  003740******************************************************************
   375  003750 債権明細ファイル読込処理             SECTION.                    
   376  003760 債権明細ファイル読込処理−ＳＴＡＲＴ.                            
   377  003770*                                                                 
   378  003780     READ  入力ファイル                                           
   379  003790        AT END                                                    
   380  003800           MOVE  "Y"                  TO  Ｗ−終了−フラグ        
   381  003810           GO    TO   債権明細ファイル読込処理−ＥＸＩＴ          
   382  003820     END-READ.                                                    
   383  003830*                                                                 
   384  003840*--< 債権明細ファイル読込状態判定 >                               
   385  003850     EVALUATE  Ｗ−状態                                           
   386  003860        WHEN  ZERO                                                
   387  003870*--<       債権明細ファイル入力件数のカウント >                   
   388  003880           COMPUTE   Ｗ−債権明細−件数  =  Ｗ−債権明細−件数 + 1
   389  003890        WHEN  OTHER                                               
   390  003900*--<       債権明細ファイル読込エラー >                           
   391  003910           MOVE     -4                TO  Ｗ−エラーコード        
   392  003920           PERFORM  エラー処理                                    
   393  003930     END-EVALUATE.                                                
   394  003940*                                                                 
   395  003950 債権明細ファイル読込処理−ＥＸＩＴ.                              
   396  003960     EXIT.                                                        
   397  003970******************************************************************
   398  003980*    協調幹事持分以外編集処理                                *
   399  003990******************************************************************
   400  004000 協調幹事持分以外編集処理         SECTION.                    
   401  004010 協調幹事持分以外編集処理−ＳＴＡＲＴ.                        
   402        
   403  004170*--< 出力レコードの初期化処理 >                                   
   404  004040     INITIALIZE            出力１−レコード.                  
   405  004190     MOVE  入力−レコード             TO  出力１−レコード.       
   406  004200*--< No.1 >                                                       
   407  004210     MOVE  入力−契約番号             TO  出力１−契約番号.       
   408  004220*--< No.2 >                                                       
   409  004230     MOVE  入力−契約番号             TO  ＷＳ−契約番号.         
   410  004240     MOVE  入力−再リースコード       TO  ＷＳ−再リースコード.   
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   411  004250     MOVE  入力−勘定処理コード       TO  ＷＳ−勘定処理コード.   
   412  004260     EXEC SQL                                                     
   413  004270        SELECT 再リース回数                                       
   414  004280          INTO :ＩＫＯ００２−再リース回数                        
   415  004290          FROM IKOTBL002                                          
   416  004300          WHERE  契約ＮＯ = :ＷＳ−契約番号                       
   417  004310            AND  再リースコード = :ＷＳ−再リースコード           
   418  004320            AND  旧債権勘定処理コード = :ＷＳ−勘定処理コード     
   419  004330     END-EXEC.                                                    
   420  004340     EVALUATE  SQLCODE                                            
   421  004350        WHEN  定数−ＳＱＬＯＫ                                    
   422  004360*--<       正常 >                                                 
   423  004370     MOVE  ＩＫＯ００２−再リース回数 TO  出力１−再リース回数    
   424  004380           CONTINUE                                               
   425  004390        WHEN  OTHER                                               
   426  004400           MOVE -11                   TO  Ｗ−エラーコード        
   427  004410           PERFORM エラー処理                                     
   428  004420      END-EVALUATE.                                               
   429  004430                                                                  
   430  004440*--< No.3 >                                                       
   431  004450     MOVE  入力−契約番号             TO  ＷＳ−契約番号.         
   432  004460     MOVE  入力−再リースコード       TO  ＷＳ−再リースコード.   
   433  004470     MOVE  入力−勘定処理コード       TO  ＷＳ−勘定処理コード.   
   434  004480     EXEC SQL                                                     
   435  004490        SELECT 契約種類                                           
   436  004500          INTO :ＩＫＯ００２−契約種類                            
   437  004510          FROM IKOTBL002                                          
   438  004520          WHERE  契約ＮＯ = :ＷＳ−契約番号                       
   439  004530            AND  再リースコード = :ＷＳ−再リースコード           
   440  004540            AND  旧債権勘定処理コード = :ＷＳ−勘定処理コード     
   441  004550     END-EXEC.                                                    
   442  004560     EVALUATE  SQLCODE                                            
   443  004570        WHEN  定数−ＳＱＬＯＫ                                    
   444  004580*--<       正常 >                                                 
   445  004590     MOVE  ＩＫＯ００２−契約種類     TO  出力１−契約種類        
   446  004600           CONTINUE                                               
   447  004610        WHEN  OTHER                                               
   448  004620           MOVE -21                   TO  Ｗ−エラーコード        
   449  004630           PERFORM エラー処理                                     
   450  004640      END-EVALUATE.                                               
   451  004650                                                                  
   452  004660*--< No.4 >                                                       
   453  004670     MOVE  ZERO                       TO  出力１−回収サイト.     
   454  004680*--< No.5 >                                                       
   455  004690     MOVE  入力−入金日               TO  出力１−回収日.         
   456  004700*--< No.6 >                                                       
   457  004710*    振込                                                         
   458  004720     IF 入力−回収方式コード = '1'                                
   459  004730     MOVE  ZERO                       TO  出力１−回収方法        
   460  004740*    手形                                                         
   461  004750     ELSE IF 入力−回収方式コード = '2'                           
   462  004760     MOVE  '5'                        TO  出力１−回収方法        
   463  004770*    自動引落                                                     
   464  004780     ELSE IF 入力−回収方式コード = '3'                           
   465  004790     MOVE  '3'                        TO  出力１−回収方法        
   466  004800*    代理回収                                                     
   467  004810     ELSE IF 入力−回収方式コード = '4'                           
   468  004820     MOVE  '4'                        TO  出力１−回収方法        
   469  004830*    上記以外の場合                                               
   470  004840     ELSE                                                         
   471  004850     MOVE  ZERO                       TO  出力１−回収方法        
   472  004860     END-IF.                                                      
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   473  004870*--< No.7 >                                                       
   474  004880     MOVE  入力−基本利回り           TO  出力１−基本利回り.     
   475  004890*--< No.8 >                                                       
   476  004900     MOVE  入力−実質利回り           TO  出力１−実質利回り.     
   477  004910*--< No.9 >                                                       
   478  004920     MOVE  入力−粗利                 TO  出力１−粗利額.         
   479  004930*--< No.10 >                                                      
   480  004940     MOVE  入力−基本利回り           TO  出力１−基本利回り総額. 
   481  004950*--< No.11 >                                                      
   482  004960     MOVE  入力−基本利回り           TO  出力１−売上基本利回り. 
   483  004970*--< No.12 >                                                      
   484  004980     MOVE  入力−基本利回り           TO  出力１−一般基本利回り. 
   485  004990*--< No.13 >                                                      
   486  005000     MOVE  入力−実質利回り           TO  出力１−一般実質利回り. 
   487  005010*--< No.14 >                                                      
   488  005020     MOVE  入力−粗利                 TO  出力１−一般粗利額.     
   489  005030*--< No.15 >                                                      
   490  005040     COMPUTE Ｗ−固定資産税 = 入力−固定資産税 * 入力−リース期間.
   491  005050     MOVE  Ｗ−固定資産税             TO  出力１−固定資産税.     
   492  005060*--< No.16 >                                                      
   493  005070     COMPUTE Ｗ−動総保険料 = 入力−保険料 * 入力−リース期間.    
   494  005080     MOVE  Ｗ−動総保険料             TO  出力１−動総保険料.     
   495  005090*--< No.17 >                                                      
   496  005100     COMPUTE Ｗ−委託保守料 = 入力−保守料 * 入力−リース期間.    
   497  005110     MOVE  Ｗ−委託保守料             TO  出力１−委託保守料.     
   498  005120*--< No.18 >                                                      
   499  005130     MOVE  Ｗ−固定資産税             TO  出力１−固定資産税現価. 
   500  005140*--< No.19 >                                                      
   501  005150     MOVE  Ｗ−動総保険料             TO  出力１−動総保険料現価. 
   502  005160*--< No.20 >                                                      
   503  005170     MOVE  Ｗ−委託保守料             TO  出力１−委託保守料現価. 
   504  005180*--< No.21 >                                                      
   505  005190     MOVE  ZERO                       TO                          
   506  005191                                       出力１−一般固定資産税現価.
   507  005200*--< No.22 >                                                      
   508  005210     MOVE  ZERO                       TO                          
   509  005211                                       出力１−一般動総保険料現価.
   510  005230     MOVE  ZERO                       TO                          
   511  005231                                       出力１−一般委託保守料現価.
   512  005240*--< No.24 >                                                      
   513  005250     MOVE  ZERO                       TO  出力１−前受メリット.   
   514  005260*--< No.25 >                                                      
   515  005270     MOVE  ZERO                       TO                          
   516  005271                                         出力１−一般前受メリット.
   517  005280*--< No.26 >                                                      
   518  005290     MOVE  ZERO                       TO  出力１−繰延メリット.   
   519  005300*--< No.27 >                                                      
   520  005310     MOVE  ZERO                       TO                          
   521  005311                                         出力１−一般繰延メリット.
   522  005320*--< No.28 >                                                      
   523  005330     MOVE  入力−契約金額基本         TO                          
   524  005331                                         出力１−基本リース料総額.
   525  005340*--< No.29 >                                                      
   526  005350     COMPUTE Ｗ−基本リース料１回分                               
   527  005351                                      =                           
   528  005352                            入力−契約金額基本 / 入力−リース期間.
   529  005370     MOVE  Ｗ−基本リース料１回分     TO                          
   530  005381                                       出力１−基本リース料１回分.
   531  005390*--< No.30 >                                                      
   532  005400     COMPUTE Ｗ−固定資産税費用総額   =                           
   533  005401                              入力−固定資産税 * 入力−リース期間.
   534  005420     MOVE  Ｗ−固定資産税費用総額     TO                          
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   535  005430                                       出力１−固定資産税費用総額.
   536  005440*--< No.31 >                                                      
   537  005450     MOVE  入力−固定資産税           TO                          
   538  005460                                     出力１−固定資産税費用１回分.
   539  005470*--< No.32 >                                                      
   540  005480     COMPUTE Ｗ−動総保険料費用総額   =                           
   541  005490                                  入力−保険料 * 入力−リース期間.
   542  005500     MOVE  Ｗ−動総保険料費用総額     TO                          
   543  005510                                       出力１−動総保険料費用総額.
   544  005520*--< No.33 >                                                      
   545  005530     MOVE  入力−保険料               TO                          
   546  005531                                     出力１−動総保険料費用１回分.
   547  005540*--< No.34 >                                                      
   548  005550     MOVE  入力−契約金額実質         TO  出力１−リース料総額.   
   549  005560*--< No.35 >                                                      
   550  005570     COMPUTE Ｗ−リース料１回分       =                           
   551  005571                            入力−契約金額実質 * 入力−リース期間.
   552  005590     MOVE  Ｗ−リース料１回分         TO                          
   553  005600                                           出力１−リース料１回分.
   554  005610*--< No.36 >                                                      
   555  005620     MOVE  ZERO                       TO                          
   556  005621                                         出力１−前受メリット総額.
   557  005630*--< No.37 >                                                      
   558  005640     MOVE  ZERO                       TO                          
   559  005641                                       出力１−前受メリット１回分.
   560  005650*--< No.38 >                                                      
   561  005660     MOVE  ZERO                       TO                          
   562  005661                                        出力１−繰延メリット総額.
   563  005670*--< No.39 >                                                      
   564  005680     MOVE  ZERO                       TO                          
   565  005681                                       出力１−繰延メリット１回分.
   566  005690*--< No.40 >                                                      
   567  005700     MOVE  入力−実リース料−実質     TO                          
   568  005710                                         出力１−実質リース料総額.
   569  005720*--< No.41 >                                                      
   570  005730     COMPUTE Ｗ−実質リース料１回分   =                           
   571  005731                       入力−実リース料−実質 / 入力−リース期間. 
   572  005750     MOVE  Ｗ−実質リース料１回分     TO                          
   573  005760                                       出力１−実質リース料１回分.
   574  005770*--< No.42 >                                                      
   575  005780     MOVE  ZERO                       TO                          
   576  005781                                         出力１−実質リース料現価.
   577  005790*--< No.43 >                                                      
   578  005800     MOVE  入力−初期費用             TO  出力１−初期費用.       
   579  005810*--< No.44 >                                                      
   580  005820     MOVE  ZERO                       TO  出力１−期中費用現価.   
   581  005830*--< No.45 >                                                      
   582  005840     MOVE  入力−契約金額基本         TO                          
   583  005850                                     出力１−基本リース料総額当社.
   584  005860*--< No.46 >                                                      
   585  005870     COMPUTE Ｗ−基本リース料１回分当社                           
   586  005871                                      =                           
   587  005880                           入力−契約金額基本  / 入力−リース期間.
   588  005890     MOVE  Ｗ−基本リース料１回分当社 TO                          
   589  005900                           出力１−基本リース料１回分当社.        
   590  005910*--< No.47 >                                                      
   591  005920     COMPUTE Ｗ−固定資産税費用総額当社                           
   592  005921                                      =                           
   593  005930                              入力−固定資産税 * 入力−リース期間.
   594  005940     MOVE  Ｗ−固定資産税費用総額当社 TO                          
   595  005950                                   出力１−固定資産税費用総額当社.
   596  005960*--< No.48 >                                                      
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   597  005970     MOVE  入力−固定資産税           TO                          
   598  005980                                 出力１−固定資産税費用１回分当社.
   599  005990*--< No.49 >                                                      
   600  006000     COMPUTE Ｗ−動総保険料費用総額当社                           
   601  006001                                      =                           
   602  006011                                  入力−保険料 * 入力−リース期間.
   603  006020     MOVE  Ｗ−動総保険料費用総額当社 TO                          
   604  006030                                   出力１−動総保険料費用総額当社.
   605  006040*--< No.50 >                                                      
   606  006050     MOVE  入力−保険料               TO                          
   607  006060                                 出力１−動総保険料費用１回分当社.
   608  006070*--< No.51 >                                                      
   609  006080     MOVE  入力−契約金額実質         TO                          
   610  006081                                         出力１−リース料総額当社.
   611  006090*--< No.52 >                                                      
   612  006100     COMPUTE Ｗ−リース料１回分当社   =                           
   613  006110                            入力−契約金額実質 / 入力−リース期間.
   614  006120     MOVE  Ｗ−リース料１回分当社     TO                          
   615  006130                                       出力１−リース料１回分当社.
   616  006140*--< No.53 >                                                      
   617  006150     MOVE  ZERO                       TO                          
   618  006151                                     出力１−前受メリット総額当社.
   619  006160*--< No.54 >                                                      
   620  006170     MOVE  ZERO                       TO                          
   621  006171                                   出力１−前受メリット１回分当社.
   622  006180*--< No.55 >                                                      
   623  006190     MOVE  ZERO                       TO                          
   624  006191                                     出力１−繰延メリット総額当社.
   625  006200*--< No.56 >                                                      
   626  006210     MOVE  ZERO                       TO                          
   627  006211                                   出力１−繰延メリット１回分当社.
   628  006220*--< No.57 >                                                      
   629  006230     MOVE  入力−契約金額実質         TO                          
   630  006240                                     出力１−実質リース料総額当社.
   631  006250*--< No.58 >                                                      
   632  006260     COMPUTE Ｗ−実質リース料１回分当社                           
   633  006261                                      =                           
   634  006270                           入力−契約金額実質  / 入力−リース期間.
   635  006280     MOVE  Ｗ−実質リース料１回分当社 TO                          
   636  006290                                   出力１−実質リース料１回分当社.
   637  006300*--< No.59 >                                                      
   638  006310     MOVE  ZERO                       TO                          
   639  006311                                     出力１−実質リース料現価当社.
   640  006320*--< No.60 >                                                      
   641  006330     MOVE  ZERO                       TO                          
   642  006331                                         出力１−残価回収現価当社.
   643  006340*--< No.61 >                                                      
   644  006350     MOVE  入力−初期費用             TO  出力１−初期費用当社.   
   645  006360*--< No.62 >                                                      
   646  006370     MOVE  ZERO                       TO                          
   647  006371                                         出力１−期中費用現価当社.
   648  006380*--< No.63 >                                                      
   649  006390     MOVE  ZERO                       TO  出力１−残価回収現価.   
   650  006400*--< No.64 >                                                      
   651  006410     MOVE  入力−粗利                 TO  出力１−粗利益全体.     
   652  006420*--< No.65 >                                                      
   653  006430     MOVE  ZERO                       TO                          
   654  006431                                     出力１−一般実質リース料現価.
   655  006440*--< No.66 >                                                      
   656  006450     MOVE  ZERO                       TO                          
   657  006451                                         出力１−一般残価回収現価.
   658  006460*--< No.67 >                                                      
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   659  006470     MOVE  ZERO                       TO                          
   660  006471                                         出力１−一般期中費用現価.
   661  006480*--< No.68 >                                                      
   662  006490     MOVE  入力−粗利                 TO  出力１−一般粗利額全体. 
   663  006500*--< No.69 >                                                      
   664  006510     MOVE  ZERO                       TO                          
   665  006511                                 出力１−一般実質リース料現価当社.
   666  006520*--< No.70 >                                                      
   667  006530     MOVE  ZERO                       TO                          
   668  006531                                     出力１−一般残価回収現価当社.
   669  006540*--< No.71 >                                                      
   670  006550     MOVE  ZERO                       TO                          
   671  006551                                     出力１−一般期中費用現価当社.
   672  006560*--< No.72 >                                                      
   673  006570     MOVE  ZERO                       TO  出力１−当社持分比率.   
   674  006580*--< No.73 >                                                      
   675  006590     MOVE  ZERO                       TO  出力１−基本元本金額.   
   676  006600*--< No.74 >                                                      
   677  006610     MOVE  ZERO                       TO  出力１−リース料現価.   
   678  006620*--< No.75 >                                                      
   679  006630     MOVE  ZERO                       TO                          
   680  006631                                         出力１−リース料現価当社.
   681  006640*--< No.76 >                                                      
   682  006650     COMPUTE Ｗ−その他諸費用         =                           
   683  006660           ( 入力−その他１ + 入力−その他２ ) * 入力−リース期間.
   684  006670     MOVE  Ｗ−その他諸費用           TO  出力１−その他諸費用.   
   685  006680*--< No.77 >                                                      
   686  006690     COMPUTE Ｗ−その他諸費用現価     =                           
   687  006700          ( 入力−その他１ + 入力−その他２ )  * 入力−リース期間.
   688  006710                                                                  
   689  006720     MOVE  Ｗ−その他諸費用現価       TO                          
   690  006730                                         出力１−その他諸費用現価.
   691  006740*--< No.78 >                                                      
   692  006750     MOVE  ZERO                       TO                          
   693  006751                                     出力１−一般その他諸費用現価.
   694  006760*--< No.79 >                                                      
   695  006770     MOVE  ZERO                       TO                          
   696  006771                                       出力１−委託保険料費用総額.
   697  006780*--< No.80 >                                                      
   698  006790     MOVE  ZERO                       TO                          
   699  006791                                     出力１−委託保険料費用１回分.
   700  006800*--< No.81 >                                                      
   701  006810     COMPUTE Ｗ−その他諸費用総額     =                           
   702  006820           ( 入力−その他１ + 入力−その他２ ) * 入力−リース期間.
   703  006830     MOVE  Ｗ−その他諸費用総額       TO                          
   704  006840                                         出力１−その他諸費用総額.
   705  006850*--< No.82 >                                                      
   706  006860     COMPUTE Ｗ−その他諸費用１回分   =                           
   707  006870                                   入力−その他１ + 入力−その他２
   708  006880     MOVE  Ｗ−その他諸費用１回分     TO                          
   709  006890                                       出力１−その他諸費用１回分.
   710  006900*--< No.83 >                                                      
   711  006910     MOVE  ZERO                       TO                          
   712  006911                                   出力１−委託保険料費用総額当社.
   713  006920*--< No.84 >                                                      
   714  006930     MOVE  ZERO                       TO                          
   715  006931                                 出力１−委託保険料費用１回分当社.
   716  006940*--< No.85 >                                                      
   717  006950     COMPUTE Ｗ−その他諸費用総額当社 =                           
   718  006960           ( 入力−その他１ + 入力−その他２ ) * 入力−リース期間.
   719  006970     MOVE  Ｗ−その他諸費用総額当社   TO                          
   720  006980                                     出力１−その他諸費用総額当社.
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   721  006990*--< No.86 >                                                      
   722  007000     COMPUTE Ｗ−その他諸費用１回分当社                           
   723  007001                                      =                           
   724  007010                                  入力−その他１  + 入力−その他２
   725  007020     MOVE  Ｗ−その他諸費用１回分当社 TO                          
   726  007030                                   出力１−その他諸費用１回分当社.
   727  007040*--< No.87 >                                                      
   728  007050     MOVE  Ｗ−システム日付           TO  出力１−更新年月日.     
   729  007060*--< No.88 >                                                      
   730  007070     MOVE  Ｗ−システム時刻           TO  出力１−更新時間.       
   731  007080*--< No.89 >                                                      
   732  007090     MOVE  Ｗ−担当者                 TO  出力１−更新者.         
   733  007100*--< No.90 >                                                      
   734  007110     MOVE  Ｗ−システム日付           TO  出力１−登録年月日.     
   735  007120*--< No.91 >                                                      
   736  007130     MOVE  Ｗ−システム時刻           TO  出力１−登録時間.       
   737  007140*--< No.92 >                                                      
   738  007150     MOVE  Ｗ−担当者                 TO  出力１−登録担当者.     
   739  007160*--< No.93 >                                                      
   740  007170     MOVE  Ｗ−担当者                 TO                          
   741  007171                                         出力１−入力担当者コード.
   742  007180*                                                                 
   743             PERFORM                          協調幹事持分以外出力処理.                            
   744  007200*                                                                 
   745  007210*--< 検収後協調幹事持分以外出力の状態判定 >                       
   746  007220     EVALUATE  Ｗ−状態                                           
   747  007230        WHEN  ZERO                                                
   748  007240*--<       検収後協調幹事持分以外出力件数の加算 >                 
   749  007250           COMPUTE  Ｗ−持分以外−件数 =  Ｗ−持分以外−件数 + 1  
   750  007260        WHEN  OTHER                                               
   751  007270*--<       検収後協調幹事持分以外ファイル出力エラー >             
   752  007280           MOVE     -5                TO  Ｗ−エラーコード        
   753  007290           PERFORM  エラー処理                                    
   754  007300     END-EVALUATE.                                                
   755  007310*                                                                 
   756  007320 協調幹事持分以外編集処理−ＥＸＩＴ.                      
   757  007330     EXIT.                                                        
   758  003970******************************************************************
   759  003980*    協調幹事持分以外出力処理                                *
   760  003990******************************************************************
   761  004000 協調幹事持分以外出力処理         SECTION.                    
   762  004010 協調幹事持分以外出力処理−ＳＴＡＲＴ.                        
   763  007190     WRITE  出力１−レコード. 
   764  004090 協調幹事持分以外出力処理−ＥＸＩＴ.                          
   765  004100     EXIT.   
   766  007340******************************************************************
   767  007350*    協調幹事持分編集処理                                    *
   768  007360******************************************************************
   769  007500 協調幹事持分編集処理               SECTION.              
   770  007510 協調幹事持分編集処理−ＳＴＡＲＴ.                        
   771  007520*
   772             INITIALIZE                       出力２−レコード.
   773  007530*--< 協調幹事持分レコード基本項目の編集処理 >                     
   774  007550*--< No.1 >                                                       
   775  007560     MOVE  入力−契約番号             TO  出力２−契約番号.       
   776  007570*--< No.2 >                                                       
   777  007580     MOVE  入力−契約番号             TO  ＷＳ−契約番号.         
   778  007590     MOVE  入力−再リースコード       TO  ＷＳ−再リースコード.   
   779  007600     MOVE  入力−勘定処理コード       TO  ＷＳ−勘定処理コード.   
   780  007610     EXEC SQL                                                     
   781  007620        SELECT 再リース回数                                       
   782  007630          INTO :ＩＫＯ００２−再リース回数                        
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   783  007640          FROM IKOTBL002                                          
   784  007650          WHERE  契約ＮＯ = :ＷＳ−契約番号                       
   785  007660            AND  再リースコード = :ＷＳ−再リースコード           
   786  007670            AND  旧債権勘定処理コード = :ＷＳ−勘定処理コード     
   787  007680     END-EXEC.                                                    
   788  007700     EVALUATE  SQLCODE                                            
   789  007710        WHEN  定数−ＳＱＬＯＫ                                    
   790  007720*--<       正常 >                                                 
   791  007730     MOVE  ＩＫＯ００２−再リース回数 TO  出力１−再リース回数    
   792  007740           CONTINUE                                               
   793  007750        WHEN  OTHER                                               
   794  007760           MOVE -12                   TO  Ｗ−エラーコード        
   795  007770           PERFORM エラー処理                                     
   796  007780      END-EVALUATE.                                               
   797  007790*--< No.3 >                                                       
   798  007830     MOVE  入力−契約番号             TO  ＷＳ−契約番号.         
   799  007840     MOVE  入力−再リースコード       TO  ＷＳ−再リースコード.   
   800  007850     MOVE  入力−勘定処理コード       TO  ＷＳ−勘定処理コード.   
   801  007860     EXEC SQL                                                     
   802  007870        SELECT 契約種類                                           
   803  007880          INTO :ＩＫＯ００２−契約種類                            
   804  007890          FROM IKOTBL002                                          
   805  007900          WHERE  契約ＮＯ = :ＷＳ−契約番号                       
   806  007910            AND  再リースコード = :ＷＳ−再リースコード           
   807  007920            AND  旧債権勘定処理コード = :ＷＳ−勘定処理コード     
   808  007930     END-EXEC.                                                    
   809  007940     EVALUATE  SQLCODE                                            
   810  007950        WHEN  定数−ＳＱＬＯＫ                                    
   811  007960*--<       正常 >                                                 
   812  007970     MOVE  ＩＫＯ００２−契約種類     TO  出力２−契約種類        
   813  007980           CONTINUE                                               
   814  007990        WHEN  OTHER                                               
   815  008000           MOVE -22                   TO  Ｗ−エラーコード        
   816  008010           PERFORM エラー処理                                     
   817  008020      END-EVALUATE.                                               
   818  008030*--< No.4 >                                                       
   819  008040     MOVE  ZERO                       TO  出力２−回収サイト.     
   820  008050*--< No.5 >                                                       
   821  008060     MOVE  入力−入金日               TO  出力２−回収日.         
   822  008070*--< No.6 >                                                       
   823  008080*    振込                                                         
   824  008090     IF 入力−回収方式コード = '1'                                
   825  008100     MOVE  ZERO                       TO  出力２−回収方法        
   826  008110*    手形                                                         
   827  008120     ELSE IF 入力−回収方式コード = '2'                           
   828  008130     MOVE  '5'                        TO  出力２−回収方法        
   829  008140*    自動引落                                                     
   830  008150     ELSE IF 入力−回収方式コード = '3'                           
   831  008160     MOVE  '3'                        TO  出力２−回収方法        
   832  008170*    代理回収                                                     
   833  008180     ELSE IF 入力−回収方式コード = '4'                           
   834  008190     MOVE  '4'                        TO  出力２−回収方法        
   835  008200*    上記以外の場合                                               
   836  008210     ELSE                                                         
   837  008220     MOVE  ZERO                       TO  出力２−回収方法        
   838  008230     END-IF.                                                      
   839  008240*--< No.7 >                                                       
   840  008250     MOVE  入力−基本利回り           TO  出力２−基本利回り.     
   841  008260*--< No.8 >                                                       
   842  008270     MOVE  入力−実質利回り           TO  出力２−実質利回り.     
   843  008280*--< No.9 >                                                       
   844  008290     MOVE  入力−粗利                 TO  出力２−粗利額.         
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   845  008300*--< No.10 >                                                      
   846  008310     MOVE  入力−基本利回り           TO  出力２−基本利回り総額. 
   847  008320*--< No.11 >                                                      
   848  008330     MOVE  入力−基本利回り           TO  出力２−売上基本利回り. 
   849  008340*--< No.12 >                                                      
   850  008350     MOVE  入力−基本利回り           TO  出力２−一般基本利回り. 
   851  008360*--< No.13 >                                                      
   852  008370     MOVE  入力−実質利回り           TO  出力２−一般実質利回り. 
   853  008380*--< No.14 >                                                      
   854  008390     MOVE  入力−粗利                 TO  出力２−一般粗利額.     
   855  008400*--< No.15 >                                                      
   856  008410     COMPUTE Ｗ−固定資産税           =                           
   857  008411                              入力−固定資産税 * 入力−リース期間.
   858  008420     MOVE  Ｗ−固定資産税             TO  出力２−固定資産税.     
   859  008430*--< No.16 >                                                      
   860  008440     COMPUTE Ｗ−動総保険料           =                           
   861  008441                                  入力−保険料 * 入力−リース期間.
   862  008450     MOVE  Ｗ−動総保険料             TO  出力２−動総保険料.     
   863  008460*--< No.17 >                                                      
   864  008470     COMPUTE Ｗ−委託保守料           =                           
   865  008471                                  入力−保守料 * 入力−リース期間.
   866  008480     MOVE  Ｗ−委託保守料             TO  出力２−委託保守料.     
   867  008490*--< No.18 >                                                      
   868  008500     MOVE  Ｗ−固定資産税             TO  出力２−固定資産税現価. 
   869  008510*--< No.19 >                                                      
   870  008520     MOVE  Ｗ−動総保険料             TO  出力２−動総保険料現価. 
   871  008530*--< No.20 >                                                      
   872  008540     MOVE  Ｗ−委託保守料             TO  出力２−委託保守料現価. 
   873  008550*--< No.21 >                                                      
   874  008560     MOVE  ZERO                       TO                          
   875  008561                                       出力２−一般固定資産税現価.
   876  008570*--< No.22 >                                                      
   877  008580     MOVE  ZERO                       TO                          
   878  008581                                       出力２−一般動総保険料現価.
   879  008590*--< No.23 >                                                      
   880  008600     MOVE  ZERO                       TO                          
   881  008601                                       出力２−一般委託保守料現価.
   882  008610*--< No.24 >                                                      
   883  008620     MOVE  ZERO                       TO  出力２−前受メリット.   
   884  008630*--< No.25 >                                                      
   885  008640     MOVE  ZERO                       TO                          
   886  008641                                         出力２−一般前受メリット.
   887  008650*--< No.26 >                                                      
   888  008660     MOVE  ZERO                       TO  出力２−繰延メリット.   
   889  008670*--< No.27 >                                                      
   890  008680     MOVE  ZERO                       TO                          
   891  008681                                         出力２−一般繰延メリット.
   892  008690*--< No.28 >                                                      
   893  008700     MOVE  入力−契約金額基本         TO                          
   894  008701                                         出力２−基本リース料総額.
   895  008710*--< No.29 >                                                      
   896  008720     COMPUTE Ｗ−基本リース料１回分   =                           
   897  008730                            入力−契約金額基本 / 入力−リース期間.
   898  008740     MOVE  Ｗ−基本リース料１回分     TO                          
   899  008750                                       出力２−基本リース料１回分.
   900  008760*--< No.30 >                                                      
   901  008770     COMPUTE Ｗ−固定資産税費用総額   =                           
   902  008780                              入力−固定資産税 * 入力−リース期間.
   903  008790     MOVE  Ｗ−固定資産税費用総額     TO                          
   904  008800                                       出力２−固定資産税費用総額.
   905  008810*--< No.31 >                                                      
   906  008820     MOVE  入力−固定資産税           TO                          
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   907  008830                                     出力２−固定資産税費用１回分.
   908  008840*--< No.32 >                                                      
   909  008850     COMPUTE Ｗ−動総保険料費用総額   =                           
   910  008860                                  入力−保険料 * 入力−リース期間.
   911  008870     MOVE  Ｗ−動総保険料費用総額     TO                          
   912  008880                                       出力２−動総保険料費用総額.
   913  008890*--< No.33 >                                                      
   914  008900     MOVE  入力−保険料               TO                          
   915  008901                                     出力２−動総保険料費用１回分.
   916  008910*--< No.34 >                                                      
   917  008920     MOVE  入力−契約金額実質         TO  出力２−リース料総額.   
   918  008930*--< No.35 >                                                      
   919  008940     COMPUTE Ｗ−リース料１回分       =                           
   920  008950                            入力−契約金額実質 * 入力−リース期間.
   921  008960     MOVE  Ｗ−リース料１回分         TO  出力２−リース料１回分. 
   922  008980*--< No.36 >                                                      
   923  008990     MOVE  ZERO                       TO                          
   924  008991                                         出力２−前受メリット総額.
   925  009000*--< No.37 >                                                      
   926  009010     MOVE  ZERO                       TO                          
   927  009011                                       出力２−前受メリット１回分.
   928  009020*--< No.38 >                                                      
   929  009030     MOVE  ZERO                       TO                          
   930  009031                                         出力２−繰延メリット総額.
   931  009040*--< No.39 >                                                      
   932  009050     MOVE  ZERO                       TO                          
   933  009051                                       出力２−繰延メリット１回分.
   934  009060*--< No.40 >                                                      
   935  009070     MOVE  入力−実リース料−実質     TO                          
   936  009080                                         出力２−実質リース料総額.
   937  009090*--< No.41 >                                                      
   938  009100     COMPUTE Ｗ−実質リース料１回分   =                           
   939  009110                       入力−実リース料−実質  / 入力−リース期間.
   940  009120     MOVE  Ｗ−実質リース料１回分     TO                          
   941  009130                                       出力２−実質リース料１回分.
   942  009140*--< No.42 >                                                      
   943  009150     MOVE  ZERO                       TO                          
   944  009151                                         出力２−実質リース料現価.
   945  009160*--< No.43 >                                                      
   946  009170     MOVE  入力−初期費用             TO  出力２−初期費用.       
   947  009180*--< No.44 >                                                      
   948  009190     MOVE  ZERO                       TO  出力２−期中費用現価.   
   949  009200*--< No.45 >                                                      
   950  009210     MOVE  入力−契約金額基本         TO                          
   951  009220                                     出力２−基本リース料総額当社.
   952  009230*--< No.46 >                                                      
   953  009240     COMPUTE Ｗ−基本リース料１回分当社                           
   954  009241                                      =                           
   955  009250                           入力−契約金額基本  / 入力−リース期間.
   956  009260     MOVE  Ｗ−基本リース料１回分当社 TO                          
   957  009270                                   出力２−基本リース料１回分当社.
   958  009280*--< No.47 >                                                      
   959  009290     COMPUTE Ｗ−固定資産税費用総額当社                           
   960  009291                                      =                           
   961  009300                             入力−固定資産税  * 入力−リース期間.
   962  009310     MOVE  Ｗ−固定資産税費用総額当社 TO                          
   963  009320                                   出力２−固定資産税費用総額当社.
   964  009330*--< No.48 >                                                      
   965  009340     MOVE  入力−固定資産税           TO                          
   966  009350                           出力２−固定資産税費用１回分当社.      
   967  009360*--< No.49 >                                                      
   968  009370     COMPUTE Ｗ−動総保険料費用総額当社                           
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   969  009371                                      =                           
   970  009380                                 入力−保険料  * 入力−リース期間.
   971  009390     MOVE  Ｗ−動総保険料費用総額当社 TO                          
   972  009400                                   出力２−動総保険料費用総額当社.
   973  009410*--< No.50 >                                                      
   974  009420     MOVE  入力−保険料               TO                          
   975  009430                                 出力２−動総保険料費用１回分当社.
   976  009440*--< No.51 >                                                      
   977  009450     MOVE  入力−契約金額実質         TO                          
   978  009451                                         出力２−リース料総額当社.
   979  009460*--< No.52 >                                                      
   980  009470     COMPUTE Ｗ−リース料１回分当社   =                           
   981  009480                            入力−契約金額実質 / 入力−リース期間.
   982  009490     MOVE  Ｗ−リース料１回分当社     TO                          
   983  009500                                       出力２−リース料１回分当社.
   984  009510*--< No.53 >                                                      
   985  009520     MOVE  ZERO                       TO                          
   986  009521                                     出力２−前受メリット総額当社.
   987  009530*--< No.54 >                                                      
   988  009540     MOVE  ZERO                       TO                          
   989  009541                                   出力２−前受メリット１回分当社.
   990  009550*--< No.55 >                                                      
   991  009560     MOVE  ZERO                       TO                          
   992  009561                                     出力２−繰延メリット総額当社.
   993  009570*--< No.56 >                                                      
   994  009580     MOVE  ZERO                       TO                          
   995  009581                                   出力２−繰延メリット１回分当社.
   996  009590*--< No.57 >                                                      
   997  009600     MOVE  入力−契約金額実質         TO                          
   998  009610                                     出力２−実質リース料総額当社.
   999  009620*--< No.58 >                                                      
  1000  009630     COMPUTE Ｗ−実質リース料１回分当社                           
  1001  009631                                      =                           
  1002  009640                           入力−契約金額実質  / 入力−リース期間.
  1003  009650     MOVE  Ｗ−実質リース料１回分当社 TO                          
  1004  009660                                   出力２−実質リース料１回分当社.
  1005  009670*--< No.59 >                                                      
  1006  009680     MOVE  ZERO                       TO                          
  1007  009681                                    出力２−実質リース料現価当社. 
  1008  009690*--< No.60 >                                                      
  1009  009700     MOVE  ZERO                       TO                          
  1010  009701                                         出力２−残価回収現価当社.
  1011  009710*--< No.61 >                                                      
  1012  009720     MOVE  入力−初期費用             TO                          
  1013  009721                                             出力２−初期費用当社.
  1014  009730*--< No.62 >                                                      
  1015  009740     MOVE  ZERO                       TO                          
  1016  009741                                         出力２−期中費用現価当社.
  1017  009750*--< No.63 >                                                      
  1018  009760     MOVE  ZERO                       TO  出力２−残価回収現価.   
  1019  009770*--< No.64 >                                                      
  1020  009780     MOVE  入力−粗利                 TO  出力２−粗利益全体.     
  1021  009790*--< No.65 >                                                      
  1022  009800     MOVE  ZERO                       TO                          
  1023  009801                                     出力２−一般実質リース料現価.
  1024  009810*--< No.66 >                                                      
  1025  009820     MOVE  ZERO                       TO                          
  1026  009821                                         出力２−一般残価回収現価.
  1027  009830*--< No.67 >                                                      
  1028  009840     MOVE  ZERO                       TO                          
  1029  009841                                         出力２−一般期中費用現価.
  1030  009850*--< No.68 >                                                      
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  1031  009860     MOVE  入力−粗利                 TO  出力２−一般粗利額全体. 
  1032  009870*--< No.69 >                                                      
  1033  009880     MOVE  ZERO                       TO                          
  1034  009881                                 出力２−一般実質リース料現価当社.
  1035  009890*--< No.70 >                                                      
  1036  009900     MOVE  ZERO                       TO                          
  1037  009901                                     出力２−一般残価回収現価当社.
  1038  009910*--< No.71 >                                                      
  1039  009920     MOVE  ZERO                       TO                          
  1040  009921                                     出力２−一般期中費用現価当社.
  1041  009930*--< No.72 >                                                      
  1042  009940     MOVE  ZERO                       TO  出力２−当社持分比率.   
  1043  009950*--< No.73 >                                                      
  1044  009960     MOVE  ZERO                       TO  出力２−基本元本金額.   
  1045  009970*--< No.74 >                                                      
  1046  009980     MOVE  ZERO                       TO  出力２−リース料現価.   
  1047  009990*--< No.75 >                                                      
  1048  010000     MOVE  ZERO                       TO                          
  1049  010001                                         出力２−リース料現価当社.
  1050  010010*--< No.76 >                                                      
  1051  010020     COMPUTE Ｗ−その他諸費用         =                           
  1052  010030           ( 入力−その他１ + 入力−その他２)  * 入力−リース期間.
  1053  010040     MOVE  Ｗ−その他諸費用           TO                          
  1054  010050                                             出力２−その他諸費用.
  1055  010060*--< No.77 >                                                      
  1056  010070     COMPUTE Ｗ−その他諸費用現価     =                           
  1057  010080          ( 入力−その他１ + 入力−その他２ )  * 入力−リース期間.
  1058  010090     MOVE  Ｗ−その他諸費用現価       TO                          
  1059  010100                                         出力２−その他諸費用現価.
  1060  010110*--< No.78 >                                                      
  1061  010120     MOVE  ZERO                       TO                          
  1062  010121                                     出力２−一般その他諸費用現価.
  1063  010130*--< No.79 >                                                      
  1064  010140     MOVE  ZERO                       TO                          
  1065  010141                                       出力２−委託保険料費用総額.
  1066  010150*--< No.80 >                                                      
  1067  010160     MOVE  ZERO                       TO                          
  1068  010161                                     出力２−委託保険料費用１回分.
  1069  010170*--< No.81 >                                                      
  1070  010180     COMPUTE Ｗ−その他諸費用総額     =                           
  1071  010190           ( 入力−その他１ + 入力−その他２ ) * 入力−リース期間.
  1072  010200     MOVE  Ｗ−その他諸費用総額       TO                          
  1073  010210                                         出力２−その他諸費用総額.
  1074  010220*--< No.82 >                                                      
  1075  010230     COMPUTE Ｗ−その他諸費用１回分   =                           
  1076  010240                                  入力−その他１  + 入力−その他２
  1077  010250     MOVE  Ｗ−その他諸費用１回分     TO                          
  1078  010260                                       出力２−その他諸費用１回分.
  1079  010270*--< No.83 >                                                      
  1080  010280     MOVE  ZERO                       TO                          
  1081  010281                                   出力２−委託保険料費用総額当社.
  1082  010290*--< No.84 >                                                      
  1083  010300     MOVE  ZERO                       TO                          
  1084  010301                                 出力２−委託保険料費用１回分当社.
  1085  010310*--< No.85 >                                                      
  1086  010320     COMPUTE Ｗ−その他諸費用総額当社 =                           
  1087  010330          ( 入力−その他１  + 入力−その他２ ) * 入力−リース期間.
  1088  010340     MOVE  Ｗ−その他諸費用総額当社   TO                          
  1089  010350                                     出力２−その他諸費用総額当社.
  1090  010360*--< No.86 >                                                      
  1091  010370     COMPUTE Ｗ−その他諸費用１回分当社                           
  1092  010371                                      =                           
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  1093  010380                                   入力−その他１ + 入力−その他２
  1094  010390     MOVE  Ｗ−その他諸費用１回分当社 TO                          
  1095  010400                                   出力２−その他諸費用１回分当社.
  1096  010410*--< No.87 >                                                      
  1097  010420     MOVE  Ｗ−システム日付           TO  出力２−更新年月日.     
  1098  010430*--< No.88 >                                                      
  1099  010440     MOVE  Ｗ−システム時刻           TO  出力２−更新時間.       
  1100  010450*--< No.89 >                                                      
  1101  010460     MOVE  Ｗ−担当者                 TO  出力２−更新者.         
  1102  010470*--< No.90 >                                                      
  1103  010480     MOVE  Ｗ−システム日付           TO  出力２−登録年月日.     
  1104  010490*--< No.91 >                                                      
  1105  010500     MOVE  Ｗ−システム時刻           TO  出力２−登録時間.       
  1106  010510*--< No.92 >                                                      
  1107  010520     MOVE  Ｗ−担当者                 TO  出力２−登録担当者.     
  1108  010530*--< No.93 >                                                      
  1109  010540     MOVE  Ｗ−担当者                 TO                          
  1110  010541                                         出力２−入力担当者コード.
  1111  010550*                                                                 
  1112             PERFORM                          協調幹事持分出力処理.                             
  1113  010570*                                                                 
  1114  010580*--< 協調幹事持分出力の状態判定 >                                 
  1115  010590     EVALUATE  Ｗ−状態                                           
  1116  010600        WHEN  ZERO                                                
  1117  010610*--<       協調幹事持分出力件数の加算 >                           
  1118  010620           COMPUTE  Ｗ−持分−件数 =  Ｗ−持分−件数 + 1          
  1119  010630        WHEN  OTHER                                               
  1120  010640*--<       協調幹事持分ファイル出力エラー >                       
  1121  010650           MOVE     -6                TO  Ｗ−エラーコード        
  1122  010660           PERFORM  エラー処理                                    
  1123  010670     END-EVALUATE.                                                
  1124  010680*                                                                 
  1125  010690 協調幹事持分編集処理−ＥＸＩＴ.                          
  1126  010700     EXIT.                                                        
  1127  003970******************************************************************
  1128  003980*    協調幹事持分出力処理                                *
  1129  003990******************************************************************
  1130  004000 協調幹事持分出力処理         SECTION.                    
  1131  004010 協調幹事持分出力処理−ＳＴＡＲＴ.                        
  1132  007190     WRITE  出力２−レコード. 
  1133  004090 協調幹事持分出力処理−ＥＸＩＴ.                          
  1134  004100     EXIT.   
  1135  010710                                                                  
  1136  010720                                                                  
  1137  010730******************************************************************
  1138  010740*    終了メッセージ出力                                          *
  1139  010750******************************************************************
  1140  010760  終了メッセージ出力                  SECTION.                    
  1141  010770  終了メッセージ出力−ＳＴＡＲＴ.                                 
  1142  010780*----------------------------------------------------------------*
  1143  010790*    債権明細ファイル入力件数                                    *
  1144  010800*----------------------------------------------------------------*
  1145  010810     INITIALIZE                       IF-CHOCO001.                
  1146  010820     MOVE  "3"                        TO  共通−イベント種別.     
  1147  010830     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
  1148  010840     MOVE  "0"                        TO  共通−復帰コード.       
  1149  010850     MOVE  "FFUIS350"                 TO  共通−処理テーブルＩＤ. 
  1150  010860     MOVE  "COUNT"                    TO  共通−処理識別.         
  1151  010870     MOVE  Ｗ−債権明細−件数         TO  共通−データ内容.       
  1152  010880     MOVE  "債権明細ファイル入力件数"                                     
  1153  010890                                      TO  共通−その他メッセージ. 
  1154  010900     CALL  CLOCO001                USING  IF-CHOCO001.            
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  1155  010910*                                                                 
  1156  010920*----------------------------------------------------------------*
  1157  010930*    検収後協調幹事持分以外ファイル出力件数                      *
  1158  010940*----------------------------------------------------------------*
  1159  010950     INITIALIZE                       IF-CHOCO001.                
  1160  010960     MOVE  "3"                        TO  共通−イベント種別.     
  1161  010970     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
  1162  010980     MOVE  "0"                        TO  共通−復帰コード.       
  1163  010990     MOVE  "FFUIS351"                 TO  共通−処理テーブルＩＤ. 
  1164  011000     MOVE  "COUNT"                    TO  共通−処理識別.         
  1165  011010     MOVE  Ｗ−持分以外−件数             TO  共通−データ内容.   
  1166  011020     MOVE  "検収後・協調持分以外出力件数"                   
  1167  011030                                      TO  共通−その他メッセージ. 
  1168  011040     CALL  CLOCO001                USING  IF-CHOCO001.            
  1169  011050*                                                                 
  1170  011060*----------------------------------------------------------------*
  1171  011070*    検収後協調幹事持分ファイル出力件数                          *
  1172  011080*----------------------------------------------------------------*
  1173  011090     INITIALIZE                       IF-CHOCO001.                
  1174  011100     MOVE  "3"                        TO  共通−イベント種別.     
  1175  011110     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
  1176  011120     MOVE  "0"                        TO  共通−復帰コード.       
  1177  011130     MOVE  "FFUIS352"                 TO  共通−処理テーブルＩＤ. 
  1178  011140     MOVE  "COUNT"                    TO  共通−処理識別.         
  1179  011150     MOVE  Ｗ−持分−件数             TO  共通−データ内容.       
  1180  011160     MOVE  "検収後・協調持分出力件数"                       
  1181  011170                                      TO  共通−その他メッセージ. 
  1182  011180     CALL  CLOCO001                USING  IF-CHOCO001.            
  1183  011190*                                                                 
  1184  011200*----------------------------------------------------------------*
  1185  011210*    終了メッセージ 出力                                         *
  1186  011220*----------------------------------------------------------------*
  1187  011230     INITIALIZE                       IF-CHOCO001.                
  1188  011240     MOVE  "3"                        TO  共通−イベント種別.     
  1189  011250     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
  1190  011260     MOVE  "0"                        TO  共通−復帰コード.       
  1191  011270     MOVE  "END"                      TO  共通−処理識別.         
  1192  011280     MOVE  定数−プログラム名         TO  共通−その他メッセージ. 
  1193  011290     CALL  CLOCO001                USING  IF-CHOCO001.            
  1194  011300*                                                                 
  1195  011310 終了メッセージ出力−ＥＸＩＴ.                                    
  1196  011320     EXIT.                                                        
  1197  011330******************************************************************
  1198  011340*    エラー処理                                                  *
  1199  011350******************************************************************
  1200  011360 エラー処理                           SECTION.                    
  1201  011370 エラー処理−ＳＴＡＲＴ.                                          
  1202  011380*                                                                 
  1203  011390     MOVE  "Y"                        TO  Ｗ−異常終了−フラグ.   
  1204  011400     INITIALIZE                           IF-CHOCO001.            
  1205  011410*                                                                 
  1206  011420     EVALUATE  Ｗ−エラーコード                                   
  1207  011430        WHEN  -1                                                  
  1208  011440*--<       債権明細ファイルオープンエラー >                       
  1209  011450           MOVE  "1"                  TO  共通−イベント種別      
  1210  011460           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1211  011470           MOVE  "9"                  TO  共通−復帰コード        
  1212  011480           MOVE  "FFUIS350"           TO  共通−処理テーブルＩＤ  
  1213  011490           MOVE  "OPEN"               TO  共通−処理識別          
  1214  011500           MOVE  Ｗ−状態             TO  共通−データ内容        
  1215  011510           MOVE  "債権明細ファイルオープンエラー "                
  1216  011520                                      TO  共通−その他メッセージ  
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  1217  011530           CALL  CLOCO001          USING  IF-CHOCO001             
  1218  011540*                                                                 
  1219  011550        WHEN  -2                                                  
  1220  011560*--<       持分以外ファイルオープンエラー >                       
  1221  011570           MOVE  "1"                  TO  共通−イベント種別      
  1222  011580           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1223  011590           MOVE  "9"                  TO  共通−復帰コード        
  1224  011600           MOVE  "FFUIS351"           TO  共通−処理テーブルＩＤ  
  1225  011610           MOVE  "OPEN"               TO  共通−処理識別          
  1226  011620           MOVE  Ｗ−状態             TO  共通−データ内容        
  1227  011630           MOVE  "持分以外ファイルオープンエラー "                
  1228  011640                                      TO  共通−その他メッセージ  
  1229  011650           CALL  CLOCO001          USING  IF-CHOCO001             
  1230  011660*                                                                 
  1231  011670        WHEN  -3                                                  
  1232  011680*--<       持分ファイルオープンエラー >                           
  1233  011690           MOVE  "1"                  TO  共通−イベント種別      
  1234  011700           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1235  011710           MOVE  "9"                  TO  共通−復帰コード        
  1236  011720           MOVE  "FFUIS352"           TO  共通−処理テーブルＩＤ  
  1237  011730           MOVE  "OPEN"               TO  共通−処理識別          
  1238  011740           MOVE  Ｗ−状態             TO  共通−データ内容        
  1239  011750           MOVE  "持分ファイルオープンエラー "                    
  1240  011760                                      TO  共通−その他メッセージ  
  1241  011770           CALL  CLOCO001          USING  IF-CHOCO001             
  1242  011780*                                                                 
  1243  011790        WHEN  -4                                                  
  1244  011800*--<       債権明細読込エラー >                                   
  1245  011810           MOVE  "1"                  TO  共通−イベント種別      
  1246  011820           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1247  011830           MOVE  "9"                  TO  共通−復帰コード        
  1248  011840           MOVE  "FFUIS350"           TO  共通−処理テーブルＩＤ  
  1249  011850           MOVE  "READ"               TO  共通−処理識別          
  1250  011860           MOVE  Ｗ−状態             TO  共通−データ内容        
  1251  011870           MOVE  "債権明細ファイル読込エラー "                    
  1252  011880                                      TO  共通−その他メッセージ  
  1253  011890           CALL  CLOCO001          USING  IF-CHOCO001             
  1254  011900*                                                                 
  1255  011910        WHEN  -5                                                  
  1256  011920*--<       検収後協調幹事持分以外ファイル出力エラー >             
  1257  011930           MOVE  "1"                  TO  共通−イベント種別      
  1258  011940           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1259  011950           MOVE  "9"                  TO  共通−復帰コード        
  1260  011960           MOVE  "FFUIS351"           TO  共通−処理テーブルＩＤ  
  1261  011970           MOVE  "WRITE"              TO  共通−処理識別          
  1262  011980           MOVE  Ｗ−状態             TO  共通−データ内容        
  1263  011990           MOVE  "検収後協調幹事持分以外ファイル出力エラー "      
  1264  012000                                      TO  共通−その他メッセージ  
  1265  012010           CALL  CLOCO001          USING  IF-CHOCO001             
  1266  012020*                                                                 
  1267  012030        WHEN  OTHER                                               
  1268  012040           MOVE  "N"                  TO  Ｗ−異常終了−フラグ    
  1269  012050*                                                                 
  1270  012060     END-EVALUATE.                                                
  1271  012070*                                                                 
  1272  012080     IF  Ｗ−異常終了−フラグ  =  "Y"                             
  1273  012090        PERFORM  終了メッセージ出力                               
  1274  012100*                                                                 
  1275  012110*--<    プログラム異常終了のリターンコード >                      
  1276  012120        MOVE  定数−異常状態          TO  PROGRAM-STATUS          
  1277  012130*                                                                 
  1278  012140        EXIT  PROGRAM                                             
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  1279  012150     END-IF.                                                      
  1280  012160*                                                                 
  1281  012170 エラー処理−ＥＸＩＴ.                                            
  1282  012180      EXIT.                                                       
  1283  012190******************************************************************
  1284  012200*                  END OF PROGRAM                                *
  1285  012210******************************************************************
ファイル: C:\COB97\SOC\COBIS350\COBIS350.PCOをクローズ
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


ホスト変数
--------------

01  DB-STRING                                           Charf(20)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      3
  C:\COB97\SOC\COBIS350\COBIS350.PCO    263

01  PASSWD                                              Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      5
  C:\COB97\SOC\COBIS350\COBIS350.PCO    258    262

01  SQLSTATE                                            Charf(5)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      2
  C:\COB97\SOC\COBIS350\COBIS350.PCO    257    261    412    434    780    801

01  USERNAME                                            Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      4
  C:\COB97\SOC\COBIS350\COBIS350.PCO    258    262

01  ＩＫＯ００２−契約種類                              Charf(3)
  Z:\COB97\COPYLIB_DB\IKOTBL002.CBL     11
  C:\COB97\SOC\COBIS350\COBIS350.PCO    436    803

01  ＩＫＯ００２−再リース回数                          Decimal(2,0)
  Z:\COB97\COPYLIB_DB\IKOTBL002.CBL      8
  C:\COB97\SOC\COBIS350\COBIS350.PCO    414    782

01  ＷＳ−勘定処理コード                                Over punch trailing(2,0)
  C:\COB97\SOC\COBIS350\COBIS350.PCO    106    418    440    786    807

01  ＷＳ−契約番号                                      Charf(9)
  C:\COB97\SOC\COBIS350\COBIS350.PCO    104    416    438    784    805

01  ＷＳ−再リースコード                                Over punch trailing(1,0)
  C:\COB97\SOC\COBIS350\COBIS350.PCO    105    417    439    785    806

Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.



                              プリコンパイラ・オプション
-------------------------------------------------------------------------------
オプション名   現在の設定値         設定先
-------------------------------------------------------------------------------
asacc             no                デフォルト                                  
assume_sqlcode    no                デフォルト                                  
auto_connect      no                デフォルト                                  
close_on_commit   yes               mode                                        
comp5             yes               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
config            default config    デフォルト                                  
date_format       local             デフォルト                                  
dbms              native            デフォルト                                  
declare_section   yes               mode                                        
define            *なし*            デフォルト                                  
dynamic           ansi              mode                                        
end_of_fetch      100               mode                                        
eol_padding       yes               デフォルト                                  
errors            yes               デフォルト                                  
fips              no                デフォルト                                  
format            ansi              デフォルト                                  
hold_cursor       no                デフォルト                                  
host              cobol             デフォルト                                  
iname             C:\COB97\SOC\COBISコマンドラインCO                            
include           Z:\COB97\COPYLIB  D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
                  Z:\COB97\COPYLIB_DD:\oracle\ora90\precomp\admin\pcbcfg.cfg    
                  *なし*            D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
ireclen           132               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
litdelim          quote             デフォルト                                  
lname             *なし*            デフォルト                                  
lreclen           132               デフォルト                                  
ltype             long              デフォルト                                  
maxliteral        160               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
maxopencursors    10                デフォルト                                  
mode              ANSI              D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
nested            yes               デフォルト                                  
nls_local         yes               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
oname             COBIS350.COB      コマンドライン                              
oraca             no                デフォルト                                  
oreclen           80                デフォルト                                  
pagelen           66                デフォルト                                  
picx              charf             デフォルト                                  
prefetch          1                 デフォルト                                  
release_cursor    no                デフォルト                                  
select_error      yes               デフォルト                                  
sqlcheck          FULL              D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
threads           no                デフォルト                                  
type_code         ansi              mode                                        
unsafe_null       no                デフォルト                                  
userid            GUOXZ/GXZ@FIP     D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
varchar           no                デフォルト                                  
xref              yes               デフォルト                                  
Pro*COBOL: Release 9.2.0.1.0 - Production on 土 Apr 9 13:05:23 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


統計表示
----------

リターン・コード: 0
重要性 Iでのメッセージ数: 0
重要性 Wでのメッセージ数: 0
重要性 Eでのメッセージ数: 0
重要性 Fでのメッセージ数: 0
入力ラインの数: 1304
宣言されたホスト変数の数: 17
カーソル名の数: 0
文名の数: 0
使用される最大メモリー(バイト): 164347
