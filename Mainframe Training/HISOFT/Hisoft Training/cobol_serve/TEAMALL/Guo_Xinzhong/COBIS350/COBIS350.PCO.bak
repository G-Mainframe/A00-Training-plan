000010******************************************************************
000020*         ＜海輝軟件(大連)＞                                     *
000030*      1. プログラム名  : SUMMIT検収後・履歴ｱﾝﾏｯﾁ抽出            *
000040*      2. プログラムID  : COBIS350                               *
000050*      3. 処理概要      : 債権明細をベースにして、債権採算検収後 *
000060*                          データを抽出する。                    *
000070*                                                                *
000080*      4. 作成者        : 郭新鐘                                 *
000090*      5. 作成日        : 2005.04.01                             *
000100******************************************************************
000110*                                                                 
000120******************************************************************
000130*    ＩＤＥＮＴＩＦＩＣＡＴＩＯＮ     ＤＩＶＩＳＩＯＮ           *
000140******************************************************************
000150 IDENTIFICATION                       DIVISION.                   
000160*                                                                 
000170 PROGRAM-ID.                          COBIS350.                   
000180******************************************************************
000190*    ＥＮＶＩＲＯＮＭＥＮＴ           ＤＩＶＩＳＩＯＮ           *
000200******************************************************************
000210 ENVIRONMENT                          DIVISION.                   
000220******************************************************************
000230*    ＩＮＰＵＴ−ＯＵＴＰＵＴ      ＳＥＣＴＩＯＮ                *
000240******************************************************************
000250 INPUT-OUTPUT                         SECTION.                    
000260*                                                                 
000270 FILE-CONTROL.                                                    
000280     SELECT    入力ファイル         ASSIGN    TO     U01          
000290     FILE      STATUS     IS          Ｗ−状態                    
000300     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000310*                                                                 
000320     SELECT    出力ファイル１         ASSIGN    TO     U11        
000330     FILE      STATUS     IS          Ｗ−状態                    
000340     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000350*                                                                 
000360     SELECT    出力ファイル２           ASSIGN    TO     U12      
000370     FILE      STATUS     IS          Ｗ−状態                    
000380     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000390*                                                                 
000400******************************************************************
000410*    ＤＡＴＡ                      ＤＩＶＩＳＩＯＮ              *
000420******************************************************************
000430 DATA                                 DIVISION.                   
000440******************************************************************
000450*    ＦＩＬＥ                      ＳＥＣＴＩＯＮ                *
000460******************************************************************
000470 FILE                                 SECTION.                    
000480*----------------------------------------------------------------*
000490*    入力ファイル                                                *
000500*----------------------------------------------------------------*
000510 FD  入力ファイル                                                 
000520     LABEL     RECORD     IS          STANDARD                    
000530     BLOCK     CONTAINS   0           RECORDS.                    
000540*                                                                 
000550 01  入力−レコード.                                              
000560     COPY  CPBIS161  REPLACING  ==()==  BY  ==入力−==.           
000570*                                                                 
000580*----------------------------------------------------------------*
000590*    出力ファイル                                                *
000600*----------------------------------------------------------------*
000610 FD  出力ファイル１                                               
000620     LABEL     RECORD     IS          STANDARD                    
000630     BLOCK     CONTAINS   0           RECORDS.                    
000640*                                                                 
000650 01  出力１−レコード.                                            
000660     COPY  CISUF351  REPLACING  ==()==  BY  ==出力１−==.         
000670*                                                                 
000680*                                                                 
000690 FD  出力ファイル２                                               
000700     LABEL     RECORD     IS          STANDARD                    
000710     BLOCK     CONTAINS   0           RECORDS.                    
000720*                                                                 
000730 01  出力２−レコード.                                            
000740     COPY  CISUF351  REPLACING  ==()==  BY  ==出力２−==.         
000750                                                                  
000760******************************************************************
000770*    ＷＯＲＫＩＮＧ−ＳＴＯＲＡＧＥ   ＳＥＣＴＩＯＮ             *
000780******************************************************************
000790 WORKING-STORAGE                      SECTION.                    
000800 01  Ｗ−固定資産税                   PIC S9(13).                 
000810 01  Ｗ−動総保険料                   PIC S9(13).                 
000820 01  Ｗ−委託保守料                   PIC S9(13).                 
000830 01  Ｗ−基本リース料１回分           PIC S9(13).                 
000840 01  Ｗ−固定資産税費用総額           PIC S9(13).                 
000850 01  Ｗ−動総保険料費用総額           PIC S9(13).                 
000860 01  Ｗ−リース料１回分               PIC S9(13).                 
000870 01  Ｗ−実質リース料１回分           PIC S9(13).                 
000880 01  Ｗ−基本リース料１回分当社       PIC S9(13).                 
000890 01  Ｗ−固定資産税費用総額当社       PIC S9(13).                 
000900 01  Ｗ−動総保険料費用総額当社       PIC S9(13).                 
000910 01  Ｗ−リース料１回分当社           PIC S9(13).                 
000920 01  Ｗ−実質リース料１回分当社       PIC S9(13).                 
000930 01  Ｗ−その他諸費用                 PIC S9(13).                 
000940 01  Ｗ−その他諸費用現価             PIC S9(13).                 
000950 01  Ｗ−その他諸費用総額             PIC S9(13).                 
000960 01  Ｗ−その他諸費用１回分           PIC S9(13).                 
000970 01  Ｗ−その他諸費用総額当社         PIC S9(13).                 
000980 01  Ｗ−その他諸費用１回分当社       PIC S9(13).                 
000990                                                                  
001000*----------------------------------------------------------------*
001010*    ホスト変数定義エリア                                        *
001020*----------------------------------------------------------------*
001030     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
001040 01   ＷＳ−契約番号                  PIC  X(9).                  
001050 01   ＷＳ−再リースコード            PIC  S9(1).                 
001060 01   ＷＳ−勘定処理コード            PIC  S9(2).                 
001070*--< ＯＲＡＣＬＥ共通変数 >                                       
001080     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
001090*                                                                 
001100*--< ＯＲＡＣＬＥ  ＳＱＬ実行情報 >                               
001110     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
001120*                                                                 
001130*--< 契約種類等変換テーブル >                                     
001140     EXEC  SQL  INCLUDE  IKOTBL002.CBL         END-EXEC.          
001150*                                                                 
001160     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
001170*                                                                 
001180*----------------------------------------------------------------*
001190*   作業領域定義                                                 *
001200*----------------------------------------------------------------*
001210 01  ワークエリア.                                                
001220*                                                                 
001230*--< 件数エリア >                                                 
001240     03  Ｗ−件数エリア.                                          
001250         05  Ｗ−債権明細−件数       PIC  9(09).                 
001260         05  Ｗ−持分以外−件数       PIC  9(09).                 
001270         05  Ｗ−持分−件数           PIC  9(09).                 
001280*                                                                 
001290*--< ファイル状態 >                                               
001300     03  Ｗ−状態エリア.                                          
001310         05  Ｗ−状態                 PIC  X(02).                 
001320*                                                                 
001330*--< エラーコード >                                               
001340     03  Ｗ−エラーコード             PIC S9(04).                 
001350*                                                                 
001360*--< フラグエリア >                                               
001370     03  Ｗ−フラッグエリア.                                      
001380         05  Ｗ−終了−フラグ         PIC  X(01).                 
001390         05  Ｗ−異常終了−フラグ     PIC  X(01).                 
001400*                                                                 
001410*----------------------------------------------------------------*
001420*   処理時間定義                                                 *
001430*----------------------------------------------------------------*
001440*--< 共通情報 >                                                   
001450 01  Ｗ−共通情報.                                                
001460     03  Ｗ−システム日付.                                        
001470         05  Ｗ−世紀                 PIC  X(02) VALUE  "20".     
001480         05  Ｗ−年月日               PIC  X(06).                 
001490     03  Ｗ−システム時刻             PIC  X(08).                 
001500     03  Ｗ−担当者                   PIC  X(08) VALUE "IKOPG   ".
001510*----------------------------------------------------------------*
001520*    サブルーチン名                                              *
001530*----------------------------------------------------------------*
001540 01  CALL-AREA.                                                   
001550*--< 共通ログサブルーチン >                                       
001560     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001570     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001580*                                                                 
001590*----------------------------------------------------------------*
001600*    ＣＯＰＹ領域                                                *
001610*----------------------------------------------------------------*
001620*--< 共通ログ用 >                                                 
001630 01  IF-CHOCO001.                                                 
001640     COPY  CHOCO001  REPLACING  ==()==  BY  ==共通−==.           
001650*                                                                 
001660*----------------------------------------------------------------*
001670*    ＩＮＩファイル読込サブルーチン用パラメタ領域                *
001680*----------------------------------------------------------------*
001690 01  PARA-AREA.                                                   
001700     COPY CPBCO001.                                               
001710*                                                                 
001720******************************************************************
001730*    定数用データ定義                                            *
001740******************************************************************
001750 CONSTANT                             SECTION.                    
001760*                                                                 
001770 01  定数領域.                                                    
001780     03  定数−プログラムＩＤ         PIC  X(08) VALUE "COBIS350".
001790     03  定数−プログラム名           PIC  X(80)                  
001800             VALUE "SUMMIT検収後・履歴アンマッチ抽出".            
001810     03  定数−ＳＱＬＯＫ             PIC S9(04)  VALUE  ZERO.    
001820     03  定数−ＳＱＬＥＮＤ           PIC S9(04)  VALUE  0100.    
001830     03  定数−正常状態               PIC  9(04) VALUE  ZERO.     
001840     03  定数−異常状態               PIC  9(04) VALUE  0009.     
001850*                                                                 
001860******************************************************************
001870*    ＰＲＯＣＥＤＵＲＥ               ＤＩＶＩＳＩＯＮ           *
001880******************************************************************
001890 PROCEDURE                            DIVISION.                   
001900*                                                                 
001910     PERFORM   初期処理.                                          
001920*                                                                 
001930     PERFORM   主処理     UNTIL  (Ｗ−終了−フラグ = "Y").        
001940*                                                                 
001950     PERFORM   終了処理.                                          
001960*                                                                 
001970     STOP RUN.                                                    
001980*                                                                 
001990******************************************************************
002000*    初期処理                                                    *
002010******************************************************************
002020 初期処理                             SECTION.                    
002030 初期処理−ＳＴＡＲＴ.                                            
002040*                                                                 
002050*----------------------------------------------------------------*
002060*    開始メッセージ出力                                          *
002070*----------------------------------------------------------------*
002080     INITIALIZE                       IF-CHOCO001.                
002090     MOVE  "3"                        TO  共通−イベント種別.     
002100     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
002110     MOVE  "0"                        TO  共通−復帰コード.       
002120     MOVE  "START"                    TO  共通−処理識別.         
002130     MOVE  定数−プログラム名         TO  共通−その他メッセージ. 
002140     CALL  CLOCO001                USING  IF-CHOCO001.            
002150*                                                                 
002160*----------------------------------------------------------------*
002170*    作業領域の初期値設定                                        *
002180*----------------------------------------------------------------*
002190                                                                  
002200     MOVE  SPACE                      TO  ワークエリア.           
002210     INITIALIZE                           ワークエリア.           
002220*                                                                 
002230*--< ＣＰＵ日付を取得 >                                           
002240     ACCEPT  Ｗ−年月日               FROM  DATE.                 
002250*                                                                 
002260*--< ＣＰＵ時刻を取得 >                                           
002270     ACCEPT  Ｗ−システム時刻         FROM  TIME.                 
002280*----------------------------------------------------------------*
002290*    ＯＲＡＣＬＥ接続                                    <1.1>   *
002300*----------------------------------------------------------------*
002310     PERFORM  ＯＲＡＣＬＥ接続.                                   
002320*                                                                 
002330     PERFORM  ファイルオープン.                                   
002340*                                                                 
002350*--< 債権明細ファイル読込処理（１件目） >                         
002360     PERFORM  債権明細ファイル読込処理.                           
002370*                                                                 
002380 初期処理−ＥＸＩＴ.                                              
002390     EXIT.                                                        
002400******************************************************************
002410*    ＯＲＡＣＬＥ接続                                            *
002420******************************************************************
002430 ＯＲＡＣＬＥ接続                     SECTION.                    
002440 ＯＲＡＣＬＥ接続−ＳＴＡＲＴ.                                    
002450*                                                                 
002460*--< ＤＢ接続用情報を取得処理 >                                   
002470     CALL  COBCO001                USING  PARA-AREA.              
002480*                                                                 
002490     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002500     MOVE  PARA-USERNAME              TO  USERNAME.               
002510     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002520*                                                                 
002530*----------------------------------------------------------------*
002540*    開始接続                                                    *
002550*----------------------------------------------------------------*
002560     IF    DB-STRING  =  SPACE                                    
002570        EXEC SQL                                                  
002580           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002590        END-EXEC                                                  
002600     ELSE                                                         
002610        EXEC SQL                                                  
002620           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002630             USING  :DB-STRING                                    
002640        END-EXEC                                                  
002650     END-IF.                                                      
002660*                                                                 
002670*----------------------------------------------------------------*
002680*    接続確認                                                    *
002690*----------------------------------------------------------------*
002700     EVALUATE  SQLCODE                                            
002710        WHEN   定数−ＳＱＬＯＫ                                   
002720           CONTINUE                                               
002730        WHEN   OTHER                                              
002740*--<       接続エラー >                                           
002750           MOVE     -10               TO  Ｗ−エラーコード        
002760           PERFORM  エラー処理                                    
002770     END-EVALUATE.                                                
002780*                                                                 
002790 ＯＲＡＣＬＥ接続−ＥＸＩＴ.                                      
002800     EXIT.                                                        
002810*                                                                 
002820******************************************************************
002830*    主処理                                                       
002840******************************************************************
002850 主処理                               SECTION.                    
002860 主処理−ＳＴＡＲＴ.                                              
002870*                                                                 
002880      IF 入力−債協コード NOT = '2X'                                  
002890           PERFORM  協調幹事持分以外編集処理                  
002900      ELSE                                                        
002910           PERFORM  協調幹事持分編集処理                      
002920      END-IF.                                                     
002930*--< 債権明細ファイル読込処理（２件目以降） >                     
002940     PERFORM  債権明細ファイル読込処理.                           
002950*                                                                 
002960 主処理−ＥＸＩＴ.                                                
002970     EXIT.                                                        
002980******************************************************************
002990*    終了処理                                                    *
003000******************************************************************
003010 終了処理                             SECTION.                    
003020 終了処理−ＳＴＡＲＴ.                                            
003030*                                                                 
003040*----------------------------------------------------------------*
003050*    ファイルクローズ                                            *
003060*----------------------------------------------------------------*
003070     CLOSE  入力ファイル.                                         
003080     CLOSE  出力ファイル１.                                       
003090     CLOSE  出力ファイル２.                                       
003100*                                                                 
003110*--< 終了メッセージ出力処理                                       
003120     PERFORM  終了メッセージ出力.                                 
003130*                                                                 
003140*--< プログラム正常終了 >                                         
003150     MOVE  定数−正常状態             TO  PROGRAM-STATUS.         
003160*                                                                 
003170 終了処理−ＥＸＩＴ.                                              
003180     EXIT.                                                        
003190******************************************************************
003200*    ファイルオープン                                            *
003210******************************************************************
003220 ファイルオープン                     SECTION.                    
003230 ファイルオープン−ＳＴＡＲＴ.                                    
003240*                                                                 
003250*----------------------------------------------------------------*
003260*    債権明細ファイルのオープン                                  *
003270*----------------------------------------------------------------*
003280     OPEN  INPUT   入力ファイル.                                  
003290*                                                                 
003300*--< ファイルオープンの状態判定 >                                 
003310     EVALUATE  Ｗ−状態                                           
003320        WHEN  ZERO                                                
003330           CONTINUE                                               
003340        WHEN  OTHER                                               
003350*--<       ファイルオープンエラー >                               
003360           MOVE     -1                TO  Ｗ−エラーコード        
003370           PERFORM  エラー処理                                    
003380     END-EVALUATE.                                                
003390*                                                                 
003400*----------------------------------------------------------------*
003410*    持分以外ファイルのオープン                                  *
003420*----------------------------------------------------------------*
003430     OPEN  OUTPUT   出力ファイル１.                               
003440*                                                                 
003450*--< ファイルオープンの状態判定 >                                 
003460     EVALUATE  Ｗ−状態                                           
003470        WHEN  ZERO                                                
003480           CONTINUE                                               
003490        WHEN  OTHER                                               
003500*--<       持分以外ファイルオープンエラー >                       
003510           MOVE     -2                TO  Ｗ−エラーコード        
003520           PERFORM  エラー処理                                    
003530     END-EVALUATE.                                                
003540*                                                                 
003550*----------------------------------------------------------------*
003560*    持分ファイルのオープン                                      *
003570*----------------------------------------------------------------*
003580     OPEN  OUTPUT   出力ファイル２.                               
003590*                                                                 
003600*--< ファイルオープンの状態判定 >                                 
003610     EVALUATE  Ｗ−状態                                           
003620        WHEN  ZERO                                                
003630           CONTINUE                                               
003640        WHEN  OTHER                                               
003650*--<       持分ファイルオープンエラー >                           
003660           MOVE     -3                TO  Ｗ−エラーコード        
003670           PERFORM  エラー処理                                    
003680     END-EVALUATE.                                                
003690*                                                                 
003700 ファイルオープン−ＥＸＩＴ.                                      
003710     EXIT.                                                        
003720******************************************************************
003730*    債権明細ファイル読込処理                                    *
003740******************************************************************
003750 債権明細ファイル読込処理             SECTION.                    
003760 債権明細ファイル読込処理−ＳＴＡＲＴ.                            
003770*                                                                 
003780     READ  入力ファイル                                           
003790        AT END                                                    
003800           MOVE  "Y"                  TO  Ｗ−終了−フラグ        
003810           GO    TO   債権明細ファイル読込処理−ＥＸＩＴ          
003820     END-READ.                                                    
003830*                                                                 
003840*--< 債権明細ファイル読込状態判定 >                               
003850     EVALUATE  Ｗ−状態                                           
003860        WHEN  ZERO                                                
003870*--<       債権明細ファイル入力件数のカウント >                   
003880           COMPUTE   Ｗ−債権明細−件数  =  Ｗ−債権明細−件数 + 1
003890        WHEN  OTHER                                               
003900*--<       債権明細ファイル読込エラー >                           
003910           MOVE     -4                TO  Ｗ−エラーコード        
003920           PERFORM  エラー処理                                    
003930     END-EVALUATE.                                                
003940*                                                                 
003950 債権明細ファイル読込処理−ＥＸＩＴ.                              
003960     EXIT.                                                        
003970******************************************************************
003980*    協調幹事持分以外編集処理                                *
003990******************************************************************
004000 協調幹事持分以外編集処理         SECTION.                    
004010 協調幹事持分以外編集処理−ＳＴＡＲＴ.                        
      
004170*--< 出力レコードの初期化処理 >                                   
004040     INITIALIZE            出力１−レコード.                  
004190     MOVE  入力−レコード             TO  出力１−レコード.       
004200*--< No.1 >                                                       
004210     MOVE  入力−契約番号             TO  出力１−契約番号.       
004220*--< No.2 >                                                       
004230     MOVE  入力−契約番号             TO  ＷＳ−契約番号.         
004240     MOVE  入力−再リースコード       TO  ＷＳ−再リースコード.   
004250	   MOVE  入力−勘定処理コード       TO  ＷＳ−勘定処理コード.   
004260     EXEC SQL                                                     
004270        SELECT 再リース回数                                       
004280          INTO :ＩＫＯ００２−再リース回数                        
004290          FROM IKOTBL002                                          
004300          WHERE  契約ＮＯ = :ＷＳ−契約番号                       
004310            AND  再リースコード = :ＷＳ−再リースコード           
004320		  AND  旧債権勘定処理コード = :ＷＳ−勘定処理コード     
004330     END-EXEC.                                                    
004340     EVALUATE  SQLCODE                                            
004350        WHEN  定数−ＳＱＬＯＫ                                    
004360*--<       正常 >                                                 
004370     MOVE  ＩＫＯ００２−再リース回数 TO  出力１−再リース回数    
004380           CONTINUE                                               
004390        WHEN  OTHER                                               
004400           MOVE -11                   TO  Ｗ−エラーコード        
004410           PERFORM エラー処理                                     
004420      END-EVALUATE.                                               
004430                                                                  
004440*--< No.3 >                                                       
004450     MOVE  入力−契約番号             TO  ＷＳ−契約番号.         
004460     MOVE  入力−再リースコード       TO  ＷＳ−再リースコード.   
004470	   MOVE  入力−勘定処理コード       TO  ＷＳ−勘定処理コード.   
004480     EXEC SQL                                                     
004490        SELECT 契約種類                                           
004500          INTO :ＩＫＯ００２−契約種類                            
004510          FROM IKOTBL002                                          
004520          WHERE  契約ＮＯ = :ＷＳ−契約番号                       
004530            AND  再リースコード = :ＷＳ−再リースコード           
004540		  AND  旧債権勘定処理コード = :ＷＳ−勘定処理コード     
004550     END-EXEC.                                                    
004560     EVALUATE  SQLCODE                                            
004570        WHEN  定数−ＳＱＬＯＫ                                    
004580*--<       正常 >                                                 
004590     MOVE  ＩＫＯ００２−契約種類     TO  出力１−契約種類        
004600           CONTINUE                                               
004610        WHEN  OTHER                                               
004620           MOVE -21                   TO  Ｗ−エラーコード        
004630           PERFORM エラー処理                                     
004640      END-EVALUATE.                                               
004650                                                                  
004660*--< No.4 >                                                       
004670     MOVE  ZERO                       TO  出力１−回収サイト.     
004680*--< No.5 >                                                       
004690     MOVE  入力−入金日               TO  出力１−回収日.         
004700*--< No.6 >                                                       
004710*    振込                                                         
004720	   IF 入力−回収方式コード = '1'                                
004730     MOVE  ZERO                       TO  出力１−回収方法        
004740*    手形                                                         
004750	   ELSE IF 入力−回収方式コード = '2'                           
004760     MOVE  '5'                        TO  出力１−回収方法        
004770*    自動引落                                                     
004780	   ELSE IF 入力−回収方式コード = '3'                           
004790     MOVE  '3'                        TO  出力１−回収方法        
004800*    代理回収                                                     
004810	   ELSE IF 入力−回収方式コード = '4'                           
004820     MOVE  '4'                        TO  出力１−回収方法        
004830*    上記以外の場合                                               
004840     ELSE                                                         
004850     MOVE  ZERO                       TO  出力１−回収方法        
004860     END-IF.                                                      
004870*--< No.7 >                                                       
004880     MOVE  入力−基本利回り           TO  出力１−基本利回り.     
004890*--< No.8 >                                                       
004900     MOVE  入力−実質利回り           TO  出力１−実質利回り.     
004910*--< No.9 >                                                       
004920     MOVE  入力−粗利                 TO  出力１−粗利額.         
004930*--< No.10 >                                                      
004940     MOVE  入力−基本利回り           TO  出力１−基本利回り総額. 
004950*--< No.11 >                                                      
004960     MOVE  入力−基本利回り           TO  出力１−売上基本利回り. 
004970*--< No.12 >                                                      
004980     MOVE  入力−基本利回り           TO  出力１−一般基本利回り. 
004990*--< No.13 >                                                      
005000     MOVE  入力−実質利回り           TO  出力１−一般実質利回り. 
005010*--< No.14 >                                                      
005020     MOVE  入力−粗利                 TO  出力１−一般粗利額.     
005030*--< No.15 >                                                      
005040     COMPUTE Ｗ−固定資産税 = 入力−固定資産税 * 入力−リース期間.
005050     MOVE  Ｗ−固定資産税             TO  出力１−固定資産税.     
005060*--< No.16 >                                                      
005070     COMPUTE Ｗ−動総保険料 = 入力−保険料 * 入力−リース期間.    
005080     MOVE  Ｗ−動総保険料             TO  出力１−動総保険料.     
005090*--< No.17 >                                                      
005100     COMPUTE Ｗ−委託保守料 = 入力−保守料 * 入力−リース期間.    
005110     MOVE  Ｗ−委託保守料             TO  出力１−委託保守料.     
005120*--< No.18 >                                                      
005130     MOVE  Ｗ−固定資産税             TO  出力１−固定資産税現価. 
005140*--< No.19 >                                                      
005150     MOVE  Ｗ−動総保険料             TO  出力１−動総保険料現価. 
005160*--< No.20 >                                                      
005170     MOVE  Ｗ−委託保守料             TO  出力１−委託保守料現価. 
005180*--< No.21 >                                                      
005190     MOVE  ZERO                       TO                          
005191                                       出力１−一般固定資産税現価.
005200*--< No.22 >                                                      
005210     MOVE  ZERO                       TO                          
005211                                       出力１−一般動総保険料現価.
005230     MOVE  ZERO                       TO                          
005231                                       出力１−一般委託保守料現価.
005240*--< No.24 >                                                      
005250     MOVE  ZERO                       TO  出力１−前受メリット.   
005260*--< No.25 >                                                      
005270     MOVE  ZERO                       TO                          
005271                                         出力１−一般前受メリット.
005280*--< No.26 >                                                      
005290     MOVE  ZERO                       TO  出力１−繰延メリット.   
005300*--< No.27 >                                                      
005310     MOVE  ZERO                       TO                          
005311                                         出力１−一般繰延メリット.
005320*--< No.28 >                                                      
005330     MOVE  入力−契約金額基本         TO                          
005331                                         出力１−基本リース料総額.
005340*--< No.29 >                                                      
005350     COMPUTE Ｗ−基本リース料１回分                               
005351                                      =                           
005352                            入力−契約金額基本 / 入力−リース期間.
005370     MOVE  Ｗ−基本リース料１回分     TO                          
005381                                       出力１−基本リース料１回分.
005390*--< No.30 >                                                      
005400     COMPUTE Ｗ−固定資産税費用総額   =                           
005401                              入力−固定資産税 * 入力−リース期間.
005420     MOVE  Ｗ−固定資産税費用総額     TO                          
005430                                       出力１−固定資産税費用総額.
005440*--< No.31 >                                                      
005450     MOVE  入力−固定資産税           TO                          
005460                                     出力１−固定資産税費用１回分.
005470*--< No.32 >                                                      
005480     COMPUTE Ｗ−動総保険料費用総額   =                           
005490	                                入力−保険料 * 入力−リース期間.
005500     MOVE  Ｗ−動総保険料費用総額     TO                          
005510                                       出力１−動総保険料費用総額.
005520*--< No.33 >                                                      
005530     MOVE  入力−保険料               TO                          
005531                                     出力１−動総保険料費用１回分.
005540*--< No.34 >                                                      
005550     MOVE  入力−契約金額実質         TO  出力１−リース料総額.   
005560*--< No.35 >                                                      
005570     COMPUTE Ｗ−リース料１回分       =                           
005571                            入力−契約金額実質 * 入力−リース期間.
005590     MOVE  Ｗ−リース料１回分         TO                          
005600                                           出力１−リース料１回分.
005610*--< No.36 >                                                      
005620     MOVE  ZERO                       TO                          
005621                                         出力１−前受メリット総額.
005630*--< No.37 >                                                      
005640     MOVE  ZERO                       TO                          
005641                                       出力１−前受メリット１回分.
005650*--< No.38 >                                                      
005660     MOVE  ZERO                       TO                          
005661                                        出力１−繰延メリット総額.
005670*--< No.39 >                                                      
005680     MOVE  ZERO                       TO                          
005681                                       出力１−繰延メリット１回分.
005690*--< No.40 >                                                      
005700     MOVE  入力−実リース料−実質     TO                          
005710                                         出力１−実質リース料総額.
005720*--< No.41 >                                                      
005730     COMPUTE Ｗ−実質リース料１回分   =                           
005731                       入力−実リース料−実質 / 入力−リース期間. 
005750     MOVE  Ｗ−実質リース料１回分     TO                          
005760                                       出力１−実質リース料１回分.
005770*--< No.42 >                                                      
005780     MOVE  ZERO                       TO                          
005781                                         出力１−実質リース料現価.
005790*--< No.43 >                                                      
005800     MOVE  入力−初期費用             TO  出力１−初期費用.       
005810*--< No.44 >                                                      
005820     MOVE  ZERO                       TO  出力１−期中費用現価.   
005830*--< No.45 >                                                      
005840     MOVE  入力−契約金額基本         TO                          
005850                                     出力１−基本リース料総額当社.
005860*--< No.46 >                                                      
005870     COMPUTE Ｗ−基本リース料１回分当社                           
005871                                      =                           
005880	                         入力−契約金額基本  / 入力−リース期間.
005890     MOVE  Ｗ−基本リース料１回分当社 TO                          
005900                           出力１−基本リース料１回分当社.        
005910*--< No.47 >                                                      
005920     COMPUTE Ｗ−固定資産税費用総額当社                           
005921                                      =                           
005930	                            入力−固定資産税 * 入力−リース期間.
005940     MOVE  Ｗ−固定資産税費用総額当社 TO                          
005950                                   出力１−固定資産税費用総額当社.
005960*--< No.48 >                                                      
005970     MOVE  入力−固定資産税           TO                          
005980                                 出力１−固定資産税費用１回分当社.
005990*--< No.49 >                                                      
006000     COMPUTE Ｗ−動総保険料費用総額当社                           
006001                                      =                           
006011                                  入力−保険料 * 入力−リース期間.
006020     MOVE  Ｗ−動総保険料費用総額当社 TO                          
006030                                   出力１−動総保険料費用総額当社.
006040*--< No.50 >                                                      
006050     MOVE  入力−保険料               TO                          
006060                                 出力１−動総保険料費用１回分当社.
006070*--< No.51 >                                                      
006080     MOVE  入力−契約金額実質         TO                          
006081                                         出力１−リース料総額当社.
006090*--< No.52 >                                                      
006100     COMPUTE Ｗ−リース料１回分当社   =                           
006110	                          入力−契約金額実質 / 入力−リース期間.
006120     MOVE  Ｗ−リース料１回分当社     TO                          
006130                                       出力１−リース料１回分当社.
006140*--< No.53 >                                                      
006150     MOVE  ZERO                       TO                          
006151                                     出力１−前受メリット総額当社.
006160*--< No.54 >                                                      
006170     MOVE  ZERO                       TO                          
006171                                   出力１−前受メリット１回分当社.
006180*--< No.55 >                                                      
006190     MOVE  ZERO                       TO                          
006191                                     出力１−繰延メリット総額当社.
006200*--< No.56 >                                                      
006210     MOVE  ZERO                       TO                          
006211                                   出力１−繰延メリット１回分当社.
006220*--< No.57 >                                                      
006230     MOVE  入力−契約金額実質         TO                          
006240                                     出力１−実質リース料総額当社.
006250*--< No.58 >                                                      
006260     COMPUTE Ｗ−実質リース料１回分当社                           
006261                                      =                           
006270	                         入力−契約金額実質  / 入力−リース期間.
006280     MOVE  Ｗ−実質リース料１回分当社 TO                          
006290                                   出力１−実質リース料１回分当社.
006300*--< No.59 >                                                      
006310     MOVE  ZERO                       TO                          
006311                                     出力１−実質リース料現価当社.
006320*--< No.60 >                                                      
006330     MOVE  ZERO                       TO                          
006331                                         出力１−残価回収現価当社.
006340*--< No.61 >                                                      
006350     MOVE  入力−初期費用             TO  出力１−初期費用当社.   
006360*--< No.62 >                                                      
006370     MOVE  ZERO                       TO                          
006371                                         出力１−期中費用現価当社.
006380*--< No.63 >                                                      
006390     MOVE  ZERO                       TO  出力１−残価回収現価.   
006400*--< No.64 >                                                      
006410     MOVE  入力−粗利                 TO  出力１−粗利益全体.     
006420*--< No.65 >                                                      
006430     MOVE  ZERO                       TO                          
006431                                     出力１−一般実質リース料現価.
006440*--< No.66 >                                                      
006450     MOVE  ZERO                       TO                          
006451                                         出力１−一般残価回収現価.
006460*--< No.67 >                                                      
006470     MOVE  ZERO                       TO                          
006471                                         出力１−一般期中費用現価.
006480*--< No.68 >                                                      
006490     MOVE  入力−粗利                 TO  出力１−一般粗利額全体. 
006500*--< No.69 >                                                      
006510     MOVE  ZERO                       TO                          
006511                                 出力１−一般実質リース料現価当社.
006520*--< No.70 >                                                      
006530     MOVE  ZERO                       TO                          
006531                                     出力１−一般残価回収現価当社.
006540*--< No.71 >                                                      
006550     MOVE  ZERO                       TO                          
006551                                     出力１−一般期中費用現価当社.
006560*--< No.72 >                                                      
006570     MOVE  ZERO                       TO  出力１−当社持分比率.   
006580*--< No.73 >                                                      
006590     MOVE  ZERO                       TO  出力１−基本元本金額.   
006600*--< No.74 >                                                      
006610     MOVE  ZERO                       TO  出力１−リース料現価.   
006620*--< No.75 >                                                      
006630     MOVE  ZERO                       TO                          
006631                                         出力１−リース料現価当社.
006640*--< No.76 >                                                      
006650     COMPUTE Ｗ−その他諸費用         =                           
006660           ( 入力−その他１ + 入力−その他２ ) * 入力−リース期間.
006670     MOVE  Ｗ−その他諸費用           TO  出力１−その他諸費用.   
006680*--< No.77 >                                                      
006690     COMPUTE Ｗ−その他諸費用現価     =                           
006700          ( 入力−その他１ + 入力−その他２ )  * 入力−リース期間.
006710	                                                                
006720     MOVE  Ｗ−その他諸費用現価       TO                          
006730                                         出力１−その他諸費用現価.
006740*--< No.78 >                                                      
006750     MOVE  ZERO                       TO                          
006751                                     出力１−一般その他諸費用現価.
006760*--< No.79 >                                                      
006770     MOVE  ZERO                       TO                          
006771                                       出力１−委託保険料費用総額.
006780*--< No.80 >                                                      
006790     MOVE  ZERO                       TO                          
006791                                     出力１−委託保険料費用１回分.
006800*--< No.81 >                                                      
006810     COMPUTE Ｗ−その他諸費用総額     =                           
006820	         ( 入力−その他１ + 入力−その他２ ) * 入力−リース期間.
006830     MOVE  Ｗ−その他諸費用総額       TO                          
006840                                         出力１−その他諸費用総額.
006850*--< No.82 >                                                      
006860     COMPUTE Ｗ−その他諸費用１回分   =                           
006870	                                 入力−その他１ + 入力−その他２
006880     MOVE  Ｗ−その他諸費用１回分     TO                          
006890                                       出力１−その他諸費用１回分.
006900*--< No.83 >                                                      
006910     MOVE  ZERO                       TO                          
006911                                   出力１−委託保険料費用総額当社.
006920*--< No.84 >                                                      
006930     MOVE  ZERO                       TO                          
006931                                 出力１−委託保険料費用１回分当社.
006940*--< No.85 >                                                      
006950     COMPUTE Ｗ−その他諸費用総額当社 =                           
006960	         ( 入力−その他１ + 入力−その他２ ) * 入力−リース期間.
006970     MOVE  Ｗ−その他諸費用総額当社   TO                          
006980                                     出力１−その他諸費用総額当社.
006990*--< No.86 >                                                      
007000     COMPUTE Ｗ−その他諸費用１回分当社                           
007001                                      =                           
007010	                                入力−その他１  + 入力−その他２
007020     MOVE  Ｗ−その他諸費用１回分当社 TO                          
007030                                   出力１−その他諸費用１回分当社.
007040*--< No.87 >                                                      
007050     MOVE  Ｗ−システム日付           TO  出力１−更新年月日.     
007060*--< No.88 >                                                      
007070     MOVE  Ｗ−システム時刻           TO  出力１−更新時間.       
007080*--< No.89 >                                                      
007090     MOVE  Ｗ−担当者                 TO  出力１−更新者.         
007100*--< No.90 >                                                      
007110     MOVE  Ｗ−システム日付           TO  出力１−登録年月日.     
007120*--< No.91 >                                                      
007130     MOVE  Ｗ−システム時刻           TO  出力１−登録時間.       
007140*--< No.92 >                                                      
007150     MOVE  Ｗ−担当者                 TO  出力１−登録担当者.     
007160*--< No.93 >                                                      
007170     MOVE  Ｗ−担当者                 TO                          
007171                                         出力１−入力担当者コード.
007180*                                                                 
           PERFORM                          協調幹事持分以外出力処理.                            
007200*                                                                 
007210*--< 検収後協調幹事持分以外出力の状態判定 >                       
007220     EVALUATE  Ｗ−状態                                           
007230        WHEN  ZERO                                                
007240*--<       検収後協調幹事持分以外出力件数の加算 >                 
007250           COMPUTE  Ｗ−持分以外−件数 =  Ｗ−持分以外−件数 + 1  
007260        WHEN  OTHER                                               
007270*--<       検収後協調幹事持分以外ファイル出力エラー >             
007280           MOVE     -5                TO  Ｗ−エラーコード        
007290           PERFORM  エラー処理                                    
007300     END-EVALUATE.                                                
007310*                                                                 
007320 協調幹事持分以外編集処理−ＥＸＩＴ.                      
007330     EXIT.                                                        
003970******************************************************************
003980*    協調幹事持分以外出力処理                                *
003990******************************************************************
004000 協調幹事持分以外出力処理         SECTION.                    
004010 協調幹事持分以外出力処理−ＳＴＡＲＴ.                        
007190     WRITE  出力１−レコード. 
004090 協調幹事持分以外出力処理−ＥＸＩＴ.                          
004100     EXIT.   
007340******************************************************************
007350*    協調幹事持分編集処理                                    *
007360******************************************************************
007500 協調幹事持分編集処理               SECTION.              
007510 協調幹事持分編集処理−ＳＴＡＲＴ.                        
007520*
           INITIALIZE                       出力２−レコード.
007530*--< 協調幹事持分レコード基本項目の編集処理 >                     
007550*--< No.1 >                                                       
007560     MOVE  入力−契約番号             TO  出力２−契約番号.       
007570*--< No.2 >                                                       
007580     MOVE  入力−契約番号             TO  ＷＳ−契約番号.         
007590     MOVE  入力−再リースコード       TO  ＷＳ−再リースコード.   
007600	   MOVE  入力−勘定処理コード       TO  ＷＳ−勘定処理コード.   
007610     EXEC SQL                                                     
007620        SELECT 再リース回数                                       
007630          INTO :ＩＫＯ００２−再リース回数                        
007640          FROM IKOTBL002                                          
007650          WHERE  契約ＮＯ = :ＷＳ−契約番号                       
007660            AND  再リースコード = :ＷＳ−再リースコード           
007670		  AND  旧債権勘定処理コード = :ＷＳ−勘定処理コード     
007680     END-EXEC.                                                    
007700     EVALUATE  SQLCODE                                            
007710        WHEN  定数−ＳＱＬＯＫ                                    
007720*--<       正常 >                                                 
007730     MOVE  ＩＫＯ００２−再リース回数 TO  出力１−再リース回数    
007740           CONTINUE                                               
007750        WHEN  OTHER                                               
007760           MOVE -12                   TO  Ｗ−エラーコード        
007770           PERFORM エラー処理                                     
007780      END-EVALUATE.                                               
007790*--< No.3 >                                                       
007830     MOVE  入力−契約番号             TO  ＷＳ−契約番号.         
007840     MOVE  入力−再リースコード       TO  ＷＳ−再リースコード.   
007850	   MOVE  入力−勘定処理コード       TO  ＷＳ−勘定処理コード.   
007860     EXEC SQL                                                     
007870        SELECT 契約種類                                           
007880          INTO :ＩＫＯ００２−契約種類                            
007890          FROM IKOTBL002                                          
007900          WHERE  契約ＮＯ = :ＷＳ−契約番号                       
007910            AND  再リースコード = :ＷＳ−再リースコード           
007920		  AND  旧債権勘定処理コード = :ＷＳ−勘定処理コード     
007930     END-EXEC.                                                    
007940     EVALUATE  SQLCODE                                            
007950        WHEN  定数−ＳＱＬＯＫ                                    
007960*--<       正常 >                                                 
007970     MOVE  ＩＫＯ００２−契約種類     TO  出力２−契約種類        
007980           CONTINUE                                               
007990        WHEN  OTHER                                               
008000           MOVE -22                   TO  Ｗ−エラーコード        
008010           PERFORM エラー処理                                     
008020      END-EVALUATE.                                               
008030*--< No.4 >                                                       
008040     MOVE  ZERO                       TO  出力２−回収サイト.     
008050*--< No.5 >                                                       
008060     MOVE  入力−入金日               TO  出力２−回収日.         
008070*--< No.6 >                                                       
008080*    振込                                                         
008090	   IF 入力−回収方式コード = '1'                                
008100     MOVE  ZERO                       TO  出力２−回収方法        
008110*    手形                                                         
008120	   ELSE IF 入力−回収方式コード = '2'                           
008130     MOVE  '5'                        TO  出力２−回収方法        
008140*    自動引落                                                     
008150	   ELSE IF 入力−回収方式コード = '3'                           
008160     MOVE  '3'                        TO  出力２−回収方法        
008170*    代理回収                                                     
008180	   ELSE IF 入力−回収方式コード = '4'                           
008190     MOVE  '4'                        TO  出力２−回収方法        
008200*    上記以外の場合                                               
008210     ELSE                                                         
008220     MOVE  ZERO                       TO  出力２−回収方法        
008230     END-IF.                                                      
008240*--< No.7 >                                                       
008250     MOVE  入力−基本利回り           TO  出力２−基本利回り.     
008260*--< No.8 >                                                       
008270     MOVE  入力−実質利回り           TO  出力２−実質利回り.     
008280*--< No.9 >                                                       
008290     MOVE  入力−粗利                 TO  出力２−粗利額.         
008300*--< No.10 >                                                      
008310     MOVE  入力−基本利回り           TO  出力２−基本利回り総額. 
008320*--< No.11 >                                                      
008330     MOVE  入力−基本利回り           TO  出力２−売上基本利回り. 
008340*--< No.12 >                                                      
008350     MOVE  入力−基本利回り           TO  出力２−一般基本利回り. 
008360*--< No.13 >                                                      
008370     MOVE  入力−実質利回り           TO  出力２−一般実質利回り. 
008380*--< No.14 >                                                      
008390     MOVE  入力−粗利                 TO  出力２−一般粗利額.     
008400*--< No.15 >                                                      
008410     COMPUTE Ｗ−固定資産税           =                           
008411                              入力−固定資産税 * 入力−リース期間.
008420     MOVE  Ｗ−固定資産税             TO  出力２−固定資産税.     
008430*--< No.16 >                                                      
008440     COMPUTE Ｗ−動総保険料           =                           
008441                                  入力−保険料 * 入力−リース期間.
008450     MOVE  Ｗ−動総保険料             TO  出力２−動総保険料.     
008460*--< No.17 >                                                      
008470     COMPUTE Ｗ−委託保守料           =                           
008471                                  入力−保守料 * 入力−リース期間.
008480     MOVE  Ｗ−委託保守料             TO  出力２−委託保守料.     
008490*--< No.18 >                                                      
008500     MOVE  Ｗ−固定資産税             TO  出力２−固定資産税現価. 
008510*--< No.19 >                                                      
008520     MOVE  Ｗ−動総保険料             TO  出力２−動総保険料現価. 
008530*--< No.20 >                                                      
008540     MOVE  Ｗ−委託保守料             TO  出力２−委託保守料現価. 
008550*--< No.21 >                                                      
008560     MOVE  ZERO                       TO                          
008561                                       出力２−一般固定資産税現価.
008570*--< No.22 >                                                      
008580     MOVE  ZERO                       TO                          
008581                                       出力２−一般動総保険料現価.
008590*--< No.23 >                                                      
008600     MOVE  ZERO                       TO                          
008601                                       出力２−一般委託保守料現価.
008610*--< No.24 >                                                      
008620     MOVE  ZERO                       TO  出力２−前受メリット.   
008630*--< No.25 >                                                      
008640     MOVE  ZERO                       TO                          
008641                                         出力２−一般前受メリット.
008650*--< No.26 >                                                      
008660     MOVE  ZERO                       TO  出力２−繰延メリット.   
008670*--< No.27 >                                                      
008680     MOVE  ZERO                       TO                          
008681                                         出力２−一般繰延メリット.
008690*--< No.28 >                                                      
008700     MOVE  入力−契約金額基本         TO                          
008701                                         出力２−基本リース料総額.
008710*--< No.29 >                                                      
008720     COMPUTE Ｗ−基本リース料１回分   =                           
008730	                          入力−契約金額基本 / 入力−リース期間.
008740     MOVE  Ｗ−基本リース料１回分     TO                          
008750                                       出力２−基本リース料１回分.
008760*--< No.30 >                                                      
008770     COMPUTE Ｗ−固定資産税費用総額   =                           
008780	                            入力−固定資産税 * 入力−リース期間.
008790     MOVE  Ｗ−固定資産税費用総額     TO                          
008800                                       出力２−固定資産税費用総額.
008810*--< No.31 >                                                      
008820     MOVE  入力−固定資産税           TO                          
008830                                     出力２−固定資産税費用１回分.
008840*--< No.32 >                                                      
008850     COMPUTE Ｗ−動総保険料費用総額   =                           
008860	                                入力−保険料 * 入力−リース期間.
008870     MOVE  Ｗ−動総保険料費用総額     TO                          
008880                                       出力２−動総保険料費用総額.
008890*--< No.33 >                                                      
008900     MOVE  入力−保険料               TO                          
008901                                     出力２−動総保険料費用１回分.
008910*--< No.34 >                                                      
008920     MOVE  入力−契約金額実質         TO  出力２−リース料総額.   
008930*--< No.35 >                                                      
008940     COMPUTE Ｗ−リース料１回分       =                           
008950	                          入力−契約金額実質 * 入力−リース期間.
008960     MOVE  Ｗ−リース料１回分         TO  出力２−リース料１回分. 
008980*--< No.36 >                                                      
008990     MOVE  ZERO                       TO                          
008991                                         出力２−前受メリット総額.
009000*--< No.37 >                                                      
009010     MOVE  ZERO                       TO                          
009011                                       出力２−前受メリット１回分.
009020*--< No.38 >                                                      
009030     MOVE  ZERO                       TO                          
009031                                         出力２−繰延メリット総額.
009040*--< No.39 >                                                      
009050     MOVE  ZERO                       TO                          
009051                                       出力２−繰延メリット１回分.
009060*--< No.40 >                                                      
009070     MOVE  入力−実リース料−実質     TO                          
009080                                         出力２−実質リース料総額.
009090*--< No.41 >                                                      
009100     COMPUTE Ｗ−実質リース料１回分   =                           
009110	                     入力−実リース料−実質  / 入力−リース期間.
009120     MOVE  Ｗ−実質リース料１回分     TO                          
009130                                       出力２−実質リース料１回分.
009140*--< No.42 >                                                      
009150     MOVE  ZERO                       TO                          
009151                                         出力２−実質リース料現価.
009160*--< No.43 >                                                      
009170     MOVE  入力−初期費用             TO  出力２−初期費用.       
009180*--< No.44 >                                                      
009190     MOVE  ZERO                       TO  出力２−期中費用現価.   
009200*--< No.45 >                                                      
009210     MOVE  入力−契約金額基本         TO                          
009220                                     出力２−基本リース料総額当社.
009230*--< No.46 >                                                      
009240     COMPUTE Ｗ−基本リース料１回分当社                           
009241                                      =                           
009250	                         入力−契約金額基本  / 入力−リース期間.
009260     MOVE  Ｗ−基本リース料１回分当社 TO                          
009270                                   出力２−基本リース料１回分当社.
009280*--< No.47 >                                                      
009290     COMPUTE Ｗ−固定資産税費用総額当社                           
009291                                      =                           
009300	                           入力−固定資産税  * 入力−リース期間.
009310     MOVE  Ｗ−固定資産税費用総額当社 TO                          
009320                                   出力２−固定資産税費用総額当社.
009330*--< No.48 >                                                      
009340     MOVE  入力−固定資産税           TO                          
009350                           出力２−固定資産税費用１回分当社.      
009360*--< No.49 >                                                      
009370     COMPUTE Ｗ−動総保険料費用総額当社                           
009371                                      =                           
009380	                               入力−保険料  * 入力−リース期間.
009390     MOVE  Ｗ−動総保険料費用総額当社 TO                          
009400                                   出力２−動総保険料費用総額当社.
009410*--< No.50 >                                                      
009420     MOVE  入力−保険料               TO                          
009430                                 出力２−動総保険料費用１回分当社.
009440*--< No.51 >                                                      
009450     MOVE  入力−契約金額実質         TO                          
009451                                         出力２−リース料総額当社.
009460*--< No.52 >                                                      
009470     COMPUTE Ｗ−リース料１回分当社   =                           
009480	                          入力−契約金額実質 / 入力−リース期間.
009490     MOVE  Ｗ−リース料１回分当社     TO                          
009500                                       出力２−リース料１回分当社.
009510*--< No.53 >                                                      
009520     MOVE  ZERO                       TO                          
009521                                     出力２−前受メリット総額当社.
009530*--< No.54 >                                                      
009540     MOVE  ZERO                       TO                          
009541                                   出力２−前受メリット１回分当社.
009550*--< No.55 >                                                      
009560     MOVE  ZERO                       TO                          
009561                                     出力２−繰延メリット総額当社.
009570*--< No.56 >                                                      
009580     MOVE  ZERO                       TO                          
009581                                   出力２−繰延メリット１回分当社.
009590*--< No.57 >                                                      
009600     MOVE  入力−契約金額実質         TO                          
009610                                     出力２−実質リース料総額当社.
009620*--< No.58 >                                                      
009630     COMPUTE Ｗ−実質リース料１回分当社                           
009631                                      =                           
009640	                         入力−契約金額実質  / 入力−リース期間.
009650     MOVE  Ｗ−実質リース料１回分当社 TO                          
009660                                   出力２−実質リース料１回分当社.
009670*--< No.59 >                                                      
009680     MOVE  ZERO                       TO                          
009681                                    出力２−実質リース料現価当社. 
009690*--< No.60 >                                                      
009700     MOVE  ZERO                       TO                          
009701                                         出力２−残価回収現価当社.
009710*--< No.61 >                                                      
009720     MOVE  入力−初期費用             TO                          
009721                                             出力２−初期費用当社.
009730*--< No.62 >                                                      
009740     MOVE  ZERO                       TO                          
009741                                         出力２−期中費用現価当社.
009750*--< No.63 >                                                      
009760     MOVE  ZERO                       TO  出力２−残価回収現価.   
009770*--< No.64 >                                                      
009780     MOVE  入力−粗利                 TO  出力２−粗利益全体.     
009790*--< No.65 >                                                      
009800     MOVE  ZERO                       TO                          
009801                                     出力２−一般実質リース料現価.
009810*--< No.66 >                                                      
009820     MOVE  ZERO                       TO                          
009821                                         出力２−一般残価回収現価.
009830*--< No.67 >                                                      
009840     MOVE  ZERO                       TO                          
009841                                         出力２−一般期中費用現価.
009850*--< No.68 >                                                      
009860     MOVE  入力−粗利                 TO  出力２−一般粗利額全体. 
009870*--< No.69 >                                                      
009880     MOVE  ZERO                       TO                          
009881                                 出力２−一般実質リース料現価当社.
009890*--< No.70 >                                                      
009900     MOVE  ZERO                       TO                          
009901                                     出力２−一般残価回収現価当社.
009910*--< No.71 >                                                      
009920     MOVE  ZERO                       TO                          
009921                                     出力２−一般期中費用現価当社.
009930*--< No.72 >                                                      
009940     MOVE  ZERO                       TO  出力２−当社持分比率.   
009950*--< No.73 >                                                      
009960     MOVE  ZERO                       TO  出力２−基本元本金額.   
009970*--< No.74 >                                                      
009980     MOVE  ZERO                       TO  出力２−リース料現価.   
009990*--< No.75 >                                                      
010000     MOVE  ZERO                       TO                          
010001                                         出力２−リース料現価当社.
010010*--< No.76 >                                                      
010020     COMPUTE Ｗ−その他諸費用         =                           
010030	         ( 入力−その他１ + 入力−その他２)  * 入力−リース期間.
010040     MOVE  Ｗ−その他諸費用           TO                          
010050                                             出力２−その他諸費用.
010060*--< No.77 >                                                      
010070     COMPUTE Ｗ−その他諸費用現価     =                           
010080          ( 入力−その他１ + 入力−その他２ )  * 入力−リース期間.
010090     MOVE  Ｗ−その他諸費用現価       TO                          
010100                                         出力２−その他諸費用現価.
010110*--< No.78 >                                                      
010120     MOVE  ZERO                       TO                          
010121                                     出力２−一般その他諸費用現価.
010130*--< No.79 >                                                      
010140     MOVE  ZERO                       TO                          
010141                                       出力２−委託保険料費用総額.
010150*--< No.80 >                                                      
010160     MOVE  ZERO                       TO                          
010161                                     出力２−委託保険料費用１回分.
010170*--< No.81 >                                                      
010180     COMPUTE Ｗ−その他諸費用総額     =                           
010190	         ( 入力−その他１ + 入力−その他２ ) * 入力−リース期間.
010200     MOVE  Ｗ−その他諸費用総額       TO                          
010210                                         出力２−その他諸費用総額.
010220*--< No.82 >                                                      
010230     COMPUTE Ｗ−その他諸費用１回分   =                           
010240	                                入力−その他１  + 入力−その他２
010250     MOVE  Ｗ−その他諸費用１回分     TO                          
010260                                       出力２−その他諸費用１回分.
010270*--< No.83 >                                                      
010280     MOVE  ZERO                       TO                          
010281                                   出力２−委託保険料費用総額当社.
010290*--< No.84 >                                                      
010300     MOVE  ZERO                       TO                          
010301                                 出力２−委託保険料費用１回分当社.
010310*--< No.85 >                                                      
010320     COMPUTE Ｗ−その他諸費用総額当社 =                           
010330	        ( 入力−その他１  + 入力−その他２ ) * 入力−リース期間.
010340     MOVE  Ｗ−その他諸費用総額当社   TO                          
010350                                     出力２−その他諸費用総額当社.
010360*--< No.86 >                                                      
010370     COMPUTE Ｗ−その他諸費用１回分当社                           
010371                                      =                           
010380	                                 入力−その他１ + 入力−その他２
010390     MOVE  Ｗ−その他諸費用１回分当社 TO                          
010400                                   出力２−その他諸費用１回分当社.
010410*--< No.87 >                                                      
010420     MOVE  Ｗ−システム日付           TO  出力２−更新年月日.     
010430*--< No.88 >                                                      
010440     MOVE  Ｗ−システム時刻           TO  出力２−更新時間.       
010450*--< No.89 >                                                      
010460     MOVE  Ｗ−担当者                 TO  出力２−更新者.         
010470*--< No.90 >                                                      
010480     MOVE  Ｗ−システム日付           TO  出力２−登録年月日.     
010490*--< No.91 >                                                      
010500     MOVE  Ｗ−システム時刻           TO  出力２−登録時間.       
010510*--< No.92 >                                                      
010520     MOVE  Ｗ−担当者                 TO  出力２−登録担当者.     
010530*--< No.93 >                                                      
010540     MOVE  Ｗ−担当者                 TO                          
010541                                         出力２−入力担当者コード.
010550*                                                                 
010560     WRITE  出力２−レコード.                                     
010570*                                                                 
010580*--< 協調幹事持分出力の状態判定 >                                 
010590     EVALUATE  Ｗ−状態                                           
010600        WHEN  ZERO                                                
010610*--<       協調幹事持分出力件数の加算 >                           
010620           COMPUTE  Ｗ−持分−件数 =  Ｗ−持分−件数 + 1          
010630        WHEN  OTHER                                               
010640*--<       協調幹事持分ファイル出力エラー >                       
010650           MOVE     -6                TO  Ｗ−エラーコード        
010660           PERFORM  エラー処理                                    
010670     END-EVALUATE.                                                
010680*                                                                 
010690 協調幹事持分編集処理−ＥＸＩＴ.                          
010700     EXIT.                                                        
010710                                                                  
010720                                                                  
010730******************************************************************
010740*    終了メッセージ出力                                          *
010750******************************************************************
010760  終了メッセージ出力                  SECTION.                    
010770  終了メッセージ出力−ＳＴＡＲＴ.                                 
010780*----------------------------------------------------------------*
010790*    債権明細ファイル入力件数                                    *
010800*----------------------------------------------------------------*
010810     INITIALIZE                       IF-CHOCO001.                
010820     MOVE  "3"                        TO  共通−イベント種別.     
010830     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
010840     MOVE  "0"                        TO  共通−復帰コード.       
010850     MOVE  "FFUIS350"                 TO  共通−処理テーブルＩＤ. 
010860     MOVE  "COUNT"                    TO  共通−処理識別.         
010870     MOVE  Ｗ−債権明細−件数         TO  共通−データ内容.       
010880     MOVE  "債権明細ファイル入力件数"                                     
010890                                      TO  共通−その他メッセージ. 
010900     CALL  CLOCO001                USING  IF-CHOCO001.            
010910*                                                                 
010920*----------------------------------------------------------------*
010930*    検収後協調幹事持分以外ファイル出力件数                      *
010940*----------------------------------------------------------------*
010950     INITIALIZE                       IF-CHOCO001.                
010960     MOVE  "3"                        TO  共通−イベント種別.     
010970     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
010980     MOVE  "0"                        TO  共通−復帰コード.       
010990     MOVE  "FFUIS351"                 TO  共通−処理テーブルＩＤ. 
011000     MOVE  "COUNT"                    TO  共通−処理識別.         
011010     MOVE  Ｗ−持分以外−件数             TO  共通−データ内容.   
011020     MOVE  "検収後・協調持分以外出力件数"                   
011030                                      TO  共通−その他メッセージ. 
011040     CALL  CLOCO001                USING  IF-CHOCO001.            
011050*                                                                 
011060*----------------------------------------------------------------*
011070*    検収後協調幹事持分ファイル出力件数                          *
011080*----------------------------------------------------------------*
011090     INITIALIZE                       IF-CHOCO001.                
011100     MOVE  "3"                        TO  共通−イベント種別.     
011110     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
011120     MOVE  "0"                        TO  共通−復帰コード.       
011130     MOVE  "FFUIS352"                 TO  共通−処理テーブルＩＤ. 
011140     MOVE  "COUNT"                    TO  共通−処理識別.         
011150     MOVE  Ｗ−持分−件数             TO  共通−データ内容.       
011160     MOVE  "検収後・協調持分出力件数"                       
011170                                      TO  共通−その他メッセージ. 
011180     CALL  CLOCO001                USING  IF-CHOCO001.            
011190*                                                                 
011200*----------------------------------------------------------------*
011210*    終了メッセージ 出力                                         *
011220*----------------------------------------------------------------*
011230     INITIALIZE                       IF-CHOCO001.                
011240     MOVE  "3"                        TO  共通−イベント種別.     
011250     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
011260     MOVE  "0"                        TO  共通−復帰コード.       
011270     MOVE  "END"                      TO  共通−処理識別.         
011280     MOVE  定数−プログラム名         TO  共通−その他メッセージ. 
011290     CALL  CLOCO001                USING  IF-CHOCO001.            
011300*                                                                 
011310 終了メッセージ出力−ＥＸＩＴ.                                    
011320     EXIT.                                                        
011330******************************************************************
011340*    エラー処理                                                  *
011350******************************************************************
011360 エラー処理                           SECTION.                    
011370 エラー処理−ＳＴＡＲＴ.                                          
011380*                                                                 
011390     MOVE  "Y"                        TO  Ｗ−異常終了−フラグ.   
011400     INITIALIZE                           IF-CHOCO001.            
011410*                                                                 
011420     EVALUATE  Ｗ−エラーコード                                   
011430        WHEN  -1                                                  
011440*--<       債権明細ファイルオープンエラー >                       
011450           MOVE  "1"                  TO  共通−イベント種別      
011460           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
011470           MOVE  "9"                  TO  共通−復帰コード        
011480           MOVE  "FFUIS350"           TO  共通−処理テーブルＩＤ  
011490           MOVE  "OPEN"               TO  共通−処理識別          
011500           MOVE  Ｗ−状態             TO  共通−データ内容        
011510           MOVE  "債権明細ファイルオープンエラー "                
011520                                      TO  共通−その他メッセージ  
011530           CALL  CLOCO001          USING  IF-CHOCO001             
011540*                                                                 
011550        WHEN  -2                                                  
011560*--<       持分以外ファイルオープンエラー >                       
011570           MOVE  "1"                  TO  共通−イベント種別      
011580           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
011590           MOVE  "9"                  TO  共通−復帰コード        
011600           MOVE  "FFUIS351"           TO  共通−処理テーブルＩＤ  
011610           MOVE  "OPEN"               TO  共通−処理識別          
011620           MOVE  Ｗ−状態             TO  共通−データ内容        
011630           MOVE  "持分以外ファイルオープンエラー "                
011640                                      TO  共通−その他メッセージ  
011650           CALL  CLOCO001          USING  IF-CHOCO001             
011660*                                                                 
011670        WHEN  -3                                                  
011680*--<       持分ファイルオープンエラー >                           
011690           MOVE  "1"                  TO  共通−イベント種別      
011700           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
011710           MOVE  "9"                  TO  共通−復帰コード        
011720           MOVE  "FFUIS352"           TO  共通−処理テーブルＩＤ  
011730           MOVE  "OPEN"               TO  共通−処理識別          
011740           MOVE  Ｗ−状態             TO  共通−データ内容        
011750           MOVE  "持分ファイルオープンエラー "                    
011760                                      TO  共通−その他メッセージ  
011770           CALL  CLOCO001          USING  IF-CHOCO001             
011780*                                                                 
011790        WHEN  -4                                                  
011800*--<       債権明細読込エラー >                                   
011810           MOVE  "1"                  TO  共通−イベント種別      
011820           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
011830           MOVE  "9"                  TO  共通−復帰コード        
011840           MOVE  "FFUIS350"           TO  共通−処理テーブルＩＤ  
011850           MOVE  "READ"               TO  共通−処理識別          
011860           MOVE  Ｗ−状態             TO  共通−データ内容        
011870           MOVE  "債権明細ファイル読込エラー "                    
011880                                      TO  共通−その他メッセージ  
011890           CALL  CLOCO001          USING  IF-CHOCO001             
011900*                                                                 
011910        WHEN  -5                                                  
011920*--<       検収後協調幹事持分以外ファイル出力エラー >             
011930           MOVE  "1"                  TO  共通−イベント種別      
011940           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
011950           MOVE  "9"                  TO  共通−復帰コード        
011960           MOVE  "FFUIS351"           TO  共通−処理テーブルＩＤ  
011970           MOVE  "WRITE"              TO  共通−処理識別          
011980           MOVE  Ｗ−状態             TO  共通−データ内容        
011990           MOVE  "検収後協調幹事持分以外ファイル出力エラー "      
012000                                      TO  共通−その他メッセージ  
012010           CALL  CLOCO001          USING  IF-CHOCO001             
012020*                                                                 
012030        WHEN  OTHER                                               
012040           MOVE  "N"                  TO  Ｗ−異常終了−フラグ    
012050*                                                                 
012060     END-EVALUATE.                                                
012070*                                                                 
012080     IF  Ｗ−異常終了−フラグ  =  "Y"                             
012090        PERFORM  終了メッセージ出力                               
012100*                                                                 
012110*--<    プログラム異常終了のリターンコード >                      
012120        MOVE  定数−異常状態          TO  PROGRAM-STATUS          
012130*                                                                 
012140        EXIT  PROGRAM                                             
012150     END-IF.                                                      
012160*                                                                 
012170 エラー処理−ＥＸＩＴ.                                            
012180      EXIT.                                                       
012190******************************************************************
012200*                  END OF PROGRAM                                *
012210******************************************************************
