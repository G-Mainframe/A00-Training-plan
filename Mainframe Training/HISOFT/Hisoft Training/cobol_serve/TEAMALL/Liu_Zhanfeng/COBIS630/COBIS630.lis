Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

ファイル: COBIS630.PCOをオープン
     1  000010******************************************************************
     2  000020*         ＜海輝軟件(大連)＞                                     *
     3  000030*      1. プログラム名  : 受取手形移行処理                       *
     4  000040*      2. プログラムID  : COBIS630                               *
     5  000050*      3. 処理概要      : ＜受取手形テーブル＞受取手形の情報を代 *
     6  000060*                         表契約番号、束数位で管理したもの       *
     7  000070*                         ＜受取手形展開テーブル＞受取手形の情報 *
     8  000080*                         を代表契約番号、束数、連番（代表契約番 *
     9  000090*                         号、束数単位)単位で管理したもの        *
    10  000100*      4. 作成者        : 柳占鋒                                 *
    11  000110*      5. 作成日        : 2005.04.04                             *
    12  000120******************************************************************
    13  000130*                                                                 
    14  000140******************************************************************
    15  000150*    ＩＤＥＮＴＩＦＩＣＡＴＩＯＮ  ＤＩＶＩＳＩＯＮ              *
    16  000160******************************************************************
    17  000170 IDENTIFICATION                       DIVISION.                   
    18  000180*                                                                 
    19  000190 PROGRAM-ID.                          COBIS630.                   
    20  000200******************************************************************
    21  000210*    ＥＮＶＩＲＯＮＭＥＮＴ        ＤＩＶＩＳＩＯＮ              *
    22  000220******************************************************************
    23  000230 ENVIRONMENT                          DIVISION.                   
    24  000240******************************************************************
    25  000250*    ＩＮＰＵＴ−ＯＵＴＰＵＴ      ＳＥＣＴＩＯＮ                *
    26  000260******************************************************************
    27  000270 INPUT-OUTPUT                         SECTION.                    
    28  000280*                                                                 
    29  000290 FILE-CONTROL.                                                    
    30  000300     SELECT    入力ファイル１         ASSIGN    TO     U01        
    31  000310     FILE      STATUS     IS          Ｗ−状態                    
    32  000320     ORGANIZATION         IS          LINE      SEQUENTIAL.       
    33  000330*                                                                 
    34  000340     SELECT    入力ファイル２         ASSIGN    TO     U02        
    35  000350     FILE      STATUS     IS          Ｗ−状態                    
    36  000360     ORGANIZATION         IS          LINE      SEQUENTIAL.       
    37  000370*                                                                 
    38  000380******************************************************************
    39  000390*    ＤＡＴＡ                      ＤＩＶＩＳＩＯＮ              *
    40  000400******************************************************************
    41  000410 DATA                                 DIVISION.                   
    42  000420******************************************************************
    43  000430*    ＦＩＬＥ                      ＳＥＣＴＩＯＮ                *
    44  000440******************************************************************
    45  000450 FILE                                 SECTION.                    
    46  000460*----------------------------------------------------------------*
    47  000470*    入力ファイル                                                *
    48  000480*----------------------------------------------------------------*
    49  000490 FD  入力ファイル１                                               
    50  000500     LABEL     RECORD     IS          STANDARD                    
    51  000510     BLOCK     CONTAINS   0           RECORDS.                    
    52  000520*                                                                 
    53  000530 01  入力−レコード１.                                            
    54  000540     COPY  CPBIS061  REPLACING  ==()==  BY  ==入力１−==.         
    55  000550*                                                                 
    56  000560 FD  入力ファイル２                                               
    57  000570     LABEL     RECORD     IS          STANDARD                    
    58  000580     BLOCK     CONTAINS   0           RECORDS.                    
    59  000590*                                                                 
    60  000600 01  入力−レコード２.                                            
    61  000610     COPY  CPBIS062  REPLACING  ==()==  BY  ==入力２−==.         
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    62  000620*                                                                 
    63  000630******************************************************************
    64  000640*  ＷＯＲＫＩＮＧ−ＳＴＯＲＡＧＥ  ＳＥＣＴＩＯＮ                *
    65  000650******************************************************************
    66  000660  WORKING-STORAGE                     SECTION.                    
    67  000670*----------------------------------------------------------------*
    68  000680*    ホスト変数定義エリア                                        *
    69  000690*----------------------------------------------------------------*
    70  000700     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
    71  000710*                                                                 
    72  000720 01  ＷＳ−取引先コード               PIC  X(08).                 
    73  000730 01  ＷＳ−目的ＣＤ                   PIC  X(01)  VALUE "2".      
    74  000740 01  ＷＳ−契約ＮＯ                   PIC  X(09).                 
    75  000750 01  ＷＳ−支払人コード               PIC  X(08).                 
    76  000760*--< ＯＲＡＣＬＥ共通変数 >                                       
    77  000770     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
    78  000780*                                                                 
    79  000790*--< ＯＲＡＣＬＥ  ＳＱＬ実行情報 >                               
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをオープン
     1  000010*--＜ＳＱＬ共通変数＞
     2  000030   01  SQLSTATE                      PIC  X(005).
     3  000040   01  DB-STRING                     PIC  X(020).
     4  000050   01  USERNAME                      PIC  X(010).
     5  000060   01  PASSWD                        PIC  X(010).
     6  000070*
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをクローズ
    80  000800     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
    81  000810*                                                                 
    82  000820*--< 受取手形テーブル >                                           
    83  000830     EXEC  SQL  INCLUDE  D642UTG.CBL           END-EXEC.          
    84  000840*                                                                 
    85  000850*--< 受取手形展開テーブル >                                       
ファイル: Z:\COB97\COPYLIB_DB\D642UTG.CBLをオープン
     1        *****************************************************************
     2        *   受取手形(D642UTG_TBL)
     3        *****************************************************************
     4         01  受取手形.
     5             03  Ｄ６４２−代表契約番号
     6                                       PIC  X(010).
     7             03  Ｄ６４２−束数        PIC S9(003) PACKED-DECIMAL.
     8             03  Ｄ６４２−取引先コード
     9                                       PIC  X(009).
    10             03  Ｄ６４２−契約先コード
    11                                       PIC  X(005).
    12             03  Ｄ６４２−契約先名称  PIC  X(040).
    13             03  Ｄ６４２−契約先名称カナ
    14                                       PIC  X(040).
    15             03  Ｄ６４２−部店コード  PIC  X(004).
    16             03  Ｄ６４２−主契約区分  PIC  X(001).
    17             03  Ｄ６４２−手形状態    PIC  X(001).
    18             03  Ｄ６４２−取引日      PIC  X(008).
    19             03  Ｄ６４２−伝票発行日  PIC  X(008).
    20             03  Ｄ６４２−手形種類    PIC  X(001).
    21             03  Ｄ６４２−期日基準日  PIC  X(008).
    22             03  Ｄ６４２−期日サイクル
    23                                       PIC S9(002) PACKED-DECIMAL.
    24             03  Ｄ６４２−束合計金額  PIC S9(013) PACKED-DECIMAL.
    25             03  Ｄ６４２−手形枚数    PIC S9(004) PACKED-DECIMAL.
    26             03  Ｄ６４２−取立銀行コード
    27                                       PIC  X(007).
    28             03  Ｄ６４２−支払銀行コード
    29                                       PIC  X(007).
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    30             03  Ｄ６４２−契約番号１  PIC  X(010).
    31             03  Ｄ６４２−契約番号２  PIC  X(010).
    32             03  Ｄ６４２−契約番号３  PIC  X(010).
    33             03  Ｄ６４２−契約番号４  PIC  X(010).
    34             03  Ｄ６４２−契約番号５  PIC  X(010).
    35             03  Ｄ６４２−契約番号６  PIC  X(010).
    36             03  Ｄ６４２−契約番号７  PIC  X(010).
    37             03  Ｄ６４２−契約番号８  PIC  X(010).
    38             03  Ｄ６４２−契約番号９  PIC  X(010).
    39             03  Ｄ６４２−契約番号１０
    40                                       PIC  X(010).
    41             03  Ｄ６４２−備考欄      PIC  X(040).
    42             03  Ｄ６４２−手形内容種別
    43                                       PIC  X(001).
    44             03  Ｄ６４２−登録年月日  PIC  X(008).
    45             03  Ｄ６４２−登録時間    PIC  X(008).
    46             03  Ｄ６４２−登録担当者  PIC  X(008).
    47             03  Ｄ６４２−更新年月日  PIC  X(008).
    48             03  Ｄ６４２−更新時間    PIC  X(008).
    49             03  Ｄ６４２−更新者      PIC  X(008).
    50             03  Ｄ６４２−入力担当者コード
    51                                       PIC  X(008).
    52             03  Ｄ６４２−売却代金区分
    53                                       PIC  X(001).
    54             03  Ｄ６４２−振出人取引先コード
    55                                       PIC  X(009).
    56             03  Ｄ６４２−振出人契約先コード
    57                                       PIC  X(005).
    58             03  Ｄ６４２−振出人名称  PIC  X(040).
    59             03  Ｄ６４２−振出人名称カナ
    60                                       PIC  X(040).
ファイル: Z:\COB97\COPYLIB_DB\D642UTG.CBLをクローズ
    86  000860     EXEC  SQL  INCLUDE  D645UTT.CBL           END-EXEC.          
    87  000870*                                                                 
    88  000880*--< 変換テーブル >                                               
ファイル: Z:\COB97\COPYLIB_DB\D645UTT.CBLをオープン
     1        *****************************************************************
     2        *   受取手形展開(D645UTT_TBL)
     3        *****************************************************************
     4         01  受取手形展開.
     5             03  Ｄ６４５−代表契約番号
     6                                       PIC  X(010).
     7             03  Ｄ６４５−束数        PIC S9(003) PACKED-DECIMAL.
     8             03  Ｄ６４５−連番        PIC S9(003) PACKED-DECIMAL.
     9             03  Ｄ６４５−手形番号    PIC  X(010).
    10             03  Ｄ６４５−期日        PIC  X(008).
    11             03  Ｄ６４５−金額        PIC S9(013) PACKED-DECIMAL.
    12             03  Ｄ６４５−振出人取引先コード
    13                                       PIC  X(009).
    14             03  Ｄ６４５−振出人契約先コード
    15                                       PIC  X(005).
    16             03  Ｄ６４５−振出人名称  PIC  X(040).
    17             03  Ｄ６４５−振出人名称カナ
    18                                       PIC  X(040).
    19             03  Ｄ６４５−登録年月日  PIC  X(008).
    20             03  Ｄ６４５−登録時間    PIC  X(008).
    21             03  Ｄ６４５−登録担当者  PIC  X(008).
    22             03  Ｄ６４５−更新年月日  PIC  X(008).
    23             03  Ｄ６４５−更新時間    PIC  X(008).
    24             03  Ｄ６４５−更新者      PIC  X(008).
    25             03  Ｄ６４５−入力担当者コード
    26                                       PIC  X(008).
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    27             03  Ｄ６４５−手形状態    PIC  X(001).
ファイル: Z:\COB97\COPYLIB_DB\D645UTT.CBLをクローズ
    89  000890     EXEC  SQL  INCLUDE  IKOTBL001.CBL         END-EXEC.          
    90  000900*                                                                 
    91  000910*--< 契約種類等変換テーブル >                                     
ファイル: Z:\COB97\COPYLIB_DB\IKOTBL001.CBLをオープン
     1  000010************************************************
     2  000020* 変換テーブル(IKOTBL001)
     3  000030************************************************
     4  000040 01  ＩＫＯ００１−取引先コード PIC  X(008).
     5  000050 01  ＩＫＯ００１−目的ＣＤ PIC  X(001).
     6  000060 01  ＩＫＯ００１−新取引先コード PIC  X(007).
     7  000070 01  ＩＫＯ００１−枝番 PIC  X(003).
     8  000080 01  ＩＫＯ００１−与信括りコード PIC  X(007).
     9  000090 01  ＩＫＯ００１−名寄せコード PIC  X(008).
    10  000100 01  ＩＫＯ００１−ユーザコード PIC  X(008).
    11  000110 01  ＩＫＯ００１−識別ＣＤ PIC  X(001).
ファイル: Z:\COB97\COPYLIB_DB\IKOTBL001.CBLをクローズ
    92  000920     EXEC  SQL  INCLUDE  IKOTBL002.CBL         END-EXEC.          
    93  000930*                                                                 
ファイル: Z:\COB97\COPYLIB_DB\IKOTBL002.CBLをオープン
     1  000010************************************************
     2  000020* 契約種類等変換テーブル(IKOTBL002)
     3  000030************************************************
     4  000040 01  ＩＫＯ００２−契約ＮＯ PIC  X(009).
     5  000050 01  ＩＫＯ００２−再リースコード PIC S9(001) COMP-3.
     6  000060 01  ＩＫＯ００２−旧債権勘定処理コード PIC S9(002) COMP-3.
     7  000070 01  ＩＫＯ００２−旧債務勘定処理コード PIC S9(002) COMP-3.
     8  000080 01  ＩＫＯ００２−再リース回数 PIC S9(002) COMP-3.
     9  000090 01  ＩＫＯ００２−債権勘定処理コード PIC S9(002) COMP-3.
    10  000100 01  ＩＫＯ００２−債務勘定処理コード PIC S9(002) COMP-3.
    11  000110 01  ＩＫＯ００２−契約種類 PIC  X(003).
    12  000120 01  ＩＫＯ００２−主契約区分 PIC  X(001).
    13  000130 01  ＩＫＯ００２−回収手順 PIC  X(001).
ファイル: Z:\COB97\COPYLIB_DB\IKOTBL002.CBLをクローズ
    94  000940     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
    95  000950*                                                                 
    96  000960*----------------------------------------------------------------*
    97  000970*    ＷＯＲＫエリア                                              *
    98  000980*----------------------------------------------------------------*
    99  000990 01  ＷＯＲＫ−エリア.                                            
   100  001000*--< エラー判定用 >                                               
   101  001010     03  Ｗ−エラーコード             PIC S9(04).                 
   102  001020*--< 日期処理 >                                                   
   103  001021     03  Ｗ−入力日期                 PIC  X(07).                 
   104  001022     03  Ｗ−出力日期                 PIC  X(08).                 
   105  001023*                                                                 
   106  001030*--< フラグアリア >                                               
   107  001040     03  フラグアリア.                                            
   108  001050         05  Ｗ−終了−フラグ１       PIC  X(01).                 
   109  001060         05  Ｗ−終了−フラグ２       PIC  X(01).                 
   110  001070         05  Ｗ−異常終了−フラグ     PIC  X(01).                 
   111  001080*                                                                 
   112  001090*--< 件数エリア >                                                 
   113  001100     03  件数エリア.                                              
   114  001110         05  Ｗ−入力−件数１         PIC  9(09).                 
   115  001120         05  Ｗ−入力−件数２         PIC  9(09).                 
   116  001130         05  Ｗ−出力−件数１         PIC  9(09).                 
   117  001140         05  Ｗ−出力−件数２         PIC  9(09).                 
   118  001150*                                                                 
   119  001160*--< 連番エリア >                                                 
   120  001170     03  連番エリア.                                              
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   121  001220         05  Ｗ−連番                 PIC S9(03).                 
   122  001230*                                                                 
   123  001240*--< ファイル状態 >                                               
   124  001250     03  Ｗ−状態エリア.                                          
   125  001260         05  Ｗ−状態                 PIC  X(02).                 
   126  001270*--< キーエリア >                                                 
   127  001280     03  ＫＥＹ−エリア.                                          
   128  001290         05  ＮＥＷキー.                                          
   129  001292             07 Ｗ−契約ＮＯ１        PIC  X(09).                 
   130  001300             07 Ｗ−契約ＮＯ２        PIC  X(09).                 
   131  001311             07 Ｎ−束数              PIC S9(02).                 
   132  001312         05  ＯＬＤキー.                                          
   133  001313             07 Ｏ−契約ＮＯ１        PIC  X(09).                 
   134  001314             07 Ｏ−束数              PIC S9(02).                 
   135  001316*                                                                 
   136  001320*--< 共通情報 >                                                   
   137  001330 01  Ｗ−共通情報.                                                
   138  001340     03  Ｗ−システム日付.                                        
   139  001350         05  Ｗ−世紀                 PIC  X(02) VALUE  "20".     
   140  001360         05  Ｗ−年月日               PIC  X(06).                 
   141  001370     03  Ｗ−システム時刻             PIC  X(08).                 
   142  001380     03  Ｗ−担当者                   PIC  X(08) VALUE "IKOPG   ".
   143  001390*                                                                 
   144  001400*----------------------------------------------------------------*
   145  001410*    サブルーチン名                                              *
   146  001420*----------------------------------------------------------------*
   147  001430 01  CALL-AREA.                                                   
   148  001440*--< 共通ログサブルーチン >                                       
   149  001450     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
   150  001460     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
   151  001470*                                                                 
   152  001480*----------------------------------------------------------------*
   153  001490*    ＣＯＰＹ領域                                                *
   154  001500*----------------------------------------------------------------*
   155  001510*--< 共通ログ用パラメータ >                                       
   156  001520 01  IF-CHOCO001.                                                 
   157  001530     COPY  CHOCO001  REPLACING  ==()==  BY  ==共通−==.           
   158  001540*                                                                 
   159  001550*----------------------------------------------------------------*
   160  001560*    ＩＮＩファイル読込サブルーチン用パラメタ領域                *
   161  001570*----------------------------------------------------------------*
   162  001580 01  PARA-AREA.                                                   
   163  001590     COPY CPBCO001.                                               
   164  001600*                                                                 
   165  001610******************************************************************
   166  001620*    定数用データ定義エリア                                      *
   167  001630******************************************************************
   168  001640 CONSTANT                             SECTION.                    
   169  001650 01  定数領域.                                                    
   170  001660     03  定数−プログラムＩＤ         PIC  X(08) VALUE "COBIS630".
   171  001670     03  定数−プログラム名           PIC  X(80)                  
   172  001680                                        VALUE  "受取手形移行処理".
   173  001690     03  定数−ＳＱＬＯＫ             PIC S9(04)  VALUE  ZERO.    
   174  001700     03  定数−ＳＱＬＣＤＤＥＯＫ     PIC S9(04)  VALUE -2112.    
   175  001710     03  定数−ＳＱＬＥＮＤ           PIC S9(04)  VALUE  0100.    
   176  001720     03  定数−正常状態               PIC S9(04)  VALUE  ZERO.    
   177  001731     03  定数−異常状態               PIC S9(04)  VALUE  0009.    
   178  001740******************************************************************
   179  001750*    ＰＲＯＣＥＤＵＲＥ            ＤＩＶＩＳＩＯＮ              *
   180  001760******************************************************************
   181  001770 PROCEDURE                            DIVISION.                   
   182  001780*                                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   183  001790     PERFORM  初期処理.                                           
   184  001800*                                                                 
   185  001810     PERFORM  主処理  UNTIL  (Ｗ−終了−フラグ１  =  "Y"          
   186  001820                        AND   Ｗ−終了−フラグ２  =  "Y").        
   187  001830*                                                                 
   188  001840     PERFORM  終了処理.                                           
   189  001850*                                                                 
   190  001860     STOP     RUN.                                                
   191  001870*                                                                 
   192  001880******************************************************************
   193  001890*    初期処理                                                    *
   194  001900******************************************************************
   195  001910 初期処理                             SECTION.                    
   196  001920 初期処理−ＳＴＡＲＴ.                                            
   197  001930*                                                                 
   198  001940*----------------------------------------------------------------*
   199  001950*    開始メッセージ出力処理                                      *
   200  001960*----------------------------------------------------------------*
   201  001970     INITIALIZE                       IF-CHOCO001.                
   202  001980     MOVE  "3"                        TO  共通−イベント種別.     
   203  001990     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
   204  002000     MOVE  "0"                        TO  共通−復帰コード.       
   205  002010     MOVE  "START"                    TO  共通−処理識別.         
   206  002020     MOVE  定数−プログラム名         TO  共通−その他メッセージ. 
   207  002030     CALL  CLOCO001                USING  IF-CHOCO001.            
   208  002040*                                                                 
   209  002050*----------------------------------------------------------------*
   210  002060*    作業領域の初期値処理                                        *
   211  002070*----------------------------------------------------------------*
   212  002080     MOVE  SPACE                      TO  ＷＯＲＫ−エリア.       
   213  002090     INITIALIZE                           ＷＯＲＫ−エリア.       
   214  002100*                                                                 
   215  002110*--< ＣＰＵ日付を取得 >                                           
   216  002120     ACCEPT  Ｗ−年月日               FROM  DATE.                 
   217  002130*                                                                 
   218  002140*--< ＣＰＵ時刻を取得 >                                           
   219  002150     ACCEPT  Ｗ−システム時刻         FROM  TIME.                 
   220  002160*                                                                 
   221  002170     PERFORM  手形基本ファイルオープン.                           
   222  002180*                                                                 
   223  002190     PERFORM  受取手形ファイルオープン.                           
   224  002200*                                                                 
   225  002210     PERFORM  ＯＲＡＣＬＥ接続.                                   
   226  002220*                                                                 
   227  002230*--< 手形基本ファイル読込(１件目) >                               
   228  002240     PERFORM  手形基本ファイル読込処理.                           
   229  002250*                                                                 
   230  002260*--< 受取手形ファイル読込(１件目) >                               
   231  002270     PERFORM  受取手形ファイル読込処理.                           
   232  002280*                                                                 
   233  002290 初期処理−ＥＸＩＴ.                                              
   234  002300     EXIT.                                                        
   235  002310******************************************************************
   236  002320*    ＯＲＡＣＬＥ接続                                            *
   237  002330******************************************************************
   238  002340 ＯＲＡＣＬＥ接続                     SECTION.                    
   239  002350 ＯＲＡＣＬＥ接続−ＳＴＡＲＴ.                                    
   240  002360*                                                                 
   241  002370*--< ＤＢ接続用情報を取得処理 >                                   
   242  002380     CALL  COBCO001                USING  PARA-AREA.              
   243  002390*                                                                 
   244  002400     MOVE  PARA-DBSTRING              TO  DB-STRING.              
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   245  002410     MOVE  PARA-USERNAME              TO  USERNAME.               
   246  002420     MOVE  PARA-PASSWORD              TO  PASSWD.                 
   247  002430*                                                                 
   248  002440*----------------------------------------------------------------*
   249  002450*    開始接続                                                    *
   250  002460*----------------------------------------------------------------*
   251  002470     IF    DB-STRING  =  SPACE                                    
   252  002480        EXEC SQL                                                  
   253  002490           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   254  002500        END-EXEC                                                  
   255  002510     ELSE                                                         
   256  002520        EXEC SQL                                                  
   257  002530           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   258  002540             USING  :DB-STRING                                    
   259  002550        END-EXEC                                                  
   260  002560     END-IF.                                                      
   261  002570*                                                                 
   262  002580*----------------------------------------------------------------*
   263  002590*    接続確認                                                    *
   264  002600*----------------------------------------------------------------*
   265  002610     EVALUATE  SQLCODE                                            
   266  002620        WHEN   定数−ＳＱＬＯＫ                                   
   267  002630           CONTINUE                                               
   268  002640        WHEN   OTHER                                              
   269  002650*--<       接続エラー >                                           
   270  002660           MOVE     -10               TO  Ｗ−エラーコード        
   271  002670           PERFORM  エラー判定処理                                
   272  002680     END-EVALUATE.                                                
   273  002690*                                                                 
   274  002700 ＯＲＡＣＬＥ接続−ＥＸＩＴ.                                      
   275  002710     EXIT.                                                        
   276  002720******************************************************************
   277  002730*    手形基本、受取手形ファイルオープン                          *
   278  002740******************************************************************
   279  002750*                                                                 
   280  002760*----------------------------------------------------------------*
   281  002770*    手形基本ファイルのオープン                                  *
   282  002780*----------------------------------------------------------------*
   283  002790 手形基本ファイルオープン             SECTION.                    
   284  002800 手形基本ファイルオープン−ＳＴＡＲＴ.                            
   285  002810*                                                                 
   286  002820     OPEN  INPUT   入力ファイル１.                                
   287  002830*                                                                 
   288  002840*--< 入力ファイル１オープンの状態判定 >                           
   289  002850     EVALUATE  Ｗ−状態                                           
   290  002860        WHEN  ZERO                                                
   291  002870           CONTINUE                                               
   292  002880        WHEN  OTHER                                               
   293  002890*--<       入力ファイル１オープンエラー >                         
   294  002900           MOVE     -1                TO  Ｗ−エラーコード        
   295  002910           PERFORM  エラー判定処理                                
   296  002920     END-EVALUATE.                                                
   297  002930*                                                                 
   298  002940 手形基本ファイルオープン−ＥＸＩＴ.                              
   299  002950     EXIT.                                                        
   300  002960*----------------------------------------------------------------*
   301  002970*    受取手形ファイルのオープン                                  *
   302  002980*----------------------------------------------------------------*
   303  002990 受取手形ファイルオープン             SECTION.                    
   304  003000 受取手形ファイルオープン−ＳＴＡＲＴ.                            
   305  003010*                                                                 
   306  003020     OPEN  INPUT    入力ファイル２.                               
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   307  003030*                                                                 
   308  003040*--< 入力ファイル２オープンの状態判定 >                           
   309  003050     EVALUATE  Ｗ−状態                                           
   310  003060        WHEN  ZERO                                                
   311  003070           CONTINUE                                               
   312  003080        WHEN  OTHER                                               
   313  003090*--<       入力ファイル２オープンエラー >                         
   314  003100           MOVE     -2                TO  Ｗ−エラーコード        
   315  003110           PERFORM  エラー判定処理                                
   316  003120     END-EVALUATE.                                                
   317  003130*                                                                 
   318  003140 受取手形ファイルオープン−ＥＸＩＴ.                              
   319  003150     EXIT.                                                        
   320  003160******************************************************************
   321  003170*    手形基本、受取手形ファイル読込処理                          *
   322  003180******************************************************************
   323  003190*                                                                 
   324  003200*----------------------------------------------------------------*
   325  003210*    手形基本ファイル読込処理                                    *
   326  003220*----------------------------------------------------------------*
   327  003230 手形基本ファイル読込処理             SECTION.                    
   328  003240 手形基本ファイル読込処理−ＳＴＡＲＴ.                            
   329  003250*                                                                 
   330  003260     READ  入力ファイル１                                         
   331  003270        AT END                                                    
   332  003280           MOVE  "Y"                  TO  Ｗ−終了−フラグ１      
   333  003290           MOVE  HIGH-VALUE           TO  Ｗ−契約ＮＯ１          
   334  003300           GO    TO   手形基本ファイル読込処理−ＥＸＩＴ          
   335  003310     END-READ.                                                    
   336  003320*                                                                 
   337  003330*--< 手形基本ファイル読込状態判定 >                               
   338  003340     EVALUATE  Ｗ−状態                                           
   339  003350        WHEN  ZERO                                                
   340  003360           MOVE  入力１−契約ＮＯ     TO  Ｗ−契約ＮＯ１          
   341  003371           MOVE  入力１−契約ＮＯ     TO  ＷＳ−契約ＮＯ          
   342  003372           MOVE  入力１−取引先コード TO  ＷＳ−取引先コード      
   343  003374*--<       手形基本ファイル入力件数のカウント >                   
   344  003380           COMPUTE  Ｗ−入力−件数１  =  Ｗ−入力−件数１ + 1     
   345  003390        WHEN  OTHER                                               
   346  003400*--<       手形基本ファイル読込エラー >                           
   347  003410           MOVE     -3                TO  Ｗ−エラーコード        
   348  003420           PERFORM  エラー判定処理                                
   349  003430     END-EVALUATE.                                                
   350  003440*                                                                 
   351  003450 手形基本ファイル読込処理−ＥＸＩＴ.                              
   352  003460     EXIT.                                                        
   353  003470*----------------------------------------------------------------*
   354  003480*    受取手形ファイル読込処理                                    *
   355  003490*----------------------------------------------------------------*
   356  003500 受取手形ファイル読込処理             SECTION.                    
   357  003510 受取手形ファイル読込処理−ＳＴＡＲＴ.                            
   358  003520*                                                                 
   359  003530     READ  入力ファイル２                                         
   360  003540        AT END                                                    
   361  003550           MOVE  "Y"                  TO  Ｗ−終了−フラグ２      
   362  003560           MOVE  HIGH-VALUE           TO  Ｗ−契約ＮＯ２          
   363  003570           GO    TO   受取手形ファイル読込処理−ＥＸＩＴ          
   364  003580     END-READ.                                                    
   365  003590*                                                                 
   366  003600*--< 受取手形ファイル読込状態判定 >                               
   367  003610     EVALUATE  Ｗ−状態                                           
   368  003620        WHEN  ZERO                                                
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   369  003630           MOVE  入力２−契約ＮＯ     TO  Ｗ−契約ＮＯ２          
   370  003640           MOVE  入力２−束数         TO  Ｎ−束数                
   371  003641           MOVE  入力２−支払人コード TO  ＷＳ−支払人コード      
   372  003642*--<       受取手形ファイル入力件数のカウント >                   
   373  003650           COMPUTE  Ｗ−入力−件数２  =  Ｗ−入力−件数２ + 1     
   374  003660        WHEN  OTHER                                               
   375  003670*--<       受取手形ファイル読込エラー >                           
   376  003680           MOVE     -4                TO  Ｗ−エラーコード        
   377  003690           PERFORM  エラー判定処理                                
   378  003700     END-EVALUATE.                                                
   379  003710*                                                                 
   380  003720 受取手形ファイル読込処理−ＥＸＩＴ.                              
   381  003730     EXIT.                                                        
   382  003740*                                                                 
   383  003750******************************************************************
   384  003760*    主処理                                                      *
   385  003770******************************************************************
   386  003780 主処理                               SECTION.                    
   387  003790 主処理−ＳＴＡＲＴ.                                              
   388  003800*                                                                 
   389  003810     EVALUATE  TRUE                                               
   390  003820*--<    ファイルのみの場合 >                                      
   391  003830        WHEN  Ｗ−契約ＮＯ１ > Ｗ−契約ＮＯ２                     
   392  003840           PERFORM  受取手形ファイル読込処理                      
   393  003850*                                                                 
   394  003860*--<    マッチングの場合 >                                        
   395  003870        WHEN  Ｗ−契約ＮＯ１ = Ｗ−契約ＮＯ２                     
   396  003880           PERFORM  編集出力処理                                  
   397  003890*                                                                 
   398  003900           PERFORM  受取手形ファイル読込処理                      
   399  003910*                                                                 
   400  003920*--<    ファイルのみの場合 >                                      
   401  003930        WHEN  Ｗ−契約ＮＯ１ < Ｗ−契約ＮＯ２                     
   402  003950*                                                                 
   403  003960           IF Ｗ−契約ＮＯ１ NOT  =  Ｏ−契約ＮＯ１               
   404  003970              DISPLAY "***** COBIS630:受取手形ファイルなし ",     
   405  003980                      "契約ＮＯ=" , Ｗ−契約ＮＯ１                
   406  003990           END-IF                                                 
   407  004000           PERFORM  手形基本ファイル読込処理                      
   408  004001*                                                                 
   409  004010     END-EVALUATE.                                                
   410  004020*                                                                 
   411  004030 主処理−ＥＸＩＴ.                                                
   412  004040     EXIT.                                                        
   413  004050******************************************************************
   414  004060*     手形基本、受取手形編集出力処理                             *
   415  004070******************************************************************
   416  004080 編集出力処理                         SECTION.                    
   417  004090 編集出力処理−ＳＴＡＲＴ.                                        
   418  004100*                                                                 
   419  004110     PERFORM  受取手形編集処理.                                   
   420  004120*                                                                 
   421  004140     PERFORM  受取手形展開編集処理.                               
   422  004142     IF     Ｗ−契約ＮＯ１ = Ｏ−契約ＮＯ１                       
   423  004143        AND Ｎ−束数       = Ｏ−束数                             
   424  004144        PERFORM  受取手形展開出力処理                             
   425  004145     ELSE                                                         
   426  004146*                                                                 
   427  004150        PERFORM  受取手形出力処理                                 
   428  004161        PERFORM  受取手形展開出力処理                             
   429  004162     END-IF.                                                      
   430  004180*                                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   431  004190     MOVE Ｗ−契約ＮＯ１              TO  Ｏ−契約ＮＯ１.         
   432  004191     MOVE Ｎ−束数                    TO  Ｏ−束数.               
   433  004194*                                                                 
   434  004195 編集出力処理−ＥＸＩＴ.                                          
   435  004200     EXIT.                                                        
   436  004210*                                                                 
   437  004220******************************************************************
   438  004230*    受取手形、受取手形展開編集処理                              *
   439  004240******************************************************************
   440  004250 受取手形編集処理                     SECTION.                    
   441  004260 受取手形編集処理−ＳＴＡＲＴ.                                    
   442  004270*----------------------------------------------------------------*
   443  004280*       初期化処理                                               *
   444  004290*----------------------------------------------------------------*
   445  004300        MOVE  SPACE                   TO  受取手形.               
   446  004310        INITIALIZE                        受取手形.               
   447  004320*----------------------------------------------------------------*
   448  004330*       項目編集処理                                             *
   449  004340*----------------------------------------------------------------*
   450  004350*                                                                 
   451  004400*--< No.01 >                                                      
   452  004410     MOVE  入力１−契約ＮＯ           TO  Ｄ６４２−代表契約番号. 
   453  004420*--< No.02 >                                                      
   454  004430     MOVE  入力２−束数               TO  Ｄ６４２−束数.         
   455  004440*--< No.03 >                                                      
   456  004450*----------------------------------------------------------------*
   457  004460     EXEC  SQL                                                    
   458  004470        SELECT  新取引先コード                                    
   459  004480               ,枝番                                              
   460  004490          INTO :ＩＫＯ００１−新取引先コード                      
   461  004500              ,:ＩＫＯ００１−枝番                                
   462  004510          FROM  IKOTBL001                                         
   463  004520         WHERE  取引先コード  =  :ＷＳ−取引先コード              
   464  004530           AND  目的ＣＤ      =  :ＷＳ−目的ＣＤ                  
   465  004540     END-EXEC.                                                    
   466  004550*                                                                 
   467  004560     EVALUATE  SQLCODE                                            
   468  004570        WHEN   定数−ＳＱＬＯＫ                                   
   469  004580*--<       正常 >                                                 
   470  004590           CONTINUE                                               
   471  004600        WHEN   OTHER                                              
   472  004610*--<       項目抽出失敗 >                                         
   473  004620           MOVE      -7               TO  Ｗ−エラーコード        
   474  004630           PERFORM   エラー判定処理                               
   475  004640     END-EVALUATE.                                                
   476  004650*----------------------------------------------------------------*
   477  004660     MOVE  ＩＫＯ００１−新取引先コード                           
   478  004670                                      TO  Ｄ６４２−取引先コード. 
   479  004680*--< No.04 >                                                      
   480  004690     MOVE  ＩＫＯ００１−枝番         TO  Ｄ６４２−契約先コード. 
   481  004700*--< No.05 >                                                      
   482  004710     MOVE  入力１−名称漢字           TO  Ｄ６４２−契約先名称.   
   483  004720*--< No.06 >                                                      
   484  004730     MOVE  入力１−名称カナ          TO  Ｄ６４２−契約先名称カナ.
   485  004740*--< No.07 >                                                      
   486  004750     MOVE  入力１−事業所コード       TO  Ｄ６４２−部店コード.   
   487  004760*--< No.08 >                                                      
   488  004770*----------------------------------------------------------------*
   489  004790     EXEC  SQL                                                    
   490  004800        SELECT  主契約区分                                        
   491  004810          INTO :ＩＫＯ００２−主契約区分                          
   492  004820          FROM  IKOTBL002                                         
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   493  004830         WHERE  契約ＮＯ  =  :ＷＳ−契約ＮＯ                      
   494  004840     END-EXEC.                                                    
   495  004850*                                                                 
   496  004860     EVALUATE  SQLCODE                                            
   497  004870        WHEN   定数−ＳＱＬＯＫ                                   
   498  004880*--<       正常 >                                                 
   499  004890           CONTINUE                                               
   500  004900        WHEN   定数−ＳＱＬＣＤＤＥＯＫ                           
   501  004910*--<       正常 >                                                 
   502  004920           CONTINUE                                               
   503  004930        WHEN   OTHER                                              
   504  004940*--<       項目抽出失敗 >                                         
   505  004950           MOVE      -8               TO  Ｗ−エラーコード        
   506  004960           PERFORM   エラー判定処理                               
   507  004970     END-EVALUATE.                                                
   508  004980*----------------------------------------------------------------*
   509  004990     MOVE  ＩＫＯ００２−主契約区分   TO  Ｄ６４２−主契約区分.   
   510  005000*--< No.09 >                                                      
   511  005010     MOVE  ZERO                       TO  Ｄ６４２−手形状態.     
   512  005020*--< No.10 >                                                      
   513  005030     MOVE  入力２−取引日             TO  Ｄ６４２−取引日.       
   514  005040*--< No.11>                                                       
   515  005050     MOVE  入力２−伝票発行日         TO  Ｄ６４２−伝票発行日.   
   516  005060*--< No.12 >                                                      
   517  005070     MOVE  入力２−手形種類           TO  Ｄ６４２−手形種類.     
   518  005080*--< No.13 >                                                      
   519  005090     MOVE  入力２−期日基準日         TO  Ｄ６４２−期日基準日.   
   520  005100*--< No.14 >                                                      
   521  005110     MOVE  入力２−期日サイクル       TO  Ｄ６４２−期日サイクル. 
   522  005120*--< No.15 >                                                      
   523  005130     MOVE  入力２−束合計金額         TO  Ｄ６４２−束合計金額.   
   524  005140*--< No.16 >                                                      
   525  005150     MOVE  入力２−手形枚数           TO  Ｄ６４２−手形枚数.     
   526  005160*--< No.17 >                                                      
   527  005170     MOVE  入力２−取立依頼銀行コード                             
   528  005180                                     TO  Ｄ６４２−取立銀行コード.
   529  005190*--< No.18 >                                                      
   530  005200     MOVE  入力２−支払人コード      TO  Ｄ６４２−支払銀行コード.
   531  005210*--< No.19 >                                                      
   532  005220     MOVE  入力１−契約ＮＯ１         TO  Ｄ６４２−契約番号１.   
   533  005230*--< No.20 >                                                      
   534  005240     MOVE  入力１−契約ＮＯ２         TO  Ｄ６４２−契約番号２.   
   535  005250*--< No.21 >                                                      
   536  005260     MOVE  入力１−契約ＮＯ３         TO  Ｄ６４２−契約番号３.   
   537  005270*--< No.22 >                                                      
   538  005280     MOVE  入力１−契約ＮＯ４         TO  Ｄ６４２−契約番号４.   
   539  005290*--< No.23 >                                                      
   540  005300     MOVE  入力１−契約ＮＯ５         TO  Ｄ６４２−契約番号５.   
   541  005310*--< No.24 >                                                      
   542  005320     MOVE  入力１−契約ＮＯ６         TO  Ｄ６４２−契約番号６.   
   543  005330*--< No.25 >                                                      
   544  005340     MOVE  入力１−契約ＮＯ７         TO  Ｄ６４２−契約番号７.   
   545  005350*--< No.26 >                                                      
   546  005360     MOVE  入力１−契約ＮＯ８         TO  Ｄ６４２−契約番号８.   
   547  005370*--< No.27 >                                                      
   548  005380     MOVE  入力１−契約ＮＯ９         TO  Ｄ６４２−契約番号９.   
   549  005390*--< No.28 >                                                      
   550  005400     MOVE  入力１−契約ＮＯ１０       TO  Ｄ６４２−契約番号１０. 
   551  005410*--< No.29 >                                                      
   552  005420     MOVE  入力２−備考欄             TO  Ｄ６４２−備考欄.       
   553  005430*--< No.30 >                                                      
   554  005440     MOVE  ZERO                       TO  Ｄ６４２−手形内容種別. 
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   555  005450*--< No.31 >                                                      
   556  005460     MOVE  Ｗ−システム日付           TO  Ｄ６４２−登録年月日.   
   557  005470*--< No.32 >                                                      
   558  005480     MOVE  Ｗ−システム時刻           TO  Ｄ６４２−登録時間.     
   559  005490*--< No.33 >                                                      
   560  005500     MOVE  Ｗ−担当者                 TO  Ｄ６４２−登録担当者.   
   561  005510*--< No.34 >                                                      
   562  005520     MOVE  Ｗ−システム日付           TO  Ｄ６４２−更新年月日.   
   563  005530*--< No.35 >                                                      
   564  005540     MOVE  Ｗ−システム時刻           TO  Ｄ６４２−更新時間.     
   565  005550*--< No.36 >                                                      
   566  005560     MOVE  Ｗ−担当者                 TO  Ｄ６４２−更新者.       
   567  005570*--< No.37 >                                                      
   568  005580     MOVE  Ｗ−担当者              TO  Ｄ６４２−入力担当者コード.
   569  005590*--< No.38 >                                                      
   570  005600     MOVE  ZERO                       TO  Ｄ６４２−売却代金区分. 
   571  005610*--< No.39 >                                                      
   572  005620*----------------------------------------------------------------*
   573  005640     EXEC  SQL                                                    
   574  005650        SELECT  新取引先コード                                    
   575  005660               ,枝番                                              
   576  005670          INTO :ＩＫＯ００１−新取引先コード                      
   577  005680              ,:ＩＫＯ００１−枝番                                
   578  005690          FROM  IKOTBL001                                         
   579  005700         WHERE  取引先コード  =  :ＷＳ−支払人コード              
   580  005710           AND  目的ＣＤ      =  :ＷＳ−目的ＣＤ                  
   581  005720     END-EXEC.                                                    
   582  005730*                                                                 
   583  005740     EVALUATE  SQLCODE                                            
   584  005750        WHEN   定数−ＳＱＬＯＫ                                   
   585  005760*--<       正常 >                                                 
   586  005770           CONTINUE                                               
   587  005780        WHEN   OTHER                                              
   588  005790*--<       項目抽出失敗 >                                         
   589  005800           MOVE      -9               TO  Ｗ−エラーコード        
   590  005810           PERFORM   エラー判定処理                               
   591  005820     END-EVALUATE.                                                
   592  005830*----------------------------------------------------------------*
   593  005840     MOVE  ＩＫＯ００１−新取引先コード                           
   594  005850                                 TO  Ｄ６４２−振出人取引先コード.
   595  005860*--< No.40 >                                                      
   596  005870     MOVE  ＩＫＯ００１−枝番    TO  Ｄ６４２−振出人契約先コード.
   597  005880*--< No.41 >                                                      
   598  005890     MOVE  入力２−名称漢字           TO  Ｄ６４２−振出人名称.   
   599  005900*--< No.42 >                                                      
   600  005910     MOVE  入力２−名称カナ          TO  Ｄ６４２−振出人名称カナ.
   601  005920 受取手形編集処理−ＥＸＩＴ.                                      
   602  005930     EXIT.                                                        
   603  005940*----------------------------------------------------------------*
   604  005950 受取手形展開編集処理                 SECTION.                    
   605  005960 受取手形展開編集処理−ＳＴＡＲＴ.                                
   606  005970*----------------------------------------------------------------*
   607  005980*       初期化処理                                               *
   608  005990*----------------------------------------------------------------*
   609  006000        MOVE  SPACE                   TO  受取手形展開.           
   610  006010        INITIALIZE                        受取手形展開.           
   611  006020*----------------------------------------------------------------*
   612  006030*       項目編集処理                                             *
   613  006040*----------------------------------------------------------------*
   614  006050*                                                                 
   615  006110*--< No.01 >                                                      
   616  006120     MOVE  入力１−契約ＮＯ           TO  Ｄ６４５−代表契約番号. 
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   617  006130*--< No.02 >                                                      
   618  006140     MOVE  入力２−束数               TO  Ｄ６４５−束数.         
   619  006150*--< No.03 >                                                      
   620  006160     IF    ( Ｗ−契約ＮＯ１ = Ｏ−契約ＮＯ１                      
   621  006170        AND  Ｎ−束数       = Ｏ−束数 )                          
   622  006180        COMPUTE      Ｗ−連番  =  Ｗ−連番 + 1                    
   623  006190     ELSE                                                         
   624  006200        MOVE    1                     TO  Ｗ−連番                
   625  006210     END-IF.                                                      
   626  006220     MOVE  Ｗ−連番                   TO  Ｄ６４５−連番.         
   627  006230*--< No.04 >                                                      
   628  006240     MOVE  入力２−手形ＮＯ           TO  Ｄ６４５−手形番号.     
   629  006250*--< No.05 >                                                      
   630  006260     MOVE  入力２−期日               TO  Ｄ６４５−期日.         
   631  006270*--< No.06 >                                                      
   632  006280     MOVE  入力２−金額               TO  Ｄ６４５−金額.         
   633  006290*--< No.07 >                                                      
   634  006300     MOVE  ＩＫＯ００１−新取引先コード                           
   635  006310                                 TO  Ｄ６４５−振出人取引先コード.
   636  006320*--< No.08 >                                                      
   637  006330     MOVE  ＩＫＯ００１−枝番    TO  Ｄ６４５−振出人契約先コード.
   638  006340*--< No.09 >                                                      
   639  006350     MOVE  入力２−名称漢字           TO  Ｄ６４５−振出人名称.   
   640  006360*--< No.10 >                                                      
   641  006370     MOVE  入力２−名称カナ          TO  Ｄ６４５−振出人名称カナ.
   642  006380*--< No.11 >                                                      
   643  006390     MOVE  Ｗ−システム日付           TO  Ｄ６４５−登録年月日.   
   644  006400*--< No.12 >                                                      
   645  006410     MOVE  Ｗ−システム時刻           TO  Ｄ６４５−登録時間.     
   646  006420*--< No.13 >                                                      
   647  006430     MOVE  Ｗ−担当者                 TO  Ｄ６４５−登録担当者.   
   648  006440*--< No.14 >                                                      
   649  006450     MOVE  Ｗ−システム日付           TO  Ｄ６４５−更新年月日.   
   650  006460*--< No.15 >                                                      
   651  006470     MOVE  Ｗ−システム時刻           TO  Ｄ６４５−更新時間.     
   652  006480*--< No.16 >                                                      
   653  006490     MOVE  Ｗ−担当者                 TO  Ｄ６４５−更新者.       
   654  006500*--< No.17 >                                                      
   655  006510     MOVE  Ｗ−担当者              TO  Ｄ６４５−入力担当者コード.
   656  006520*--< No.18 >                                                      
   657  006530     MOVE  入力２−手形区分           TO  Ｄ６４５−手形状態.     
   658  006540 受取手形編集処理−ＥＸＩＴ.                                      
   659  006550     EXIT.                                                        
   660  006560******************************************************************
   661  006570*    出力処理                                                    *
   662  006580******************************************************************
   663  006590 受取手形出力処理                     SECTION.                    
   664  006600 受取手形出力処理−ＳＴＡＲＴ.                                    
   665  006610*                                                                 
   666  006620     EXEC  SQL                                                    
   667  006630        INSERT  INTO  D642UTG_TBL                                 
   668  006640           ( 代表契約番号                                         
   669  006650            ,束数                                                 
   670  006660            ,取引先コード                                         
   671  006670            ,契約先コード                                         
   672  006680            ,契約先名称                                           
   673  006690            ,契約先名称カナ                                       
   674  006700            ,部店コード                                           
   675  006710            ,主契約区分                                           
   676  006720            ,手形状態                                             
   677  006730            ,取引日                                               
   678  006740            ,伝票発行日                                           
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   679  006750            ,手形種類                                             
   680  006760            ,期日基準日                                           
   681  006770            ,期日サイクル                                         
   682  006780            ,束合計金額                                           
   683  006790            ,手形枚数                                             
   684  006800            ,取立銀行コード                                       
   685  006810            ,支払銀行コード                                       
   686  006820            ,契約番号１                                           
   687  006830            ,契約番号２                                           
   688  006840            ,契約番号３                                           
   689  006850            ,契約番号４                                           
   690  006860            ,契約番号５                                           
   691  006870            ,契約番号６                                           
   692  006880            ,契約番号７                                           
   693  006890            ,契約番号８                                           
   694  006900            ,契約番号９                                           
   695  006910            ,契約番号１０                                         
   696  006920            ,備考欄                                               
   697  006930            ,手形内容種別                                         
   698  006940            ,登録年月日                                           
   699  006950            ,登録時間                                             
   700  006960            ,登録担当者                                           
   701  006970            ,更新年月日                                           
   702  006980            ,更新時間                                             
   703  006990            ,更新者                                               
   704  007000            ,入力担当者コード                                     
   705  007010            ,売却代金区分                                         
   706  007020            ,振出人取引先コード                                   
   707  007030            ,振出人契約先コード                                   
   708  007040            ,振出人名称                                           
   709  007050            ,振出人名称カナ)                                      
   710  007060        VALUES                                                    
   711  007070           ( :Ｄ６４２−代表契約番号                              
   712  007080            ,:Ｄ６４２−束数                                      
   713  007090            ,:Ｄ６４２−取引先コード                              
   714  007100            ,:Ｄ６４２−契約先コード                              
   715  007110            ,:Ｄ６４２−契約先名称                                
   716  007120            ,:Ｄ６４２−契約先名称カナ                            
   717  007130            ,:Ｄ６４２−部店コード                                
   718  007140            ,:Ｄ６４２−主契約区分                                
   719  007150            ,:Ｄ６４２−手形状態                                  
   720  007160            ,:Ｄ６４２−取引日                                    
   721  007170            ,:Ｄ６４２−伝票発行日                                
   722  007180            ,:Ｄ６４２−手形種類                                  
   723  007190            ,:Ｄ６４２−期日基準日                                
   724  007200            ,:Ｄ６４２−期日サイクル                              
   725  007210            ,:Ｄ６４２−束合計金額                                
   726  007220            ,:Ｄ６４２−手形枚数                                  
   727  007230            ,:Ｄ６４２−取立銀行コード                            
   728  007240            ,:Ｄ６４２−支払銀行コード                            
   729  007250            ,:Ｄ６４２−契約番号１                                
   730  007260            ,:Ｄ６４２−契約番号２                                
   731  007270            ,:Ｄ６４２−契約番号３                                
   732  007280            ,:Ｄ６４２−契約番号４                                
   733  007290            ,:Ｄ６４２−契約番号５                                
   734  007300            ,:Ｄ６４２−契約番号６                                
   735  007310            ,:Ｄ６４２−契約番号７                                
   736  007320            ,:Ｄ６４２−契約番号８                                
   737  007330            ,:Ｄ６４２−契約番号９                                
   738  007340            ,:Ｄ６４２−契約番号１０                              
   739  007350            ,:Ｄ６４２−備考欄                                    
   740  007360            ,:Ｄ６４２−手形内容種別                              
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   741  007370            ,:Ｄ６４２−登録年月日                                
   742  007380            ,:Ｄ６４２−登録時間                                  
   743  007390            ,:Ｄ６４２−登録担当者                                
   744  007400            ,:Ｄ６４２−更新年月日                                
   745  007410            ,:Ｄ６４２−更新時間                                  
   746  007420            ,:Ｄ６４２−更新者                                    
   747  007430            ,:Ｄ６４２−入力担当者コード                          
   748  007440            ,:Ｄ６４２−売却代金区分                              
   749  007450            ,:Ｄ６４２−振出人取引先コード                        
   750  007460            ,:Ｄ６４２−振出人契約先コード                        
   751  007470            ,:Ｄ６４２−振出人名称                                
   752  007480            ,:Ｄ６４２−振出人名称カナ)                           
   753  007490     END-EXEC.                                                    
   754  007500*                                                                 
   755  007510     EVALUATE  SQLCODE                                            
   756  007520        WHEN   定数−ＳＱＬＯＫ                                   
   757  007530*--<       追加成功 >                                             
   758  007540           COMPUTE  Ｗ−出力−件数１  =  Ｗ−出力−件数１  +  1   
   759  007550        WHEN   OTHER                                              
   760  007560*--<       追加処理エラー >                                       
   761  007570           MOVE     -5                TO  Ｗ−エラーコード        
   762  007580           PERFORM  エラー判定処理                                
   763  007590     END-EVALUATE.                                                
   764  007600*                                                                 
   765  007610 受取手形出力処理−ＥＸＩＴ.                                      
   766  007620     EXIT.                                                        
   767  007630*----------------------------------------------------------------*
   768  007640 受取手形展開出力処理                 SECTION.                    
   769  007650 受取手形展開出力処理−ＳＴＡＲＴ.                                
   770  007660*                                                                 
   771  007670     EXEC  SQL                                                    
   772  007680        INSERT  INTO  D645UTT_TBL                                 
   773  007690           ( 代表契約番号                                         
   774  007700            ,束数                                                 
   775  007710            ,連番                                                 
   776  007720            ,手形番号                                             
   777  007730            ,期日                                                 
   778  007740            ,金額                                                 
   779  007750            ,振出人取引先コード                                   
   780  007760            ,振出人契約先コード                                   
   781  007770            ,振出人名称                                           
   782  007780            ,振出人名称カナ                                       
   783  007790            ,登録年月日                                           
   784  007800            ,登録時間                                             
   785  007810            ,登録担当者                                           
   786  007820            ,更新年月日                                           
   787  007830            ,更新時間                                             
   788  007840            ,更新者                                               
   789  007850            ,入力担当者コード                                     
   790  007860            ,手形状態)                                            
   791  007870        VALUES                                                    
   792  007880           ( :Ｄ６４５−代表契約番号                              
   793  007890            ,:Ｄ６４５−束数                                      
   794  007900            ,:Ｄ６４５−連番                                      
   795  007910            ,:Ｄ６４５−手形番号                                  
   796  007920            ,:Ｄ６４５−期日                                      
   797  007930            ,:Ｄ６４５−金額                                      
   798  007940            ,:Ｄ６４５−振出人取引先コード                        
   799  007950            ,:Ｄ６４５−振出人契約先コード                        
   800  007960            ,:Ｄ６４５−振出人名称                                
   801  007970            ,:Ｄ６４５−振出人名称カナ                            
   802  007980            ,:Ｄ６４５−登録年月日                                
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   803  007990            ,:Ｄ６４５−登録時間                                  
   804  008000            ,:Ｄ６４５−登録担当者                                
   805  008010            ,:Ｄ６４５−更新年月日                                
   806  008020            ,:Ｄ６４５−更新時間                                  
   807  008030            ,:Ｄ６４５−更新者                                    
   808  008040            ,:Ｄ６４５−入力担当者コード                          
   809  008050            ,:Ｄ６４５−手形状態)                                 
   810  008060     END-EXEC.                                                    
   811  008070*                                                                 
   812  008080     EVALUATE  SQLCODE                                            
   813  008090        WHEN   定数−ＳＱＬＯＫ                                   
   814  008100*--<       追加成功 >                                             
   815  008110           COMPUTE  Ｗ−出力−件数２  =  Ｗ−出力−件数２  +  1   
   816  008120        WHEN   OTHER                                              
   817  008130*--<       追加処理エラー >                                       
   818  008140           MOVE     -6                TO  Ｗ−エラーコード        
   819  008150           PERFORM  エラー判定処理                                
   820  008160     END-EVALUATE.                                                
   821  008170 受取手形展開出力処理−ＥＸＩＴ.                                  
   822  008180     EXIT.                                                        
   823  008190******************************************************************
   824  008200*    終了処理                                                    *
   825  008210******************************************************************
   826  008220 終了処理                             SECTION.                    
   827  008230 終了処理−ＳＴＡＲＴ.                                            
   828  008240*                                                                 
   829  008250     PERFORM  ファイルクローズ処理.                               
   830  008260*                                                                 
   831  008270     PERFORM  ＤＢコミット処理.                                   
   832  008280*                                                                 
   833  008290     PERFORM  終了メッセージ出力.                                 
   834  008300*                                                                 
   835  008310*--< プログラム正常終了 >                                         
   836  008320     MOVE  定数−正常状態             TO  PROGRAM-STATUS.         
   837  008330*                                                                 
   838  008340 終了処理−ＥＸＩＴ.                                              
   839  008350     EXIT.                                                        
   840  008360******************************************************************
   841  008370*    ファイルクローズ処理                                        *
   842  008380******************************************************************
   843  008390 ファイルクローズ処理                 SECTION.                    
   844  008400 ファイルクローズ処理−ＳＴＡＲＴ.                                
   845  008410*                                                                 
   846  008420     CLOSE  入力ファイル１.                                       
   847  008430     CLOSE  入力ファイル２.                                       
   848  008440*                                                                 
   849  008450 ファイルクローズ処理−ＥＸＩＴ.                                  
   850  008460     EXIT.                                                        
   851  008470******************************************************************
   852  008480*    終了メッセージ出力                                          *
   853  008490******************************************************************
   854  008500 終了メッセージ出力                   SECTION.                    
   855  008510 終了メッセージ出力−ＳＴＡＲＴ.                                  
   856  008520*                                                                 
   857  008530*----------------------------------------------------------------*
   858  008540*    件数メッセージ出力処理                                      *
   859  008550*----------------------------------------------------------------*
   860  008560     INITIALIZE                       IF-CHOCO001.                
   861  008570     MOVE  "3"                        TO  共通−イベント種別.     
   862  008580     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
   863  008590     MOVE  "0"                        TO  共通−復帰コード.       
   864  008600     MOVE  "D411STK"                  TO  共通−処理テーブルＩＤ. 
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   865  008610     MOVE  "COUNT"                    TO  共通−処理識別.         
   866  008620     MOVE  Ｗ−入力−件数１           TO  共通−データ内容.       
   867  008630     MOVE  "手形基本読込件数"         TO  共通−その他メッセージ. 
   868  008640     CALL  CLOCO001                USING  IF-CHOCO001.            
   869  008650*                                                                 
   870  008660     INITIALIZE                       IF-CHOCO001.                
   871  008670     MOVE  "3"                        TO  共通−イベント種別.     
   872  008680     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
   873  008690     MOVE  "0"                        TO  共通−復帰コード.       
   874  008700     MOVE  "D411STK"                  TO  共通−処理テーブルＩＤ. 
   875  008710     MOVE  "COUNT"                    TO  共通−処理識別.         
   876  008720     MOVE  Ｗ−入力−件数２           TO  共通−データ内容.       
   877  008730     MOVE  "受取手形読込件数"         TO  共通−その他メッセージ. 
   878  008740     CALL  CLOCO001                USING  IF-CHOCO001.            
   879  008750*                                                                 
   880  008760     INITIALIZE                       IF-CHOCO001.                
   881  008770     MOVE  "3"                        TO  共通−イベント種別.     
   882  008780     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
   883  008790     MOVE  "0"                        TO  共通−復帰コード.       
   884  008800     MOVE  "D34HNS"                   TO  共通−処理テーブルＩＤ. 
   885  008810     MOVE  "COUNT"                    TO  共通−処理識別.         
   886  008820     MOVE  Ｗ−出力−件数１           TO  共通−データ内容.       
   887  008830     MOVE  "受取手形出力件数"         TO  共通−その他メッセージ. 
   888  008840     CALL  CLOCO001                USING  IF-CHOCO001.            
   889  008850*                                                                 
   890  008860     INITIALIZE                       IF-CHOCO001.                
   891  008870     MOVE  "3"                        TO  共通−イベント種別.     
   892  008880     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
   893  008890     MOVE  "0"                        TO  共通−復帰コード.       
   894  008900     MOVE  "D34HNS"                   TO  共通−処理テーブルＩＤ. 
   895  008910     MOVE  "COUNT"                    TO  共通−処理識別.         
   896  008920     MOVE  Ｗ−出力−件数２           TO  共通−データ内容.       
   897  008930     MOVE  "受取手形展開出力件数"     TO  共通−その他メッセージ. 
   898  008950     CALL  CLOCO001                USING  IF-CHOCO001.            
   899  008960*                                                                 
   900  008970*----------------------------------------------------------------*
   901  008980*    終了メッセージ出力                                          *
   902  008990*----------------------------------------------------------------*
   903  009000     INITIALIZE                       IF-CHOCO001.                
   904  009010     MOVE  "3"                        TO  共通−イベント種別.     
   905  009020     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
   906  009030     MOVE  "0"                        TO  共通−復帰コード.       
   907  009040     MOVE  "END"                      TO  共通−処理識別.         
   908  009050     MOVE  定数−プログラム名         TO  共通−その他メッセージ. 
   909  009060     CALL  CLOCO001                USING  IF-CHOCO001.            
   910  009070*                                                                 
   911  009080 終了メッセージ出力−ＥＸＩＴ.                                    
   912  009090     EXIT.                                                        
   913  009100******************************************************************
   914  009110*    ＤＢコミット処理                                            *
   915  009120******************************************************************
   916  009130 ＤＢコミット処理                     SECTION.                    
   917  009140 ＤＢコミット処理−ＳＴＡＲＴ.                                    
   918  009150*                                                                 
   919  009160     EXEC  SQL                                                    
   920  009170        COMMIT  WORK  RELEASE                                     
   921  009180     END-EXEC.                                                    
   922  009190*                                                                 
   923  009200     INITIALIZE                       IF-CHOCO001.                
   924  009210     MOVE  "3"                        TO  共通−イベント種別.     
   925  009220     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
   926  009230     MOVE  "0"                        TO  共通−復帰コード.       
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   927  009240     MOVE  "COMMIT"                   TO  共通−処理識別.         
   928  009250     MOVE  "コミット実施"             TO  共通−その他メッセージ. 
   929  009260     CALL  CLOCO001                USING  IF-CHOCO001.            
   930  009270*                                                                 
   931  009280 ＤＢコミット処理−ＥＸＩＴ.                                      
   932  009290     EXIT.                                                        
   933  009300******************************************************************
   934  009310*    ＤＢロールバック処理                                        *
   935  009320******************************************************************
   936  009330 ＤＢロールバック処理                 SECTION.                    
   937  009340 ＤＢロールバック処理−ＳＴＡＲＴ.                                
   938  009350*                                                                 
   939  009360     EXEC  SQL                                                    
   940  009370        ROLLBACK WORK  RELEASE                                    
   941  009380     END-EXEC.                                                    
   942  009390*                                                                 
   943  009400     INITIALIZE                       IF-CHOCO001.                
   944  009410     MOVE  "1"                        TO  共通−イベント種別.     
   945  009420     MOVE  定数−プログラムＩＤ       TO  共通−ソースＩＤ.       
   946  009430     MOVE  "9"                        TO  共通−復帰コード.       
   947  009440     MOVE  "ROLLBACK"                 TO  共通−処理識別.         
   948  009450     MOVE  "ロールバック実施"         TO  共通−その他メッセージ. 
   949  009460     CALL  CLOCO001                USING  IF-CHOCO001.            
   950  009470*                                                                 
   951  009480 ＤＢロールバック処理−ＥＸＩＴ.                                  
   952  009490     EXIT.                                                        
   953  009500******************************************************************
   954  009510*    エラー処理                                                  *
   955  009520******************************************************************
   956  009530 エラー判定処理                       SECTION.                    
   957  009540 エラー判定処理−ＳＴＡＲＴ.                                      
   958  009550*                                                                 
   959  009560     MOVE  "Y"                        TO Ｗ−異常終了−フラグ.    
   960  009570     INITIALIZE                           IF-CHOCO001.            
   961  009580*                                                                 
   962  009590     EVALUATE  Ｗ−エラーコード                                   
   963  009600        WHEN  -1                                                  
   964  009610*--<       手形基本ファイルオープンエラー >                       
   965  009620           MOVE  "1"                  TO  共通−イベント種別      
   966  009630           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
   967  009640           MOVE  "9"                  TO  共通−復帰コード        
   968  009650           MOVE  "FFUIS630"           TO  共通−処理テーブルＩＤ  
   969  009660           MOVE  "OPEN"               TO  共通−処理識別          
   970  009670           MOVE  Ｗ−状態             TO  共通−データ内容        
   971  009680           MOVE  "手形基本ファイルオープンエラー "                
   972  009690                                      TO  共通−その他メッセージ  
   973  009700           CALL  CLOCO001          USING  IF-CHOCO001             
   974  009710*                                                                 
   975  009720        WHEN  -2                                                  
   976  009730*--<       受取手形ファイルオープンエラー >                       
   977  009740           MOVE  "1"                  TO  共通−イベント種別      
   978  009750           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
   979  009760           MOVE  "9"                  TO  共通−復帰コード        
   980  009770           MOVE  "FFUIS631"           TO  共通−処理テーブルＩＤ  
   981  009780           MOVE  "OPEN"               TO  共通−処理識別          
   982  009790           MOVE  Ｗ−状態             TO  共通−データ内容        
   983  009800           MOVE  "受取手形ファイルオープンエラー "                
   984  009810                                      TO  共通−その他メッセージ  
   985  009820           CALL  CLOCO001          USING  IF-CHOCO001             
   986  009830*                                                                 
   987  009840        WHEN  -3                                                  
   988  009850*--<       手形基本ファイル読込エラー >                           
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   989  009860           MOVE  "1"                  TO  共通−イベント種別      
   990  009870           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
   991  009880           MOVE  "9"                  TO  共通−復帰コード        
   992  009890           MOVE  "FFUIS630"           TO  共通−処理テーブルＩＤ  
   993  009900           MOVE  "READ"               TO  共通−処理識別          
   994  009910           MOVE  Ｗ−状態             TO  共通−データ内容        
   995  009920           MOVE  "手形基本ファイル読込エラー "                    
   996  009930                                      TO  共通−その他メッセージ  
   997  009940           CALL  CLOCO001          USING  IF-CHOCO001             
   998  009950*                                                                 
   999  009960        WHEN  -4                                                  
  1000  009970*--<       受取手形ファイル読込エラー >                           
  1001  009980           MOVE  "1"                  TO  共通−イベント種別      
  1002  009990           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1003  010000           MOVE  "9"                  TO  共通−復帰コード        
  1004  010010           MOVE  "FFUIS631"           TO  共通−処理テーブルＩＤ  
  1005  010020           MOVE  "READ"               TO  共通−処理識別          
  1006  010030           MOVE  Ｗ−状態             TO  共通−データ内容        
  1007  010040           MOVE  "受取手形ファイル読込エラー "                    
  1008  010050                                      TO  共通−その他メッセージ  
  1009  010060           CALL  CLOCO001          USING  IF-CHOCO001             
  1010  010070*                                                                 
  1011  010080        WHEN  -5                                                  
  1012  010090*--<       受取手形テーブル追加失敗 >                             
  1013  010100           MOVE  "1"                  TO  共通−イベント種別      
  1014  010110           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1015  010120           MOVE  "9"                  TO  共通−復帰コード        
  1016  010130           MOVE  "D642UTG"            TO  共通−処理テーブルＩＤ  
  1017  010140           MOVE  "SELECT"             TO  共通−処理識別          
  1018  010150           MOVE  SQLCODE              TO  共通−データ内容        
  1019  010160           MOVE  SQLERRMC             TO  共通−その他メッセージ  
  1020  010170           CALL  CLOCO001          USING  IF-CHOCO001             
  1021  010180*                                                                 
  1022  010190        WHEN  -6                                                  
  1023  010200*--<       受取手形展開テーブル追加失敗 >                         
  1024  010210           MOVE  "1"                  TO  共通−イベント種別      
  1025  010220           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1026  010230           MOVE  "9"                  TO  共通−復帰コード        
  1027  010240           MOVE  "D645UTT"            TO  共通−処理テーブルＩＤ  
  1028  010250           MOVE  "SELECT"             TO  共通−処理識別          
  1029  010260           MOVE  SQLCODE              TO  共通−データ内容        
  1030  010270           MOVE  SQLERRMC             TO  共通−その他メッセージ  
  1031  010280           CALL  CLOCO001          USING  IF-CHOCO001             
  1032  010290*                                                                 
  1033  010291        WHEN  -7                                                  
  1034  010292*--<       項目抽出失敗 >                                         
  1035  010293           MOVE  "2"                  TO  共通−イベント種別      
  1036  010294           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1037  010295           MOVE  "9"                  TO  共通−復帰コード        
  1038  010296           MOVE  "IKOTL001"           TO  共通−処理テーブルＩＤ  
  1039  010297           MOVE  "SELECT"             TO  共通−処理識別          
  1040  010298           MOVE  SQLCODE              TO  共通−データ内容        
  1041  010299           MOVE  SQLERRMC             TO  共通−その他メッセージ  
  1042  010300           CALL  CLOCO001          USING  IF-CHOCO001             
  1043  010301           MOVE  "N"                  TO Ｗ−異常終了−フラグ     
  1044  010302*                                                                 
  1045  010303        WHEN  -8                                                  
  1046  010304*--<       項目抽出失敗 >                                         
  1047  010305           MOVE  "2"                  TO  共通−イベント種別      
  1048  010306           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1049  010307           MOVE  "9"                  TO  共通−復帰コード        
  1050  010308           MOVE  "IKOTL002"           TO  共通−処理テーブルＩＤ  
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  1051  010309           MOVE  "SELECT"             TO  共通−処理識別          
  1052  010310           MOVE  SQLCODE              TO  共通−データ内容        
  1053  010311           MOVE  SQLERRMC             TO  共通−その他メッセージ  
  1054  010312           CALL  CLOCO001          USING  IF-CHOCO001             
  1055  010313           MOVE  "N"                  TO Ｗ−異常終了−フラグ     
  1056  010314*                                                                 
  1057  010315        WHEN  -9                                                  
  1058  010316*--<       項目抽出失敗 >                                         
  1059  010317           MOVE  "2"                  TO  共通−イベント種別      
  1060  010318           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1061  010319           MOVE  "9"                  TO  共通−復帰コード        
  1062  010320           MOVE  "IKOTL001"           TO  共通−処理テーブルＩＤ  
  1063  010321           MOVE  "SELECT"             TO  共通−処理識別          
  1064  010322           MOVE  SQLCODE              TO  共通−データ内容        
  1065  010323           MOVE  SQLERRMC             TO  共通−その他メッセージ  
  1066  010324           CALL  CLOCO001          USING  IF-CHOCO001             
  1067  010325           MOVE  "N"                  TO Ｗ−異常終了−フラグ     
  1068  010326*                                                                 
  1069  010327        WHEN  -10                                                 
  1070  010328*--<       ＯＲＡＣＬＥ接続失敗 >                                 
  1071  010329           MOVE  "1"                  TO  共通−イベント種別      
  1072  010330           MOVE  定数−プログラムＩＤ TO  共通−ソースＩＤ        
  1073  010340           MOVE  "9"                  TO  共通−復帰コード        
  1074  010350           MOVE  "CONNECT"            TO  共通−処理識別          
  1075  010360           MOVE  SQLCODE              TO  共通−データ内容        
  1076  010370           MOVE  SQLERRMC             TO  共通−その他メッセージ  
  1077  010380           CALL  CLOCO001          USING  IF-CHOCO001             
  1078  010750*                                                                 
  1079  010760        WHEN  OTHER                                               
  1080  010770           MOVE  "N"                  TO Ｗ−異常終了−フラグ     
  1081  010780     END-EVALUATE.                                                
  1082  010790*                                                                 
  1083  010800*                                                                 
  1084  010810     IF  Ｗ−異常終了−フラグ  =  "Y"                             
  1085  010820        PERFORM  ＤＢロールバック処理                             
  1086  010830*                                                                 
  1087  010840        PERFORM  終了メッセージ出力                               
  1088  010850*                                                                 
  1089  010860*--<    プログラム異常終了のリターンコード >                      
  1090  010870        MOVE  定数−異常状態          TO  PROGRAM-STATUS          
  1091  010880*                                                                 
  1092  010890        EXIT  PROGRAM                                             
  1093  010900     END-IF.                                                      
  1094  010910*                                                                 
  1095  010920 エラー判定処理−ＥＸＩＴ.                                        
  1096  010930     EXIT.                                                        
  1097  010940******************************************************************
  1098  010950*                  END OF PROGRAM                                *
  1099  010960******************************************************************
  1100  010970
ファイル: COBIS630.PCOをクローズ
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


ホスト変数
--------------

01  DB-STRING                                           Charf(20)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      3
  COBIS630.PCO    258

01  PASSWD                                              Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      5
  COBIS630.PCO    253    257

01  SQLSTATE                                            Charf(5)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      2
  COBIS630.PCO    252    256    457    489    573    666    771    919    939

01  USERNAME                                            Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      4
  COBIS630.PCO    253    257

03  Ｄ６４２−期日サイクル OF 受取手形                  Decimal(2,0)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     22
  COBIS630.PCO    724

03  Ｄ６４２−期日基準日 OF 受取手形                    Charf(8)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     21
  COBIS630.PCO    723

03  Ｄ６４２−契約先コード OF 受取手形                  Charf(5)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     10
  COBIS630.PCO    714

03  Ｄ６４２−契約先名称 OF 受取手形                    Charf(40)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     12
  COBIS630.PCO    715

03  Ｄ６４２−契約先名称カナ OF 受取手形                Charf(40)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     13
  COBIS630.PCO    716

03  Ｄ６４２−契約番号１ OF 受取手形                    Charf(10)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     30
  COBIS630.PCO    729

03  Ｄ６４２−契約番号１０ OF 受取手形                  Charf(10)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     39
  COBIS630.PCO    738

03  Ｄ６４２−契約番号２ OF 受取手形                    Charf(10)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     31
  COBIS630.PCO    730

03  Ｄ６４２−契約番号３ OF 受取手形                    Charf(10)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     32
  COBIS630.PCO    731

03  Ｄ６４２−契約番号４ OF 受取手形                    Charf(10)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     33
  COBIS630.PCO    732

03  Ｄ６４２−契約番号５ OF 受取手形                    Charf(10)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     34
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  COBIS630.PCO    733

03  Ｄ６４２−契約番号６ OF 受取手形                    Charf(10)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     35
  COBIS630.PCO    734

03  Ｄ６４２−契約番号７ OF 受取手形                    Charf(10)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     36
  COBIS630.PCO    735

03  Ｄ６４２−契約番号８ OF 受取手形                    Charf(10)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     37
  COBIS630.PCO    736

03  Ｄ６４２−契約番号９ OF 受取手形                    Charf(10)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     38
  COBIS630.PCO    737

03  Ｄ６４２−更新時間 OF 受取手形                      Charf(8)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     48
  COBIS630.PCO    745

03  Ｄ６４２−更新者 OF 受取手形                        Charf(8)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     49
  COBIS630.PCO    746

03  Ｄ６４２−更新年月日 OF 受取手形                    Charf(8)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     47
  COBIS630.PCO    744

03  Ｄ６４２−支払銀行コード OF 受取手形                Charf(7)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     28
  COBIS630.PCO    728

03  Ｄ６４２−主契約区分 OF 受取手形                    Charf(1)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     16
  COBIS630.PCO    718

03  Ｄ６４２−取引先コード OF 受取手形                  Charf(9)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL      8
  COBIS630.PCO    713

03  Ｄ６４２−取引日 OF 受取手形                        Charf(8)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     18
  COBIS630.PCO    720

03  Ｄ６４２−取立銀行コード OF 受取手形                Charf(7)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     26
  COBIS630.PCO    727

03  Ｄ６４２−手形種類 OF 受取手形                      Charf(1)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     20
  COBIS630.PCO    722

03  Ｄ６４２−手形状態 OF 受取手形                      Charf(1)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     17
  COBIS630.PCO    719

03  Ｄ６４２−手形内容種別 OF 受取手形                  Charf(1)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     42
  COBIS630.PCO    740

Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

03  Ｄ６４２−手形枚数 OF 受取手形                      Decimal(4,0)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     25
  COBIS630.PCO    726

03  Ｄ６４２−振出人契約先コード OF 受取手形            Charf(5)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     56
  COBIS630.PCO    750

03  Ｄ６４２−振出人取引先コード OF 受取手形            Charf(9)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     54
  COBIS630.PCO    749

03  Ｄ６４２−振出人名称 OF 受取手形                    Charf(40)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     58
  COBIS630.PCO    751

03  Ｄ６４２−振出人名称カナ OF 受取手形                Charf(40)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     59
  COBIS630.PCO    752

03  Ｄ６４２−束合計金額 OF 受取手形                    Decimal(13,0)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     24
  COBIS630.PCO    725

03  Ｄ６４２−束数 OF 受取手形                          Decimal(3,0)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL      7
  COBIS630.PCO    712

03  Ｄ６４２−代表契約番号 OF 受取手形                  Charf(10)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL      5
  COBIS630.PCO    711

03  Ｄ６４２−伝票発行日 OF 受取手形                    Charf(8)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     19
  COBIS630.PCO    721

03  Ｄ６４２−登録時間 OF 受取手形                      Charf(8)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     45
  COBIS630.PCO    742

03  Ｄ６４２−登録担当者 OF 受取手形                    Charf(8)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     46
  COBIS630.PCO    743

03  Ｄ６４２−登録年月日 OF 受取手形                    Charf(8)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     44
  COBIS630.PCO    741

03  Ｄ６４２−入力担当者コード OF 受取手形              Charf(8)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     50
  COBIS630.PCO    747

03  Ｄ６４２−売却代金区分 OF 受取手形                  Charf(1)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     52
  COBIS630.PCO    748

03  Ｄ６４２−備考欄 OF 受取手形                        Charf(40)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     41
  COBIS630.PCO    739

03  Ｄ６４２−部店コード OF 受取手形                    Charf(4)
  Z:\COB97\COPYLIB_DB\D642UTG.CBL     15
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  COBIS630.PCO    717

03  Ｄ６４５−期日 OF 受取手形展開                      Charf(8)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     10
  COBIS630.PCO    796

03  Ｄ６４５−金額 OF 受取手形展開                      Decimal(13,0)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     11
  COBIS630.PCO    797

03  Ｄ６４５−更新時間 OF 受取手形展開                  Charf(8)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     23
  COBIS630.PCO    806

03  Ｄ６４５−更新者 OF 受取手形展開                    Charf(8)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     24
  COBIS630.PCO    807

03  Ｄ６４５−更新年月日 OF 受取手形展開                Charf(8)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     22
  COBIS630.PCO    805

03  Ｄ６４５−手形状態 OF 受取手形展開                  Charf(1)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     27
  COBIS630.PCO    809

03  Ｄ６４５−手形番号 OF 受取手形展開                  Charf(10)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL      9
  COBIS630.PCO    795

03  Ｄ６４５−振出人契約先コード OF 受取手形            Charf(5)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     14
  COBIS630.PCO    799

03  Ｄ６４５−振出人取引先コード OF 受取手形            Charf(9)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     12
  COBIS630.PCO    798

03  Ｄ６４５−振出人名称 OF 受取手形展開                Charf(40)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     16
  COBIS630.PCO    800

03  Ｄ６４５−振出人名称カナ OF 受取手形展開            Charf(40)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     17
  COBIS630.PCO    801

03  Ｄ６４５−束数 OF 受取手形展開                      Decimal(3,0)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL      7
  COBIS630.PCO    793

03  Ｄ６４５−代表契約番号 OF 受取手形展開              Charf(10)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL      5
  COBIS630.PCO    792

03  Ｄ６４５−登録時間 OF 受取手形展開                  Charf(8)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     20
  COBIS630.PCO    803

03  Ｄ６４５−登録担当者 OF 受取手形展開                Charf(8)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     21
  COBIS630.PCO    804

Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

03  Ｄ６４５−登録年月日 OF 受取手形展開                Charf(8)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     19
  COBIS630.PCO    802

03  Ｄ６４５−入力担当者コード OF 受取手形展            Charf(8)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL     25
  COBIS630.PCO    808

03  Ｄ６４５−連番 OF 受取手形展開                      Decimal(3,0)
  Z:\COB97\COPYLIB_DB\D645UTT.CBL      8
  COBIS630.PCO    794

01  ＩＫＯ００１−枝番                                  Charf(3)
  Z:\COB97\COPYLIB_DB\IKOTBL001.CBL      7
  COBIS630.PCO    461    577

01  ＩＫＯ００１−新取引先コード                        Charf(7)
  Z:\COB97\COPYLIB_DB\IKOTBL001.CBL      6
  COBIS630.PCO    460    576

01  ＩＫＯ００２−主契約区分                            Charf(1)
  Z:\COB97\COPYLIB_DB\IKOTBL002.CBL     12
  COBIS630.PCO    491

01  ＷＳ−契約ＮＯ                                      Charf(9)
  COBIS630.PCO     74    493

01  ＷＳ−支払人コード                                  Charf(8)
  COBIS630.PCO     75    579

01  ＷＳ−取引先コード                                  Charf(8)
  COBIS630.PCO     72    463

01  ＷＳ−目的ＣＤ                                      Charf(1)
  COBIS630.PCO     73    464    580

Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.



                              プリコンパイラ・オプション
-------------------------------------------------------------------------------
オプション名   現在の設定値         設定先
-------------------------------------------------------------------------------
asacc             no                デフォルト                                  
assume_sqlcode    no                デフォルト                                  
auto_connect      no                デフォルト                                  
close_on_commit   yes               mode                                        
comp5             yes               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
config            default config    デフォルト                                  
date_format       local             デフォルト                                  
dbms              native            デフォルト                                  
declare_section   yes               mode                                        
define            *なし*            デフォルト                                  
dynamic           ansi              mode                                        
end_of_fetch      100               mode                                        
eol_padding       yes               デフォルト                                  
errors            yes               デフォルト                                  
fips              no                デフォルト                                  
format            ansi              デフォルト                                  
hold_cursor       no                デフォルト                                  
host              cobol             デフォルト                                  
iname             COBIS630.PCO      コマンドライン                              
include           Z:\COB97\COPYLIB  D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
                  Z:\COB97\COPYLIB_DD:\oracle\ora90\precomp\admin\pcbcfg.cfg    
                  *なし*            D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
ireclen           132               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
litdelim          quote             デフォルト                                  
lname             *なし*            デフォルト                                  
lreclen           132               デフォルト                                  
ltype             long              デフォルト                                  
maxliteral        160               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
maxopencursors    10                デフォルト                                  
mode              ANSI              D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
nested            yes               デフォルト                                  
nls_local         yes               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
oname             COBIS630.COB      コマンドライン                              
oraca             no                デフォルト                                  
oreclen           80                デフォルト                                  
pagelen           66                デフォルト                                  
picx              charf             デフォルト                                  
prefetch          1                 デフォルト                                  
release_cursor    no                デフォルト                                  
select_error      yes               デフォルト                                  
sqlcheck          FULL              D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
threads           no                デフォルト                                  
type_code         ansi              mode                                        
unsafe_null       no                デフォルト                                  
userid            liuzf/lzf@FIP     D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
varchar           no                デフォルト                                  
xref              yes               デフォルト                                  
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 09:11:48 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


統計表示
----------

リターン・コード: 0
重要性 Iでのメッセージ数: 0
重要性 Wでのメッセージ数: 0
重要性 Eでのメッセージ数: 0
重要性 Fでのメッセージ数: 0
入力ラインの数: 1217
宣言されたホスト変数の数: 88
カーソル名の数: 0
文名の数: 0
使用される最大メモリー(バイト): 210755
