Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

ファイル: COBIS351.PCOをオープン
     1  000010******************************************************************
     2  000020*         ＜海輝軟件(大連)＞                                     *
     3  000030*      1. プログラム名  : 債権採算移行処理                       *
     4  000040*                         <SUMMIT未検収抽出>                     *
     5  000050*      2. プログラムID  : COBIS351                               *
     6  000060*      3. 処理概要      : 契約基本をベースにして、               *
     7  000070*                         債権採算未検収データを抽出する。       *
     8  000080*      4. 作成者        : 周静                                   *
     9  000090*      5. 作成日        : 2005/4/2                               *
    10  000100******************************************************************
    11  000110*                                                                 
    12  000120******************************************************************
    13  000130*    ＩＤＥＮＴＩＦＩＣＡＴＩＯＮ     ＤＩＶＩＳＩＯＮ           *
    14  000140******************************************************************
    15  000150 IDENTIFICATION                       DIVISION.                   
    16  000160*                                                                 
    17  000170 PROGRAM-ID.                          COBIS351.                   
    18  000180******************************************************************
    19  000190*    ＥＮＶＩＲＯＮＭＥＮＴ           ＤＩＶＩＳＩＯＮ           *
    20  000200******************************************************************
    21  000210 ENVIRONMENT                          DIVISION.                   
    22  000220******************************************************************
    23  000230*    ＩＮＰＵＴ−ＯＵＴＰＵＴ      ＳＥＣＴＩＯＮ                *
    24  000240******************************************************************
    25  000250 INPUT-OUTPUT                         SECTION.                    
    26  000260*                                                                 
    27  000270 FILE-CONTROL.                                                    
    28  000280     SELECT    入力ファイル           ASSIGN    TO     U01        
    29  000290     FILE      STATUS     IS          Ｗ−状態                    
    30  000300     ORGANIZATION         IS          LINE      SEQUENTIAL.       
    31  000310*                                                                 
    32  000320     SELECT    出力ファイル１         ASSIGN    TO     U11        
    33  000330     FILE      STATUS     IS          Ｗ−状態                    
    34  000340     ORGANIZATION         IS          LINE      SEQUENTIAL.       
    35  000350*                                                                 
    36  000360     SELECT    出力ファイル２         ASSIGN    TO     U12        
    37  000370     FILE      STATUS     IS          Ｗ−状態                    
    38  000380     ORGANIZATION         IS          LINE      SEQUENTIAL.       
    39  000390*                                                                 
    40  000400******************************************************************
    41  000410*    ＤＡＴＡ                      ＤＩＶＩＳＩＯＮ              *
    42  000420******************************************************************
    43  000430 DATA                                 DIVISION.                   
    44  000440******************************************************************
    45  000450*    ＦＩＬＥ                      ＳＥＣＴＩＯＮ                *
    46  000460******************************************************************
    47  000470 FILE                                 SECTION.                    
    48  000480*----------------------------------------------------------------*
    49  000490*    入力ファイル                                                *
    50  000500*----------------------------------------------------------------*
    51  000510 FD  入力ファイル                                                 
    52  000520     LABEL     RECORD     IS          STANDARD                    
    53  000530     BLOCK     CONTAINS   0           RECORDS.                    
    54  000540*                                                                 
    55  000550 01  入力−レコード.                                              
    56  000560     COPY  CPBIS032  REPLACING  ==()==  BY  ==入力−==.           
    57  000570*                                                                 
    58  000580*----------------------------------------------------------------*
    59  000590*    出力ファイル                                                *
    60  000600*----------------------------------------------------------------*
    61  000610 FD  出力ファイル１                                               
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    62  000620     LABEL     RECORD     IS          STANDARD                    
    63  000630     BLOCK     CONTAINS   0           RECORDS.                    
    64  000640*                                                                 
    65  000650 01  出力１−レコード.                                            
    66  000660     COPY  CISUF351  REPLACING  ==()==  BY  ==出力１−==.         
    67  000670*                                                                 
    68  000680 FD  出力ファイル２                                               
    69  000690     LABEL     RECORD     IS          STANDARD                    
    70  000700     BLOCK     CONTAINS   0           RECORDS.                    
    71  000710*                                                                 
    72  000720 01  出力２−レコード.                                            
    73  000730     COPY  CISUF351  REPLACING  ==()==  BY  ==出力２−==.         
    74  000740*                                                                 
    75  000750******************************************************************
    76  000760*    ＷＯＲＫＩＮＧ−ＳＴＯＲＡＧＥ   ＳＥＣＴＩＯＮ             *
    77  000770******************************************************************
    78  000780 WORKING-STORAGE                      SECTION.                    
    79  000790*----------------------------------------------------------------*
    80  000800*    ホスト変数定義エリア                                        *
    81  000810*----------------------------------------------------------------*
    82  000820     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
    83  000830*--<NO.2>                                                         
    84  000840 01  ＷＳ−契約番号                   PIC X(09).                  
    85  000850 01  ＷＳ−再リースコード             PIC 9(01) VALUE ZERO.       
    86  000860 01  ＷＳ−勘定処理コード             PIC 9(02).                  
    87  000870*                                                                 
    88  000880*--< ＯＲＡＣＬＥ共通変数 >                                       
    89  000890     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
    90  000900*                                                                 
    91  000910*--< ＯＲＡＣＬＥ  ＳＱＬ実行情報 >                               
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをオープン
     1  000010*--＜ＳＱＬ共通変数＞
     2  000030   01  SQLSTATE                      PIC  X(005).
     3  000040   01  DB-STRING                     PIC  X(020).
     4  000050   01  USERNAME                      PIC  X(010).
     5  000060   01  PASSWD                        PIC  X(010).
     6  000070*
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをクローズ
    92  000920     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
    93  000930*                                                                 
    94  000940*--< 契約種類等変換テーブル >                                     
    95  000950     EXEC  SQL  INCLUDE  IKOTBL002.CBL         END-EXEC.          
    96  000960*                                                                 
ファイル: Z:\COB97\COPYLIB_DB\IKOTBL002.CBLをオープン
     1  000010************************************************
     2  000020* 契約種類等変換テーブル(IKOTBL002)
     3  000030************************************************
     4  000040 01  ＩＫＯ００２−契約ＮＯ PIC  X(009).
     5  000050 01  ＩＫＯ００２−再リースコード PIC S9(001) COMP-3.
     6  000060 01  ＩＫＯ００２−旧債権勘定処理コード PIC S9(002) COMP-3.
     7  000070 01  ＩＫＯ００２−旧債務勘定処理コード PIC S9(002) COMP-3.
     8  000080 01  ＩＫＯ００２−再リース回数 PIC S9(002) COMP-3.
     9  000090 01  ＩＫＯ００２−債権勘定処理コード PIC S9(002) COMP-3.
    10  000100 01  ＩＫＯ００２−債務勘定処理コード PIC S9(002) COMP-3.
    11  000110 01  ＩＫＯ００２−契約種類 PIC  X(003).
    12  000120 01  ＩＫＯ００２−主契約区分 PIC  X(001).
    13  000130 01  ＩＫＯ００２−回収手順 PIC  X(001).
ファイル: Z:\COB97\COPYLIB_DB\IKOTBL002.CBLをクローズ
    97  000970     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
    98  000980*                                                                 
    99  000990*----------------------------------------------------------------*
   100  001000*   作業領域定義                                                 *
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   101  001010*----------------------------------------------------------------*
   102  001020 01  ワークエリア.                                                
   103  001030*                                                                 
   104  001040*--< 件数エリア >                                                 
   105  001050     03  Ｗ−件数エリア.                                          
   106  001060         05  Ｗ−契約基本−件数       PIC  9(09).                 
   107  001070         05  Ｗ−持分以外−件数       PIC  9(09).                 
   108  001080         05  Ｗ−持分−件数           PIC  9(09).                 
   109  001090*                                                                 
   110  001100*--< ファイル状態 >                                               
   111  001110     03  Ｗ−状態エリア.                                          
   112  001120         05  Ｗ−状態                 PIC  X(02).                 
   113  001130*                                                                 
   114  001140*--< エラーコード >                                               
   115  001150     03  Ｗ−エラーコード             PIC S9(04).                 
   116  001160*                                                                 
   117  001170*--< フラグエリア >                                               
   118  001180     03  Ｗ−フラッグエリア.                                      
   119  001190         05  Ｗ−終了−フラグ         PIC  X(01).                 
   120  001200         05  Ｗ−異常終了−フラグ     PIC  X(01).                 
   121  001210*--<NO.4>                                                         
   122  001220     03  Ｗ−第１回リース料入金日１.                              
   123  001230         05 Ｗ−入金年                PIC 9(04).                  
   124  001240         05 Ｗ−入金月                PIC 9(02).                  
   125  001250     03  Ｗ−リース開始日１.                                      
   126  001260         05 Ｗ−開始年                PIC 9(04).                  
   127  001270         05 Ｗ−開始月                PIC 9(02).                  
   128  001280     03  Ｗ−回収サイト１             PIC 9(06).                  
   129  001290     03  Ｗ−回収サイト.                                          
   130  001300         05 Ｗ−回収サイト年          PIC 9(04).                  
   131  001310         05 Ｗ−回収サイト月          PIC 9(02).                  
   132  001320     03  Ｗ−第１回リース料入金日２   PIC 9(06).                  
   133  001330     03  Ｗ−リース開始日２           PIC 9(06).                  
   134  001340     03  Ｗ−回収サイト２             PIC 9(02).                  
   135  001350*--< 共通情報 >                                                   
   136  001360 01  Ｗ−共通情報.                                                
   137  001370     03  Ｗ−システム日付.                                        
   138  001380         05  Ｗ−世紀                 PIC  X(02) VALUE  "20".     
   139  001390         05  Ｗ−年月日               PIC  X(06).                 
   140  001400     03  Ｗ−システム時刻             PIC  X(08).                 
   141  001410     03  Ｗ−担当者                   PIC  X(08) VALUE "IKOPG   ".
   142  001420*----------------------------------------------------------------*
   143  001430*    サブルーチン名                                              *
   144  001440*----------------------------------------------------------------*
   145  001450 01  CALL-AREA.                                                   
   146  001460*--< 共通ログサブルーチン >                                       
   147  001470     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
   148  001480     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
   149  001490*                                                                 
   150  001500*----------------------------------------------------------------*
   151  001510*    ＣＯＰＹ領域                                                *
   152  001520*----------------------------------------------------------------*
   153  001530*--< 共通ログ用パラメータ >                                       
   154  001540 01  IF-CHOCO001.                                                 
   155  001550     COPY  CHOCO001  REPLACING  ==()==  BY  ==共１−==.           
   156  001560*                                                                 
   157  001570*----------------------------------------------------------------*
   158  001580*    ＩＮＩファイル読込サブルーチン用パラメタ領域                *
   159  001590*----------------------------------------------------------------*
   160  001600 01  PARA-AREA.                                                   
   161  001610     COPY CPBCO001.                                               
   162  001620******************************************************************
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   163  001630*    定数用データ定義エリア                                      *
   164  001640******************************************************************
   165  001650 CONSTANT                             SECTION.                    
   166  001660 01  定数領域.                                                    
   167  001670     03  定数−プログラムＩＤ         PIC  X(08) VALUE "COBIS351".
   168  001680     03  定数−プログラム名           PIC  X(80) VALUE            
   169  001690                             "債権採算移行処理<SUMMIT未検収抽出>".
   170  001700     03  定数−ＳＱＬＯＫ             PIC S9(04)  VALUE  ZERO.    
   171  001710     03  定数−ＳＱＬＥＮＤ           PIC S9(04)  VALUE  0100.    
   172  001720     03  定数−正常状態               PIC S9(04)  VALUE  ZERO.    
   173  001730     03  定数−異常状態               PIC S9(04)  VALUE  0009.    
   174  001740******************************************************************
   175  001750*    ＰＲＯＣＥＤＵＲＥ            ＤＩＶＩＳＩＯＮ              *
   176  001760******************************************************************
   177  001770 PROCEDURE                            DIVISION.                   
   178  001780*                                                                 
   179  001790     PERFORM  初期処理.                                           
   180  001800*                                                                 
   181  001810     PERFORM  主処理  UNTIL  Ｗ−終了−フラグ  =  "Y".            
   182  001820*                                                                 
   183  001830     PERFORM  終了処理.                                           
   184  001840*                                                                 
   185  001850     STOP     RUN.                                                
   186  001860*                                                                 
   187  001870******************************************************************
   188  001880*    初期処理                                                    *
   189  001890******************************************************************
   190  001900 初期処理                             SECTION.                    
   191  001910 初期処理−ＳＴＡＲＴ.                                            
   192  001920*                                                                 
   193  001930*----------------------------------------------------------------*
   194  001940*    開始メッセージ出力処理                                      *
   195  001950*----------------------------------------------------------------*
   196  001960     INITIALIZE                       IF-CHOCO001.                
   197  001970     MOVE  "3"                        TO  共１−イベント種別.     
   198  001980     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   199  001990     MOVE  "0"                        TO  共１−復帰コード.       
   200  002000     MOVE  "START"                    TO  共１−処理識別.         
   201  002010     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
   202  002020     CALL  CLOCO001                USING  IF-CHOCO001.            
   203  002030*                                                                 
   204  002040*----------------------------------------------------------------*
   205  002050*    作業領域の初期値設定                                        *
   206  002060*----------------------------------------------------------------*
   207  002070     MOVE  SPACE                      TO  ワークエリア.           
   208  002080     INITIALIZE                           ワークエリア.           
   209  002090*                                                                 
   210  002100*--< ＣＰＵ日付を取得 >                                           
   211  002110     ACCEPT  Ｗ−年月日               FROM  DATE.                 
   212  002120*                                                                 
   213  002130*--< ＣＰＵ時刻を取得 >                                           
   214  002140     ACCEPT  Ｗ−システム時刻         FROM  TIME.                 
   215  002150*                                                                 
   216  002160*--< ＯＲＡＣＬＥ接続 >                                           
   217  002170     PERFORM  ＯＲＡＣＬＥ接続.                                   
   218  002180*                                                                 
   219  002190*--< ファイルオープン >                                           
   220  002200     PERFORM  ファイルオープン.                                   
   221  002210*                                                                 
   222  002220*--< 契約基本ファイル読込処理（１件目） >                         
   223  002230     PERFORM  契約基本ファイル読込.                               
   224  002240*                                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   225  002250 初期処理−ＥＸＩＴ.                                              
   226  002260     EXIT.                                                        
   227  002270******************************************************************
   228  002280*    ＯＲＡＣＬＥ接続                                            *
   229  002290******************************************************************
   230  002300 ＯＲＡＣＬＥ接続                     SECTION.                    
   231  002310 ＯＲＡＣＬＥ接続−ＳＴＡＲＴ.                                    
   232  002320*                                                                 
   233  002330*--< ＤＢ接続用情報を取得処理 >                                   
   234  002340     CALL  COBCO001                USING  PARA-AREA.              
   235  002350*                                                                 
   236  002360     MOVE  PARA-DBSTRING              TO  DB-STRING.              
   237  002370     MOVE  PARA-USERNAME              TO  USERNAME.               
   238  002380     MOVE  PARA-PASSWORD              TO  PASSWD.                 
   239  002390*                                                                 
   240  002400*----------------------------------------------------------------*
   241  002410*    開始接続                                                    *
   242  002420*----------------------------------------------------------------*
   243  002430     IF    DB-STRING  =  SPACE                                    
   244  002440        EXEC SQL                                                  
   245  002450           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   246  002460        END-EXEC                                                  
   247  002470     ELSE                                                         
   248  002480        EXEC SQL                                                  
   249  002490           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   250  002500             USING  :DB-STRING                                    
   251  002510        END-EXEC                                                  
   252  002520     END-IF.                                                      
   253  002530*                                                                 
   254  002540*----------------------------------------------------------------*
   255  002550*    接続確認                                                    *
   256  002560*----------------------------------------------------------------*
   257  002570     EVALUATE  SQLCODE                                            
   258  002580        WHEN   定数−ＳＱＬＯＫ                                   
   259  002590           CONTINUE                                               
   260  002600        WHEN   OTHER                                              
   261  002610*--<       接続エラー >                                           
   262  002620           MOVE     -10               TO  Ｗ−エラーコード        
   263  002630           PERFORM  エラー処理                                    
   264  002640     END-EVALUATE.                                                
   265  002650*                                                                 
   266  002660 ＯＲＡＣＬＥ接続−ＥＸＩＴ.                                      
   267  002670     EXIT.                                                        
   268  002680******************************************************************
   269  002690*    ファイルオープン                                            *
   270  002700******************************************************************
   271  002710 ファイルオープン                     SECTION.                    
   272  002720 ファイルオープン−ＳＴＡＲＴ.                                    
   273  002730*                                                                 
   274  002740*----------------------------------------------------------------*
   275  002750*    契約基本ファイルのオープン                                  *
   276  002760*----------------------------------------------------------------*
   277  002770     OPEN  INPUT   入力ファイル.                                  
   278  002780*                                                                 
   279  002790*--< ファイルオープンの状態判定 >                                 
   280  002800     EVALUATE  Ｗ−状態                                           
   281  002810        WHEN  ZERO                                                
   282  002820           CONTINUE                                               
   283  002830        WHEN  OTHER                                               
   284  002840*--<       ファイルオープンエラー >                               
   285  002850           MOVE     -20               TO  Ｗ−エラーコード        
   286  002860           PERFORM  エラー処理                                    
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   287  002870     END-EVALUATE.                                                
   288  002880*                                                                 
   289  002890*----------------------------------------------------------------*
   290  002900*    未検収・協調幹事持分以外のオープン                          *
   291  002910*----------------------------------------------------------------*
   292  002920     OPEN  OUTPUT   出力ファイル１.                               
   293  002930*                                                                 
   294  002940*--< ファイルオープンの状態判定 >                                 
   295  002950     EVALUATE  Ｗ−状態                                           
   296  002960        WHEN  ZERO                                                
   297  002970           CONTINUE                                               
   298  002980        WHEN  OTHER                                               
   299  002990*--<       ファイルオープンエラー >                               
   300  003000           MOVE     -30               TO  Ｗ−エラーコード        
   301  003010           PERFORM  エラー処理                                    
   302  003020     END-EVALUATE.                                                
   303  003030*                                                                 
   304  003040*----------------------------------------------------------------*
   305  003050*    未検収・協調幹事持分のオープン                              *
   306  003060*----------------------------------------------------------------*
   307  003070     OPEN  OUTPUT   出力ファイル２                                
   308  003080*                                                                 
   309  003090*--< ファイルオープンの状態判定 >                                 
   310  003100     EVALUATE  Ｗ−状態                                           
   311  003110        WHEN  ZERO                                                
   312  003120           CONTINUE                                               
   313  003130        WHEN  OTHER                                               
   314  003140*--<       ファイルオープンエラー >                               
   315  003150           MOVE     -40                TO  Ｗ−エラーコード       
   316  003160           PERFORM  エラー処理                                    
   317  003170     END-EVALUATE.                                                
   318  003180*                                                                 
   319  003190 ファイルオープン−ＥＸＩＴ.                                      
   320  003200     EXIT.                                                        
   321  003210******************************************************************
   322  003220*    契約基本ファイル読込処理読込処理                            *
   323  003230******************************************************************
   324  003240 契約基本ファイル読込             SECTION.                        
   325  003250 契約基本ファイル読込−ＳＴＡＲＴ.                                
   326  003260*                                                                 
   327  003270     READ  入力ファイル                                           
   328  003280        AT END                                                    
   329  003290           MOVE  "Y"                  TO  Ｗ−終了−フラグ        
   330  003300        GO TO     契約基本ファイル読込−ＥＸＩＴ                  
   331  003310     END-READ.                                                    
   332  003320*                                                                 
   333  003330*--< 契約基本ファイル読込状態判定 >                               
   334  003340     EVALUATE  Ｗ−状態                                           
   335  003350        WHEN  ZERO                                                
   336  003360*--<       契約基本ファイル入力件数のカウント >                   
   337  003370           COMPUTE  Ｗ−契約基本−件数  =  Ｗ−契約基本−件数 + 1 
   338  003380        WHEN  OTHER                                               
   339  003390*--<       契約基本ファイル読込エラー >                           
   340  003400           MOVE     -50                TO  Ｗ−エラーコード       
   341  003410           PERFORM  エラー処理                                    
   342  003420     END-EVALUATE.                                                
   343  003430*                                                                 
   344  003440 契約基本ファイル読込−ＥＸＩＴ.                                  
   345  003450     EXIT.                                                        
   346  003460******************************************************************
   347  003470*    主処理                                               <2.0>  *
   348  003480******************************************************************
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   349  003490 主処理                               SECTION.                    
   350  003500 主処理−ＳＴＡＲＴ.                                              
   351  003510*                                                                 
   352  003520*--< ファイル出力判定処理  >                                      
   353  003530     IF  入力−債務協調区分   NOT = "2X"                          
   354  003540*                                                                 
   355  003550*--< 未検収・協調幹事持分以外編集、出力処理 >                        
   356  003560        PERFORM  協調幹事持分以外編集                             
   357  003570     ELSE                                                         
   358  003580*                                                                 
   359  003590*--< 未検収・協調幹事持分編集、出力処理 >                         
   360  003600       PERFORM  協調幹事持分編集                                  
   361  003610     END-IF.                                                      
   362  003620*                                                                 
   363  003630*--< 契約基本ファイル読込(２件目以降) >                           
   364  003640     PERFORM  契約基本ファイル読込.                               
   365  003650*                                                                 
   366  003660 主処理−ＥＸＩＴ.                                                
   367  003670     EXIT.                                                        
   368  003680******************************************************************
   369  003690*    未検収・協調幹事持分以外編集処理                            *
   370  003700******************************************************************
   371  003710 協調幹事持分以外編集                 SECTION.                    
   372  003720 協調幹事持分以外編集−ＳＴＡＲＴ.                                
   373  003730*----------------------------------------------------------------*
   374  003740*    出力−レコードの初期化処理                                  *
   375  003750*----------------------------------------------------------------*
   376  003760     MOVE  SPACE                      TO  出力１−レコード        
   377  003770     INITIALIZE                           出力１−レコード        
   378  003780*                                                                 
   379  003790*--< No.01 >                                                      
   380  003800     MOVE  入力−契約ＮＯ             TO 出力１−契約番号.        
   381  003810*                                                                 
   382  003820*--< No.02 >                                                      
   383  003830     PERFORM  共用信息.                                           
   384  003840     MOVE  ＩＫＯ００２−再リース回数 TO 出力１−再リース回数.    
   385  003850*--< No.03 >                                                      
   386  003860     MOVE  ＩＫＯ００２−契約種類     TO 出力１−契約種類.        
   387  003870*                                                                 
   388  003880*--< No.04 >                                                      
   389  003890     PERFORM  日期変換.                                           
   390  003900     MOVE  Ｗ−回収サイト２           TO  出力１−回収サイト.     
   391  003910*                                                                 
   392  003920*--< No.05 >                                                      
   393  003930     MOVE  入力−入金日               TO 出力１−回収日.          
   394  003940*                                                                 
   395  003950*--< No.06 >                                                      
   396  003960     EVALUATE  入力−回収方式以降                                 
   397  003970        WHEN  "1"                                                 
   398  003980           MOVE  ZERO                 TO  出力１−回収方法        
   399  003990        WHEN  "2"                                                 
   400  004000           MOVE  "5"                  TO  出力１−回収方法        
   401  004010        WHEN  "3"                                                 
   402  004020           MOVE  "3"                  TO  出力１−回収方法        
   403  004030        WHEN  "4"                                                 
   404  004040           MOVE  "4"                  TO  出力１−回収方法        
   405  004050        WHEN  OTHER                                               
   406  004060           MOVE  ZERO                 TO  出力１−回収方法        
   407  004070     END-EVALUATE.                                                
   408  004080*                                                                 
   409  004090*--< No.07 >                                                      
   410  004100     MOVE  入力−基本利回り           TO  出力１−基本利回り.     
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   411  004110*                                                                 
   412  004120*--< No.08 >                                                      
   413  004130     MOVE  入力−実質利回り           TO 出力１−実質利回り .     
   414  004140*                                                                 
   415  004150*--< No.09 >                                                      
   416  004160     MOVE  入力−粗利                 TO 出力１−粗利額.          
   417  004170*                                                                 
   418  004180*--< No.10 >                                                      
   419  004190     MOVE  入力−基本利回り           TO 出力１−基本利回り総額.  
   420  004200*                                                                 
   421  004210*--< No.11 >                                                      
   422  004220     MOVE  入力−基本利回り           TO 出力１−売上基本利回り.  
   423  004230*                                                                 
   424  004240*--< No.12 >                                                      
   425  004250     MOVE  入力−基本利回り           TO 出力１−一般基本利回り.  
   426  004260*                                                                 
   427  004270*--< No.13 >                                                      
   428  004280     MOVE  入力−実質利回り           TO 出力１−一般実質利回り.  
   429  004290*                                                                 
   430  004300*--< No.14 >                                                      
   431  004310     MOVE  入力−粗利                 TO 出力１−一般粗利額.      
   432  004320*                                                                 
   433  004330*--< No.15 >                                                      
   434  004340     COMPUTE  出力１−固定資産税 = 入力−固定資産税               
   435  004350                                 * 入力−リース期間.              
   436  004360*                                                                 
   437  004370*--< No.16 >                                                      
   438  004380     COMPUTE  出力１−動総保険料 = 入力−保険料                   
   439  004390                                 * 入力−リース期間.              
   440  004400*                                                                 
   441  004410*--< No.17 >                                                      
   442  004420     COMPUTE  出力１−委託保守料 = 入力−保守料                   
   443  004430                                 * 入力−リース期間.              
   444  004440*                                                                 
   445  004450*--< No.18 >                                                      
   446  004460     COMPUTE  出力１−固定資産税現価  = 入力−固定資産税          
   447  004470                                      * 入力−リース期間.         
   448  004480*                                                                 
   449  004490*--< No.19 >                                                      
   450  004500     COMPUTE  出力１−動総保険料現価  = 入力−保険料              
   451  004510                                      * 入力−リース期間.         
   452  004520*                                                                 
   453  004530*--< No.20 >                                                      
   454  004540     COMPUTE  出力１−委託保守料現価  = 入力−保守料              
   455  004550                                      * 入力−リース期間.         
   456  004560*                                                                 
   457  004570*--< No.21 >                                                      
   458  004580     MOVE  ZERO                       TO                          
   459  004590                                   出力１−一般固定資産税現価.    
   460  004600*                                                                 
   461  004610*--< No.22 >                                                      
   462  004620     MOVE  ZERO                       TO                          
   463  004630                                   出力１−一般動総保険料現価.    
   464  004640*                                                                 
   465  004650*--< No.23 >                                                      
   466  004660     MOVE  ZERO                       TO                          
   467  004670                                  出力１−一般委託保守料現価.     
   468  004680*                                                                 
   469  004690*--< No.24 >                                                      
   470  004700     MOVE  ZERO                       TO 出力１−前受メリット.    
   471  004710*                                                                 
   472  004720*--< No.25 >                                                      
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   473  004730     MOVE  ZERO                       TO 出力１−一般前受メリット.
   474  004740*                                                                 
   475  004750*--< No.26 >                                                      
   476  004760     MOVE  ZERO                       TO 出力１−繰延メリット.    
   477  004770*--< No.27 >                                                      
   478  004780     MOVE  ZERO                       TO 出力１−一般繰延メリット.
   479  004790*--< No.28 >                                                      
   480  004800     MOVE  入力−契約金額             TO 出力１−基本リース料総額.
   481  004810*--< No.29 >                                                      
   482  004820     COMPUTE  出力１−基本リース料１回分 =  入力−契約金額        
   483  004830                                         /  入力−リース期間.     
   484  004840*--< No.30 >                                                      
   485  004850     COMPUTE  出力１−固定資産税費用総額 =  入力−固定資産税      
   486  004860                                         *  入力−リース期間.     
   487  004870*--< No.31 >                                                      
   488  004880     MOVE  入力−固定資産税           TO                          
   489  004890                                   出力１−固定資産税費用１回分.  
   490  004900*--< No.32 >                                                      
   491  004910     COMPUTE  出力１−動総保険料費用総額 = 入力−保険料           
   492  004920                                         * 入力−リース期間.      
   493  004930*--< No.33 >                                                      
   494  004940     MOVE  入力−保険料               TO                          
   495  004950                                   出力１−動総保険料費用１回分.  
   496  004960*--< No.34 >                                                      
   497  004970     MOVE  入力−契約金額             TO 出力１−リース料総額.    
   498  004980*--< No.35 >                                                      
   499  004990     COMPUTE  出力１−リース料１回分 = 入力−契約金額             
   500  005000                                     / 入力−リース期間.          
   501  005010*--< No.36 >                                                      
   502  005020     MOVE  ZERO                       TO 出力１−前受メリット総額.
   503  005030*--< No.37 >                                                      
   504  005040     MOVE  ZERO                       TO                          
   505  005050                                   出力１−前受メリット１回分.    
   506  005060*--< No.38 >                                                      
   507  005070     MOVE  ZERO                       TO 出力１−繰延メリット総額.
   508  005080*--< No.39 >                                                      
   509  005090     MOVE  ZERO                       TO                          
   510  005100                                  出力１−繰延メリット１回分.     
   511  005110*--< No.40 >                                                      
   512  005120     MOVE 入力−契約金額              TO 出力１−実質リース料総額.
   513  005130*--< No.41 >                                                      
   514  005140     COMPUTE  出力１−実質リース料１回分 =  入力−契約金額        
   515  005150                                         /  入力−リース期間.     
   516  005160*--< No.42 >                                                      
   517  005170     MOVE  ZERO                       TO 出力１−実質リース料現価.
   518  005180*--< No.43 >                                                      
   519  005190     MOVE  入力−初期費用             TO 出力１−初期費用.        
   520  005200*--< No.44 >                                                      
   521  005210     MOVE  ZERO                       TO 出力１−期中費用現価.    
   522  005220*--< No.45 >                                                      
   523  005230     MOVE  入力−契約金額             TO                          
   524  005240                                   出力１−基本リース料総額当社.  
   525  005250*--< No.46 >                                                      
   526  005260     COMPUTE  出力１−基本リース料１回分当社 = 入力−契約金額     
   527  005270                                             / 入力−リース期間.  
   528  005280*--< No.47 >                                                      
   529  005290     MOVE  入力−固定資産税           TO                          
   530  005300                                  出力１−固定資産税費用総額当社. 
   531  005310*--< No.48 >                                                      
   532  005320     COMPUTE  出力１−固定資産税費用１回分当社                    
   533  005330           =  入力−固定資産税                                    
   534  005340           /  入力−リース期間.                                   
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   535  005350*--< No.49 >                                                      
   536  005360     MOVE  入力−保険料               TO                          
   537  005370                                   出力１−動総保険料費用総額当社.
   538  005380*--< No.50 >                                                      
   539  005390     COMPUTE  出力１−動総保険料費用１回分当社 = 入力−保険料     
   540  005400                                               / 入力−リース期間.
   541  005410*--< No.51 >                                                      
   542  005420     MOVE  入力−契約金額             TO 出力１−リース料総額当社.
   543  005430*--< No.52 >                                                      
   544  005440     COMPUTE  出力１−リース料１回分当社 = 入力−契約金額         
   545  005450                                         / 入力−リース期間.      
   546  005460*--< No.53 >                                                      
   547  005470     MOVE  ZERO                       TO                          
   548  005480                                   出力１−前受メリット総額当社.  
   549  005490*--< No.54 >                                                      
   550  005500     MOVE  ZERO                       TO                          
   551  005510                                   出力１−前受メリット１回分当社.
   552  005520*--< No.55 >                                                      
   553  005530     MOVE  ZERO                       TO                          
   554  005540                                   出力１−繰延メリット総額当社.  
   555  005550*--< No.56 >                                                      
   556  005560     MOVE  ZERO                       TO                          
   557  005570                                   出力１−繰延メリット１回分当社.
   558  005580*--< No.57 >                                                      
   559  005590     MOVE  入力−契約金額             TO                          
   560  005600                                   出力１−実質リース料総額当社.  
   561  005610*--< No.58 >                                                      
   562  005620     COMPUTE  出力１−実質リース料１回分当社 = 入力−契約金額     
   563  005630                                             / 入力−リース期間.  
   564  005640*--< No.59 >                                                      
   565  005650     MOVE  ZERO                       TO                          
   566  005660                                   出力１−実質リース料現価当社.  
   567  005670*--< No.60 >                                                      
   568  005680     MOVE  ZERO                       TO 出力１−残価回収現価当社.
   569  005690*--< No.61 >                                                      
   570  005700     MOVE  入力−初期費用             TO 出力１−初期費用当社.    
   571  005710*--< No.62 >                                                      
   572  005720     MOVE  ZERO                       TO 出力１−期中費用現価当社.
   573  005730*--< No.63 >                                                      
   574  005740     MOVE  ZERO                       TO 出力１−残価回収現価.    
   575  005750*--< No.64 >                                                      
   576  005760     MOVE  入力−粗利                 TO 出力１−粗利益全体.      
   577  005770*--< No.65 >                                                      
   578  005780     MOVE  ZERO                       TO                          
   579  005790                                  出力１−一般実質リース料現価.   
   580  005800*--< No.66 >                                                      
   581  005810     MOVE  ZERO                       TO 出力１−一般残価回収現価.
   582  005820*--< No.67 >                                                      
   583  005830     MOVE  ZERO                       TO 出力１−一般期中費用現価.
   584  005840*--< No.68 >                                                      
   585  005850     MOVE  入力−粗利                 TO 出力１−一般粗利額全体.  
   586  005860*--< No.69 >                                                      
   587  005870     MOVE  ZERO                       TO                          
   588  005880                                 出力１−一般実質リース料現価当社.
   589  005890*--< No.70 >                                                      
   590  005900     MOVE  ZERO                       TO                          
   591  005910                                  出力１−一般残価回収現価当社.   
   592  005920*--< No.71 >                                                      
   593  005930     MOVE  ZERO                       TO                          
   594  005940                                  出力１−一般期中費用現価当社.   
   595  005950*--< No.72 >                                                      
   596  005960     MOVE  ZERO                       TO 出力１−当社持分比率.    
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   597  005970*--< No.73 >                                                      
   598  005980     MOVE  ZERO                       TO 出力１−基本元本金額.    
   599  005990*--< No.74 >                                                      
   600  006000     MOVE  ZERO                       TO 出力１−リース料現価.    
   601  006010*--< No.75 >                                                      
   602  006020     MOVE  ZERO                       TO 出力１−リース料現価当社.
   603  006030*--< No.76 >                                                      
   604  006040     COMPUTE  出力１−その他諸費用                                
   605  006050            = (入力−その他１ + 入力−その他２)                   
   606  006060            * 入力−リース期間.                                   
   607  006070*--< No.77 >                                                      
   608  006080     COMPUTE  出力１−その他諸費用現価                            
   609  006090            = (入力−その他１ + 入力−その他２)                   
   610  006100            * 入力−リース期間.                                   
   611  006110*--< No.78 >                                                      
   612  006120     MOVE  ZERO                       TO                          
   613  006130                                  出力１−一般その他諸費用現価.   
   614  006140*--< No.79 >                                                      
   615  006150     MOVE  ZERO                       TO                          
   616  006160                                  出力１−委託保険料費用総額.     
   617  006170*--< No.80 >                                                      
   618  006180     MOVE  ZERO                       TO                          
   619  006190                                  出力１−委託保険料費用１回分.   
   620  006200*--< No.81 >                                                      
   621  006210     COMPUTE  出力１−その他諸費用総額                            
   622  006220            = (入力−その他１ + 入力−その他２)                   
   623  006230            * 入力−リース期間.                                   
   624  006240*--< No.82 >                                                      
   625  006250     COMPUTE  出力１−その他諸費用１回分                          
   626  006260            = 入力−その他１ + 入力−その他２.                    
   627  006270*--< No.83 >                                                      
   628  006280     MOVE  ZERO                       TO                          
   629  006290                                 出力１−委託保険料費用総額当社.  
   630  006300*--< No.84 >                                                      
   631  006310     MOVE  ZERO                       TO                          
   632  006320                                 出力１−委託保険料費用１回分当社.
   633  006330*--< No.85 >                                                      
   634  006340     COMPUTE  出力１−その他諸費用総額当社                        
   635  006350            = (入力−その他１ + 入力−その他２)                   
   636  006360            * 入力−リース期間.                                   
   637  006370*--< No.86 >                                                      
   638  006380     COMPUTE  出力１−その他諸費用１回分当社                      
   639  006390            = 入力−その他１ + 入力−その他２.                    
   640  006400*--< No.87 >                                                      
   641  006410     MOVE  Ｗ−システム日付           TO  出力１−更新年月日.     
   642  006420*--< No.88 >                                                      
   643  006430     MOVE  Ｗ−システム時刻           TO  出力１−更新時間.       
   644  006440*--< No.89 >                                                      
   645  006450     MOVE  Ｗ−担当者                 TO  出力１−更新者.         
   646  006460*--< No.90 >                                                      
   647  006470     MOVE  Ｗ−システム日付           TO  出力１−登録年月日.     
   648  006480*--< No.91 >                                                      
   649  006490     MOVE  Ｗ−システム時刻           TO  出力１−登録時間.       
   650  006500*--< No.92 >                                                      
   651  006510     MOVE  Ｗ−担当者                 TO  出力１−登録担当者.     
   652  006520*--< No.93 >                                                      
   653  006530     MOVE  Ｗ−担当者                 TO                          
   654  006540                                     出力１−入力担当者コード.    
   655  006550*                                                                 
   656  006560     PERFORM  協調幹事持分以外出力.                               
   657  006570*                                                                 
   658  006580 協調幹事持分以外編集−ＥＸＩＴ.                                  
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   659  006590     EXIT.                                                        
   660  006600******************************************************************
   661  006610*    未検収・協調幹事持分以外出力処理                            *
   662  006620******************************************************************
   663  006630 協調幹事持分以外出力                 SECTION.                    
   664  006640 協調幹事持分以外出力−ＳＴＡＲＴ.                                
   665  006650*----------------------------------------------------------------*
   666  006660*    未検収・協調幹事持分以外出力                                *
   667  006670*----------------------------------------------------------------*
   668  006680     WRITE   出力１−レコード.                                    
   669  006690*                                                                 
   670  006700*--< 未検収・協調幹事持分以外出力の状態判定 >                     
   671  006710     EVALUATE  Ｗ−状態                                           
   672  006720        WHEN  ZERO                                                
   673  006730*--<       未検収・協調幹事持分以外出力件数の加算 >               
   674  006740           COMPUTE  Ｗ−持分以外−件数 =  Ｗ−持分以外−件数 + 1  
   675  006750        WHEN  OTHER                                               
   676  006760*--<       未検収・協調幹事持分以外出力エラー >                   
   677  006770           MOVE     -60               TO  Ｗ−エラーコード        
   678  006780           PERFORM  エラー処理                                    
   679  006790     END-EVALUATE.                                                
   680  006800 協調幹事持分以外出力−ＥＸＩＴ.                                  
   681  006810     EXIT.                                                        
   682  006820******************************************************************
   683  006830*    未検収・協調幹事持分編集処理                                      *
   684  006840******************************************************************
   685  006850 協調幹事持分編集                     SECTION.                    
   686  006860 協調幹事持分編集−ＳＴＡＲＴ.                                    
   687  006870*----------------------------------------------------------------*
   688  006880*    出力−レコードの初期化処理                                  *
   689  006890*----------------------------------------------------------------*
   690  006900     MOVE  SPACE                      TO  出力２−レコード.       
   691  006910     INITIALIZE                           出力２−レコード        
   692  006920*                                                                 
   693  006930*--< No.01 >                                                      
   694  006940     MOVE  入力−契約ＮＯ             TO  出力２−契約番号.       
   695  006950*                                                                 
   696  006960*--< No.02 >                                                      
   697  006970     PERFORM  共用信息.                                           
   698  006980     MOVE  ＩＫＯ００２−再リース回数 TO  出力２−再リース回数.   
   699  006990*--< No.03 >                                                      
   700  007000     MOVE  ＩＫＯ００２−契約種類     TO  出力２−契約種類.       
   701  007010*                                                                 
   702  007020*--< No.04 >                                                      
   703  007030     PERFORM  日期変換.                                           
   704  007040     MOVE  Ｗ−回収サイト２           TO  出力２−回収サイト.     
   705  007050*                                                                 
   706  007060*--< No.05 >                                                      
   707  007070     MOVE  入力−入金日               TO  出力２−回収日.         
   708  007080*                                                                 
   709  007090*--< No.06 >                                                      
   710  007100     EVALUATE  入力−回収方式以降                                 
   711  007110        WHEN  "1"                                                 
   712  007120           MOVE  ZERO                 TO  出力２−回収方法        
   713  007130        WHEN  "2"                                                 
   714  007140           MOVE  "5"                  TO  出力２−回収方法        
   715  007150        WHEN  "3"                                                 
   716  007160           MOVE  "3"                  TO  出力２−回収方法        
   717  007170        WHEN  "4"                                                 
   718  007180           MOVE  "4"                  TO  出力２−回収方法        
   719  007190        WHEN  OTHER                                               
   720  007200           MOVE  ZERO                 TO  出力２−回収方法        
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   721  007210     END-EVALUATE.                                                
   722  007220*                                                                 
   723  007230*--< No.07 >                                                      
   724  007240     MOVE  入力−基本利回り           TO  出力２−基本利回り.     
   725  007250*                                                                 
   726  007260*--< No.08 >                                                      
   727  007270     MOVE  入力−実質利回り           TO  出力２−実質利回り .    
   728  007280*                                                                 
   729  007290*--< No.09 >                                                      
   730  007300     MOVE  入力−粗利                 TO  出力２−粗利額.         
   731  007310*                                                                 
   732  007320*--< No.10 >                                                      
   733  007330     MOVE  入力−基本利回り           TO  出力２−基本利回り総額. 
   734  007340*                                                                 
   735  007350*--< No.11 >                                                      
   736  007360     MOVE  入力−基本利回り           TO  出力２−売上基本利回り. 
   737  007370*                                                                 
   738  007380*--< No.12 >                                                      
   739  007390     MOVE  入力−基本利回り           TO  出力２−一般基本利回り. 
   740  007400*                                                                 
   741  007410*--< No.13 >                                                      
   742  007420     MOVE  入力−実質利回り           TO  出力２−一般実質利回り. 
   743  007430*                                                                 
   744  007440*--< No.14 >                                                      
   745  007450     MOVE  入力−粗利                 TO  出力２−一般粗利額.     
   746  007460*                                                                 
   747  007470*--< No.15 >                                                      
   748  007480     COMPUTE  出力２−固定資産税      = 入力−固定資産税          
   749  007490                                      * 入力−リース期間.         
   750  007500*                                                                 
   751  007510*--< No.16 >                                                      
   752  007520     COMPUTE  出力２−動総保険料      = 入力−保険料              
   753  007530                                      * 入力−リース期間.         
   754  007540*                                                                 
   755  007550*--< No.17 >                                                      
   756  007560     COMPUTE  出力２−委託保守料      = 入力−保守料              
   757  007570                                      * 入力−リース期間.         
   758  007580*                                                                 
   759  007590*--< No.18 >                                                      
   760  007600     COMPUTE  出力２−固定資産税現価  = 入力−固定資産税          
   761  007610                                      * 入力−リース期間.         
   762  007620*                                                                 
   763  007630*--< No.19 >                                                      
   764  007640     COMPUTE  出力２−動総保険料現価  = 入力−保険料              
   765  007650                                      * 入力−リース期間.         
   766  007660*                                                                 
   767  007670*--< No.20 >                                                      
   768  007680     COMPUTE  出力２−委託保守料現価  = 入力−保守料              
   769  007690                                      * 入力−リース期間.         
   770  007700*                                                                 
   771  007710*--< No.21 >                                                      
   772  007720     MOVE     ZERO                    TO                          
   773  007730                                  出力２−一般固定資産税現価.     
   774  007740*                                                                 
   775  007750*--< No.22 >                                                      
   776  007760     MOVE     ZERO                    TO                          
   777  007770                                  出力２−一般動総保険料現価.     
   778  007780*                                                                 
   779  007790*--< No.23 >                                                      
   780  007800     MOVE     ZERO                    TO                          
   781  007810                                  出力２−一般委託保守料現価.     
   782  007820*                                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   783  007830*--< No.24 >                                                      
   784  007840     MOVE     ZERO                    TO 出力２−前受メリット.    
   785  007850*                                                                 
   786  007860*--< No.25 >                                                      
   787  007870     MOVE     ZERO                    TO 出力２−一般前受メリット.
   788  007880*                                                                 
   789  007890*--< No.26 >                                                      
   790  007900     MOVE     ZERO                    TO 出力２−繰延メリット.    
   791  007910*--< No.27 >                                                      
   792  007920     MOVE     ZERO                    TO 出力２−一般繰延メリット.
   793  007930*--< No.28 >                                                      
   794  007940     MOVE     入力−契約金額          TO 出力２−基本リース料総額.
   795  007950*--< No.29 >                                                      
   796  007960     COMPUTE  出力２−基本リース料１回分 =  入力−契約金額        
   797  007970                                         /  入力−リース期間.     
   798  007980*--< No.30 >                                                      
   799  007990     COMPUTE  出力２−固定資産税費用総額 =  入力−固定資産税      
   800  008000                                         *  入力−リース期間.     
   801  008010*--< No.31 >                                                      
   802  008020     MOVE     入力−固定資産税        TO                          
   803  008030                                   出力２−固定資産税費用１回分.  
   804  008040*--< No.32 >                                                      
   805  008050     COMPUTE  出力２−動総保険料費用総額 = 入力−保険料           
   806  008060                                         * 入力−リース期間.      
   807  008070*--< No.33 >                                                      
   808  008080     MOVE     入力−保険料            TO                          
   809  008090                                   出力２−動総保険料費用１回分.  
   810  008100*--< No.34 >                                                      
   811  008110     MOVE     入力−契約金額          TO  出力２−リース料総額.   
   812  008120*--< No.35 >                                                      
   813  008130     COMPUTE  出力２−リース料１回分 = 入力−契約金額             
   814  008140                                     / 入力−リース期間.          
   815  008150*--< No.36 >                                                      
   816  008160     MOVE     ZERO                    TO                          
   817  008170                                   出力２−前受メリット総額.      
   818  008180*--< No.37 >                                                      
   819  008190     MOVE     ZERO                    TO                          
   820  008200                                   出力２−前受メリット１回分.    
   821  008210*--< No.38 >                                                      
   822  008220     MOVE     ZERO                    TO 出力２−繰延メリット総額.
   823  008230*--< No.39 >                                                      
   824  008240     MOVE     ZERO                    TO                          
   825  008250                                   出力２−繰延メリット１回分.    
   826  008260*--< No.40 >                                                      
   827  008270     MOVE     入力−契約金額          TO 出力２−実質リース料総額.
   828  008280*--< No.41 >                                                      
   829  008290      COMPUTE  出力２−実質リース料１回分 =  入力−契約金額       
   830  008300                                         /  入力−リース期間.     
   831  008310*--< No.42 >                                                      
   832  008320     MOVE     ZERO                    TO 出力２−実質リース料現価.
   833  008330*--< No.43 >                                                      
   834  008340     MOVE    入力−初期費用           TO 出力２−初期費用.        
   835  008350*--< No.44 >                                                      
   836  008360     MOVE     ZERO                    TO 出力２−期中費用現価.    
   837  008370*--< No.45 >                                                      
   838  008380     MOVE     入力−契約金額          TO                          
   839  008390                                   出力２−基本リース料総額当社.  
   840  008400*--< No.46 >                                                      
   841  008410     COMPUTE  出力２−基本リース料１回分当社 = 入力−契約金額     
   842  008420                                             / 入力−リース期間.  
   843  008430*--< No.47 >                                                      
   844  008440     MOVE     入力−固定資産税        TO                          
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   845  008450                                   出力２−固定資産税費用総額当社.
   846  008460*--< No.48 >                                                      
   847  008470     COMPUTE  出力２−固定資産税費用１回分当社 =  入力−固定資産税
   848  008480                                              /  入力−リース期間.
   849  008490*--< No.49 >                                                      
   850  008500     MOVE     入力−保険料            TO                          
   851  008510                                   出力２−動総保険料費用総額当社.
   852  008520*--< No.50 >                                                      
   853  008530     COMPUTE  出力２−動総保険料費用１回分当社 = 入力−保険料     
   854  008540                                               / 入力−リース期間.
   855  008550*--< No.51 >                                                      
   856  008560     MOVE     入力−契約金額          TO 出力２−リース料総額当社.
   857  008570*--< No.52 >                                                      
   858  008580     COMPUTE  出力２−リース料１回分当社 = 入力−契約金額         
   859  008590                                         / 入力−リース期間.      
   860  008600*--< No.53 >                                                      
   861  008610     MOVE     ZERO                    TO                          
   862  008620                                   出力２−前受メリット総額当社.  
   863  008630*--< No.54 >                                                      
   864  008640     MOVE     ZERO                    TO                          
   865  008650                                  出力２−前受メリット１回分当社. 
   866  008660*--< No.55 >                                                      
   867  008670     MOVE     ZERO                    TO                          
   868  008680                                  出力２−繰延メリット総額当社.   
   869  008690*--< No.56 >                                                      
   870  008700     MOVE     ZERO                    TO                          
   871  008710                                  出力２−繰延メリット１回分当社. 
   872  008720*--< No.57 >                                                      
   873  008730     MOVE     入力−契約金額          TO                          
   874  008740                                   出力２−実質リース料総額当社.  
   875  008750*--< No.58 >                                                      
   876  008760     COMPUTE  出力２−実質リース料１回分当社 = 入力−契約金額     
   877  008770                                             / 入力−リース期間.  
   878  008780*--< No.59 >                                                      
   879  008790     MOVE     ZERO                    TO                          
   880  008800                                   出力２−実質リース料現価当社.  
   881  008810*--< No.60 >                                                      
   882  008820     MOVE     ZERO                    TO                          
   883  008830                                   出力２−残価回収現価当社.      
   884  008840*--< No.61 >                                                      
   885  008850     MOVE     入力−初期費用          TO  出力２−初期費用当社.   
   886  008860*--< No.62 >                                                      
   887  008870     MOVE     ZERO                    TO                          
   888  008880                                  出力２−期中費用現価当社.       
   889  008890*--< No.63 >                                                      
   890  008900     MOVE     ZERO                    TO  出力２−残価回収現価.   
   891  008910*--< No.64 >                                                      
   892  008920     MOVE     入力−粗利              TO  出力２−粗利益全体.     
   893  008930*--< No.65 >                                                      
   894  008940     MOVE     ZERO                    TO                          
   895  008950                                  出力２−一般実質リース料現価.   
   896  008960*--< No.66 >                                                      
   897  008970     MOVE     ZERO                    TO 出力２−一般残価回収現価.
   898  008980*--< No.67 >                                                      
   899  008990     MOVE     ZERO                    TO 出力２−一般期中費用現価.
   900  009000*--< No.68 >                                                      
   901  009010     MOVE     入力−粗利              TO  出力２−一般粗利額全体. 
   902  009020*--< No.69 >                                                      
   903  009030     MOVE     ZERO                    TO                          
   904  009040                                 出力２−一般実質リース料現価当社.
   905  009050*--< No.70 >                                                      
   906  009060     MOVE     ZERO                    TO                          
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   907  009070                                   出力２−一般残価回収現価当社.  
   908  009080*--< No.71 >                                                      
   909  009090     MOVE     ZERO                    TO                          
   910  009100                                   出力２−一般期中費用現価当社.  
   911  009110*--< No.72 >                                                      
   912  009120     MOVE     ZERO                    TO  出力２−当社持分比率.   
   913  009130*--< No.73 >                                                      
   914  009140     MOVE     ZERO                    TO  出力２−基本元本金額.   
   915  009150*--< No.74 >                                                      
   916  009160     MOVE     ZERO                    TO  出力２−リース料現価.   
   917  009170*--< No.75 >                                                      
   918  009180     MOVE     ZERO                    TO 出力２−リース料現価当社.
   919  009190*--< No.76 >                                                      
   920  009200     COMPUTE  出力２−その他諸費用                                
   921  009210            = (入力−その他１ + 入力−その他２)                   
   922  009220            * 入力−リース期間.                                   
   923  009230*--< No.77 >                                                      
   924  009240     COMPUTE  出力２−その他諸費用現価                            
   925  009250            = (入力−その他１ + 入力−その他２)                   
   926  009260            * 入力−リース期間.                                   
   927  009270*--< No.78 >                                                      
   928  009280     MOVE     ZERO                    TO                          
   929  009290                                  出力２−一般その他諸費用現価.   
   930  009300*--< No.79 >                                                      
   931  009310     MOVE     ZERO                    TO                          
   932  009320                                  出力２−委託保険料費用総額.     
   933  009330*--< No.80 >                                                      
   934  009340     MOVE     ZERO                    TO                          
   935  009350                                  出力２−委託保険料費用１回分.   
   936  009360*--< No.81 >                                                      
   937  009370     COMPUTE  出力２−その他諸費用総額                            
   938  009380            = (入力−その他１ + 入力−その他２)                   
   939  009390            * 入力−リース期間.                                   
   940  009400*--< No.82 >                                                      
   941  009410     COMPUTE  出力２−その他諸費用１回分                          
   942  009420            = 入力−その他１ + 入力−その他２.                    
   943  009430*--< No.83 >                                                      
   944  009440     MOVE     ZERO                    TO                          
   945  009450                                  出力２−委託保険料費用総額当社. 
   946  009460*--< No.84 >                                                      
   947  009470     MOVE     ZERO                    TO                          
   948  009480                                 出力２−委託保険料費用１回分当社.
   949  009490*--< No.85 >                                                      
   950  009500     COMPUTE  出力２−その他諸費用総額当社                        
   951  009510            = (入力−その他１ + 入力−その他２)                   
   952  009520            * 入力−リース期間.                                   
   953  009530*--< No.86 >                                                      
   954  009540     COMPUTE  出力２−その他諸費用１回分当社                      
   955  009550            = 入力−その他１ + 入力−その他２.                    
   956  009560*--< No.87 >                                                      
   957  009570     MOVE  Ｗ−システム日付           TO  出力２−更新年月日.     
   958  009580*--< No.88 >                                                      
   959  009590     MOVE  Ｗ−システム時刻           TO  出力２−更新時間.       
   960  009600*--< No.89 >                                                      
   961  009610     MOVE  Ｗ−担当者                 TO  出力２−更新者.         
   962  009620*--< No.90 >                                                      
   963  009630     MOVE  Ｗ−システム日付           TO  出力２−登録年月日.     
   964  009640*--< No.91 >                                                      
   965  009650     MOVE  Ｗ−システム時刻           TO  出力２−登録時間.       
   966  009660*--< No.92 >                                                      
   967  009670     MOVE  Ｗ−担当者                 TO  出力２−登録担当者.     
   968  009680*--< No.93 >                                                      
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   969  009690     MOVE  Ｗ−担当者                 TO                          
   970  009700                                    出力２−入力担当者コード.     
   971  009710*                                                                 
   972  009720     PERFORM  協調幹事持分出力.                                   
   973  009730*                                                                 
   974  009740 協調幹事持分編集−ＥＸＩＴ.                                      
   975  009750     EXIT.                                                        
   976  009760******************************************************************
   977  009770*    未検収・協調幹事持分出力処理                                *
   978  009780******************************************************************
   979  009790 協調幹事持分出力                     SECTION.                    
   980  009800 協調幹事持分出力−ＳＴＡＲＴ.                                    
   981  009810*----------------------------------------------------------------*
   982  009820*    未検収・協調幹事持分出力                                    *
   983  009830*----------------------------------------------------------------*
   984  009840     WRITE   出力２−レコード.                                    
   985  009850*                                                                 
   986  009860*--< 未検収・協調幹事持分出力の状態判定 >                         
   987  009870     EVALUATE  Ｗ−状態                                           
   988  009880        WHEN  ZERO                                                
   989  009890*--<       未検収・協調幹事持分出力件数の加算 >                   
   990  009900           COMPUTE  Ｗ−持分−件数 =  Ｗ−持分−件数 + 1          
   991  009910        WHEN  OTHER                                               
   992  009920*--<       未検収・協調幹事持分出力エラー >                       
   993  009930           MOVE     -70               TO  Ｗ−エラーコード        
   994  009940           PERFORM  エラー処理                                    
   995  009950     END-EVALUATE.                                                
   996  009960 協調幹事持分出力−ＥＸＩＴ.                                      
   997  009970     EXIT.                                                        
   998  009980******************************************************************
   999  009990*    契約種類等変換テーブル信息抽出                              *
  1000  010000******************************************************************
  1001  010010 共用信息                             SECTION.                    
  1002  010020 共用信息−ＳＴＡＲＴ.                                            
  1003  010030*----------------------------------------------------------------*
  1004  010040*    契約種類等変換テーブル読込処理                              *
  1005  010050*----------------------------------------------------------------*
  1006  010060     MOVE  入力−契約ＮＯ             TO  ＷＳ−契約番号.         
  1007  010070     MOVE  入力−勘定処理コード       TO  ＷＳ−勘定処理コード.   
  1008  010080     EXEC  SQL                                                    
  1009  010090        SELECT  再リース回数                                      
  1010  010100               ,契約種類                                          
  1011  010110          INTO :ＩＫＯ００２−再リース回数                        
  1012  010120              ,:ＩＫＯ００２−契約種類                            
  1013  010130          FROM  IKOTBL002                                         
  1014  010140         WHERE  契約ＮＯ       = :ＷＳ−契約番号                  
  1015  010150           AND  再リースコード = :ＷＳ−再リースコード            
  1016  010160           AND  旧債権勘定処理コード                              
  1017  010170                               = :ＷＳ−勘定処理コード            
  1018  010180     END-EXEC.                                                    
  1019  010190*----------------------------------------------------------------*
  1020  010200*    契約種類等変換テーブル読込処理を確認                        *
  1021  010210*----------------------------------------------------------------*
  1022  010220     EVALUATE  SQLCODE                                            
  1023  010230        WHEN  定数−ＳＱＬＯＫ                                    
  1024  010240*--<       正常 >                                                 
  1025  010250           CONTINUE                                               
  1026  010260        WHEN  OTHER                                               
  1027  010270*--<       読込エラー >                                           
  1028  010280           MOVE     -80               TO  Ｗ−エラーコード        
  1029  010290           PERFORM  エラー処理                                    
  1030  010300     END-EVALUATE.                                                
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  1031  010310 共用信息−ＥＸＩＴ.                                              
  1032  010320     EXIT.                                                        
  1033  010330******************************************************************
  1034  010340*    日期変換                                                    *
  1035  010350******************************************************************
  1036  010360 日期変換                             SECTION.                    
  1037  010370 日期変換−ＳＴＡＲＴ.                                            
  1038  010380     EVALUATE  入力−第１回リース料入金日−世紀                   
  1039  010390        WHEN  "0"                                                 
  1040  010400           MOVE  "19"                 TO  Ｗ−入金年(1:2)         
  1041  010410        WHEN  "1"                                                 
  1042  010420           MOVE  "20"                 TO  Ｗ−入金年(1:2)         
  1043  010430     END-EVALUATE.                                                
  1044  010440     MOVE  入力−第１回リース料入金日−年月日(1:2)                
  1045  010450                                      TO  Ｗ−入金年(3:2).        
  1046  010460     MOVE  入力−第１回リース料入金日−年月日(3:2)                
  1047  010470                                      TO  Ｗ−入金月.             
  1048  010480     EVALUATE  入力−リース開始日−世紀                           
  1049  010490        WHEN  "0"                                                 
  1050  010500           MOVE  "19"                 TO  Ｗ−開始年(1:2)         
  1051  010510        WHEN  "1"                                                 
  1052  010520           MOVE  "20"                 TO  Ｗ−開始年(1:2)         
  1053  010530     END-EVALUATE.                                                
  1054  010540     MOVE  入力−リース開始日−年月日(1:2)                        
  1055  010550                                      TO  Ｗ−開始年(3:2).        
  1056  010560     MOVE  入力−リース開始日−年月日(3:2)                        
  1057  010570                                      TO  Ｗ−開始月.             
  1058  010580     MOVE  Ｗ−第１回リース料入金日１                             
  1059  010590                                  TO  Ｗ−第１回リース料入金日２. 
  1060  010600     MOVE  Ｗ−リース開始日１         TO  Ｗ−リース開始日２.     
  1061  010610     IF  Ｗ−開始月 < Ｗ−入金月                                  
  1062  010620        COMPUTE  Ｗ−回収サイト１ =  Ｗ−第１回リース料入金日２   
  1063  010630                                  -  Ｗ−リース開始日２           
  1064  010640           MOVE  Ｗ−回収サイト１     TO  Ｗ−回収サイト          
  1065  010650        COMPUTE  Ｗ−回収サイト２ =  Ｗ−回収サイト年 * 12        
  1066  010660                                  +  Ｗ−回収サイト月             
  1067  010670     ELSE                                                         
  1068  010680        COMPUTE  Ｗ−入金年 =  Ｗ−入金年 - 1                     
  1069  010690        COMPUTE  Ｗ−入金月 =  Ｗ−入金月 + 12                    
  1070  010700        COMPUTE  Ｗ−回収サイト年 =  Ｗ−入金年 - Ｗ−開始年      
  1071  010710        COMPUTE  Ｗ−回収サイト月 =  Ｗ−入金月 - Ｗ−開始月      
  1072  010720        COMPUTE  Ｗ−回収サイト２ =  Ｗ−回収サイト年 * 12        
  1073  010730                                  +  Ｗ−回収サイト月             
  1074  010740     END-IF.                                                      
  1075  010750 日期変換−ＥＸＩＴ.                                              
  1076  010760     EXIT.                                                        
  1077  010770******************************************************************
  1078  010780*    終了処理                                                    *
  1079  010790******************************************************************
  1080  010800 終了処理                             SECTION.                    
  1081  010810 終了処理−ＳＴＡＲＴ.                                            
  1082  010820*                                                                 
  1083  010830*----------------------------------------------------------------*
  1084  010840*    ファイルクローズ                                            *
  1085  010850*----------------------------------------------------------------*
  1086  010860     CLOSE  入力ファイル.                                         
  1087  010870     CLOSE  出力ファイル１.                                       
  1088  010880     CLOSE  出力ファイル２.                                       
  1089  010890*                                                                 
  1090  010900*--< 終了メッセージ出力処理                                       
  1091  010910     PERFORM  終了メッセージ出力.                                 
  1092  010920*                                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  1093  010930*--< プログラム正常終了 >                                         
  1094  010940     MOVE  定数−正常状態             TO  PROGRAM-STATUS.         
  1095  010950*                                                                 
  1096  010960 終了処理−ＥＸＩＴ.                                              
  1097  010970     EXIT.                                                        
  1098  010980******************************************************************
  1099  010990*    終了メッセージ出力                                          *
  1100  011000******************************************************************
  1101  011010  終了メッセージ出力                  SECTION.                    
  1102  011020  終了メッセージ出力−ＳＴＡＲＴ.                                 
  1103  011030*----------------------------------------------------------------*
  1104  011040*    契約基本ファイル入力件数                                    *
  1105  011050*----------------------------------------------------------------*
  1106  011060     INITIALIZE                       IF-CHOCO001.                
  1107  011070     MOVE  "3"                        TO  共１−イベント種別.     
  1108  011080     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
  1109  011090     MOVE  "0"                        TO  共１−復帰コード.       
  1110  011100     MOVE  "FFUIS345"                 TO  共１−処理テーブルＩＤ. 
  1111  011110     MOVE  "COUNT"                    TO  共１−処理識別.         
  1112  011120     MOVE  Ｗ−契約基本−件数         TO  共１−データ内容.       
  1113  011130     MOVE  "契約基本ファイル入力件数" TO  共１−その他メッセージ. 
  1114  011140     CALL  CLOCO001                USING  IF-CHOCO001.            
  1115  011150*                                                                 
  1116  011160*----------------------------------------------------------------*
  1117  011170*   未検収・協調持分以外出力件数                                 *
  1118  011180*----------------------------------------------------------------*
  1119  011190     INITIALIZE                       IF-CHOCO001.                
  1120  011200     MOVE  "3"                        TO  共１−イベント種別.     
  1121  011210     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
  1122  011220     MOVE  "0"                        TO  共１−復帰コード.       
  1123  011230     MOVE  "FFUIS355"                 TO  共１−処理テーブルＩＤ. 
  1124  011240     MOVE  "COUNT"                    TO  共１−処理識別.         
  1125  011250     MOVE  Ｗ−持分以外−件数         TO  共１−データ内容.       
  1126  011260     MOVE  "未検収・協調持分以外 出力件数"                        
  1127  011270                                      TO  共１−その他メッセージ. 
  1128  011280     CALL  CLOCO001                USING  IF-CHOCO001.            
  1129  011290*                                                                 
  1130  011300*----------------------------------------------------------------*
  1131  011310*    未検収・協調持分出力件数                                    *
  1132  011320*----------------------------------------------------------------*
  1133  011330     INITIALIZE                       IF-CHOCO001.                
  1134  011340     MOVE  "3"                        TO  共１−イベント種別.     
  1135  011350     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
  1136  011360     MOVE  "0"                        TO  共１−復帰コード.       
  1137  011370     MOVE  "FFUIS356"                 TO  共１−処理テーブルＩＤ. 
  1138  011380     MOVE  "COUNT"                    TO  共１−処理識別.         
  1139  011390     MOVE  Ｗ−持分−件数             TO  共１−データ内容.       
  1140  011400     MOVE  "未検収・協調持分 出力件数"                            
  1141  011410                                      TO  共１−その他メッセージ. 
  1142  011420     CALL  CLOCO001                USING  IF-CHOCO001.            
  1143  011430*                                                                 
  1144  011440*----------------------------------------------------------------*
  1145  011450*    終了メッセージ 出力                                         *
  1146  011460*----------------------------------------------------------------*
  1147  011470     INITIALIZE                       IF-CHOCO001.                
  1148  011480     MOVE  "3"                        TO  共１−イベント種別.     
  1149  011490     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
  1150  011500     MOVE  "0"                        TO  共１−復帰コード.       
  1151  011510     MOVE  "END"                      TO  共１−処理識別.         
  1152  011520     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
  1153  011530     CALL  CLOCO001                USING  IF-CHOCO001.            
  1154  011540*                                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  1155  011550 終了メッセージ出力−ＥＸＩＴ.                                    
  1156  011560     EXIT.                                                        
  1157  011570******************************************************************
  1158  011580*    エラー処理                                                  *
  1159  011590******************************************************************
  1160  011600 エラー処理                           SECTION.                    
  1161  011610 エラー処理−ＳＴＡＲＴ.                                          
  1162  011620*                                                                 
  1163  011630     MOVE  "Y"                        TO  Ｗ−異常終了−フラグ.   
  1164  011640     INITIALIZE                           IF-CHOCO001.            
  1165  011650*                                                                 
  1166  011660     EVALUATE  Ｗ−エラーコード                                   
  1167  011670        WHEN  -10                                                 
  1168  011680*--<       ＯＲＡＣＬＥ接続失敗 >                                 
  1169  011690           MOVE  "1"                  TO  共１−イベント種別      
  1170  011700           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
  1171  011710           MOVE  "9"                  TO  共１−復帰コード        
  1172  011720           MOVE  "CONNECT"            TO  共１−処理識別          
  1173  011730           MOVE  SQLCODE              TO  共１−データ内容        
  1174  011740           MOVE  SQLERRMC             TO  共１−その他メッセージ  
  1175  011750           CALL  CLOCO001          USING  IF-CHOCO001             
  1176  011760                                                                  
  1177  011770        WHEN  -20                                                 
  1178  011780*--<        契約基本ファイルオープンエラー   >                    
  1179  011790           MOVE  "1"                  TO  共１−イベント種別      
  1180  011800           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
  1181  011810           MOVE  "9"                  TO  共１−復帰コード        
  1182  011820           MOVE  "FFUIS354"           TO  共１−処理テーブルＩＤ  
  1183  011830           MOVE  "OPEN"               TO  共１−処理識別          
  1184  011840           MOVE  Ｗ−状態             TO  共１−データ内容        
  1185  011850           MOVE  "契約基本ファイルオープンエラー"                 
  1186  011860                                      TO  共１−その他メッセージ  
  1187  011870           CALL  CLOCO001          USING  IF-CHOCO001             
  1188  011880*                                                                 
  1189  011890        WHEN  -30                                                 
  1190  011900*--<       未検収・協調幹事持分以外オープンエラー   >             
  1191  011910           MOVE  "1"                  TO  共１−イベント種別      
  1192  011920           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
  1193  011930           MOVE  "9"                  TO  共１−復帰コード        
  1194  011940           MOVE  "FFUIS355"           TO  共１−処理テーブルＩＤ  
  1195  011950           MOVE  "OPEN"               TO  共１−処理識別          
  1196  011960           MOVE  Ｗ−状態             TO  共１−データ内容        
  1197  011970           MOVE  "未検収・協調幹事持分以外オープンエラー "        
  1198  011980                                      TO  共１−その他メッセージ  
  1199  011990           CALL  CLOCO001          USING  IF-CHOCO001             
  1200  012000      WHEN  -40                                                   
  1201  012010*--<       未検収・協調幹事持分オープンエラー   >                 
  1202  012020           MOVE  "1"                  TO  共１−イベント種別      
  1203  012030           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
  1204  012040           MOVE  "9"                  TO  共１−復帰コード        
  1205  012050           MOVE  "FFUIS356"           TO  共１−処理テーブルＩＤ  
  1206  012060           MOVE  "OPEN"               TO  共１−処理識別          
  1207  012070           MOVE  Ｗ−状態             TO  共１−データ内容        
  1208  012080           MOVE  "未検収・協調幹事持分オープンエラー"             
  1209  012090                                      TO  共１−その他メッセージ  
  1210  012100           CALL  CLOCO001          USING  IF-CHOCO001             
  1211  012110*                                                                 
  1212  012120        WHEN  -50                                                 
  1213  012130*--<       契約基本ファイル読込エラー >                           
  1214  012140           MOVE  "1"                  TO  共１−イベント種別      
  1215  012150           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
  1216  012160           MOVE  "9"                  TO  共１−復帰コード        
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  1217  012170           MOVE  "FFUIS354"           TO  共１−処理テーブルＩＤ  
  1218  012180           MOVE  "READ"               TO  共１−処理識別          
  1219  012190           MOVE  Ｗ−状態             TO  共１−データ内容        
  1220  012200           MOVE  "契約基本ファイル読込エラー"                     
  1221  012210                                      TO  共１−その他メッセージ  
  1222  012220           CALL  CLOCO001          USING  IF-CHOCO001             
  1223  012230*                                                                 
  1224  012240        WHEN  -60                                                 
  1225  012250*--<       未検収・協調幹事持分以外出力エラー >                   
  1226  012260           MOVE  "1"                  TO  共１−イベント種別      
  1227  012270           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
  1228  012280           MOVE  "9"                  TO  共１−復帰コード        
  1229  012290           MOVE  "FFUIS355"           TO  共１−処理テーブルＩＤ  
  1230  012300           MOVE  "WRITE"              TO  共１−処理識別          
  1231  012310           MOVE  Ｗ−状態             TO  共１−データ内容        
  1232  012320           MOVE  "未検収・協調幹事持分以外出力エラー"             
  1233  012330                                      TO  共１−その他メッセージ  
  1234  012340           CALL  CLOCO001          USING  IF-CHOCO001             
  1235  012350*                                                                 
  1236  012360        WHEN  -70                                                 
  1237  012370*--<       未検収・協調幹事持分出力エラー >                       
  1238  012380           MOVE  "1"                  TO  共１−イベント種別      
  1239  012390           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
  1240  012400           MOVE  "9"                  TO  共１−復帰コード        
  1241  012410           MOVE  "FFUIS356"           TO  共１−処理テーブルＩＤ  
  1242  012420           MOVE  "WRITE"              TO  共１−処理識別          
  1243  012430           MOVE  Ｗ−状態             TO  共１−データ内容        
  1244  012440           MOVE  "未検収・協調幹事持分出力エラー"                 
  1245  012450                                      TO  共１−その他メッセージ  
  1246  012460           CALL  CLOCO001          USING  IF-CHOCO001             
  1247  012470*                                                                 
  1248  012480        WHEN  -80                                                 
  1249  012490*--<       契約種類等変換テーブル読込処理失敗 >                   
  1250  012500           MOVE  "1"                  TO  共１−イベント種別      
  1251  012510           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
  1252  012520           MOVE  "9"                  TO  共１−復帰コード        
  1253  012530           MOVE  "IKOTBL02"           TO  共１−処理テーブルＩＤ  
  1254  012540           MOVE  "SELECT"             TO  共１−処理識別          
  1255  012550           MOVE  SQLCODE              TO  共１−データ内容        
  1256  012560           MOVE  SQLERRMC             TO  共１−その他メッセージ  
  1257  012570           CALL  CLOCO001          USING  IF-CHOCO001             
  1258  012580*                                                                 
  1259  012590        WHEN  OTHER                                               
  1260  012600           MOVE  "N"                  TO  Ｗ−異常終了−フラグ    
  1261  012610*                                                                 
  1262  012620     END-EVALUATE.                                                
  1263  012630*                                                                 
  1264  012640     IF  Ｗ−異常終了−フラグ  =  "Y"                             
  1265  012650        PERFORM  終了メッセージ出力                               
  1266  012660*                                                                 
  1267  012670*--<    プログラム異常終了のリターンコード >                      
  1268  012680        MOVE  定数−異常状態          TO  PROGRAM-STATUS          
  1269  012690*                                                                 
  1270  012700        EXIT  PROGRAM                                             
  1271  012710     END-IF.                                                      
  1272  012720*                                                                 
  1273  012730 エラー処理−ＥＸＩＴ.                                            
  1274  012740      EXIT.                                                       
  1275  012750******************************************************************
  1276  012760*                  END OF PROGRAM                                *
  1277  012770******************************************************************
  1278  012780                                                                                                             
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

ファイル: COBIS351.PCOをクローズ
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


ホスト変数
--------------

01  DB-STRING                                           Charf(20)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      3
  COBIS351.PCO    250

01  PASSWD                                              Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      5
  COBIS351.PCO    245    249

01  SQLSTATE                                            Charf(5)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      2
  COBIS351.PCO    244    248   1008

01  USERNAME                                            Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      4
  COBIS351.PCO    245    249

01  ＩＫＯ００２−契約種類                              Charf(3)
  Z:\COB97\COPYLIB_DB\IKOTBL002.CBL     11
  COBIS351.PCO   1012

01  ＩＫＯ００２−再リース回数                          Decimal(2,0)
  Z:\COB97\COPYLIB_DB\IKOTBL002.CBL      8
  COBIS351.PCO   1011

01  ＷＳ−勘定処理コード                                Unsigned Display(2,0)
  COBIS351.PCO     86   1017

01  ＷＳ−契約番号                                      Charf(9)
  COBIS351.PCO     84   1014

01  ＷＳ−再リースコード                                Unsigned Display(1,0)
  COBIS351.PCO     85   1015

Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.



                              プリコンパイラ・オプション
-------------------------------------------------------------------------------
オプション名   現在の設定値         設定先
-------------------------------------------------------------------------------
asacc             no                デフォルト                                  
assume_sqlcode    no                デフォルト                                  
auto_connect      no                デフォルト                                  
close_on_commit   yes               mode                                        
comp5             yes               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
config            default config    デフォルト                                  
date_format       local             デフォルト                                  
dbms              native            デフォルト                                  
declare_section   yes               mode                                        
define            *なし*            デフォルト                                  
dynamic           ansi              mode                                        
end_of_fetch      100               mode                                        
eol_padding       yes               デフォルト                                  
errors            yes               デフォルト                                  
fips              no                デフォルト                                  
format            ansi              デフォルト                                  
hold_cursor       no                デフォルト                                  
host              cobol             デフォルト                                  
iname             COBIS351.PCO      コマンドライン                              
include           Z:\COB97\COPYLIB  D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
                  Z:\COB97\COPYLIB_DD:\oracle\ora90\precomp\admin\pcbcfg.cfg    
                  *なし*            D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
ireclen           132               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
litdelim          quote             デフォルト                                  
lname             *なし*            デフォルト                                  
lreclen           132               デフォルト                                  
ltype             long              デフォルト                                  
maxliteral        160               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
maxopencursors    10                デフォルト                                  
mode              ANSI              D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
nested            yes               デフォルト                                  
nls_local         yes               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
oname             COBIS351.COB      コマンドライン                              
oraca             no                デフォルト                                  
oreclen           80                デフォルト                                  
pagelen           66                デフォルト                                  
picx              charf             デフォルト                                  
prefetch          1                 デフォルト                                  
release_cursor    no                デフォルト                                  
select_error      yes               デフォルト                                  
sqlcheck          FULL              D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
threads           no                デフォルト                                  
type_code         ansi              mode                                        
unsafe_null       no                デフォルト                                  
userid            ZHOUJING/ZJ@FIP   D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
varchar           no                デフォルト                                  
xref              yes               デフォルト                                  
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:37:55 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


統計表示
----------

リターン・コード: 0
重要性 Iでのメッセージ数: 0
重要性 Wでのメッセージ数: 0
重要性 Eでのメッセージ数: 0
重要性 Fでのメッセージ数: 0
入力ラインの数: 1297
宣言されたホスト変数の数: 17
カーソル名の数: 0
文名の数: 0
使用される最大メモリー(バイト): 151472
