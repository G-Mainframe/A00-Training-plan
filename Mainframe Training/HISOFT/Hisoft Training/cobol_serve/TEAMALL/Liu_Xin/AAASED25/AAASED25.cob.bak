000010******************************************************************
000020*                 (A)                                     *
000030*      1. vO  : O󕥎ct@C쐬             *
000040*      2. vOID  : AAASED25                               *
000050*      3. Tv      : 
000070*                                                                *
000080*      4. 쐬        :                               *
000090*      5. 쐬        :                             *
000100******************************************************************
000110*                                                                 
000120******************************************************************
000130*    hcdmshehb`shnm  chuhrhnm              *
000140******************************************************************
000150 IDENTIFICATION                       DIVISION.                   
000160*                                                                 
000170 PROGRAM-ID.                          AAASED25.                   
000180******************************************************************
000190*    dmuhqnmldms        chuhrhnm              *
000200******************************************************************
000210 ENVIRONMENT                          DIVISION.                   
000220******************************************************************
000230*    c`s`                      chuhrhnm              *
000240******************************************************************
000250 DATA                                 DIVISION.                   
000260******************************************************************
000270*  vnqjhmf|rsnq`fd  rdbshnm                *
000280******************************************************************
000290  WORKING-STORAGE                     SECTION.                    
000300*----------------------------------------------------------------*
000310*    zXgϐ`GA                                        *
000320*----------------------------------------------------------------*
000330     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +34.
           02  SQLFPN-FILENAME PIC X(34) VALUE "C:\COB97\SOC\AAASED25\AA
      -    "ASED25.PCO".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(159) VALUE "insert into D34HNS_TBL(_ԍ,
      -     "ă[X,_,Jn,JnN,I,IN,z,
      -     ",XVN,XV,XV,͒S҃R[h,o^N
      -    ",o^".

           02  FILLER PIC X(94) VALUE ",o^S) values (:b1,:b2,:b
      -    "3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,:b16
      -    ")".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +157234284.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +16.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 16 TIMES.


       01  SQ0001 GLOBAL.
           02  FILLER PIC X(160) VALUE "select D411STK_TBL._ԍ  ,D4
      -    "11STK_TBL.ă[X  ,D411STK_TBL._  ,D411STK_TBL.
      -    "z  ,D411STK_TBL.  ,D411STK_TBL.N  ,D41
      -    "1STK_TBL".

           02  FILLER PIC X(160) VALUE ".A   from D32SAK_TBL ,D411STK
      -    "_TBL where (((D32SAK_TBL.ϑ='1' and D32SAK_TBL._ԍ=
      -    "D411STK_TBL._ԍ) and D32SAK_TBL.ă[X=D411STK_TB
      -    "L.ă[".

           02  FILLER PIC X(159) VALUE "X) and D32SAK_TBL._=
      -    "D411STK_TBL._) order by D411STK_TBL._ԍ,D411STK_
      -    "TBL.ă[X,D411STK_TBL._,D411STK_TBL.z    
      -    "       ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +193.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +197.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +479.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +251.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +82.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +277.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +125.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +253.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +416.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +204.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +535.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +219.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +12.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +547.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +234.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +14.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +32.
           02     FILLER PIC S9(4) COMP-5 VALUE +567.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000340*                                                                 
000350*--< nq`bkdʕϐ >                                       
000360     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
000370*                                                                 
000380*--< nq`bkd  rpks >                               
000010*--rpkʕϐ
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000390     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000400*                                                                 
000410*--< ڍs_WJ >                                            
000420     
      *    EXEC  SQL  INCLUDE  D411STK.CBL           END-EXEC.
000430*                                                                 
000440*--< ڍs_ >                                                
      *****************************************************************
      *   WJ(D411STK_TBL)
      *****************************************************************
       01  WJ.
           03  cSPP|_ԍ    PIC  X(010).
           03  cSPP|ă[X
                                     PIC S9(002) PACKED-DECIMAL.
           03  cSPP|_    PIC  X(003).
           03  cSPP|A        PIC S9(003) PACKED-DECIMAL.
           03  cSPP|ŗ    PIC S9(002)V9(008) PACKED-DECIMAL.
           03  cSPP|ŗ敪
                                     PIC  X(002).
           03  cSPP|N    PIC  X(006).
           03  cSPP|z      PIC S9(013) PACKED-DECIMAL.
           03  cSPP|  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ŕ␳z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|R[h
                                     PIC  X(009).
           03  cSPP|R[h
                                     PIC  X(005).
           03  cSPP|N  PIC  X(008).
           03  cSPP|z      PIC S9(013) PACKED-DECIMAL.
           03  cSPP|  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ŕ␳z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|\  PIC  X(008).
           03  cSPP|N  PIC  X(008).
           03  cSPP|z      PIC S9(013) PACKED-DECIMAL.
           03  cSPP|z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|sσtO
                                     PIC  X(001).
           03  cSPP|XVN  PIC  X(008).
           03  cSPP|XV    PIC  X(008).
           03  cSPP|XV      PIC  X(008).
           03  cSPP|s
                                     PIC  X(008).
           03  cSPP|ԍ  PIC S9(007) PACKED-DECIMAL.
           03  cSPP|z    PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ϑێ敪
                                     PIC  X(001).
           03  cSPP|ϑێ痿  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ϑێ
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|_ԍ
                                     PIC  X(015).
           03  cSPP|@    PIC  X(001).
           03  cSPP|͒S҃R[h
                                     PIC  X(008).
           03  cSPP|`tO
                                     PIC  X(001).
           03  cSPP|Љz  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Љz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Аz  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|А
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|R[h
                                     PIC  X(003).
           03  cSPP|R[h
                                     PIC  X(003).
           03  cSPP|ʔ    PIC  X(011).
           03  cSPP|A    PIC S9(002) PACKED-DECIMAL.
           03  cSPP|c  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|c
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|c  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|c
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Аc
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Аc
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|{    PIC S9(013) PACKED-DECIMAL.
           03  cSPP|    PIC S9(013) PACKED-DECIMAL.
           03  cSPP|{c
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|{z  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|z  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ЌŒ莑Y
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Гی
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Јϑێ痿
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Д㌳{
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Д㗘
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Д㌳{c
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|vWJ
                                     PIC S9(002)V9(008) PACKED-DECIMAL.
           03  cSPP|Д㌳{
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|ЕxKp
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Еx
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|        PIC S9(002)V9(008) PACKED-DECIMAL.
           03  cSPP|ԍϔN  PIC  X(008).
           03  cSPP|Ԍ    PIC S9(003) PACKED-DECIMAL.
           03  cSPP|ԓ    PIC S9(003) PACKED-DECIMAL.
           03  cSPP|vZJn
                                     PIC  X(008).
           03  cSPP|vZI
                                     PIC  X(008).
           03  cSPP|Љz  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Љ
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|o^N  PIC  X(008).
           03  cSPP|o^    PIC  X(008).
           03  cSPP|o^S  PIC  X(008).
           03  cSPP|  PIC  X(008).
           03  cSPP|O[敪
                                     PIC  X(001).
           03  cSPP|      PIC S9(003) PACKED-DECIMAL.
           03  cSPP|N  PIC  X(008).
           03  cSPP|Аz  PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Аz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPP|Ђ̑p
                                     PIC S9(013) PACKED-DECIMAL.
000450     
      *    EXEC  SQL  INCLUDE  D32SAK.CBL            END-EXEC.
000460*                                                                 
000470*--< ϑca>                                                  
      *****************************************************************
      *    (D32SAK_TBL)
      *****************************************************************
       01  .
           03  cRQ|_ԍ      PIC  X(010).
           03  cRQ|ă[X  PIC S9(002) PACKED-DECIMAL.
           03  cRQ|_      PIC  X(003).
           03  cRQ|_񌏖      PIC  X(040).
           03  cRQ|      PIC  X(060).
           03  cRQ|ϑ        PIC  X(001).
           03  cRQ|z  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŋ敪
                                     PIC  X(002).
           03  cRQ|Ŋz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|_񑍊z  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|őz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVŋ敪
                                     PIC  X(002).
           03  cRQ|ŐVŊz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐV_񑍊z  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVőz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ێ疳  PIC S9(003) PACKED-DECIMAL.
           03  cRQ|ԃtO    PIC  X(001).
           03  cRQ|tO    PIC  X(001).
           03  cRQ|N    PIC  X(008).
           03  cRQ|敪      PIC  X(001).
           03  cRQ|񗝗R      PIC  X(002).
           03  cRQ|      PIC S9(002) PACKED-DECIMAL.
           03  cRQ|ŐV
                                     PIC  X(008).
           03  cRQ|z        PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŉz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐV    PIC  X(008).
           03  cRQ|Ǘx
                                     PIC  X(001).
           03  cRQ|z  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|vz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|擾z      PIC S9(013) PACKED-DECIMAL.
           03  cRQ|kytO
                                     PIC  X(001).
           03  cRQ|񏈗N  PIC  X(006).
           03  cRQ|Gg
                                     PIC  X(008).
           03  cRQ|tO    PIC  X(001).
           03  cRQ|N    PIC  X(008).
           03  cRQ|\tO
                                     PIC  X(001).
           03  cRQ|\    PIC  X(008).
           03  cRQ|ύXtO
                                     PIC  X(001).
           03  cRQ|ύX
                                     PIC S9(002) PACKED-DECIMAL.
           03  cRQ|ύX
                                     PIC  X(008).
           03  cRQ|O敪      PIC  X(001).
           03  cRQ|ă[X
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[X敪
                                     PIC  X(001).
           03  cRQ|ێLtO
                                     PIC  X(001).
           03  cRQ|ă[X쐬tO
                                     PIC  X(001).
           03  cRQ|ă[X쐬N
                                     PIC  X(008).
           03  cRQ|XVN    PIC  X(008).
           03  cRQ|XV      PIC  X(008).
           03  cRQ|XV        PIC  X(008).
           03  cRQ|擾z    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|擾z    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|O      PIC S9(002) PACKED-DECIMAL.
           03  cRQ|ă[X
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[Xŋ敪
                                     PIC  X(002).
           03  cRQ|      PIC S9(003) PACKED-DECIMAL.
           03  cRQ|    PIC S9(003) PACKED-DECIMAL.
           03  cRQ|Z_
                                     PIC  X(003).
           03  cRQ|ă[X敪
                                     PIC  X(001).
           03  cRQ|ă[X萔
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|UXgbv\N
                                     PIC  X(008).
           03  cRQ|UXgbv\
                                     PIC  X(004).
           03  cRQ|UXgbv\
                                     PIC  X(008).
           03  cRQ|UXgbvJnN
                                     PIC  X(006).
           03  cRQ|UXgbvIN
                                     PIC  X(006).
           03  cRQ|UXgbvR
                                     PIC  X(002).
           03  cRQ|UXgbvGg
                                     PIC  X(008).
           03  cRQ|Uʐ\N
                                     PIC  X(008).
           03  cRQ|Uʐ\
                                     PIC  X(004).
           03  cRQ|Uʐ\
                                     PIC  X(008).
           03  cRQ|UʐJnN
                                     PIC  X(006).
           03  cRQ|UʐIN
                                     PIC  X(006).
           03  cRQ|Uʐ\z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|UʃGg
                                     PIC  X(008).
           03  cRQ|xă[X
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ϑێ敪  PIC  X(001).
           03  cRQ|ϑێ瑊z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|͒S҃R[h
                                     PIC  X(008).
           03  cRQ|̑_ދ敪
                                     PIC  X(001).
           03  cRQ|R[h  PIC  X(009).
           03  cRQ|R[h  PIC  X(005).
           03  cRQ|evz      PIC S9(013) PACKED-DECIMAL.
           03  cRQ|evz|\  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|`    PIC  X(008).
           03  cRQ|`      PIC S9(003) PACKED-DECIMAL.
           03  cRQ|Еz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Еz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Е_񑍊z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Еőz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ѝwz    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|cݒz    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ўcݒz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Љz    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Љz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Њz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Њvz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[X萔z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[X萔
                                     PIC  X(008).
           03  cRQ|p萔  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[XЎcݒz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[XЎcݒz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|vz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|vz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|pz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|菈R[h
                                     PIC  X(002).
           03  cRQ|Œ|
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|菈R[h
                                     PIC  X(002).
           03  cRQ|敪  PIC  X(001).
           03  cRQ|zz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ŋzz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVzz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVŊzz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐV_񑍊zz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ŐVőzz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|擾zz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|擾zz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[Xz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ă[Xőz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|cTCg
                                     PIC S9(002)V9(002) PACKED-DECIMAL.
           03  cRQ|XPO_񑍊z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Œ敪
                                     PIC  X(001).
           03  cRQ|o^N    PIC  X(008).
           03  cRQ|o^      PIC  X(008).
           03  cRQ|o^S    PIC  X(008).
           03  cRQ|UzύXR
                                     PIC  X(002).
           03  cRQ|Еă[X
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Еă[X
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ݒuꏊ敪  PIC S9(001) PACKED-DECIMAL.
           03  cRQ|_񑍊zz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|őzz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ѝwz    PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ўcݒz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ќ{z  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Д㗘z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Зz  PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Џpz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ЌŒ莑Yőz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Гیz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Јϑێ痿z
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Ђ̑pz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|ЕxpKpv
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|Еxpʍv
                                     PIC S9(013) PACKED-DECIMAL.
           03  cRQ|{z      PIC S9(013) PACKED-DECIMAL.
           03  cRQ|z      PIC S9(013) PACKED-DECIMAL.
           03  cRQ|pz    PIC S9(013) PACKED-DECIMAL.
000480     
      *    EXEC  SQL  INCLUDE  D34HNS.CBL            END-EXEC.
000490*                                                                 
      *****************************************************************
      *   ϑ(D34HNS_TBL)
      *****************************************************************
       01  ϑ.
           03  cRS|_ԍ      PIC  X(010).
           03  cRS|ă[X  PIC S9(002) PACKED-DECIMAL.
           03  cRS|_      PIC  X(003).
           03  cRS|Jn        PIC S9(003) PACKED-DECIMAL.
           03  cRS|JnN      PIC  X(006).
           03  cRS|I        PIC S9(003) PACKED-DECIMAL.
           03  cRS|IN      PIC  X(006).
           03  cRS|z          PIC S9(013) PACKED-DECIMAL.
           03  cRS|        PIC S9(013) PACKED-DECIMAL.
           03  cRS|XVN    PIC  X(008).
           03  cRS|XV      PIC  X(008).
           03  cRS|XV        PIC  X(008).
           03  cRS|͒S҃R[h
                                     PIC  X(008).
           03  cRS|o^N    PIC  X(008).
           03  cRS|o^      PIC  X(008).
           03  cRS|o^S    PIC  X(008).
000500     
      *    EXEC  SQL  END  DECLARE          SECTION  END-EXEC.
000510*                                                                 
000520*----------------------------------------------------------------*
000530*    vnqjGA                                              *
000540*----------------------------------------------------------------*
000550 01  vnqj|GA.                                            
000560*--< G[p >                                               
000570     03  v|G[R[h             PIC S9(04).                 
000580*                                                                 
000590*--< tOAA >                                               
000600     03  tOAA.                                            
000610         05  v|I|tO         PIC  X(01).                 
000620         05  v|ُI|tO     PIC  X(01).                 
000630*                                                                 
000640*--< GA >                                                 
000650     03  GA.                                              
000660         05  v|́|           PIC  9(09).                 
000670         05  v|ó|           PIC  9(09).                 
000680*                                                                 
000690*--< L[GA >                                                 
000700     03  jdx|GA.                                          
000710        05  mdvL[.                                           
000720            07 m|_ԍ           PIC  X(09).                 
000730            07 m|ă[X       PIC  9(02).                 
000740            07 m|_           PIC  X(03).                 
000750            07 m|z             PIC  9(13).                 
000760        05  nkcL[.                                           
000770            07 n|_ԍ           PIC  X(09).                 
000780            07 n|ă[X       PIC  9(02).                 
000790            07 n|_           PIC  X(03).                 
000800            07 n|z             PIC  9(13).                 
000810*                                                                 
000820*--< ʏ >                                                   
000830 01  v|ʏ.                                                
000840     03  v|VXet.                                        
000850         05  v|I                 PIC  X(02) VALUE  "20".     
000860         05  v|N               PIC  X(06).                 
000870     03  v|VXe             PIC  X(08).                 
000880     03  v|S                   PIC  X(08) VALUE "IKOPG   ".
000890*                                                                 
000900*----------------------------------------------------------------*
000910*    Tu[`                                              *
000920*----------------------------------------------------------------*
000930 01  CALL-AREA.                                                   
000940*--< ʃOTu[` >                                       
000950     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
000960     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
000970*                                                                 
000980*----------------------------------------------------------------*
000990*    bnoẍ                                                *
001000*----------------------------------------------------------------*
001010*--< ʃOpp[^ >                                       
001020 01  IF-CHOCO001.                                                 
001030     COPY  CHOCO001  REPLACING  ==()==  BY  ==P|==.           
001040*                                                                 
001050*----------------------------------------------------------------*
001060*    hmht@CǍTu[`pp^̈                *
001070*----------------------------------------------------------------*
001080 01  PARA-AREA.                                                   
001090     COPY CPBCO001.                                               
001100******************************************************************
001110*    萔pf[^`GA                                      *
001120******************************************************************
001130 CONSTANT                             SECTION.                    
001140 01  萔̈.                                                    
001150     03  萔|vOhc         PIC  X(08) VALUE "COBIS430".
001160     03  萔|vO           PIC  X(80)                  
001170                                      VALUE  "ϑڍs".        
001180     03  萔|rpknj             PIC S9(04)  VALUE  ZERO.    
001190     03  萔|rpkdmc           PIC S9(04)  VALUE  0100.    
001200     03  萔|               PIC S9(04)  VALUE  ZERO.    
001210     03  萔|ُ               PIC S9(04)  VALUE  0009.    
001220******************************************************************
001230*    oqnbdctqd            chuhrhnm              *
001240******************************************************************
001250 PROCEDURE                            DIVISION.                   
001260*                                                                 
001270     PERFORM  .                                           
001280*                                                                 
001290     PERFORM  又  UNTIL  v|I|tO  =  "Y".            
001300*                                                                 
001310     PERFORM  I.                                           
001320*                                                                 
001330     STOP     RUN.                                                
001340*                                                                 
001350******************************************************************
001360*                                                        *
001370******************************************************************
001380                              SECTION.                    
001390 |rs`qs.                                            
001400*                                                                 
001410*----------------------------------------------------------------*
001420*    JnbZ[Wo͏                                      *
001430*----------------------------------------------------------------*
001440     INITIALIZE                       IF-CHOCO001.                
001450     MOVE  "3"                        TO  P|Cxg.     
001460     MOVE  萔|vOhc       TO  P|\[Xhc.       
001470     MOVE  "0"                        TO  P|AR[h.       
001480     MOVE  "START"                    TO  P|.         
001490     MOVE  萔|vO         TO  P|̑bZ[W. 
001500     CALL  CLOCO001                USING  IF-CHOCO001.            
001510*                                                                 
001520*----------------------------------------------------------------*
001530*    Ɨ̈̏l                                        *
001540*----------------------------------------------------------------*
001550     MOVE  SPACE                      TO  vnqj|GA.       
001560     INITIALIZE                           vnqj|GA.       
001570*                                                                 
001580     MOVE  LOW-VALUE                  TO  nkcL[.             
001590*                                                                 
001600*--< bott擾 >                                           
001610     ACCEPT  v|N               FROM  DATE.                 
001620*                                                                 
001630*--< bot擾 >                                           
001640     ACCEPT  v|VXe         FROM  TIME.                 
001650*                                                                 
001660*--< nq`bkdڑ >                                           
001670     PERFORM   nq`bkdڑ.                                  
001680*                                                                 
001690*--< e[uJ[\` >                                   
001700     PERFORM  e[uJ[\`.                           
001710*                                                                 
001720*--< e[uJ[\Ǎ(P) >                           
001730     PERFORM  e[uJ[\Ǎ.                           
001740*                                                                 
001750 |dwhs.                                              
001760     EXIT.                                                        
001770******************************************************************
001780*    nq`bkdڑ                                            *
001790******************************************************************
001800 nq`bkdڑ                     SECTION.                    
001810 nq`bkdڑ|rs`qs.                                    
001820*                                                                 
001830*--< caڑp擾 >                                   
001840     CALL  COBCO001                USING  PARA-AREA.              
001850*                                                                 
001860     MOVE  PARA-DBSTRING              TO  DB-STRING.              
001870     MOVE  PARA-USERNAME              TO  USERNAME.               
001880     MOVE  PARA-PASSWORD              TO  PASSWD.                 
001890*                                                                 
001900*----------------------------------------------------------------*
001910*    Jnڑ                                                    *
001920*----------------------------------------------------------------*
001930     IF    DB-STRING  =  SPACE                                    
001940        
      *       EXEC SQL                                                  
001950*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
001960*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
001970     ELSE                                                         
001980        
      *       EXEC SQL                                                  
001990*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002000*            USING  :DB-STRING                                    
002010*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002020     END-IF.                                                      
002030*                                                                 
002040*----------------------------------------------------------------*
002050*    ڑmF                                                    *
002060*----------------------------------------------------------------*
002070     EVALUATE  SQLCODE                                            
002080        WHEN   萔|rpknj                                   
002090           CONTINUE                                               
002100        WHEN   OTHER                                              
002110*--<       ڑG[ >                                           
002120           MOVE     -10               TO  v|G[R[h        
002130           PERFORM  G[菈                                
002140     END-EVALUATE.                                                
002150*                                                                 
002160 nq`bkdڑ|dwhs.                                      
002170     EXIT.                                                        
002180******************************************************************
002190*        e[uJ[\`                                *
002200******************************************************************
002210 e[uJ[\`             SECTION.                    
002220 e[uJ[\`|rs`qs.                            
002230*                                                                 
002240*----------------------------------------------------------------*
002250*    J[\nodm                                        *
002260*----------------------------------------------------------------*
002270     
      *    EXEC SQL                                                     
002280*       DECLARE CUR1  CURSOR FOR                                  
002290*          SELECT  D411STK_TBL._ԍ                           
002300*                 ,D411STK_TBL.ă[X                       
002310*                 ,D411STK_TBL._                           
002320*                 ,D411STK_TBL.z                             
002330*                 ,D411STK_TBL.                         
002340*                 ,D411STK_TBL.N                           
002350*                 ,D411STK_TBL.A                               
002360*            FROM  D32SAK_TBL                                     
002370*                 ,D411STK_TBL                                    
002380*           WHERE  D32SAK_TBL.ϑ       =  '1'                 
002390*             AND  D32SAK_TBL._ԍ     =  D411STK_TBL._ԍ
002400*             AND  D32SAK_TBL.ă[X =                      
002410*                                         D411STK_TBL.ă[X
002420*             AND  D32SAK_TBL._     =  D411STK_TBL._
002430*        ORDER BY  D411STK_TBL._ԍ                           
002440*                 ,D411STK_TBL.ă[X                       
002450*                 ,D411STK_TBL._                           
002460*                 ,D411STK_TBL.z                             
002470*    END-EXEC.
002480*                                                                 
002490*----------------------------------------------------------------*
002500*    J[\nodm                                        *
002510*----------------------------------------------------------------*
002520     
      *    EXEC  SQL                                                    
002530*       OPEN  CUR1                                                
002540*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
002550*                                                                 
002560*----------------------------------------------------------------*
002570*    J[\nodmmF                                        *
002580*----------------------------------------------------------------*
002590     EVALUATE  SQLCODE                                            
002600        WHEN  萔|rpknj                                    
002610*--<        >                                                 
002620           CONTINUE                                               
002630        WHEN  OTHER                                               
002640*--<       J[\nodmG[ >                               
002650           MOVE -20                   TO  v|G[R[h        
002660           PERFORM  G[菈                                
002670     END-EVALUATE.                                                
002680*                                                                 
002690 e[uJ[\`|dwhs.                              
002700     EXIT.                                                        
002710******************************************************************
002720*    e[uJ[\Ǎ                                    *
002730******************************************************************
002740 e[uJ[\Ǎ             SECTION.                    
002750 e[uJ[\Ǎ|rs`qs.                            
002760*                                                                 
002770*--< e[uJ[\Ǎ >                                   
002780     
      *    EXEC SQL                                                     
002790*        FETCH  CUR1                                              
002800*         INTO  :cSPP|_ԍ                               
002810*              ,:cSPP|ă[X                           
002820*              ,:cSPP|_                               
002830*              ,:cSPP|z                                 
002840*              ,:cSPP|                             
002850*              ,:cSPP|N                               
002860*              ,:cSPP|A                                   
002870*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 82 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               cSPP|_ԍ IN
               WJ
               SQL-SQHSTV(1)
           MOVE 10 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               cSPP|ă[X IN
               WJ
               SQL-SQHSTV(2)
           MOVE 2 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               cSPP|_ IN
               WJ
               SQL-SQHSTV(3)
           MOVE 3 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               cSPP|z IN
               WJ
               SQL-SQHSTV(4)
           MOVE 7 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               cSPP| IN
               WJ
               SQL-SQHSTV(5)
           MOVE 7 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               cSPP|N IN
               WJ
               SQL-SQHSTV(6)
           MOVE 6 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               cSPP|A IN
               WJ
               SQL-SQHSTV(7)
           MOVE 2 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
002880*                                                                 
002890*----------------------------------------------------------------*
002900*    e[uJ[\ǍmF                              *
002910*----------------------------------------------------------------*
002920     EVALUATE   SQLCODE                                           
002930        WHEN   萔|rpknj                                   
002940*--<        >                                                 
002950           MOVE  cSPP|_ԍ   TO  m|_ԍ            
002960           MOVE  cSPP|ă[X                           
002970                                      TO  m|ă[X        
002980           MOVE  cSPP|_   TO  m|_            
002990           MOVE  cSPP|z     TO  m|z              
003000*                                                                 
003010           COMPUTE  v|́|  =  v|́|  +  1       
003020        WHEN   萔|rpkdmc                                 
003030*--<       ǍI >                                             
003040           MOVE  "Y"                  TO  v|I|tO        
003050        WHEN   OTHER                                              
003060*--<       ǍG[ >                                           
003070           MOVE     -30               TO  v|G[R[h        
003080           PERFORM  G[菈                                
003090     END-EVALUATE.                                                
003100*                                                                 
003110 e[uJ[\Ǎ|dwhs.                              
003120     EXIT.                                                        
003130******************************************************************
003140*    又                                                      *
003150******************************************************************
003160 又                               SECTION.                    
003170 又|rs`qs.                                              
003180*                                                                 
003190     PERFORM  ҏWo͏.                                       
003200*                                                                 
003210*--< e[uJ[\ǍiQڈȍ~j >                     
003220     PERFORM  e[uJ[\Ǎ.                           
003230*                                                                 
003240     IF  v|I|tO  =  "Y"                                 
003250*--<    ̓f[^I鎞Ōo͏ >                          
003260        PERFORM  o͏                                         
003270     END-IF.                                                      
003280*                                                                 
003290 又|dwhs.                                                
003300     EXIT.                                                        
003310******************************************************************
003320*     ҏWo͏                                               *
003330******************************************************************
003340 ҏWo͏                         SECTION.                    
003350 ҏWo͏|rs`qs.                                        
003360*                                                                 
003370     IF  mdvL[  =  nkcL[                                
003380*--<    No.06 >                                                   
003390        MOVE  cSPP|A          TO  cRS|I          
003400*--<    No.07 >                                                   
003410        MOVE  cSPP|N      TO  cRS|IN        
003420     ELSE                                                         
003430        IF  v|́|  >  1                                  
003440*--<       Qڈȍ~AL[ς鎞Ao͂ >               
003450           PERFORM  o͏                                      
003460        END-IF                                                    
003470*                                                                 
003480*----------------------------------------------------------------*
003490*                                                      *
003500*----------------------------------------------------------------*
003510        MOVE  SPACE                   TO  ϑ                  
003520        INITIALIZE                        ϑ                  
003530*                                                                 
003540*----------------------------------------------------------------*
003550*       ڕҏW                                             *
003560*----------------------------------------------------------------*
003570*--<    No.01 >                                                   
003580        MOVE  cSPP|_ԍ(1:9) TO  cRS|_ԍ        
003590*                                                                 
003600*--<    No.02 >                                                   
003610        MOVE  cSPP|ă[X  TO  cRS|ă[X    
003620                                                                  
003630*--<    No.03 >                                                   
003640        MOVE  cSPP|_      TO  cRS|_        
003650*                                                                 
003660*--<    No.04 >                                                   
003670        MOVE  cSPP|A          TO  cRS|Jn          
003680*                                                                 
003690*--<    No.05 >                                                   
003700        MOVE  cSPP|N      TO  cRS|JnN        
003710*                                                                 
003720*--<    No.06 >                                                   
003730        MOVE  cSPP|A          TO  cRS|I          
003740*                                                                 
003750*--<    No.07 >                                                   
003760        MOVE  cSPP|N      TO  cRS|IN        
003770*                                                                 
003780*--<    No.08 >                                                   
003790        MOVE  cSPP|z        TO  cRS|z            
003800*                                                                 
003810*--<    No.09 >                                                   
003820        MOVE  cSPP|    TO  cRS|          
003830*                                                                 
003840*--<    No.10 >                                                   
003850        MOVE  v|VXet        TO  cRS|XVN      
003860*                                                                 
003870*--<    No.11 >                                                   
003880        MOVE  v|VXe        TO  cRS|XV        
003890*                                                                 
003900*--<    No.12 >                                                   
003910        MOVE  v|S              TO  cRS|XV          
003920*                                                                 
003930*--<    No.13 >                                                   
003940        MOVE  v|S              TO  cRS|͒S҃R[h
003950*                                                                 
003960*--<    No.14 >                                                   
003970        MOVE  v|VXet        TO  cRS|o^N      
003980*                                                                 
003990*--<    No.15 >                                                   
004000        MOVE  v|VXe        TO  cRS|o^        
004010*                                                                 
004020*--<    No.16 >                                                   
004030        MOVE  v|S              TO  cRS|o^S      
004040*                                                                 
004050     END-IF.                                                      
004060*                                                                 
004070     MOVE mdvL[                  TO  nkcL[.             
004080*                                                                 
004090 ҏWo͏|dwhs.                                          
004100     EXIT.                                                        
004110******************************************************************
004120*    o͏                                                    *
004130******************************************************************
004140 o͏                             SECTION.                    
004150 o͏|rs`qs.                                            
004160*                                                                 
004170       
      *      EXEC  SQL                                                  
004180*       INSERT  INTO  D34HNS_TBL                                  
004190*          ( _ԍ                                             
004200*           ,ă[X                                         
004210*           ,_                                             
004220*           ,Jn                                               
004230*           ,JnN                                             
004240*           ,I                                               
004250*           ,IN                                             
004260*           ,z                                                 
004270*           ,                                               
004280*           ,XVN                                           
004290*           ,XV                                             
004300*           ,XV                                               
004310*           ,͒S҃R[h                                     
004320*           ,o^N                                           
004330*           ,o^                                             
004340*           ,o^S)                                          
004350*      VALUES                                                     
004360*          ( :cRS|_ԍ                                    
004370*           ,:cRS|ă[X                                
004380*           ,:cRS|_                                    
004390*           ,:cRS|Jn                                      
004400*           ,:cRS|JnN                                    
004410*           ,:cRS|I                                      
004420*           ,:cRS|IN                                    
004430*           ,:cRS|z                                        
004440*           ,:cRS|                                      
004450*           ,:cRS|XVN                                  
004460*           ,:cRS|XV                                    
004470*           ,:cRS|XV                                      
004480*           ,:cRS|͒S҃R[h                            
004490*           ,:cRS|o^N                                  
004500*           ,:cRS|o^                                    
004510*           ,:cRS|o^S)                                 
004520*    END-EXEC.
             CALL "SQLADR" USING SQ0002 SQL-STMT
             MOVE 1 TO SQL-ITERS
             MOVE 125 TO SQL-OFFSET
             MOVE 0 TO SQL-OCCURS
             CALL "SQLADR" USING
                 SQLCUD
                 SQL-CUD
             CALL "SQLADR" USING
                 SQLCA
                 SQL-SQLEST
             MOVE 256 TO SQL-SQLETY
             CALL "SQLADR" USING
                 cRS|_ԍ IN
                 ϑ
                 SQL-SQHSTV(1)
             MOVE 10 TO SQL-SQHSTL(1)
             MOVE 0 TO SQL-SQHSTS(1)
             MOVE 0 TO SQL-SQINDV(1)
             MOVE 0 TO SQL-SQINDS(1)
             MOVE 0 TO SQL-SQHARM(1)
             CALL "SQLADR" USING
                 cRS|ă[X IN
                 ϑ
                 SQL-SQHSTV(2)
             MOVE 2 TO SQL-SQHSTL(2)
             MOVE 0 TO SQL-SQHSTS(2)
             MOVE 0 TO SQL-SQINDV(2)
             MOVE 0 TO SQL-SQINDS(2)
             MOVE 0 TO SQL-SQHARM(2)
             CALL "SQLADR" USING
                 cRS|_ IN
                 ϑ
                 SQL-SQHSTV(3)
             MOVE 3 TO SQL-SQHSTL(3)
             MOVE 0 TO SQL-SQHSTS(3)
             MOVE 0 TO SQL-SQINDV(3)
             MOVE 0 TO SQL-SQINDS(3)
             MOVE 0 TO SQL-SQHARM(3)
             CALL "SQLADR" USING
                 cRS|Jn IN
                 ϑ
                 SQL-SQHSTV(4)
             MOVE 2 TO SQL-SQHSTL(4)
             MOVE 0 TO SQL-SQHSTS(4)
             MOVE 0 TO SQL-SQINDV(4)
             MOVE 0 TO SQL-SQINDS(4)
             MOVE 0 TO SQL-SQHARM(4)
             CALL "SQLADR" USING
                 cRS|JnN IN
                 ϑ
                 SQL-SQHSTV(5)
             MOVE 6 TO SQL-SQHSTL(5)
             MOVE 0 TO SQL-SQHSTS(5)
             MOVE 0 TO SQL-SQINDV(5)
             MOVE 0 TO SQL-SQINDS(5)
             MOVE 0 TO SQL-SQHARM(5)
             CALL "SQLADR" USING
                 cRS|I IN
                 ϑ
                 SQL-SQHSTV(6)
             MOVE 2 TO SQL-SQHSTL(6)
             MOVE 0 TO SQL-SQHSTS(6)
             MOVE 0 TO SQL-SQINDV(6)
             MOVE 0 TO SQL-SQINDS(6)
             MOVE 0 TO SQL-SQHARM(6)
             CALL "SQLADR" USING
                 cRS|IN IN
                 ϑ
                 SQL-SQHSTV(7)
             MOVE 6 TO SQL-SQHSTL(7)
             MOVE 0 TO SQL-SQHSTS(7)
             MOVE 0 TO SQL-SQINDV(7)
             MOVE 0 TO SQL-SQINDS(7)
             MOVE 0 TO SQL-SQHARM(7)
             CALL "SQLADR" USING
                 cRS|z IN
                 ϑ
                 SQL-SQHSTV(8)
             MOVE 7 TO SQL-SQHSTL(8)
             MOVE 0 TO SQL-SQHSTS(8)
             MOVE 0 TO SQL-SQINDV(8)
             MOVE 0 TO SQL-SQINDS(8)
             MOVE 0 TO SQL-SQHARM(8)
             CALL "SQLADR" USING
                 cRS| IN
                 ϑ
                 SQL-SQHSTV(9)
             MOVE 7 TO SQL-SQHSTL(9)
             MOVE 0 TO SQL-SQHSTS(9)
             MOVE 0 TO SQL-SQINDV(9)
             MOVE 0 TO SQL-SQINDS(9)
             MOVE 0 TO SQL-SQHARM(9)
             CALL "SQLADR" USING
                 cRS|XVN IN
                 ϑ
                 SQL-SQHSTV(10)
             MOVE 8 TO SQL-SQHSTL(10)
             MOVE 0 TO SQL-SQHSTS(10)
             MOVE 0 TO SQL-SQINDV(10)
             MOVE 0 TO SQL-SQINDS(10)
             MOVE 0 TO SQL-SQHARM(10)
             CALL "SQLADR" USING
                 cRS|XV IN
                 ϑ
                 SQL-SQHSTV(11)
             MOVE 8 TO SQL-SQHSTL(11)
             MOVE 0 TO SQL-SQHSTS(11)
             MOVE 0 TO SQL-SQINDV(11)
             MOVE 0 TO SQL-SQINDS(11)
             MOVE 0 TO SQL-SQHARM(11)
             CALL "SQLADR" USING
                 cRS|XV IN
                 ϑ
                 SQL-SQHSTV(12)
             MOVE 8 TO SQL-SQHSTL(12)
             MOVE 0 TO SQL-SQHSTS(12)
             MOVE 0 TO SQL-SQINDV(12)
             MOVE 0 TO SQL-SQINDS(12)
             MOVE 0 TO SQL-SQHARM(12)
             CALL "SQLADR" USING
                 cRS|͒S҃R[h IN
                 ϑ
                 SQL-SQHSTV(13)
             MOVE 8 TO SQL-SQHSTL(13)
             MOVE 0 TO SQL-SQHSTS(13)
             MOVE 0 TO SQL-SQINDV(13)
             MOVE 0 TO SQL-SQINDS(13)
             MOVE 0 TO SQL-SQHARM(13)
             CALL "SQLADR" USING
                 cRS|o^N IN
                 ϑ
                 SQL-SQHSTV(14)
             MOVE 8 TO SQL-SQHSTL(14)
             MOVE 0 TO SQL-SQHSTS(14)
             MOVE 0 TO SQL-SQINDV(14)
             MOVE 0 TO SQL-SQINDS(14)
             MOVE 0 TO SQL-SQHARM(14)
             CALL "SQLADR" USING
                 cRS|o^ IN
                 ϑ
                 SQL-SQHSTV(15)
             MOVE 8 TO SQL-SQHSTL(15)
             MOVE 0 TO SQL-SQHSTS(15)
             MOVE 0 TO SQL-SQINDV(15)
             MOVE 0 TO SQL-SQINDS(15)
             MOVE 0 TO SQL-SQHARM(15)
             CALL "SQLADR" USING
                 cRS|o^S IN
                 ϑ
                 SQL-SQHSTV(16)
             MOVE 8 TO SQL-SQHSTL(16)
             MOVE 0 TO SQL-SQHSTS(16)
             MOVE 0 TO SQL-SQINDV(16)
             MOVE 0 TO SQL-SQINDS(16)
             MOVE 0 TO SQL-SQHARM(16)
             CALL "SQLADR" USING
                 SQL-SQHSTV(1)
                 SQL-SQPHSV
             CALL "SQLADR" USING
                 SQL-SQHSTL(1)
                 SQL-SQPHSL
             CALL "SQLADR" USING
                 SQL-SQHSTS(1)
                 SQL-SQPHSS
             CALL "SQLADR" USING
                 SQL-SQINDV(1)
                 SQL-SQPIND
             CALL "SQLADR" USING
                 SQL-SQINDS(1)
                 SQL-SQPINS
             CALL "SQLADR" USING
                 SQL-SQHARM(1)
                 SQL-SQPARM
             CALL "SQLADR" USING
                 SQL-SQHARC(1)
                 SQL-SQPARC

             CALL "SQLBEX" USING
                 SQLCTX
                 SQLEXD
                 SQLFPN

             CALL "SQLGSS" USING
                SQLSTATE
                 .
004530*                                                                 
004540*----------------------------------------------------------------*
004550*    ǉmF                                              *
004560*----------------------------------------------------------------*
004570     EVALUATE  SQLCODE                                            
004580        WHEN   萔|rpknj                                   
004590*--<       ǉ >                                             
004600           COMPUTE  v|ó|  =  v|ó|  +  1       
004610        WHEN   OTHER                                              
004620*--<       ǉG[ >                                       
004630           MOVE     -40               TO  v|G[R[h        
004640           PERFORM  G[菈                                
004650     END-EVALUATE.                                                
004660*                                                                 
004670 o͏|dwhs.                                              
004680     EXIT.                                                        
004690******************************************************************
004700*    I                                                    *
004710******************************************************************
004720 I                             SECTION.                    
004730 I|rs`qs.                                            
004740*                                                                 
004750     PERFORM  caN[Y.                                   
004760*                                                                 
004770     PERFORM  caR~bg.                                   
004780*                                                                 
004790     PERFORM  IbZ[Wo.                                 
004800*                                                                 
004810*--< vOI >                                         
004820     MOVE  萔|             TO  PROGRAM-STATUS.         
004830*                                                                 
004840 I|dwhs.                                              
004850     EXIT.                                                        
004860******************************************************************
004870*    IbZ[Wo                                          *
004880******************************************************************
004890 IbZ[Wo                   SECTION.                    
004900 IbZ[Wó|rs`qs.                                  
004910*                                                                 
004920*----------------------------------------------------------------*
004930*    bZ[Wo͏                                      *
004940*----------------------------------------------------------------*
004950     INITIALIZE                       IF-CHOCO001.                
004960     MOVE  "3"                        TO  P|Cxg.     
004970     MOVE  萔|vOhc       TO  P|\[Xhc.       
004980     MOVE  "0"                        TO  P|AR[h.       
004990     MOVE  "D411STK"                  TO  P|e[uhc. 
005000     MOVE  "COUNT"                    TO  P|.         
005010     MOVE  v|́|             TO  P|f[^e.       
005020     MOVE  "xAbvWJ͌"                         
005030                                      TO  P|̑bZ[W. 
005040     CALL  CLOCO001                USING  IF-CHOCO001.            
005050*                                                                 
005060     INITIALIZE                       IF-CHOCO001.                
005070     MOVE  "3"                        TO  P|Cxg.     
005080     MOVE  萔|vOhc       TO  P|\[Xhc.       
005090     MOVE  "0"                        TO  P|AR[h.       
005100     MOVE  "D34HNS"                   TO  P|e[uhc. 
005110     MOVE  "COUNT"                    TO  P|.         
005120     MOVE  v|ó|             TO  P|f[^e.       
005130     MOVE  "ϑDBo͌"         TO  P|̑bZ[W. 
005140     CALL  CLOCO001                USING  IF-CHOCO001.            
005150*                                                                 
005160*----------------------------------------------------------------*
005170*    IbZ[Wo                                          *
005180*----------------------------------------------------------------*
005190     INITIALIZE                       IF-CHOCO001.                
005200     MOVE  "3"                        TO  P|Cxg.     
005210     MOVE  萔|vOhc       TO  P|\[Xhc.       
005220     MOVE  "0"                        TO  P|AR[h.       
005230     MOVE  "END"                      TO  P|.         
005240     MOVE  萔|vO         TO  P|̑bZ[W. 
005250     CALL  CLOCO001                USING  IF-CHOCO001.            
005260*                                                                 
005270 IbZ[Wó|dwhs.                                    
005280     EXIT.                                                        
005290******************************************************************
005300*    caN[Y                                                *
005310******************************************************************
005320 caN[Y                     SECTION.                    
005330 caN[Y|rs`qs.                                    
005340*                                                                 
005350*--< J[\ N[Y >                                          
005360     
      *    EXEC SQL                                                     
005370*       CLOSE  CUR1                                               
005380*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 204 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005390*                                                                 
005400 caN[Y|dwhs.                                      
005410     EXIT.                                                        
005420******************************************************************
005430*    caR~bg                                            *
005440******************************************************************
005450 caR~bg                     SECTION.                    
005460 caR~bg|rs`qs.                                    
005470*                                                                 
005480     
      *    EXEC  SQL                                                    
005490*       COMMIT  WORK  RELEASE                                     
005500*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 219 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005510*                                                                 
005520     INITIALIZE                       IF-CHOCO001.                
005530     MOVE  "3"                        TO  P|Cxg.     
005540     MOVE  萔|vOhc       TO  P|\[Xhc.       
005550     MOVE  "0"                        TO  P|AR[h.       
005560     MOVE  "COMMIT"                   TO  P|.         
005570     MOVE  "R~bg{"             TO  P|̑bZ[W. 
005580     CALL  CLOCO001                USING  IF-CHOCO001.            
005590*                                                                 
005600 caR~bg|dwhs.                                      
005610     EXIT.                                                        
005620******************************************************************
005630*    ca[obN                                        *
005640******************************************************************
005650 ca[obN                 SECTION.                    
005660 ca[obN|rs`qs.                                
005670*                                                                 
005680     
      *    EXEC  SQL                                                    
005690*       ROLLBACK WORK  RELEASE                                    
005700*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 234 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005710*                                                                 
005720     INITIALIZE                       IF-CHOCO001.                
005730     MOVE  "1"                        TO  P|Cxg.     
005740     MOVE  萔|vOhc       TO  P|\[Xhc.       
005750     MOVE  "9"                        TO  P|AR[h.       
005760     MOVE  "ROLLBACK"                 TO  P|.         
005770     MOVE  "[obN{"         TO  P|̑bZ[W. 
005780     CALL  CLOCO001                USING  IF-CHOCO001.            
005790*                                                                 
005800 ca[obN|dwhs.                                  
005810     EXIT.                                                        
005820******************************************************************
005830*    G[                                                  *
005840******************************************************************
005850 G[菈                       SECTION.                    
005860 G[菈|rs`qs.                                      
005870*                                                                 
005880     MOVE  "Y"                        TO v|ُI|tO.    
005890     INITIALIZE                           IF-CHOCO001.            
005900*                                                                 
005910     EVALUATE  v|G[R[h                                   
005920        WHEN  -10                                                 
005930*--<       nq`bkdڑs >                                 
005940           MOVE  "1"                  TO  P|Cxg      
005950           MOVE  萔|vOhc TO  P|\[Xhc        
005960           MOVE  "9"                  TO  P|AR[h        
005970           MOVE  "CONNECT"            TO  P|          
005980           MOVE  SQLCODE              TO  P|f[^e        
005990           MOVE  SQLERRMC             TO  P|̑bZ[W  
006000           CALL  CLOCO001          USING  IF-CHOCO001             
006010*                                                                 
006020        WHEN  -20                                                 
006030*--<       e[uJ[\I[vs >                     
006040           MOVE  "1"                  TO  P|Cxg      
006050           MOVE  萔|vOhc TO  P|\[Xhc        
006060           MOVE  "9"                  TO  P|AR[h        
006070           MOVE  "D32SAK"             TO  P|e[uhc  
006080           MOVE  "OPEN"               TO  P|          
006090           MOVE  SQLCODE              TO  P|f[^e        
006100           MOVE  SQLERRMC             TO  P|̑bZ[W  
006110           CALL  CLOCO001          USING  IF-CHOCO001             
006120*                                                                 
006130        WHEN  -30                                                 
006140*--<       e[uǍs >                                 
006150           MOVE  "1"                  TO  P|Cxg      
006160           MOVE  萔|vOhc TO  P|\[Xhc        
006170           MOVE  "9"                  TO  P|AR[h        
006180           MOVE  "D11STK"             TO  P|e[uhc  
006190           MOVE  "FETCH"              TO  P|          
006200           MOVE  SQLCODE              TO  P|f[^e        
006210           MOVE  SQLERRMC             TO  P|̑bZ[W  
006220           CALL  CLOCO001          USING  IF-CHOCO001             
006230*                                                                 
006240        WHEN  -40                                                 
006250*--<       ϑcaǉs >                                   
006260           MOVE  "1"                  TO  P|Cxg      
006270           MOVE  萔|vOhc TO  P|\[Xhc        
006280           MOVE  "9"                  TO  P|AR[h        
006290           MOVE  "D34HNS"             TO  P|e[uhc  
006300           MOVE  "INSERT"             TO  P|          
006310           MOVE  SQLCODE              TO  P|f[^e        
006320           MOVE  SQLERRMC             TO  P|̑bZ[W  
006330           CALL  CLOCO001          USING  IF-CHOCO001             
006340*                                                                 
006350        WHEN  OTHER                                               
006360           MOVE  "N"                  TO v|ُI|tO     
006370     END-EVALUATE.                                                
006380*                                                                 
006390     IF v|ُI|tO  =  "Y"                              
006400        PERFORM  ca[obN                             
006410*                                                                 
006420        PERFORM  IbZ[Wo                               
006430*                                                                 
006440*--<    vOُĨ^[R[h >                      
006450        MOVE  萔|ُ          TO  PROGRAM-STATUS          
006460*                                                                 
006470        EXIT  PROGRAM                                             
006480     END-IF.                                                      
006490*                                                                 
006500 G[|dwhs.                                            
006510     EXIT.                                                        
006520******************************************************************
006530*                  END OF PROGRAM                                *
006540******************************************************************
