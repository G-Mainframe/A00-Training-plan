000010******************************************************************
000020*         CP(A)                                     *
000030*      1. vO    FYڍs<SUMMIT>                 *
000040*      2. vOID    FCOBIS770                             *
000050*      3. Tv        FYׁAVԍ̔ԃe[u *
000060*                           Ye[uXV           *
000070*      4. 쐬          F  v                               *
000080*      5. 쐬          F2005.04.05                           *
000090******************************************************************
000100*                                                                 
000110******************************************************************
000120*    hcdmshehb`shnm  chuhrhnm              *
000130******************************************************************
000140 IDENTIFICATION                       DIVISION.                   
000150*                                                                 
000160 PROGRAM-ID.                          COBIS770.                   
000170******************************************************************
000180*    dmuhqnmldms        chuhrhnm              *
000190******************************************************************
000200 ENVIRONMENT                          DIVISION.                   
000210******************************************************************
000220*    hmots|ntsots      rdbshnm                *
000230******************************************************************
000240 INPUT-OUTPUT                         SECTION.                    
000250 FILE-CONTROL.                                                    
000260*                                                                 
000270     SELECT         ̓t@C      ASSIGN    TO   U01          
000280     FILE   STATUS    IS     v|                             
000290     ORGANIZATION   IS     LINE       SEQUENTIAL.                 
000300*                                                                 
000310******************************************************************
000320*    c`s`                      chuhrhnm              *
000330******************************************************************
000340 DATA                                 DIVISION.                   
000350******************************************************************
000360*    ehkd                      rdbshnm                *
000370******************************************************************
000380 FILE                                 SECTION.                    
000390*----------------------------------------------------------------*
000400*    ̓t@C                                                *
000410*----------------------------------------------------------------*
000420 FD  ̓t@C                                                 
000430     LABEL  RECORD    IS              STANDARD                    
000440     BLOCK  CONTAINS  0               RECORDS.                    
000450*                                                                 
000460 01  ́|R[h.                                              
000470     COPY   CPBIS165   REPLACING      ==()==  BY  ==́|==.     
000480*                                                                 
000490******************************************************************
000500*  vnqjhmf|rsnq`fd  rdbshnm                *
000510******************************************************************
000520 WORKING-STORAGE                      SECTION.                    
000530*----------------------------------------------------------------*
000540*    zXgϐ`GA                                        *
000550*----------------------------------------------------------------*
000560     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
000570*                                                                 
000580*--< e[uʕϐ >                                           
000590 01  vr|ԍ                   PIC  9(04).                 
000600 01  vr|                     PIC  X(07).                 
000610 01  vr|IP                     PIC  X(02).                 
000620*                                                                 
000630*--< L[GA >                                                 
000640 01  jdx|GA.                                              
000650     03  mdvL[.                                              
000660         05  vr|m|_ԍ       PIC  X(10).                 
000670         05  vr|m|Vԍ     PIC S9(04) COMP-3.          
000680     03  nkcL[.                                              
000690         05  vr|n|_ԍ       PIC  X(10).                 
000700         05  vr|n|Vԍ     PIC S9(04) COMP-3.          
000710*                                                                 
000720*--< nq`bkdʕϐ >                                       
000730     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
000740*	                                                            
000750*--< Vԍ̔ԃe[u >                                     
000760     EXEC  SQL  INCLUDE  IKOTBL010.CBL         END-EXEC.          
000770*                                                                 
000780*--< Ye[u >                                           
000790     EXEC  SQL  INCLUDE  D921SIJ.CBL           END-EXEC.          
000800*                                                                 
000810*--< nq`bkd rpks (SQLCA) >                        
000820     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
000830*                                                                 
000840*                                                                 
000850     EXEC  SQL  END      DECLARE      SECTION  END-EXEC.          
000860*                                                                 
000870*----------------------------------------------------------------*
000880*    vnqjGA                                              *
000890*----------------------------------------------------------------*
000900 01  vnqj|GA.                                            
000910*                                                                 
000920*--< G[p >                                               
000930     03  v|G[R[h             PIC S9(04).                 
000940*                                                                 
000950*--< t@C >                                               
000960     03  v|ԃGA.                                          
000970         05  v|                 PIC  X(02).                 
000980*                                                                 
000990*--< tOAA >                                               
001000     03  tOAA.                                            
001010         05  v|I|tO         PIC  X(01).                 
001020         05  v|ُI|tO     PIC  X(01).                 
001030*                                                                 
001040*--< GA >                                                 
001050     03  GA.                                              
001060         05  v|́|P         PIC  9(09).                 
001070         05  v|́|Q         PIC  9(09).                 
001080         05  v|XV|           PIC  9(09).                 
001090*                                                                 
001100*--< ʏ >                                                   
001110 01  v|ʏ.                                                
001120     03  v|VXet.                                        
001130         05  v|I                 PIC  X(02) VALUE  "20".     
001140         05  v|N               PIC  X(06).                 
001150     03  v|VXe             PIC  X(08).                 
001160     03  v|S                   PIC  X(08) VALUE "IKOPG   ".
001170*                                                                 
001180*----------------------------------------------------------------*
001190*    Tu[`                                              *
001200*----------------------------------------------------------------*
001210 01  CALL-AREA.                                                   
001220*--< ʃOTu[` >                                       
001230     03  CLOCO001                     PIC X(08) VALUE "CLOCO001". 
001240     03  COBCO001                     PIC X(08) VALUE "COBCO001". 
001250*                                                                 
001260*----------------------------------------------------------------*
001270*    bnoẍ                                                *
001280*----------------------------------------------------------------*
001290*--< ʃOpp[^ >                                       
001300 01  IF-CHOCO001.                                                 
001310     COPY  CHOCO001  REPLACING  ==()==  BY  ==P|==.           
001320*                                                                 
001330*----------------------------------------------------------------*
001340*    hmht@CǍTu[`pp^̈                *
001350*----------------------------------------------------------------*
001360 01  PARA-AREA.                                                   
001370     COPY CPBCO001.                                               
001380******************************************************************
001390*    萔pf[^`GA                                      *
001400******************************************************************
001410 CONSTANT                             SECTION.                    
001420 01  萔̈.                                                    
001430     03  萔|vOhc         PIC X(08) VALUE "COBIS770". 
001440     03  萔|vO           PIC X(80)                   
001450                                    VALUE  "Yڍs<SUMMIT>".
001460     03  萔|rpknj             PIC S9(04)  VALUE  ZERO.    
001470     03  萔|rpkdmc           PIC S9(04)  VALUE  0100.    
001480     03  萔|               PIC S9(04)  VALUE  ZERO.    
001490     03  萔|ُ               PIC S9(04)  VALUE  0009.    
001500******************************************************************
001510*    oqnbdctqd            chuhrhnm              *
001520******************************************************************
001530 PROCEDURE                            DIVISION.                   
001540*                                                                 
001550     PERFORM  .                                           
001560*                                                                 
001570     PERFORM  又  UNTIL  v|I|tO  =  "Y".            
001580*                                                                 
001590     PERFORM  I.                                           
001600*                                                                 
001610     STOP     RUN.                                                
001620*                                                                 
001630******************************************************************
001640*                                            <1.0>       *
001650******************************************************************
001660                              SECTION.                    
001670 |rs`qs.                                            
001680*----------------------------------------------------------------*
001690*    JnbZ[Wo͏                          <1.1>       *
001700*----------------------------------------------------------------*
001710     INITIALIZE                       IF-CHOCO001.                
001720     MOVE  "3"                        TO  P|Cxg.     
001730     MOVE  萔|vOhc       TO  P|\[Xhc.       
001740     MOVE  "0"                        TO  P|AR[h.       
001750     MOVE  "START"                    TO  P|.         
001760     MOVE  萔|vO         TO  P|̑bZ[W. 
001770     CALL  CLOCO001                USING  IF-CHOCO001.            
001780*                                                                 
001790*----------------------------------------------------------------*
001800*    Ɨ̈̏l                            <1.2>       *
001810*----------------------------------------------------------------*
001820     MOVE  SPACE                      TO  vnqj|GA.       
001830     INITIALIZE                           vnqj|GA.       
001840*                                                                 
001850*--< bott擾 >                                           
001860     ACCEPT  v|N               FROM  DATE.                 
001870*--< bot擾 >                                           
001880     ACCEPT  v|VXe         FROM  TIME.                 
001890*                                                                 
001900*--< nq`bkdڑ >                                           
001910     PERFORM   nq`bkdڑ.                                  
001920*                                                                 
001930*--< t@CI[v >                                           
001940     PERFORM  t@CI[v.                                   
001950*                                                                 
001960*--< t@CǍ >                                           
001970     PERFORM  t@CǍ.                                   
001980*                                                                 
001990*--< Vԍ̔ >                                             
002000     PERFORM  Vԍ̔.                                     
002010*                                                                 
002020*--< J[\錾 >                                               
002030     PERFORM  J[\錾.                                       
002040*                                                                 
002050*--< e[uJ[\Ǎ>                                        
002060     PERFORM  e[uJ[\Ǎ.                               
002070*                                                                 
002080 |dwhs.                                              
002090*                                                                 
002100******************************************************************
002110*    nq`bkdڑ                                <1.3>       *
002120******************************************************************
002130 nq`bkdڑ                     SECTION.                    
002140 nq`bkdڑ|rs`qs.                                    
002150*                                                                 
002160*--< caڑp擾 >                                   
002170     CALL  COBCO001                USING  PARA-AREA.              
002180*                                                                 
002190     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002200     MOVE  PARA-USERNAME              TO  USERNAME.               
002210     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002220*                                                                 
002230*----------------------------------------------------------------*
002240*    Jnڑ                                                    *
002250*----------------------------------------------------------------*
002260     IF    DB-STRING  =  SPACE                                    
002270        EXEC SQL                                                  
002280           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002290        END-EXEC                                                  
002300     ELSE                                                         
002310        EXEC SQL                                                  
002320           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002330             USING  :DB-STRING                                    
002340        END-EXEC                                                  
002350     END-IF.                                                      
002360*                                                                 
002370*----------------------------------------------------------------*
002380*    ڑmF                                                    *
002390*----------------------------------------------------------------*
002400     EVALUATE  SQLCODE                                            
002410        WHEN   萔|rpknj                                   
002420           CONTINUE                                               
002430        WHEN   OTHER                                              
002440*--<       ڑG[ >                                           
002450           MOVE     -10               TO  v|G[R[h        
002460           PERFORM  G[                                    
002470     END-EVALUATE.                                                
002480*                                                                 
002490 nq`bkdڑ|dwhs.                                      
002500     EXIT.                                                        
002510******************************************************************
002520*    t@CI[v                                <1.4>       *
002530******************************************************************
002540*                                                                 
002550 t@CI[v                     SECTION.                    
002560 t@CI[v|rs`qs.                                    
002570*                                                                 
002580     OPEN  INPUT   ̓t@C.                                  
002590*                                                                 
002600*----------------------------------------------------------------*
002610*    t@CI[vԔ                                    *
002620*----------------------------------------------------------------*
002630     EVALUATE  v|                                           
002640        WHEN  ZERO                                                
002650           CONTINUE                                               
002660        WHEN  OTHER                                               
002670*--<       t@CI[vG[ >                               
002680           MOVE     -20                TO  v|G[R[h       
002690           PERFORM  G[                                    
002700     END-EVALUATE.                                                
002710 t@CI[v|dwhs.                                      
002720     EXIT.                                                        
002730*                                                                 
002740******************************************************************
002750*    t@CǍ                                <1.5>       *
002760******************************************************************
002770 t@CǍ                 SECTION.                        
002780 t@CǍ|rs`qs.                                    
002790*                                                                 
002800     READ  ̓t@C                                           
002810        AT END                                                    
002820           MOVE  "Y"                  TO  v|I|tO        
002830           MOVE  HIGH-VALUE           TO  vr|m|_ԍ      
002840           GO  TO  t@CǍ|dwhs                     
002850     END-READ.                                                    
002860*                                                                 
002870*--< t@CǍԔ >                                       
002880     EVALUATE  v|                                           
002890        WHEN  ZERO                                                
002900*--<       t@C}b`OL[̃Zbg >                       
002910           MOVE  ́|_mn       TO  vr|m|_ԍ      
002920           MOVE  ́|mn       TO  vr|ԍ          
002930           MOVE  ́|jdx| TO  vr|            
002940*--<       t@C͌̉Z >                               
002950           COMPUTE   v|́|P =  v|́|P + 1     
002960        WHEN  OTHER                                               
002970*--<       t@CǍG[ >                                   
002980           MOVE     -30               TO  v|G[R[h        
002990           PERFORM  G[                                    
003000     END-EVALUATE.                                                
003010*                                                                 
003020 t@CǍ|dwhs.                                      
003030     EXIT.                                                        
003040******************************************************************
003050*   Vԍ̔                                   <1.6>       *
003060******************************************************************
003070 Vԍ̔                       SECTION.                    
003080 Vԍ̔ԁ|rs`qs.                                      
003090*                                                                 
003100     EXEC  SQL                                                    
003110        SELECT  Vԍ                                        
003120          INTO :vr|m|Vԍ                              
003130          FROM  IKOTBL010                                         
003140         WHERE  _ԍ = :vr|m|_ԍ                    
003150           AND  ԍ = :vr|ԍ                        
003160	         AND   = :vr|                        
003170     END-EXEC.                                                    
003180*                                                                 
003190*----------------------------------------------------------------*
003200*    Vԍ̔ԓǍmF                                      *
003210*----------------------------------------------------------------*
003220     EVALUATE  SQLCODE                                            
003230        WHEN  萔|rpknj                                    
003240*--<       Vԍ̔Ԍ̉Z >                             
003250           COMPUTE   v|́|Q =  v|́|Q + 1     
003260        WHEN  OTHER                                               
003270*--<       Vԍ̔ԃG[ >                                 
003280           MOVE      -40              TO  v|G[R[h        
003290           PERFORM   G[                                   
003300     END-EVALUATE.                                                
003310*                                                                 
003320 Vԍ̔ԁ|dwhs.                                        
003330     EXIT.                                                        
003340*                                                                 
003350******************************************************************
003360*    J[\錾                                    <1.7>       *
003370******************************************************************
003380 J[\錾                         SECTION.                    
003390 J[\錾|rs`qs.                                        
003400*                                                                 
003410*----------------------------------------------------------------*
003420*    J[\錾                                                 
003430*----------------------------------------------------------------*
003440     EXEC  SQL                                                    
003450        DECLARE CUR1  CURSOR FOR                                  
003460           SELECT  D921SIJ_TBL.L[Q_ԍ                 
003470                  ,D921SIJ_TBL.L[Qԍ                 
003480                  ,D921SIJ_TBL.Q擾z                 
003490                  ,D921SIJ_TBL.З_Qݕ뉿                 
003500		        ,D921SIJ_TBL.ŖQ@뉿               
003510             FROM  D921SIJ_TBL                                    
003520            WHERE  D921SIJ_TBL.L[Q_ԍ > '0'           
003530              AND  D921SIJ_TBL.L[Qԍ > '0'           
003540         ORDER BY  D921SIJ_TBL.L[Q_ԍ                 
003550                  ,D921SIJ_TBL.L[Qԍ                 
003560     END-EXEC.                                                    
003570*                                                                 
003580*----------------------------------------------------------------*
003590*    J[\nodm                                        *
003600*----------------------------------------------------------------*
003610     EXEC  SQL                                                    
003620        OPEN  CUR1                                                
003630     END-EXEC.                                                    
003640*                                                                 
003650*----------------------------------------------------------------*
003660*    J[\nodmmF                                        *
003670*----------------------------------------------------------------*
003680     EVALUATE  SQLCODE                                            
003690        WHEN  萔|rpknj                                    
003700*--<        >                                                 
003710           CONTINUE                                               
003720        WHEN  OTHER                                               
003730*--<       J[\nodmG[ >                               
003740           MOVE -50                   TO  v|G[R[h        
003750           PERFORM  G[                                    
003760     END-EVALUATE.                                                
003770*                                                                 
003780 J[\錾|dwhs.                                          
003790     EXIT.                                                        
003800*                                                                 
003810******************************************************************
003820*    e[uJ[\Ǎ                        <1.8>           *
003830******************************************************************
003840 e[uJ[\Ǎ             SECTION.                        
003850 e[uJ[\Ǎ|rs`qs.                                
003860*                                                                 
003870*--< e[uJ[\Ǎ >                                       
003880     EXEC SQL                                                     
003890         FETCH  CUR1                                              
003900          INTO  :cXQP|L[|_ԍ                     
003910               ,:cXQP|L[|ԍ                     
003920               ,:cXQP||擾z                     
003930               ,:cXQP|З_|ݕ뉿                     
003940		     ,:cXQP|Ŗ|@뉿                   
003950     END-EXEC.
003960*----------------------------------------------------------------*
003970*    e[uJ[\ǍmF                                  *
003980*----------------------------------------------------------------*
003990     EVALUATE   SQLCODE                                           
004000        WHEN   萔|rpknj                                   
004010*--<        >                                                 
004020           CONTINUE                                               
004030        WHEN   萔|rpkdmc                                 
004040*--<       ǍI >                                             
004050           PERFORM  t@CǍ                              
004060        WHEN   OTHER                                              
004070*--<       ǍG[ >                                           
004080           MOVE     -60               TO  v|G[R[h        
004090           PERFORM  G[                                    
004100           PERFORM  t@CǍ                              
004110     END-EVALUATE.                                                
004120*                                                                 
004130 e[uJ[\Ǎ|dwhs.                                  
004140     EXIT.                                                        
004150*                                                                 
004160******************************************************************
004170*    又                                          <2.0>       *
004180******************************************************************
004190 又                               SECTION.                    
004200 又|rs`qs.                                              
004210*                                                                 
004220     EVALUATE  TRUE                                               
004230        WHEN  cXQP|L[|_ԍ < vr|m|_ԍ   
004240	         PERFORM  e[uJ[\Ǎ                      
004250        WHEN  cXQP|L[|_ԍ > vr|m|_ԍ   
004260*--<       Ŷׂ݂̏ꍇ>                                    
004270           IF  vr|m|_ԍ NOT = vr|n|_ԍ        
004280           DISPLAY  "YȂiSĎYׂ̍ځjF" ,      
004290	                  "_ԍ" , vr|m|_ԍ,            
004300                    "ԍ" , vr|ԍ,                
004310	                  "" , vr|                     
004320           END-IF                                                 
004330           PERFORM  t@CǍ                              
004340        WHEN  cXQP|L[|_ԍ = vr|m|_ԍ   
004350           PERFORM  Yƃ}b`O                          
004360*           PERFORM  t@CI[v                              
004370           PERFORM  t@CǍ                              
004380           PERFORM  Vԍ̔                                
004390           PERFORM  J[\錾                                  
004400	         PERFORM  e[uJ[\Ǎ                          
004410     END-EVALUATE.                                                
004420*                                                                 
004430 又|dwhs.                                                
004440     EXIT.                                                        
004450*                                                                 
004460******************************************************************
004470*    Yƃ}b`O                                        *
004480******************************************************************
004490 Yƃ}b`O                 SECTION.                    
004500 Yƃ}b`O|rs`qs.                                
004510*                                                                 
004520 	   EVALUATE  TRUE                                           
004530        WHEN  cXQP|L[|ԍ < vr|m|Vԍ 
004540           PERFORM  e[uJ[\Ǎ                          
004550        WHEN  cXQP|L[|ԍ > vr|m|Vԍ 
004560	         PERFORM  t@CǍ                          
004570        WHEN  cXQP|L[|ԍ = vr|m|Vԍ 
004580           PERFORM  ỸR[hǂݍ                  
004590           PERFORM  Y֘AڍXV                          
004600     END-EVALUATE.                                                
004610*                                                                 
004620 Yƃ}b`O|dwhs.                                  
004630     EXIT.                                                        
004640******************************************************************
004650*    ỸR[hǂݍ                                *
004660******************************************************************
004670 ỸR[hǂݍ         SECTION.                    
004680 ỸR[hǂݍށ|rs`qs.                        
004690*                                                                 
004700*--< NO.91>                                                       
004710     MOVE  ́|tۋ敪|Y   TO                          
004720                               cXQP|ی|tۋ敪.  
004730*                                                                 
004740*--< NO.92>                                                       
004750     STRING  v|I , ́|tۓ|N                      
004760        DELIMITED  BY  SIZE INTO  cXQP|ی|tۓ.     
004770*                                                                 
004780*--< NO.94>                                                       
004790     PERFORM  mnXSڍs.                                   
004800*                                                                 
004810*--< NO.95>                                                       
004820     MOVE  ́|ی           TO                          
004830                                   cXQP|ی|ی.
004840*                                                                 
004850*--< NO.96>                                                       
004860     MOVE  ́|̗L敪         TO                          
004870                                       cXQP|ی|̓.
004880*                                                                 
004890*--< NO.97>                                                       
004900     STRING  v|I , ́|̓|N                      
004910        DELIMITED  BY  SIZE  INTO  cXQP|ی|̓.    
004920*                                                                 
004930*--< NO.98>                                                       
004940     MOVE  ́|یVKp敪     TO                          
004950                                     cXQP|ی|یp.
004960*                                                                 
004970*--< NO.99>                                                       
004980     MOVE  ́|ی         TO                          
004990                                     cXQP|ی|ی.
005000*                                                                 
005010*--< NO.100>                                                      
005020     MOVE  ́|یi         TO                          
005030                                     cXQP|ی|یi.
005040*                                                                 
005050*--< NO.101>                                                      
005060     MOVE  ́|߂ی     TO                          
005070                                   cXQP|ی|Ԗߕی.
005080*                                                                 
005090*--< NO.102>                                                      
005100     MOVE  ́|ی،ԍ     TO                          
005110                             cXQP|ی|ی،ԍ.
005120*                                                                 
005130*--< NO.103>                                                      
005140     MOVE  ́|ی         TO                          
005150                                       cXQP|ی|tۗ.
005160*                                                                 
005170*--< NO.104>                                                      
005180     MOVE  ́|c|p[XpΏۊz      TO           
005190                         cXQP|ی|p[XpΏۊz.
005200*                                                                 
005210*--< NO.105>                                                      
005220     MOVE  ́|ݒuꏊJi                      TO           
005230                               cXQP|ی|ݒuꏊJi.
005240*                                                                 
005250*--< NO.109>                                                      
005260     MOVE  ́|ی|یЃR[h            TO           
005270                           cXQP|Mpی|MpیЃR[h.
005280*                                                                 
005290*--< NO.110>                                                      
005300     MOVE  ́|MpیR[h|@B敪            TO           
005310                             cXQP|Mpی|@BޕރR[h.
005320*                                                                 
005330*--< NO.111>                                                      
005340     STRING  v|I , ́|ʒmt|N                
005350        DELIMITED  BY  SIZE  INTO                                 
005360                               cXQP|Mpی|ʒm.  
005370*                                                                 
005380*--< NO.113>                                                      
005390     MOVE  ́|Mpی           TO                          
005400                                       cXQP|Mpی|ی.
005410*                                                                 
005420*--< NO.114>                                                      
005430     MOVE  ́|Aԍ         TO cXQP|Mpی|.
005440*                                                                 
005450*--< NO.119>                                                      
005460     MOVE  ́|[tR[h         TO                          
005470                         cXQP|Œ莑YŁ|ONx[tR[h.
005480*                                                                 
005490*--< NO.120>                                                      
005500     MOVE  ́|[tR[h         TO                          
005510                               cXQP|Œ莑YŁ|[tR[h.
005520*                                                                 
005530*--< NO.123>                                                      
005540     MOVE  ́|NŊz               TO                          
005550                                     cXQP|Œ莑YŁ|NŊz.
005560*                                                                 
005570     MOVE  ́|ONx]z         TO                          
005580                               cXQP|Œ莑YŁ|ONx]z.
005590*                                                                 
005600*--< NO.125>                                                      
005610     MOVE  ́|ONx_뉿       TO                          
005620                             cXQP|Œ莑YŁ|ONx_뉿.
005630*                                                                 
005640*--< NO.126>                                                      
005650     MOVE  ́|Nx]z         TO                          
005660                               cXQP|Œ莑YŁ|Nx]z.
005670*                                                                 
005680*--< NO.127>                                                      
005690     MOVE  ́|Nx_뉿       TO                          
005700                             cXQP|Œ莑YŁ|Nx_뉿.
005710*                                                                 
005720*--< NO.156>                                                      
005730     PERFORM  mnPTUڍs.                                 
005740*                                                                 
005750*--< NO.157>                                                      
005760     PERFORM  mnPTVڍs.                                 
005770*                                                                 
005780*--< NO.158>                                                      
005790     MOVE  ́|БO뉿       TO                          
005800                                   cXQP|З_|O뉿.
005810*                                                                 
005820*--< NO.159>                                                      
005830     COMPUTE  cXQP|З_|Opz݌v =              
005840              cXQP||擾z - ́|БO뉿.
005850*                                                                 
005860*--< NO.162>                                                      
005870     COMPUTE  cXQP|З_|Opz݌v =              
005880                cXQP||擾z - ́|Ќݕ뉿.
005890*                                                                 
005900*--< NO.163>                                                      
005910     MOVE  ́|Ќݕ뉿         TO                          
005920                                     cXQP|З_|ݕ뉿.
005930*                                                                 
005940*--< NO.164>                                                      
005950     PERFORM  mnPUSڍs.                                 
005960*                                                                 
005970*--< NO.165>                                                      
005980     COMPUTE  cXQP|З_|pz݌v =              
005990                cXQP||擾z - ́|Ќݕ뉿.
006000*                                                                 
006010*--< NO.167>                                                      
006020     MOVE  ́|Гp       TO                          
006030                                   cXQP|З_|pz.
006040*                                                                 
006050*--< NO.168>                                                      
006060     MOVE  ́|З_O뉿   TO                          
006070                                   cXQP|Ǘv|O뉿.
006080*                                                                 
006090*--< NO.169>                                                      
006100     COMPUTE  cXQP|Ǘv|Opz݌v =              
006110          cXQP||擾z - ́|З_O뉿.
006120*                                                                 
006130*--< NO.171>                                                      
006140     COMPUTE  cXQP|Ǘv|Opz݌v =              
006150          cXQP||擾z - ́|З_뉿.
006160*                                                                 
006170*--< NO.172>                                                      
006180     MOVE  ́|З_뉿   TO                          
006190                                     cXQP|Ǘv|ݕ뉿.
006200*                                                                 
006210*--< NO.173>                                                      
006220     COMPUTE  cXQP|Ǘv|pz݌v =              
006230          cXQP||擾z - ́|З_뉿.
006240*                                                                 
006250*--< NO.175>                                                      
006260     COMPUTE  cXQP|Ǘv|pz =                    
006270              ́|З_O뉿 - ́|З_뉿.
006280*                                                                 
006290*--< NO.177>                                                      
006300     MOVE  ́|Ŗ@敪         TO cXQP|Ŗ|p.
006310*                                                                 
006320*--< NO.179>                                                      
006330     MOVE  ́|Ŗ@p       TO                          
006340                                       cXQP|Ŗ|p.
006350*                                                                 
006360*--< NO.180>                                                      
006370     MOVE  ́|Ŗ@ʏp|q TO                          
006380                                   cXQP|Ŗ|ʏpq.
006390*                                                                 
006400*--< NO.181>                                                      
006410     MOVE  ́|Ŗ@ʏp| TO                          
006420                                   cXQP|Ŗ|ʏp.
006430*                                                                 
006440*--< NO.182>                                                      
006450     MOVE  ́|Ŗ@ʏp       TO                          
006460                                       cXQP|Ŗ|ʏp.
006470*                                                                 
006480*--< NO.183>                                                      
006490     MOVE  ́|Ŗ@O뉿@   TO                          
006500                                 cXQP|Ŗ|O{z뉿.
006510*                                                                 
006520*--< NO.184>                                                      
006530     COMPUTE  cXQP|Ŗ|O{z݌v =                    
006540          cXQP||擾z - ́|Ŗ@O뉿@.
006550*                                                                 
006560*--< NO.185>                                                      
006570     MOVE  ́|Ŗ@Jzߊz       TO                          
006580                                   cXQP|Ŗ|OJzߊz.
006590*                                                                 
006600*--< NO.186>                                                      
006610     PERFORM  mnPWUڍs.                                 
006620*                                                                 
006630*--< NO.187>                                                      
006640     MOVE  ́|Ŗ@pxz       TO                          
006650                                   cXQP|Ŗ|pxz.
006660*                                                                 
006670*--< NO.188>                                                      
006680     COMPUTE  cXQP|Ŗ|p{z =                    
006690                  ́|Ŗ@O뉿@ - ́|Ŗ@뉿.
006700*                                                                 
006710*--< NO.189>                                                      
006720     COMPUTE  cXQP|Ŗ|p{z݌v =                
006730                  ́|Ŗ@O뉿@ - ́|Ŗ@뉿.
006740*                                                                 
006750*--< NO.190>                                                      
006760     PERFORM  mnPXOڍs.                                 
006770*                                                                 
006780*--< NO.191>                                                      
006790     MOVE  ́|Ŗ@Jzߊz       TO                          
006800                                   cXQP|Ŗ|pߊz.
006810*                                                                 
006820*--< NO.192>                                                      
006830     PERFORM  mnPXQڍs.                                 
006840*                                                                 
006850*--< NO.193>                                                      
006860     MOVE  ́|Ŗ@뉿       TO                          
006870                                 cXQP|Ŗ|{z뉿.
006880*                                                                 
006890*--< NO.196>                                                      
006900     MOVE  ́|Ŗ@O뉿@   TO                          
006910                                   cXQP|Ŗ|O@뉿.
006920*                                                                 
006930*--< NO.197>                                                      
006940     MOVE  ́|Ŗ@뉿       TO                          
006950                                   cXQP|Ŗ|@뉿.
006960*                                                                 
006970 ỸR[hǂݍށ|dwhs.                          
006980     EXIT.                                                        
006990*                                                                 
007000******************************************************************
007010*    mnDXSڍs                                          *
007020******************************************************************
007030 mnXSڍs                     SECTION.                    
007040 mnXSڍs|rs`qs.                                    
007050     IF  ́|tۓ|I = "0"                                 
007060         MOVE  "19"  TO  vr|IP                             
007070     ELSE                                                         
007080        IF  ́|tۓ|I = "1"                              
007090           MOVE  "20"  TO  vr|IP                           
007100        END-IF                                                    
007110     END-IF.                                                      
007120     STRING  vr|IP , ́|tۓ|N                  
007130        DELIMITED  BY  SIZE INTO                                  
007140                           cXQP|ی|tۊJnN.
007150 mnXSڍs|dwhs.                                      
007160     EXIT.                                                        
007170*                                                                 
007180******************************************************************
007190*    mnDPTUڍs                                        *
007200******************************************************************
007210 mnPTUڍs                   SECTION.                    
007220 mnPTUڍs|rs`qs.                                  
007230     IF  ́|敪 = "0"                                     
007240        MOVE  "0"  TO  cXQP|З_|p~tO         
007250     ELSE                                                         
007260        MOVE  "1"  TO  cXQP|З_|p~tO         
007270     END-IF.                                                      
007280 mnPTUڍs|dwhs.                                    
007290     EXIT.                                                        
007300*                                                                 
007310******************************************************************
007320*    mnDPTVڍs                                        *
007330******************************************************************
007340 mnPTVڍs                   SECTION.                    
007350 mnPTVڍs|rs`qs.                                  
007360     IF  ́||I = "0"                                 
007370        MOVE  "19"  TO  vr|IP                              
007380     ELSE                                                         
007390        IF  ́||I = "1"                              
007400           MOVE  "20"  TO  vr|IP                           
007410        END-IF                                                    
007420     END-IF.                                                      
007430     STRING  vr|IP , ́||N                  
007440        DELIMITED  BY  SIZE INTO                                  
007450                                 cXQP|З_|p~.  
007460 mnPTVڍs|dwhs.                                    
007470     EXIT.                                                        
007480*                                                                 
007490******************************************************************
007500*    mnDPUSڍs                                        *
007510******************************************************************
007520 mnPUSڍs                   SECTION.                    
007530 mnPUSڍs|rs`qs.                                  
007540     IF  cXQP||ptO = "1"                     
007550        MOVE  ́|Ќݕ뉿      TO                          
007560                                    cXQP|З_|p뉿  
007570     ELSE                                                         
007580        MOVE  ZERO  TO  cXQP|З_|p뉿              
007590     END-IF.                                                      
007600 mnPUSڍs|dwhs.                                    
007610     EXIT.                                                        
007620*                                                                 
007630******************************************************************
007640*    mnDPWUڍs                                        *
007650******************************************************************
007660 mnPWUڍs                   SECTION.                    
007670 mnPWUڍs|rs`qs.                                  
007680     IF  (́|Ŗ@O뉿@ - ́|Ŗ@뉿) <      
007690                                            ́|Ŗ@pxz  
007700         COMPUTE  cXQP|Ŗ|Opsz =                
007710                                         ́|Ŗ@pxz -   
007720				     (́|Ŗ@O뉿@ -          
007730                                            ́|Ŗ@뉿) 
007740     ELSE                                                         
007750         MOVE  ZERO  TO  cXQP|Ŗ|Opsz           
007760     END-IF.                                                      
007770 mnPWUڍs|dwhs.                                    
007780     EXIT.                                                        
007790*                                                                 
007800******************************************************************
007810*    mnDPXOڍs                                        *
007820******************************************************************
007830 mnPXOڍs                   SECTION.                    
007840 mnPXOڍs|rs`qs.                                  
007850     IF  ́|pߕsz < ZERO                            
007860        MOVE  ́|pߕsz  TO                          
007870                                  cXQP|Ŗ|psz  
007880     ELSE                                                         
007890        MOVE  ZERO  TO  cXQP|Ŗ|psz            
007900     END-IF.                                                      
007910 mnPXOڍs|dwhs.                                    
007920     EXIT.                                                        
007930*                                                                 
007940******************************************************************
007950*    mnDPXQڍs                                        *
007960******************************************************************
007970 mnPXQڍs                   SECTION.                    
007980 mnPXQڍs|rs`qs.                                  
007990     IF  cXQP||ptO = "1"                     
008000        COMPUTE  cXQP|Ŗ|pւ̐U֊z =             
008010                                   cXQP|З_|ݕ뉿 - 
008020			          cXQP|Ŗ|@뉿        
008030     ELSE                                                         
008040        MOVE  ZERO  TO  cXQP|Ŗ|pւ̐U֊z        
008050     END-IF.                                                      
008060 mnPXQڍs|dwhs.                                    
008070     EXIT.                                                        
008080*                                                                 
008090******************************************************************
008100*YɊ֘AڂXV                                    *
008110******************************************************************
008120 Y֘AڍXV                 SECTION.                    
008130 Y֘AڍXV|rs`qs.                                
008140*                                                                 
008150     EXEC SQL                                                     
008160      UPDATE  D921SIJ_TBL                                         
008170         SET                                                      
008180        یQtۋ敪 = :cXQP|ی|tۋ敪
008190       ,یQtۓ = :cXQP|ی|tۓ            
008200       ,یQtۊJnN =                            
008210                           :cXQP|ی|tۊJnN
008220       ,یQی = :cXQP|ی|ی    
008230       ,یQ̗L = :cXQP|ی|̗L        
008240       ,یQ̓ = :cXQP|ی|̓            
008250       ,یQیp = :cXQP|ی|یp        
008260       ,یQی = :cXQP|ی|ی        
008270       ,یQیi = :cXQP|ی|یi        
008280       ,یQԖߕی = :cXQP|ی|Ԗߕی    
008290       ,یQی،ԍ =                              
008300                             :cXQP|ی|ی،ԍ
008310       ,یQtۗ = :cXQP|ی|tۗ            
008320       ,یQp[XpΏۊz =                          
008330                         :cXQP|ی|p[XpΏۊz
008340       ,یQݒuꏊJi =                                
008350                               :cXQP|ی|ݒuꏊJi
008360       ,MpیQMpیЃR[h =                            
008370                           :cXQP|Mpی|MpیЃR[h
008380       ,MpیQ@BޕރR[h =                              
008390                           :cXQP|Mpی|@BޕރR[h  
008400       ,MpیQʒm = :cXQP|Mpی|ʒm
008410       ,MpیQی = :cXQP|Mpی|ی            
008420       ,MpیQ = :cXQP|Mpی|                
008430       ,Œ莑YŁQONx[tR[h =                          
008440                         :cXQP|Œ莑YŁ|ONx[tR[h
008450       ,Œ莑YŁQ[tR[h =                                
008460                               :cXQP|Œ莑YŁ|[tR[h
008470       ,Œ莑YŁQNŊz = :cXQP|Œ莑YŁ|NŊz        
008480       ,Œ莑YŁQONx]z =                                
008490                               :cXQP|Œ莑YŁ|ONx]z
008500       ,Œ莑YŁQONx_뉿 =                              
008510                             :cXQP|Œ莑YŁ|ONx_뉿
008520       ,Œ莑YŁQNx]z =                                
008530                               :cXQP|Œ莑YŁ|Nx]z
008540       ,Œ莑YŁQNx_뉿 =                              
008550                             :cXQP|Œ莑YŁ|Nx_뉿
008560       ,З_Qp~tO =                                
008570                               :cXQP|З_|p~tO
008580       ,З_Qp~ = :cXQP|З_|p~    
008590       ,З_QO뉿 = :cXQP|З_|O뉿    
008600       ,З_QOpz݌v =                              
008610                             :cXQP|З_|Opz݌v
008620       ,З_QOpz݌v =                              
008630                             :cXQP|З_|Opz݌v
008640       ,З_Qݕ뉿 = :cXQP|З_|ݕ뉿        
008650       ,З_Qp뉿 = :cXQP|З_|p뉿        
008660       ,З_Qpz݌v =                              
008670                             :cXQP|З_|pz݌v
008680       ,З_Qpz = :cXQP|З_|pz    
008690       ,ǗvQO뉿 = :cXQP|Ǘv|O뉿    
008700       ,ǗvQOpz݌v =                              
008710                             :cXQP|Ǘv|Opz݌v
008720       ,ǗvQOpz݌v =                              
008730                             :cXQP|Ǘv|Opz݌v
008740       ,ǗvQݕ뉿 = :cXQP|Ǘv|ݕ뉿        
008750       ,ǗvQpz݌v =                              
008760                             :cXQP|Ǘv|pz݌v
008770       ,ǗvQpz = :cXQP|Ǘv|pz    
008780       ,ŖQp = :cXQP|Ŗ|p                
008790       ,ŖQp = :cXQP|Ŗ|p            
008800       ,ŖQʏpq = :cXQP|Ŗ|ʏpq    
008810       ,ŖQʏp = :cXQP|Ŗ|ʏp    
008820       ,ŖQʏp = :cXQP|Ŗ|ʏp            
008830       ,ŖQO{z뉿 = :cXQP|Ŗ|O{z뉿
008840       ,ŖQO{z݌v = :cXQP|Ŗ|O{z݌v    
008850       ,ŖQOJzߊz = :cXQP|Ŗ|OJzߊz    
008860       ,ŖQOpsz = :cXQP|Ŗ|Opsz    
008870       ,ŖQpxz = :cXQP|Ŗ|pxz    
008880       ,ŖQp{z = :cXQP|Ŗ|p{z    
008890       ,ŖQp{z݌v =                                
008900                               :cXQP|Ŗ|p{z݌v
008910       ,ŖQpsz = :cXQP|Ŗ|psz    
008920       ,ŖQpߊz = :cXQP|Ŗ|pߊz    
008930       ,ŖQpւ̐U֊z =                                
008940                               :cXQP|Ŗ|pւ̐U֊z
008950       ,ŖQ{z뉿 = :cXQP|Ŗ|{z뉿
008960       ,ŖQO@뉿 = :cXQP|Ŗ|O@뉿    
008970       ,ŖQ@뉿 = :cXQP|Ŗ|@뉿    
008980     WHERE  L[Q_ԍ = :vr|m|_ԍ              
008990	     AND  L[Qԍ = :vr|m|Vԍ        
009000     END-EXEC.                                                    
009010*                                                                 
009020     EVALUATE  SQLCODE                                            
009030        WHEN  萔|rpknj                                    
009040*--<       Y֘AڍXV >                             
009050           COMPUTE  v|XV| = v|XV| + 1           
009060        WHEN  OTHER                                               
009070*--<       Y֘AڍXV[ >                             
009080           MOVE -70                   TO  v|G[R[h        
009090           PERFORM  ca[obN                          
009100           PERFORM  G[                                    
009110     END-EVALUATE.                                                
009120*                                                                 
009130 Y֘AڍXV|dwhs.                                  
009140     EXIT.                                                        
009150*                                                                 
009160******************************************************************
009170*    I                                        <3.0>       *
009180******************************************************************
009190 I                             SECTION.                    
009200 I|rs`qs.                                            
009210*                                                                 
009220*----------------------------------------------------------------*
009230*    t@CN[Y                                <3.1>       *
009240*----------------------------------------------------------------*
009250     CLOSE  ̓t@C.                                         
009260*                                                                 
009270     PERFORM  caN[Y.                                   
009280*                                                                 
009290     PERFORM  caR~bg.                                   
009300*                                                                 
009310     PERFORM  bZ[Wo.                                 
009320*                                                                 
009330     PERFORM  IbZ[Wo.                                 
009340*                                                                 
009350*--< vOI >                                         
009360     MOVE  萔|             TO  PROGRAM-STATUS.         
009370*                                                                 
009380 I|dwhs.                                              
009390     EXIT.                                                        
009400******************************************************************
009410*    caN[Y                                    <3.2>       *
009420******************************************************************
009430 caN[Y                     SECTION.                    
009440 caN[Y|rs`qs.                                    
009450*                                                                 
009460*--< J[\ N[Y >                                          
009470     EXEC SQL                                                     
009480        CLOSE  CUR1                                               
009490     END-EXEC.                                                    
009500                                                                  
009510 caN[Y|dwhs.                                      
009520     EXIT.                                                        
009530                                                                  
009540******************************************************************
009550*    caR~bg                                <3.3>       *
009560******************************************************************
009570 caR~bg                     SECTION.                    
009580 caR~bg|rs`qs.                                    
009590*                                                                 
009600     EXEC  SQL                                                    
009610        COMMIT  WORK  RELEASE                                     
009620     END-EXEC.                                                    
009630*                                                                 
009640     INITIALIZE                       IF-CHOCO001.                
009650     MOVE  "3"                        TO  P|Cxg.     
009660     MOVE  萔|vOhc       TO  P|\[Xhc.       
009670     MOVE  "0"                        TO  P|AR[h.       
009680     MOVE  "COMMIT"                   TO  P|.         
009690     MOVE  "R~bg{"             TO  P|̑bZ[W. 
009700     CALL  CLOCO001                USING  IF-CHOCO001.            
009710*                                                                 
009720 caR~bg|dwhs.                                      
009730     EXIT.                                                        
009740*                                                                 
009750******************************************************************
009760*    ca[obN                                        *
009770******************************************************************
009780 ca[obN                 SECTION.                    
009790 ca[obN|rs`qs.                                
009800*                                                                 
009810     EXEC  SQL                                                    
009820        ROLLBACK WORK  RELEASE                                    
009830     END-EXEC.                                                    
009840*                                                                 
009850     INITIALIZE                       IF-CHOCO001.                
009860     MOVE  "1"                        TO  P|Cxg.     
009870     MOVE  萔|vOhc       TO  P|\[Xhc.       
009880     MOVE  "9"                        TO  P|AR[h.       
009890     MOVE  "ROLLBACK"                 TO  P|.         
009900     MOVE  "[obN{"         TO  P|̑bZ[W. 
009910     CALL  CLOCO001                USING  IF-CHOCO001.            
009920*                                                                 
009930 ca[obN|dwhs.                                  
009940     EXIT.                                                        
009950*                                                                 
009960******************************************************************
009970*    bZ[Wo͏                          <3.4>       *
009980******************************************************************
009990 bZ[Wo                   SECTION.                    
010000 bZ[Wó|rs`qs.                                  
010010*                                                                 
010020     INITIALIZE                       IF-CHOCO001.                
010030     MOVE  "3"                        TO  P|Cxg.     
010040     MOVE  萔|vOhc       TO  P|\[Xhc.       
010050     MOVE  "0"                        TO  P|AR[h.       
010060     MOVE  "IKOTBL010"                TO  P|e[uhc. 
010070     MOVE  "COUNT"                    TO  P|.         
010080     MOVE  v|́|Q           TO  P|f[^e.       
010090     MOVE  "Vԍ̔ԃe[uǍ"                       
010100                                      TO  P|̑bZ[W. 
010110     CALL  CLOCO001                USING  IF-CHOCO001.            
010120*                                                                 
010130     INITIALIZE                       IF-CHOCO001.                
010140     MOVE  "3"                        TO  P|Cxg.     
010150     MOVE  萔|vOhc       TO  P|\[Xhc.       
010160     MOVE  "0"                        TO  P|AR[h.       
010170     MOVE  "FFUIS772"                 TO  P|e[uhc. 
010180     MOVE  "COUNT"                    TO  P|.         
010190     MOVE  v|́|P           TO  P|f[^e.       
010200     MOVE  "YדǓǍ"       TO  P|̑bZ[W. 
010210     CALL  CLOCO001                USING  IF-CHOCO001.            
010220*                                                                 
010230     INITIALIZE                       IF-CHOCO001.                
010240     MOVE  "3"                        TO  P|Cxg.     
010250     MOVE  萔|vOhc       TO  P|\[Xhc.       
010260     MOVE  "0"                        TO  P|AR[h.       
010270     MOVE  "D921SIJ"                  TO  P|e[uhc. 
010280     MOVE  "COUNT"                    TO  P|.         
010290     MOVE  v|XV|             TO  P|f[^e.       
010300     MOVE  "Ye[uXV" TO  P|̑bZ[W. 
010310     CALL  CLOCO001                USING  IF-CHOCO001.            
010320*                                                                 
010330 bZ[Wó|dwhs.                                    
010340     EXIT.                                                        
010350*                                                                 
010360******************************************************************
010370*    IbZ[Wo                              <3.5>       *
010380******************************************************************
010390 IbZ[Wo                   SECTION.                    
010400 IbZ[Wó|rs`qs.                                  
010410*                                                                 
010420     INITIALIZE                       IF-CHOCO001.                
010430     MOVE  "3"                        TO  P|Cxg.     
010440     MOVE  萔|vOhc       TO  P|\[Xhc.       
010450     MOVE  "0"                        TO  P|AR[h.       
010460     MOVE  "END"                      TO  P|.         
010470     MOVE  萔|vO         TO  P|̑bZ[W. 
010480     CALL  CLOCO001                USING  IF-CHOCO001.            
010490*                                                                 
010500 IbZ[Wó|dwhs.                                    
010510     EXIT.                                                        
010520*                                                                 
010530******************************************************************
010540*    G[                                          <4.0>   *
010550******************************************************************
010560 G[                           SECTION.                    
010570 G[|rs`qs.                                          
010580*                                                                 
010590     MOVE  "Y"                        TO  v|ُI|tO.   
010600     INITIALIZE                       IF-CHOCO001.                
010610*                                                                 
010620     EVALUATE  v|G[R[h                                   
010630        WHEN  -10                                                 
010640*--<       nq`bkdڑs >                                 
010650           MOVE  "1"                  TO  P|Cxg      
010660           MOVE  萔|vOhc TO  P|\[Xhc        
010670           MOVE  "9"                  TO  P|AR[h        
010680           MOVE  "CONNECT"            TO  P|          
010690           MOVE  SQLCODE              TO  P|f[^e        
010700           MOVE  SQLERRMC             TO  P|̑bZ[W  
010710           CALL  CLOCO001          USING  IF-CHOCO001             
010720*                                                                 
010730        WHEN  -20                                                 
010740*--<       ̓t@CI[vG[ >                           
010750           MOVE  "1"                  TO  P|Cxg      
010760           MOVE  萔|vOhc TO  P|\[Xhc        
010770           MOVE  "9"                  TO  P|AR[h        
010780           MOVE  "FFUIS772"           TO  P|e[uhc  
010790           MOVE  "OPEN"               TO  P|          
010800           MOVE  v|             TO  P|f[^e        
010810           MOVE  "Y()t@CI[vG["           
010820                                      TO  P|̑bZ[W  
010830           CALL  CLOCO001          USING  IF-CHOCO001             
010840*                                                                 
010850        WHEN  -30                                                 
010860*--<       t@CǍG[>                                    
010870           MOVE  "1"                  TO  P|Cxg      
010880           MOVE  萔|vOhc TO  P|\[Xhc        
010890           MOVE  "9"                  TO  P|AR[h        
010900           MOVE  "FFUI772"            TO  P|e[uhc  
010910           MOVE  "READ"               TO  P|          
010920           MOVE  v|             TO  P|f[^e        
010930           MOVE  "Y()t@CǍG["               
010940                                      TO  P|̑bZ[W  
010950           CALL  CLOCO001          USING  IF-CHOCO001             
010960*                                                                 
010970        WHEN  -40                                                 
010980*--<       Vԍ̔Ԏs >                                   
010990           MOVE  "2"                  TO  P|Cxg      
011000           MOVE  萔|vOhc TO  P|\[Xhc        
011010           MOVE  "9"                  TO  P|AR[h        
011020           MOVE  "IKOTBL010"          TO  P|e[uhc  
011030           MOVE  "SELECT"             TO  P|          
011040           MOVE  SQLCODE              TO  P|f[^e        
011050           MOVE  SQLERRMC             TO  P|̑bZ[W  
011060           CALL  CLOCO001          USING  IF-CHOCO001             
011070           MOVE  "N"                  TO  v|ُI|tO    
011080*                                                                 
011090        WHEN  -50                                                 
011100*--<       uJ[\I[vs >                             
011110           MOVE  "1"                  TO  P|Cxg      
011120           MOVE  萔|vOhc TO  P|\[Xhc        
011130           MOVE  "9"                  TO  P|AR[h        
011140           MOVE  "D921SIJ"            TO  P|e[uhc  
011150           MOVE  "OPEN"               TO  P|          
011160           MOVE  SQLCODE              TO  P|f[^e        
011170           MOVE  SQLERRMC             TO  P|̑bZ[W  
011180           CALL  CLOCO001          USING  IF-CHOCO001             
011190*                                                                 
011200        WHEN  -60                                                 
011210*--<       e[uJ[\ǍG[ >                           
011220           MOVE  "2"                  TO  P|Cxg      
011230           MOVE  萔|vOhc TO  P|\[Xhc        
011240           MOVE  "9"                  TO  P|AR[h        
011250           MOVE  "D921SIJ"            TO  P|e[uhc  
011260           MOVE  "FETCH"              TO  P|          
011270           MOVE  SQLCODE              TO  P|f[^e        
011280           MOVE  SQLERRMC             TO  P|̑bZ[W  
011290           CALL  CLOCO001          USING  IF-CHOCO001             
011300           MOVE  "N"                  TO  v|ُI|tO    
011310*                                                                 
011320        WHEN  -70                                                 
011330*--<       Y֘AڍXVs >                             
011340           MOVE  "2"                  TO  P|Cxg      
011350           MOVE  萔|vOhc TO  P|\[Xhc        
011360           MOVE  "9"                  TO  P|AR[h        
011370           MOVE  "D921SIJ"            TO  P|e[uhc  
011380           MOVE  "UPDATE"             TO  P|          
011390           MOVE  SQLCODE              TO  P|f[^e        
011400           MOVE  SQLERRMC             TO  P|̑bZ[W  
011410           CALL  CLOCO001          USING  IF-CHOCO001             
011420           MOVE  "N"                  TO  v|ُI|tO    
011430*                                                                 
011440        WHEN  OTHER                                               
011450           MOVE  "N"                  TO  v|ُI|tO    
011460     END-EVALUATE.                                                
011470*                                                                 
011480     IF  v|ُI|tO  =  "Y"                             
011490*----------------------------------------------------------------*
011500*    IbZ[Wo͏                                      *
011510*----------------------------------------------------------------*
011520        PERFORM  caN[Y                                 
011530*                                                                 
011540        PERFORM  bZ[Wo                               
011550*                                                                 
011560        PERFORM  IbZ[Wo                               
011570*--<    vO^[R[h >                                
011580        MOVE  萔|ُ          TO  PROGRAM-STATUS          
011590        EXIT  PROGRAM                                             
011600     END-IF.                                                      
011610*                                                                 
011620 G[|dwhs.                                            
011630      EXIT.                                                       
011640******************************************************************
011650*                  END OF PROGRAM                                *
011660******************************************************************
