000010******************************************************************
000020*         ÅÉäCãPìÓåè(ëÂòA)ÅÑ                                     *
000030*      1. ÉvÉçÉOÉâÉÄñº  : ïœë•ï•ì]à⁄çsèàóù                       *
000040*      2. ÉvÉçÉOÉâÉÄID  : COBIS410                               *
000050*      3. èàóùäTóv      : ïœë•ï•ÇÃì]ÉäÅ[ÉXÉfÅ[É^ÇçÏê¨Ç∑ÇÈÅB     *
000060*                                                                *
000070*      4. çÏê¨é“        : â§åR                                   *
000080*      5. çÏê¨ì˙        : 2005.04.04                             *
000090******************************************************************
000100*                                                                 
000110******************************************************************
000120*    ÇhÇcÇdÇmÇsÇhÇeÇhÇbÇ`ÇsÇhÇnÇm  ÇcÇhÇuÇhÇrÇhÇnÇm              *
000130******************************************************************
000140 IDENTIFICATION                       DIVISION.                   
000150*                                                                 
000160 PROGRAM-ID.                          COBIS410.                   
000170******************************************************************
000180*    ÇdÇmÇuÇhÇqÇnÇmÇlÇdÇmÇs        ÇcÇhÇuÇhÇrÇhÇnÇm              *
000190******************************************************************
000200 ENVIRONMENT                          DIVISION.                   
000210******************************************************************
000220*    ÇhÇmÇoÇtÇsÅ|ÇnÇtÇsÇoÇtÇs      ÇrÇdÇbÇsÇhÇnÇm                *
000230******************************************************************
000240 INPUT-OUTPUT                         SECTION.                    
000250*                                                                 
000260 FILE-CONTROL.                                                    
000270     SELECT    ì¸óÕÉtÉ@ÉCÉãÇP         ASSIGN    TO     U01        
000280     FILE      STATUS     IS          ÇvÅ|èÛë‘                    
000290     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000300*                                                                 
000310     SELECT    ì¸óÕÉtÉ@ÉCÉãÇQ         ASSIGN    TO     U02        
000320     FILE      STATUS     IS          ÇvÅ|èÛë‘                    
000330     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000340*                                                                 
000350******************************************************************
000360*    ÇcÇ`ÇsÇ`                      ÇcÇhÇuÇhÇrÇhÇnÇm              *
000370******************************************************************
000380 DATA                                 DIVISION.                   
000390******************************************************************
000400*    ÇeÇhÇkÇd                      ÇrÇdÇbÇsÇhÇnÇm                *
000410******************************************************************
000420 FILE                                 SECTION.                    
000430*----------------------------------------------------------------*
000440*    èoóÕÉtÉ@ÉCÉã                                                *
000450*----------------------------------------------------------------*
000460 FD  ì¸óÕÉtÉ@ÉCÉãÇP                                               
000470     LABEL     RECORD     IS          STANDARD                    
000480     BLOCK     CONTAINS   0           RECORDS.                    
000490*                                                                 
000500 01  ì¸óÕÇPÅ|ÉåÉRÅ[Éh.                                            
000510     COPY  CPBIS043  REPLACING  ==()==  BY  ==ì¸óÕÇPÅ|==.         
000520*                                                                 
000530 FD  ì¸óÕÉtÉ@ÉCÉãÇQ                                               
000540     LABEL     RECORD     IS          STANDARD                    
000550     BLOCK     CONTAINS   0           RECORDS.                    
000560*                                                                 
000570 01  ì¸óÕÇQÅ|ÉåÉRÅ[Éh.                                            
000580     COPY  CPBIS042  REPLACING  ==()==  BY  ==ì¸óÕÇQÅ|==.         
000590*                                                                 
000600******************************************************************
000610*  ÇvÇnÇqÇjÇhÇmÇfÅ|ÇrÇsÇnÇqÇ`ÇfÇd  ÇrÇdÇbÇsÇhÇnÇm                *
000620******************************************************************
000630  WORKING-STORAGE                     SECTION.                    
000640*----------------------------------------------------------------*
000650*    ÉzÉXÉgïœêîíËã`ÉGÉäÉA                                        *
000660*----------------------------------------------------------------*
000670     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +12.
           02  SQLFPN-FILENAME PIC X(12) VALUE "COBIS410.PCO".

       01  SQ0001 GLOBAL.
           02  FILLER PIC X(134) VALUE "select çƒÉäÅ[ÉXâÒêî  ,å_ñÒéÌóﬁ  
      -     " into :b1,:b2  from IKOTBL002 where ((å_ñÒÇmÇn=:b3 and çƒÉä
      -    "Å[ÉXÉRÅ[Éh=:b4) and ç¬ñ±ä®íËèàóùÉRÅ[Éh=:b5)".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(160) VALUE "insert into D343HTN_TBL(å_ñÒî‘çÜ
      -    ",çƒÉäÅ[ÉXâÒêî,å_ñÒéÌóﬁ,äJénâÒ,äJénîNåé,èIóπâÒ,èIóπîNåé,ã‡äz,
      -     "è¡îÔê≈,çXêVîNåéì˙,çXêVéûä‘,çXêVé“,ì¸óÕíSìñé“ÉRÅ[Éh,ìoò^îNåé
      -    "ì˙,ìoò^éû".

           02  FILLER PIC X(94) VALUE "ä‘,ìoò^íSìñé“) values (:b1,:b2,:b
      -    "3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,:b16
      -    ")".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +287781.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +16.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 16 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 16 TIMES.


       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +272.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +276.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +134.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +496.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +153.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +153.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +102.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +254.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +603.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +16.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +181.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +12.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +690.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +196.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +14.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +32.
           02     FILLER PIC S9(4) COMP-5 VALUE +710.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000680*                                                                 
000690*--< ç¬ñ±å_ñÒÇmÇn>                                                
000700 01  ÇvÇrÅ|ç¬ñ±å_ñÒÇmÇn               PIC  X(09).                 
000710*--< çƒÉäÅ[ÉXÉRÅ[Éh>                                              
000720 01  ÇvÇrÅ|çƒÉäÅ[ÉXÉRÅ[Éh             PIC  9(01).                 
000730*--< ç¬ñ±ä®íËèàóùÉRÅ[Éh>                                          
000740 01  ÇvÇrÅ|ç¬ñ±ä®íËèàóùÉRÅ[Éh         PIC  9(02).                 
000750*                                                                 
000760*--< ÇnÇqÇ`ÇbÇkÇdã§í ïœêî >                                       
000770     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
000780*                                                                 
000790*--< ÇnÇqÇ`ÇbÇkÇd  ÇrÇpÇké¿çsèÓïÒ >                               
000010*--ÅÉÇrÇpÇkã§í ïœêîÅÑ
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000800     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000810*                                                                 
000820*--< ïœë•ï•ì]ÉåÉRÅ[Éh>                                            
000830     
      *    EXEC  SQL  INCLUDE  D343HTN.CBL           END-EXEC.
000840*                                                                 
000850*--< å_ñÒéÌóﬁìôïœä∑ÉeÅ[ÉuÉã>                                      
      *****************************************************************
      *   ïœë•ï•ì](D343HTN_TBL)
      *****************************************************************
       01  ïœë•ï•ì].
           03  ÇcÇRÇSÇRÅ|å_ñÒî‘çÜ    PIC  X(010).
           03  ÇcÇRÇSÇRÅ|çƒÉäÅ[ÉXâÒêî
                                     PIC S9(002) PACKED-DECIMAL.
           03  ÇcÇRÇSÇRÅ|å_ñÒéÌóﬁ    PIC  X(003).
           03  ÇcÇRÇSÇRÅ|äJénâÒ      PIC S9(003) PACKED-DECIMAL.
           03  ÇcÇRÇSÇRÅ|äJénîNåé    PIC  X(006).
           03  ÇcÇRÇSÇRÅ|èIóπâÒ      PIC S9(003) PACKED-DECIMAL.
           03  ÇcÇRÇSÇRÅ|èIóπîNåé    PIC  X(006).
           03  ÇcÇRÇSÇRÅ|ã‡äz        PIC S9(013) PACKED-DECIMAL.
           03  ÇcÇRÇSÇRÅ|è¡îÔê≈      PIC S9(013) PACKED-DECIMAL.
           03  ÇcÇRÇSÇRÅ|çXêVîNåéì˙  PIC  X(008).
           03  ÇcÇRÇSÇRÅ|çXêVéûä‘    PIC  X(008).
           03  ÇcÇRÇSÇRÅ|çXêVé“      PIC  X(008).
           03  ÇcÇRÇSÇRÅ|ì¸óÕíSìñé“ÉRÅ[Éh
                                     PIC  X(008).
           03  ÇcÇRÇSÇRÅ|ìoò^îNåéì˙  PIC  X(008).
           03  ÇcÇRÇSÇRÅ|ìoò^éûä‘    PIC  X(008).
           03  ÇcÇRÇSÇRÅ|ìoò^íSìñé“  PIC  X(008).
000860     
      *    EXEC  SQL  INCLUDE  IKOTBL002.CBL         END-EXEC.
000870*                                                                 
000010************************************************
000020* å_ñÒéÌóﬁìôïœä∑ÉeÅ[ÉuÉã(IKOTBL002)
000030************************************************
000040 01  ÇhÇjÇnÇOÇOÇQÅ|å_ñÒÇmÇn PIC  X(009).
000050 01  ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXÉRÅ[Éh PIC S9(001) COMP-3.
000060 01  ÇhÇjÇnÇOÇOÇQÅ|ãåç¬å†ä®íËèàóùÉRÅ[Éh PIC S9(002) COMP-3.
000070 01  ÇhÇjÇnÇOÇOÇQÅ|ãåç¬ñ±ä®íËèàóùÉRÅ[Éh PIC S9(002) COMP-3.
000080 01  ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXâÒêî PIC S9(002) COMP-3.
000090 01  ÇhÇjÇnÇOÇOÇQÅ|ç¬å†ä®íËèàóùÉRÅ[Éh PIC S9(002) COMP-3.
000100 01  ÇhÇjÇnÇOÇOÇQÅ|ç¬ñ±ä®íËèàóùÉRÅ[Éh PIC S9(002) COMP-3.
000110 01  ÇhÇjÇnÇOÇOÇQÅ|å_ñÒéÌóﬁ PIC  X(003).
000120 01  ÇhÇjÇnÇOÇOÇQÅ|éÂå_ñÒãÊï™ PIC  X(001).
000130 01  ÇhÇjÇnÇOÇOÇQÅ|âÒé˚éËèá PIC  X(001).
000880     
      *    EXEC  SQL  END  DECLARE          SECTION  END-EXEC.
000890*----------------------------------------------------------------*
000900*    ÇvÇnÇqÇjÉGÉäÉA                                              *
000910*----------------------------------------------------------------*
000920 01  ÇvÇnÇqÇjÅ|ÉGÉäÉA.                                            
000930*                                                                 
000940*--< ÉèÅ[ÉNÉGÉäÉAçÄñ⁄>                                            
000950     03  ÇvÅ|é¿éxï•äz                 PIC S9(03).                 
000960     03  ÇvÅ|éxï•âÒêîî‘çÜ             PIC S9(04).                 
000970     03  ÇvÅ|éxï•îNåé                 PIC X(6).                   
000980*                                                                 
000990*--< ÉtÉ@ÉCÉãèÛë‘ >                                               
001000     03  ÇvÅ|èÛë‘ÉGÉäÉA.                                          
001010         05  ÇvÅ|èÛë‘                 PIC  X(02).                 
001020*                                                                 
001030*--< èoóÕîªíËóp>                                                  
001040     03  ÇvÅ|èoóÕÉtÉâÉO               PIC  X(01).                 
001050*                                                                 
001060*--< ÉGÉâÅ[îªíËóp >                                               
001070     03  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             PIC S9(04).                 
001080*                                                                 
001090*--< ÉtÉâÉOÉAÉäÉA >                                               
001100     03  ÉtÉâÉOÉAÉäÉA.                                            
001110         05  ÇvÅ|èIóπÅ|ÉtÉâÉOÇP       PIC  X(01).                 
001120         05  ÇvÅ|èIóπÅ|ÉtÉâÉOÇQ       PIC  X(01).                 
001130         05  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     PIC  X(01).                 
001140*                                                                 
001150*--< ÉLÅ[ÉGÉäÉA >                                                 
001160     03  ÇvÅ|ÉLÅ[ÉGÉäÉA.                                          
001170         05  ÇvÅ|ÇjÇdÇxÅ|ç¬ñ±ñæç◊.                                
001180             07  ÇvÅ|ç¬ñ±å_ñÒÇmÇnÇP   PIC  X(10).                 
001190             07  ÇvÅ|çƒÉäÅ[ÉXÉRÅ[ÉhÇP PIC  S9(1).                 
001200             07  ÇvÅ|å_ñÒñæç◊ÇmÇnÇP   PIC  S9(2).                 
001210             07  ÇvÅ|ÉåÉRÅ[ÉhÉVÅ[ÉPÉìÉXÇP                         
001220                                      PIC  S9(1).                 
001230*                                                                 
001240         05  ÇvÅ|ÇjÇdÇxÅ|ç¬ñ±ìWäJ.                                
001250             07  ÇvÅ|ç¬ñ±å_ñÒÇmÇnÇQ   PIC  X(10).                 
001260             07  ÇvÅ|çƒÉäÅ[ÉXÉRÅ[ÉhÇQ PIC  S9(1).                 
001270             07  ÇvÅ|å_ñÒñæç◊ÇmÇnÇQ   PIC  S9(2).                 
001280             07  ÇvÅ|ÉåÉRÅ[ÉhÉVÅ[ÉPÉìÉXÇQ                         
001290                                      PIC  S9(1).                 
001300*                                                                 
001310*--< åèêîÉGÉäÉA >                                                 
001320     03  åèêîÉGÉäÉA.                                              
001330         05  ÇvÅ|ì¸óÕÅ|åèêîÇP         PIC  9(09).                 
001340         05  ÇvÅ|ì¸óÕÅ|åèêîÇQ         PIC  9(09).                 
001350         05  ÇvÅ|èoóÕÅ|åèêî           PIC  9(09).                 
001360*                                                                 
001370*--< ã§í èÓïÒ >                                                   
001380 01  ÇvÅ|ã§í èÓïÒ.                                                
001390     03  ÇvÅ|ÉVÉXÉeÉÄì˙ït.                                        
001400         05  ÇvÅ|ê¢ãI                 PIC  X(02) VALUE  "20".     
001410         05  ÇvÅ|îNåéì˙               PIC  X(06).                 
001420     03  ÇvÅ|ÉVÉXÉeÉÄéûçè             PIC  X(08).                 
001430     03  ÇvÅ|íSìñé“                   PIC  X(08) VALUE "IKOPG   ".
001440*                                                                 
001450*----------------------------------------------------------------*
001460*    ÉTÉuÉãÅ[É`Éìñº                                              *
001470*----------------------------------------------------------------*
001480 01  CALL-AREA.                                                   
001490*--< ã§í ÉçÉOÉTÉuÉãÅ[É`Éì >                                       
001500     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001510     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001520*                                                                 
001530*----------------------------------------------------------------*
001540*    ÇbÇnÇoÇxóÃàÊ                                                *
001550*----------------------------------------------------------------*
001560*--< ã§í ÉçÉOópÉpÉâÉÅÅ[É^ >                                       
001570 01  IF-CHOCO001.                                                 
001580     COPY  CHOCO001  REPLACING  ==()==  BY  ==ã§ÇPÅ|==.           
001590*                                                                 
001600*----------------------------------------------------------------*
001610*    ÇhÇmÇhÉtÉ@ÉCÉãì«çûÉTÉuÉãÅ[É`ÉìópÉpÉâÉÅÉ^óÃàÊ                *
001620*----------------------------------------------------------------*
001630 01  PARA-AREA.                                                   
001640     COPY CPBCO001.                                               
001650******************************************************************
001660*    íËêîópÉfÅ[É^íËã`ÉGÉäÉA                                      *
001670******************************************************************
001680 CONSTANT                             SECTION.                    
001690 01  íËêîóÃàÊ.                                                    
001700     03  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc         PIC  X(08) VALUE "COBIS410".
001710     03  íËêîÅ|ÉvÉçÉOÉâÉÄñº           PIC  X(80) VALUE            
001720                                               "ïœë•ï•ì]à⁄çsèàóù".
001730     03  íËêîÅ|ÇrÇpÇkÇnÇj             PIC S9(04)  VALUE  ZERO.    
001740     03  íËêîÅ|ÇrÇpÇkÇdÇmÇc           PIC S9(04)  VALUE  0100.    
001750     03  íËêîÅ|ê≥èÌèÛë‘               PIC S9(04)  VALUE  ZERO.    
001760     03  íËêîÅ|àŸèÌèÛë‘               PIC S9(04)  VALUE  0009.    
001770******************************************************************
001780*    ÇoÇqÇnÇbÇdÇcÇtÇqÇd            ÇcÇhÇuÇhÇrÇhÇnÇm              *
001790******************************************************************
001800 PROCEDURE                            DIVISION.                   
001810*                                                                 
001820     PERFORM  èâä˙èàóù.                                           
001830*                                                                 
001840     PERFORM  éÂèàóù  UNTIL  ÇvÅ|èIóπÅ|ÉtÉâÉOÇP  =  "Y"           
001850                        AND  ÇvÅ|èIóπÅ|ÉtÉâÉOÇQ  =  "Y".          
001860*                                                                 
001870     PERFORM  èIóπèàóù.                                           
001880*                                                                 
001890     STOP     RUN.                                                
001900*                                                                 
001910******************************************************************
001920*    èâä˙èàóù                                                    *
001930******************************************************************
001940 èâä˙èàóù                             SECTION.                    
001950 èâä˙èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
001960*                                                                 
001970*----------------------------------------------------------------*
001980*    äJénÉÅÉbÉZÅ[ÉWèoóÕèàóù                                  1.1 *
001990*----------------------------------------------------------------*
002000     INITIALIZE                       IF-CHOCO001.                
002010     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
002020     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
002030     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
002040     MOVE  "START"                    TO  ã§ÇPÅ|èàóùéØï .         
002050     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
002060     CALL  CLOCO001                USING  IF-CHOCO001.            
002070*                                                                 
002080*----------------------------------------------------------------*
002090*    çÏã∆óÃàÊÇÃèâä˙ílèàóù                                    1.2 *
002100*----------------------------------------------------------------*
002110     MOVE  SPACE                      TO  ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
002120     INITIALIZE                           ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
002130*                                                                 
002140*--< èoóÕÉåÉRÅ[ÉhÇÃèâä˙âªèàóù >                                   
002150     MOVE  SPACE                      TO  ïœë•ï•ì].               
002160     INITIALIZE                           ïœë•ï•ì].               
002170*                                                                 
002180*--< ÇbÇoÇtì˙ïtÇéÊìæ >                                           
002190     ACCEPT  ÇvÅ|îNåéì˙               FROM  DATE.                 
002200*                                                                 
002210*--< ÇbÇoÇtéûçèÇéÊìæ >                                           
002220     ACCEPT  ÇvÅ|ÉVÉXÉeÉÄéûçè         FROM  TIME.                 
002230*                                                                 
002240*----------------------------------------------------------------*
002250*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                        1.3 *
002260*----------------------------------------------------------------*
002270     PERFORM  ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                                   
002280*----------------------------------------------------------------*
002290*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                                        1.4 *
002300*----------------------------------------------------------------*
002310     PERFORM  ÉtÉ@ÉCÉãÉIÅ[ÉvÉì.                                   
002320*----------------------------------------------------------------*
002330*    ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûèàóùÅiÇPåèñ⁄Åj                      1.5 *
002340*----------------------------------------------------------------*
002350     PERFORM  ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûèàóù.                           
002360*----------------------------------------------------------------*
002370*    ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûèàóùÅiÇPåèñ⁄Åj                      1.6 *
002380*----------------------------------------------------------------*
002390     PERFORM  ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûèàóù.                           
002400*                                                                 
002410*--< ëŒè€íäèoîªíË>                                                
002420     IF    (ì¸óÕÇPÅ|ç¬ñ±ã¶í≤ÉRÅ[Éh = "45"                         
002430        OR  ì¸óÕÇPÅ|ç¬ñ±ã¶í≤ÉRÅ[Éh = "46"                         
002440        OR  ì¸óÕÇPÅ|ç¬ñ±ã¶í≤ÉRÅ[Éh = "55"                         
002450        OR  ì¸óÕÇPÅ|ç¬ñ±ã¶í≤ÉRÅ[Éh = "56")                        
002460        AND    ì¸óÕÇPÅ|åvéZï˚éÆ = "2"                             
002470        CONTINUE                                                  
002480     ELSE                                                         
002490        IF  ÇvÅ|èIóπÅ|ÉtÉâÉOÇP  NOT =  "Y"                        
002500           PERFORM  ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûèàóù                      
002510     END-IF.                                                      
002520*                                                                 
002530 èâä˙èàóùÅ|ÇdÇwÇhÇs.                                              
002540     EXIT.                                                        
002550******************************************************************
002560*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
002570******************************************************************
002580 ÇnÇqÇ`ÇbÇkÇdê⁄ë±                     SECTION.                    
002590 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇrÇsÇ`ÇqÇs.                                    
002600*                                                                 
002610*--< ÇcÇaê⁄ë±ópèÓïÒÇéÊìæèàóù >                                   
002620     CALL  COBCO001                USING  PARA-AREA.              
002630*                                                                 
002640     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002650     MOVE  PARA-USERNAME              TO  USERNAME.               
002660     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002670*                                                                 
002680*----------------------------------------------------------------*
002690*    äJénê⁄ë±                                                    *
002700*----------------------------------------------------------------*
002710     IF    DB-STRING  =  SPACE                                    
002720        
      *       EXEC SQL                                                  
002730*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002740*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002750     ELSE                                                         
002760        
      *       EXEC SQL                                                  
002770*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002780*            USING  :DB-STRING                                    
002790*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002800     END-IF.                                                      
002810*                                                                 
002820*----------------------------------------------------------------*
002830*    ê⁄ë±ämîF                                                    *
002840*----------------------------------------------------------------*
002850     EVALUATE  SQLCODE                                            
002860        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002870           CONTINUE                                               
002880        WHEN   OTHER                                              
002890*--<       ê⁄ë±ÉGÉâÅ[ >                                           
002900           MOVE     -1                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002910           PERFORM  ÉGÉâÅ[èàóù                                    
002920     END-EVALUATE.                                                
002930*                                                                 
002940 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇdÇwÇhÇs.                                      
002950     EXIT.                                                        
002960******************************************************************
002970*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                                            *
002980******************************************************************
002990 ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                     SECTION.                    
003000 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇrÇsÇ`ÇqÇs.                                    
003010*                                                                 
003020*----------------------------------------------------------------*
003030*    ç¬ñ±ñæç◊ÉåÉRÅ[ÉhÇÃÉIÅ[ÉvÉì                                  *
003040*----------------------------------------------------------------*
003050     OPEN  INPUT   ì¸óÕÉtÉ@ÉCÉãÇP.                                
003060*                                                                 
003070*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÇÃèÛë‘îªíË >                                 
003080     EVALUATE  ÇvÅ|èÛë‘                                           
003090        WHEN  ZERO                                                
003100           CONTINUE                                               
003110        WHEN  OTHER                                               
003120*--<       ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                               
003130           MOVE     -2                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003140           PERFORM  ÉGÉâÅ[èàóù                                    
003150     END-EVALUATE.                                                
003160*                                                                 
003170*----------------------------------------------------------------*
003180*    ç¬ñ±ìWäJÉåÉRÅ[ÉhÇÃÉIÅ[ÉvÉì                                  *
003190*----------------------------------------------------------------*
003200     OPEN  INPUT   ì¸óÕÉtÉ@ÉCÉãÇQ.                                
003210*                                                                 
003220*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÇÃèÛë‘îªíË >                                 
003230     EVALUATE  ÇvÅ|èÛë‘                                           
003240        WHEN  ZERO                                                
003250           CONTINUE                                               
003260        WHEN  OTHER                                               
003270*--<       ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                               
003280           MOVE     -3                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003290           PERFORM  ÉGÉâÅ[èàóù                                    
003300     END-EVALUATE.                                                
003310*                                                                 
003320 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇdÇwÇhÇs.                                      
003330     EXIT.                                                        
003340******************************************************************
003350*    ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûèàóùÅiÇPåèñ⁄Åj                          *
003360******************************************************************
003370 ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûèàóù             SECTION.                    
003380 ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûèàóùÅ|ÇrÇsÇ`ÇqÇs.                            
003390*                                                                 
003400     READ  ì¸óÕÉtÉ@ÉCÉãÇP                                         
003410        AT END                                                    
003420           MOVE  "Y"                  TO  ÇvÅ|èIóπÅ|ÉtÉâÉOÇP      
003430           MOVE  HIGH-VALUE           TO  ÇvÅ|ÇjÇdÇxÅ|ç¬ñ±ñæç◊    
003440           GO    TO   ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûèàóùÅ|ÇdÇwÇhÇs          
003450     END-READ.                                                    
003460*                                                                 
003470*--< ÉtÉ@ÉCÉãì«çûèÛë‘îªíË >                                       
003480     EVALUATE  ÇvÅ|èÛë‘                                           
003490        WHEN  ZERO                                                
003500*--<       ç¬ñ±ñæç◊ÉåÉRÅ[ÉhÉ}ÉbÉ`ÉìÉOÉLÅ[ÇÃÉZÉbÉg >               
003510           MOVE  ì¸óÕÇPÅ|ç¬ñ±å_ñÒÇmÇn                             
003520                                      TO  ÇvÅ|ç¬ñ±å_ñÒÇmÇnÇP      
003530           MOVE  ì¸óÕÇPÅ|çƒÉäÅ[ÉXÉRÅ[Éh                           
003540                                      TO  ÇvÅ|çƒÉäÅ[ÉXÉRÅ[ÉhÇP    
003550           MOVE  ì¸óÕÇPÅ|å_ñÒñæç◊ÇmÇn                             
003560                                      TO  ÇvÅ|å_ñÒñæç◊ÇmÇnÇP      
003570           MOVE  ì¸óÕÇPÅ|ÉåÉRÅ[ÉhÉVÅ[ÉPÉìÉX                       
003580                                      TO  ÇvÅ|ÉåÉRÅ[ÉhÉVÅ[ÉPÉìÉXÇP
003590*--<       ÇrÇpÇkïœêîÇÃÉZÉbÉg>                                    
003600           MOVE  ì¸óÕÇPÅ|ç¬ñ±å_ñÒÇmÇn(2:9)                        
003610                                      TO  ÇvÇrÅ|ç¬ñ±å_ñÒÇmÇn      
003620           MOVE  ì¸óÕÇPÅ|çƒÉäÅ[ÉXÉRÅ[Éh                           
003630                                      TO  ÇvÇrÅ|çƒÉäÅ[ÉXÉRÅ[Éh    
003640           MOVE  ì¸óÕÇPÅ|ç¬ñ±ä®íËèàóùÉRÅ[Éh                       
003650                                      TO  ÇvÇrÅ|ç¬ñ±ä®íËèàóùÉRÅ[Éh
003660*--<       ç¬ñ±ñæç◊ÉåÉRÅ[Éhì¸óÕåèêîÇÃÉJÉEÉìÉg >                   
003670           COMPUTE   ÇvÅ|ì¸óÕÅ|åèêîÇP  =  ÇvÅ|ì¸óÕÅ|åèêîÇP + 1    
003680        WHEN  OTHER                                               
003690*--<       ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûÉGÉâÅ[ >                           
003700           MOVE     -4                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003710           PERFORM  ÉGÉâÅ[èàóù                                    
003720     END-EVALUATE.                                                
003730*                                                                 
003740 ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûèàóùÅ|ÇdÇwÇhÇs.                              
003750     EXIT.                                                        
003760******************************************************************
003770*    ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûèàóùÅiÇPåèñ⁄Åj                          *
003780******************************************************************
003790 ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûèàóù             SECTION.                    
003800 ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûèàóùÅ|ÇrÇsÇ`ÇqÇs.                            
003810*                                                                 
003820     READ  ì¸óÕÉtÉ@ÉCÉãÇQ                                         
003830        AT END                                                    
003840           MOVE  "Y"                  TO  ÇvÅ|èIóπÅ|ÉtÉâÉOÇQ      
003850           MOVE  HIGH-VALUE           TO  ÇvÅ|ÇjÇdÇxÅ|ç¬ñ±ìWäJ    
003860           GO    TO   ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûèàóùÅ|ÇdÇwÇhÇs          
003870     END-READ.                                                    
003880*                                                                 
003890*--< ÉtÉ@ÉCÉãì«çûèÛë‘îªíË >                                       
003900     EVALUATE  ÇvÅ|èÛë‘                                           
003910        WHEN  ZERO                                                
003920*--<       ç¬ñ±ìWäJÉåÉRÅ[ÉhÉ}ÉbÉ`ÉìÉOÉLÅ[ÇÃÉZÉbÉg >               
003930           MOVE  ì¸óÕÇQÅ|ç¬ñ±å_ñÒÇmÇn                             
003940                                      TO  ÇvÅ|ç¬ñ±å_ñÒÇmÇnÇQ      
003950           MOVE  ì¸óÕÇQÅ|çƒÉäÅ[ÉXÉRÅ[Éh                           
003960                                      TO  ÇvÅ|çƒÉäÅ[ÉXÉRÅ[ÉhÇQ    
003970           MOVE  ì¸óÕÇQÅ|å_ñÒñæç◊ÇmÇn                             
003980                                      TO  ÇvÅ|å_ñÒñæç◊ÇmÇnÇQ      
003990           MOVE  ì¸óÕÇQÅ|ÉåÉRÅ[ÉhÉVÅ[ÉPÉìÉX                       
004000                                      TO  ÇvÅ|ÉåÉRÅ[ÉhÉVÅ[ÉPÉìÉXÇQ
004010*--<       ç¬ñ±ìWäJÉåÉRÅ[Éhì¸óÕåèêîÇÃÉJÉEÉìÉg >                   
004020           COMPUTE   ÇvÅ|ì¸óÕÅ|åèêîÇQ  =  ÇvÅ|ì¸óÕÅ|åèêîÇQ + 1    
004030        WHEN  OTHER                                               
004040*--<       ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûÉGÉâÅ[ >                           
004050           MOVE     -5                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004060           PERFORM  ÉGÉâÅ[èàóù                                    
004070     END-EVALUATE.                                                
004080*                                                                 
004090 ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûèàóùÅ|ÇdÇwÇhÇs.                              
004100     EXIT.                                                        
004110******************************************************************
004120*    éÂèàóù                                                      *
004130******************************************************************
004140 éÂèàóù                               SECTION.                    
004150 éÂèàóùÅ|ÇrÇsÇ`ÇqÇs.                                              
004160*                                                                 
004170     EVALUATE  TRUE                                               
004180*--<    ç¬ñ±ñæç◊ÉåÉRÅ[ÉhÇÃÇ›ÇÃèÍçá >                              
004190        WHEN  ÇvÅ|ÇjÇdÇxÅ|ç¬ñ±ñæç◊ > ÇvÅ|ÇjÇdÇxÅ|ç¬ñ±ìWäJ         
004200           MOVE  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ TO  ÇvÅ|éxï•âÒêîî‘çÜ        
004210           MOVE  ì¸óÕÇQÅ|é¿éxï•äz     TO  ÇvÅ|é¿éxï•äz            
004220           MOVE  ì¸óÕÇQÅ|éxï•ÉfÅ[É^çÏê¨ì˙Å|îNåéì˙                 
004230                                      TO  ÇvÅ|éxï•îNåé            
004240           PERFORM  ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûèàóù                      
004250*                                                                 
004260*--<    É}ÉbÉ`ÉìÉOÇÃèÍçá >                                        
004270        WHEN  ÇvÅ|ÇjÇdÇxÅ|ç¬ñ±ñæç◊ = ÇvÅ|ÇjÇdÇxÅ|ç¬ñ±ìWäJ         
004280           PERFORM  É}ÉbÉ`ÉìÉOï“èWèoóÕèàóù                        
004290*                                                                 
004300           MOVE  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ TO  ÇvÅ|éxï•âÒêîî‘çÜ        
004310           MOVE  ì¸óÕÇQÅ|é¿éxï•äz     TO  ÇvÅ|é¿éxï•äz            
004320           MOVE  ì¸óÕÇQÅ|éxï•ÉfÅ[É^çÏê¨ì˙Å|îNåéì˙                 
004330                                      TO  ÇvÅ|éxï•îNåé            
004340           PERFORM  ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûèàóù                      
004350*                                                                 
004360*--<    ç¬ñ±ìWäJÉåÉRÅ[ÉhÇÃÇ›ÇÃèÍçá >                              
004370        WHEN  ÇvÅ|ÇjÇdÇxÅ|ç¬ñ±ñæç◊ < ÇvÅ|ÇjÇdÇxÅ|ç¬ñ±ìWäJ         
004380*                                                                 
004390           IF  ÇvÅ|èoóÕÉtÉâÉO = "N"                               
004400              PERFORM  èoóÕèàóù                                   
004410           END-IF                                                 
004420*                                                                 
004430           PERFORM  ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûèàóù                      
004440*                                                                 
004450     END-EVALUATE.                                                
004460*                                                                 
004470 éÂèàóùÅ|ÇdÇwÇhÇs.                                                
004480     EXIT.                                                        
004490******************************************************************
004500*    É}ÉbÉ`ÉìÉOï“èWèoóÕèàóù                                      *
004510******************************************************************
004520 É}ÉbÉ`ÉìÉOï“èWèoóÕèàóù               SECTION.                    
004530 É}ÉbÉ`ÉìÉOï“èWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                              
004540*                                                                 
004550*--< ïœë•ï•ì]ÉåÉRÅ[ÉhäÓñ{çÄñ⁄ÇÃï“èWèàóù >                         
004560*--<    No.04--No.09 >                                            
004570        PERFORM  ìWäJï“èW.                                        
004580*--<    No.01 >                                                   
004590        MOVE  ì¸óÕÇPÅ|ç¬ñ±å_ñÒÇmÇn    TO  ÇcÇRÇSÇRÅ|å_ñÒî‘çÜ.     
004600*--<    No.02 >                                                   
004610        PERFORM  ã§í èàóù.                                        
004620        MOVE  ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXâÒêî                          
004630                                      TO  ÇcÇRÇSÇRÅ|çƒÉäÅ[ÉXâÒêî. 
004640*--<    No.03 >                                                   
004650        MOVE  ÇhÇjÇnÇOÇOÇQÅ|å_ñÒéÌóﬁ  TO  ÇcÇRÇSÇRÅ|å_ñÒéÌóﬁ.     
004660*--<    No.10 >                                                   
004670        MOVE  ÇvÅ|ÉVÉXÉeÉÄì˙ït        TO  ÇcÇRÇSÇRÅ|çXêVîNåéì˙.   
004680*--<    No.11 >                                                   
004690        MOVE  ÇvÅ|ÉVÉXÉeÉÄéûçè        TO  ÇcÇRÇSÇRÅ|çXêVéûä‘.     
004700*--<    No.12 >                                                   
004710        MOVE  ÇvÅ|íSìñé“              TO  ÇcÇRÇSÇRÅ|çXêVé“.       
004720*--<    No.13 >                                                   
004730        MOVE  ÇvÅ|íSìñé“              TO                          
004740                                       ÇcÇRÇSÇRÅ|ì¸óÕíSìñé“ÉRÅ[Éh.
004750*--<    No.14 >                                                   
004760        MOVE  ÇvÅ|ÉVÉXÉeÉÄì˙ït        TO  ÇcÇRÇSÇRÅ|ìoò^îNåéì˙.   
004770*--<    No.15 >                                                   
004780        MOVE  ÇvÅ|ÉVÉXÉeÉÄéûçè        TO  ÇcÇRÇSÇRÅ|ìoò^éûä‘.     
004790*--<    No.16 >                                                   
004800        MOVE  ÇvÅ|íSìñé“              TO  ÇcÇRÇSÇRÅ|ìoò^íSìñé“.   
004810*                                                                 
004820 É}ÉbÉ`ÉìÉOï“èWèoóÕèàóùÅ|ÇdÇwÇhÇs.                                
004830     EXIT.                                                        
004840******************************************************************
004850*    ã§í èàóù                                                    *
004860******************************************************************
004870 ã§í èàóù                             SECTION.                    
004880 ã§í èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
004890*----------------------------------------------------------------*
004900*    å_ñÒéÌóﬁìôïœä∑ÉeÅ[ÉuÉãì«çû                                  *
004910*----------------------------------------------------------------*
004920*                                                                 
004930     INITIALIZE                       ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXâÒêî. 
004940     INITIALIZE                       ÇhÇjÇnÇOÇOÇQÅ|å_ñÒéÌóﬁ.     
004950*                                                                 
004960     
      *    EXEC SQL                                                     
004970*       SELECT  çƒÉäÅ[ÉXâÒêî                                      
004980*              ,å_ñÒéÌóﬁ                                          
004990*         INTO :ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXâÒêî                        
005000*             ,:ÇhÇjÇnÇOÇOÇQÅ|å_ñÒéÌóﬁ                            
005010*         FROM  IKOTBL002                                         
005020*        WHERE  å_ñÒÇmÇn           = :ÇvÇrÅ|ç¬ñ±å_ñÒÇmÇn          
005030*          AND  çƒÉäÅ[ÉXÉRÅ[Éh     = :ÇvÇrÅ|çƒÉäÅ[ÉXÉRÅ[Éh        
005040*          AND  ç¬ñ±ä®íËèàóùÉRÅ[Éh = :ÇvÇrÅ|ç¬ñ±ä®íËèàóùÉRÅ[Éh    
005050*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ÇhÇjÇnÇOÇOÇQÅ|çƒÉäÅ[ÉXâÒêî
               SQL-SQHSTV(1)
           MOVE 2 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ÇhÇjÇnÇOÇOÇQÅ|å_ñÒéÌóﬁ
               SQL-SQHSTV(2)
           MOVE 3 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ÇvÇrÅ|ç¬ñ±å_ñÒÇmÇn
               SQL-SQHSTV(3)
           MOVE 9 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ÇvÇrÅ|çƒÉäÅ[ÉXÉRÅ[Éh
               SQL-SQHSTV(4)
           MOVE 1 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ÇvÇrÅ|ç¬ñ±ä®íËèàóùÉRÅ[Éh
               SQL-SQHSTV(5)
           MOVE 2 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005060*----------------------------------------------------------------*
005070*    å_ñÒéÌóﬁìôïœä∑ÉeÅ[ÉuÉãåüçıÇämîF                            *
005080*----------------------------------------------------------------*
005090     EVALUATE   SQLCODE                                           
005100        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
005110*--<       ê≥èÌÇÃéû >                                             
005120           CONTINUE                                               
005130        WHEN   OTHER                                              
005140*--<       ë∂ç›ÇµÇ»Ç¢ >                                           
005150           MOVE     -6                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
005160           PERFORM  ÉGÉâÅ[èàóù                                    
005170     END-EVALUATE.                                                
005180*                                                                 
005190 ã§í èàóùÅ|ÇdÇwÇhÇs.                                              
005200     EXIT.                                                        
005210******************************************************************
005220*    ìWäJï“èW                                                    *
005230******************************************************************
005240 ìWäJï“èW                             SECTION.                    
005250 ìWäJï“èWÅ|ÇrÇsÇ`ÇqÇs.                                            
005260*                                                                 
005270     IF  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ = 1                                 
005280*--<    No.04>                                                    
005290        MOVE  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ    TO  ÇcÇRÇSÇRÅ|äJénâÒ        
005300*--<    No.05>                                                    
005310        MOVE  ì¸óÕÇQÅ|éxï•ÉfÅ[É^çÏê¨ì˙Å|îNåéì˙                    
005320                                      TO  ÇcÇRÇSÇRÅ|äJénîNåé      
005330*--<    No.06>                                                    
005340        MOVE  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ    TO  ÇcÇRÇSÇRÅ|èIóπâÒ        
005350*--<    No.07>                                                    
005360        MOVE  ì¸óÕÇQÅ|éxï•ÉfÅ[É^çÏê¨ì˙Å|îNåéì˙                    
005370                                      TO  ÇcÇRÇSÇRÅ|èIóπîNåé      
005380*--<    No.08>                                                    
005390        MOVE  ì¸óÕÇQÅ|é¿éxï•äz        TO  ÇcÇRÇSÇRÅ|ã‡äz          
005400*--<    No.09>                                                    
005410        MOVE  ì¸óÕÇQÅ|è¡îÔê≈äz        TO  ÇcÇRÇSÇRÅ|è¡îÔê≈        
005420*                                                                 
005430        MOVE  "N"                     TO  ÇvÅ|èoóÕÉtÉâÉO          
005440*                                                                 
005450        MOVE  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ    TO  ÇvÅ|éxï•âÒêîî‘çÜ        
005460        MOVE  ì¸óÕÇQÅ|é¿éxï•äz        TO  ÇvÅ|é¿éxï•äz            
005470        MOVE  ì¸óÕÇQÅ|éxï•ÉfÅ[É^çÏê¨ì˙Å|îNåéì˙                    
005480                                      TO  ÇvÅ|éxï•îNåé            
005490*                                                                 
005500        MOVE  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ    TO  ÇvÅ|éxï•âÒêîî‘çÜ        
005510        MOVE  ì¸óÕÇQÅ|é¿éxï•äz        TO  ÇvÅ|é¿éxï•äz            
005520        MOVE  ì¸óÕÇQÅ|éxï•ÉfÅ[É^çÏê¨ì˙Å|îNåéì˙                    
005530                                      TO  ÇvÅ|éxï•îNåé            
005540        PERFORM  ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûèàóù                         
005550*                                                                 
005560     ELSE                                                         
005570        IF  ì¸óÕÇQÅ|é¿éxï•äz NOT = ÇvÅ|é¿éxï•äz                   
005580*                                                                 
005590           PERFORM  èoóÕèàóù                                      
005600*                                                                 
005610*--<       No.04>                                                 
005620           MOVE  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ TO  ÇcÇRÇSÇRÅ|äJénâÒ        
005630*--<       No.05>                                                 
005640           MOVE  ì¸óÕÇQÅ|éxï•ÉfÅ[É^çÏê¨ì˙Å|îNåéì˙                 
005650                                      TO  ÇcÇRÇSÇRÅ|äJénîNåé      
005660*--<       No.06>                                                 
005670           MOVE  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ TO  ÇcÇRÇSÇRÅ|èIóπâÒ        
005680*--<       No.07>                                                 
005690           MOVE  ì¸óÕÇQÅ|éxï•ÉfÅ[É^çÏê¨ì˙Å|îNåéì˙                 
005700                                      TO  ÇcÇRÇSÇRÅ|èIóπîNåé      
005710*--<       No.08>                                                 
005720           MOVE  ì¸óÕÇQÅ|é¿éxï•äz     TO  ÇcÇRÇSÇRÅ|ã‡äz          
005730*--<       No.09>                                                 
005740           MOVE  ì¸óÕÇQÅ|è¡îÔê≈äz     TO  ÇcÇRÇSÇRÅ|è¡îÔê≈        
005750*                                                                 
005760        ELSE                                                      
005770*--<       No.06>                                                 
005780           MOVE  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ TO  ÇcÇRÇSÇRÅ|èIóπâÒ        
005790*--<       No.07>                                                 
005800           MOVE  ì¸óÕÇQÅ|éxï•ÉfÅ[É^çÏê¨ì˙Å|îNåéì˙                 
005810                                      TO  ÇcÇRÇSÇRÅ|èIóπîNåé      
005820*                                                                 
005830           MOVE  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ TO  ÇvÅ|éxï•âÒêîî‘çÜ        
005840           MOVE  ì¸óÕÇQÅ|é¿éxï•äz     TO  ÇvÅ|é¿éxï•äz            
005850           MOVE  ì¸óÕÇQÅ|éxï•ÉfÅ[É^çÏê¨ì˙Å|îNåéì˙                 
005860                                      TO  ÇvÅ|éxï•îNåé            
005870*                                                                 
005880           MOVE  ì¸óÕÇQÅ|éxï•âÒêîî‘çÜ TO  ÇvÅ|éxï•âÒêîî‘çÜ        
005890           MOVE  ì¸óÕÇQÅ|é¿éxï•äz     TO  ÇvÅ|é¿éxï•äz            
005900           MOVE  ì¸óÕÇQÅ|éxï•ÉfÅ[É^çÏê¨ì˙Å|îNåéì˙                 
005910                                      TO  ÇvÅ|éxï•îNåé            
005920           PERFORM  ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûèàóù                      
005930     END-IF.                                                      
005940*                                                                 
005950 ìWäJï“èWÅ|ÇdÇwÇhÇs.                                              
005960     EXIT.                                                        
005970******************************************************************
005980*    èoóÕèàóù                                                    *
005990******************************************************************
006000 èoóÕèàóù                             SECTION.                    
006010 èoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
006020*                                                                 
006030       
      *      EXEC  SQL                                                  
006040*       INSERT  INTO  D343HTN_TBL                                 
006050*          ( å_ñÒî‘çÜ                                             
006060*           ,çƒÉäÅ[ÉXâÒêî                                         
006070*           ,å_ñÒéÌóﬁ                                             
006080*           ,äJénâÒ                                               
006090*           ,äJénîNåé                                             
006100*           ,èIóπâÒ                                               
006110*           ,èIóπîNåé                                             
006120*           ,ã‡äz                                                 
006130*           ,è¡îÔê≈                                               
006140*           ,çXêVîNåéì˙                                           
006150*           ,çXêVéûä‘                                             
006160*           ,çXêVé“                                               
006170*           ,ì¸óÕíSìñé“ÉRÅ[Éh                                     
006180*           ,ìoò^îNåéì˙                                           
006190*           ,ìoò^éûä‘                                             
006200*           ,ìoò^íSìñé“ )                                         
006210*      VALUES                                                     
006220*          ( :ÇcÇRÇSÇRÅ|å_ñÒî‘çÜ                                  
006230*           ,:ÇcÇRÇSÇRÅ|çƒÉäÅ[ÉXâÒêî                              
006240*           ,:ÇcÇRÇSÇRÅ|å_ñÒéÌóﬁ                                  
006250*           ,:ÇcÇRÇSÇRÅ|äJénâÒ                                    
006260*           ,:ÇcÇRÇSÇRÅ|äJénîNåé                                  
006270*           ,:ÇcÇRÇSÇRÅ|èIóπâÒ                                    
006280*           ,:ÇcÇRÇSÇRÅ|èIóπîNåé                                  
006290*           ,:ÇcÇRÇSÇRÅ|ã‡äz                                      
006300*           ,:ÇcÇRÇSÇRÅ|è¡îÔê≈                                    
006310*           ,:ÇcÇRÇSÇRÅ|çXêVîNåéì˙                                
006320*           ,:ÇcÇRÇSÇRÅ|çXêVéûä‘                                  
006330*           ,:ÇcÇRÇSÇRÅ|çXêVé“                                    
006340*           ,:ÇcÇRÇSÇRÅ|ì¸óÕíSìñé“ÉRÅ[Éh                          
006350*           ,:ÇcÇRÇSÇRÅ|ìoò^îNåéì˙                                
006360*           ,:ÇcÇRÇSÇRÅ|ìoò^éûä‘                                  
006370*           ,:ÇcÇRÇSÇRÅ|ìoò^íSìñé“)                               
006380*    END-EXEC.
             CALL "SQLADR" USING SQ0002 SQL-STMT
             MOVE 1 TO SQL-ITERS
             MOVE 102 TO SQL-OFFSET
             MOVE 0 TO SQL-OCCURS
             CALL "SQLADR" USING
                 SQLCUD
                 SQL-CUD
             CALL "SQLADR" USING
                 SQLCA
                 SQL-SQLEST
             MOVE 256 TO SQL-SQLETY
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|å_ñÒî‘çÜ IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(1)
             MOVE 10 TO SQL-SQHSTL(1)
             MOVE 0 TO SQL-SQHSTS(1)
             MOVE 0 TO SQL-SQINDV(1)
             MOVE 0 TO SQL-SQINDS(1)
             MOVE 0 TO SQL-SQHARM(1)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|çƒÉäÅ[ÉXâÒêî IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(2)
             MOVE 2 TO SQL-SQHSTL(2)
             MOVE 0 TO SQL-SQHSTS(2)
             MOVE 0 TO SQL-SQINDV(2)
             MOVE 0 TO SQL-SQINDS(2)
             MOVE 0 TO SQL-SQHARM(2)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|å_ñÒéÌóﬁ IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(3)
             MOVE 3 TO SQL-SQHSTL(3)
             MOVE 0 TO SQL-SQHSTS(3)
             MOVE 0 TO SQL-SQINDV(3)
             MOVE 0 TO SQL-SQINDS(3)
             MOVE 0 TO SQL-SQHARM(3)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|äJénâÒ IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(4)
             MOVE 2 TO SQL-SQHSTL(4)
             MOVE 0 TO SQL-SQHSTS(4)
             MOVE 0 TO SQL-SQINDV(4)
             MOVE 0 TO SQL-SQINDS(4)
             MOVE 0 TO SQL-SQHARM(4)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|äJénîNåé IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(5)
             MOVE 6 TO SQL-SQHSTL(5)
             MOVE 0 TO SQL-SQHSTS(5)
             MOVE 0 TO SQL-SQINDV(5)
             MOVE 0 TO SQL-SQINDS(5)
             MOVE 0 TO SQL-SQHARM(5)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|èIóπâÒ IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(6)
             MOVE 2 TO SQL-SQHSTL(6)
             MOVE 0 TO SQL-SQHSTS(6)
             MOVE 0 TO SQL-SQINDV(6)
             MOVE 0 TO SQL-SQINDS(6)
             MOVE 0 TO SQL-SQHARM(6)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|èIóπîNåé IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(7)
             MOVE 6 TO SQL-SQHSTL(7)
             MOVE 0 TO SQL-SQHSTS(7)
             MOVE 0 TO SQL-SQINDV(7)
             MOVE 0 TO SQL-SQINDS(7)
             MOVE 0 TO SQL-SQHARM(7)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|ã‡äz IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(8)
             MOVE 7 TO SQL-SQHSTL(8)
             MOVE 0 TO SQL-SQHSTS(8)
             MOVE 0 TO SQL-SQINDV(8)
             MOVE 0 TO SQL-SQINDS(8)
             MOVE 0 TO SQL-SQHARM(8)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|è¡îÔê≈ IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(9)
             MOVE 7 TO SQL-SQHSTL(9)
             MOVE 0 TO SQL-SQHSTS(9)
             MOVE 0 TO SQL-SQINDV(9)
             MOVE 0 TO SQL-SQINDS(9)
             MOVE 0 TO SQL-SQHARM(9)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|çXêVîNåéì˙ IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(10)
             MOVE 8 TO SQL-SQHSTL(10)
             MOVE 0 TO SQL-SQHSTS(10)
             MOVE 0 TO SQL-SQINDV(10)
             MOVE 0 TO SQL-SQINDS(10)
             MOVE 0 TO SQL-SQHARM(10)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|çXêVéûä‘ IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(11)
             MOVE 8 TO SQL-SQHSTL(11)
             MOVE 0 TO SQL-SQHSTS(11)
             MOVE 0 TO SQL-SQINDV(11)
             MOVE 0 TO SQL-SQINDS(11)
             MOVE 0 TO SQL-SQHARM(11)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|çXêVé“ IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(12)
             MOVE 8 TO SQL-SQHSTL(12)
             MOVE 0 TO SQL-SQHSTS(12)
             MOVE 0 TO SQL-SQINDV(12)
             MOVE 0 TO SQL-SQINDS(12)
             MOVE 0 TO SQL-SQHARM(12)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|ì¸óÕíSìñé“ÉRÅ[Éh IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(13)
             MOVE 8 TO SQL-SQHSTL(13)
             MOVE 0 TO SQL-SQHSTS(13)
             MOVE 0 TO SQL-SQINDV(13)
             MOVE 0 TO SQL-SQINDS(13)
             MOVE 0 TO SQL-SQHARM(13)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|ìoò^îNåéì˙ IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(14)
             MOVE 8 TO SQL-SQHSTL(14)
             MOVE 0 TO SQL-SQHSTS(14)
             MOVE 0 TO SQL-SQINDV(14)
             MOVE 0 TO SQL-SQINDS(14)
             MOVE 0 TO SQL-SQHARM(14)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|ìoò^éûä‘ IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(15)
             MOVE 8 TO SQL-SQHSTL(15)
             MOVE 0 TO SQL-SQHSTS(15)
             MOVE 0 TO SQL-SQINDV(15)
             MOVE 0 TO SQL-SQINDS(15)
             MOVE 0 TO SQL-SQHARM(15)
             CALL "SQLADR" USING
                 ÇcÇRÇSÇRÅ|ìoò^íSìñé“ IN
                 ïœë•ï•ì]
                 SQL-SQHSTV(16)
             MOVE 8 TO SQL-SQHSTL(16)
             MOVE 0 TO SQL-SQHSTS(16)
             MOVE 0 TO SQL-SQINDV(16)
             MOVE 0 TO SQL-SQINDS(16)
             MOVE 0 TO SQL-SQHARM(16)
             CALL "SQLADR" USING
                 SQL-SQHSTV(1)
                 SQL-SQPHSV
             CALL "SQLADR" USING
                 SQL-SQHSTL(1)
                 SQL-SQPHSL
             CALL "SQLADR" USING
                 SQL-SQHSTS(1)
                 SQL-SQPHSS
             CALL "SQLADR" USING
                 SQL-SQINDV(1)
                 SQL-SQPIND
             CALL "SQLADR" USING
                 SQL-SQINDS(1)
                 SQL-SQPINS
             CALL "SQLADR" USING
                 SQL-SQHARM(1)
                 SQL-SQPARM
             CALL "SQLADR" USING
                 SQL-SQHARC(1)
                 SQL-SQPARC

             CALL "SQLBEX" USING
                 SQLCTX
                 SQLEXD
                 SQLFPN

             CALL "SQLGSS" USING
                SQLSTATE
                 .
006390*                                                                 
006400*----------------------------------------------------------------*
006410*    í«â¡èàóùÇämîF                                              *
006420*----------------------------------------------------------------*
006430     EVALUATE  SQLCODE                                            
006440        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
006450*--<       í«â¡ê¨å˜ >                                             
006460           COMPUTE  ÇvÅ|èoóÕÅ|åèêî  =  ÇvÅ|èoóÕÅ|åèêî  +  1       
006470           MOVE  "Y"                  TO  ÇvÅ|èoóÕÉtÉâÉO          
006480        WHEN   OTHER                                              
006490*--<       í«â¡èàóùÉGÉâÅ[ >                                       
006500           MOVE     -7                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
006510           PERFORM  ÉGÉâÅ[èàóù                                    
006520     END-EVALUATE.                                                
006530*                                                                 
006540 èoóÕèàóùÅ|ÇdÇwÇhÇs.                                              
006550     EXIT.                                                        
006560******************************************************************
006570*    èIóπèàóù                                                    *
006580******************************************************************
006590 èIóπèàóù                             SECTION.                    
006600 èIóπèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
006610*                                                                 
006620*----------------------------------------------------------------*
006630*    ÉtÉ@ÉCÉãÉNÉçÅ[ÉY                                            *
006640*----------------------------------------------------------------*
006650     CLOSE  ì¸óÕÉtÉ@ÉCÉãÇP                                        
006660            ì¸óÕÉtÉ@ÉCÉãÇQ.                                       
006670*----------------------------------------------------------------*
006680*    ÇcÇaÉRÉ~ÉbÉgèàóù                                            *
006690*----------------------------------------------------------------*
006700     PERFORM  ÇcÇaÉRÉ~ÉbÉgèàóù.                                   
006710*----------------------------------------------------------------*
006720*    åèêîÉÅÉbÉZÅ[ÉWèoóÕ                                          *
006730*----------------------------------------------------------------*
006740     PERFORM  åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù.                             
006750*----------------------------------------------------------------*
006760*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
006770*----------------------------------------------------------------*
006780     PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ.                                 
006790*--< ÉvÉçÉOÉâÉÄê≥èÌèIóπ >                                         
006800     MOVE  íËêîÅ|ê≥èÌèÛë‘             TO  PROGRAM-STATUS.         
006810*                                                                 
006820 èIóπèàóùÅ|ÇdÇwÇhÇs.                                              
006830     EXIT.                                                        
006840******************************************************************
006850*    ÇcÇaÉRÉ~ÉbÉgèàóù                                            *
006860******************************************************************
006870 ÇcÇaÉRÉ~ÉbÉgèàóù                     SECTION.                    
006880 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
006890*                                                                 
006900     
      *    EXEC  SQL                                                    
006910*       COMMIT  WORK  RELEASE                                     
006920*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 181 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
006930*                                                                 
006940     INITIALIZE                       IF-CHOCO001.                
006950     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
006960     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
006970     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
006980     MOVE  "COMMIT"                   TO  ã§ÇPÅ|èàóùéØï .         
006990     MOVE  "ÉRÉ~ÉbÉgé¿é{"             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007000     CALL  CLOCO001                USING  IF-CHOCO001.            
007010*                                                                 
007020 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇdÇwÇhÇs.                                      
007030     EXIT.                                                        
007040******************************************************************
007050*    ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                                        *
007060******************************************************************
007070 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                 SECTION.                    
007080 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóùÅ|ÇrÇsÇ`ÇqÇs.                                
007090*                                                                 
007100     
      *    EXEC  SQL                                                    
007110*       ROLLBACK WORK  RELEASE                                    
007120*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 196 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007130*                                                                 
007140     INITIALIZE                       IF-CHOCO001.                
007150     MOVE  "1"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007160     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007170     MOVE  "9"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007180     MOVE  "ROLLBACK"                 TO  ã§ÇPÅ|èàóùéØï .         
007190     MOVE  "ÉçÅ[ÉãÉoÉbÉNé¿é{"         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007200     CALL  CLOCO001                USING  IF-CHOCO001.            
007210*                                                                 
007220 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóùÅ|ÇdÇwÇhÇs.                                  
007230     EXIT.                                                        
007240******************************************************************
007250*    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
007260******************************************************************
007270 åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù               SECTION.                    
007280 åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                              
007290*                                                                 
007300*----------------------------------------------------------------*
007310*    ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûåèêîÉÅÉbÉZÅ[ÉWèoóÕ                      *
007320*----------------------------------------------------------------*
007330     INITIALIZE                       IF-CHOCO001.                
007340     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007350     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007360     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007370     MOVE  "FFUSI410"                 TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007380     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007390     MOVE  ÇvÅ|ì¸óÕÅ|åèêîÇP           TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007400     MOVE  "ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûåèêî" TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007410     CALL  CLOCO001                USING  IF-CHOCO001.            
007420*                                                                 
007430*----------------------------------------------------------------*
007440*    ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûåèêîÉÅÉbÉZÅ[ÉWèoóÕ                      *
007450*----------------------------------------------------------------*
007460     INITIALIZE                       IF-CHOCO001.                
007470     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007480     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007490     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007500     MOVE  "FFUSI412"                 TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007510     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007520     MOVE  ÇvÅ|ì¸óÕÅ|åèêîÇQ           TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007530     MOVE  "ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûåèêî" TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007540     CALL  CLOCO001                USING  IF-CHOCO001.            
007550*                                                                 
007560*----------------------------------------------------------------*
007570*    ïœë•ï•ì]ÉåÉRÅ[ÉhèëçûåèêîÉÅÉbÉZÅ[ÉWèoóÕ                      *
007580*----------------------------------------------------------------*
007590     INITIALIZE                       IF-CHOCO001.                
007600     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007610     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007620     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007630     MOVE  "D343HTN"                  TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007640     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007650     MOVE  ÇvÅ|èoóÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007660     MOVE  "ïœë•ï•ì]ÉåÉRÅ[Éhèëçûåèêî" TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007670     CALL  CLOCO001                USING  IF-CHOCO001.            
007680*                                                                 
007690 åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóùÅ|ÇdÇwÇhÇs.                                
007700     EXIT.                                                        
007710******************************************************************
007720*    èIóπÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
007730******************************************************************
007740 èIóπÉÅÉbÉZÅ[ÉWèoóÕ                   SECTION.                    
007750 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
007760*                                                                 
007770     INITIALIZE                       IF-CHOCO001.                
007780     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007790     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007800     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007810     MOVE  "END"                      TO  ã§ÇPÅ|èàóùéØï .         
007820     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007830     CALL  CLOCO001                USING  IF-CHOCO001.            
007840*                                                                 
007850 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
007860     EXIT.                                                        
007870******************************************************************
007880*    ÉGÉâÅ[èàóù                                                  *
007890******************************************************************
007900 ÉGÉâÅ[èàóù                           SECTION.                    
007910 ÉGÉâÅ[èàóùÅ|ÇrÇsÇ`ÇqÇs.                                          
007920*                                                                 
007930     MOVE     "Y"                     TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO    
007940     INITIALIZE                           IF-CHOCO001.            
007950*                                                                 
007960     EVALUATE  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh                                   
007970        WHEN  -1                                                  
007980*--<       ÇnÇqÇ`ÇbÇkÇdê⁄ë±é∏îs >                                 
007990           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008000           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008010           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008020           MOVE  "CONNECT"            TO  ã§ÇPÅ|èàóùéØï           
008030           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008040           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008050           CALL  CLOCO001          USING  IF-CHOCO001             
008060*                                                                 
008070        WHEN  -2                                                  
008080*--<       ç¬ñ±ñæç◊ÉåÉRÅ[ÉhÇÃÉIÅ[ÉvÉìÉGÉâÅ[ >                     
008090           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008100           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008110           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008120           MOVE  "FFUSI410"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008130           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008140           MOVE  ÇvÅ|èÛë‘             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008150           MOVE  "ç¬ñ±ñæç◊ÉåÉRÅ[ÉhÇÃÉIÅ[ÉvÉìÉGÉâÅ["               
008160                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008170           CALL  CLOCO001          USING  IF-CHOCO001             
008180*                                                                 
008190        WHEN  -3                                                  
008200*--<       ç¬ñ±ìWäJÉåÉRÅ[ÉhÇÃÉIÅ[ÉvÉìÉGÉâÅ[ >                     
008210           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008220           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008230           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008240           MOVE  "FFUSI412"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008250           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008260           MOVE  ÇvÅ|èÛë‘             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008270           MOVE  "ç¬ñ±ìWäJÉåÉRÅ[ÉhÇÃÉIÅ[ÉvÉìÉGÉâÅ["               
008280                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008290           CALL  CLOCO001          USING  IF-CHOCO001             
008300*                                                                 
008310        WHEN  -4                                                  
008320*--<       ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûÉGÉâÅ[ >                           
008330           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008340           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008350           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008360           MOVE  "FFUSI410"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008370           MOVE  "READ"               TO  ã§ÇPÅ|èàóùéØï           
008380           MOVE  ÇvÅ|èÛë‘             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008390           MOVE  "ç¬ñ±ñæç◊ÉåÉRÅ[Éhì«çûÉGÉâÅ[ "                    
008400                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008410           CALL  CLOCO001          USING  IF-CHOCO001             
008420*                                                                 
008430        WHEN  -5                                                  
008440*--<       ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûÉGÉâÅ[ >                           
008450           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008460           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008470           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008480           MOVE  "FFUSI412"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008490           MOVE  "READ"               TO  ã§ÇPÅ|èàóùéØï           
008500           MOVE  ÇvÅ|èÛë‘             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008510           MOVE  "ç¬ñ±ìWäJÉåÉRÅ[Éhì«çûÉGÉâÅ[ "                    
008520                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008530           CALL  CLOCO001          USING  IF-CHOCO001             
008540*                                                                 
008550        WHEN  -6                                                  
008560*--<       ã§í èÓïÒåüçıÉGÉâÅ[ >                                   
008570           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008580           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008590           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008600           MOVE  "IKOTBL002"          TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008610           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
008620           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008630           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008640           CALL  CLOCO001          USING  IF-CHOCO001             
008650           MOVE  "N"                  TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO    
008660*                                                                 
008670        WHEN  -7                                                  
008680*--<       ïœë•ï•ì]ÉåÉRÅ[Éhí«â¡é∏îs >                             
008690           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008700           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008710           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008720           MOVE  "D343HTN"            TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008730           MOVE  "INSERT"             TO  ã§ÇPÅ|èàóùéØï           
008740           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008750           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008760           CALL  CLOCO001          USING  IF-CHOCO001             
008770*                                                                 
008780        WHEN  OTHER                                               
008790           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
008800*                                                                 
008810     END-EVALUATE.                                                
008820*                                                                 
008830     IF ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO  =  "Y"                              
008840*                                                                 
008850*--<    ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù >                                    
008860        PERFORM  ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                             
008870*--<    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù >                                  
008880        PERFORM  åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                           
008890*                                                                 
008900*--<    èIóπÉÅÉbÉZÅ[ÉWèoóÕèàóù >                                  
008910        PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ                               
008920*                                                                 
008930*--<    ÉvÉçÉOÉâÉÄàŸèÌèIóπÇÃÉäÉ^Å[ÉìÉRÅ[Éh >                      
008940        MOVE  íËêîÅ|àŸèÌèÛë‘          TO  PROGRAM-STATUS          
008950*                                                                 
008960        EXIT  PROGRAM                                             
008970     END-IF.                                                      
008980*                                                                 
008990 ÉGÉâÅ[èàóùÅ|ÇdÇwÇhÇs.                                            
009000     EXIT.                                                        
009010******************************************************************
009020*                  END OF PROGRAM                                *
009030******************************************************************
