Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

ファイル: COBIS410.PCOをオープン
     1  000010******************************************************************
     2  000020*         ＜海輝軟件(大連)＞                                     *
     3  000030*      1. プログラム名  : 変則払転移行処理                       *
     4  000040*      2. プログラムID  : COBIS410                               *
     5  000050*      3. 処理概要      : 変則払の転リースデータを作成する。     *
     6  000060*                                                                *
     7  000070*      4. 作成者        : 王軍                                   *
     8  000080*      5. 作成日        : 2005.04.04                             *
     9  000090******************************************************************
    10  000100*                                                                 
    11  000110******************************************************************
    12  000120*    ＩＤＥＮＴＩＦＩＣＡＴＩＯＮ  ＤＩＶＩＳＩＯＮ              *
    13  000130******************************************************************
    14  000140 IDENTIFICATION                       DIVISION.                   
    15  000150*                                                                 
    16  000160 PROGRAM-ID.                          COBIS410.                   
    17  000170******************************************************************
    18  000180*    ＥＮＶＩＲＯＮＭＥＮＴ        ＤＩＶＩＳＩＯＮ              *
    19  000190******************************************************************
    20  000200 ENVIRONMENT                          DIVISION.                   
    21  000210******************************************************************
    22  000220*    ＩＮＰＵＴ−ＯＵＴＰＵＴ      ＳＥＣＴＩＯＮ                *
    23  000230******************************************************************
    24  000240 INPUT-OUTPUT                         SECTION.                    
    25  000250*                                                                 
    26  000260 FILE-CONTROL.                                                    
    27  000270     SELECT    入力ファイル１         ASSIGN    TO     U01        
    28  000280     FILE      STATUS     IS          Ｗ−状態                    
    29  000290     ORGANIZATION         IS          LINE      SEQUENTIAL.       
    30  000300*                                                                 
    31  000310     SELECT    入力ファイル２         ASSIGN    TO     U02        
    32  000320     FILE      STATUS     IS          Ｗ−状態                    
    33  000330     ORGANIZATION         IS          LINE      SEQUENTIAL.       
    34  000340*                                                                 
    35  000350******************************************************************
    36  000360*    ＤＡＴＡ                      ＤＩＶＩＳＩＯＮ              *
    37  000370******************************************************************
    38  000380 DATA                                 DIVISION.                   
    39  000390******************************************************************
    40  000400*    ＦＩＬＥ                      ＳＥＣＴＩＯＮ                *
    41  000410******************************************************************
    42  000420 FILE                                 SECTION.                    
    43  000430*----------------------------------------------------------------*
    44  000440*    出力ファイル                                                *
    45  000450*----------------------------------------------------------------*
    46  000460 FD  入力ファイル１                                               
    47  000470     LABEL     RECORD     IS          STANDARD                    
    48  000480     BLOCK     CONTAINS   0           RECORDS.                    
    49  000490*                                                                 
    50  000500 01  入力１−レコード.                                            
    51  000510     COPY  CPBIS043  REPLACING  ==()==  BY  ==入力１−==.         
    52  000520*                                                                 
    53  000530 FD  入力ファイル２                                               
    54  000540     LABEL     RECORD     IS          STANDARD                    
    55  000550     BLOCK     CONTAINS   0           RECORDS.                    
    56  000560*                                                                 
    57  000570 01  入力２−レコード.                                            
    58  000580     COPY  CPBIS042  REPLACING  ==()==  BY  ==入力２−==.         
    59  000590*                                                                 
    60  000600******************************************************************
    61  000610*  ＷＯＲＫＩＮＧ−ＳＴＯＲＡＧＥ  ＳＥＣＴＩＯＮ                *
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

    62  000620******************************************************************
    63  000630  WORKING-STORAGE                     SECTION.                    
    64  000640*----------------------------------------------------------------*
    65  000650*    ホスト変数定義エリア                                        *
    66  000660*----------------------------------------------------------------*
    67  000670     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
    68  000680*                                                                 
    69  000690*--< 債務契約ＮＯ>                                                
    70  000700 01  ＷＳ−債務契約ＮＯ               PIC  X(09).                 
    71  000710*--< 再リースコード>                                              
    72  000720 01  ＷＳ−再リースコード             PIC  9(01).                 
    73  000730*--< 債務勘定処理コード>                                          
    74  000740 01  ＷＳ−債務勘定処理コード         PIC  9(02).                 
    75  000750*                                                                 
    76  000760*--< ＯＲＡＣＬＥ共通変数 >                                       
    77  000770     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
    78  000780*                                                                 
    79  000790*--< ＯＲＡＣＬＥ  ＳＱＬ実行情報 >                               
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをオープン
     1  000010*--＜ＳＱＬ共通変数＞
     2  000030   01  SQLSTATE                      PIC  X(005).
     3  000040   01  DB-STRING                     PIC  X(020).
     4  000050   01  USERNAME                      PIC  X(010).
     5  000060   01  PASSWD                        PIC  X(010).
     6  000070*
ファイル: Z:\COB97\COPYLIB_DB\SQLCOM.CBLをクローズ
    80  000800     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
    81  000810*                                                                 
    82  000820*--< 変則払転レコード>                                            
    83  000830     EXEC  SQL  INCLUDE  D343HTN.CBL           END-EXEC.          
    84  000840*                                                                 
    85  000850*--< 契約種類等変換テーブル>                                      
ファイル: Z:\COB97\COPYLIB_DB\D343HTN.CBLをオープン
     1        *****************************************************************
     2        *   変則払転(D343HTN_TBL)
     3        *****************************************************************
     4         01  変則払転.
     5             03  Ｄ３４３−契約番号    PIC  X(010).
     6             03  Ｄ３４３−再リース回数
     7                                       PIC S9(002) PACKED-DECIMAL.
     8             03  Ｄ３４３−契約種類    PIC  X(003).
     9             03  Ｄ３４３−開始回      PIC S9(003) PACKED-DECIMAL.
    10             03  Ｄ３４３−開始年月    PIC  X(006).
    11             03  Ｄ３４３−終了回      PIC S9(003) PACKED-DECIMAL.
    12             03  Ｄ３４３−終了年月    PIC  X(006).
    13             03  Ｄ３４３−金額        PIC S9(013) PACKED-DECIMAL.
    14             03  Ｄ３４３−消費税      PIC S9(013) PACKED-DECIMAL.
    15             03  Ｄ３４３−更新年月日  PIC  X(008).
    16             03  Ｄ３４３−更新時間    PIC  X(008).
    17             03  Ｄ３４３−更新者      PIC  X(008).
    18             03  Ｄ３４３−入力担当者コード
    19                                       PIC  X(008).
    20             03  Ｄ３４３−登録年月日  PIC  X(008).
    21             03  Ｄ３４３−登録時間    PIC  X(008).
    22             03  Ｄ３４３−登録担当者  PIC  X(008).
ファイル: Z:\COB97\COPYLIB_DB\D343HTN.CBLをクローズ
    86  000860     EXEC  SQL  INCLUDE  IKOTBL002.CBL         END-EXEC.          
    87  000870*                                                                 
ファイル: Z:\COB97\COPYLIB_DB\IKOTBL002.CBLをオープン
     1  000010************************************************
     2  000020* 契約種類等変換テーブル(IKOTBL002)
     3  000030************************************************
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

     4  000040 01  ＩＫＯ００２−契約ＮＯ PIC  X(009).
     5  000050 01  ＩＫＯ００２−再リースコード PIC S9(001) COMP-3.
     6  000060 01  ＩＫＯ００２−旧債権勘定処理コード PIC S9(002) COMP-3.
     7  000070 01  ＩＫＯ００２−旧債務勘定処理コード PIC S9(002) COMP-3.
     8  000080 01  ＩＫＯ００２−再リース回数 PIC S9(002) COMP-3.
     9  000090 01  ＩＫＯ００２−債権勘定処理コード PIC S9(002) COMP-3.
    10  000100 01  ＩＫＯ００２−債務勘定処理コード PIC S9(002) COMP-3.
    11  000110 01  ＩＫＯ００２−契約種類 PIC  X(003).
    12  000120 01  ＩＫＯ００２−主契約区分 PIC  X(001).
    13  000130 01  ＩＫＯ００２−回収手順 PIC  X(001).
ファイル: Z:\COB97\COPYLIB_DB\IKOTBL002.CBLをクローズ
    88  000880     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
    89  000890*----------------------------------------------------------------*
    90  000900*    ＷＯＲＫエリア                                              *
    91  000910*----------------------------------------------------------------*
    92  000920 01  ＷＯＲＫ−エリア.                                            
    93  000930*                                                                 
    94  000940*--< ワークエリア項目>                                            
    95  000950     03  Ｗ−実支払額                 PIC S9(03).                 
    96  000960     03  Ｗ−支払回数番号             PIC S9(04).                 
    97  000970     03  Ｗ−支払年月                 PIC X(6).                   
    98  000980*                                                                 
    99  000990*--< ファイル状態 >                                               
   100  001000     03  Ｗ−状態エリア.                                          
   101  001010         05  Ｗ−状態                 PIC  X(02).                 
   102  001020*                                                                 
   103  001030*--< 出力判定用>                                                  
   104  001040     03  Ｗ−出力フラグ               PIC  X(01).                 
   105  001050*                                                                 
   106  001060*--< エラー判定用 >                                               
   107  001070     03  Ｗ−エラーコード             PIC S9(04).                 
   108  001080*                                                                 
   109  001090*--< フラグアリア >                                               
   110  001100     03  フラグアリア.                                            
   111  001110         05  Ｗ−終了−フラグ１       PIC  X(01).                 
   112  001120         05  Ｗ−終了−フラグ２       PIC  X(01).                 
   113  001130         05  Ｗ−異常終了−フラグ     PIC  X(01).                 
   114  001140*                                                                 
   115  001150*--< キーエリア >                                                 
   116  001160     03  Ｗ−キーエリア.                                          
   117  001170         05  Ｗ−ＫＥＹ−債務明細.                                
   118  001180             07  Ｗ−債務契約ＮＯ１   PIC  X(10).                 
   119  001190             07  Ｗ−再リースコード１ PIC  S9(1).                 
   120  001200             07  Ｗ−契約明細ＮＯ１   PIC  S9(2).                 
   121  001210             07  Ｗ−レコードシーケンス１                         
   122  001220                                      PIC  S9(1).                 
   123  001230*                                                                 
   124  001240         05  Ｗ−ＫＥＹ−債務展開.                                
   125  001250             07  Ｗ−債務契約ＮＯ２   PIC  X(10).                 
   126  001260             07  Ｗ−再リースコード２ PIC  S9(1).                 
   127  001270             07  Ｗ−契約明細ＮＯ２   PIC  S9(2).                 
   128  001280             07  Ｗ−レコードシーケンス２                         
   129  001290                                      PIC  S9(1).                 
   130  001300*                                                                 
   131  001310*--< 件数エリア >                                                 
   132  001320     03  件数エリア.                                              
   133  001330         05  Ｗ−入力−件数１         PIC  9(09).                 
   134  001340         05  Ｗ−入力−件数２         PIC  9(09).                 
   135  001350         05  Ｗ−出力−件数           PIC  9(09).                 
   136  001360*                                                                 
   137  001370*--< 共通情報 >                                                   
   138  001380 01  Ｗ−共通情報.                                                
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   139  001390     03  Ｗ−システム日付.                                        
   140  001400         05  Ｗ−世紀                 PIC  X(02) VALUE  "20".     
   141  001410         05  Ｗ−年月日               PIC  X(06).                 
   142  001420     03  Ｗ−システム時刻             PIC  X(08).                 
   143  001430     03  Ｗ−担当者                   PIC  X(08) VALUE "IKOPG   ".
   144  001440*                                                                 
   145  001450*----------------------------------------------------------------*
   146  001460*    サブルーチン名                                              *
   147  001470*----------------------------------------------------------------*
   148  001480 01  CALL-AREA.                                                   
   149  001490*--< 共通ログサブルーチン >                                       
   150  001500     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
   151  001510     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
   152  001520*                                                                 
   153  001530*----------------------------------------------------------------*
   154  001540*    ＣＯＰＹ領域                                                *
   155  001550*----------------------------------------------------------------*
   156  001560*--< 共通ログ用パラメータ >                                       
   157  001570 01  IF-CHOCO001.                                                 
   158  001580     COPY  CHOCO001  REPLACING  ==()==  BY  ==共１−==.           
   159  001590*                                                                 
   160  001600*----------------------------------------------------------------*
   161  001610*    ＩＮＩファイル読込サブルーチン用パラメタ領域                *
   162  001620*----------------------------------------------------------------*
   163  001630 01  PARA-AREA.                                                   
   164  001640     COPY CPBCO001.                                               
   165  001650******************************************************************
   166  001660*    定数用データ定義エリア                                      *
   167  001670******************************************************************
   168  001680 CONSTANT                             SECTION.                    
   169  001690 01  定数領域.                                                    
   170  001700     03  定数−プログラムＩＤ         PIC  X(08) VALUE "COBIS410".
   171  001710     03  定数−プログラム名           PIC  X(80) VALUE            
   172  001720                                               "変則払転移行処理".
   173  001730     03  定数−ＳＱＬＯＫ             PIC S9(04)  VALUE  ZERO.    
   174  001740     03  定数−ＳＱＬＥＮＤ           PIC S9(04)  VALUE  0100.    
   175  001750     03  定数−正常状態               PIC S9(04)  VALUE  ZERO.    
   176  001760     03  定数−異常状態               PIC S9(04)  VALUE  0009.    
   177  001770******************************************************************
   178  001780*    ＰＲＯＣＥＤＵＲＥ            ＤＩＶＩＳＩＯＮ              *
   179  001790******************************************************************
   180  001800 PROCEDURE                            DIVISION.                   
   181  001810*                                                                 
   182  001820     PERFORM  初期処理.                                           
   183  001830*                                                                 
   184  001840     PERFORM  主処理  UNTIL  Ｗ−終了−フラグ１  =  "Y"           
   185  001850                        AND  Ｗ−終了−フラグ２  =  "Y".          
   186  001860*                                                                 
   187  001870     PERFORM  終了処理.                                           
   188  001880*                                                                 
   189  001890     STOP     RUN.                                                
   190  001900*                                                                 
   191  001910******************************************************************
   192  001920*    初期処理                                                    *
   193  001930******************************************************************
   194  001940 初期処理                             SECTION.                    
   195  001950 初期処理−ＳＴＡＲＴ.                                            
   196  001960*                                                                 
   197  001970*----------------------------------------------------------------*
   198  001980*    開始メッセージ出力処理                                  1.1 *
   199  001990*----------------------------------------------------------------*
   200  002000     INITIALIZE                       IF-CHOCO001.                
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   201  002010     MOVE  "3"                        TO  共１−イベント種別.     
   202  002020     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   203  002030     MOVE  "0"                        TO  共１−復帰コード.       
   204  002040     MOVE  "START"                    TO  共１−処理識別.         
   205  002050     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
   206  002060     CALL  CLOCO001                USING  IF-CHOCO001.            
   207  002070*                                                                 
   208  002080*----------------------------------------------------------------*
   209  002090*    作業領域の初期値処理                                    1.2 *
   210  002100*----------------------------------------------------------------*
   211  002110     MOVE  SPACE                      TO  ＷＯＲＫ−エリア.       
   212  002120     INITIALIZE                           ＷＯＲＫ−エリア.       
   213  002130*                                                                 
   214  002140*--< 出力レコードの初期化処理 >                                   
   215  002150     MOVE  SPACE                      TO  変則払転.               
   216  002160     INITIALIZE                           変則払転.               
   217  002170*                                                                 
   218  002180*--< ＣＰＵ日付を取得 >                                           
   219  002190     ACCEPT  Ｗ−年月日               FROM  DATE.                 
   220  002200*                                                                 
   221  002210*--< ＣＰＵ時刻を取得 >                                           
   222  002220     ACCEPT  Ｗ−システム時刻         FROM  TIME.                 
   223  002230*                                                                 
   224  002240*----------------------------------------------------------------*
   225  002250*    ＯＲＡＣＬＥ接続                                        1.3 *
   226  002260*----------------------------------------------------------------*
   227  002270     PERFORM  ＯＲＡＣＬＥ接続.                                   
   228  002280*----------------------------------------------------------------*
   229  002290*    ファイルオープン                                        1.4 *
   230  002300*----------------------------------------------------------------*
   231  002310     PERFORM  ファイルオープン.                                   
   232  002320*----------------------------------------------------------------*
   233  002330*    債務明細レコード読込処理（１件目）                      1.5 *
   234  002340*----------------------------------------------------------------*
   235  002350     PERFORM  債務明細レコード読込処理.                           
   236  002360*----------------------------------------------------------------*
   237  002370*    債務展開レコード読込処理（１件目）                      1.6 *
   238  002380*----------------------------------------------------------------*
   239  002390     PERFORM  債務展開レコード読込処理.                           
   240  002400*                                                                 
   241  002410*--< 対象抽出判定>                                                
   242  002420     IF    (入力１−債務協調コード = "45"                         
   243  002430        OR  入力１−債務協調コード = "46"                         
   244  002440        OR  入力１−債務協調コード = "55"                         
   245  002450        OR  入力１−債務協調コード = "56")                        
   246  002460        AND    入力１−計算方式 = "2"                             
   247  002470        CONTINUE                                                  
   248  002480     ELSE                                                         
   249  002490        IF  Ｗ−終了−フラグ１  NOT =  "Y"                        
   250  002500           PERFORM  債務明細レコード読込処理                      
   251  002510     END-IF.                                                      
   252  002520*                                                                 
   253  002530 初期処理−ＥＸＩＴ.                                              
   254  002540     EXIT.                                                        
   255  002550******************************************************************
   256  002560*    ＯＲＡＣＬＥ接続                                            *
   257  002570******************************************************************
   258  002580 ＯＲＡＣＬＥ接続                     SECTION.                    
   259  002590 ＯＲＡＣＬＥ接続−ＳＴＡＲＴ.                                    
   260  002600*                                                                 
   261  002610*--< ＤＢ接続用情報を取得処理 >                                   
   262  002620     CALL  COBCO001                USING  PARA-AREA.              
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   263  002630*                                                                 
   264  002640     MOVE  PARA-DBSTRING              TO  DB-STRING.              
   265  002650     MOVE  PARA-USERNAME              TO  USERNAME.               
   266  002660     MOVE  PARA-PASSWORD              TO  PASSWD.                 
   267  002670*                                                                 
   268  002680*----------------------------------------------------------------*
   269  002690*    開始接続                                                    *
   270  002700*----------------------------------------------------------------*
   271  002710     IF    DB-STRING  =  SPACE                                    
   272  002720        EXEC SQL                                                  
   273  002730           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   274  002740        END-EXEC                                                  
   275  002750     ELSE                                                         
   276  002760        EXEC SQL                                                  
   277  002770           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
   278  002780             USING  :DB-STRING                                    
   279  002790        END-EXEC                                                  
   280  002800     END-IF.                                                      
   281  002810*                                                                 
   282  002820*----------------------------------------------------------------*
   283  002830*    接続確認                                                    *
   284  002840*----------------------------------------------------------------*
   285  002850     EVALUATE  SQLCODE                                            
   286  002860        WHEN   定数−ＳＱＬＯＫ                                   
   287  002870           CONTINUE                                               
   288  002880        WHEN   OTHER                                              
   289  002890*--<       接続エラー >                                           
   290  002900           MOVE     -1                TO  Ｗ−エラーコード        
   291  002910           PERFORM  エラー処理                                    
   292  002920     END-EVALUATE.                                                
   293  002930*                                                                 
   294  002940 ＯＲＡＣＬＥ接続−ＥＸＩＴ.                                      
   295  002950     EXIT.                                                        
   296  002960******************************************************************
   297  002970*    ファイルオープン                                            *
   298  002980******************************************************************
   299  002990 ファイルオープン                     SECTION.                    
   300  003000 ファイルオープン−ＳＴＡＲＴ.                                    
   301  003010*                                                                 
   302  003020*----------------------------------------------------------------*
   303  003030*    債務明細レコードのオープン                                  *
   304  003040*----------------------------------------------------------------*
   305  003050     OPEN  INPUT   入力ファイル１.                                
   306  003060*                                                                 
   307  003070*--< ファイルオープンの状態判定 >                                 
   308  003080     EVALUATE  Ｗ−状態                                           
   309  003090        WHEN  ZERO                                                
   310  003100           CONTINUE                                               
   311  003110        WHEN  OTHER                                               
   312  003120*--<       ファイルオープンエラー >                               
   313  003130           MOVE     -2                TO  Ｗ−エラーコード        
   314  003140           PERFORM  エラー処理                                    
   315  003150     END-EVALUATE.                                                
   316  003160*                                                                 
   317  003170*----------------------------------------------------------------*
   318  003180*    債務展開レコードのオープン                                  *
   319  003190*----------------------------------------------------------------*
   320  003200     OPEN  INPUT   入力ファイル２.                                
   321  003210*                                                                 
   322  003220*--< ファイルオープンの状態判定 >                                 
   323  003230     EVALUATE  Ｗ−状態                                           
   324  003240        WHEN  ZERO                                                
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   325  003250           CONTINUE                                               
   326  003260        WHEN  OTHER                                               
   327  003270*--<       ファイルオープンエラー >                               
   328  003280           MOVE     -3                TO  Ｗ−エラーコード        
   329  003290           PERFORM  エラー処理                                    
   330  003300     END-EVALUATE.                                                
   331  003310*                                                                 
   332  003320 ファイルオープン−ＥＸＩＴ.                                      
   333  003330     EXIT.                                                        
   334  003340******************************************************************
   335  003350*    債務明細レコード読込処理（１件目）                          *
   336  003360******************************************************************
   337  003370 債務明細レコード読込処理             SECTION.                    
   338  003380 債務明細レコード読込処理−ＳＴＡＲＴ.                            
   339  003390*                                                                 
   340  003400     READ  入力ファイル１                                         
   341  003410        AT END                                                    
   342  003420           MOVE  "Y"                  TO  Ｗ−終了−フラグ１      
   343  003430           MOVE  HIGH-VALUE           TO  Ｗ−ＫＥＹ−債務明細    
   344  003440           GO    TO   債務明細レコード読込処理−ＥＸＩＴ          
   345  003450     END-READ.                                                    
   346  003460*                                                                 
   347  003470*--< ファイル読込状態判定 >                                       
   348  003480     EVALUATE  Ｗ−状態                                           
   349  003490        WHEN  ZERO                                                
   350  003500*--<       債務明細レコードマッチングキーのセット >               
   351  003510           MOVE  入力１−債務契約ＮＯ                             
   352  003520                                      TO  Ｗ−債務契約ＮＯ１      
   353  003530           MOVE  入力１−再リースコード                           
   354  003540                                      TO  Ｗ−再リースコード１    
   355  003550           MOVE  入力１−契約明細ＮＯ                             
   356  003560                                      TO  Ｗ−契約明細ＮＯ１      
   357  003570           MOVE  入力１−レコードシーケンス                       
   358  003580                                      TO  Ｗ−レコードシーケンス１
   359  003590*--<       ＳＱＬ変数のセット>                                    
   360  003600           MOVE  入力１−債務契約ＮＯ(2:9)                        
   361  003610                                      TO  ＷＳ−債務契約ＮＯ      
   362  003620           MOVE  入力１−再リースコード                           
   363  003630                                      TO  ＷＳ−再リースコード    
   364  003640           MOVE  入力１−債務勘定処理コード                       
   365  003650                                      TO  ＷＳ−債務勘定処理コード
   366  003660*--<       債務明細レコード入力件数のカウント >                   
   367  003670           COMPUTE   Ｗ−入力−件数１  =  Ｗ−入力−件数１ + 1    
   368  003680        WHEN  OTHER                                               
   369  003690*--<       債務明細レコード読込エラー >                           
   370  003700           MOVE     -4                TO  Ｗ−エラーコード        
   371  003710           PERFORM  エラー処理                                    
   372  003720     END-EVALUATE.                                                
   373  003730*                                                                 
   374  003740 債務明細レコード読込処理−ＥＸＩＴ.                              
   375  003750     EXIT.                                                        
   376  003760******************************************************************
   377  003770*    債務展開レコード読込処理（１件目）                          *
   378  003780******************************************************************
   379  003790 債務展開レコード読込処理             SECTION.                    
   380  003800 債務展開レコード読込処理−ＳＴＡＲＴ.                            
   381  003810*                                                                 
   382  003820     READ  入力ファイル２                                         
   383  003830        AT END                                                    
   384  003840           MOVE  "Y"                  TO  Ｗ−終了−フラグ２      
   385  003850           MOVE  HIGH-VALUE           TO  Ｗ−ＫＥＹ−債務展開    
   386  003860           GO    TO   債務展開レコード読込処理−ＥＸＩＴ          
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   387  003870     END-READ.                                                    
   388  003880*                                                                 
   389  003890*--< ファイル読込状態判定 >                                       
   390  003900     EVALUATE  Ｗ−状態                                           
   391  003910        WHEN  ZERO                                                
   392  003920*--<       債務展開レコードマッチングキーのセット >               
   393  003930           MOVE  入力２−債務契約ＮＯ                             
   394  003940                                      TO  Ｗ−債務契約ＮＯ２      
   395  003950           MOVE  入力２−再リースコード                           
   396  003960                                      TO  Ｗ−再リースコード２    
   397  003970           MOVE  入力２−契約明細ＮＯ                             
   398  003980                                      TO  Ｗ−契約明細ＮＯ２      
   399  003990           MOVE  入力２−レコードシーケンス                       
   400  004000                                      TO  Ｗ−レコードシーケンス２
   401  004010*--<       債務展開レコード入力件数のカウント >                   
   402  004020           COMPUTE   Ｗ−入力−件数２  =  Ｗ−入力−件数２ + 1    
   403  004030        WHEN  OTHER                                               
   404  004040*--<       債務展開レコード読込エラー >                           
   405  004050           MOVE     -5                TO  Ｗ−エラーコード        
   406  004060           PERFORM  エラー処理                                    
   407  004070     END-EVALUATE.                                                
   408  004080*                                                                 
   409  004090 債務展開レコード読込処理−ＥＸＩＴ.                              
   410  004100     EXIT.                                                        
   411  004110******************************************************************
   412  004120*    主処理                                                      *
   413  004130******************************************************************
   414  004140 主処理                               SECTION.                    
   415  004150 主処理−ＳＴＡＲＴ.                                              
   416  004160*                                                                 
   417  004170     EVALUATE  TRUE                                               
   418  004180*--<    債務明細レコードのみの場合 >                              
   419  004190        WHEN  Ｗ−ＫＥＹ−債務明細 > Ｗ−ＫＥＹ−債務展開         
   420  004200           MOVE  入力２−支払回数番号 TO  Ｗ−支払回数番号        
   421  004210           MOVE  入力２−実支払額     TO  Ｗ−実支払額            
   422  004220           MOVE  入力２−支払データ作成日−年月日                 
   423  004230                                      TO  Ｗ−支払年月            
   424  004240           PERFORM  債務展開レコード読込処理                      
   425  004250*                                                                 
   426  004260*--<    マッチングの場合 >                                        
   427  004270        WHEN  Ｗ−ＫＥＹ−債務明細 = Ｗ−ＫＥＹ−債務展開         
   428  004280           PERFORM  マッチング編集出力処理                        
   429  004290*                                                                 
   430  004300           MOVE  入力２−支払回数番号 TO  Ｗ−支払回数番号        
   431  004310           MOVE  入力２−実支払額     TO  Ｗ−実支払額            
   432  004320           MOVE  入力２−支払データ作成日−年月日                 
   433  004330                                      TO  Ｗ−支払年月            
   434  004340           PERFORM  債務展開レコード読込処理                      
   435  004350*                                                                 
   436  004360*--<    債務展開レコードのみの場合 >                              
   437  004370        WHEN  Ｗ−ＫＥＹ−債務明細 < Ｗ−ＫＥＹ−債務展開         
   438  004380*                                                                 
   439  004390           IF  Ｗ−出力フラグ = "N"                               
   440  004400              PERFORM  出力処理                                   
   441  004410           END-IF                                                 
   442  004420*                                                                 
   443  004430           PERFORM  債務明細レコード読込処理                      
   444  004440*                                                                 
   445  004450     END-EVALUATE.                                                
   446  004460*                                                                 
   447  004470 主処理−ＥＸＩＴ.                                                
   448  004480     EXIT.                                                        
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   449  004490******************************************************************
   450  004500*    マッチング編集出力処理                                      *
   451  004510******************************************************************
   452  004520 マッチング編集出力処理               SECTION.                    
   453  004530 マッチング編集出力処理−ＳＴＡＲＴ.                              
   454  004540*                                                                 
   455  004550*--< 変則払転レコード基本項目の編集処理 >                         
   456  004560*--<    No.04--No.09 >                                            
   457  004570        PERFORM  展開編集.                                        
   458  004580*--<    No.01 >                                                   
   459  004590        MOVE  入力１−債務契約ＮＯ    TO  Ｄ３４３−契約番号.     
   460  004600*--<    No.02 >                                                   
   461  004610        PERFORM  共通処理.                                        
   462  004620        MOVE  ＩＫＯ００２−再リース回数                          
   463  004630                                      TO  Ｄ３４３−再リース回数. 
   464  004640*--<    No.03 >                                                   
   465  004650        MOVE  ＩＫＯ００２−契約種類  TO  Ｄ３４３−契約種類.     
   466  004660*--<    No.10 >                                                   
   467  004670        MOVE  Ｗ−システム日付        TO  Ｄ３４３−更新年月日.   
   468  004680*--<    No.11 >                                                   
   469  004690        MOVE  Ｗ−システム時刻        TO  Ｄ３４３−更新時間.     
   470  004700*--<    No.12 >                                                   
   471  004710        MOVE  Ｗ−担当者              TO  Ｄ３４３−更新者.       
   472  004720*--<    No.13 >                                                   
   473  004730        MOVE  Ｗ−担当者              TO                          
   474  004740                                       Ｄ３４３−入力担当者コード.
   475  004750*--<    No.14 >                                                   
   476  004760        MOVE  Ｗ−システム日付        TO  Ｄ３４３−登録年月日.   
   477  004770*--<    No.15 >                                                   
   478  004780        MOVE  Ｗ−システム時刻        TO  Ｄ３４３−登録時間.     
   479  004790*--<    No.16 >                                                   
   480  004800        MOVE  Ｗ−担当者              TO  Ｄ３４３−登録担当者.   
   481  004810*                                                                 
   482  004820 マッチング編集出力処理−ＥＸＩＴ.                                
   483  004830     EXIT.                                                        
   484  004840******************************************************************
   485  004850*    共通処理                                                    *
   486  004860******************************************************************
   487  004870 共通処理                             SECTION.                    
   488  004880 共通処理−ＳＴＡＲＴ.                                            
   489  004890*----------------------------------------------------------------*
   490  004900*    契約種類等変換テーブル読込                                  *
   491  004910*----------------------------------------------------------------*
   492  004920*                                                                 
   493  004930     INITIALIZE                       ＩＫＯ００２−再リース回数. 
   494  004940     INITIALIZE                       ＩＫＯ００２−契約種類.     
   495  004950*                                                                 
   496  004960     EXEC SQL                                                     
   497  004970        SELECT  再リース回数                                      
   498  004980               ,契約種類                                          
   499  004990          INTO :ＩＫＯ００２−再リース回数                        
   500  005000              ,:ＩＫＯ００２−契約種類                            
   501  005010          FROM  IKOTBL002                                         
   502  005020         WHERE  契約ＮＯ           = :ＷＳ−債務契約ＮＯ          
   503  005030           AND  再リースコード     = :ＷＳ−再リースコード        
   504  005040           AND  債務勘定処理コード = :ＷＳ−債務勘定処理コード    
   505  005050     END-EXEC.                                                    
   506  005060*----------------------------------------------------------------*
   507  005070*    契約種類等変換テーブル検索を確認                            *
   508  005080*----------------------------------------------------------------*
   509  005090     EVALUATE   SQLCODE                                           
   510  005100        WHEN   定数−ＳＱＬＯＫ                                   
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   511  005110*--<       正常の時 >                                             
   512  005120           CONTINUE                                               
   513  005130        WHEN   OTHER                                              
   514  005140*--<       存在しない >                                           
   515  005150           MOVE     -6                TO  Ｗ−エラーコード        
   516  005160           PERFORM  エラー処理                                    
   517  005170     END-EVALUATE.                                                
   518  005180*                                                                 
   519  005190 共通処理−ＥＸＩＴ.                                              
   520  005200     EXIT.                                                        
   521  005210******************************************************************
   522  005220*    展開編集                                                    *
   523  005230******************************************************************
   524  005240 展開編集                             SECTION.                    
   525  005250 展開編集−ＳＴＡＲＴ.                                            
   526  005260*                                                                 
   527  005270     IF  入力２−支払回数番号 = 1                                 
   528  005280*--<    No.04>                                                    
   529  005290        MOVE  入力２−支払回数番号    TO  Ｄ３４３−開始回        
   530  005300*--<    No.05>                                                    
   531  005310        MOVE  入力２−支払データ作成日−年月日                    
   532  005320                                      TO  Ｄ３４３−開始年月      
   533  005330*--<    No.06>                                                    
   534  005340        MOVE  入力２−支払回数番号    TO  Ｄ３４３−終了回        
   535  005350*--<    No.07>                                                    
   536  005360        MOVE  入力２−支払データ作成日−年月日                    
   537  005370                                      TO  Ｄ３４３−終了年月      
   538  005380*--<    No.08>                                                    
   539  005390        MOVE  入力２−実支払額        TO  Ｄ３４３−金額          
   540  005400*--<    No.09>                                                    
   541  005410        MOVE  入力２−消費税額        TO  Ｄ３４３−消費税        
   542  005420*                                                                 
   543  005430        MOVE  "N"                     TO  Ｗ−出力フラグ          
   544  005440*                                                                 
   545  005450        MOVE  入力２−支払回数番号    TO  Ｗ−支払回数番号        
   546  005460        MOVE  入力２−実支払額        TO  Ｗ−実支払額            
   547  005470        MOVE  入力２−支払データ作成日−年月日                    
   548  005480                                      TO  Ｗ−支払年月            
   549  005490*                                                                 
   550  005500        MOVE  入力２−支払回数番号    TO  Ｗ−支払回数番号        
   551  005510        MOVE  入力２−実支払額        TO  Ｗ−実支払額            
   552  005520        MOVE  入力２−支払データ作成日−年月日                    
   553  005530                                      TO  Ｗ−支払年月            
   554  005540        PERFORM  債務展開レコード読込処理                         
   555  005550*                                                                 
   556  005560     ELSE                                                         
   557  005570        IF  入力２−実支払額 NOT = Ｗ−実支払額                   
   558  005580*                                                                 
   559  005590           PERFORM  出力処理                                      
   560  005600*                                                                 
   561  005610*--<       No.04>                                                 
   562  005620           MOVE  入力２−支払回数番号 TO  Ｄ３４３−開始回        
   563  005630*--<       No.05>                                                 
   564  005640           MOVE  入力２−支払データ作成日−年月日                 
   565  005650                                      TO  Ｄ３４３−開始年月      
   566  005660*--<       No.06>                                                 
   567  005670           MOVE  入力２−支払回数番号 TO  Ｄ３４３−終了回        
   568  005680*--<       No.07>                                                 
   569  005690           MOVE  入力２−支払データ作成日−年月日                 
   570  005700                                      TO  Ｄ３４３−終了年月      
   571  005710*--<       No.08>                                                 
   572  005720           MOVE  入力２−実支払額     TO  Ｄ３４３−金額          
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   573  005730*--<       No.09>                                                 
   574  005740           MOVE  入力２−消費税額     TO  Ｄ３４３−消費税        
   575  005750*                                                                 
   576  005760        ELSE                                                      
   577  005770*--<       No.06>                                                 
   578  005780           MOVE  入力２−支払回数番号 TO  Ｄ３４３−終了回        
   579  005790*--<       No.07>                                                 
   580  005800           MOVE  入力２−支払データ作成日−年月日                 
   581  005810                                      TO  Ｄ３４３−終了年月      
   582  005820*                                                                 
   583  005830           MOVE  入力２−支払回数番号 TO  Ｗ−支払回数番号        
   584  005840           MOVE  入力２−実支払額     TO  Ｗ−実支払額            
   585  005850           MOVE  入力２−支払データ作成日−年月日                 
   586  005860                                      TO  Ｗ−支払年月            
   587  005870*                                                                 
   588  005880           MOVE  入力２−支払回数番号 TO  Ｗ−支払回数番号        
   589  005890           MOVE  入力２−実支払額     TO  Ｗ−実支払額            
   590  005900           MOVE  入力２−支払データ作成日−年月日                 
   591  005910                                      TO  Ｗ−支払年月            
   592  005920           PERFORM  債務展開レコード読込処理                      
   593  005930     END-IF.                                                      
   594  005940*                                                                 
   595  005950 展開編集−ＥＸＩＴ.                                              
   596  005960     EXIT.                                                        
   597  005970******************************************************************
   598  005980*    出力処理                                                    *
   599  005990******************************************************************
   600  006000 出力処理                             SECTION.                    
   601  006010 出力処理−ＳＴＡＲＴ.                                            
   602  006020*                                                                 
   603  006030       EXEC  SQL                                                  
   604  006040        INSERT  INTO  D343HTN_TBL                                 
   605  006050           ( 契約番号                                             
   606  006060            ,再リース回数                                         
   607  006070            ,契約種類                                             
   608  006080            ,開始回                                               
   609  006090            ,開始年月                                             
   610  006100            ,終了回                                               
   611  006110            ,終了年月                                             
   612  006120            ,金額                                                 
   613  006130            ,消費税                                               
   614  006140            ,更新年月日                                           
   615  006150            ,更新時間                                             
   616  006160            ,更新者                                               
   617  006170            ,入力担当者コード                                     
   618  006180            ,登録年月日                                           
   619  006190            ,登録時間                                             
   620  006200            ,登録担当者 )                                         
   621  006210       VALUES                                                     
   622  006220           ( :Ｄ３４３−契約番号                                  
   623  006230            ,:Ｄ３４３−再リース回数                              
   624  006240            ,:Ｄ３４３−契約種類                                  
   625  006250            ,:Ｄ３４３−開始回                                    
   626  006260            ,:Ｄ３４３−開始年月                                  
   627  006270            ,:Ｄ３４３−終了回                                    
   628  006280            ,:Ｄ３４３−終了年月                                  
   629  006290            ,:Ｄ３４３−金額                                      
   630  006300            ,:Ｄ３４３−消費税                                    
   631  006310            ,:Ｄ３４３−更新年月日                                
   632  006320            ,:Ｄ３４３−更新時間                                  
   633  006330            ,:Ｄ３４３−更新者                                    
   634  006340            ,:Ｄ３４３−入力担当者コード                          
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   635  006350            ,:Ｄ３４３−登録年月日                                
   636  006360            ,:Ｄ３４３−登録時間                                  
   637  006370            ,:Ｄ３４３−登録担当者)                               
   638  006380     END-EXEC.                                                    
   639  006390*                                                                 
   640  006400*----------------------------------------------------------------*
   641  006410*    追加処理を確認                                              *
   642  006420*----------------------------------------------------------------*
   643  006430     EVALUATE  SQLCODE                                            
   644  006440        WHEN   定数−ＳＱＬＯＫ                                   
   645  006450*--<       追加成功 >                                             
   646  006460           COMPUTE  Ｗ−出力−件数  =  Ｗ−出力−件数  +  1       
   647  006470           MOVE  "Y"                  TO  Ｗ−出力フラグ          
   648  006480        WHEN   OTHER                                              
   649  006490*--<       追加処理エラー >                                       
   650  006500           MOVE     -7                TO  Ｗ−エラーコード        
   651  006510           PERFORM  エラー処理                                    
   652  006520     END-EVALUATE.                                                
   653  006530*                                                                 
   654  006540 出力処理−ＥＸＩＴ.                                              
   655  006550     EXIT.                                                        
   656  006560******************************************************************
   657  006570*    終了処理                                                    *
   658  006580******************************************************************
   659  006590 終了処理                             SECTION.                    
   660  006600 終了処理−ＳＴＡＲＴ.                                            
   661  006610*                                                                 
   662  006620*----------------------------------------------------------------*
   663  006630*    ファイルクローズ                                            *
   664  006640*----------------------------------------------------------------*
   665  006650     CLOSE  入力ファイル１                                        
   666  006660            入力ファイル２.                                       
   667  006670*----------------------------------------------------------------*
   668  006680*    ＤＢコミット処理                                            *
   669  006690*----------------------------------------------------------------*
   670  006700     PERFORM  ＤＢコミット処理.                                   
   671  006710*----------------------------------------------------------------*
   672  006720*    件数メッセージ出力                                          *
   673  006730*----------------------------------------------------------------*
   674  006740     PERFORM  件数メッセージ出力処理.                             
   675  006750*----------------------------------------------------------------*
   676  006760*    終了メッセージ出力                                          *
   677  006770*----------------------------------------------------------------*
   678  006780     PERFORM  終了メッセージ出力.                                 
   679  006790*--< プログラム正常終了 >                                         
   680  006800     MOVE  定数−正常状態             TO  PROGRAM-STATUS.         
   681  006810*                                                                 
   682  006820 終了処理−ＥＸＩＴ.                                              
   683  006830     EXIT.                                                        
   684  006840******************************************************************
   685  006850*    ＤＢコミット処理                                            *
   686  006860******************************************************************
   687  006870 ＤＢコミット処理                     SECTION.                    
   688  006880 ＤＢコミット処理−ＳＴＡＲＴ.                                    
   689  006890*                                                                 
   690  006900     EXEC  SQL                                                    
   691  006910        COMMIT  WORK  RELEASE                                     
   692  006920     END-EXEC.                                                    
   693  006930*                                                                 
   694  006940     INITIALIZE                       IF-CHOCO001.                
   695  006950     MOVE  "3"                        TO  共１−イベント種別.     
   696  006960     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   697  006970     MOVE  "0"                        TO  共１−復帰コード.       
   698  006980     MOVE  "COMMIT"                   TO  共１−処理識別.         
   699  006990     MOVE  "コミット実施"             TO  共１−その他メッセージ. 
   700  007000     CALL  CLOCO001                USING  IF-CHOCO001.            
   701  007010*                                                                 
   702  007020 ＤＢコミット処理−ＥＸＩＴ.                                      
   703  007030     EXIT.                                                        
   704  007040******************************************************************
   705  007050*    ＤＢロールバック処理                                        *
   706  007060******************************************************************
   707  007070 ＤＢロールバック処理                 SECTION.                    
   708  007080 ＤＢロールバック処理−ＳＴＡＲＴ.                                
   709  007090*                                                                 
   710  007100     EXEC  SQL                                                    
   711  007110        ROLLBACK WORK  RELEASE                                    
   712  007120     END-EXEC.                                                    
   713  007130*                                                                 
   714  007140     INITIALIZE                       IF-CHOCO001.                
   715  007150     MOVE  "1"                        TO  共１−イベント種別.     
   716  007160     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   717  007170     MOVE  "9"                        TO  共１−復帰コード.       
   718  007180     MOVE  "ROLLBACK"                 TO  共１−処理識別.         
   719  007190     MOVE  "ロールバック実施"         TO  共１−その他メッセージ. 
   720  007200     CALL  CLOCO001                USING  IF-CHOCO001.            
   721  007210*                                                                 
   722  007220 ＤＢロールバック処理−ＥＸＩＴ.                                  
   723  007230     EXIT.                                                        
   724  007240******************************************************************
   725  007250*    件数メッセージ出力処理                                      *
   726  007260******************************************************************
   727  007270 件数メッセージ出力処理               SECTION.                    
   728  007280 件数メッセージ出力処理−ＳＴＡＲＴ.                              
   729  007290*                                                                 
   730  007300*----------------------------------------------------------------*
   731  007310*    債務明細レコード読込件数メッセージ出力                      *
   732  007320*----------------------------------------------------------------*
   733  007330     INITIALIZE                       IF-CHOCO001.                
   734  007340     MOVE  "3"                        TO  共１−イベント種別.     
   735  007350     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   736  007360     MOVE  "0"                        TO  共１−復帰コード.       
   737  007370     MOVE  "FFUSI410"                 TO  共１−処理テーブルＩＤ. 
   738  007380     MOVE  "COUNT"                    TO  共１−処理識別.         
   739  007390     MOVE  Ｗ−入力−件数１           TO  共１−データ内容.       
   740  007400     MOVE  "債務明細レコード読込件数" TO  共１−その他メッセージ. 
   741  007410     CALL  CLOCO001                USING  IF-CHOCO001.            
   742  007420*                                                                 
   743  007430*----------------------------------------------------------------*
   744  007440*    債務展開レコード読込件数メッセージ出力                      *
   745  007450*----------------------------------------------------------------*
   746  007460     INITIALIZE                       IF-CHOCO001.                
   747  007470     MOVE  "3"                        TO  共１−イベント種別.     
   748  007480     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   749  007490     MOVE  "0"                        TO  共１−復帰コード.       
   750  007500     MOVE  "FFUSI412"                 TO  共１−処理テーブルＩＤ. 
   751  007510     MOVE  "COUNT"                    TO  共１−処理識別.         
   752  007520     MOVE  Ｗ−入力−件数２           TO  共１−データ内容.       
   753  007530     MOVE  "債務展開レコード読込件数" TO  共１−その他メッセージ. 
   754  007540     CALL  CLOCO001                USING  IF-CHOCO001.            
   755  007550*                                                                 
   756  007560*----------------------------------------------------------------*
   757  007570*    変則払転レコード書込件数メッセージ出力                      *
   758  007580*----------------------------------------------------------------*
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   759  007590     INITIALIZE                       IF-CHOCO001.                
   760  007600     MOVE  "3"                        TO  共１−イベント種別.     
   761  007610     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   762  007620     MOVE  "0"                        TO  共１−復帰コード.       
   763  007630     MOVE  "D343HTN"                  TO  共１−処理テーブルＩＤ. 
   764  007640     MOVE  "COUNT"                    TO  共１−処理識別.         
   765  007650     MOVE  Ｗ−出力−件数             TO  共１−データ内容.       
   766  007660     MOVE  "変則払転レコード書込件数" TO  共１−その他メッセージ. 
   767  007670     CALL  CLOCO001                USING  IF-CHOCO001.            
   768  007680*                                                                 
   769  007690 件数メッセージ出力処理−ＥＸＩＴ.                                
   770  007700     EXIT.                                                        
   771  007710******************************************************************
   772  007720*    終了メッセージ出力処理                                      *
   773  007730******************************************************************
   774  007740 終了メッセージ出力                   SECTION.                    
   775  007750 終了メッセージ出力−ＳＴＡＲＴ.                                  
   776  007760*                                                                 
   777  007770     INITIALIZE                       IF-CHOCO001.                
   778  007780     MOVE  "3"                        TO  共１−イベント種別.     
   779  007790     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
   780  007800     MOVE  "0"                        TO  共１−復帰コード.       
   781  007810     MOVE  "END"                      TO  共１−処理識別.         
   782  007820     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
   783  007830     CALL  CLOCO001                USING  IF-CHOCO001.            
   784  007840*                                                                 
   785  007850 終了メッセージ出力−ＥＸＩＴ.                                    
   786  007860     EXIT.                                                        
   787  007870******************************************************************
   788  007880*    エラー処理                                                  *
   789  007890******************************************************************
   790  007900 エラー処理                           SECTION.                    
   791  007910 エラー処理−ＳＴＡＲＴ.                                          
   792  007920*                                                                 
   793  007930     MOVE     "Y"                     TO  Ｗ−異常終了−フラグ    
   794  007940     INITIALIZE                           IF-CHOCO001.            
   795  007950*                                                                 
   796  007960     EVALUATE  Ｗ−エラーコード                                   
   797  007970        WHEN  -1                                                  
   798  007980*--<       ＯＲＡＣＬＥ接続失敗 >                                 
   799  007990           MOVE  "1"                  TO  共１−イベント種別      
   800  008000           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   801  008010           MOVE  "9"                  TO  共１−復帰コード        
   802  008020           MOVE  "CONNECT"            TO  共１−処理識別          
   803  008030           MOVE  SQLCODE              TO  共１−データ内容        
   804  008040           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   805  008050           CALL  CLOCO001          USING  IF-CHOCO001             
   806  008060*                                                                 
   807  008070        WHEN  -2                                                  
   808  008080*--<       債務明細レコードのオープンエラー >                     
   809  008090           MOVE  "1"                  TO  共１−イベント種別      
   810  008100           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   811  008110           MOVE  "9"                  TO  共１−復帰コード        
   812  008120           MOVE  "FFUSI410"           TO  共１−処理テーブルＩＤ  
   813  008130           MOVE  "OPEN"               TO  共１−処理識別          
   814  008140           MOVE  Ｗ−状態             TO  共１−データ内容        
   815  008150           MOVE  "債務明細レコードのオープンエラー"               
   816  008160                                      TO  共１−その他メッセージ  
   817  008170           CALL  CLOCO001          USING  IF-CHOCO001             
   818  008180*                                                                 
   819  008190        WHEN  -3                                                  
   820  008200*--<       債務展開レコードのオープンエラー >                     
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   821  008210           MOVE  "1"                  TO  共１−イベント種別      
   822  008220           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   823  008230           MOVE  "9"                  TO  共１−復帰コード        
   824  008240           MOVE  "FFUSI412"           TO  共１−処理テーブルＩＤ  
   825  008250           MOVE  "OPEN"               TO  共１−処理識別          
   826  008260           MOVE  Ｗ−状態             TO  共１−データ内容        
   827  008270           MOVE  "債務展開レコードのオープンエラー"               
   828  008280                                      TO  共１−その他メッセージ  
   829  008290           CALL  CLOCO001          USING  IF-CHOCO001             
   830  008300*                                                                 
   831  008310        WHEN  -4                                                  
   832  008320*--<       債務明細レコード読込エラー >                           
   833  008330           MOVE  "1"                  TO  共１−イベント種別      
   834  008340           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   835  008350           MOVE  "9"                  TO  共１−復帰コード        
   836  008360           MOVE  "FFUSI410"           TO  共１−処理テーブルＩＤ  
   837  008370           MOVE  "READ"               TO  共１−処理識別          
   838  008380           MOVE  Ｗ−状態             TO  共１−データ内容        
   839  008390           MOVE  "債務明細レコード読込エラー "                    
   840  008400                                      TO  共１−その他メッセージ  
   841  008410           CALL  CLOCO001          USING  IF-CHOCO001             
   842  008420*                                                                 
   843  008430        WHEN  -5                                                  
   844  008440*--<       債務展開レコード読込エラー >                           
   845  008450           MOVE  "1"                  TO  共１−イベント種別      
   846  008460           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   847  008470           MOVE  "9"                  TO  共１−復帰コード        
   848  008480           MOVE  "FFUSI412"           TO  共１−処理テーブルＩＤ  
   849  008490           MOVE  "READ"               TO  共１−処理識別          
   850  008500           MOVE  Ｗ−状態             TO  共１−データ内容        
   851  008510           MOVE  "債務展開レコード読込エラー "                    
   852  008520                                      TO  共１−その他メッセージ  
   853  008530           CALL  CLOCO001          USING  IF-CHOCO001             
   854  008540*                                                                 
   855  008550        WHEN  -6                                                  
   856  008560*--<       共通情報検索エラー >                                   
   857  008570           MOVE  "1"                  TO  共１−イベント種別      
   858  008580           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   859  008590           MOVE  "9"                  TO  共１−復帰コード        
   860  008600           MOVE  "IKOTBL002"          TO  共１−処理テーブルＩＤ  
   861  008610           MOVE  "SELECT"             TO  共１−処理識別          
   862  008620           MOVE  SQLCODE              TO  共１−データ内容        
   863  008630           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   864  008640           CALL  CLOCO001          USING  IF-CHOCO001             
   865  008650           MOVE  "N"                  TO  Ｗ−異常終了−フラグ    
   866  008660*                                                                 
   867  008670        WHEN  -7                                                  
   868  008680*--<       変則払転レコード追加失敗 >                             
   869  008690           MOVE  "1"                  TO  共１−イベント種別      
   870  008700           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
   871  008710           MOVE  "9"                  TO  共１−復帰コード        
   872  008720           MOVE  "D343HTN"            TO  共１−処理テーブルＩＤ  
   873  008730           MOVE  "INSERT"             TO  共１−処理識別          
   874  008740           MOVE  SQLCODE              TO  共１−データ内容        
   875  008750           MOVE  SQLERRMC             TO  共１−その他メッセージ  
   876  008760           CALL  CLOCO001          USING  IF-CHOCO001             
   877  008770*                                                                 
   878  008780        WHEN  OTHER                                               
   879  008790           MOVE  "N"                  TO Ｗ−異常終了−フラグ     
   880  008800*                                                                 
   881  008810     END-EVALUATE.                                                
   882  008820*                                                                 
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

   883  008830     IF Ｗ−異常終了−フラグ  =  "Y"                              
   884  008840*                                                                 
   885  008850*--<    ＤＢロールバック処理 >                                    
   886  008860        PERFORM  ＤＢロールバック処理                             
   887  008870*--<    件数メッセージ出力処理 >                                  
   888  008880        PERFORM  件数メッセージ出力処理                           
   889  008890*                                                                 
   890  008900*--<    終了メッセージ出力処理 >                                  
   891  008910        PERFORM  終了メッセージ出力                               
   892  008920*                                                                 
   893  008930*--<    プログラム異常終了のリターンコード >                      
   894  008940        MOVE  定数−異常状態          TO  PROGRAM-STATUS          
   895  008950*                                                                 
   896  008960        EXIT  PROGRAM                                             
   897  008970     END-IF.                                                      
   898  008980*                                                                 
   899  008990 エラー処理−ＥＸＩＴ.                                            
   900  009000     EXIT.                                                        
   901  009010******************************************************************
   902  009020*                  END OF PROGRAM                                *
   903  009030******************************************************************
ファイル: COBIS410.PCOをクローズ
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


ホスト変数
--------------

01  DB-STRING                                           Charf(20)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      3
  COBIS410.PCO    278

01  PASSWD                                              Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      5
  COBIS410.PCO    273    277

01  SQLSTATE                                            Charf(5)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      2
  COBIS410.PCO    272    276    496    603    690    710

01  USERNAME                                            Charf(10)
  Z:\COB97\COPYLIB_DB\SQLCOM.CBL      4
  COBIS410.PCO    273    277

03  Ｄ３４３−開始回 OF 変則払転                        Decimal(3,0)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL      9
  COBIS410.PCO    625

03  Ｄ３４３−開始年月 OF 変則払転                      Charf(6)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     10
  COBIS410.PCO    626

03  Ｄ３４３−金額 OF 変則払転                          Decimal(13,0)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     13
  COBIS410.PCO    629

03  Ｄ３４３−契約種類 OF 変則払転                      Charf(3)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL      8
  COBIS410.PCO    624

03  Ｄ３４３−契約番号 OF 変則払転                      Charf(10)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL      5
  COBIS410.PCO    622

03  Ｄ３４３−更新時間 OF 変則払転                      Charf(8)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     16
  COBIS410.PCO    632

03  Ｄ３４３−更新者 OF 変則払転                        Charf(8)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     17
  COBIS410.PCO    633

03  Ｄ３４３−更新年月日 OF 変則払転                    Charf(8)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     15
  COBIS410.PCO    631

03  Ｄ３４３−再リース回数 OF 変則払転                  Decimal(2,0)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL      6
  COBIS410.PCO    623

03  Ｄ３４３−終了回 OF 変則払転                        Decimal(3,0)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     11
  COBIS410.PCO    627

03  Ｄ３４３−終了年月 OF 変則払転                      Charf(6)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     12
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.

  COBIS410.PCO    628

03  Ｄ３４３−消費税 OF 変則払転                        Decimal(13,0)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     14
  COBIS410.PCO    630

03  Ｄ３４３−登録時間 OF 変則払転                      Charf(8)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     21
  COBIS410.PCO    636

03  Ｄ３４３−登録担当者 OF 変則払転                    Charf(8)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     22
  COBIS410.PCO    637

03  Ｄ３４３−登録年月日 OF 変則払転                    Charf(8)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     20
  COBIS410.PCO    635

03  Ｄ３４３−入力担当者コード OF 変則払転              Charf(8)
  Z:\COB97\COPYLIB_DB\D343HTN.CBL     18
  COBIS410.PCO    634

01  ＩＫＯ００２−契約種類                              Charf(3)
  Z:\COB97\COPYLIB_DB\IKOTBL002.CBL     11
  COBIS410.PCO    500

01  ＩＫＯ００２−再リース回数                          Decimal(2,0)
  Z:\COB97\COPYLIB_DB\IKOTBL002.CBL      8
  COBIS410.PCO    499

01  ＷＳ−債務勘定処理コード                            Unsigned Display(2,0)
  COBIS410.PCO     74    504

01  ＷＳ−債務契約ＮＯ                                  Charf(9)
  COBIS410.PCO     70    502

01  ＷＳ−再リースコード                                Unsigned Display(1,0)
  COBIS410.PCO     72    503

Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.



                              プリコンパイラ・オプション
-------------------------------------------------------------------------------
オプション名   現在の設定値         設定先
-------------------------------------------------------------------------------
asacc             no                デフォルト                                  
assume_sqlcode    no                デフォルト                                  
auto_connect      no                デフォルト                                  
close_on_commit   yes               mode                                        
comp5             yes               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
config            default config    デフォルト                                  
date_format       local             デフォルト                                  
dbms              native            デフォルト                                  
declare_section   yes               mode                                        
define            *なし*            デフォルト                                  
dynamic           ansi              mode                                        
end_of_fetch      100               mode                                        
eol_padding       yes               デフォルト                                  
errors            yes               デフォルト                                  
fips              no                デフォルト                                  
format            ansi              デフォルト                                  
hold_cursor       no                デフォルト                                  
host              cobol             デフォルト                                  
iname             COBIS410.PCO      コマンドライン                              
include           Z:\COB97\COPYLIB  D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
                  Z:\COB97\COPYLIB_DD:\oracle\ora90\precomp\admin\pcbcfg.cfg    
                  *なし*            D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
ireclen           132               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
litdelim          quote             デフォルト                                  
lname             *なし*            デフォルト                                  
lreclen           132               デフォルト                                  
ltype             long              デフォルト                                  
maxliteral        160               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
maxopencursors    10                デフォルト                                  
mode              ANSI              D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
nested            yes               デフォルト                                  
nls_local         yes               D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
oname             COBIS410.COB      コマンドライン                              
oraca             no                デフォルト                                  
oreclen           80                デフォルト                                  
pagelen           66                デフォルト                                  
picx              charf             デフォルト                                  
prefetch          1                 デフォルト                                  
release_cursor    no                デフォルト                                  
select_error      yes               デフォルト                                  
sqlcheck          FULL              D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
threads           no                デフォルト                                  
type_code         ansi              mode                                        
unsafe_null       no                デフォルト                                  
userid            wangjun/wj@FIP    D:\oracle\ora90\precomp\admin\pcbcfg.cfg    
varchar           no                デフォルト                                  
xref              yes               デフォルト                                  
Pro*COBOL: Release 9.2.0.1.0 - Production on 金 Apr 8 16:43:54 2005

Copyright (c) 1982, 2002, Oracle Corporation.  All rights reserved.


統計表示
----------

リターン・コード: 0
重要性 Iでのメッセージ数: 0
重要性 Wでのメッセージ数: 0
重要性 Eでのメッセージ数: 0
重要性 Fでのメッセージ数: 0
入力ラインの数: 944
宣言されたホスト変数の数: 34
カーソル名の数: 0
文名の数: 0
使用される最大メモリー(バイト): 154278
