000010******************************************************************
000020*         CP(A)                                     *
000030*      1. vO  : ]pڍs             *
000040*      2. vOID  : COBIS420       		               *
000050*      3. Tv      :DB.{ADB.ׂ       
000051*                         _mnEă[XR[h            
000052*                         KEYƂAJOINŎw                     
000053*                         DB.׏̌         
000054*                         ڍsڑΔ\̈ڍsQ      
000070*                                                                *
000080*      4. 쐬        :                                  *
000090*      5. 쐬        : 2005.4.2                               *
000100******************************************************************
000110*                                                                *
000120******************************************************************
000130*    hcdmshehb`shnm  chuhrhnm              *
000140******************************************************************
000150 IDENTIFICATION                       DIVISION.                   
000160*                                                                 
000170 PROGRAM-ID.                          COBIS420.                   
000180******************************************************************
000190*    dmuhqnmldms        chuhrhnm              *
000200******************************************************************
000210 ENVIRONMENT                          DIVISION.                   
000220******************************************************************
000230*    INPUT-OUTPUT                     SECTION                    *
000240******************************************************************
000250 INPUT-OUTPUT                          SECTION.                   
000260*                                                                 
000270 FILE-CONTROL.                                                    
000280     SELECT  oJt@C              ASSIGN     TO       U11    
000290     FILE    STATUS         IS         v|                   
000300     ORGANIZATION           IS         LINE        SEQUENTIAL.    
000310     SELECT  ̓t@C              ASSIGN     TO       U01    
000320     FILE    STATUS         IS         v|                   
000330     ORGANIZATION           IS         LINE        SEQUENTIAL.    
000340******************************************************************
000350*    c`s`                      chuhrhnm              *
000360******************************************************************
000370 DATA                                 DIVISION.                   
000380******************************************************************
000390*            oJt@C                                        *
000400******************************************************************
000410 FILE                                 SECTION.                    
000420 FD    oJt@C                                               
000430      LABEL    RECORD     IS          STANDARD                    
000440      BLOCK   CONTAINS    0           RECORDS.                    
000450 01  oJ[R[h.                                              
000460    COPY   CISUF421   REPLACING   ==()==  BY  ==oJ[==.         
000470 FD    ̓t@C                                               
000480      LABEL    RECORD     IS          STANDARD                    
000490      BLOCK   CONTAINS    0           RECORDS.                    
000500 01  ́[R[h.                                              
000510     COPY  CISPF001   REPLACING   ==()==  BY  ==́[==.         
000520*                                                                 
000530                                                                  
000540******************************************************************
000550*  vnqjhmf|rsnq`fd  rdbshnm                *
000560******************************************************************
000570  WORKING-STORAGE                     SECTION.                    
000580*----------------------------------------------------------------*
000590*    zXgϐ`GA                                        *
000600*----------------------------------------------------------------*
000610     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +34.
           02  SQLFPN-FILENAME PIC X(34) VALUE "C:\COB97\SOC\COBIS420\CO
      -    "BIS420.PCO".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(151) VALUE "select ă[X  ,_  
      -     ",_敪   into :b1,:b2,:b3  from IKOTBL002 where ((_
      -    "mn=:b4 and ă[XR[h=:b5) and 菈R[h=:b6)
      -    "".

       01  SQ0003 GLOBAL.
           02  FILLER PIC X(82) VALUE "select VR[h  ,}   in
      -    "to :b1,:b2  from IKOTBL001 where R[h=:b3".

       01  SQ0004 GLOBAL.
           02  FILLER PIC X(148) VALUE "select z  ,QN
      -    "  ,QI   into :b1,:b2,:b3  from LTRSKM where ((_
      -    "ԍ=:b4 and ă[XR[h=:b5) and R[h=:b6)".

       01  SQ0005 GLOBAL.
           02  FILLER PIC X(129) VALUE "select ʔ  ,QN
      -    "   into :b1,:b2  from LTRSKM where ((_ԍ=:b3 and ă[
      -    "XR[h=:b4) and R[h=:b5)".

       01  SQ0006 GLOBAL.
           02  FILLER PIC X(77) VALUE "select R[h   into :b
      -    "1  from IKOTBL005 where VR[h=:b2".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +148476348.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +18.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 18 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 18 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 18 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 18 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 18 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 18 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 18 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 18 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 18 TIMES.


       01  SQ0001 GLOBAL.
           02  FILLER PIC X(160) VALUE "select LTRSMK._mn  ,LTR
      -    "SMK.ă[XR[h  ,LTRSMK.菈R[h  ,LTRSMM.[
      -    "XJnQI  ,LTRSMM.[XJnQN  ,LTRSMM.
      -    "".

           02  FILLER PIC X(160) VALUE "QI  ,LTRSMM.Q
      -    "N  ,LTRSMM.z  ,LTRSMM.  ,LTRSMM.
      -    "f[^쐬QI  ,LTRSMM.f[^쐬QN  ,LTR
      -    "SMM.ă".

           02  FILLER PIC X(160) VALUE "[XR[h  ,LTRSMM.R[
      -    "h  ,LTRSMM.R[h  ,LTRSMM.ă[XR[h  ,LTRSMM.
      -    "_mn  ,LTRSMM.菈R[h  ,LTRSMM.R
      -    "[h   f".

           02  FILLER PIC X(160) VALUE "rom LTRSMK ,LTRSMM where (((LTRS
      -     "MK._mn=LTRSMM._mn and LTRSMK.ă[XR[
      -    "h=LTRSMM.ă[XR[h) and ((SUBSTR(LTRSMM.R[h
      -     ",1,1)='1'".

           02  FILLER PIC X(95) VALUE " or LTRSMM.R[h='46') o
      -    "r LTRSMM.R[h='56')) and z<>0)         
      -    "  ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +263.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +267.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +735.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +328.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +82.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +417.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +18.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +169.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +151.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +523.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +6.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +208.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +82.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +624.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +235.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +148.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +842.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +6.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +274.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +129.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +933.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +309.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +6.
           02     FILLER PIC S9(4) COMP-5 VALUE +77.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +975.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +332.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +1220.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000620*--<L[GA >                                                  
000630 01   vr|L[.                                                 
000640     03  vr|mdvL[.                                        
000650         05  vr|mdv|_ԍ         PIC  X(09).           
000660         05  vr|mdv|ă[X     PIC  9(02).           
000670         05  vr|mdv|_         PIC  X(03).           
000680     03  vr|nkcL[.                                        
000690         05  vr|nkc|_ԍ         PIC  X(09).           
000700         05  vr|nkc|ă[X     PIC  9(02).           
000710         05  vr|nkc|_         PIC  X(03).           
000720*--<A>                                                         
000730 01   vr|A                         PIC 9(03) VALUE 0.       
000740*--<>                                                         
000750 01   vr|                         PIC S9(02).              
000760 01   vr|.                                       
000770      03  vr|I                     PIC 9(02).               
000780      03  vr|N                   PIC 9(06).               
000781 01   vr|N                         PIC 9(04).               
000790 01   vr|[XJn.                                         
000800      03  vr|JnI               PIC 9(02).               
000810      03  vr|JnN             PIC 9(06).               
000811 01   vr|NP                       PIC 9(04).               
000820 01   vr|f[^쐬.                                     
000830      03  vr|f[^쐬|I   PIC 9(02).               
000840      03  vr|f[^쐬|N PIC 9(06).               
000850 01   vr|\.                                         
000860      03   vr|\|I      PIC 9(01).               
000870	    03   vr|\|N    PIC 9(06).               
000880 01   vr|sdlo                 PIC 9(01).               
000890 01   vr|sσtO           PIC X(01).               
000900 01   vr|R[h               PIC X(03).               
000910 01   vr|                       PIC 9(08).               
000920 01   vr|_mn                 PIC X(09).               
000930 01   vr|                           PIC 9(02).               
000940 01   vr|Jn                       PIC 9(02).               
000950 01   vr|R[h               PIC X(01).               
000951 01   vr|tO                       PIC 9(01).               
000960*                                                                 
000970*--< nq`bkdʕϐ >                                       
000980     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
000990*                                                                 
001000*--< nq`bkd  rpks >                               
000010*--rpkʕϐ
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
001010     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
001020*                                                                 
001030*--< {>                                                    
001040     
      *    EXEC  SQL  INCLUDE  LTRSMK.CBL            END-EXEC.
001050*                                                                 
001060*--<׏>                                                 
000010************************************************
000020* i{j(LTRSMK)
000030************************************************
000040 01  ksqrlj|_mn PIC  X(010).
000050 01  ksqrlj|ă[XR[h PIC S9(001) COMP-3.
000060 01  ksqrlj|ƏR[h PIC S9(004) COMP-3.
000070 01  ksqrlj|S҃R[h PIC S9(004) COMP-3.
000080 01  ksqrlj|_|zP PIC S9(013) COMP-3.
000090 01  ksqrlj|_|_zP PIC S9(013) COMP-3.
000100 01  ksqrlj|_|zQ PIC S9(013) COMP-3.
000110 01  ksqrlj|_|_zQ PIC S9(013) COMP-3.
000120 01  ksqrlj|_|zR PIC S9(013) COMP-3.
000130 01  ksqrlj|_|_zR PIC S9(013) COMP-3.
000140 01  ksqrlj|_|zS PIC S9(013) COMP-3.
000150 01  ksqrlj|_|_zS PIC S9(013) COMP-3.
000160 01  ksqrlj|_|zT PIC S9(013) COMP-3.
000170 01  ksqrlj|_|_zT PIC S9(013) COMP-3.
000180 01  ksqrlj|_|zU PIC S9(013) COMP-3.
000190 01  ksqrlj|_|_zU PIC S9(013) COMP-3.
000200 01  ksqrlj|_|zV PIC S9(013) COMP-3.
000210 01  ksqrlj|_|_zV PIC S9(013) COMP-3.
000220 01  ksqrlj|_|zW PIC S9(013) COMP-3.
000230 01  ksqrlj|_|_zW PIC S9(013) COMP-3.
000240 01  ksqrlj|_|zX PIC S9(013) COMP-3.
000250 01  ksqrlj|_|_zX PIC S9(013) COMP-3.
000260 01  ksqrlj|_|zPO PIC S9(013) COMP-3.
000270 01  ksqrlj|_|_zPO PIC S9(013) COMP-3.
000280 01  ksqrlj|菈R[h PIC S9(002) COMP-3.
000290 01  ksqrlj|S|I PIC S9(001) COMP-3.
000300 01  ksqrlj|S|N PIC  X(006).
000310 01  ksqrlj|SN|I PIC S9(001) COMP-3.
000320 01  ksqrlj|SN|N PIC  X(004).
000330 01  ksqrlj|_mn PIC  X(010).
000340 01  ksqrlj|V_mn PIC  X(010).
000350 01  ksqrlj|R[hV[PXP PIC S9(001) COMP-3.
000360 01  ksqrlj|R[hV[PXQ PIC S9(001) COMP-3.
000370 01  ksqrlj|R[hV[PXR PIC S9(001) COMP-3.
000380 01  ksqrlj|R[hV[PXS PIC S9(001) COMP-3.
000390 01  ksqrlj|R[hV[PXT PIC S9(001) COMP-3.
000400 01  ksqrlj|R[hV[PXU PIC S9(001) COMP-3.
000410 01  ksqrlj|R[hV[PXV PIC S9(001) COMP-3.
000420 01  ksqrlj|R[hV[PXW PIC S9(001) COMP-3.
000430 01  ksqrlj|R[hV[PXX PIC S9(001) COMP-3.
000440 01  ksqrlj|R[hV[PXPO PIC S9(001) COMP-3.
000450 01  ksqrlj|_~[OOP PIC  X(022).
000460 01  ksqrlj|ʏ PIC  X(035).
001070     
      *    EXEC  SQL  INCLUDE  LTRSMM.CBL            END-EXEC.
001080*                                                                 
001090*--<>                                                     
000010************************************************
000020* iׁj(LTRSMM)
000030************************************************
000040 01  ksqrll|_mn PIC  X(010).
000050 01  ksqrll|ă[XR[h PIC S9(001) COMP-3.
000060 01  ksqrll|_񖾍ׂmn PIC S9(002) COMP-3.
000070 01  ksqrll|R[hV[PX PIC S9(001) COMP-3.
000080 01  ksqrll|R[h PIC  X(008).
000090 01  ksqrll|R[h PIC  X(002).
000100 01  ksqrll|qdeԍ PIC  X(016).
000110 01  ksqrll|_|I PIC S9(001) COMP-3.
000120 01  ksqrll|_|N PIC  X(006).
000130 01  ksqrll||I PIC S9(001) COMP-3.
000140 01  ksqrll||N PIC  X(006).
000150 01  ksqrll||I PIC S9(001) COMP-3.
000160 01  ksqrll||N PIC  X(006).
000170 01  ksqrll|eύX|I PIC S9(001) COMP-3.
000180 01  ksqrll|eύX|N PIC  X(006).
000190 01  ksqrll|Nx|I PIC S9(001) COMP-3.
000200 01  ksqrll|Nx|N PIC  X(004).
000210 01  ksqrll|_~[OOP PIC  X(010).
000220 01  ksqrll|z PIC S9(013) COMP-3.
000230 01  ksqrll| PIC S9(013) COMP-3.
000240 01  ksqrll||I PIC S9(001) COMP-3.
000250 01  ksqrll||N PIC  X(006).
000260 01  ksqrll|R[h PIC S9(001) COMP-3.
000270 01  ksqrll|őE敪 PIC S9(001) COMP-3.
000280 01  ksqrll|f[^쐬|I PIC S9(001) COMP-3.
000290 01  ksqrll|f[^쐬|N PIC  X(006).
000300 01  ksqrll|_~[OOQ PIC  X(010).
000310 01  ksqrll|[XJn|I PIC S9(001) COMP-3.
000320 01  ksqrll|[XJn|N PIC  X(006).
000330 01  ksqrll|[XI|I PIC S9(001) COMP-3.
000340 01  ksqrll|[XI|N PIC  X(006).
000350 01  ksqrll|[X PIC S9(003) COMP-3.
000360 01  ksqrll|t@CiXJn|I PIC S9(001) COMP-3.
000370 01  ksqrll|t@CiXJn|N PIC  X(006).
000380 01  ksqrll|t@CiX|I PIC S9(001) COMP-3.
000390 01  ksqrll|t@CiX|N PIC  X(006).
000400 01  ksqrll|t@CiX PIC S9(003) COMP-3.
000410 01  ksqrll|菈R[h PIC S9(002) COMP-3.
000420 01  ksqrll|[X PIC S9(013) COMP-3.
000430 01  ksqrll|xTCN PIC S9(002) COMP-3.
000440 01  ksqrll|x PIC S9(003) COMP-3.
000450 01  ksqrll|x PIC S9(002) COMP-3.
000460 01  ksqrll|vZ PIC S9(001) COMP-3.
000470 01  ksqrll|u PIC S9(003) COMP-3.
000480 01  ksqrll|adfhm PIC S9(001) COMP-3.
000490 01  ksqrll|P񃊁[XxI 
000491                                              PIC S9(001) COMP-3.
000500 01  ksqrll|P񃊁[XxN PIC  X(006).
000510 01  ksqrll|P񃊁[Xx|I PIC S9(001) COMP-3.
000520 01  ksqrll|P񃊁[Xx|N PIC  X(006).
000530 01  ksqrll|O[Xx|I PIC S9(001) COMP-3.
000540 01  ksqrll|O[Xx|N PIC  X(006).
000550 01  ksqrll|O[X PIC S9(013) COMP-3.
000560 01  ksqrll|O[X PIC S9(013) COMP-3.
000570 01  ksqrll|O[Xxz PIC S9(013) COMP-3.
000580 01  ksqrll|O[Xp PIC S9(013) COMP-3.
000590 01  ksqrll|O[X[JnNI 
000591                                              PIC S9(001) COMP-3.
000600 01  ksqrll|O[X[JnNN PIC  X(004).
000610 01  ksqrll|O[X[INI  
000611                                              PIC S9(001) COMP-3.
000620 01  ksqrll|O[X[INN PIC  X(004).
000630 01  ksqrll|O[ PIC S9(003) COMP-3.
000640 01  ksqrll|{ PIC S9(002)V9(9) COMP-3.
000650 01  ksqrll| PIC S9(002)V9(9) COMP-3.
000660 01  ksqrll|xz PIC S9(013) COMP-3.
000670 01  ksqrll|v PIC S9(013) COMP-3.
000680 01  ksqrll|ev PIC S9(013) COMP-3.
000690 01  ksqrll|őz PIC S9(013) COMP-3.
000700 01  ksqrll|Ŏx敪 PIC S9(001) COMP-3.
000710 01  ksqrll|Őŗ PIC S9(002)V9(1) COMP-3.
000720 01  ksqrll|ŃR[h PIC S9(002) COMP-3.
000730 01  ksqrll|pŒ莑Y PIC S9(013) COMP-3.
000740 01  ksqrll|pی PIC S9(013) COMP-3.
000750 01  ksqrll|pێ痿 PIC S9(013) COMP-3.
000760 01  ksqrll|p̂P PIC S9(013) COMP-3.
000770 01  ksqrll|p̂Q PIC S9(013) COMP-3.
000780 01  ksqrll|p敪 PIC S9(001) COMP-3.
000790 01  ksqrll|xR[h PIC  X(004).
000800 01  ksqrll|sR[h PIC  X(007).
000810 01  ksqrll|ԍ PIC  X(007).
000820 01  ksqrll|a PIC  X(001).
000830 01  ksqrll|xm|I PIC S9(001) COMP-3.
000840 01  ksqrll|xm|N PIC  X(006).
000850 01  ksqrll|xmNx|I PIC S9(001) COMP-3.
000860 01  ksqrll|xmNx|N PIC  X(004).
000870 01  ksqrll|S҃R[h PIC  X(004).
000880 01  ksqrll|xFTuVXe敪 PIC  X(001).
000890 01  ksqrll|xFV[PX PIC S9(005) COMP-3.
000900 01  ksqrll|xFxF|I 
000901                                              PIC S9(001) COMP-3.
000910 01  ksqrll|xFxF|N PIC  X(006).
000920 01  ksqrll|xFS҃R[h PIC S9(004) COMP-3.
000930 01  ksqrll|cxFTuVXe敪 PIC  X(001).
000940 01  ksqrll|cxFV[PX PIC S9(005) COMP-3.
000950 01  ksqrll|cxFxF|I 
000951                                              PIC S9(001) COMP-3.
000960 01  ksqrll|cxFxF|N PIC  X(006).
000970 01  ksqrll|cxFS҃R[h PIC S9(004) COMP-3.
000980 01  ksqrll|Oc PIC S9(013) COMP-3.
000990 01  ksqrll|O{c PIC S9(013) COMP-3.
001000 01  ksqrll|OŎc PIC S9(013) COMP-3.
001010 01  ksqrll|cz PIC S9(013) COMP-3.
001020 01  ksqrll|cx|I PIC S9(001) COMP-3.
001030 01  ksqrll|cx|N PIC  X(006).
001040 01  ksqrll|_~[OOR PIC  X(024).
001050 01  ksqrll|[X PIC S9(013) COMP-3.
001060 01  ksqrll|mds[X PIC S9(013) COMP-3.
001070 01  ksqrll|񗘑 PIC S9(013) COMP-3.
001080 01  ksqrll|񌳖{xz PIC S9(013) COMP-3.
001090 01  ksqrll|񌳖{c PIC S9(013) COMP-3.
001100 01  ksqrll|c PIC S9(013) COMP-3.
001110 01  ksqrll|Ŋz PIC S9(013) COMP-3.
001120 01  ksqrll|Ŏc PIC S9(013) COMP-3.
001130 01  ksqrll|񏔔p PIC S9(013) COMP-3.
001140 01  ksqrll|xz PIC S9(013) COMP-3.
001150 01  ksqrll|ŗ PIC S9(002)V9(1) COMP-3.
001160 01  ksqrll|_~[ PIC  X(014).
001170 01  ksqrll|xf[^쐬|I PIC S9(001) COMP-3.
001180 01  ksqrll|xf[^쐬|N PIC  X(006).
001190 01  ksqrll|f[^쐬|IQ PIC S9(001) COMP-3.
001200 01  ksqrll|f[^쐬|NQ PIC  X(006).
001210 01  ksqrll|df[^쐬|I PIC S9(001) COMP-3.
001220 01  ksqrll|df[^쐬|N PIC  X(006).
001230 01  ksqrll|_~[OOS PIC  X(018).
001240 01  ksqrll|ʏ PIC  X(035).
001100     
      *    EXEC  SQL  INCLUDE  LTRSKM.CBL            END-EXEC.
001110                                                                  
000010************************************************
000020* i׏j(LTRSKM)
000030************************************************
000040 01  ksqrjl|jdxڐR[h PIC  X(008).
000050 01  ksqrjl|_ԍ PIC  X(009).
000060 01  ksqrjl|ă[XR[h PIC S9(001) COMP-3.
000070 01  ksqrjl|\ PIC  X(007).
000080 01  ksqrjl|R[h PIC  X(003).
000090 01  ksqrjl|x PIC S9(003) COMP-3.
000100 01  ksqrjl|[ PIC S9(003) COMP-3.
000110 01  ksqrjl| PIC S9(001) COMP-3.
000120 01  ksqrjl|Z敪 PIC S9(001) COMP-3.
000130 01  ksqrjl|ƏR[h PIC S9(004) COMP-3.
000140 01  ksqrjl|s|I PIC S9(001) COMP-3.
000150 01  ksqrjl|s|N PIC  X(006).
000160 01  ksqrjl|菈R[h PIC S9(002) COMP-3.
000170 01  ksqrjl|ʔ PIC S9(009) COMP-3.
000180 01  ksqrjl||I PIC S9(001) COMP-3.
000190 01  ksqrjl||N PIC  X(006).
000200 01  ksqrjl|Ł|敪 PIC S9(001) COMP-3.
000210 01  ksqrjl|Ł|z PIC S9(013) COMP-3.
000220 01  ksqrjl|Ł|ŃR[h PIC S9(002) COMP-3.
000230 01  ksqrjl|[X PIC S9(013) COMP-3.
000240 01  ksqrjl|z PIC S9(013) COMP-3.
000250 01  ksqrjl|z PIC S9(013) COMP-3.
000260 01  ksqrjl|敪 PIC S9(001) COMP-3.
000270 01  ksqrjl|sbc PIC S9(007) COMP-3.
000280 01  ksqrjl|R[h PIC  X(003).
000290 01  ksqrjl|[UR[h PIC  X(008).
000300 01  ksqrjl|R[h PIC  X(002).
000310 01  ksqrjl|ˍσtO PIC  X(001).
000320 01  ksqrjl|_~[OOP PIC  X(005).
000330 01  ksqrjl|ʏ PIC  X(035).
001120     
      *    EXEC  SQL  INCLUDE  IKOTBL001.CBL         END-EXEC.
001130                                                                  
000010************************************************
000020* ϊe[u(IKOTBL001)
000030************************************************
000040 01  hjnOOP|R[h PIC  X(008).
000050 01  hjnOOP|ړIbc PIC  X(001).
000060 01  hjnOOP|VR[h PIC  X(007).
000070 01  hjnOOP|} PIC  X(003).
000080 01  hjnOOP|^MR[h PIC  X(007).
000090 01  hjnOOP|񂹃R[h PIC  X(008).
000100 01  hjnOOP|[UR[h PIC  X(008).
000110 01  hjnOOP|ʂbc PIC  X(001).
001140     
      *    EXEC  SQL  INCLUDE  IKOTBL002.CBL         END-EXEC.
001150                                                                  
000010************************************************
000020* _ޓϊe[u(IKOTBL002)
000030************************************************
000040 01  hjnOOQ|_mn PIC  X(009).
000050 01  hjnOOQ|ă[XR[h PIC S9(001) COMP-3.
000060 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000070 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000080 01  hjnOOQ|ă[X PIC S9(002) COMP-3.
000090 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000100 01  hjnOOQ|菈R[h PIC S9(002) COMP-3.
000110 01  hjnOOQ|_ PIC  X(003).
000120 01  hjnOOQ|_敪 PIC  X(001).
000130 01  hjnOOQ|菇 PIC  X(001).
001160     
      *    EXEC  SQL  INCLUDE  IKOTBL005.CBL         END-EXEC.
001170*                                                                 
001180                                                                  
000010************************************************
000020* R[hϊe[u(IKOTBL005)
000030************************************************
000040 01  hjnOOT|R[h PIC  X(003).
000050 01  hjnOOT|ANZX敪 PIC  X(001).
000060 01  hjnOOT|菈R[h PIC  X(002).
000070 01  hjnOOT|ŃR[h PIC  X(002).
000080 01  hjnOOT|Z敪 PIC S9(001) COMP-3.
000090 01  hjnOOT|萔R[h PIC  X(002).
000100 01  hjnOOT|ă[XR[h PIC S9(001) COMP-3.
000110 01  hjnOOT|v敪 PIC S9(001) COMP-3.
000120 01  hjnOOT|敪P PIC S9(001) COMP-3.
000130 01  hjnOOT|P PIC  X(001).
000140 01  hjnOOT|敪Q PIC  X(001).
000150 01  hjnOOT|_ޏP PIC S9(001) COMP-3.
000160 01  hjnOOT|VR[h PIC  X(003).
000170 01  hjnOOT|VR[hQ PIC  X(003).
001190     
      *    EXEC  SQL  END  DECLARE          SECTION  END-EXEC.
001200*                                                                 
001210*----------------------------------------------------------------*
001220*    vnqjGA                                              *
001230*----------------------------------------------------------------*
001240 01  vnqj|GA.                                            
001250*--< G[p >                                               
001260     03  v|G[R[h             PIC S9(04).                 
001270     03  v|                     PIC X(02).                  
001280*                                                                 
001290*--< tOAA >                                               
001300     03  tOAA.                                            
001310         05  v|I|tO         PIC  X(01).                 
001320         05  v|ُI|tO     PIC  X(01).                 
001330*                                                                 
001340*--< GA >                                                 
001350     03  GA.                                              
001360         05  v|́|           PIC  9(09).                 
001361         05  v|́|P         PIC  9(09).                 
001370         05  v|ó|           PIC  9(09).                 
001380*                                                                 
001390*                                                                 
001400*--< ʏ >                                                   
001410 01  v|ʏ.                                                
001420     03  v|VXet.                                        
001430         05  v|I                 PIC  X(02) VALUE  "20".     
001440         05  v|N               PIC  X(06).                 
001450     03  v|VXe             PIC  X(08).                 
001460     03  v|S                   PIC  X(08) VALUE "IKOPG   ".
001470                                                                  
001480*----------------------------------------------------------------*
001490*    Tu[`                                              *
001500*----------------------------------------------------------------*
001510 01  CALL-AREA.                                                   
001520*--< ʃOTu[` >                                       
001530     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001540     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001550*                                                                 
001560*----------------------------------------------------------------*
001570*    bnoẍ                                                *
001580*----------------------------------------------------------------*
001590*--< ʃOpp[^ >                                       
001600 01  IF-CHOCO001.                                                 
001610     COPY  CHOCO001  REPLACING  ==()==  BY  ==P|==.           
001620*                                                                 
001630*----------------------------------------------------------------*
001640*    hmht@CǍTu[`pp^̈                *
001650*----------------------------------------------------------------*
001660 01  PARA-AREA.                                                   
001670     COPY CPBCO001.                                               
001680******************************************************************
001690*    萔pf[^`GA                                      *
001700******************************************************************
001710 CONSTANT                             SECTION.                    
001720 01  萔̈.                                                    
001730     03  萔|vOhc         PIC  X(08) VALUE "COBIS420".
001740     03  萔|vO           PIC  X(80)                  
001750                              VALUE  "]pڍs".
001760     03  萔|rpknj             PIC S9(04)  VALUE  ZERO.    
001770     03  萔|rpkdmc           PIC S9(04)  VALUE  0100.    
001780     03  萔|               PIC S9(04)  VALUE  ZERO.    
001790     03  萔|ُ               PIC S9(04)  VALUE  0009.    
001800******************************************************************
001810*    oqnbdctqd            chuhrhnm              *
001820******************************************************************
001830 PROCEDURE                            DIVISION.                   
001840*                                                                 
001850     PERFORM  .                                           
001860*                                                                 
001870     PERFORM  又  UNTIL  v|I|tO  =  "Y".            
001880*                                                                 
001890     PERFORM  I.                                           
001900*                                                                 
001910     STOP     RUN.                                                
001920*                                                                 
001930******************************************************************
001940*                            (NO 1.)                     *
001950******************************************************************
001960                              SECTION.                    
001970 |rs`qs.                                            
001980*                                                                 
001990*----------------------------------------------------------------*
002000*    JnbZ[Wo͏                                      *
002010*----------------------------------------------------------------*
002020     INITIALIZE                       IF-CHOCO001.                
002030     MOVE  "3"                        TO  P|Cxg.     
002040     MOVE  萔|vOhc       TO  P|\[Xhc.       
002050     MOVE  "0"                        TO  P|AR[h.       
002060     MOVE  "START"                    TO  P|.         
002070     MOVE  萔|vO         TO  P|̑bZ[W. 
002080     CALL  CLOCO001                USING  IF-CHOCO001.            
002090*                                                                 
002100*----------------------------------------------------------------*
002110*    Ɨ̈̏l                                        *
002120*----------------------------------------------------------------*
002130     MOVE  SPACE                      TO  vnqj|GA.       
002140     INITIALIZE                           vnqj|GA.       
002150*                                                                 
002160*--< bott擾 >                                           
002170     ACCEPT    v|N               FROM  DATE.               
002180*                                                                 
002190*--< bot擾 >                                           
002200     ACCEPT    v|VXe         FROM  TIME.               
002210*                                                                 
002220*--< nq`bkdڑ >                                           
002230     PERFORM   nq`bkdڑ.                                  
002240*                                                                 
002250*--< {׃e[uJ[\錾 >                   
002260     PERFORM  {ׂ͂̌.                       
002270*                                                                 
002280*--<t@CI[v>                                             
002290     PERFORM  t@CI[v.                                   
002300*                                                                 
002310*--<Kpt@Cǂ>                                       
002320     PERFORM   Kpt@Cǂ.                            
002330*                                                                 
002340*--<{׃e[uJ[\Ǎ>                     
002350     PERFORM   {׃J[\Ǎ.                      
002360*                                                                 
002370 |dwhs.                                              
002380     EXIT.                                                        
002390******************************************************************
002400*    nq`bkdڑ                 (NO 1.1)                   *
002410******************************************************************
002420 nq`bkdڑ                     SECTION.                    
002430 nq`bkdڑ|rs`qs.                                    
002440*                                                                 
002450*--< caڑp擾 >                                   
002460     CALL  COBCO001                USING  PARA-AREA.              
002470*                                                                 
002480     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002490     MOVE  PARA-USERNAME              TO  USERNAME.               
002500     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002510*                                                                 
002520*----------------------------------------------------------------*
002530*    Jnڑ                                                    *
002540*----------------------------------------------------------------*
002550     IF    DB-STRING  =  SPACE                                    
002560        
      *       EXEC SQL                                                  
002570*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002580*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002590     ELSE                                                         
002600        
      *       EXEC SQL                                                  
002610*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002620*            USING  :DB-STRING                                    
002630*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002640     END-IF.                                                      
002650*                                                                 
002660*----------------------------------------------------------------*
002670*    ڑmF                                                    *
002680*----------------------------------------------------------------*
002690     EVALUATE  SQLCODE                                            
002700        WHEN   萔|rpknj                                   
002710           CONTINUE                                               
002720        WHEN   OTHER                                              
002730*--<       ڑG[ >                                           
002740           MOVE     -10               TO  v|G[R[h        
002750           PERFORM  G[菈                                
002760     END-EVALUATE.                                                
002770*                                                                 
002780 nq`bkdڑ|dwhs.                                      
002790     EXIT.                                                        
002810******************************************************************
002820*        {ׂ͂̌.     (NO 1.2)              *
002830******************************************************************
002840 {ׂ͂̌                SECTION.             
002850 {ׂ͂̌|rs`qs.                        
002860*----------------------------------------------------------------*
002870*    J[\nodm                                        *
002880*----------------------------------------------------------------*
002890     
      *    EXEC SQL                                                     
002900*      DECLARE CUR1  CURSOR FOR                                   
002910*        SELECT  LTRSMK._mn                              
002920*               ,LTRSMK.ă[XR[h                            
002930* 	      ,LTRSMK.菈R[h                        
002940*               ,LTRSMM.[XJnQI                        
002950*               ,LTRSMM.[XJnQN                      
002960*               ,LTRSMM.QI                      
002970*               ,LTRSMM.QN                    
002980*               ,LTRSMM.z                              
002990*               ,LTRSMM.                                
003000*               ,LTRSMM.f[^쐬QI                    
003010*               ,LTRSMM.f[^쐬QN                  
003020*               ,LTRSMM.ă[XR[h                            
003030*               ,LTRSMM.R[h                            
003040*               ,LTRSMM.R[h                            
003050*               ,LTRSMM.ă[XR[h                            
003060*               ,LTRSMM._mn                              
003070*               ,LTRSMM.菈R[h                        
003080*               ,LTRSMM.R[h                            
003090*          FROM  LTRSMK                                           
003100*               ,LTRSMM                                           
003110*          WHERE  LTRSMK._mn  =  LTRSMM._mn     
003120*            AND  LTRSMK.ă[XR[h  =                        
003130*                                       LTRSMM.ă[XR[h     
003140*            AND  (SUBSTR(LTRSMM.R[h,1,1)='1'          
003150* 	    OR  LTRSMM.R[h='46'                      
003160* 	    OR  LTRSMM.R[h='56')                     
003170* 	   AND  z <> 0                               
003180*    END-EXEC.
003190*----------------------------------------------------------------*
003200*    J[\nodm                                        *
003210*----------------------------------------------------------------*
003220     
      *    EXEC  SQL                                                    
003230*       OPEN  CUR1                                                
003240*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
003250*                                                                 
003260*----------------------------------------------------------------*
003270*    J[\nodmmF                                        *
003280*----------------------------------------------------------------*
003290     EVALUATE  SQLCODE                                            
003300        WHEN  萔|rpknj                                    
003310*--<        >                                                 
003320           CONTINUE                                               
003330        WHEN  OTHER                                               
003340*--<       J[\nodmG[ >                               
003350           MOVE  -20                   TO  v|G[R[h       
003360           PERFORM  G[菈                                
003370     END-EVALUATE.                                                
003380*                                                                 
003390 {ׂ͂̌|dwhs.                          
003400     EXIT.                                                        
003420******************************************************************
003430*                   t@CI[v.       (NO 1.3)             *
003440******************************************************************
003450 t@CI[v                     SECTION.                    
003460 t@CI[v|rs`qs.                                    
003470*----------------------------------------------------------------*
003480*   ]pt@CI[v                           *
003490*----------------------------------------------------------------*
003500     OPEN  OUTPUT  oJt@C.                                  
003510                                                                  
003520*----------------------------------------------------------------*
003530*   ]pt@CI[vmF                       *
003540*----------------------------------------------------------------*
003550     EVALUATE   v|                                          
003560        WHEN  ZERO                                                
003570*--<        >                                                 
003580           CONTINUE                                               
003590        WHEN  OTHER                                               
003600*--<       t@CnodmG[ >                               
003610           MOVE -30                   TO  v|G[R[h        
003620           PERFORM  G[菈                                
003630     END-EVALUATE.                                                
003640*                                                                 
003650*----------------------------------------------------------------*
003660*   Kpt@CI[v                                   *
003670*----------------------------------------------------------------*
003680     OPEN  INPUT  ̓t@C.                                   
003690*                                                                 
003700*----------------------------------------------------------------*
003710*   Kpt@CI[vmF                               *
003720*----------------------------------------------------------------*
003730     EVALUATE   v|                                          
003740        WHEN  ZERO                                                
003750*--<        >                                                 
003760           CONTINUE                                               
003770        WHEN  OTHER                                               
003780*--<       t@CnodmG[ >                               
003790           MOVE -40                   TO  v|G[R[h        
003800           PERFORM  G[菈                                
003810     END-EVALUATE.                                                
003820 t@CI[v|dwhs.                                      
003830     EXIT.                                                        
003850******************************************************************
003860*              Kpt@Cǂ.       (NO 1.5)            *
003870******************************************************************
003880 Kpt@Cǂ               SECTION.                    
003890 Kpt@Cǂ݁|rs`qs.                              
003900     READ    ̓t@C                                         
003910               AT  END  GO  TO   Kpt@Cǂ݁|dwhs.
003920*----------------------------------------------------------------*
003930*              Kpt@Cǂ݊mF                        *
003940*----------------------------------------------------------------*
003950     EVALUATE   v|                                          
003960        WHEN  ZERO                                                
003970*--<        >                                                 
003980           MOVE          ́[ TO     vr|         
003990        WHEN  OTHER                                               
004000*--<       ǂ݃G[ >                                           
004010           MOVE -50                   TO     v|G[R[h     
004020           PERFORM  G[菈                                
004030     END-EVALUATE.                                                
004040                                                                  
004050 Kpt@Cǂ݁|dwhs.                                
004060     EXIT.                                                        
004070******************************************************************
004080*        {׃J[\Ǎ.     (NO 1.6)              *
004090******************************************************************
004100 {׃J[\Ǎ         SECTION.                    
004110 {׃J[\Ǎ|rs`qs.                        
004120*--< {׃e[uJ[\Ǎ >                   
004130     
      *    EXEC SQL                                                     
004140*        FETCH  CUR1                                              
004150*         INTO  :ksqrlj|_mn                       
004160*              ,:ksqrlj|ă[XR[h                     
004170*              ,:ksqrlj|菈R[h		        
004180*              ,:ksqrll|[XJn|I                 
004190*              ,:ksqrll|[XJn|N               
004200*              ,:ksqrll||I               
004210*              ,:ksqrll||N             
004220*              ,:ksqrll|z                       
004230*              ,:ksqrll|                         
004240*              ,:ksqrll|f[^쐬|I             
004250*              ,:ksqrll|f[^쐬|N           
004260*              ,:ksqrll|ă[XR[h                     
004270*              ,:ksqrll|R[h                     
004280*              ,:ksqrll|R[h                     
004290*              ,:ksqrll|ă[XR[h                     
004300*              ,:ksqrll|_mn                       
004310*              ,:ksqrll|菈R[h                 
004320*              ,:ksqrll|R[h                     
004330*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 82 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ksqrlj|_mn
               SQL-SQHSTV(1)
           MOVE 10 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ksqrlj|ă[XR[h
               SQL-SQHSTV(2)
           MOVE 1 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ksqrlj|菈R[h
               SQL-SQHSTV(3)
           MOVE 2 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ksqrll|[XJn|I
               SQL-SQHSTV(4)
           MOVE 1 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ksqrll|[XJn|N
               SQL-SQHSTV(5)
           MOVE 6 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               ksqrll||I
               SQL-SQHSTV(6)
           MOVE 1 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               ksqrll||N
               SQL-SQHSTV(7)
           MOVE 6 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               ksqrll|z
               SQL-SQHSTV(8)
           MOVE 7 TO SQL-SQHSTL(8)
           MOVE 0 TO SQL-SQHSTS(8)
           MOVE 0 TO SQL-SQINDV(8)
           MOVE 0 TO SQL-SQINDS(8)
           MOVE 0 TO SQL-SQHARM(8)
           CALL "SQLADR" USING
               ksqrll|
               SQL-SQHSTV(9)
           MOVE 7 TO SQL-SQHSTL(9)
           MOVE 0 TO SQL-SQHSTS(9)
           MOVE 0 TO SQL-SQINDV(9)
           MOVE 0 TO SQL-SQINDS(9)
           MOVE 0 TO SQL-SQHARM(9)
           CALL "SQLADR" USING
               ksqrll|f[^쐬|I
               SQL-SQHSTV(10)
           MOVE 1 TO SQL-SQHSTL(10)
           MOVE 0 TO SQL-SQHSTS(10)
           MOVE 0 TO SQL-SQINDV(10)
           MOVE 0 TO SQL-SQINDS(10)
           MOVE 0 TO SQL-SQHARM(10)
           CALL "SQLADR" USING
               ksqrll|f[^쐬|N
               SQL-SQHSTV(11)
           MOVE 6 TO SQL-SQHSTL(11)
           MOVE 0 TO SQL-SQHSTS(11)
           MOVE 0 TO SQL-SQINDV(11)
           MOVE 0 TO SQL-SQINDS(11)
           MOVE 0 TO SQL-SQHARM(11)
           CALL "SQLADR" USING
               ksqrll|ă[XR[h
               SQL-SQHSTV(12)
           MOVE 1 TO SQL-SQHSTL(12)
           MOVE 0 TO SQL-SQHSTS(12)
           MOVE 0 TO SQL-SQINDV(12)
           MOVE 0 TO SQL-SQINDS(12)
           MOVE 0 TO SQL-SQHARM(12)
           CALL "SQLADR" USING
               ksqrll|R[h
               SQL-SQHSTV(13)
           MOVE 2 TO SQL-SQHSTL(13)
           MOVE 0 TO SQL-SQHSTS(13)
           MOVE 0 TO SQL-SQINDV(13)
           MOVE 0 TO SQL-SQINDS(13)
           MOVE 0 TO SQL-SQHARM(13)
           CALL "SQLADR" USING
               ksqrll|R[h
               SQL-SQHSTV(14)
           MOVE 8 TO SQL-SQHSTL(14)
           MOVE 0 TO SQL-SQHSTS(14)
           MOVE 0 TO SQL-SQINDV(14)
           MOVE 0 TO SQL-SQINDS(14)
           MOVE 0 TO SQL-SQHARM(14)
           CALL "SQLADR" USING
               ksqrll|ă[XR[h
               SQL-SQHSTV(15)
           MOVE 1 TO SQL-SQHSTL(15)
           MOVE 0 TO SQL-SQHSTS(15)
           MOVE 0 TO SQL-SQINDV(15)
           MOVE 0 TO SQL-SQINDS(15)
           MOVE 0 TO SQL-SQHARM(15)
           CALL "SQLADR" USING
               ksqrll|_mn
               SQL-SQHSTV(16)
           MOVE 10 TO SQL-SQHSTL(16)
           MOVE 0 TO SQL-SQHSTS(16)
           MOVE 0 TO SQL-SQINDV(16)
           MOVE 0 TO SQL-SQINDS(16)
           MOVE 0 TO SQL-SQHARM(16)
           CALL "SQLADR" USING
               ksqrll|菈R[h
               SQL-SQHSTV(17)
           MOVE 2 TO SQL-SQHSTL(17)
           MOVE 0 TO SQL-SQHSTS(17)
           MOVE 0 TO SQL-SQINDV(17)
           MOVE 0 TO SQL-SQINDS(17)
           MOVE 0 TO SQL-SQHARM(17)
           CALL "SQLADR" USING
               ksqrll|R[h
               SQL-SQHSTV(18)
           MOVE 1 TO SQL-SQHSTL(18)
           MOVE 0 TO SQL-SQHSTS(18)
           MOVE 0 TO SQL-SQINDV(18)
           MOVE 0 TO SQL-SQINDS(18)
           MOVE 0 TO SQL-SQHARM(18)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004340*----------------------------------------------------------------*
004370*    {׃J[\ǍǍmF                      *
004380*----------------------------------------------------------------*
004390     EVALUATE   SQLCODE                                           
004400        WHEN   萔|rpknj                                   
004410*--<        >                                                 
004420                                                                  
004430        COMPUTE  v|́|  =  v|́|  +  1          
004431        COMPUTE  v|́|P =  v|́|P + 1         
004440        WHEN   萔|rpkdmc                                 
004450*--<       ǍI >                                             
004460           MOVE  "Y"                  TO  v|I|tO        
004470        WHEN   OTHER                                              
004480*--<       ǍG[ >                                           
004490           MOVE     -60               TO  v|G[R[h        
004500           PERFORM  G[菈                                
004510     END-EVALUATE.                                                
004520*                                                                 
004530 {׃J[\Ǎ|dwhs.                          
004540     EXIT.                                                        
004550******************************************************************
004560*                        又          (NO 2.)                 *
004570******************************************************************
004580 又                               SECTION.                    
004590 又|rs`qs.                                              
004600*--<o>                                                     
004610     PERFORM    o.                                         
004620*                                                                 
004630*--<oҏW >                                                    
004640     PERFORM    oҏW.                                         
004650*                                                                 
004660*--<ooJ>                                                     
004670     PERFORM    ooJ.                                         
004680*                                                                 
004690*--<{׃J[\Ǎ(Qڈȍ~)>                     
004700     PERFORM    {׃J[\Ǎ.                     
004710                                                                  
004720 又|dwhs.                                                
004780     EXIT.                                                        
004790*                                                                 
004800******************************************************************
004810*                        o       (NO 2.1)                 *
004820******************************************************************
004830 o                             SECTION.                    
004840 o|rs`qs.                                            
004850*                                                                 
004851     MOVE  ksqrlj|_mn(2:9)                        
004852                                      TO   vr|_mn.    
004860*--<{o>                                             
004890     PERFORM    {o.                                 
004910*                                                                 
004920*--<גo>                                             
004930     PERFORM    גo.                                 
004950*                                                                 
004960*--<׏񒊏o>                                         
004970     PERFORM    ׏񒊏o.                             
004990*                                                                 
005000*--<R[hϊe[uo>                           
005010     PERFORM    R[hϊe[uo.               
005020*                                                                 
005030 o|dwhs.                                              
005040     EXIT.                                                        
005060******************************************************************
005070*                   {o       NO(2.1.1)             *
005080******************************************************************
005090 {o                     SECTION.                    
005100 {o|rs`qs.                                    
005110*                                                                 
005120*--<擾ă[X>                                             
005130     PERFORM    _ޓϊ擾.                               
005140*                                                                 
005150*--<擾A>                                                     
005190     PERFORM    擾A.                                         
005200*                                                                 
005210 {o|dwhs.                                      
005220     EXIT.                                                        
005240******************************************************************
005250*              _ޓϊ擾ă[X  (NO 2.1.1.1)      *
005260******************************************************************
005270 _ޓϊ擾                   SECTION.                    
005280 _ޓϊ擾|rs`qs.                                  
005290*                                                                 
005300*----------------------------------------------------------------*
005310*                ă[X񐔂̌                              *
005320*----------------------------------------------------------------*
005330     
      *    EXEC  SQL                                                    
005340*                                                                 
005350*             SELECT  ă[X                                
005351*                    ,_                                    
005352*                    ,_敪                                  
005360*                                                                 
005370*               INTO  :hjnOOQ|ă[X                 
005371*                    ,:hjnOOQ|_                     
005372*                    ,:hjnOOQ|_敪                   
005380*                                                                 
005390*               FROM  IKOTBL002                                   
005400*                                                                 
005410*              WHERE  _mn  = :vr|_mn             
005420*                AND  ă[XR[h  =                           
005430*                                :ksqrlj|ă[XR[h    
005440*                AND  菈R[h =                        
005450*                                :ksqrlj|菈R[h
005460*    END-EXEC.
           CALL "SQLADR" USING SQ0002 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 169 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               hjnOOQ|ă[X
               SQL-SQHSTV(1)
           MOVE 2 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               hjnOOQ|_
               SQL-SQHSTV(2)
           MOVE 3 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               hjnOOQ|_敪
               SQL-SQHSTV(3)
           MOVE 1 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               vr|_mn
               SQL-SQHSTV(4)
           MOVE 9 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ksqrlj|ă[XR[h
               SQL-SQHSTV(5)
           MOVE 1 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               ksqrlj|菈R[h
               SQL-SQHSTV(6)
           MOVE 2 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005470*----------------------------------------------------------------*
005480*                ă[X񐔂̌mF                          *
005490*----------------------------------------------------------------*
005500      EVALUATE   SQLCODE                                          
005510        WHEN   萔|rpknj                                   
005520*--<        >                                                 
005530           CONTINUE                                               
005540        WHEN   OTHER                                              
005550*--<       ǍȂ >                                           
005560           MOVE     ZERO              TO                          
005570                                    hjnOOQ|ă[X    
005571           MOVE     SPACE             TO   hjnOOQ|_ 
005572           MOVE     ZERO              TO  hjnOOQ|_敪
005580           MOVE     -70               TO  v|G[R[h        
005590           PERFORM  G[菈                                
005600     END-EVALUATE.                                                
005610*                                                                 
005620 _ޓϊ擾|dwhs.                                    
005630     EXIT.                                                        
005640******************************************************************
006050*              擾A                (NO 2.1.1.2)              *
006060******************************************************************
006070 擾A                             SECTION.                    
006080 擾Aԁ|rs`qs.                                            
006090*--<NEWL[̏l>                                          
006100      MOVE      SPACE                 TO  vr|mdvL[.       
006110      INITIALIZE                          vr|mdvL[.       
006120*                                                                 
006130      MOVE      ksqrlj|_mn(2:9)                   
006140                                      TO  vr|mdv|_ԍ. 
006150      MOVE      hjnOOQ|ă[X                        
006160                                   TO  vr|mdv|ă[X.
006170      MOVE      hjnOOQ|_                            
006180                                      TO  vr|mdv|_ .
006190      IF      vr|mdvL[  =  vr|nkcL[               
006200              COMPUTE   vr|A  =  vr|A  +  1           
006210      ELSE                                                        
006220              MOVE   1                TO     vr|A           
006230      END-IF.                                                     
006240*                                                                 
006250*--<OLDL[̏l>                                          
006260      MOVE      SPACE                 TO  vr|nkcL[.       
006270      INITIALIZE                          vr|nkcL[.       
006280*                                                                 
006290      MOVE    vr|mdvL[           TO    vr|nkcL[.  
006300 擾Aԁ|dwhs.                                              
006310      EXIT.                                                       
006320******************************************************************
006330*              גo         NO(2.1.2)                *
006340******************************************************************
006350 גo                     SECTION.                    
006360 גo|rs`qs.                                    
006370*--<擾VR[h>                                           
006380*                                                                 
006390     PERFORM   R[hϊe[u.                            
006400*                                                                 
006450*--<擾>                                                     
006460*                                                                 
006470     PERFORM   擾.                                          
006480*                                                                 
006490*--<擾sσtO>                                       
006500*                                                                 
006510     PERFORM   擾sσtO.                            
006520*                                                                 
006530*--<R[hR[hϊ>                                   
006540*                                                                 
006550     PERFORM   R[hR[hϊ.                        
006560*                                                                 
006570*--<擾R[h>                                           
006580*                                                                 
006590     PERFORM   擾R[h.                                
006600*                                                                 
006610 גo|dwhs.                                      
006620     EXIT.                                                        
006640******************************************************************
006650*           R[hϊe[u        (NO 2.1.2.1)            *
006660******************************************************************
006670 R[hϊe[u               SECTION.                    
006680 R[hϊe[u|rs`qs.                              
006690*                                                                 
006700*----------------------------------------------------------------*
006710*           R[hϊe[ǔ                         *
006720*----------------------------------------------------------------*
006730     
      *    EXEC    SQL                                                  
006740*                                                                 
006750*         SELECT   VR[h                                 
006751*                 ,}                                           
006760*                                                                 
006770*           INTO  :hjnOOP|VR[h                   
006771*                ,:hjnOOP|}                             
006780*                                                                 
006790*           FROM   IKOTBL001                                      
006800*                                                                 
006810*          WHERE   R[h  =  :ksqrll|R[h 
006820*    END-EXEC.
           CALL "SQLADR" USING SQ0003 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 208 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               hjnOOP|VR[h
               SQL-SQHSTV(1)
           MOVE 7 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               hjnOOP|}
               SQL-SQHSTV(2)
           MOVE 3 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ksqrll|R[h
               SQL-SQHSTV(3)
           MOVE 8 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
006830*                                                                 
006840*----------------------------------------------------------------*
006850*           R[hϊe[umF                           *
006860*----------------------------------------------------------------*
006870     EVALUATE   SQLCODE                                           
006880        WHEN   萔|rpknj                                   
006890*--<        >                                                 
006900           CONTINUE                                               
006910        WHEN   OTHER                                              
006920*--<       ǍȂ >                                           
006930           MOVE     ZERO              TO                          
006940                                      hjnOOP|VR[h
006941           MOVE     ZERO              TO  hjnOOP|}      
006950           MOVE     -80               TO  v|G[R[h        
006960           PERFORM  G[菈                                
006970      END-EVALUATE.                                               
006980                                                                  
006990  R[hϊe[u|dwhs.                               
007000     EXIT.                                                        
007020******************************************************************
007400*           擾                   (NO 2.1.2.2)              *
007410******************************************************************
007420 擾                             SECTION.                    
007430 擾|rs`qs.                                            
007440     MOVE          SPACE              TO    vr|. 
007450     INITIALIZE                             vr|. 
007470     INITIALIZE                             vr|sdlo.   
007480     MOVE     ksqrll||I                  
007490                                      TO   vr|sdlo.    
007500     MOVE     ksqrll||N                
007510                                      TO   vr|N.          
007520     IF       vr|sdlo  =  ZERO                         
007530            MOVE      19              TO   vr|I             
007540     ELSE                                                         
007550            MOVE      20              TO   vr|I             
007560     END-IF.                                                      
007561     MOVE   vr|(1:4) TO    vr|N.           
007570     MOVE         SPACE               TO   vr|[XJn.    
007580     INITIALIZE                            vr|[XJn.    
007600     INITIALIZE                            vr|sdlo.    
007610     MOVE     ksqrll|[XJn|I                    
007620                                      TO   vr|sdlo.    
007630     MOVE     ksqrll|[XJn|N                  
007640                                      TO vr|JnN.      
007650     IF       vr|sdlo  =  0                            
007660              MOVE    19              TO vr|JnI         
007670     ELSE                                                         
007680              MOVE    20              TO vr|JnI         
007690     END-IF.                                                      
007700     MOVE   vr|N(3:2)         TO    vr|.             
007710     MOVE   vr|JnN(3:2)   TO    vr|Jn.         
007711     MOVE   vr|[XJn(1:4) TO    vr|NP.           
007721     COMPUTE  vr|  =   (vr|N - vr|NP) * 12.   
007872     COMPUTE  vr|  = vr| + vr| - vr|Jn. 
007880 擾|dwhs.                                              
007890     EXIT.                                                        
007910******************************************************************
007920*           擾sσtO         (NO 2.1.2.3)          *
007930******************************************************************
007940 擾sσtO               SECTION.                    
007950 擾sσtO|rs`qs.                              
007960                                                                  
007970     IF   ksqrll|f[^쐬|I  =  ZERO           
007980	                                                                
007990	        MOVE        19              TO                          
008000                                      vr|f[^쐬|I
008010	   ELSE                                                         
008020	                                                                
008030		MOVE        20              TO                          
008040                                      vr|f[^쐬|I
008050	   END-IF.                                                      
008060                                                                  
008070	   MOVE  ksqrll|f[^쐬|N                 
008080	                                    TO                          
008090                                    vr|f[^쐬|N
008091     MOVE     ́[            TO  vr|.           
008100     IF   vr|f[^쐬  <  vr|                 
008110                                                                  
008120	         MOVE         "1"           TO  vr|sσtO
008130                                                                  
008140     ELSE                                                         
008150                                                                  
008160          MOVE         "0"            TO  vr|sσtO
008170	                                                                
008180     END-IF.                                                      
008190                                                                  
008200 擾sσtO|dwhs.                                
008210     EXIT.                                                        
008220******************************************************************
008230*           R[hR[hϊ      (NO 2.1.2.4)         *
008240******************************************************************
008250 R[hR[hϊ           SECTION.                    
008260 R[hR[hϊ|rs`qs.                          
008270*                                                                 
008280      EVALUATE      ksqrll|R[h                  
008290                                                                  
008300	       WHEN   1                                                 
008310	                                                                
008320		   MOVE   "0"               TO      vr|R[h
008330         WHEN   2                                                 
008340	                                                                
008350	           MOVE   "5"               TO      vr|R[h
008360         WHEN   3                                                 
008370                                                                  
008380	           MOVE    "3"              TO      vr|R[h
008390         WHEN   4                                                 
008400	           MOVE    "4"              TO      vr|R[h
008410         WHEN OTHER                                               
008420             MOVE    "0"              TO      vr|R[h
008430     END-EVALUATE.                                                
008440                                                                  
008450 R[hR[hϊ|dwhs.                            
008460     EXIT.                                                        
008480******************************************************************
008490*           擾R[h          (NO 2.1.2.5)             *
008500******************************************************************
008510 擾R[h                   SECTION.                    
008520 擾R[h|rs`qs.                                  
008530                                                                  
008531      MOVE       ZERO                 TO   vr|tO.          
008540      IF   ksqrll|菈R[h  =  89                
008550                                                                  
008560	        MOVE     "U00"              TO   vr|R[h   
008570          MOVE       1                TO   vr|tO           
008580      END-IF.                                                     
008590      IF    (ksqrll|菈R[h  =  52  OR          
008600             ksqrll|菈R[h  = 62)              
008610        AND ksqrll|R[h  =  "56"                 
008620        AND hjnOOQ|_敪  =  "5"                      
008630        AND hjnOOQ|_(1:1)  NOT =  "6"               
008640                                                                  
008650           MOVE    "W01"              TO   vr|R[h   
008651           MOVE       1               TO   vr|tO           
008660                                                                  
008670      END-IF.                                                     
008680      IF    (ksqrll|菈R[h  =  52  OR          
008690             ksqrll|菈R[h  =  62)             
008700        AND ksqrll|R[h  =  "56"                 
008710        AND hjnOOQ|_敪  =  "5"                      
008720        AND hjnOOQ|_(1:1)  =  "6"                   
008730                                                                  
008740           MOVE    "WO2"              TO   vr|R[h   
008741           MOVE       1               TO   vr|tO           
008750      END-IF.                                                     
008760      IF    (ksqrll|菈R[h  =  52  OR          
008770             ksqrll|菈R[h  = 62)              
008780       AND ksqrll|R[h  =  "56"                  
008790       AND hjnOOQ|_敪  =  "0"                       
008800                                                                  
008810	         MOVE    "W51"              TO   vr|R[h   
008811           MOVE       1               TO   vr|tO           
008820      END-IF.                                                     
008830      IF    (ksqrll|菈R[h  =  51  OR          
008840             ksqrll|菈R[h  =  61)             
008850        AND ksqrll|R[h  =  "56"                 
008860        AND hjnOOQ|_敪  =  "0"                      
008870                                                                  
008880	         MOVE    "W52"              TO   vr|R[h   
008881           MOVE       1               TO   vr|tO           
008890      END-IF.                                                     
008900      IF     ksqrll|菈R[h  =  39              
008910         AND ksqrll|R[h  =  "46"                
008920	       AND hjnOOQ|_敪  =  "5"                     
008930         AND hjnOOQ|_(1:1)  NOT =  "6"              
008940                                                                  
008950	       MOVE    "V01"                TO   vr|R[h   
008951         MOVE       1                 TO   vr|tO           
008960      END-IF.                                                     
008970      IF     ksqrll|菈R[h  =  39              
008980         AND ksqrll|R[h  =  "46"                
008990	       AND hjnOOQ|_敪  =  "5"                     
009000         AND hjnOOQ|_(1:1)   =  "6"                 
009010                                                                  
009020	       MOVE    "V02"                TO   vr|R[h   
009021         MOVE       1                 TO   vr|tO           
009030      END-IF.                                                     
009031      IF     vr|tO  =  ZERO                                
009032         MOVE      ZERO               TO   vr|R[h   
009033      END-IF.                                                     
009040 擾R[h|dwhs.                                    
009050      EXIT.                                                       
009070******************************************************************
009080*           ׏񒊏o       (NO 2.1.3)                *
009090******************************************************************
009100 ׏񒊏o                 SECTION.                    
009110 ׏񒊏o|rs`qs.                                
009120*                                                                 
009130*--<擾p̉ϊz>                                       
009140*                                                                 
009150      PERFORM    擾p̉ϊz.                          
009160*                                                                 
009170*--<sۂɃZbgŐV̏ʔ>               
009180*                                                                 
009190      PERFORM    ŐV.                                    
009200*                                                                 
009250 ׏񒊏o|dwhs.                                  
009260      EXIT.                                                       
009280******************************************************************
009290*                擾p̉ϊz   (NO 2.1.3.1)           *
009300******************************************************************
009310 擾p̉ϊz                       SECTION.            
009320 擾p̉ϊz|rs`qs.                              
009330*----------------------------------------------------------------*
009340*                擾p̉ϊž                    *
009350*----------------------------------------------------------------*
009360                                                                  
009370     
      *    EXEC   SQL                                                   
009380*                                                                 
009390*           SELECT  z                                      
009400*                  ,QN                                
009410*                  ,QI                                  
009420*             INTO :ksqrjl|z                        
009430*                 ,:ksqrjl||N                  
009440*                 ,:ksqrjl||I                    
009450*             FROM  LTRSKM                                        
009460*                                                                 
009470*            WHERE  _ԍ  =  :vr|_mn              
009480*              AND  ă[XR[h  =                             
009490*                                    :ksqrll|ă[XR[h
009500*              AND  R[h  = :vr|R[h       
009510*               AND  ˍσtO  =  NULL                         
009520*    END-EXEC.
           CALL "SQLADR" USING SQ0004 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 235 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ksqrjl|z
               SQL-SQHSTV(1)
           MOVE 7 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ksqrjl||N
               SQL-SQHSTV(2)
           MOVE 6 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ksqrjl||I
               SQL-SQHSTV(3)
           MOVE 1 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               vr|_mn
               SQL-SQHSTV(4)
           MOVE 9 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ksqrll|ă[XR[h
               SQL-SQHSTV(5)
           MOVE 1 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               vr|R[h
               SQL-SQHSTV(6)
           MOVE 3 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
009530*----------------------------------------------------------------*
009540*                擾p̉ϊž                    *
009550*----------------------------------------------------------------*
009560     EVALUATE   SQLCODE                                           
009570        WHEN   萔|rpknj                                   
009580*--<        >                                                 
009590           PERFORM     Sđ݂ꍇ                           
009600        WHEN   OTHER                                              
009610*--<       ǍȂ >                                           
009620           PERFORM     SĂȂ                                 
009630                                                                  
009640      END-EVALUATE.                                               
009650 擾p̉ϊz|dwhs.                                
009660      EXIT.                                                       
009680******************************************************************
009690*                Sđ݂ꍇ                                *
009700******************************************************************
009710 Sđ݂ꍇ                     SECTION.                    
009720 Sđ݂ꍇ|rs`qs.                                    
009730     IF    ksqrjl||I  =  ZERO                    
009740                                                                  
009750           MOVE        19             TO    vr|I            
009760     ELSE                                                         
009770           MOVE        20             TO    vr|I            
009780     END-IF.                                                      
009790     MOVE        ksqrjl||N                     
009800                                      TO    vr|N          
009810     IF    ksqrjl|z  >  ZERO                        
009820*--<NO 15>                                                        
009830           MOVE    ksqrll|z                     
009831                                     TO    oJ[z           
009840*--<NO 16>                                                        
009850           MOVE    ksqrll|                       
009860                                      TO    oJ[z    
009870*--<NO 17>                                                        
009880           MOVE    vr|                           
009890                                      TO    oJ[N      
009900     ELSE                                                         
009910           MOVE    ZERO               TO    oJ[z          
009920           MOVE    ZERO               TO    oJ[z    
009930           MOVE    ZERO               TO    oJ[N      
009940     END-IF.                                                      
009950 Sđ݂ꍇ|dwhs.                                      
009960     EXIT.                                                        
009970******************************************************************
009980*                SĂȂ                                      *
009990******************************************************************
010000 SĂȂ                           SECTION.                    
010010 SĂȂ|rs`qs.                                          
010020     IF    vr|(1:6)  > vr|(1:6)         
010030*--<p(No.1O)ҏW>                                       
010040           MOVE    ksqrll|z                     
010041                                      TO    oJ[z          
010050*--<p(No.11)ҏW>                                  
010060           MOVE    ksqrll|                       
010070                                      TO    oJ[z    
010080*--<\imXjҏW>                                   
010090           MOVE   vr| TO    oJ[N     
010100     ELSE                                                         
010110                                                                  
010120           MOVE    ZERO               TO    oJ[z          
010130           MOVE    ZERO               TO    oJ[z    
010140           MOVE    ZERO               TO    oJ[N      
010150     END-IF.                                                      
010160 SĂȂ|dwhs.                                            
010170     EXIT.                                                        
010180******************************************************************
010190*                ŐV           (NO 2.1.3.2)             *
010200******************************************************************
010210 ŐV                         SECTION.                    
010220 ŐV|rs`qs.                                        
010230*                                                                 
010240*----------------------------------------------------------------*
010250*                ŐV̌                              *
010260*----------------------------------------------------------------*
010270      
      *     EXEC     SQL                                                
010280*                                                                 
010290*             SELECT   ʔ                                   
010291*                     ,QN                             
010300*                                                                 
010310*               INTO  :ksqrjl|ʔ                     
010311*                    ,:ksqrjl||N               
010320*                                                                 
010330* 	      FROM   LTRSKM                                     
010340*                                                                 
010350*              WHERE   _ԍ  =   :vr|_mn          
010360*                AND   ă[XR[h  =                          
010370*                                    :ksqrll|ă[XR[h
010380* 	       AND   R[h  =  :vr|R[h   
010390*     END-EXEC.
            CALL "SQLADR" USING SQ0005 SQL-STMT
            MOVE 1 TO SQL-ITERS
            MOVE 274 TO SQL-OFFSET
            MOVE 0 TO SQL-OCCURS
            MOVE 1 TO SQL-SELERR
            CALL "SQLADR" USING
                SQLCUD
                SQL-CUD
            CALL "SQLADR" USING
                SQLCA
                SQL-SQLEST
            MOVE 256 TO SQL-SQLETY
            CALL "SQLADR" USING
                ksqrjl|ʔ
                SQL-SQHSTV(1)
            MOVE 5 TO SQL-SQHSTL(1)
            MOVE 0 TO SQL-SQHSTS(1)
            MOVE 0 TO SQL-SQINDV(1)
            MOVE 0 TO SQL-SQINDS(1)
            MOVE 0 TO SQL-SQHARM(1)
            CALL "SQLADR" USING
                ksqrjl||N
                SQL-SQHSTV(2)
            MOVE 6 TO SQL-SQHSTL(2)
            MOVE 0 TO SQL-SQHSTS(2)
            MOVE 0 TO SQL-SQINDV(2)
            MOVE 0 TO SQL-SQINDS(2)
            MOVE 0 TO SQL-SQHARM(2)
            CALL "SQLADR" USING
                vr|_mn
                SQL-SQHSTV(3)
            MOVE 9 TO SQL-SQHSTL(3)
            MOVE 0 TO SQL-SQHSTS(3)
            MOVE 0 TO SQL-SQINDV(3)
            MOVE 0 TO SQL-SQINDS(3)
            MOVE 0 TO SQL-SQHARM(3)
            CALL "SQLADR" USING
                ksqrll|ă[XR[h
                SQL-SQHSTV(4)
            MOVE 1 TO SQL-SQHSTL(4)
            MOVE 0 TO SQL-SQHSTS(4)
            MOVE 0 TO SQL-SQINDV(4)
            MOVE 0 TO SQL-SQINDS(4)
            MOVE 0 TO SQL-SQHARM(4)
            CALL "SQLADR" USING
                vr|R[h
                SQL-SQHSTV(5)
            MOVE 3 TO SQL-SQHSTL(5)
            MOVE 0 TO SQL-SQHSTS(5)
            MOVE 0 TO SQL-SQINDV(5)
            MOVE 0 TO SQL-SQINDS(5)
            MOVE 0 TO SQL-SQHARM(5)
            CALL "SQLADR" USING
                SQL-SQHSTV(1)
                SQL-SQPHSV
            CALL "SQLADR" USING
                SQL-SQHSTL(1)
                SQL-SQPHSL
            CALL "SQLADR" USING
                SQL-SQHSTS(1)
                SQL-SQPHSS
            CALL "SQLADR" USING
                SQL-SQINDV(1)
                SQL-SQPIND
            CALL "SQLADR" USING
                SQL-SQINDS(1)
                SQL-SQPINS
            CALL "SQLADR" USING
                SQL-SQHARM(1)
                SQL-SQPARM
            CALL "SQLADR" USING
                SQL-SQHARC(1)
                SQL-SQPARC

            CALL "SQLBEX" USING
                SQLCTX
                SQLEXD
                SQLFPN

            CALL "SQLGSS" USING
               SQLSTATE
                .
010400*----------------------------------------------------------------*
010410*                ŐVmF                                *
010420*----------------------------------------------------------------*
010430      EVALUATE   SQLCODE                                          
010440        WHEN   萔|rpknj                                   
010450*--<        >                                                 
010460           CONTINUE                                               
010470        WHEN   OTHER                                              
010480*--<       ǍȂ >                                           
010490           MOVE     ZERO              TO   ksqrjl|ʔ 
010491           MOVE     ZERO              TO                          
010492                                      ksqrjl||N
010500           MOVE     -90               TO   v|G[R[h       
010510           PERFORM     G[菈                             
010520      END-EVALUATE.                                               
010530                                                                  
010540 ŐV|dwhs.                                          
010550      EXIT.                                                       
010960******************************************************************
010970*             R[hϊe[uo   (NO 2.1.4)    *
010980******************************************************************
010990 R[hϊe[uo   SECTION.                    
011000 R[hϊe[uo|rs`qs.                  
011010*                                                                 
011020*----------------------------------------------------------------*
011030*           R[hϊe[ǔ                     *
011040*----------------------------------------------------------------*
011050     
      *    EXEC   SQL                                                   
011060*     SELECT    R[h                                  
011070*                                                                 
011080*       INTO   :hjnOOT|R[h                    
011090*                                                                 
011100*       FROM    IKOTBL005                                         
011110*                                                                 
011120*      WHERE    VR[h  =  :vr|R[h        
011130*    END-EXEC.
           CALL "SQLADR" USING SQ0006 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 309 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               hjnOOT|R[h
               SQL-SQHSTV(1)
           MOVE 3 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               vr|R[h
               SQL-SQHSTV(2)
           MOVE 3 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
011140*----------------------------------------------------------------*
011150*           R[hϊe[umF                       *
011160*----------------------------------------------------------------*
011170      EVALUATE   SQLCODE                                          
011180        WHEN   萔|rpknj                                   
011190*--<        >                                                 
011200           CONTINUE                                               
011210        WHEN   OTHER                                              
011220*--<       ǍȂ >                                           
011230           MOVE     ZERO              TO                          
011240                                    hjnOOT|R[h
011250           MOVE     -100              TO   v|G[R[h       
011260           PERFORM     G[菈                             
011270      END-EVALUATE.                                               
011280 R[hϊe[uo|dwhs.                    
011290      EXIT.                                                       
011310******************************************************************
011320*                     oҏW          (NO 2.2)                 *
011330******************************************************************
011340 oҏW                             SECTION.                    
011350 oҏW|rs`qs.                                            
011360*--<NO 1>                                                         
011370     MOVE   vr|_mn        TO   oJ[_ԍ.        
011390*--<NO 2>                                                         
011400     MOVE   hjnOOQ|ă[X                            
011410                                      TO   oJ[ă[X.    
011420*--<NO 3>                                                         
011430     MOVE   hjnOOQ|_    TO   oJ[_.        
011440*--<NO 4>                                                         
011450     MOVE   vr|A                TO   oJ[A.            
011460*--<NO 5>                                                         
011470     MOVE   hjnOOP|VR[h                          
011480                                      TO   oJ[R[h.    
011490*--<NO 6>                                                         
011500     MOVE   hjnOOP|}        TO   oJ[R[h.    
011510*--<NO 7>                                                         
011520     MOVE    vr|               TO   oJ[TCg.      
011530*--<NO 8>                                                         
011540     MOVE   ksqrll||N(5:2)             
011550                                      TO   oJ[.          
011560*--<NO 9>                                                         
011570     MOVE   vr|      TO   oJ[\.      
011580*--<NO 10>                                                        
011590     MOVE   ksqrll|z                            
011600                                      TO   oJ[p.        
011610*--<NO 11>                                                        
011620     MOVE   ksqrll|  TO   oJ[p.  
011630*--<NO 12>                                                        
011640     MOVE   ZERO                      TO   oJ[p萔.    
011650*--<NO 13>                                                        
011660     MOVE   oJ[p            TO   oJ[p㑍z.      
011670*--<NO 14>                                                        
011680     MOVE   oJ[p      TO   oJ[p㑍z.
011690                                                                  
011700*--<NO 18>                                                        
011710     COMPUTE   oJ[z  =  oJ[p㑍z                
011720                               +  oJ[p㑍z          
011730                               -  oJ[z                    
011740                               -  oJ[z.             
011750*--<NO 19>                                                        
011760     MOVE   vr|sσtO  TO                          
011770                                         oJ[sσtO.
011780*--<NO 20>                                                        
011790     MOVE   ZERO                      TO                          
011800                                     oJ[sσtO.
011810*--<NO 21>                                                        
011820     MOVE   ZERO                      TO   oJ[ԍ.      
011830*--<NO 22>                                                        
011840     MOVE   v|VXet          TO   oJ[XVN.      
011850*--<NO 23>                                                        
011860     MOVE   v|VXe          TO   oJ[XV.        
011870*--<NO 24>                                                        
011880     MOVE   v|S                TO   oJ[XV.          
011890*--<NO 25>                                                        
011900     MOVE   v|S                TO   oJ[͒S҃R[h.
011910*--<NO 26>                                                        
011920     MOVE   vr|R[h      TO   oJ[@.        
011930*--<NO 27>                                                        
011940     IF   hjnOOQ|_(1:1)  =  "6"                     
011950          MOVE    oJ[p      TO   oJ[\tgp   
011960     ELSE                                                         
011970          MOVE    ZERO                TO   oJ[\tgp   
011980     END-IF.                                                      
011990*--<NO 28>                                                        
012000     IF   hjnOOQ|_(1:1)  =  "6"                     
012010          MOVE   oJ[p TO                          
012020                                        oJ[\tgp
012030     ELSE                                                         
012040          MOVE    ZERO                TO                          
012050                                        oJ[\tgp
012060     END-IF.                                                      
012070*--<NO 29>                                                        
012080     MOVE   v|VXet          TO   oJ[o^N.      
012090*--<NO 30>                                                        
012100     MOVE   v|VXe          TO   oJ[o^.        
012110*--<NO 31>                                                        
012120     MOVE   v|S                TO   oJ[o^S.      
012130*--<NO 32>                                                        
012140     MOVE   vr|R[h      TO   oJ[R[h.  
012150*--<NO 33>                                                        
012160     MOVE   ksqrjl|ʔ    TO   oJ[ʔ.        
012170*--<NO 34>                                                        
012180     MOVE   oJ[N          TO   oJ[.      
012190*--<NO 35>                                                        
012200     MOVE   ksqrjl||N                          
012210                                      TO   oJ[N.      
012220*--<NO 36>                                                        
012230     IF     ksqrll|  NOT =  ZERO                 
012240            MOVE   0.05                TO   oJ[ŗ        
012250     ELSE                                                         
012260            MOVE   ZERO               TO   oJ[ŗ         
012270     END-IF.                                                      
012280*--<NO 37>                                                        
012290     IF     oJ[ŗ  =  ZERO                               
012300            MOVE   ZERO               TO   oJ[ŗ敪     
012310     ELSE                                                         
012320            MOVE   "12"               TO   oJ[ŗ敪     
012330     END-IF.                                                      
012340*--<NO 38>                                                        
012350     MOVE   ksqrll|ă[XR[h                          
012360                                      TO oJ[ă[XR[hP.
012370*--<NO 39>                                                        
012380     MOVE   hjnOOT|R[h                        
012390                                      TO oJ[R[hP.
012400*--<NO 40>                                                        
012410     IF     oJ[\(1:2)  =  20                          
012420                                                                  
012430	          MOVE         1            TO  vr|\|I
012440	   ELSE                                                         
012450	          MOVE         0            TO  vr|\|I
012460	   END-IF.                                                      
012470	   MOVE   oJ[\(3:6)     TO                          
012480                                       vr|\|N.
012490                                                                  
012500     MOVE   vr|\        TO    oJ[\P. 
012510 oҏW|dwhs.                                              
012520     EXIT.                                                        
012540******************************************************************
012550*                        ooJ           (NO 2.3)             *
012560******************************************************************
012570 ooJ                             SECTION.                    
012580 ooJ|rs`qs.                                            
012590*                                                                 
012600     WRITE   oJ[R[h.                                      
012610     EVALUATE   v|                                          
012620        WHEN   ZERO                                               
012630*--<    >                                                     
012640            COMPUTE  v|ó|  =  v|ó|  +  1      
012650                                                                  
012660        WHEN   OTHER                                              
012670*--<WRITE G[>                                                 
012680            MOVE     -110              TO  v|G[R[h       
012690                                                                  
012700            PERFORM  G[菈                               
012710                                                                  
012720     END-EVALUATE.                                                
012730                                                                  
012740 ooJ|dwhs.                                              
012750     EXIT.                                                        
012760******************************************************************
012770*                     I             (NO 3.)               *
012780******************************************************************
012790 I                             SECTION.                    
012800 I|rs`qs.                                            
012810*                                                                 
012820      PERFORM  caN[Y.                                  
012830*                                                                 
012840      CLOSE    oJt@C  ̓t@C.                        
012850*                                                                 
012860      PERFORM  IbZ[Wo.                                
012870*                                                                 
012880*--< vOI >                                         
012890      MOVE  萔|             TO  PROGRAM-STATUS.        
012900*                                                                 
012910 I|dwhs.                                              
012920      EXIT.                                                       
012930******************************************************************
012940*    IbZ[Wo           (NO 3.2)                       *
012950******************************************************************
012960 IbZ[Wo                   SECTION.                    
012970 IbZ[Wó|rs`qs.                                  
012980*                                                                 
012990*----------------------------------------------------------------*
013000*    bZ[Wo͏                                      *
013010*----------------------------------------------------------------*
013020     INITIALIZE                       IF-CHOCO001.                
013030     MOVE  "3"                        TO  P|Cxg.     
013040     MOVE  萔|vOhc       TO  P|\[Xhc.       
013050     MOVE  "0"                        TO  P|AR[h.       
013060     MOVE  "LTRSMM"                   TO  P|e[uhc. 
013070     MOVE  "COUNT"                    TO  P|.         
013080     MOVE  v|́|             TO  P|f[^e.       
013090     MOVE  "ד"             TO  P|̑bZ[W. 
013100     CALL  CLOCO001                USING  IF-CHOCO001.            
013110*                                                                 
013111     INITIALIZE                       IF-CHOCO001.                
013112     MOVE  "3"                        TO  P|Cxg.     
013113     MOVE  萔|vOhc       TO  P|\[Xhc.       
013114     MOVE  "0"                        TO  P|AR[h.       
013115     MOVE  "LTRSMK"                   TO  P|e[uhc. 
013116     MOVE  "COUNT"                    TO  P|.         
013117     MOVE  v|́|             TO  P|f[^e.       
013118     MOVE  "{"             TO  P|̑bZ[W. 
013119     CALL  CLOCO001                USING  IF-CHOCO001             
013120*                                                                 
013121     INITIALIZE                       IF-CHOCO001.                
013130     MOVE  "3"                        TO  P|Cxg.     
013140     MOVE  萔|vOhc       TO  P|\[Xhc.       
013150     MOVE  "0"                        TO  P|AR[h.       
013160     MOVE  "CISUF421"                 TO  P|e[uhc. 
013170     MOVE  "COUNT"                    TO  P|.         
013180     MOVE  v|ó|             TO  P|f[^e.       
013190     MOVE  "]pڍso"                       
013191                                      TO  P|̑bZ[W. 
013200     CALL  CLOCO001                USING  IF-CHOCO001.            
013210*                                                                 
013220*----------------------------------------------------------------*
013230*    IbZ[Wo                                          *
013240*----------------------------------------------------------------*
013250     INITIALIZE                       IF-CHOCO001.                
013260     MOVE  "3"                        TO  P|Cxg.     
013270     MOVE  萔|vOhc       TO  P|\[Xhc.       
013280     MOVE  "0"                        TO  P|AR[h.       
013290     MOVE  "END"                      TO  P|.         
013300     MOVE  萔|vO         TO  P|̑bZ[W. 
013310     CALL  CLOCO001                USING  IF-CHOCO001.            
013320*                                                                 
013330 IbZ[Wó|dwhs.                                    
013340     EXIT.                                                        
013350******************************************************************
013360*    caN[Y                  (NO 3.1)                      *
013370******************************************************************
013380 caN[Y                     SECTION.                    
013390 caN[Y|rs`qs.                                    
013400*                                                                 
013410*--< J[\ N[Y >                                          
013420     
      *    EXEC SQL                                                     
013430*       CLOSE  CUR1                                               
013440*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 332 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
013450*                                                                 
013460 caN[Y|dwhs.                                      
013470     EXIT.                                                        
013480******************************************************************
013490*    G[                                                  *
013500******************************************************************
013510 G[菈                       SECTION.                    
013520 G[菈|rs`qs.                                      
013530*                                                                 
013540     MOVE  "Y"                        TO  v|ُI|tO.   
013550     INITIALIZE                           IF-CHOCO001.            
013560*                                                                 
013570     EVALUATE  v|G[R[h                                   
013580        WHEN  -10                                                 
013590*--<       nq`bkdڑs >                                 
013600           MOVE  "1"                  TO  P|Cxg      
013610           MOVE  萔|vOhc TO  P|\[Xhc        
013620           MOVE  "9"                  TO  P|AR[h        
013630           MOVE  "CONNECT"            TO  P|          
013640           MOVE  SQLCODE              TO  P|f[^e        
013650           MOVE  SQLERRMC             TO  P|̑bZ[W  
013660           CALL  CLOCO001          USING  IF-CHOCO001             
013670*                                                                 
013680        WHEN  -20                                                 
013690*--<       e[uǍs >                                 
013700           MOVE  "1"                  TO  P|Cxg      
013710           MOVE  萔|vOhc TO  P|\[Xhc        
013720           MOVE  "9"                  TO  P|AR[h        
013730           MOVE  "LTRSMM"             TO  P|e[uhc  
013740           MOVE  "OPEN"           TO  P|          
013750           MOVE  SQLCODE              TO  P|f[^e        
013760           MOVE  SQLERRMC             TO  P|̑bZ[W  
013770           CALL  CLOCO001          USING  IF-CHOCO001             
013780*                                                                 
013790        WHEN  -30                                                 
013800*--<       ]pt@CI[vs >               
013810           MOVE  "1"                  TO  P|Cxg      
013820           MOVE  萔|vOhc TO  P|\[Xhc        
013830           MOVE  "9"                  TO  P|AR[h        
013840           MOVE  "FFUIS420"           TO  P|e[uhc  
013850           MOVE  "OPEN"               TO  P|          
013860           MOVE  SQLCODE              TO  P|f[^e        
013870           MOVE  SQLERRMC             TO  P|̑bZ[W  
013880           CALL  CLOCO001          USING  IF-CHOCO001             
013890*                                                                 
013900        WHEN  -40                                                 
013910*--<       Kpt@CI[vs >                       
013920           MOVE  "1"                  TO  P|Cxg      
013930           MOVE  萔|vOhc TO  P|\[Xhc        
013940           MOVE  "9"                  TO  P|AR[h        
013950           MOVE  "FFUISA01"           TO  P|e[uhc  
013960           MOVE  "OPEN"               TO  P|          
013970           CALL  CLOCO001          USING  IF-CHOCO001             
013980*                                                                 
013990        WHEN  -50                                                 
014000*--<       ǂݏs >                                         
014010           MOVE  "1"                  TO  P|Cxg      
014020           MOVE  萔|vOhc TO  P|\[Xhc        
014030           MOVE  "9"                  TO  P|AR[h        
014040           MOVE  "FFUISA01"           TO  P|e[uhc  
014050           MOVE  "READ"               TO  P|          
014060           MOVE  v|             TO  P|f[^e        
014070           MOVE  SQLERRMC             TO  P|̑bZ[W  
014080           CALL  CLOCO001          USING  IF-CHOCO001             
014090*                                                                 
014100        WHEN  -60                                                 
014110*--<       J[\s >                                     
014120           MOVE  "1"                  TO  P|Cxg      
014130           MOVE  萔|vOhc TO  P|\[Xhc        
014140           MOVE  "9"                  TO  P|AR[h        
014150           MOVE  "LTRSMM"             TO  P|e[uhc  
014160           MOVE  "FEACH"              TO  P|          
014170           MOVE  SQLCODE              TO  P|f[^e        
014180           MOVE  SQLERRMC             TO  P|̑bZ[W  
014190           CALL  CLOCO001          USING  IF-CHOCO001             
014200                                                                  
014210        WHEN  -70                                                 
014220*--<       ă[X񐔒os >                             
014230           MOVE  "2"                  TO  P|Cxg      
014240           MOVE  萔|vOhc TO  P|\[Xhc        
014250           MOVE  "9"                  TO  P|AR[h        
014260           MOVE  "IKO002"             TO  P|e[uhc  
014270           MOVE  "SELECT"             TO  P|          
014280           MOVE  SQLCODE              TO  P|f[^e        
014290           MOVE  SQLERRMC             TO  P|̑bZ[W  
014300           CALL  CLOCO001          USING  IF-CHOCO001             
014301           MOVE  "N"                  TO v|ُI|tO     
014310*                                                                 
014320        WHEN  -80                                                 
014330*--<       R[hos  >                            
014340           MOVE  "2"                  TO  P|Cxg      
014350           MOVE  萔|vOhc TO  P|\[Xhc        
014360           MOVE  "9"                  TO  P|AR[h        
014370           MOVE  "IKO001"             TO  P|e[uhc  
014380           MOVE  "SELECT"             TO  P|          
014390           MOVE  SQLCODE              TO  P|f[^e        
014400           MOVE  SQLERRMC             TO  P|̑bZ[W  
014410           CALL  CLOCO001          USING  IF-CHOCO001             
014420           MOVE  "N"                  TO v|ُI|tO     
014430*                                                                 
014440        WHEN  -90                                                 
014450*--<       sNos >                   
014460           MOVE  "2"                  TO  P|Cxg      
014470           MOVE  萔|vOhc TO  P|\[Xhc        
014480           MOVE  "9"                  TO  P|AR[h        
014490           MOVE  "LTRSKM"             TO  P|e[uhc  
014500           MOVE  "SELECT"             TO  P|          
014510           CALL  CLOCO001          USING  IF-CHOCO001             
014520           MOVE  "N"                  TO v|ُI|tO     
014530*                                                                 
014540        WHEN  -100                                                
014550*--<       R[hos >                           
014560           MOVE  "2"                  TO  P|Cxg      
014570           MOVE  萔|vOhc TO  P|\[Xhc        
014580           MOVE  "9"                  TO  P|AR[h        
014590           MOVE  "IKO005"             TO  P|e[uhc  
014600           MOVE  "SELECT"             TO  P|          
014610           CALL  CLOCO001          USING  IF-CHOCO001             
014620           MOVE  "N"                  TO v|ُI|tO     
014630*                                                                 
014640        WHEN  -110                                                
014650*--<       t@Co͏s >                                 
014660           MOVE  "1"                  TO  P|Cxg      
014670           MOVE  萔|vOhc TO  P|\[Xhc        
014680           MOVE  "9"                  TO  P|AR[h        
014690           MOVE  "FFUIS420"           TO  P|e[uhc  
014700           MOVE  "WRITE"              TO  P|          
014710           CALL  CLOCO001          USING  IF-CHOCO001             
014711           MOVE  "N"                  TO v|ُI|tO     
014720*                                                                 
014730        WHEN  OTHER                                               
014740           MOVE  "N"                  TO v|ُI|tO     
014750     END-EVALUATE.                                                
014760*                                                                 
014770     IF v|ُI|tO  =  "Y"                              
014780*                                                                 
014790        PERFORM  IbZ[Wo                               
014800*                                                                 
014810*--<    vOُĨ^[R[h >                      
014820        MOVE  萔|ُ          TO  PROGRAM-STATUS          
014830*                                                                 
014840        EXIT  PROGRAM                                             
014850     END-IF.                                                      
014860*                                                                 
014870 G[|dwhs.                                            
014880     EXIT.                                                        
014890******************************************************************
014900*                  END OF PROGRAM                                *
014910******************************************************************
