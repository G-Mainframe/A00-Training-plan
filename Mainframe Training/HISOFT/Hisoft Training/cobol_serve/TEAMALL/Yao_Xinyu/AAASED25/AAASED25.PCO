000010******************************************************************
000020*         ÅÉäCãPìÓåè(ëÂòA)ÅÑ                                     *
000030*      1. ÉvÉçÉOÉâÉÄñº  : ëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉãçÏê¨             *
000040*      2. ÉvÉçÉOÉâÉÄID  : AAASED25                               *
000050*      3. èàóùäTóv      : ëOéÛèÓïÒÇcÇaÇÉÅÉCÉìÇ…ÅAÉ}ÉXÉ^Ç∆ï\     *
000060*                         åãçáÇµÇƒì«çûÇ›ÅAëOéÛã‡éÛï•écçÇíÜä‘     *
000070*                         ÉtÉ@ÉCÉãÇçÏê¨Ç∑ÇÈÅB                   *
000080*      4. çÏê¨é“        : õLã”âJ                                 *
000090*      5. çÏê¨ì˙        : 2005.03.26                             *
000100*                                                                *
000110******************************************************************
000120*                                                                 
000130******************************************************************
000140*    ÇhÇcÇdÇmÇsÇhÇeÇhÇbÇ`ÇsÇhÇnÇm  ÇcÇhÇuÇhÇrÇhÇnÇm              *
000150******************************************************************
000160 IDENTIFICATION                       DIVISION.                   
000170*                                                                 
000180 PROGRAM-ID.                          AAASED25.                   
000190******************************************************************
000200*    ÇdÇmÇuÇhÇqÇnÇmÇlÇdÇmÇs        ÇcÇhÇuÇhÇrÇhÇnÇm              *
000210******************************************************************
000220 ENVIRONMENT                          DIVISION.                   
000230******************************************************************
000240*    ÇhÇmÇoÇtÇsÅ|ÇnÇtÇsÇoÇtÇs      ÇrÇdÇbÇsÇhÇnÇm                *
000250******************************************************************
000260 INPUT-OUTPUT                         SECTION.                    
000270*                                                                 
000280 FILE-CONTROL.                                                    
000290     SELECT    èoóÕÉtÉ@ÉCÉã           ASSIGN    TO     U11        
000300     FILE      STATUS     IS          ÇvÅ|èÛë‘                    
000310     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000320*                                                                 
000330******************************************************************
000340*    ÇcÇ`ÇsÇ`                      ÇcÇhÇuÇhÇrÇhÇnÇm              *
000350******************************************************************
000360 DATA                                 DIVISION.                   
000370******************************************************************
000380*    ÇeÇhÇkÇd                      ÇrÇdÇbÇsÇhÇnÇm                *
000390******************************************************************
000400 FILE                                 SECTION.                    
000410*----------------------------------------------------------------*
000420*    èoóÕÉtÉ@ÉCÉã                                                *
000430*----------------------------------------------------------------*
000440 FD  èoóÕÉtÉ@ÉCÉã                                                 
000450     LABEL     RECORD     IS          STANDARD                    
000460     BLOCK     CONTAINS   0           RECORDS.                    
000470*                                                                 
000480 01  èoóÕÅ|ÉåÉRÅ[Éh.                                              
000490     COPY  CPSCE50  REPLACING  ==()==  BY  ==èoóÕÅ|==.            
000500*                                                                 
000510******************************************************************
000520*  ÇvÇnÇqÇjÇhÇmÇfÅ|ÇrÇsÇnÇqÇ`ÇfÇd  ÇrÇdÇbÇsÇhÇnÇm                *
000530******************************************************************
000540  WORKING-STORAGE                     SECTION.                    
000550*----------------------------------------------------------------*
000560*    ÉzÉXÉgïœêîíËã`ÉGÉäÉA                                        *
000570*----------------------------------------------------------------*
000580     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
000590*                                                                 
000600 01  ÇvÇrÅ|ñºèÃÇP                     PIC  X(060).                
000610 01  ÇvÇrÅ|ñºèÃÇQ                     PIC  X(060).                
000620 01  ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇP               PIC  X(03)  VALUE "038".    
000630 01  ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇQ               PIC  X(03)  VALUE "005".    
000640 01  ÇvÇrÅ|ÉåÉRÅ[ÉhãÊï™              PIC  X(01)  VALUE "1".      
000650 01  ÇvÇrÅ|ÇlÇOÇPÅ|íSï€ãÊï™          PIC X(01) VALUE "0".        
000660 01  ÇvÇrÅ|ÇlÇSÇOÅ|ã¶í≤ãÊï™          PIC X(01) VALUE "2".        
000670*                                                                 
000680*--< ÇnÇqÇ`ÇbÇkÇdã§í ïœêî >                                       
000690     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
000700*                                                                 
000710*--< ÇnÇqÇ`ÇbÇkÇd  ÇrÇpÇké¿çsèÓïÒ >                               
000720     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
000730*                                                                 
000740*--< ëOéÛèÓïÒÇcÇa >                                               
000750     EXEC  SQL  INCLUDE  M40MAB.CBL            END-EXEC.          
000760*                                                                 
000770*--< ã∆ñ±ä«óùÉeÅ[ÉuÉã >                                           
000780     EXEC  SQL  INCLUDE  D70GYM.CBL            END-EXEC.          
000790*                                                                 
000800*--< éÊà¯êÊÉ}ÉXÉ^>                                                
000810     EXEC  SQL  INCLUDE  D01TRS.CBL            END-EXEC.          
000820*                                                                 
000830*--< êøãÅêÊÉ}ÉXÉ^>                                                
000840     EXEC  SQL  INCLUDE  D02SQS.CBL            END-EXEC.          
000850*                                                                 
000860*--< çÄñ⁄ñºèÃÉ}ÉXÉ^>                                              
000870     EXEC  SQL  INCLUDE  D19MSY.CBL            END-EXEC.          
000880*                                                                 
000890*--< ç¬å†èÓïÒÅiàÍî ÅjÇcÇa>                                        
000900     EXEC  SQL  INCLUDE  M01SAJ.CBL            END-EXEC.          
000910*                                                                 
000920     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
000930*----------------------------------------------------------------*
000940*    ÇvÇnÇqÇjÉGÉäÉA                                              *
000950*----------------------------------------------------------------*
000960 01  ÇvÇnÇqÇjÅ|ÉGÉäÉA.                                            
000970*                                                                 
000980*--< ÉtÉ@ÉCÉãèÛë‘ >                                               
000990     03  ÇvÅ|èÛë‘ÉGÉäÉA.                                          
001000         05  ÇvÅ|èÛë‘                 PIC  X(02).                 
001010*--< ÉGÉâÅ[îªíËóp >                                               
001020     03  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             PIC S9(04).                 
001030*                                                                 
001040*--< ÉtÉâÉOÉAÉäÉA >                                               
001050     03  ÉtÉâÉOÉAÉäÉA.                                            
001060         05  ÇvÅ|èIóπÅ|ÉtÉâÉO         PIC  X(01).                 
001070         05  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     PIC  X(01).                 
001080*                                                                 
001090*--< åèêîÉGÉäÉA >                                                 
001100     03  åèêîÉGÉäÉA.                                              
001110         05  ÇvÅ|ì¸óÕÅ|åèêî           PIC  9(09).                 
001120         05  ÇvÅ|èoóÕÅ|åèêî           PIC  9(09).                 
001130*                                                                 
001140*--< ã§í èÓïÒ >                                                   
001150 01  ÇvÅ|ã§í èÓïÒ.                                                
001160     03  ÇvÅ|ÉVÉXÉeÉÄì˙ït.                                        
001170         05  ÇvÅ|ê¢ãI                 PIC  X(02) VALUE  "20".     
001180         05  ÇvÅ|îNåéì˙               PIC  X(06).                 
001190     03  ÇvÅ|ÉVÉXÉeÉÄéûçè             PIC  X(08).                 
001200     03  ÇvÅ|íSìñé“                   PIC  X(08) VALUE "IKOPG   ".
001210*                                                                 
001220*----------------------------------------------------------------*
001230*    ÉTÉuÉãÅ[É`Éìñº                                              *
001240*----------------------------------------------------------------*
001250 01  CALL-AREA.                                                   
001260*--< ã§í ÉçÉOÉTÉuÉãÅ[É`Éì >                                       
001270     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001280     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001290*                                                                 
001300*----------------------------------------------------------------*
001310*    ÇbÇnÇoÇxóÃàÊ                                                *
001320*----------------------------------------------------------------*
001330*--< ã§í ÉçÉOópÉpÉâÉÅÅ[É^ >                                       
001340 01  IF-CHOCO001.                                                 
001350     COPY  CHOCO001  REPLACING  ==()==  BY  ==ã§ÇPÅ|==.           
001360*                                                                 
001370*----------------------------------------------------------------*
001380*    ÇhÇmÇhÉtÉ@ÉCÉãì«çûÉTÉuÉãÅ[É`ÉìópÉpÉâÉÅÉ^óÃàÊ                *
001390*----------------------------------------------------------------*
001400 01  PARA-AREA.                                                   
001410     COPY CPBCO001.                                               
001420******************************************************************
001430*    íËêîópÉfÅ[É^íËã`ÉGÉäÉA                                      *
001440******************************************************************
001450 CONSTANT                             SECTION.                    
001460 01  íËêîóÃàÊ.                                                    
001470     03  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc         PIC  X(08) VALUE "AAASED25".
001480     03  íËêîÅ|ÉvÉçÉOÉâÉÄñº           PIC  X(80)                  
001490                              VALUE  "ëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉãçÏê¨".
001500     03  íËêîÅ|ÇrÇpÇkÇnÇj             PIC S9(04)  VALUE  ZERO.    
001510     03  íËêîÅ|ÇrÇpÇkÇdÇmÇc           PIC S9(04)  VALUE  0100.    
001520     03  íËêîÅ|ê≥èÌèÛë‘               PIC S9(04)  VALUE  ZERO.    
001530     03  íËêîÅ|àŸèÌèÛë‘               PIC S9(04)  VALUE  0009.    
001540******************************************************************
001550*    ÇoÇqÇnÇbÇdÇcÇtÇqÇd            ÇcÇhÇuÇhÇrÇhÇnÇm              *
001560******************************************************************
001570 PROCEDURE                            DIVISION.                   
001580*                                                                 
001590     PERFORM  èâä˙èàóù.                                           
001600*                                                                 
001610     PERFORM  éÂèàóù  UNTIL  ÇvÅ|èIóπÅ|ÉtÉâÉO  =  "Y".            
001620*                                                                 
001630     PERFORM  èIóπèàóù.                                           
001640*                                                                 
001650     STOP     RUN.                                                
001660*                                                                 
001670******************************************************************
001680*    èâä˙èàóù                                                    *
001690*******************************************************************                                                                 
001700 èâä˙èàóù                             SECTION.                    
001710 èâä˙èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
001720*                                                                 
001730*----------------------------------------------------------------*
001740*    äJénÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
001750*----------------------------------------------------------------*
001760     INITIALIZE                       IF-CHOCO001.                
001770     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
001780     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
001790     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
001800     MOVE  "START"                    TO  ã§ÇPÅ|èàóùéØï .         
001810     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
001820     CALL  CLOCO001                USING  IF-CHOCO001.            
001830*                                                                 
001840*----------------------------------------------------------------*
001850*    çÏã∆óÃàÊÇÃèâä˙ílèàóù                                        *
001860*----------------------------------------------------------------*
001870     MOVE  SPACE                      TO  ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001880     INITIALIZE                           ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001890*                                                                 
001900*--< ÇbÇoÇtì˙ïtÇéÊìæ >                                           
001910     ACCEPT  ÇvÅ|îNåéì˙               FROM  DATE.                 
001920*                                                                 
001930*--< ÇbÇoÇtéûçèÇéÊìæ >                                           
001940     ACCEPT  ÇvÅ|ÉVÉXÉeÉÄéûçè         FROM  TIME.                 
001950*----------------------------------------------------------------*
001960*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
001970*----------------------------------------------------------------*
001980     PERFORM   ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                                  
001990*----------------------------------------------------------------*
002000*    ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû                                        *
002010*----------------------------------------------------------------*
002020     PERFORM    ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû.                             
002030*----------------------------------------------------------------*
002040*    åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`                                    *
002050*----------------------------------------------------------------*
002060     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`.                           
002070*----------------------------------------------------------------*
002080*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                                            *
002090*----------------------------------------------------------------*
002100     PERFORM  ÉtÉ@ÉCÉãÉIÅ[ÉvÉì.                                   
002110*----------------------------------------------------------------*
002120*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                                    *
002130*----------------------------------------------------------------*
002140     PERFORM åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                            
002150*                                                                 
002160 èâä˙èàóùÅ|ÇdÇwÇhÇs.                                              
002170     EXIT.                                                        
002180******************************************************************
002190*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
002200******************************************************************
002210 ÇnÇqÇ`ÇbÇkÇdê⁄ë±                     SECTION.                    
002220 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇrÇsÇ`ÇqÇs.                                    
002230*                                                                 
002240*--< ÇcÇaê⁄ë±ópèÓïÒÇéÊìæèàóù >                                   
002250     CALL  COBCO001                USING  PARA-AREA.              
002260*                                                                 
002270     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002280     MOVE  PARA-USERNAME              TO  USERNAME.               
002290     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002300*                                                                 
002310*----------------------------------------------------------------*
002320*    äJénê⁄ë±                                                    *
002330*----------------------------------------------------------------*
002340     IF    DB-STRING  =  SPACE                                    
002350        EXEC SQL                                                  
002360           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002370        END-EXEC                                                  
002380     ELSE                                                         
002390        EXEC SQL                                                  
002400           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002410             USING  :DB-STRING                                    
002420        END-EXEC                                                  
002430     END-IF.                                                      
002440*                                                                 
002450*----------------------------------------------------------------*
002460*    ê⁄ë±ämîF                                                    *
002470*----------------------------------------------------------------*
002480     EVALUATE  SQLCODE                                            
002490        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002500           CONTINUE                                               
002510        WHEN   OTHER                                              
002520*--< ê⁄ë±ÉGÉâÅ[ >                                           
002530           MOVE     -1                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002540           PERFORM  ÉGÉâÅ[èàóù                                    
002550     END-EVALUATE.                                                
002560*                                                                 
002570 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇdÇwÇhÇs.                                      
002580     EXIT.                                                        
002590******************************************************************
002600*    ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû                                        *
002610******************************************************************
002620 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû                 SECTION.                    
002630 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇrÇsÇ`ÇqÇs.                                
002640*                                                                 
002650*----------------------------------------------------------------*
002660*    ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû                                        *
002670*----------------------------------------------------------------*
002680     EXEC SQL                                                     
002690        SELECT  ÉoÉbÉ`ópã∆ñ±îNåé                                  
002700          INTO :ÇcÇVÇOÅ|ÉoÉbÉ`ópã∆ñ±îNåé                          
002710          FROM  D70GYM_TBL                                        
002720         WHERE  ã∆ñ±ä«óùÇhÇc = 'GYMKNRRC'                         
002730     END-EXEC.                                                    
002740*----------------------------------------------------------------*
002750*    ã∆ñ±ä«óùÉeÅ[ÉuÉãåüçıÇämîF                                  *
002760*----------------------------------------------------------------*
002770     EVALUATE   SQLCODE                                           
002780        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002790*--< ê≥èÌÇÃéû >                                                   
002800           CONTINUE                                               
002810        WHEN   OTHER                                              
002820*--< ë∂ç›ÇµÇ»Ç¢ >                                                 
002830           MOVE     -2                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002840           MOVE     "Y"               TO  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO    
002850           PERFORM  ÉGÉâÅ[èàóù                                    
002860     END-EVALUATE.                                                
002870*                                                                 
002880 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇdÇwÇhÇs.                                  
002890     EXIT.                                                        
002900******************************************************************
002910*        åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`                                *
002920******************************************************************
002930 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`             SECTION.                    
002940 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇrÇsÇ`ÇqÇs.                            
002950*                                                                 
002960*----------------------------------------------------------------*
002970*    ÉJÅ[É\ÉãíËã`èàóù                                            *
002980*----------------------------------------------------------------*
002990     EXEC SQL                                                     
003000        DECLARE CUR1  CURSOR FOR                                  
003010           SELECT  M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™                        
003020                  ,M40MAB_TBL.åoóùópéÂå_ñÒãÊï™                    
003030                  ,M40MAB_TBL.å⁄ãqãÊï™                            
003040                  ,NVL(D01TRS_TBL.ñºäÒÇπÉRÅ[Éh,' ')               
003050                  ,M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh                  
003060                  ,M40MAB_TBL.êøãÅêÊÉRÅ[Éh                        
003070                  ,M40MAB_TBL.å_ñÒî‘çÜ                            
003080                  ,M40MAB_TBL.å_ñÒéÌóﬁ                            
003090                  ,M40MAB_TBL.íSìñïîâ€ÉRÅ[Éh                      
003100                  ,M40MAB_TBL.çƒÉäÅ[ÉXâÒêî                        
003110                  ,M40MAB_TBL.è[ìñäJénîNåé                        
003120                  ,M40MAB_TBL.è[ìñåéêî                            
003130                  ,M40MAB_TBL.ëOï•âÒé˚ï˚ñ@                        
003140                  ,M40MAB_TBL.ì¸ã‡ì˙                              
003150                  ,M40MAB_TBL.ì¸ã‡ãÊï™                            
003160                  ,D01TRS_TBL.éÊà¯êÊñºèÃ                          
003170                  ,D02SQS_TBL.êøãÅêÊñºèÃ                          
003180                  ,M40MAB_TBL.ëOåéññécçÇ                          
003190                  ,M40MAB_TBL.ìñåéâÒé˚äz                          
003200                  ,M40MAB_TBL.ìñåéè¡âªäz                          
003210                  ,M40MAB_TBL.ìñåéññécçÇ                          
003220                  ,M40MAB_TBL.ã¶í≤ãÊï™                            
003230                  ,M40MAB_TBL.ëOåéññécçÇëºé–                      
003240                  ,M40MAB_TBL.ìñåéâÒé˚äzëºé–                      
003250                  ,M40MAB_TBL.ìñåéè¡âªäzëºé–                      
003260                  ,M40MAB_TBL.ìñåéëºé–âñÒï™óøã‡                  
003270                  ,M40MAB_TBL.ìñåéëºé–âñÒï™è¡îÔê≈                
003280                  ,M40MAB_TBL.ìñåéññécçÇëºé–                      
003290             FROM  M40MAB_TBL                                     
003300                  ,D01TRS_TBL                                     
003310                  ,D02SQS_TBL                                     
003320            WHERE  M40MAB_TBL.ëOéÛã‡éÛï•écçÇï\ëŒè€ÉtÉâÉO  =  '1'  
003330              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh =                
003340                                    D01TRS_TBL.éÊà¯êÊÉRÅ[Éh ( + ) 
003350              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh =                
003360                                    D02SQS_TBL.éÊà¯êÊÉRÅ[Éh ( + ) 
003370              AND  M40MAB_TBL.êøãÅêÊÉRÅ[Éh =                      
003380                                    D02SQS_TBL.êøãÅêÊÉRÅ[Éh ( + ) 
003390         ORDER BY  M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™                        
003400                  ,M40MAB_TBL.å_ñÒî‘çÜ                            
003410     END-EXEC.                                                    
003420*                                                                 
003430*----------------------------------------------------------------*
003440*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
003450*----------------------------------------------------------------*
003460     EXEC  SQL                                                    
003470        OPEN  CUR1                                                
003480     END-EXEC.                                                    
003490*                                                                 
003500*----------------------------------------------------------------*
003510*    ÉJÅ[É\ÉãÇnÇoÇdÇmämîF                                        *
003520*----------------------------------------------------------------*
003530     EVALUATE  SQLCODE                                            
003540        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
003550*--< ê≥èÌ >                                                       
003560           CONTINUE                                               
003570        WHEN  OTHER                                               
003580*--< ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                                     
003590           MOVE -3                    TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003600           PERFORM  ÉGÉâÅ[èàóù                                    
003610     END-EVALUATE.                                                
003620*                                                                 
003630 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇdÇwÇhÇs.                              
003640     EXIT.                                                        
003650******************************************************************
003660*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                                            *
003670******************************************************************
003680 ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                     SECTION.                    
003690 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇrÇsÇ`ÇqÇs.                                    
003700*                                                                 
003710*----------------------------------------------------------------*
003720*    ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉì                        *
003730*----------------------------------------------------------------*
003740     OPEN  OUTPUT   èoóÕÉtÉ@ÉCÉã.                                 
003750*                                                                 
003760*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÇÃèÛë‘îªíË >                                 
003770     EVALUATE  ÇvÅ|èÛë‘                                           
003780        WHEN  ZERO                                                
003790           CONTINUE                                               
003800        WHEN  OTHER                                               
003810*--<ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                                      
003820           MOVE     -4                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003830           PERFORM  ÉGÉâÅ[èàóù                                    
003840     END-EVALUATE.                                                
003850*                                                                 
003860 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇdÇwÇhÇs.                                      
003870     EXIT.                                                        
003880******************************************************************
003890*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                                    *
003900******************************************************************
003910 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû             SECTION.                    
003920 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇrÇsÇ`ÇqÇs.                            
003930*                                                                 
003940*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû >                                   
003950     EXEC SQL                                                     
003960         FETCH   CUR1                                             
003970          INTO   :ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™                            
003980                ,:ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™                        
003990                ,:ÇlÇSÇOÅ|å⁄ãqãÊï™                                
004000                ,:ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh                            
004010                ,:ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh                      
004020                ,:ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh                            
004030                ,:ÇlÇSÇOÅ|å_ñÒî‘çÜ                                
004040                ,:ÇlÇSÇOÅ|å_ñÒéÌóﬁ                                
004050                ,:ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh                          
004060                ,:ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî                            
004070                ,:ÇlÇSÇOÅ|è[ìñäJénîNåé                            
004080                ,:ÇlÇSÇOÅ|è[ìñåéêî                                
004090                ,:ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@                            
004100                ,:ÇlÇSÇOÅ|ì¸ã‡ì˙                                  
004110                ,:ÇlÇSÇOÅ|ì¸ã‡ãÊï™                                
004120                ,:ÇcÇOÇPÅ|éÊà¯êÊñºèÃ                              
004130                ,:ÇcÇOÇQÅ|êøãÅêÊñºèÃ                              
004140                ,:ÇlÇSÇOÅ|ëOåéññécçÇ                              
004150                ,:ÇlÇSÇOÅ|ìñåéâÒé˚äz                              
004160                ,:ÇlÇSÇOÅ|ìñåéè¡âªäz                              
004170                ,:ÇlÇSÇOÅ|ìñåéññécçÇ                              
004180                ,:ÇlÇSÇOÅ|ã¶í≤ãÊï™                                
004190                ,:ÇlÇSÇOÅ|ëOåéññécçÇëºé–                          
004200                ,:ÇlÇSÇOÅ|ìñåéâÒé˚äzëºé–                          
004210                ,:ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–                          
004220                ,:ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡                      
004230                ,:ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈                    
004240                ,:ÇlÇSÇOÅ|ìñåéññécçÇëºé–                          
004250     END-EXEC.                                                    
004260*                                                                 
004270*----------------------------------------------------------------*
004280*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÇämîF                              *
004290*----------------------------------------------------------------*
004300     EVALUATE   SQLCODE                                           
004310        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
004320*--< ê≥èÌ >                                                       
004330           COMPUTE  ÇvÅ|ì¸óÕÅ|åèêî  =  ÇvÅ|ì¸óÕÅ|åèêî  +  1       
004340        WHEN   íËêîÅ|ÇrÇpÇkÇdÇmÇc                                 
004350*--< ì«çûèIóπ >                                                   
004360           MOVE  "Y"                  TO  ÇvÅ|èIóπÅ|ÉtÉâÉO        
004370        WHEN   OTHER                                              
004380*--<  ì«çûÉGÉâÅ[ >                                                
004390           MOVE     -5                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004400           PERFORM  ÉGÉâÅ[èàóù                                    
004410     END-EVALUATE.                                                
004420*                                                                 
004430 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇdÇwÇhÇs.                              
004440     EXIT.                                                        
004450******************************************************************
004460*    éÂèàóù                                                      *
004470******************************************************************
004480 éÂèàóù                               SECTION.                    
004490 éÂèàóùÅ|ÇrÇsÇ`ÇqÇs.                                              
004500*----------------------------------------------------------------*
004510*    çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù                            *
004520*----------------------------------------------------------------*
004530     PERFORM  çÄñ⁄ñºèÃÉ}ÉXÉ^íäèoèàóù.                             
004540*----------------------------------------------------------------*
004550*    ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù                      *
004560*----------------------------------------------------------------*
004570     PERFORM  ç¬å†èÓïÒÇcÇaíäèoèàóù.                               
004580*----------------------------------------------------------------*
004590*    ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕîªíËèàóù                      *
004600*----------------------------------------------------------------*
004610     IF  ÇlÇOÇPÅ|íSï€ãÊï™  NOT = "1"                              
004620*--<     ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWÅAèoóÕèàóù>            
004630        PERFORM  ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãï“èWèoóÕ               
004640     END-IF.                                                      
004650*----------------------------------------------------------------*
004660*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅiÇQåèñ⁄à»ç~Åj                      *
004670*----------------------------------------------------------------*
004680     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
004690*                                                                 
004700 éÂèàóùÅ|ÇdÇwÇhÇs.                                                
004710     EXIT.                                                        
004720******************************************************************
004730*    çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù                            *
004740******************************************************************
004750 çÄñ⁄ñºèÃÉ}ÉXÉ^íäèoèàóù               SECTION.                    
004760 çÄñ⁄ñºèÃÉ}ÉXÉ^íäèoèàóùÅ|ÇrÇsÇ`ÇqÇs.                              
004770******************************************************************
004780*çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒãÊï™ñºèÃÇÃíäèoèàóù                       
004790******************************************************************
004800*----------------------------------------------------------------*
004810*    çÄñ⁄ñºèÃÉ}ÉXÉ^ì«çû                                          *
004820*----------------------------------------------------------------*
004830     EXEC SQL                                                     
004840        SELECT  ñºèÃ                                              
004850          INTO :ÇvÇrÅ|ñºèÃÇP                                      
004860          FROM  D19MSY_TBL                                        
004870         WHERE  ÉRÅ[ÉhÇmÇn = :ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇP                   
004880           AND  SUBSTR(ÉRÅ[Éh,1,1) = :ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™    
004890     END-EXEC.                                                    
004900*----------------------------------------------------------------*
004910*    çÄñ⁄ñºèÃÉ}ÉXÉ^åüçıÇämîF                                    *
004920*----------------------------------------------------------------*
004930     EVALUATE   SQLCODE                                           
004940        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
004950*--< ê≥èÌÇÃéû >                                                   
004960           CONTINUE                                               
004970        WHEN   OTHER                                              
004980*--< ë∂ç›ÇµÇ»Ç¢ >                                                 
004990           MOVE     SPACE             TO  ÇvÇrÅ|ñºèÃÇP            
005000           MOVE     -6                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
005010           PERFORM  ÉGÉâÅ[èàóù                                    
005020     END-EVALUATE.                                                
005030*                                                                 
005040*çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËå⁄ãqãÊï™ñºèÃÇÃíäèoèàóù                         
005050*----------------------------------------------------------------*
005060*    çÄñ⁄ñºèÃÉ}ÉXÉ^ì«çû                                          *
005070*----------------------------------------------------------------*
005080     EXEC SQL                                                     
005090        SELECT  ñºèÃ                                              
005100          INTO :ÇvÇrÅ|ñºèÃÇQ                                      
005110          FROM  D19MSY_TBL                                        
005120         WHERE  ÉRÅ[ÉhÇmÇn =: ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇQ                  
005130           AND  SUBSTR(ÉRÅ[Éh,1,2) = :ÇlÇSÇOÅ|å⁄ãqãÊï™            
005140     END-EXEC.                                                    
005150*----------------------------------------------------------------*
005160*    çÄñ⁄ñºèÃÉ}ÉXÉ^åüçıÇämîF                                    *
005170*----------------------------------------------------------------*
005180     EVALUATE   SQLCODE                                           
005190        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
005200*--< ê≥èÌÇÃéû >                                                   
005210           CONTINUE                                               
005220        WHEN   OTHER                                              
005230*--< ë∂ç›ÇµÇ»Ç¢ >                                                 
005240           MOVE     SPACE             TO  ÇvÇrÅ|ñºèÃÇQ            
005250           MOVE     -6                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
005260           PERFORM  ÉGÉâÅ[èàóù                                    
005270     END-EVALUATE.                                                
005280*                                                                 
005290 çÄñ⁄ñºèÃÉ}ÉXÉ^íäèoèàóùÅ|ÇdÇwÇhÇs.                                
005300     EXIT.                                                        
005310******************************************************************
005320*    ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù                      *
005330******************************************************************
005340 ç¬å†èÓïÒÇcÇaíäèoèàóù                 SECTION.                    
005350 ç¬å†èÓïÒÇcÇaíäèoèàóùÅ|ÇrÇsÇ`ÇqÇs.                                
005360*                                                                 
005370*----------------------------------------------------------------*
005380*    ç¬å†èÓïÒÇcÇaì«çû                                            *
005390*----------------------------------------------------------------*
005400     EXEC SQL                                                     
005410        SELECT  èÛë‘ÉtÉâÉO                                        
005420               ,ç¬å†å_ñÒåèñº                                      
005430               ,íSï€ãÊï™                                          
005440          INTO :ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO                                
005450              ,:ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº                              
005460              ,:ÇlÇOÇPÅ|íSï€ãÊï™                                  
005470          FROM  M01SAJ_TBL                                        
005480         WHERE  ÉåÉRÅ[ÉhãÊï™ =  :ÇvÇrÅ|ÉåÉRÅ[ÉhãÊï™               
005490           AND  å_ñÒî‘çÜ = :ÇlÇSÇOÅ|å_ñÒî‘çÜ                      
005500           AND  çƒÉäÅ[ÉXâÒêî = :ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî              
005510           AND  å_ñÒéÌóﬁ = :ÇlÇSÇOÅ|å_ñÒéÌóﬁ                      
005520     END-EXEC.                                                    
005530*----------------------------------------------------------------*
005540*    ç¬å†èÓïÒÇcÇaåüçıÇämîF                                      *
005550*----------------------------------------------------------------*
005560     EVALUATE   SQLCODE                                           
005570        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
005580*--< ê≥èÌÇÃéû >                                                   
005590           CONTINUE                                               
005600        WHEN   OTHER                                              
005610*--< ë∂ç›ÇµÇ»Ç¢ >                                                 
005620           MOVE     SPACE             TO  ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO      
005630           MOVE     SPACE             TO  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº    
005640           MOVE     ÇvÇrÅ|ÇlÇOÇPÅ|íSï€ãÊï™     TO  ÇlÇOÇPÅ|íSï€ãÊï™        
005650           MOVE     -7                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
005660           PERFORM  ÉGÉâÅ[èàóù                                    
005670     END-EVALUATE.                                                
005680*                                                                 
005690 ç¬å†èÓïÒÇcÇaíäèoèàóùÅ|ÇdÇwÇhÇs.                                  
005700     EXIT.                                                        
005710******************************************************************
005720*    ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWÅAèoóÕèàóù                *
005730******************************************************************
005740 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãï“èWèoóÕ   SECTION.                    
005750 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãï“èWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                  
005760*                                                                 
005770*--< èoóÕÉåÉRÅ[ÉhÇÃèâä˙âªèàóù >                                   
005780     MOVE  SPACE                      TO  èoóÕÅ|ÉåÉRÅ[Éh.         
005790     INITIALIZE                           èoóÕÅ|ÉåÉRÅ[Éh.         
005800*--< é©é–ï™å¬ï ÇÃï“èW >                                           
005810     PERFORM  é©é–ï™ï“èW.                                         
005820*--< é©é–ï™èoóÕîªíË >                                             
005830     IF      èoóÕÅ|ëOåéññécçÇ  NOT  =  0                          
005840         OR  èoóÕÅ|ìñåéì¸ã‡äz  NOT  =  0                          
005850         OR  èoóÕÅ|ìñåéè¡âªäz  NOT  =  0                          
005860         OR  èoóÕÅ|ìñåéññécçÇ  NOT  =  0                          
005870         PERFORM  ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóù.             
005880*--< ëºé–ï™å¬ï ÇÃï“èW >                                           
005890     IF  ÇlÇSÇOÅ|ã¶í≤ãÊï™ = ÇvÇrÅ|ÇlÇSÇOÅ|ã¶í≤ãÊï™                             
005900        PERFORM  ëºé–ï™ï“èWèoóÕ.                                  
005910*                                                                 
005920 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãï“èWèoóÕÅ|ÇdÇwÇhÇs.                    
005930     EXIT.                                                        
005940******************************************************************
005950*    é©é–ï™ï“èW                                                  *
005960******************************************************************
005970 é©é–ï™ï“èW                             SECTION.                  
005980 é©é–ï™ï“èWÅ|ÇrÇsÇ`ÇqÇs.                                          
005990*                                                                 
006000*--< No.1 >                                                       
006010     IF  ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO < 3                                   
006020        MOVE  3                       TO  èoóÕÅ|é©ëºé–ãÊï™        
006030     ELSE                                                         
006040        MOVE  1                       TO  èoóÕÅ|é©ëºé–ãÊï™        
006050     END-IF.                                                      
006060*--< No.2 >                                                       
006070     MOVE  ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™       TO  èoóÕÅ|ëOéÛãÊï™.         
006080*--< No.3 >                                                       
006090     MOVE  ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™   TO  èoóÕÅ|éÂå_ñÒãÊï™.       
006100*--< No.4 >                                                       
006110     MOVE  ÇlÇSÇOÅ|å⁄ãqãÊï™           TO  èoóÕÅ|òAåããÊï™.         
006120*--< No.5 >                                                       
006130     MOVE  ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh       TO  èoóÕÅ|ñºäÒÇπÉRÅ[Éh.     
006140*--< No.6 >                                                       
006150     MOVE  ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh TO  èoóÕÅ|éÊà¯êÊÉRÅ[Éh.     
006160*--< No.7 >                                                       
006170     MOVE  ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh       TO  èoóÕÅ|êøãÅêÊÉRÅ[Éh.     
006180*--< No.8 >                                                       
006190     MOVE  ÇlÇSÇOÅ|å_ñÒî‘çÜ           TO  èoóÕÅ|å_ñÒî‘çÜ.         
006200*--< No.9 >                                                       
006210     MOVE  ÇlÇSÇOÅ|å_ñÒéÌóﬁ           TO  èoóÕÅ|å_ñÒéÌóﬁ.         
006220*--< No.10 >                                                      
006230     MOVE  ÇcÇVÇOÅ|ÉoÉbÉ`ópã∆ñ±îNåé   TO  èoóÕÅ|ã∆ñ±îNåé.         
006240*--< No.11 >                                                      
006250     MOVE  ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh     TO  èoóÕÅ|íSìñïîâ€ÉRÅ[Éh.   
006260*--< No.12 >                                                      
006270     MOVE  ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº       TO  èoóÕÅ|å_ñÒåèñº.         
006280*--< No.13 >                                                      
006290     MOVE  ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî       TO  èoóÕÅ|çƒÉäÅ[ÉXâÒêî.     
006300*--< No.14 >                                                      
006310     MOVE  ÇlÇSÇOÅ|è[ìñäJénîNåé       TO  èoóÕÅ|è[ìñäJénîNåé.     
006320*--< No.15 >                                                      
006330     MOVE  ÇlÇSÇOÅ|è[ìñåéêî           TO  èoóÕÅ|è[ìñåéêî.         
006340*--< No.16 >                                                      
006350     MOVE  ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@       TO  èoóÕÅ|ëOï•âÒé˚ï˚ñ@.     
006360*--< No.17 >                                                      
006370     MOVE  ÇlÇSÇOÅ|ì¸ã‡ì˙             TO  èoóÕÅ|ì¸ã‡ì˙.           
006380*--< No.18 >                                                      
006390     MOVE  ÇlÇSÇOÅ|ì¸ã‡ãÊï™           TO  èoóÕÅ|ì¸ã‡ãÊï™.         
006400*--< No.19 >                                                      
006410     MOVE  ÇcÇOÇPÅ|éÊà¯êÊñºèÃ         TO  èoóÕÅ|éÊà¯êÊñºèÃ.       
006420*--< No.20 >                                                      
006430     MOVE  ÇcÇOÇQÅ|êøãÅêÊñºèÃ         TO  èoóÕÅ|êøãÅêÊñºèÃ.       
006440*--< No.21 >                                                      
006450     MOVE  ÇvÇrÅ|ñºèÃÇP               TO  èoóÕÅ|éÂå_ñÒãÊï™ñºèÃ.   
006460*--< No.22 >                                                      
006470     MOVE  ÇvÇrÅ|ñºèÃÇQ               TO  èoóÕÅ|òAåããÊï™ñºèÃ.     
006480*--< No.23 >                                                      
006490     MOVE  ÇlÇSÇOÅ|ëOåéññécçÇ         TO  èoóÕÅ|ëOåéññécçÇ.       
006500*--< No.24 >                                                      
006510     MOVE  ÇlÇSÇOÅ|ìñåéâÒé˚äz         TO  èoóÕÅ|ìñåéì¸ã‡äz.       
006520*--< No.25 >                                                      
006530     MOVE  ÇlÇSÇOÅ|ìñåéè¡âªäz         TO  èoóÕÅ|ìñåéè¡âªäz.       
006540*--< No.26 >                                                      
006550     MOVE  ÇlÇSÇOÅ|ìñåéññécçÇ         TO  èoóÕÅ|ìñåéññécçÇ.       
006560*                                                                 
006570 é©é–ï™ï“èWÅ|ÇdÇwÇhÇs.                                            
006580     EXIT.                                                        
006590******************************************************************
006600*    ëºé–ï™å¬ï ïîï™ÇÃï“èWèoóÕ                                    *
006610******************************************************************
006620 ëºé–ï™ï“èWèoóÕ                       SECTION.                    
006630 ëºé–ï™ï“èWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                      
006640*                                                                 
006650*--< ëºé–ï™ï“èW >                                                 
006660*--< No.1 >                                                       
006670     IF  ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO < 3                                   
006680        MOVE  4                       TO  èoóÕÅ|é©ëºé–ãÊï™        
006690     ELSE                                                         
006700        MOVE  2                       TO  èoóÕÅ|é©ëºé–ãÊï™        
006710     END-IF.                                                      
006720*--< No.23 >                                                      
006730     MOVE  ÇlÇSÇOÅ|ëOåéññécçÇëºé–     TO  èoóÕÅ|ëOåéññécçÇ.       
006740*--< No.24 >                                                      
006750     MOVE  ÇlÇSÇOÅ|ìñåéâÒé˚äzëºé–     TO  èoóÕÅ|ìñåéì¸ã‡äz.       
006760*--< No.25 >                                                      
006770     COMPUTE  èoóÕÅ|ìñåéè¡âªäz  =  ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–         
006780                                +  ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡     
006790                                +  ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈.  
006800*--< No.26 >                                                      
006810     COMPUTE  èoóÕÅ|ìñåéññécçÇ  =  ÇlÇSÇOÅ|ìñåéññécçÇëºé–         
006820                                -  ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡     
006830                                -  ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈.  
006840*--< ëºé–ï™èoóÕîªíË >                                             
006850     IF      èoóÕÅ|ëOåéññécçÇ  NOT  =  0                          
006860         OR  èoóÕÅ|ìñåéì¸ã‡äz  NOT  =  0                          
006870         OR  èoóÕÅ|ìñåéè¡âªäz  NOT  =  0                          
006880         OR  èoóÕÅ|ìñåéññécçÇ  NOT  =  0                          
006890         PERFORM  ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóù.             
006900*                                                                 
006910 ëºé–ï™ï“èWèoóÕÅ|ÇdÇwÇhÇs.                                        
006920     EXIT.                                                        
006930******************************************************************
006940*    ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóù                          *
006950******************************************************************
006960 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóù   SECTION.                    
006970 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                  
006980*                                                                 
006990     WRITE  èoóÕÅ|ÉåÉRÅ[Éh.                                       
007000*                                                                 
007010*--< ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕÇÃèÛë‘îªíË >                   
007020     EVALUATE  ÇvÅ|èÛë‘                                           
007030        WHEN  ZERO                                                
007040*--< ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕåèêîÇÃâ¡éZ >                   
007050           COMPUTE  ÇvÅ|èoóÕÅ|åèêî =  ÇvÅ|èoóÕÅ|åèêî + 1          
007060        WHEN  OTHER                                               
007070*--< ÉtÉ@ÉCÉãèoóÕÉGÉâÅ[ >                                         
007080           MOVE     -8                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
007090           PERFORM  ÉGÉâÅ[èàóù                                    
007100     END-EVALUATE.                                                
007110*                                                                 
007120 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóùÅ|ÇdÇwÇhÇs.                    
007130     EXIT.                                                        
007140******************************************************************
007150*    èIóπèàóù                                                    *
007160******************************************************************
007170 èIóπèàóù                             SECTION.                    
007180 èIóπèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
007190*                                                                 
007200*----------------------------------------------------------------*
007210*    ÇcÇaÉNÉçÅ[ÉY                                                *
007220*----------------------------------------------------------------*
007230     EXEC SQL                                                     
007240        CLOSE  CUR1                                               
007250     END-EXEC.                                                    
007260*----------------------------------------------------------------*
007270*    ÉtÉ@ÉCÉãÉNÉçÅ[ÉY                                            *
007280*----------------------------------------------------------------*
007290     CLOSE  èoóÕÉtÉ@ÉCÉã.                                         
007300*----------------------------------------------------------------*
007310*    åèêîÉÅÉbÉZÅ[ÉWèoóÕ                                          *
007320*----------------------------------------------------------------*
007330     PERFORM  åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù.                             
007340*----------------------------------------------------------------*
007350*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
007360*----------------------------------------------------------------*
007370     PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ.                                 
007380*--< ÉvÉçÉOÉâÉÄê≥èÌèIóπ >                                         
007390     MOVE  íËêîÅ|ê≥èÌèÛë‘             TO  PROGRAM-STATUS.         
007400*                                                                 
007410 èIóπèàóùÅ|ÇdÇwÇhÇs.                                              
007420     EXIT.                                                        
007430******************************************************************
007440*    èIóπÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
007450******************************************************************
007460 èIóπÉÅÉbÉZÅ[ÉWèoóÕ                   SECTION.                    
007470 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
007480*                                                                 
007490     INITIALIZE                       IF-CHOCO001.                
007500     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007510     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007520     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007530     MOVE  "END"                      TO  ã§ÇPÅ|èàóùéØï .         
007540     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007550     CALL  CLOCO001                USING  IF-CHOCO001.            
007560*                                                                 
007570 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
007580     EXIT.                                                        
007590******************************************************************
007600*    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
007610******************************************************************
007620 åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù               SECTION.                    
007630 åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                              
007640*                                                                 
007650     INITIALIZE                       IF-CHOCO001.                
007660     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007670     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007680     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007690     MOVE  "M40MAB"                   TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007700     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007710     MOVE  ÇvÅ|ì¸óÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007720     MOVE  "ëOéÛèÓïÒÇcÇaì¸óÕåèêî"     TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007730     CALL  CLOCO001                USING  IF-CHOCO001.            
007740*                                                                 
007750     INITIALIZE                       IF-CHOCO001.                
007760     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007770     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007780     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007790     MOVE  "SFHSED25"                 TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007800     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007810     MOVE  ÇvÅ|èoóÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007820     MOVE  "ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕåèêî"                   
007830                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007840     CALL  CLOCO001                USING  IF-CHOCO001.            
007850*                                                                 
007860 åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóùÅ|ÇdÇwÇhÇs.                                
007870     EXIT.                                                        
007880******************************************************************
007890*    ÉGÉâÅ[èàóù                                                  *
007900******************************************************************
007910 ÉGÉâÅ[èàóù                           SECTION.                    
007920 ÉGÉâÅ[èàóùÅ|ÇrÇsÇ`ÇqÇs.                                          
007930*                                                                 
007940     MOVE  "Y"                        TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO.    
007950     INITIALIZE                           IF-CHOCO001.            
007960*                                                                 
007970     EVALUATE  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh                                   
007980        WHEN  -1                                                  
007990*--< ÇnÇqÇ`ÇbÇkÇdê⁄ë±é∏îs >                                       
008000           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008010           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008020           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008030           MOVE  "CONNECT"            TO  ã§ÇPÅ|èàóùéØï           
008040           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008050           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008060           CALL  CLOCO001          USING  IF-CHOCO001             
008070*                                                                 
008080        WHEN  -2                                                  
008090*--< ã∆ñ±ä«óùÉeÅ[ÉuÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                             
008100           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008110           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008120           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008130           MOVE  "D70GYM"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008140           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
008150           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008160           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008170           CALL  CLOCO001          USING  IF-CHOCO001             
008180*                                                                 
008190        WHEN  -3                                                  
008200*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãÉIÅ[ÉvÉìé∏îs >                           
008210           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008220           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008230           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008240           MOVE  "M40MAB"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008250           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
008260           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008270           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008280           CALL  CLOCO001          USING  IF-CHOCO001             
008290*                                                                 
008300        WHEN  -4                                                  
008310*--< ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                   
008320           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008330           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008340           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008350           MOVE  "SFHSED25"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008360           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008370           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008380           MOVE  "ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ["       
008390                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008400           CALL  CLOCO001          USING  IF-CHOCO001             
008410*                                                                 
008420        WHEN  -5                                                  
008430*--< åãçáÉeÅ[ÉuÉãì«çûé∏îs >                                       
008440           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008450           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008460           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008470           MOVE  "M40MAB"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008480           MOVE  "FETCH"              TO  ã§ÇPÅ|èàóùéØï           
008490           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008500           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008510           CALL  CLOCO001          USING  IF-CHOCO001             
008520*                                                                 
008530        WHEN  -6                                                  
008540*--< çÄñ⁄ñºèÃÉ}ÉXÉ^ÉIÅ[ÉvÉìÉGÉâÅ[ >                               
008550           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008560           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008570           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008580           MOVE  "D19MSY"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008590           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
008600           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008610           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008620           CALL  CLOCO001          USING  IF-CHOCO001             
008630*                                                                 
008640        WHEN  -7                                                  
008650*--< ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÉIÅ[ÉvÉìÉGÉâÅ[ >                         
008660           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008670           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008680           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008690           MOVE  "M01SAJ"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008700           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
008710           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008720           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008730           CALL  CLOCO001          USING  IF-CHOCO001             
008740*                                                                 
008750        WHEN  -8                                                  
008760*--< ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕÉGÉâÅ[ >                       
008770           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008780           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008790           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008800           MOVE  "SFHSED25"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008810           MOVE  "WRITE"              TO  ã§ÇPÅ|èàóùéØï           
008820           MOVE  ÇvÅ|èÛë‘             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008830           MOVE  "ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕÉGÉâÅ[ "          
008840                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008850           CALL  CLOCO001          USING  IF-CHOCO001             
008860*                                                                 
008870        WHEN  OTHER                                               
008880           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
008890     END-EVALUATE.                                                
008900*                                                                 
008910 ÉGÉâÅ[èàóùÅ|ÇdÇwÇhÇs.                                            
008920     EXIT.                                                        
008930******************************************************************
008940*                  END OF PROGRAM                                *
008950******************************************************************
