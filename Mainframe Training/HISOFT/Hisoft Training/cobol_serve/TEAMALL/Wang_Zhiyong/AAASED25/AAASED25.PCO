000010******************************************************************
000020*         ÅÉäCãPìÓåè(ëÂòA)ÅÑ                                     *
000030*      1. ÉvÉçÉOÉâÉÄñº  : ëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉãçÏê¨                *
000040*      2. ÉvÉçÉOÉâÉÄID  : AAASED25                               *
000050*      3. èàóùäTóv      : åoóùí˜èàóùÅií†ï[çÏê¨Åj		       *			
000060*                         ÉäÅ[ÉXëOéÛä÷òAí†ï[íäèoÅB                 *
000070*                                                                *
000080*      4. çÏê¨é“        : â§íqóE                                  *
000090*      5. çÏê¨ì˙        : 2005.3.29                              *
000100******************************************************************
000110*                                                                 
000120******************************************************************
000130*    ÇhÇcÇdÇmÇsÇhÇeÇhÇbÇ`ÇsÇhÇnÇm  ÇcÇhÇuÇhÇrÇhÇnÇm              *
000140******************************************************************
000150 IDENTIFICATION                       DIVISION.                   
000160*                                                                 
000170 PROGRAM-ID.                          AAASED25.                   
000180******************************************************************
000190*    ÇdÇmÇuÇhÇqÇnÇmÇlÇdÇmÇs        ÇcÇhÇuÇhÇrÇhÇnÇm              *
000200******************************************************************
000210 ENVIRONMENT                          DIVISION.                   
000220******************************************************************
000230*    ÇhÇmÇoÇtÇsÅ|ÇnÇtÇsÇoÇtÇs      ÇrÇdÇbÇsÇhÇnÇm                *
000240******************************************************************
000250 INPUT-OUTPUT                         SECTION.                   
000260*                                                                 
000270 FILE-CONTROL.                                                    
000280      SELECT  èoÉJÉtÉ@ÉCÉã            ASSIGN     TO       U11     
000290      FILE    STATUS         IS       ÇvÅ|èÛë‘                    
000300      ORGANIZATION           IS       LINE        SEQUENTIAL.     
000310******************************************************************
000320*    ÇcÇ`ÇsÇ`                      ÇcÇhÇuÇhÇrÇhÇnÇm              *
000330******************************************************************
000340 DATA                                 DIVISION.                   
000350******************************************************************
000360*    ÇeÇhÇkÇd                      ÇrÇdÇbÇsÇhÇnÇm                *
000370******************************************************************
000380 FILE                                 SECTION.                    
000390******************************************************************
000400*            èoÉJÉtÉ@ÉCÉã                                        *
000410******************************************************************
000420 FD   èoÉJÉtÉ@ÉCÉã                                               
000430      LABEL   RECORD     IS           STANDARD                    
000440      BLOCK   CONTAINS    0           RECORDS.                    
000450*                                                                 
000460 01  èoÉJÅ[ÉåÉRÅ[Éh.                                              
000470    COPY   CPSCE50   REPLACING   ==()==  BY  ==èoÉJÅ[==.          
000480******************************************************************
000490*  ÇvÇnÇqÇjÇhÇmÇfÅ|ÇrÇsÇnÇqÇ`ÇfÇd  ÇrÇdÇbÇsÇhÇnÇm                *
000500******************************************************************
000510  WORKING-STORAGE                     SECTION.                    
000520*----------------------------------------------------------------*
000530*    ÉzÉXÉgïœêîíËã`ÉGÉäÉA                                        *
000540*----------------------------------------------------------------*
000550     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
000560*                                                                 
000570 01    ÇvÇrÅ|ñºèÃÇP              PIC      X(060).                 
000580 01    ÇvÇrÅ|ñºèÃÇQ              PIC      X(060).                 
000590 01    ÇvÇrÅ|ã∆ñ±ä«óùÇhÇc        PIC      X(08) VALUE 'GYMKNRRC'. 
000600 01    ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇP        PIC      X(012) VALUE '038'.     
000610 01    ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇQ        PIC      X(012) VALUE '005'.  
       01    ÇvÇrÅ|ÉåÉRÅ[ÉhãÊï™        PIC      X(01) VALUE '1'.
       01    ÇvÇrÅ|ÇlÇOÇPÅ|íSï€ãÊï™     PIC      X(01) VALUE '1'.
       01    ÇvÇrÅ|ÇlÇSÇOÅ|ã¶í≤ãÊï™     PIC      X(01) VALUE '2'.
000620*--< ÇnÇqÇ`ÇbÇkÇdã§í ïœêî >                                       
000630     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
000640*                                                                 
000650*--< ÇnÇqÇ`ÇbÇkÇd  ÇrÇpÇké¿çsèÓïÒ >                               
000660     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
000670*                                                                 
000680*--< ëOéÛèÓïÒÇcÇa>                                                
000690     EXEC  SQL  INCLUDE  M40MAB.CBL            END-EXEC.          
000700*                                                                 
000710*--<ã∆ñ±ä«óùÉeÅ[ÉuÉã >                                            
000720     EXEC  SQL  INCLUDE  D70GYM.CBL            END-EXEC.          
000730*                                                                 
000740*--<éÊà¯êÊÉ}ÉXÉ^ >                                                
000750     EXEC  SQL  INCLUDE  D01TRS.CBL            END-EXEC.          
000760*                                                                 
000770*--<êøãÅêÊÉ}ÉXÉ^>                                                 
000780     EXEC  SQL  INCLUDE  D02SQS.CBL            END-EXEC.          
000790*                                                                 
000800*--<çÄñ⁄ñºèÃÉ}ÉXÉ^>                                               
000810     EXEC  SQL  INCLUDE  D19MSY.CBL            END-EXEC.          
000820*                                                                 
000830*--<ç¬å†èÓïÒÅiàÍî ÅjÇcÇa>                                         
000840     EXEC  SQL  INCLUDE  M01SAJ.CBL            END-EXEC.          
000850*                                                                 
000860                                                                  
000870     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
000880*                                                                 
000890*----------------------------------------------------------------*
000900*    ÇvÇnÇqÇjÉGÉäÉA                                              *
000910*----------------------------------------------------------------*
000920 01  ÇvÇnÇqÇjÅ|ÉGÉäÉA.                                            
000930*--< ÉGÉâÅ[îªíËóp >                                               
000940     03  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             PIC S9(04).                 
000950     03  ÇvÅ|èÛë‘                     PIC X(02).                  
000960*                                                                 
000970*--< ÉtÉâÉOÉAÉäÉA >                                               
000980     03  ÉtÉâÉOÉAÉäÉA.                                            
000990         05  ÇvÅ|èIóπÅ|ÉtÉâÉO         PIC  X(01).                 
001000         05  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     PIC  X(01).                 
001010*                                                                 
001020*--< åèêîÉGÉäÉA >                                                 
001030     03  åèêîÉGÉäÉA.                                              
001040         05  ÇvÅ|ì¸óÕÅ|åèêî           PIC  9(09).                 
001050         05  ÇvÅ|èoóÕÅ|åèêî           PIC  9(09).                 
001060*                                                                 
001070                                                                  
001080 01  ÇvÅ|ã§í èÓïÒ.                                                
001090     03  ÇvÅ|ÉVÉXÉeÉÄì˙ït.                                        
001100         05  ÇvÅ|ê¢ãI                 PIC  X(02) VALUE  "20".     
001110         05  ÇvÅ|îNåéì˙               PIC  X(06).                 
001120     03  ÇvÅ|ÉVÉXÉeÉÄéûçè             PIC  X(08).                 
001130     03  ÇvÅ|íSìñé“                   PIC  X(08) VALUE "IKOPG ".  
001140*                                                                 
001150*----------------------------------------------------------------*
001160*    ÉTÉuÉãÅ[É`Éìñº                                              *
001170*----------------------------------------------------------------*
001180 01  CALL-AREA.                                                   
001190*--< ã§í ÉçÉOÉTÉuÉãÅ[É`Éì >                                       
001200     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001210     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001220*                                                                 
001230*----------------------------------------------------------------*
001240*    ÇbÇnÇoÇxóÃàÊ                                                *
001250*----------------------------------------------------------------*
001260*--< ã§í ÉçÉOópÉpÉâÉÅÅ[É^ >                                       
001270 01  IF-CHOCO001.                                                 
001280     COPY  CHOCO001  REPLACING  ==()==  BY  ==ã§ÇPÅ|==.           
001290*                                                                 
001300*----------------------------------------------------------------*
001310*    ÇhÇmÇhÉtÉ@ÉCÉãì«çûÉTÉuÉãÅ[É`ÉìópÉpÉâÉÅÉ^óÃàÊ                *
001320*----------------------------------------------------------------*
001330 01  PARA-AREA.                                                   
001340     COPY CPBCO001.                                               
001350******************************************************************
001360*    íËêîópÉfÅ[É^íËã`ÉGÉäÉA                                      *
001370******************************************************************
001380 CONSTANT                             SECTION.                    
001390 01  íËêîóÃàÊ.                                                    
001400     03  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc         PIC  X(08) VALUE "AAASED25".
001410     03  íËêîÅ|ÉvÉçÉOÉâÉÄñº           PIC  X(80)                  
001420                                VALUE "ëOéÛã‡éÛï•écçÇÉtÉ@ÉCÉãçÏê¨".        
001430     03  íËêîÅ|ÇrÇpÇkÇnÇj             PIC S9(04)  VALUE  ZERO.    
001440     03  íËêîÅ|ÇrÇpÇkÇdÇmÇc           PIC S9(04)  VALUE  0100.    
001450     03  íËêîÅ|ê≥èÌèÛë‘               PIC S9(04)  VALUE  ZERO.    
001460     03  íËêîÅ|àŸèÌèÛë‘               PIC S9(04)  VALUE  0009.    
001470******************************************************************
001480*    ÇoÇqÇnÇbÇdÇcÇtÇqÇd            ÇcÇhÇuÇhÇrÇhÇnÇm              *
001490******************************************************************
001500 PROCEDURE                            DIVISION.                   
001510*                                                                 
001520     PERFORM  èâä˙èàóù.                                           
001530*                                                                 
001540     PERFORM  éÂèàóù  UNTIL  ÇvÅ|èIóπÅ|ÉtÉâÉO  =  "Y".            
001550*                                                                 
001560     PERFORM  èIóπèàóù.                                           
001570*                                                                 
001580     STOP     RUN.                                                
001590*                                                                 
001600******************************************************************
001610*    èâä˙èàóù                                                    *
001620******************************************************************
001630 èâä˙èàóù                             SECTION.                    
001640 èâä˙èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
001650*----------------------------------------------------------------*
001660*    äJénÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
001670*----------------------------------------------------------------*
001680     INITIALIZE                       IF-CHOCO001.                
001690     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
001700     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
001710     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
001720     MOVE  "START"                    TO  ã§ÇPÅ|èàóùéØï .         
001730     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
001740     CALL  CLOCO001                USING  IF-CHOCO001.            
001750*----------------------------------------------------------------*
001760*    çÏã∆óÃàÊÇÃèâä˙ílèàóù                                        *
001770*----------------------------------------------------------------*
001780     MOVE  SPACE                      TO  ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001790     INITIALIZE                           ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001800*                                                                 
001810*                                                                 
001820*--< ÇbÇoÇtì˙ïtÇéÊìæ >                                           
001830     ACCEPT  ÇvÅ|îNåéì˙               FROM  DATE.                 
001840*                                                                 
001850*--< ÇbÇoÇtéûçèÇéÊìæ >                                           
001860     ACCEPT  ÇvÅ|ÉVÉXÉeÉÄéûçè         FROM  TIME.                 
001870*                                                                 
001880*--< ÇnÇqÇ`ÇbÇkÇdê⁄ë± >                                           
001890     PERFORM   ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                                  
001900*                                                                 
001910*--< ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû >                                       
001920     PERFORM  ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû.                               
001930*                                                                 
001940*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãêÈåæ >                                   
001950     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãêÈåæ.                           
001960*                                                                 
001970*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉì >                                           
001980     PERFORM  ÉtÉ@ÉCÉãÉIÅ[ÉvÉì.  
001990
002000*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû >                                   
002010     PERFORM   åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                          
002020*                                                                 
002030 èâä˙èàóùÅ|ÇdÇwÇhÇs.                                              
002040     EXIT.                                                        
002050******************************************************************
002060*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
002070******************************************************************
002080 ÇnÇqÇ`ÇbÇkÇdê⁄ë±                     SECTION.                    
002090 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇrÇsÇ`ÇqÇs.                                    
002100*                                                                 
002110*--< ÇcÇaê⁄ë±ópèÓïÒÇéÊìæèàóù >                                   
002120     CALL  COBCO001                USING  PARA-AREA.              
002130*                                                                 
002140     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002150     MOVE  PARA-USERNAME              TO  USERNAME.               
002160     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002170*----------------------------------------------------------------*
002180*    äJénê⁄ë±                                                    *
002190*----------------------------------------------------------------*
002200     IF    DB-STRING  =  SPACE                                    
002210        EXEC SQL                                                  
002220           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002230        END-EXEC                                                  
002240     ELSE                                                         
002250        EXEC SQL                                                  
002260           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002270             USING  :DB-STRING                                    
002280        END-EXEC                                                  
002290     END-IF.                                                      
002300*----------------------------------------------------------------*
002310*    ê⁄ë±ämîF                                                    *
002320*----------------------------------------------------------------*
002330     EVALUATE  SQLCODE                                            
002340        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002350           CONTINUE                                               
002360        WHEN   OTHER                                              
002370*--< ê⁄ë±ÉGÉâÅ[ >                                                 
002380           MOVE     -10               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002390           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002400     END-EVALUATE.                                                
002410*                                                                 
002420 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇdÇwÇhÇs.                                      
002430     EXIT.                                                        
002440                                                                  
002450******************************************************************
002460*        ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû.                                   *
002470******************************************************************
002480 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çû                 SECTION.                    
002490 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇrÇsÇ`ÇqÇs.                                
002500*----------------------------------------------------------------*
002510*    ÉoÉbÉ`ópã∆ñ±îNåéSELECTèàóù                                  *
002520*----------------------------------------------------------------*
002530      EXEC SQL                                                    
002540         SELECT  ÉoÉbÉ`ópã∆ñ±îNåé                              
002550         INTO :ÇcÇVÇOÅ|ÉoÉbÉ`ópã∆ñ±îNåé                                   
002560         FROM  D70GYM_TBL                                         
002570         WHERE ã∆ñ±ä«óùÇhÇc = :ÇvÇrÅ|ã∆ñ±ä«óùÇhÇc      
002580      END-EXEC.                                                   
002590*----------------------------------------------------------------*
002600*   ã∆ñ±îNåé ämîF                                                *
002610*---------------------------------------------------------------- 
002620     EVALUATE  SQLCODE                                            
002630        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
002640*--< ê≥èÌ >                                                       
002650           CONTINUE                                               
002660        WHEN  OTHER                                               
002670*--< ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                                     
002680           MOVE -20                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002690           MOVE  "Y"                  TO   ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO   
002700           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002710     END-EVALUATE.                                                
002720*                                                                 
002730 ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûÅ|ÇdÇwÇhÇs.                                  
002740     EXIT.                                                        
002750******************************************************************
002760*        åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`                                *
002770******************************************************************
002780 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãêÈåæ             SECTION.                    
002790 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãêÈåæÅ|ÇrÇsÇ`ÇqÇs.                            
002800*----------------------------------------------------------------*
002810*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
002820*----------------------------------------------------------------*
002830     EXEC SQL                                                     
002840        DECLARE CUR1  CURSOR FOR                                  
002850           SELECT  M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™                        
002860                  ,M40MAB_TBL.åoóùópéÂå_ñÒãÊï™                    
002870                  ,M40MAB_TBL.å⁄ãqãÊï™                            
002880                  ,NVL(D01TRS_TBL.ñºäÒÇπÉRÅ[Éh,RPAD(' ',40,' '))  
002890                  ,M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh                  
002900                  ,M40MAB_TBL.êøãÅêÊÉRÅ[Éh                        
002910                  ,M40MAB_TBL.å_ñÒî‘çÜ                            
002920                  ,M40MAB_TBL.å_ñÒéÌóﬁ                            
002930                  ,M40MAB_TBL.íSìñïîâ€ÉRÅ[Éh                      
002940                  ,M40MAB_TBL.çƒÉäÅ[ÉXâÒêî                        
002950                  ,M40MAB_TBL.è[ìñäJénîNåé                        
002960                  ,M40MAB_TBL.è[ìñåéêî                            
002970                  ,M40MAB_TBL.ëOï•âÒé˚ï˚ñ@                        
002980                  ,M40MAB_TBL.ì¸ã‡ì˙                              
002990                  ,M40MAB_TBL.ì¸ã‡ãÊï™                            
003000                  ,NVL(D01TRS_TBL.éÊà¯êÊñºèÃ,RPAD(' ',80,' '))    
003010                  ,NVL(D02SQS_TBL.êøãÅêÊñºèÃ,RPAD(' ',80,' '))    
003020                  ,M40MAB_TBL.ëOåéññécçÇ                          
003030                  ,M40MAB_TBL.ìñåéâÒé˚äz                          
003040                  ,M40MAB_TBL.ìñåéè¡âªäz                          
003050                  ,M40MAB_TBL.ìñåéññécçÇ                          
003060                  ,M40MAB_TBL.ã¶í≤ãÊï™                            
003070                  ,M40MAB_TBL.ëOåéññécçÇëºé–                      
003080                  ,M40MAB_TBL.ìñåéâÒé˚äzëºé–                      
003090                  ,M40MAB_TBL.ìñåéè¡âªäzëºé–                      
003100                  ,M40MAB_TBL.ìñåéëºé–âñÒï™óøã‡                  
003110                  ,M40MAB_TBL.ìñåéëºé–âñÒï™è¡îÔê≈                
003120                  ,M40MAB_TBL.ìñåéññécçÇëºé–                      
003130             FROM  M40MAB_TBL                                      
003140                  ,D01TRS_TBL                                     
003150                  ,D02SQS_TBL                                     
003160            WHERE  M40MAB_TBL.ëOéÛã‡éÛï•écçÇï\ëŒè€ÉtÉâÉO  =  '1'  
003170              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh    =             
003180                   D01TRS_TBL.éÊà¯êÊÉRÅ[Éh(+)                     
003190              AND  M40MAB_TBL.êøãÅêÊéÊà¯êÊÉRÅ[Éh    =             
003200                   D02SQS_TBL.éÊà¯êÊÉRÅ[Éh(+)                     
003210              AND  M40MAB_TBL.êøãÅêÊÉRÅ[Éh          =             
003220                   D02SQS_TBL.êøãÅêÊÉRÅ[Éh(+)                     
003230            ORDER BY  M40MAB_TBL.ÉåÉRÅ[ÉhãÊï™                     
003240                  ,M40MAB_TBL.å_ñÒî‘çÜ                            
003250                                                                  
003260     END-EXEC.                                                    
003270*----------------------------------------------------------------*
003280*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
003290*----------------------------------------------------------------*
003300     EXEC  SQL                                                    
003310        OPEN  CUR1                                                
003320     END-EXEC.                                                    
003330*----------------------------------------------------------------*
003340*    ÉJÅ[É\ÉãÇnÇoÇdÇmämîF                                        *
003350*----------------------------------------------------------------*
003360     EVALUATE  SQLCODE                                            
003370        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
003380*--< ê≥èÌ >                                                 
003390           CONTINUE                                               
003400        WHEN  OTHER                                               
003410*--< ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
003420           MOVE  -30                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
003430           PERFORM  ÉGÉâÅ[îªíËèàóù                                
003440     END-EVALUATE.                                                
003450 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãêÈåæÅ|ÇdÇwÇhÇs.                              
003460     EXIT.                                                        
003470                                                                  
003480***************************************************************** 
003490*                   ÉtÉ@ÉCÉãÉIÅ[ÉvÉì.                           * 
003500***************************************************************** 
003510 ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                     SECTION.                    
003520 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇrÇsÇ`ÇqÇs.                                    
003530     OPEN  OUTPUT  èoÉJÉtÉ@ÉCÉã.                                  
003540*----------------------------------------------------------------*
003550*   ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÇnÇoÇdÇmämîF                                 *
003560*----------------------------------------------------------------*
003570     EVALUATE   ÇvÅ|èÛë‘                                          
003580        WHEN  ZERO                                                
003590*--< ê≥èÌ >                                                       
003600           CONTINUE                                               
003610        WHEN  OTHER                                               
003620*--< ÉtÉ@ÉCÉãÇnÇoÇdÇmÉGÉâÅ[ >                                     
003630           MOVE -40                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003640           PERFORM  ÉGÉâÅ[îªíËèàóù                                
003650     END-EVALUATE.                                                
003660 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇdÇwÇhÇs.                                      
003670     EXIT.                                                        
003680                                                                  
003690******************************************************************
003700*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                                    *
003710******************************************************************
003720 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû             SECTION.                    
003730 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇrÇsÇ`ÇqÇs.                            
003740                                                                  
003750*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû >                                   
003760     EXEC SQL                                                     
003770         FETCH  CUR1                                              
003780          INTO :ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™,                             
003790               :ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™,                         
003800               :ÇlÇSÇOÅ|å⁄ãqãÊï™,                                 
003810               :ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh,                             
003820               :ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh,                       
003830               :ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh,                             
003840               :ÇlÇSÇOÅ|å_ñÒî‘çÜ,                                 
003850               :ÇlÇSÇOÅ|å_ñÒéÌóﬁ,                                 
003860               :ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh,                           
003870               :ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî,                             
003880               :ÇlÇSÇOÅ|è[ìñäJénîNåé,                             
003890               :ÇlÇSÇOÅ|è[ìñåéêî,                                  
003900               :ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@,                             
003910               :ÇlÇSÇOÅ|ì¸ã‡ì˙,                                   
003920               :ÇlÇSÇOÅ|ì¸ã‡ãÊï™,                                 
003930               :ÇcÇOÇPÅ|éÊà¯êÊñºèÃ,                               
003940               :ÇcÇOÇQÅ|êøãÅêÊñºèÃ,                               
003950               :ÇlÇSÇOÅ|ëOåéññécçÇ,                               
003960               :ÇlÇSÇOÅ|ìñåéâÒé˚äz,                               
003970               :ÇlÇSÇOÅ|ìñåéè¡âªäz,                               
003980               :ÇlÇSÇOÅ|ìñåéññécçÇ                                
003990     END-EXEC.                                                    
004000                                                                  
004010                                                                  
004020*----------------------------------------------------------------*
004030*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÇämîF                              *
004040*----------------------------------------------------------------*
004050     EVALUATE   SQLCODE                                           
004060        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
004070*--< ê≥èÌ >                                                 
004080                                                                  
004090        CONTINUE                                                   
004100        WHEN   íËêîÅ|ÇrÇpÇkÇdÇmÇc                                 
004110*--< ì«çûèIóπ >                                             
004120           MOVE  "Y"                  TO  ÇvÅ|èIóπÅ|ÉtÉâÉO        
004130        WHEN   OTHER                                              
004140*--< ì«çûÉGÉâÅ[ >                                           
004150           MOVE     -50               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
004160           PERFORM  ÉGÉâÅ[îªíËèàóù                                
004170     END-EVALUATE.                                                
004180*                                                                 
004190 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇdÇwÇhÇs.                              
004200     EXIT.                                                        
004210******************************************************************
004220*    éÂèàóù                                                      *
004230******************************************************************
004240 éÂèàóù                               SECTION.                    
004250 éÂèàóùÅ|ÇrÇsÇ`ÇqÇs.                                              
004260*--<çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù> 
004270
004280     PERFORM  çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù.                   
004290                                                                  
004300*--<ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù>                      
004310                                                                  
004320     PERFORM  ç¬å†èÓïÒàÍî ÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù.                 
004330                                                                  
004340*--<ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕîªíËèàóù>                       
004350                                                                  
004360     PERFORM  ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕîªíËèàóù.             
004370                                                                  
004380*--<åãçáÉeÅ[ÉuÉãì«çûÅiÇQåèñ⁄à»ç~Åj>                               
004390                                                                  
004400     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                       
004410*                                                                 
004420 éÂèàóùÅ|ÇdÇwÇhÇs.                                                
004430     EXIT.                                                        
004440                                                                  
004450******************************************************************
004460*    çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù.                           *
004470***************************************************************** 
004480 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóù     SECTION.                    
004490 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóùÅ|ÇrÇsÇ`ÇqÇs.                    
004500                                                                  
004510     PERFORM  çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒãÊï™ñºÇÃíäèoèàóù.           
004520                                                                  
004530     PERFORM  çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËå⁄ãqãÊï™ñºèÃÇÃíäèoèàóù.           
004540                                                                  
004550 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËçÄñ⁄ÇÃíäèoèàóùÅ|ÇdÇwÇhÇs.                      
004560     EXIT.                                                        
004570******************************************************************
004580* çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒãÊï™ñºÇÃíäèoèàóù.                      *
004590******************************************************************
004600 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒãÊï™ñºÇÃíäèoèàóù        SECTION.         
004610 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒãÊï™ñºÇÃíäèoèàóùÅ|ÇrÇsÇ`ÇqÇs.            
004620     EXEC SQL                                                     
004630        SELECT  D19MSY_TBL.ñºèÃ                                   
004640        INTO :ÇvÇrÅ|ñºèÃÇP                                        
004650        FROM  D19MSY_TBL,M40MAB_TBL                               
004660        WHERE  D19MSY_TBL.ÉRÅ[ÉhÇmÇn  =  :ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇP      
004670        AND  SUBSTR(D19MSY_TBL.ÉRÅ[Éh ,1,1) =                     
004680             :ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™                             
004690     END-EXEC.                                                    
004700*----------------------------------------------------------------*
004710*   çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒãÊï™ñºÇÃíäèoèàóù ämîF                *
004720*----------------------------------------------------------------*
004730     EVALUATE  SQLCODE                                            
004740*                                                                 
004750        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
004760*--< ê≥èÌ >                                                       
004770           CONTINUE                                               
004780*                                                                 
004790        WHEN  OTHER                                               
004800*--< ë∂ç›ÇµÇ»Ç¢>                                                  
004810            MOVE    SPACE             TO      ÇvÇrÅ|ñºèÃÇP        
004820*                                                                 
004830            MOVE   -60                TO      ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh    
004840            PERFORM  ÉGÉâÅ[îªíËèàóù                               
004850     END-EVALUATE.                                                
004860*                                                                 
004870 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËéÂå_ñÒãÊï™ñºÇÃíäèoèàóùÅ|ÇdÇwÇhÇs.              
004880     EXIT.                                                        
004890******************************************************************
004900* çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËå⁄ãqãÊï™ñºèÃÇÃíäèoèàóù.                      *
004910******************************************************************
004920 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËå⁄ãqãÊï™ñºèÃÇÃíäèoèàóù   SECTION.              
004930 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËå⁄ãqãÊï™ñºèÃÇÃíäèoèàóùÅ|ÇrÇsÇ`ÇqÇs.            
004940     EXEC SQL                                                     
004950        SELECT  D19MSY_TBL.ñºèÃ                                   
004960        INTO :ÇvÇrÅ|ñºèÃÇQ                                        
004970        FROM  D19MSY_TBL                                          
004980             ,M40MAB_TBL                                          
004990        WHERE  D19MSY_TBL.ÉRÅ[ÉhÇmÇn =  :ÇvÇrÅ|ÉRÅ[ÉhÇmÇnÇQ       
005000        AND  SUBSTR(D19MSY_TBL.ÉRÅ[Éh,1,2) =                      
005010             :ÇlÇSÇOÅ|å⁄ãqãÊï™                                    
005020     END-EXEC.                                                    
005030*----------------------------------------------------------------*
005040*   çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËå⁄ãqãÊï™ñºèÃÇÃíäèoèàóù ämîF                *
005050*----------------------------------------------------------------*
005060     EVALUATE  SQLCODE                                            
005070        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
005080*--< ê≥èÌ >                                                       
005090           CONTINUE                                               
005100        WHEN  OTHER                                               
005110*--< ë∂ç›ÇµÇ»Ç¢ >                                                 
005120*                                                                 
005130            MOVE     SPACE            TO     ÇvÇrÅ|ñºèÃÇQ         
005140*                                                                 
005150            MOVE   -60                TO      ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh    
005160*                                                                 
005170            PERFORM  ÉGÉâÅ[îªíËèàóù                               
005180     END-EVALUATE.                                                
005190 çÄñ⁄ñºèÃÉ}ÉXÉ^ÇÊÇËå⁄ãqãÊï™ñºèÃÇÃíäèoèàóùÅ|ÇdÇwÇhÇs.              
005200     EXIT.                                                        
005210******************************************************************
005220*  ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù                        *
005230******************************************************************
005240 ç¬å†èÓïÒàÍî ÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù     SECTION.                  
005250 ç¬å†èÓïÒàÍî ÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóùÅ|ÇrÇsÇ`ÇqÇs.                  
005260     EXEC SQL                                                     
005270       SELECT  M01SAJ_TBL.èÛë‘ÉtÉâÉO                              
005280              ,M01SAJ_TBL.ç¬å†å_ñÒåèñº                            
005290              ,M01SAJ_TBL.íSï€ãÊï™                                
005300        INTO :ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO,                                 
005310             :ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº,                               
005320             :ÇlÇOÇPÅ|íSï€ãÊï™                                    
005330        FROM  M01SAJ_TBL                                          
005340             ,M40MAB_TBL                                          
005350       WHERE  M01SAJ_TBL.ÉåÉRÅ[ÉhãÊï™ = :ÇvÇrÅ|ÉåÉRÅ[ÉhãÊï™                       
005360         AND  M01SAJ_TBL.å_ñÒî‘çÜ	= M40MAB_TBL.å_ñÒî‘çÜ           
005370         AND  M01SAJ_TBL.çƒÉäÅ[ÉXâÒêî  = M40MAB_TBL.çƒÉäÅ[ÉXâÒêî  
005380         AND  M01SAJ_TBL.å_ñÒéÌóﬁ	= M40MAB_TBL.å_ñÒéÌóﬁ           
005390     END-EXEC.                                                    
005400*----------------------------------------------------------------*
005410*   ç¬å†èÓïÒÅiàÍî ÅjÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóù                       *
005420*----------------------------------------------------------------*
005430     EVALUATE  SQLCODE                                            
005440        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
005450*--< ê≥èÌ >                                                       
005460           CONTINUE                                               
005470        WHEN  OTHER                                               
005480*--<  ë∂ç›ÇµÇ»Ç¢ >                                                
005490            MOVE SPACE TO    ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO,                  
005500                             ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº,                
005510                             ÇlÇOÇPÅ|íSï€ãÊï™                     
005520                                                                  
005530            MOVE   -70                TO      ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh    
005540                                                                  
005550            PERFORM  ÉGÉâÅ[îªíËèàóù                               
005560     END-EVALUATE.                                                
005570 ç¬å†èÓïÒàÍî ÇcÇaÇÊÇËçÄñ⁄ÇÃíäèoèàóùÅ|ÇdÇwÇhÇs.                    
005580     EXIT.                                                        
005590******************************************************************
005600*       ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕîªíËèàóù	               *
005610******************************************************************
005620 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕîªíËèàóù	SECTION.                
005630 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕîªíËèàóùÅ|ÇrÇsÇ`ÇqÇs.              
005640     IF  ÇlÇOÇPÅ|íSï€ãÊï™	NOT = ÇvÇrÅ|ÇlÇOÇPÅ|íSï€ãÊï™                               
005650                                                                  
005660         PERFORM  ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWèoóÕèàóù      
005670                                                                  
005680     ELSE                                                         
005690                                                                  
005700         PERFORM  ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWèàóùëºé–ï™    
005710                                                                  
005720     END-IF.                                                      
005730                                                                  
005740 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕîªíËèàóùÅ|ÇdÇwÇhÇs.                
005750     EXIT.                                                        
005760******************************************************************
005770*       ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWèoóÕèàóù               *
005780******************************************************************
005790 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWèoóÕèàóù        SECTION.       
005800 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.          
005810*--< No.1 >                                                       
005820     IF  ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO  <  3                                 
005830         MOVE    '3'     TO   èoÉJÅ[é©ëºé–ãÊï™                    
005840     ELSE                                                         
005850         MOVE    '1'     TO   èoÉJÅ[é©ëºé–ãÊï™                    
005860     END-IF.                                                      
005870*--< é©é–ï™ÅEé©é–ï™Ç∆ìØól >                                       
005880         PERFORM  é©é–ï™é©é–ï™Ç∆ìØól.                             
005890*--< No.23 >                                                      
005900         MOVE    èoÉJÅ[ëOåéññécçÇ     TO    ÇlÇSÇOÅ|ëOåéññécçÇ.   
005910*--< No.24 >                                                      
005920         MOVE    èoÉJÅ[ìñåéì¸ã‡äz     TO    ÇlÇSÇOÅ|ìñåéâÒé˚äz.	
005930*--< No.25 >                                                      
005940         MOVE    èoÉJÅ[ìñåéè¡âªäz     TO    ÇlÇSÇOÅ|ìñåéè¡âªäz.   
005950*--< No.26 >                                                      
005960         MOVE    èoÉJÅ[ìñåéññécçÇ     TO    ÇlÇSÇOÅ|ìñåéññécçÇ.   
005970                                                                  
005980     PERFORM   ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóù.                
005990                                                                  
006000     PERFORM  ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWèàóùëºé–ï™.       
006010                                                                  
006020 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWèoóÕèàóùÅ|ÇdÇwÇhÇs.            
006030     EXIT.                                                        
006040******************************************************************
006050*           é©é–ï™ÅEé©é–ï™Ç∆ìØól.                                *
006060******************************************************************
006070 é©é–ï™é©é–ï™Ç∆ìØól                     SECTION.                  
006080 é©é–ï™é©é–ï™Ç∆ìØólÅ|ÇrÇsÇ`ÇqÇs.                                  
006090*--< No.2 >                                                       
006100         MOVE    ÇlÇSÇOÅ|ÉåÉRÅ[ÉhãÊï™       TO    èoÉJÅ[ëOéÛãÊï™. 
006110*--< No.3 >                                                       
006120         MOVE    ÇlÇSÇOÅ|åoóùópéÂå_ñÒãÊï™     TO   èoÉJÅ[éÂå_ñÒãÊï™.
006130*--< No.4 >                                                       
006140         MOVE    ÇlÇSÇOÅ|å⁄ãqãÊï™       TO    èoÉJÅ[òAåããÊï™.     
006150*--< No.5 >                                                       
006160         MOVE    ÇcÇOÇPÅ|ñºäÒÇπÉRÅ[Éh   TO    èoÉJÅ[ñºäÒÇπÉRÅ[Éh. 
006170*--< No.6 >                                                       
006180         MOVE    ÇlÇSÇOÅ|êøãÅêÊéÊà¯êÊÉRÅ[Éh   TO   èoÉJÅ[éÊà¯êÊÉRÅ[Éh.
006190*--< No.7 >                                                       
006200         MOVE    ÇlÇSÇOÅ|êøãÅêÊÉRÅ[Éh   TO    èoÉJÅ[êøãÅêÊÉRÅ[Éh. 
006210*--< No.8 >                                                       
006220         MOVE     ÇlÇSÇOÅ|å_ñÒî‘çÜ      TO    èoÉJÅ[å_ñÒî‘çÜ.     
006230*--< No.9 >                                                       
006240         MOVE     ÇlÇSÇOÅ|å_ñÒéÌóﬁ      TO    èoÉJÅ[å_ñÒéÌóﬁ.     
006250*--< No.10 >                                                      
006260         MOVE     ÇcÇVÇOÅ|ÉoÉbÉ`ópã∆ñ±îNåé     TO   èoÉJÅ[ã∆ñ±îNåé.
006270*--< No.11 >                                                      
006280         MOVE    ÇlÇSÇOÅ|íSìñïîâ€ÉRÅ[Éh TO    èoÉJÅ[íSìñïîâ€ÉRÅ[Éh. 
006290*--< No.12 >                                                      
006300         MOVE    ÇlÇOÇPÅ|ç¬å†å_ñÒåèñº       TO    èoÉJÅ[å_ñÒåèñº. 
006310*--< No.13 >                                                      
006320         MOVE    ÇlÇSÇOÅ|çƒÉäÅ[ÉXâÒêî   TO    èoÉJÅ[çƒÉäÅ[ÉXâÒêî. 
006330*--< No.14 >                                                      
006340         MOVE    èoÉJÅ[è[ìñäJénîNåé   TO    èoÉJÅ[è[ìñäJénîNåé.   
006350*--< No.15 >                                                      
006360         MOVE     ÇlÇSÇOÅ|è[ìñåéêî      TO    èoÉJÅ[è[ìñåéêî.     
006370*--< No.16 >                                                      
006380         MOVE    ÇlÇSÇOÅ|ëOï•âÒé˚ï˚ñ@   TO    èoÉJÅ[ëOï•âÒé˚ï˚ñ@. 
006390*--< No.17 >                                                      
006400         MOVE    ÇlÇSÇOÅ|ì¸ã‡ì˙         TO    èoÉJÅ[ì¸ã‡ì˙.       
006410*--< No.18 >                                                      
006420         MOVE     ÇlÇSÇOÅ|ì¸ã‡ãÊï™      TO    èoÉJÅ[ì¸ã‡ãÊï™.    
006430*--< No.19 >                                                      
006440         MOVE     ÇcÇOÇPÅ|éÊà¯êÊñºèÃ    TO    èoÉJÅ[éÊà¯êÊñºèÃ.   
006450*--< No.20 >                                                      
006460	       MOVE    ÇcÇOÇQÅ|êøãÅêÊñºèÃ    TO    èoÉJÅ[êøãÅêÊñºèÃ.    
006470*--< No.21 >                                                      
006480         MOVE    ÇvÇrÅ|ñºèÃÇP TO    èoÉJÅ[éÂå_ñÒãÊï™ñºèÃ.         
006490*--< No.22 >                                                      
006500         MOVE     ÇvÇrÅ|ñºèÃÇQ  TO    èoÉJÅ[òAåããÊï™ñºèÃ.         
006510                                                                  
006520 é©é–ï™é©é–ï™Ç∆ìØólÅ|ÇdÇwÇhÇs.                                    
006530     EXIT.                                                        
006540******************************************************************
006550*    ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóù                          *
006560******************************************************************
006570 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóù        SECTION.               
006580 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                  
006590*----------------------------------------------------------------*
006600*    ëOåéññécçÇÅAìñåéâÒé˚äzÅAìñåéè¡âªäzÅAìñåéññécçÇÅ@            *
006610*    Ç™ëSÇƒÉ[ÉçÇÃèÍçáÇÕèoóÕèàóùÇçsÇÌÇ»Ç¢                        *
006620*----------------------------------------------------------------*
006630     IF    èoÉJÅ[ëOåéññécçÇ  NOT = ZERO                           
006640       AND èoÉJÅ[ìñåéì¸ã‡äz  NOT = ZERO                           
006650       AND èoÉJÅ[ìñåéè¡âªäz  NOT = ZERO                           
006660       AND èoÉJÅ[ìñåéññécçÇ  NOT = ZERO                           
006670       WRITE   èoÉJÅ[ÉåÉRÅ[Éh                                    
006680     END-IF.                                                      
006690     EVALUATE   ÇvÅ|èÛë‘                                          
006700         WHEN   ZERO                                              
006710*--< ê≥èÌ >                                                       
006720            COMPUTE  ÇvÅ|ì¸óÕÅ|åèêî  =  ÇvÅ|ì¸óÕÅ|åèêî  +  1      
006730         WHEN   OTHER                                             
006740            MOVE     -8                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh       
006750            PERFORM  ÉGÉâÅ[îªíËèàóù                                   
006760     END-EVALUATE.                                                
006770                                                                  
006780 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóùÅ|ÇdÇwÇhÇs.                    
006790     EXIT.                                                        
006800******************************************************************
006810*    ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWèàóùÅiëºé–ï™)             *
006820******************************************************************
006830 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWèàóùëºé–ï™      SECTION.       
006840 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWèàóùëºé–ï™Å|ÇrÇsÇ`ÇqÇs.        
006850                                                                  
006860     IF   ÇlÇSÇOÅ|ã¶í≤ãÊï™  =  ÇvÇrÅ|ÇlÇSÇOÅ|ã¶í≤ãÊï™                                  
006870                                                                  
006880          PERFORM ëºé–ï™ÇÃçÄñ⁄ï“èWèoóÕèàóù                        
006890                                                                  
006900     END-IF.                                                      
006910                                                                  
006920 ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãçÄñ⁄ï“èWèàóùëºé–ï™Å|ÇdÇwÇhÇs.          
006930     EXIT.                                                        
006940******************************************************************
006950*    ëºé–ï™ÇÃçÄñ⁄ï“èWèoóÕèàóù                                    *
006960******************************************************************
006970 ëºé–ï™ÇÃçÄñ⁄ï“èWèoóÕèàóù               SECTION.                  
006980 ëºé–ï™ÇÃçÄñ⁄ï“èWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                            
006990     IF    ÇlÇOÇPÅ|èÛë‘ÉtÉâÉO  <  3                               
007000         MOVE    '4'     TO   èoÉJÅ[é©ëºé–ãÊï™                    
007010     ELSE                                                         
007020         MOVE    '2'     TO   èoÉJÅ[é©ëºé–ãÊï™                    
007030     END-IF.                                                      
007040         PERFORM  é©é–ï™é©é–ï™Ç∆ìØól.                           
007050         MOVE    ÇlÇSÇOÅ|ëOåéññécçÇëºé–    TO    èoÉJÅ[ëOåéññécçÇ.
007060                                                                  
007070         MOVE    ÇlÇSÇOÅ|ìñåéâÒé˚äzëºé–    TO    èoÉJÅ[ìñåéì¸ã‡äz.
007080                                                                  
007090         COMPUTE ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–  =                
007100                                   ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡     
007110                                  +  ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈.
007120         MOVE    ÇlÇSÇOÅ|ìñåéè¡âªäzëºé–    TO    èoÉJÅ[ìñåéè¡âªäz.
007130                                                                  
007140         COMPUTE ÇlÇSÇOÅ|ìñåéññécçÇëºé–  =                        
007150                                   ÇlÇSÇOÅ|ìñåéëºé–âñÒï™óøã‡     
007160                                  +  ÇlÇSÇOÅ|ìñåéëºé–âñÒï™è¡îÔê≈.
007170         MOVE    ÇlÇSÇOÅ|ìñåéññécçÇëºé–    TO    èoÉJÅ[ìñåéññécçÇ.
007180                                                                  
007190         PERFORM   ëOéÛã‡éÛï•écçÇíÜä‘ÉtÉ@ÉCÉãèoóÕèàóù.            
007200 ëºé–ï™ÇÃçÄñ⁄ï“èWèoóÕèàóùÅ|ÇdÇwÇhÇs.
007210     EXIT.
007220******************************************************************
007230*    èIóπèàóù                                                    *
007240******************************************************************
007250 èIóπèàóù                             SECTION.                    
007260 èIóπèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
007270                                                                  
007280     PERFORM  ÇcÇaÉNÉçÅ[ÉYèàóù.                                   
007290                                                                  
007300     CLOSE    èoÉJÉtÉ@ÉCÉã.                                       
007310                                                                  
007320     PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ.                                 
007330                                                                  
007340*--< ÉvÉçÉOÉâÉÄê≥èÌèIóπ >                                         
007350     MOVE  íËêîÅ|ê≥èÌèÛë‘             TO  PROGRAM-STATUS.         
007360                                                                  
007370 èIóπèàóùÅ|ÇdÇwÇhÇs.                                              
007380     EXIT.                                                        
007390******************************************************************
007400*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
007410******************************************************************
007420 èIóπÉÅÉbÉZÅ[ÉWèoóÕ                   SECTION.                    
007430 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
007440*----------------------------------------------------------------*
007450*    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
007460*----------------------------------------------------------------*
007470     INITIALIZE                       IF-CHOCO001.                
007480     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007490     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007500     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007510     MOVE  "M40MAB"                  TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007520     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007530     MOVE  ÇvÅ|ì¸óÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007540     MOVE  "ëOéÛèÓïÒ(åãçá)ÇcÇa"                         
007550                                      TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007560     CALL  CLOCO001                USING  IF-CHOCO001.            
007570                                                                  
007580     INITIALIZE                       IF-CHOCO001.                
007590     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007600     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007610     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007620     MOVE  "SEHSED25"                   TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc. 
007630     MOVE  "COUNT"                    TO  ã§ÇPÅ|èàóùéØï .         
007640     MOVE  ÇvÅ|èoóÕÅ|åèêî             TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe.       
007650     MOVE  "ëOéÛã‡éÛï•écçÇíÜä‘Çe"       TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007660     CALL  CLOCO001                USING  IF-CHOCO001.            
007670*----------------------------------------------------------------*
007680*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
007690*----------------------------------------------------------------*
007700     INITIALIZE                       IF-CHOCO001.                
007710     MOVE  "3"                        TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï .     
007720     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§ÇPÅ|É\Å[ÉXÇhÇc.       
007730     MOVE  "0"                        TO  ã§ÇPÅ|ïúãAÉRÅ[Éh.       
007740     MOVE  "END"                      TO  ã§ÇPÅ|èàóùéØï .         
007750     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
007760     CALL  CLOCO001                USING  IF-CHOCO001.            
007770                                                                  
007780 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
007790     EXIT.                                                        
007800******************************************************************
007810*    ÇcÇaÉNÉçÅ[ÉY                                                *
007820******************************************************************
007830 ÇcÇaÉNÉçÅ[ÉYèàóù                     SECTION.                    
007840 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
007850                                                                  
007860*--< ÉJÅ[É\Éã ÉNÉçÅ[ÉY >                                          
007870     EXEC SQL                                                     
007880        CLOSE  CUR1                                               
007890     END-EXEC.                                                    
007900                                                                  
007910 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇdÇwÇhÇs.                                      
007920     EXIT.                                                        
007930******************************************************************
007940*    ÉGÉâÅ[èàóù                                                  *
007950******************************************************************
007960 ÉGÉâÅ[îªíËèàóù                       SECTION.                    
007970 ÉGÉâÅ[îªíËèàóùÅ|ÇrÇsÇ`ÇqÇs.                                      
007980                                                                  
007990     INITIALIZE                           IF-CHOCO001.            
008000                                                                  
008010     EVALUATE  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh                                   
008020        WHEN  -10                                                 
008030*--< ÇnÇqÇ`ÇbÇkÇdê⁄ë±é∏îs >                                 
008040           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008050           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc  TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008060           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008070           MOVE  "CONNECT"            TO  ã§ÇPÅ|èàóùéØï           
008080           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008090           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008100           CALL  CLOCO001          USING  IF-CHOCO001             
008110                                                                  
008120        WHEN  -20                                                 
008130*--< ã∆ñ±ä«óùÉeÅ[ÉuÉãì«çûé∏îs >                             
008140           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008150           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc  TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008160           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008170           MOVE  "D70GYM"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008180           MOVE  "GYMKNRRC"           TO  ã§ÇPÅ|èàóùéØï           
008190           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008200           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008210           CALL  CLOCO001          USING  IF-CHOCO001             
008220                                                                  
008230        WHEN  -30                                                 
008240*--< åãçáÉeÅ[ÉuÉãì«çûé∏îs >                                 
008250           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008260           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008270           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008280           MOVE  "CURSOR "                    
008290                                      TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008300           MOVE  "OPEN"              TO  ã§ÇPÅ|èàóùéØï           
008310           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008320           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008330           CALL  CLOCO001          USING  IF-CHOCO001             
008340*                                                                 
008350        WHEN  -40                                                 
008360*--< É@ÉCÉãÉIÅ[ÉvÉìé∏îs >                                         
008370           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008380           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008390           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008400           MOVE  "SEHSED25"           TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008410           MOVE  "OPEN"               TO  ã§ÇPÅ|èàóùéØï           
008420           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008430           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008440           CALL  CLOCO001          USING  IF-CHOCO001             
008450*                                                                 
008460        WHEN  -50                                                 
008470*--< ÉJÅ[É\Éãèåèé∏îs >                                           
008480           MOVE  "1"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008490           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008500           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008510           MOVE  "CUR1"                TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008520           MOVE  "FETCH"              TO  ã§ÇPÅ|èàóùéØï           
008530           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008540           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008550           CALL  CLOCO001          USING  IF-CHOCO001             
008560*                                                                 
008570        WHEN  -60                                                 
008580*--< íäèoèàóùé∏îs1 >                                        
008590           MOVE  "2"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008600           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008610           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008620           MOVE  "D19MSY"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008630           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
008640           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008650           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008660           CALL  CLOCO001          USING  IF-CHOCO001             
008670                                                                  
008680        WHEN  -70                                                 
008690*--< íäèoèàóùé∏îs2 >                                        
008700           MOVE  "2"                  TO  ã§ÇPÅ|ÉCÉxÉìÉgéÌï       
008710           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§ÇPÅ|É\Å[ÉXÇhÇc        
008720           MOVE  "9"                  TO  ã§ÇPÅ|ïúãAÉRÅ[Éh        
008730           MOVE  "M01SAJ"             TO  ã§ÇPÅ|èàóùÉeÅ[ÉuÉãÇhÇc  
008740           MOVE  "SELECT"             TO  ã§ÇPÅ|èàóùéØï           
008750           MOVE  SQLCODE              TO  ã§ÇPÅ|ÉfÅ[É^ì‡óe        
008760           MOVE  SQLERRMC             TO  ã§ÇPÅ|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
008770           CALL  CLOCO001          USING  IF-CHOCO001             
008780           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO 

008790        WHEN  OTHER                                               
008800           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
008810     END-EVALUATE.                                                
008820                                                                  
008830     IF ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO  =  "Y"                              
008840                                                                  
008850        PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ                               
008860                                                                  
008870*--<    ÉvÉçÉOÉâÉÄàŸèÌèIóπÇÃÉäÉ^Å[ÉìÉRÅ[Éh >                      
008880        MOVE  íËêîÅ|àŸèÌèÛë‘          TO  PROGRAM-STATUS          
008890                                                                  
008900        EXIT  PROGRAM                                             
008910     END-IF.                                                      
008920                                                                  
008930 ÉGÉâÅ[èàóùÅ|ÇdÇwÇhÇs.                                            
008940     EXIT.                                                        
008950******************************************************************
008960*                  END OF PROGRAM                                *
008970******************************************************************
