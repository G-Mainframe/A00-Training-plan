000010******************************************************************
000020*         ＜海輝軟件(大連)＞                                     *
000030*      1. プログラム名    ：契約売掛債権明細移行                 *
000040*      2. プログラムID    ：COBIS490                             *
000050*      3. 処理概要        ：ＳＵＭＭＩＴファクタリングＤＢより 、*
000060*                           契約売掛債権明細テーブルを作成する。 *
000070*      4. 作成者          ：李大偉                               *
000080*      5. 作成日          ：2005.03.31                           *
000090******************************************************************
000100*                                                                 
000110******************************************************************
000120*    ＤＥＮＴＩＦＩＣＡＴＩＯＮ  ＤＩＶＩＳＩＯＮ                *
000130******************************************************************
000140 IDENTIFICATION                       DIVISION.                   
000150*                                                                 
000160 PROGRAM-ID.                          COBIS490.                   
000170******************************************************************
000180*    ＥＮＶＩＲＯＮＭＥＮＴ        ＤＩＶＩＳＩＯＮ              *
000190******************************************************************
000200 ENVIRONMENT                          DIVISION.                   
000210******************************************************************
000220*    ＤＡＴＡ                      ＤＩＶＩＳＩＯＮ              *
000230******************************************************************
000240 DATA                                 DIVISION.                   
000250******************************************************************
000260*  ＷＯＲＫＩＮＧ−ＳＴＯＲＡＧＥ  ＳＥＣＴＩＯＮ                *
000270******************************************************************
000280 WORKING-STORAGE                      SECTION.                    
000290*----------------------------------------------------------------*
000300*    ホスト変数定義エリア                                        *
000310*----------------------------------------------------------------*
000320     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +12.
           02  SQLFPN-FILENAME PIC X(12) VALUE "COBIS490.PCO".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(110) VALUE "select 新取引先コード   into :b1
      -    "  from IKOTBL001 where (IKOTBL001.取引先コード=:b2 and IKOTB
      -    "L001.目的ＣＤ='2')".

       01  SQ0003 GLOBAL.
           02  FILLER PIC X(100) VALUE "select 枝番   into :b1  from IKO
      -     "TBL001 where (IKOTBL001.取引先コード=:b2 and IKOTBL001.目的
      -    "ＣＤ='2')".

       01  SQ0004 GLOBAL.
           02  FILLER PIC X(100) VALUE "select 枝番   into :b1  from IKO
      -     "TBL001 where (IKOTBL001.取引先コード=:b2 and IKOTBL001.目的
      -    "ＣＤ='3')".

       01  SQ0005 GLOBAL.
           02  FILLER PIC X(159) VALUE "insert into D414USM_TBL(契約番号
      -     ",明細番号,取引先コード,契約先コード,額面金額,期日,利息期日,
      -     "日数,割引率,割引料,取立手数料等,取立手数料等消費税額,買取代
      -    "金額,社内".

           02  FILLER PIC X(160) VALUE "金利区分,社内金利,実質年率,粗利,
      -     "請求先コード,社内金利_一般,粗利_一般,期限前決済日,流動化先,
      -    "債権流動化先区分,更新年月日,更新時間,更新者,入力担当者コード
      -    ",登録年月".

           02  FILLER PIC X(160) VALUE "日,登録時間,登録担当者) values (
      -    ":b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14
      -    ",:b15,:b16,:b17,:b18,:b19,:b20,:b21,:b22,:b23,:b24,:b25,:b26
      -    ",:b27,:b".

           02  FILLER PIC X(13) VALUE "28,:b29,:b30)".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +288037.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +30.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 30 TIMES.


       01  SQ0001 GLOBAL.
           02  FILLER PIC X(160) VALUE "select LTRFCU.契約番号  ,LTRFCK.
      -    "ユーザーコード  ,LTRFCK.額面金額  ,LTRFCK.期日  ,LTRFCU.利息
      -    "期日  ,LTRFCU.期間日数  ,LTRFCU.割引率  ,LTRFCU.割引料  ,LTR
      -    "FCU.受取".

           02  FILLER PIC X(160) VALUE "手数料  ,LTRFCU.受取手数料消費税
      -    "等額  ,LTRFCU.買取金額  ,LTRFCK.社内金利  ,LTRFCK.粗利益  ,L
      -    "TRFCK.請求先コード  ,LTRFCK.社内金利  ,LTRFCK.粗利益  ,LTRFC
      -    "U.期限前".

           02  FILLER PIC X(77) VALUE "決裁日   from LTRFCK ,LTRFCU wher
      -    "e LTRFCU.契約番号=LTRFCK.契約番号           ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +190.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +194.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +397.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +249.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +82.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +273.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +17.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +11.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +11.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +11.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +165.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +110.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +334.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +188.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +100.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +366.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +211.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +100.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +397.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +234.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +492.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +516.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +369.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +691.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +384.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +6.
           02     FILLER PIC S9(4) COMP-5 VALUE +12.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +703.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +399.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +14.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +32.
           02     FILLER PIC S9(4) COMP-5 VALUE +723.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000330*                                                                 
000340 01  ＷＳ−実質年率                   PIC  9(10) VALUE ZERO.      
000350 01  ＷＳ−社内金利区分               PIC  X(01) VALUE ZERO.      
000360 01  ＷＳ−流動化先                   PIC  X(10) VALUE ZERO.      
000370 01  ＷＳ−債権流動化先区分           PIC  X(01) VALUE ZERO.      
000380*                                                                 
000390*--< ＯＲＡＣＬＥ共通変数 >                                       
000400     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL             END-EXEC.
000410*                                                                 
000420*--< ＯＲＡＣＬＥ ＳＱＬ実行情報 (SQLCA) >                        
000010*--＜ＳＱＬ共通変数＞
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000430     
      *    EXEC  SQL  INCLUDE  SQLCA.COB              END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000440*                                                                 
000450*--< SUMMITﾌｧｸﾀﾘﾝｸﾞ売掛債権 >                                     
000460     
      *    EXEC  SQL  INCLUDE  LTRFCU.CBL             END-EXEC.
000470*                                                                 
000480*--< SUMMITﾌｧｸﾀﾘﾝｸﾞ基本情報 >                                     
000010************************************************
000020* ﾌｧｸﾀﾘﾝｸﾞ（売掛債権）(LTRFCU)
000030************************************************
000040 01  ＬＴＲＦＣＵ−契約番号 PIC  X(009).
000050 01  ＬＴＲＦＣＵ−利息期日 PIC  X(007).
000060 01  ＬＴＲＦＣＵ−回収方法 PIC S9(001) COMP-3.
000070 01  ＬＴＲＦＣＵ−代理回収区分 PIC S9(001) COMP-3.
000080 01  ＬＴＲＦＣＵ−期間日数 PIC S9(004) COMP-3.
000090 01  ＬＴＲＦＣＵ−買取金額 PIC S9(013) COMP-3.
000100 01  ＬＴＲＦＣＵ−割引料 PIC S9(013) COMP-3.
000110 01  ＬＴＲＦＣＵ−割引率 PIC S9(003)V9(8) COMP-3.
000120 01  ＬＴＲＦＣＵ−受取手数料 PIC S9(013) COMP-3.
000130 01  ＬＴＲＦＣＵ−受取手数料消費税等額 PIC S9(013) COMP-3.
000140 01  ＬＴＲＦＣＵ−買戻予定日 PIC  X(007).
000150 01  ＬＴＲＦＣＵ−買取代金支払日 PIC  X(007).
000160 01  ＬＴＲＦＣＵ−債権表示 PIC  X(060).
000170 01  ＬＴＲＦＣＵ−期限前決裁日 PIC  X(007).
000180 01  ＬＴＲＦＣＵ−戻し利息額 PIC S9(013) COMP-3.
000190 01  ＬＴＲＦＣＵ−戻し利率 PIC S9(003)V9(8) COMP-3.
000200 01  ＬＴＲＦＣＵ−戻し日数 PIC S9(004) COMP-3.
000210 01  ＬＴＲＦＣＵ−戻し利息相殺区分 PIC S9(001) COMP-3.
000220 01  ＬＴＲＦＣＵ−返済手数料 PIC S9(013) COMP-3.
000230 01  ＬＴＲＦＣＵ−返済手数料消費税等額 PIC S9(013) COMP-3.
000240 01  ＬＴＲＦＣＵ−予備 PIC  X(040).
000490     
      *    EXEC  SQL  INCLUDE  LTRFCK.CBL             END-EXEC.
000500*                                                                 
000510*--< 契約売掛債権明細ＤＢ >                                       
000010************************************************
000020* ﾌｧｸﾀﾘﾝｸﾞ（基本情報）(LTRFCK)
000030************************************************
000040 01  ＬＴＲＦＣＫ−契約番号 PIC  X(009).
000050 01  ＬＴＲＦＣＫ−ユーザーコード PIC  X(008).
000060 01  ＬＴＲＦＣＫ−請求先コード PIC  X(008).
000070 01  ＬＴＲＦＣＫ−事業所コード PIC S9(004) COMP-3.
000080 01  ＬＴＲＦＣＫ−担当者コード PIC S9(004) COMP-3.
000090 01  ＬＴＲＦＣＫ−契約日 PIC  X(007).
000100 01  ＬＴＲＦＣＫ−実行日 PIC  X(007).
000110 01  ＬＴＲＦＣＫ−勘定処理コード PIC S9(002) COMP-3.
000120 01  ＬＴＲＦＣＫ−社内金利 PIC S9(003)V9(8) COMP-3.
000130 01  ＬＴＲＦＣＫ−月利複利率 PIC S9(003)V9(8) COMP-3.
000140 01  ＬＴＲＦＣＫ−粗利益 PIC S9(013) COMP-3.
000150 01  ＬＴＲＦＣＫ−額面金額 PIC S9(013) COMP-3.
000160 01  ＬＴＲＦＣＫ−業務区分 PIC S9(001) COMP-3.
000170 01  ＬＴＲＦＣＫ−期日 PIC  X(007).
000180 01  ＬＴＲＦＣＫ−銀行コード PIC  X(007).
000190 01  ＬＴＲＦＣＫ−口座番号 PIC  X(007).
000200 01  ＬＴＲＦＣＫ−預金種類 PIC S9(001) COMP-3.
000210 01  ＬＴＲＦＣＫ−案件発生区分 PIC  X(001).
000220 01  ＬＴＲＦＣＫ−稟議区分 PIC S9(001) COMP-3.
000230 01  ＬＴＲＦＣＫ−利率基数コード PIC S9(001) COMP-3.
000240 01  ＬＴＲＦＣＫ−利息端数処理コード PIC S9(001) COMP-3.
000250 01  ＬＴＲＦＣＫ−前取後取区分 PIC S9(001) COMP-3.
000260 01  ＬＴＲＦＣＫ−片端両端区分 PIC S9(001) COMP-3.
000270 01  ＬＴＲＦＣＫ−金利変動区分 PIC S9(001) COMP-3.
000280 01  ＬＴＲＦＣＫ−連動金利区分 PIC S9(002) COMP-3.
000290 01  ＬＴＲＦＣＫ−スプレッド PIC S9(003)V9(8) COMP-3.
000300 01  ＬＴＲＦＣＫ−休日対応区分 PIC S9(001) COMP-3.
000310 01  ＬＴＲＦＣＫ−原債務者コード PIC  X(008).
000320 01  ＬＴＲＦＣＫ−原債務者情報１ PIC  X(040).
000330 01  ＬＴＲＦＣＫ−原債務者情報２ PIC  X(040).
000340 01  ＬＴＲＦＣＫ−原債務者情報３ PIC  X(040).
000350 01  ＬＴＲＦＣＫ−承認ＮＯ PIC  X(006).
000360 01  ＬＴＲＦＣＫ−支払承認日 PIC  X(007).
000370 01  ＬＴＲＦＣＫ−支払承認情報−担当者コード PIC  X(004).
000380 01  ＬＴＲＦＣＫ−支払方法コード PIC S9(002) COMP-3.
000390 01  ＬＴＲＦＣＫ−期日管理実行日 PIC  X(007).
000400 01  ＬＴＲＦＣＫ−請求ＤＢ登録日 PIC  X(007).
000410 01  ＬＴＲＦＣＫ−予備 PIC  X(090).
000420 01  ＬＴＲＦＣＫ−共通情報 PIC  X(035).
000520     
      *    EXEC  SQL  INCLUDE  D414USM.CBL            END-EXEC.
000530*                                                                 
000540*--< 変換テーブル >                                               
      *****************************************************************
      *   契約売掛債権明細(D414USM_TBL)
      *****************************************************************
       01  契約売掛債権明細.
           03  Ｄ４１４−契約番号    PIC  X(010).
           03  Ｄ４１４−明細番号    PIC S9(003) PACKED-DECIMAL.
           03  Ｄ４１４−取引先コード
                                     PIC  X(009).
           03  Ｄ４１４−契約先コード
                                     PIC  X(005).
           03  Ｄ４１４−額面金額    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ４１４−期日        PIC  X(008).
           03  Ｄ４１４−利息期日    PIC  X(008).
           03  Ｄ４１４−日数        PIC S9(003) PACKED-DECIMAL.
           03  Ｄ４１４−割引率      PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ４１４−割引料      PIC S9(013) PACKED-DECIMAL.
           03  Ｄ４１４−取立手数料等
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ４１４−取立手数料等消費税額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ４１４−買取代金額  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ４１４−社内金利区分
                                     PIC  X(001).
           03  Ｄ４１４−社内金利    PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ４１４−実質年率    PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ４１４−粗利        PIC S9(013) PACKED-DECIMAL.
           03  Ｄ４１４−請求先コード
                                     PIC  X(005).
           03  Ｄ４１４−社内金利−一般
                                     PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ４１４−粗利−一般  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ４１４−期限前決済日
                                     PIC  X(008).
           03  Ｄ４１４−流動化先    PIC  X(010).
           03  Ｄ４１４−債権流動化先区分
                                     PIC  X(001).
           03  Ｄ４１４−更新年月日  PIC  X(008).
           03  Ｄ４１４−更新時間    PIC  X(008).
           03  Ｄ４１４−更新者      PIC  X(008).
           03  Ｄ４１４−入力担当者コード
                                     PIC  X(008).
           03  Ｄ４１４−登録年月日  PIC  X(008).
           03  Ｄ４１４−登録時間    PIC  X(008).
           03  Ｄ４１４−登録担当者  PIC  X(008).
000550     
      *    EXEC  SQL  INCLUDE  IKOTBL001.CBL          END-EXEC.
000560*                                                                 
000010************************************************
000020* 変換テーブル(IKOTBL001)
000030************************************************
000040 01  ＩＫＯ００１−取引先コード PIC  X(008).
000050 01  ＩＫＯ００１−目的ＣＤ PIC  X(001).
000060 01  ＩＫＯ００１−新取引先コード PIC  X(007).
000070 01  ＩＫＯ００１−枝番 PIC  X(003).
000080 01  ＩＫＯ００１−与信括りコード PIC  X(007).
000090 01  ＩＫＯ００１−名寄せコード PIC  X(008).
000100 01  ＩＫＯ００１−ユーザコード PIC  X(008).
000110 01  ＩＫＯ００１−識別ＣＤ PIC  X(001).
000570     
      *    EXEC  SQL  END      DECLARE      SECTION   END-EXEC.
000580*----------------------------------------------------------------*
000590*    作業領域定義                                                *
000600*----------------------------------------------------------------*
000610 01  ＷＯＲＫ−エリア.                                            
000620*                                                                 
000630*--< エラーコード >                                               
000640     03  Ｗ−エラーコード             PIC S9(02).                 
000650*                                                                 
000660*--< 件数エリア >                                                 
000670     03  件数エリア.                                              
000680        05  Ｗ−入力−件数            PIC  9(09).                 
000690        05  Ｗ−出力−件数            PIC  9(09).                 
000700*                                                                 
000710*--< フラグアリア >                                               
000720     03  フラグ−エリア.                                          
000730        05  Ｗ−終了−フラグ          PIC  X(01).                 
000740        05  Ｗ−異常終了−フラグ      PIC  X(01).                 
000750*                                                                 
000850*----------------------------------------------------------------*
000860*   処理時間定義                                                 *
000870*----------------------------------------------------------------*
000880*--< 共通情報 >                                                   
000890 01  Ｗ−共通情報.                                                
000900     03  Ｗ−システム日付.                                        
000910         05  Ｗ−世紀                 PIC  X(02) VALUE  "20".     
000920         05  Ｗ−年月日               PIC  X(06).                 
000930     03  Ｗ−システム時刻             PIC  X(08).                 
000940     03  Ｗ−担当者                   PIC  X(08) VALUE "IKPO    ".
000950*----------------------------------------------------------------*
000960*    サブルーチン名                                              *
000970*----------------------------------------------------------------*
000980 01  CALL-AREA.                                                   
000990*--< 共通ログサブルーチン >                                       
001000     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001010     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001020*----------------------------------------------------------------*
001030*    ＣＯＰＹ領域                                                *
001040*----------------------------------------------------------------*
001050*--< 共通ログ用パラメータ >                                       
001060 01  IF-CHOCO001.                                                 
001070     COPY  CHOCO001  REPLACING  ==()==  BY  ==共１−==.           
001080*                                                                 
001090*----------------------------------------------------------------*
001100*    ＩＮＩファイル読込サブルーチン用パラメタ領域                *
001110*----------------------------------------------------------------*
001120 01  PARA-AREA.                                                   
001130     COPY CPBCO001.                                               
001140******************************************************************
001150*    定数用データ定義エリア                                      *
001160******************************************************************
001170 CONSTANT                             SECTION.                    
001180 01  定数領域.                                                    
001190     03  定数−プログラムＩＤ         PIC  X(08) VALUE "COBIS490".
001200     03  定数−プログラム名           PIC  X(80) VALUE            
001210                                       "契約売掛債権明細移行".    
001220     03  定数−ＳＱＬＯＫ             PIC  9(04) VALUE  0000.     
001230     03  定数−ＳＱＬＥＮＤ           PIC  9(04) VALUE  0100.     
001240     03  定数−正常状態               PIC  9(04) VALUE  ZERO.     
001250     03  定数−異常状態               PIC  9(04) VALUE  0009.     
001260******************************************************************
001270*    ＰＲＯＣＥＤＵＲＥ            ＤＩＶＩＳＩＯＮ              *
001280******************************************************************
001290 PROCEDURE                            DIVISION.                   
001300*                                                                 
001310     PERFORM  初期処理.                                           
001320*                                                                 
001330     PERFORM  主処理  UNTIL  Ｗ−終了−フラグ  =  "Y".            
001340*                                                                 
001350     PERFORM  終了処理.                                           
001360*                                                                 
001370     STOP RUN.                                                    
001380*                                                                 
001390******************************************************************
001400*    初期処理                                                    *
001410******************************************************************
001420 初期処理                             SECTION.                    
001430 初期処理−ＳＴＡＲＴ.                                            
001440*                                                                 
001450*----------------------------------------------------------------*
001460*     開始メッセージ出力                                         *
001470*----------------------------------------------------------------*
001480     INITIALIZE                       IF-CHOCO001.                
001490     MOVE  "3"                        TO  共１−イベント種別.     
001500     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
001510     MOVE  "0"                        TO  共１−復帰コード.       
001520     MOVE  "START"                    TO  共１−処理識別.         
001530     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
001540     CALL  CLOCO001                USING  IF-CHOCO001.            
001550*                                                                 
001560*----------------------------------------------------------------*
001570*    作業領域の初期値設定                                        *
001580*----------------------------------------------------------------*
001590     MOVE  SPACE                      TO  ＷＯＲＫ−エリア.       
001600     INITIALIZE                           ＷＯＲＫ−エリア.       
001610*                                                                 
001620*--< ＣＰＵ日付を取得 >                                           
001630     ACCEPT  Ｗ−年月日               FROM  DATE.                 
001640*                                                                 
001650*--< ＣＰＵ時刻を取得 >                                           
001660     ACCEPT  Ｗ−システム時刻         FROM  TIME.                 
001670*----------------------------------------------------------------*
001680*    ＯＲＡＣＬＥ接続                                            *
001690*----------------------------------------------------------------*
001700     PERFORM  ＯＲＡＣＬＥ接続.                                   
001710*----------------------------------------------------------------*
001720*    結合テーブルカーソル定義                                    *
001730*----------------------------------------------------------------*
001740     PERFORM   結合テーブルカーソル定義                           
001750*----------------------------------------------------------------*
001760*    結合テーブルカーソル読込(１件目)                            *
001770*----------------------------------------------------------------*
001780     PERFORM  結合テーブルカーソル読込.                           
001790*----------------------------------------------------------------*
001800  初期処理−ＥＸＩＴ.                                             
001810     EXIT.                                                        
001820******************************************************************
001830*    ＯＲＡＣＬＥ接続                                            *
001840******************************************************************
001850 ＯＲＡＣＬＥ接続                     SECTION.                    
001860 ＯＲＡＣＬＥ接続−ＳＴＡＲＴ.                                    
001870*                                                                 
001880*--< ＩＮＩファイル読込サブルーチン呼び出し >                     
001890     CALL  COBCO001                USING  PARA-AREA.              
001900*                                                                 
001910     MOVE  PARA-DBSTRING              TO  DB-STRING.              
001920     MOVE  PARA-USERNAME              TO  USERNAME.               
001930     MOVE  PARA-PASSWORD              TO  PASSWD.                 
001940*                                                                 
001950*----------------------------------------------------------------*
001960*    開始接続                                                    *
001970*----------------------------------------------------------------*
001980     IF  DB-STRING  =  SPACE                                      
001990        
      *       EXEC  SQL                                                 
002000*          CONNECT  :USERNAME  IDENTIFIED  BY  :PASSWD            
002010*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002020     ELSE                                                         
002030        
      *       EXEC  SQL                                                 
002040*          CONNECT  :USERNAME  IDENTIFIED  BY  :PASSWD            
002050*            USING  :DB-STRING                                    
002060*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002070     END-IF.                                                      
002080*                                                                 
002090*----------------------------------------------------------------*
002100*    接続状態判定                                                *
002110*----------------------------------------------------------------*
002120     EVALUATE  SQLCODE                                            
002130        WHEN  定数−ＳＱＬＯＫ                                    
002140*--<       接続正常 >                                             
002150           CONTINUE                                               
002160        WHEN  OTHER                                               
002170*--<       接続エラー >                                           
002180           MOVE     -1                TO  Ｗ−エラーコード        
002190           PERFORM  エラー処理                                    
002200     END-EVALUATE.                                                
002210*                                                                 
002220 ＯＲＡＣＬＥ接続−ＥＸＩＴ.                                      
002230     EXIT.                                                        
002240******************************************************************
002250*    結合テーブルカーソル定義                                    *
002260******************************************************************
002270*                                                                 
002280 結合テーブルカーソル定義             SECTION.                    
002290 結合テーブルカーソル定義−ＳＴＡＲＴ.                            
002300*--< 結合テーブルカーソル定義  >                                  
002310     
      *    EXEC SQL                                                     
002320*       DECLARE CUR1 CURSOR FOR                                   
002330*        SELECT  LTRFCU.契約番号                                  
002340*               ,LTRFCK.ユーザーコード                            
002350* 	      ,LTRFCK.額面金額                                  
002360* 	      ,LTRFCK.期日                                      
002370* 	      ,LTRFCU.利息期日                                  
002380* 	      ,LTRFCU.期間日数                                  
002390* 	      ,LTRFCU.割引率                                    
002400* 	      ,LTRFCU.割引料                                    
002410* 	      ,LTRFCU.受取手数料                                
002420* 	      ,LTRFCU.受取手数料消費税等額                      
002430* 	      ,LTRFCU.買取金額                                  
002440* 	      ,LTRFCK.社内金利                                  
002450* 	      ,LTRFCK.粗利益                                    
002460*               ,LTRFCK.請求先コード                              
002470* 	      ,LTRFCK.社内金利                                  
002480* 	      ,LTRFCK.粗利益                                    
002490* 	      ,LTRFCU.期限前決裁日                              
002500*          FROM  LTRFCK                                           
002510*               ,LTRFCU                                           
002520*         WHERE  LTRFCU.契約番号 = LTRFCK.契約番号                
002530*    END-EXEC.
002540*                                                                 
002550*----------------------------------------------------------------*
002560*    カーソルオープン処理                                        *
002570*----------------------------------------------------------------*
002580     
      *    EXEC  SQL                                                    
002590*       OPEN  CUR1                                                
002600*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
002610*----------------------------------------------------------------*
002620*    カーソルオープン確認                                        *
002630*----------------------------------------------------------------*
002640     EVALUATE  SQLCODE                                            
002650        WHEN  定数−ＳＱＬＯＫ                                    
002660*--<       正常 >                                                 
002670           CONTINUE                                               
002680        WHEN  OTHER                                               
002690*--<       カーソルオープンエラー >                               
002700           MOVE     -2                TO  Ｗ−エラーコード        
002710           PERFORM  エラー処理                                    
002720     END-EVALUATE.                                                
002730*                                                                 
002740 結合テーブルカーソル定義−ＥＸＩＴ.                              
002750     EXIT.                                                        
002760******************************************************************
002770*    結合テーブルカーソル読込                                    *
002780******************************************************************
002790 結合テーブルカーソル読込             SECTION.                    
002800 結合テーブルカーソル読込−ＳＴＡＲＴ.                            
002810*                                                                 
002820     
      *    EXEC  SQL                                                    
002830*       FETCH  CUR1                                               
002840*          INTO  :ＬＴＲＦＣＵ−契約番号                          
002850*               ,:ＬＴＲＦＣＫ−ユーザーコード                    
002860*               ,:ＬＴＲＦＣＫ−額面金額                          
002870* 	      ,:ＬＴＲＦＣＫ−期日                              
002880* 	      ,:ＬＴＲＦＣＵ−利息期日                          
002890* 	      ,:ＬＴＲＦＣＵ−期間日数                          
002900* 	      ,:ＬＴＲＦＣＵ−割引率                            
002910* 	      ,:ＬＴＲＦＣＵ−割引料                            
002920* 	      ,:ＬＴＲＦＣＵ−受取手数料                        
002930* 	      ,:ＬＴＲＦＣＵ−受取手数料消費税等額              
002940* 	      ,:ＬＴＲＦＣＵ−買取金額                          
002950* 	      ,:ＬＴＲＦＣＫ−社内金利                          
002960* 	      ,:ＬＴＲＦＣＫ−粗利益                            
002970*               ,:ＬＴＲＦＣＫ−請求先コード                      
002980*               ,:ＬＴＲＦＣＫ−社内金利                          
002990* 	      ,:ＬＴＲＦＣＫ−粗利益                            
003000* 	      ,:ＬＴＲＦＣＵ−期限前決裁日   		        
003010*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 82 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ＬＴＲＦＣＵ−契約番号
               SQL-SQHSTV(1)
           MOVE 9 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ＬＴＲＦＣＫ−ユーザーコード
               SQL-SQHSTV(2)
           MOVE 8 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ＬＴＲＦＣＫ−額面金額
               SQL-SQHSTV(3)
           MOVE 7 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ＬＴＲＦＣＫ−期日
               SQL-SQHSTV(4)
           MOVE 7 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ＬＴＲＦＣＵ−利息期日
               SQL-SQHSTV(5)
           MOVE 7 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               ＬＴＲＦＣＵ−期間日数
               SQL-SQHSTV(6)
           MOVE 3 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               ＬＴＲＦＣＵ−割引率
               SQL-SQHSTV(7)
           MOVE 6 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               ＬＴＲＦＣＵ−割引料
               SQL-SQHSTV(8)
           MOVE 7 TO SQL-SQHSTL(8)
           MOVE 0 TO SQL-SQHSTS(8)
           MOVE 0 TO SQL-SQINDV(8)
           MOVE 0 TO SQL-SQINDS(8)
           MOVE 0 TO SQL-SQHARM(8)
           CALL "SQLADR" USING
               ＬＴＲＦＣＵ−受取手数料
               SQL-SQHSTV(9)
           MOVE 7 TO SQL-SQHSTL(9)
           MOVE 0 TO SQL-SQHSTS(9)
           MOVE 0 TO SQL-SQINDV(9)
           MOVE 0 TO SQL-SQINDS(9)
           MOVE 0 TO SQL-SQHARM(9)
           CALL "SQLADR" USING
               ＬＴＲＦＣＵ−受取手数料消費税等額
               SQL-SQHSTV(10)
           MOVE 7 TO SQL-SQHSTL(10)
           MOVE 0 TO SQL-SQHSTS(10)
           MOVE 0 TO SQL-SQINDV(10)
           MOVE 0 TO SQL-SQINDS(10)
           MOVE 0 TO SQL-SQHARM(10)
           CALL "SQLADR" USING
               ＬＴＲＦＣＵ−買取金額
               SQL-SQHSTV(11)
           MOVE 7 TO SQL-SQHSTL(11)
           MOVE 0 TO SQL-SQHSTS(11)
           MOVE 0 TO SQL-SQINDV(11)
           MOVE 0 TO SQL-SQINDS(11)
           MOVE 0 TO SQL-SQHARM(11)
           CALL "SQLADR" USING
               ＬＴＲＦＣＫ−社内金利
               SQL-SQHSTV(12)
           MOVE 6 TO SQL-SQHSTL(12)
           MOVE 0 TO SQL-SQHSTS(12)
           MOVE 0 TO SQL-SQINDV(12)
           MOVE 0 TO SQL-SQINDS(12)
           MOVE 0 TO SQL-SQHARM(12)
           CALL "SQLADR" USING
               ＬＴＲＦＣＫ−粗利益
               SQL-SQHSTV(13)
           MOVE 7 TO SQL-SQHSTL(13)
           MOVE 0 TO SQL-SQHSTS(13)
           MOVE 0 TO SQL-SQINDV(13)
           MOVE 0 TO SQL-SQINDS(13)
           MOVE 0 TO SQL-SQHARM(13)
           CALL "SQLADR" USING
               ＬＴＲＦＣＫ−請求先コード
               SQL-SQHSTV(14)
           MOVE 8 TO SQL-SQHSTL(14)
           MOVE 0 TO SQL-SQHSTS(14)
           MOVE 0 TO SQL-SQINDV(14)
           MOVE 0 TO SQL-SQINDS(14)
           MOVE 0 TO SQL-SQHARM(14)
           CALL "SQLADR" USING
               ＬＴＲＦＣＫ−社内金利
               SQL-SQHSTV(15)
           MOVE 6 TO SQL-SQHSTL(15)
           MOVE 0 TO SQL-SQHSTS(15)
           MOVE 0 TO SQL-SQINDV(15)
           MOVE 0 TO SQL-SQINDS(15)
           MOVE 0 TO SQL-SQHARM(15)
           CALL "SQLADR" USING
               ＬＴＲＦＣＫ−粗利益
               SQL-SQHSTV(16)
           MOVE 7 TO SQL-SQHSTL(16)
           MOVE 0 TO SQL-SQHSTS(16)
           MOVE 0 TO SQL-SQINDV(16)
           MOVE 0 TO SQL-SQINDS(16)
           MOVE 0 TO SQL-SQHARM(16)
           CALL "SQLADR" USING
               ＬＴＲＦＣＵ−期限前決裁日
               SQL-SQHSTV(17)
           MOVE 7 TO SQL-SQHSTL(17)
           MOVE 0 TO SQL-SQHSTS(17)
           MOVE 0 TO SQL-SQINDV(17)
           MOVE 0 TO SQL-SQINDS(17)
           MOVE 0 TO SQL-SQHARM(17)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
003020*----------------------------------------------------------------*
003030*    結合テーブルカーソル読込エラー                              *
003040*----------------------------------------------------------------*
003050     EVALUATE   SQLCODE                                           
003060        WHEN   定数−ＳＱＬＯＫ                                   
003070*--<       正常 >                                                 
003080           COMPUTE  Ｗ−入力−件数    =  Ｗ−入力−件数  +  1     
003090        WHEN   定数−ＳＱＬＥＮＤ                                 
003100*--<       読込終了 >                                             
003110           MOVE  "Y"                  TO  Ｗ−終了−フラグ        
003120        WHEN   OTHER                                              
003130*--<       読込エラー >                                           
003140           MOVE     -3                TO  Ｗ−エラーコード        
003150           PERFORM  エラー処理                                    
003160     END-EVALUATE.                                                
003170*                                                                 
003180 結合テーブルカーソル読込−ＥＸＩＴ.                              
003190     EXIT.                                                        
003200*                                                                 
003210******************************************************************
003220*    主処理                                                      *
003230******************************************************************
003240 主処理                               SECTION.                    
003250 主処理−ＳＴＡＲＴ.                                              
003260*----------------------------------------------------------------*
003270*--<  編集出力処理 >                                             *
003280*---------------------------------------------------------------- 
003290        PERFORM  編集処理                                         
003300        PERFORM  出力処理                                         
003310*                                                                 
003320*--< 結合テーブルカーソル読込（２件目以降） >                     
003330     PERFORM  結合テーブルカーソル読込.                           
003340*                                                                 
003350 主処理−ＥＸＩＴ.                                                
003360     EXIT.                                                        
003370******************************************************************
003380*    変換処理１                                                  *
003390******************************************************************
003400 変換処理１                           SECTION.                    
003410 変換処理１−ＳＴＡＲＴ.                                          
003420*                                                                 
003430     
      *    EXEC  SQL                                                    
003440*          SELECT  新取引先コード                                 
003450*            INTO :ＩＫＯ００１−新取引先コード                   
003460*            FROM  IKOTBL001                                      
003470*           WHERE  IKOTBL001.取引先コード                         
003480*                                     =                           
003490*                                    :ＬＴＲＦＣＫ−ユーザーコード
003500*             AND  IKOTBL001.目的ＣＤ = '2'                       
003510*    END-EXEC.
           CALL "SQLADR" USING SQ0002 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 165 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ＩＫＯ００１−新取引先コード
               SQL-SQHSTV(1)
           MOVE 7 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ＬＴＲＦＣＫ−ユーザーコード
               SQL-SQHSTV(2)
           MOVE 8 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
003520*                                                                 
003530*----------------------------------------------------------------*
003540*    変換処理１確認                                              *
003550*----------------------------------------------------------------*
003560     EVALUATE  SQLCODE                                            
003570        WHEN  定数−ＳＱＬＯＫ                                    
003580*--<       正常 >                                                 
003590           CONTINUE                                               
003600        WHEN  OTHER                                               
003610*--<       変換処理１エラー >                                     
003620           MOVE     SPACE             TO                          
003630                                      ＩＫＯ００１−新取引先コード
003640     END-EVALUATE.                                                
003650*                                                                 
003660  変換処理１−ＥＸＩＴ.                                           
003670     EXIT.                                                        
003680*                                                                 
003690******************************************************************
003700*    変換処理２                                                  *
003710******************************************************************
003720 変換処理２                           SECTION.                    
003730 変換処理２−ＳＴＡＲＴ.                                          
003740*                                                                 
003750     
      *    EXEC  SQL                                                    
003760*          SELECT 枝番                                            
003770*            INTO :ＩＫＯ００１−枝番                             
003780*            FROM  IKOTBL001                                      
003790*           WHERE  IKOTBL001.取引先コード                         
003800*                                     =                           
003810*                                    :ＬＴＲＦＣＫ−ユーザーコード
003820*             AND  IKOTBL001.目的ＣＤ = '2'                       
003830*    END-EXEC.
           CALL "SQLADR" USING SQ0003 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 188 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ＩＫＯ００１−枝番
               SQL-SQHSTV(1)
           MOVE 3 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ＬＴＲＦＣＫ−ユーザーコード
               SQL-SQHSTV(2)
           MOVE 8 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
003840*                                                                 
003850*----------------------------------------------------------------*
003860*    変換処理２確認                                              *
003870*----------------------------------------------------------------*
003880     EVALUATE  SQLCODE                                            
003890        WHEN  定数−ＳＱＬＯＫ                                    
003900*--<       正常 >                                                 
003910           CONTINUE                                               
003920        WHEN  OTHER                                               
003930*--<       変換処理２エラー >                                     
003940           MOVE     SPACE             TO  ＩＫＯ００１−枝番      
003950     END-EVALUATE.                                                
003960*                                                                 
003970 変換処理２−ＥＸＩＴ.                                            
003980     EXIT.                                                        
003990*                                                                 
004000******************************************************************
004010*    変換処理３                                                  *
004020******************************************************************
004030 変換処理３                           SECTION.                    
004040 変換処理３−ＳＴＡＲＴ.                                          
004050*                                                                 
004060     
      *    EXEC  SQL                                                    
004070*          SELECT  枝番                                           
004080*            INTO :ＩＫＯ００１−枝番                             
004090*            FROM  IKOTBL001                                      
004100*           WHERE  IKOTBL001.取引先コード                         
004110*                                     =                           
004120*                                      :ＬＴＲＦＣＫ−請求先コード
004130*             AND  IKOTBL001.目的ＣＤ = '3'                       
004140*    END-EXEC.
           CALL "SQLADR" USING SQ0004 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 211 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ＩＫＯ００１−枝番
               SQL-SQHSTV(1)
           MOVE 3 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ＬＴＲＦＣＫ−請求先コード
               SQL-SQHSTV(2)
           MOVE 8 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004150*                                                                 
004160*----------------------------------------------------------------*
004170*    変換処理３確認                                              *
004180*----------------------------------------------------------------*
004190     EVALUATE  SQLCODE                                            
004200        WHEN  定数−ＳＱＬＯＫ                                    
004210*--<       正常 >                                                 
004220           CONTINUE                                               
004230        WHEN  OTHER                                               
004240*--<       変換処理３エラー >                                     
004250           MOVE     SPACE             TO  ＩＫＯ００１−枝番      
004260     END-EVALUATE.                                                
004270 変換処理３−ＥＸＩＴ.                                            
004280      EXIT.                                                       
004290*                                                                 
004300******************************************************************
004310*     編集処理                                                   *
004320******************************************************************
004330 編集処理                             SECTION.                    
004340 編集処理−ＳＴＡＲＴ.                                            
004350*                                                                 
004360*----------------------------------------------------------------*
004370*       初期化処理                                               *
004380*----------------------------------------------------------------*
004390        MOVE  SPACE                   TO  契約売掛債権明細.       
004400        INITIALIZE                        契約売掛債権明細.       
004410*                                                                 
004420*----------------------------------------------------------------*
004430*       項目編集処理                                             *
004440*----------------------------------------------------------------*
004450*--<    No.01 >                                                   
004460        MOVE  ＬＴＲＦＣＵ−契約番号  TO  Ｄ４１４−契約番号.     
004470*--<    No.02 >                                                   
004480        MOVE  Ｗ−出力−件数          TO  Ｄ４１４−明細番号.     
004490*--<    No.03 >                                                   
004500        PERFORM 変換処理１.                                       
004510        MOVE   ＩＫＯ００１−新取引先コード                       
004520                                      TO  Ｄ４１４−取引先コード. 
004530*--<    No.04 >                                                   
004540        PERFORM 変換処理２.                                       
004550        MOVE  ＩＫＯ００１−枝番      TO  Ｄ４１４−契約先コード. 
004560*--<    No.05 >                                                   
004570	      MOVE  ＬＴＲＦＣＫ−額面金額  TO  Ｄ４１４−額面金額.     
004580*--<    No.06 >		                                        
004590        MOVE  ＬＴＲＦＣＫ−期日      TO  Ｄ４１４−期日.         
004600*--<    No.07 >		                                        
004610	      MOVE  ＬＴＲＦＣＵ−利息期日  TO  Ｄ４１４−利息期日.     
004620*--<    No.08 >		                                        
004630	      MOVE  ＬＴＲＦＣＵ−期間日数  TO  Ｄ４１４−日数.         
004640*--<    No.09 >	                                                
004650	      MOVE  ＬＴＲＦＣＵ−割引率    TO  Ｄ４１４−割引率.       
004660*--<    No.10 >		                                        
004670	      MOVE  ＬＴＲＦＣＵ−割引料    TO  Ｄ４１４−割引料.       
004680*--<    No.11 >		                                        
004690	      MOVE  ＬＴＲＦＣＵ−受取手数料                            
004700                                      TO  Ｄ４１４−取立手数料等. 
004710*--<    No.12 >	       	                                        
004720	      MOVE  ＬＴＲＦＣＵ−受取手数料消費税等額                  
004730                                      TO                          
004740                                  Ｄ４１４−取立手数料等消費税額. 
004750*--<    No.13 >		                                        
004760	      MOVE  ＬＴＲＦＣＵ−買取金額  TO  Ｄ４１４−買取代金額.   
004770*--<    No.14 >		                                        
004780	      MOVE  ＷＳ−社内金利区分      TO  Ｄ４１４−社内金利区分. 
004790*--<    No.15 >		                                        
004800	      MOVE  ＬＴＲＦＣＫ−社内金利  TO  Ｄ４１４−社内金利.     
004810*--<    No.16 >	                                                
004820	      MOVE  ＷＳ−実質年率          TO  Ｄ４１４−実質年率.     
004830*--<    No.17 >		                                        
004840	      MOVE  ＬＴＲＦＣＫ−粗利益    TO  Ｄ４１４−粗利.         
004850*--<    No.18 >                                                   
004860        PERFORM 変換処理３.                                       
004870	      MOVE  ＩＫＯ００１−枝番      TO  Ｄ４１４−請求先コード. 
004880*--<    No.19 >		                                        
004890        MOVE  ＬＴＲＦＣＫ−社内金利  TO                          
004900                                        Ｄ４１４−社内金利−一般. 
004910*--<    No.20 >		                                        
004920	      MOVE  ＬＴＲＦＣＫ−粗利益    TO  Ｄ４１４−粗利−一般.   
004930*--<    No.21 >		                                        
004940	      MOVE  ＬＴＲＦＣＵ−期限前決裁日                          
004950                                      TO  Ｄ４１４−期限前決済日. 
004960*--<    No.22 >		                                        
004970	      MOVE  ＷＳ−流動化先          TO  Ｄ４１４−流動化先.     
004980*--<    No.23 >		                                        
004990	      MOVE  ＷＳ−債権流動化先区分  TO                          
005000                                      Ｄ４１４−債権流動化先区分. 
005010*--<    No.24 >	                                                
005020	      MOVE   Ｗ−システム日付       TO  Ｄ４１４−更新年月日.   
005030*--<    No.25 >	       	                                        
005040	      MOVE   Ｗ−システム時刻       TO  Ｄ４１４−更新時間.     
005050*--<    No.26 >	                                                
005060	      MOVE   Ｗ−担当者             TO  Ｄ４１４−更新者.       
005070*--<    No.27 >	 	                                        
005080	      MOVE   Ｗ−担当者             TO                          
005090                                      Ｄ４１４−入力担当者コード. 
005100*--<    No.28 >		                                        
005110	      MOVE   Ｗ−システム日付       TO  Ｄ４１４−登録年月日.   
005120*--<    No.29 >		                                        
005130	      MOVE   Ｗ−システム時刻       TO  Ｄ４１４−登録時間.     
005140*--<    No.30 >		                                        
005150	      MOVE   Ｗ−担当者             TO  Ｄ４１４−登録担当者.   
005160*                                                                 
005190 編集出力処理−ＥＸＩＴ.                                          
005200     EXIT.                                                        
005210******************************************************************
005220*    出力処理                                                    *
005230******************************************************************
005240 出力処理                             SECTION.                    
005250 出力処理−ＳＴＡＲＴ.                                            
005260*                                                                 
005270       
      *      EXEC  SQL                                                  
005280*       INSERT  INTO  D414USM_TBL                                 
005290*          ( 契約番号                                             
005300*           ,明細番号                                             
005310*           ,取引先コード                                         
005320*           ,契約先コード                                         
005330*           ,額面金額                                             
005340*           ,期日                                                 
005350*           ,利息期日                                             
005360*           ,日数                                                 
005370*           ,割引率                                               
005380*           ,割引料                                               
005390*           ,取立手数料等                                         
005400* 	  ,取立手数料等消費税額                                 
005410* 	  ,買取代金額                                           
005420* 	  ,社内金利区分                                         
005430* 	  ,社内金利                                             
005440* 	  ,実質年率                                             
005450* 	  ,粗利                                                 
005460* 	  ,請求先コード                                         
005470* 	  ,社内金利_一般                                        
005480* 	  ,粗利_一般                                            
005490* 	  ,期限前決済日                                         
005500* 	  ,流動化先                                             
005510* 	  ,債権流動化先区分                                     
005520*           ,更新年月日                                           
005530*           ,更新時間                                             
005540*           ,更新者                                               
005550*           ,入力担当者コード                                     
005560*           ,登録年月日                                           
005570*           ,登録時間                                             
005580*           ,登録担当者)                                          
005590*      VALUES                                                     
005600*          ( :Ｄ４１４−契約番号                                  
005610*           ,:Ｄ４１４−明細番号                                  
005620*           ,:Ｄ４１４−取引先コード                              
005630*           ,:Ｄ４１４−契約先コード                              
005640*           ,:Ｄ４１４−額面金額                                  
005650* 	  ,:Ｄ４１４−期日                                      
005660* 	  ,:Ｄ４１４−利息期日                                  
005670* 	  ,:Ｄ４１４−日数                                      
005680* 	  ,:Ｄ４１４−割引率                                    
005690* 	  ,:Ｄ４１４−割引料                                    
005700* 	  ,:Ｄ４１４−取立手数料等                              
005710* 	  ,:Ｄ４１４−取立手数料等消費税額                      
005720* 	  ,:Ｄ４１４−買取代金額                                
005730* 	  ,:Ｄ４１４−社内金利区分                              
005740* 	  ,:Ｄ４１４−社内金利                                  
005750* 	  ,:Ｄ４１４−実質年率                                  
005760* 	  ,:Ｄ４１４−粗利                                      
005770* 	  ,:Ｄ４１４−請求先コード                              
005780* 	  ,:Ｄ４１４−社内金利−一般                            
005790* 	  ,:Ｄ４１４−粗利−一般                                
005800* 	  ,:Ｄ４１４−期限前決済日                              
005810* 	  ,:Ｄ４１４−流動化先                                  
005820* 	  ,:Ｄ４１４−債権流動化先区分                          
005830* 	  ,:Ｄ４１４−更新年月日                                
005840* 	  ,:Ｄ４１４−更新時間                                  
005850* 	  ,:Ｄ４１４−更新者                                    
005860* 	  ,:Ｄ４１４−入力担当者コード                          
005870* 	  ,:Ｄ４１４−登録年月日                                
005880* 	  ,:Ｄ４１４−登録時間                                  
005890*           ,:Ｄ４１４−登録担当者)                               
005900*    END-EXEC.
             CALL "SQLADR" USING SQ0005 SQL-STMT
             MOVE 1 TO SQL-ITERS
             MOVE 234 TO SQL-OFFSET
             MOVE 0 TO SQL-OCCURS
             CALL "SQLADR" USING
                 SQLCUD
                 SQL-CUD
             CALL "SQLADR" USING
                 SQLCA
                 SQL-SQLEST
             MOVE 256 TO SQL-SQLETY
             CALL "SQLADR" USING
                 Ｄ４１４−契約番号 IN
                 契約売掛債権明細
                 SQL-SQHSTV(1)
             MOVE 10 TO SQL-SQHSTL(1)
             MOVE 0 TO SQL-SQHSTS(1)
             MOVE 0 TO SQL-SQINDV(1)
             MOVE 0 TO SQL-SQINDS(1)
             MOVE 0 TO SQL-SQHARM(1)
             CALL "SQLADR" USING
                 Ｄ４１４−明細番号 IN
                 契約売掛債権明細
                 SQL-SQHSTV(2)
             MOVE 2 TO SQL-SQHSTL(2)
             MOVE 0 TO SQL-SQHSTS(2)
             MOVE 0 TO SQL-SQINDV(2)
             MOVE 0 TO SQL-SQINDS(2)
             MOVE 0 TO SQL-SQHARM(2)
             CALL "SQLADR" USING
                 Ｄ４１４−取引先コード IN
                 契約売掛債権明細
                 SQL-SQHSTV(3)
             MOVE 9 TO SQL-SQHSTL(3)
             MOVE 0 TO SQL-SQHSTS(3)
             MOVE 0 TO SQL-SQINDV(3)
             MOVE 0 TO SQL-SQINDS(3)
             MOVE 0 TO SQL-SQHARM(3)
             CALL "SQLADR" USING
                 Ｄ４１４−契約先コード IN
                 契約売掛債権明細
                 SQL-SQHSTV(4)
             MOVE 5 TO SQL-SQHSTL(4)
             MOVE 0 TO SQL-SQHSTS(4)
             MOVE 0 TO SQL-SQINDV(4)
             MOVE 0 TO SQL-SQINDS(4)
             MOVE 0 TO SQL-SQHARM(4)
             CALL "SQLADR" USING
                 Ｄ４１４−額面金額 IN
                 契約売掛債権明細
                 SQL-SQHSTV(5)
             MOVE 7 TO SQL-SQHSTL(5)
             MOVE 0 TO SQL-SQHSTS(5)
             MOVE 0 TO SQL-SQINDV(5)
             MOVE 0 TO SQL-SQINDS(5)
             MOVE 0 TO SQL-SQHARM(5)
             CALL "SQLADR" USING
                 Ｄ４１４−期日 IN
                 契約売掛債権明細
                 SQL-SQHSTV(6)
             MOVE 8 TO SQL-SQHSTL(6)
             MOVE 0 TO SQL-SQHSTS(6)
             MOVE 0 TO SQL-SQINDV(6)
             MOVE 0 TO SQL-SQINDS(6)
             MOVE 0 TO SQL-SQHARM(6)
             CALL "SQLADR" USING
                 Ｄ４１４−利息期日 IN
                 契約売掛債権明細
                 SQL-SQHSTV(7)
             MOVE 8 TO SQL-SQHSTL(7)
             MOVE 0 TO SQL-SQHSTS(7)
             MOVE 0 TO SQL-SQINDV(7)
             MOVE 0 TO SQL-SQINDS(7)
             MOVE 0 TO SQL-SQHARM(7)
             CALL "SQLADR" USING
                 Ｄ４１４−日数 IN
                 契約売掛債権明細
                 SQL-SQHSTV(8)
             MOVE 2 TO SQL-SQHSTL(8)
             MOVE 0 TO SQL-SQHSTS(8)
             MOVE 0 TO SQL-SQINDV(8)
             MOVE 0 TO SQL-SQINDS(8)
             MOVE 0 TO SQL-SQHARM(8)
             CALL "SQLADR" USING
                 Ｄ４１４−割引率 IN
                 契約売掛債権明細
                 SQL-SQHSTV(9)
             MOVE 6 TO SQL-SQHSTL(9)
             MOVE 0 TO SQL-SQHSTS(9)
             MOVE 0 TO SQL-SQINDV(9)
             MOVE 0 TO SQL-SQINDS(9)
             MOVE 0 TO SQL-SQHARM(9)
             CALL "SQLADR" USING
                 Ｄ４１４−割引料 IN
                 契約売掛債権明細
                 SQL-SQHSTV(10)
             MOVE 7 TO SQL-SQHSTL(10)
             MOVE 0 TO SQL-SQHSTS(10)
             MOVE 0 TO SQL-SQINDV(10)
             MOVE 0 TO SQL-SQINDS(10)
             MOVE 0 TO SQL-SQHARM(10)
             CALL "SQLADR" USING
                 Ｄ４１４−取立手数料等 IN
                 契約売掛債権明細
                 SQL-SQHSTV(11)
             MOVE 7 TO SQL-SQHSTL(11)
             MOVE 0 TO SQL-SQHSTS(11)
             MOVE 0 TO SQL-SQINDV(11)
             MOVE 0 TO SQL-SQINDS(11)
             MOVE 0 TO SQL-SQHARM(11)
             CALL "SQLADR" USING
                 Ｄ４１４−取立手数料等消費税額 IN
                 契約売掛債権明細
                 SQL-SQHSTV(12)
             MOVE 7 TO SQL-SQHSTL(12)
             MOVE 0 TO SQL-SQHSTS(12)
             MOVE 0 TO SQL-SQINDV(12)
             MOVE 0 TO SQL-SQINDS(12)
             MOVE 0 TO SQL-SQHARM(12)
             CALL "SQLADR" USING
                 Ｄ４１４−買取代金額 IN
                 契約売掛債権明細
                 SQL-SQHSTV(13)
             MOVE 7 TO SQL-SQHSTL(13)
             MOVE 0 TO SQL-SQHSTS(13)
             MOVE 0 TO SQL-SQINDV(13)
             MOVE 0 TO SQL-SQINDS(13)
             MOVE 0 TO SQL-SQHARM(13)
             CALL "SQLADR" USING
                 Ｄ４１４−社内金利区分 IN
                 契約売掛債権明細
                 SQL-SQHSTV(14)
             MOVE 1 TO SQL-SQHSTL(14)
             MOVE 0 TO SQL-SQHSTS(14)
             MOVE 0 TO SQL-SQINDV(14)
             MOVE 0 TO SQL-SQINDS(14)
             MOVE 0 TO SQL-SQHARM(14)
             CALL "SQLADR" USING
                 Ｄ４１４−社内金利 IN
                 契約売掛債権明細
                 SQL-SQHSTV(15)
             MOVE 6 TO SQL-SQHSTL(15)
             MOVE 0 TO SQL-SQHSTS(15)
             MOVE 0 TO SQL-SQINDV(15)
             MOVE 0 TO SQL-SQINDS(15)
             MOVE 0 TO SQL-SQHARM(15)
             CALL "SQLADR" USING
                 Ｄ４１４−実質年率 IN
                 契約売掛債権明細
                 SQL-SQHSTV(16)
             MOVE 6 TO SQL-SQHSTL(16)
             MOVE 0 TO SQL-SQHSTS(16)
             MOVE 0 TO SQL-SQINDV(16)
             MOVE 0 TO SQL-SQINDS(16)
             MOVE 0 TO SQL-SQHARM(16)
             CALL "SQLADR" USING
                 Ｄ４１４−粗利 IN
                 契約売掛債権明細
                 SQL-SQHSTV(17)
             MOVE 7 TO SQL-SQHSTL(17)
             MOVE 0 TO SQL-SQHSTS(17)
             MOVE 0 TO SQL-SQINDV(17)
             MOVE 0 TO SQL-SQINDS(17)
             MOVE 0 TO SQL-SQHARM(17)
             CALL "SQLADR" USING
                 Ｄ４１４−請求先コード IN
                 契約売掛債権明細
                 SQL-SQHSTV(18)
             MOVE 5 TO SQL-SQHSTL(18)
             MOVE 0 TO SQL-SQHSTS(18)
             MOVE 0 TO SQL-SQINDV(18)
             MOVE 0 TO SQL-SQINDS(18)
             MOVE 0 TO SQL-SQHARM(18)
             CALL "SQLADR" USING
                 Ｄ４１４−社内金利−一般 IN
                 契約売掛債権明細
                 SQL-SQHSTV(19)
             MOVE 6 TO SQL-SQHSTL(19)
             MOVE 0 TO SQL-SQHSTS(19)
             MOVE 0 TO SQL-SQINDV(19)
             MOVE 0 TO SQL-SQINDS(19)
             MOVE 0 TO SQL-SQHARM(19)
             CALL "SQLADR" USING
                 Ｄ４１４−粗利−一般 IN
                 契約売掛債権明細
                 SQL-SQHSTV(20)
             MOVE 7 TO SQL-SQHSTL(20)
             MOVE 0 TO SQL-SQHSTS(20)
             MOVE 0 TO SQL-SQINDV(20)
             MOVE 0 TO SQL-SQINDS(20)
             MOVE 0 TO SQL-SQHARM(20)
             CALL "SQLADR" USING
                 Ｄ４１４−期限前決済日 IN
                 契約売掛債権明細
                 SQL-SQHSTV(21)
             MOVE 8 TO SQL-SQHSTL(21)
             MOVE 0 TO SQL-SQHSTS(21)
             MOVE 0 TO SQL-SQINDV(21)
             MOVE 0 TO SQL-SQINDS(21)
             MOVE 0 TO SQL-SQHARM(21)
             CALL "SQLADR" USING
                 Ｄ４１４−流動化先 IN
                 契約売掛債権明細
                 SQL-SQHSTV(22)
             MOVE 10 TO SQL-SQHSTL(22)
             MOVE 0 TO SQL-SQHSTS(22)
             MOVE 0 TO SQL-SQINDV(22)
             MOVE 0 TO SQL-SQINDS(22)
             MOVE 0 TO SQL-SQHARM(22)
             CALL "SQLADR" USING
                 Ｄ４１４−債権流動化先区分 IN
                 契約売掛債権明細
                 SQL-SQHSTV(23)
             MOVE 1 TO SQL-SQHSTL(23)
             MOVE 0 TO SQL-SQHSTS(23)
             MOVE 0 TO SQL-SQINDV(23)
             MOVE 0 TO SQL-SQINDS(23)
             MOVE 0 TO SQL-SQHARM(23)
             CALL "SQLADR" USING
                 Ｄ４１４−更新年月日 IN
                 契約売掛債権明細
                 SQL-SQHSTV(24)
             MOVE 8 TO SQL-SQHSTL(24)
             MOVE 0 TO SQL-SQHSTS(24)
             MOVE 0 TO SQL-SQINDV(24)
             MOVE 0 TO SQL-SQINDS(24)
             MOVE 0 TO SQL-SQHARM(24)
             CALL "SQLADR" USING
                 Ｄ４１４−更新時間 IN
                 契約売掛債権明細
                 SQL-SQHSTV(25)
             MOVE 8 TO SQL-SQHSTL(25)
             MOVE 0 TO SQL-SQHSTS(25)
             MOVE 0 TO SQL-SQINDV(25)
             MOVE 0 TO SQL-SQINDS(25)
             MOVE 0 TO SQL-SQHARM(25)
             CALL "SQLADR" USING
                 Ｄ４１４−更新者 IN
                 契約売掛債権明細
                 SQL-SQHSTV(26)
             MOVE 8 TO SQL-SQHSTL(26)
             MOVE 0 TO SQL-SQHSTS(26)
             MOVE 0 TO SQL-SQINDV(26)
             MOVE 0 TO SQL-SQINDS(26)
             MOVE 0 TO SQL-SQHARM(26)
             CALL "SQLADR" USING
                 Ｄ４１４−入力担当者コード IN
                 契約売掛債権明細
                 SQL-SQHSTV(27)
             MOVE 8 TO SQL-SQHSTL(27)
             MOVE 0 TO SQL-SQHSTS(27)
             MOVE 0 TO SQL-SQINDV(27)
             MOVE 0 TO SQL-SQINDS(27)
             MOVE 0 TO SQL-SQHARM(27)
             CALL "SQLADR" USING
                 Ｄ４１４−登録年月日 IN
                 契約売掛債権明細
                 SQL-SQHSTV(28)
             MOVE 8 TO SQL-SQHSTL(28)
             MOVE 0 TO SQL-SQHSTS(28)
             MOVE 0 TO SQL-SQINDV(28)
             MOVE 0 TO SQL-SQINDS(28)
             MOVE 0 TO SQL-SQHARM(28)
             CALL "SQLADR" USING
                 Ｄ４１４−登録時間 IN
                 契約売掛債権明細
                 SQL-SQHSTV(29)
             MOVE 8 TO SQL-SQHSTL(29)
             MOVE 0 TO SQL-SQHSTS(29)
             MOVE 0 TO SQL-SQINDV(29)
             MOVE 0 TO SQL-SQINDS(29)
             MOVE 0 TO SQL-SQHARM(29)
             CALL "SQLADR" USING
                 Ｄ４１４−登録担当者 IN
                 契約売掛債権明細
                 SQL-SQHSTV(30)
             MOVE 8 TO SQL-SQHSTL(30)
             MOVE 0 TO SQL-SQHSTS(30)
             MOVE 0 TO SQL-SQINDV(30)
             MOVE 0 TO SQL-SQINDS(30)
             MOVE 0 TO SQL-SQHARM(30)
             CALL "SQLADR" USING
                 SQL-SQHSTV(1)
                 SQL-SQPHSV
             CALL "SQLADR" USING
                 SQL-SQHSTL(1)
                 SQL-SQPHSL
             CALL "SQLADR" USING
                 SQL-SQHSTS(1)
                 SQL-SQPHSS
             CALL "SQLADR" USING
                 SQL-SQINDV(1)
                 SQL-SQPIND
             CALL "SQLADR" USING
                 SQL-SQINDS(1)
                 SQL-SQPINS
             CALL "SQLADR" USING
                 SQL-SQHARM(1)
                 SQL-SQPARM
             CALL "SQLADR" USING
                 SQL-SQHARC(1)
                 SQL-SQPARC

             CALL "SQLBEX" USING
                 SQLCTX
                 SQLEXD
                 SQLFPN

             CALL "SQLGSS" USING
                SQLSTATE
                 .
005910*                                                                 
005920*----------------------------------------------------------------*
005930*    追加処理を確認                                              *
005940*----------------------------------------------------------------*
005950     EVALUATE  SQLCODE                                            
005960        WHEN   定数−ＳＱＬＯＫ                                   
005970*--<       追加成功 >                                             
005980           COMPUTE  Ｗ−出力−件数    =  Ｗ−出力−件数  +  1     
005990        WHEN   OTHER                                              
006000*--<       追加処理エラー >                                       
006010           MOVE     -4                TO  Ｗ−エラーコード        
006020           PERFORM  エラー処理                                    
006030     END-EVALUATE.                                                
006040*                                                                 
006050 出力処理−ＥＸＩＴ.                                              
006060     EXIT.                                                        
006070*                                                                 
006080******************************************************************
006090*    終了処理                                                    *
006100******************************************************************
006110 終了処理                             SECTION.                    
006120 終了処理−ＳＴＡＲＴ.                                            
006130*                                                                 
006140*----------------------------------------------------------------*
006150*    ＤＢクローズ処理                                            *
006160*----------------------------------------------------------------*
006170     PERFORM ＤＢクローズ処理.                                    
006180*----------------------------------------------------------------*
006190*    ＤＢコミット処理                                             
006200*----------------------------------------------------------------*
006210     PERFORM  ＤＢコミット処理                                    
006220*----------------------------------------------------------------*
006230*    件数メッセージ出力処理                                      *
006240*----------------------------------------------------------------*
006250     PERFORM  件数メッセージ出力.                                 
006260*----------------------------------------------------------------*
006270*    終了メッセージ出力処理                                      *
006280*----------------------------------------------------------------*
006290     PERFORM  終了メッセージ出力.                                 
006300*                                                                 
006310*--< プログラム正常終了 >                                         
006320     MOVE  定数−正常状態             TO  PROGRAM-STATUS.         
006330*                                                                 
006340 終了処理−ＥＸＩＴ.                                              
006350     EXIT.                                                        
006360******************************************************************
006370*    件数メッセージ出力処理                                      *
006380******************************************************************
006390 件数メッセージ出力                   SECTION.                    
006400 件数メッセージ出力−ＳＴＡＲＴ.                                  
006410*                                                                 
006420     INITIALIZE                       IF-CHOCO001.                
006430     MOVE  "3"                        TO  共１−イベント種別.     
006440     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
006450     MOVE  "0"                        TO  共１−復帰コード.       
006460     MOVE  "LTRFCU"                   TO  共１−処理テーブルＩＤ. 
006470     MOVE  "COUNT"                    TO  共１−処理識別.         
006480     MOVE  Ｗ−入力−件数             TO  共１−データ内容.       
006490     MOVE  "SUMMITﾌｧｸﾀﾘﾝｸﾞ売掛債権読込件数"                       
006500                                      TO  共１−その他メッセージ. 
006510     CALL  CLOCO001                USING  IF-CHOCO001.            
006520*                                                                 
006530     INITIALIZE                       IF-CHOCO001.                
006540     MOVE  "3"                        TO  共１−イベント種別.     
006550     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
006560     MOVE  "0"                        TO  共１−復帰コード.       
006570     MOVE  "LTRFCK"                   TO  共１−処理テーブルＩＤ. 
006580     MOVE  "COUNT"                    TO  共１−処理識別.         
006590     MOVE  Ｗ−入力−件数             TO  共１−データ内容.       
006600     MOVE  "SUMMITﾌｧｸﾀﾘﾝｸﾞ基本情報読込件数"                       
006610                                      TO  共１−その他メッセージ. 
006620     CALL  CLOCO001                USING  IF-CHOCO001.            
006630*                                                                 
006640     INITIALIZE                       IF-CHOCO001.                
006650     MOVE  "3"                        TO  共１−イベント種別.     
006660     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
006670     MOVE  "0"                        TO  共１−復帰コード.       
006680     MOVE  "D414USM"                  TO  共１−処理テーブルＩＤ. 
006690     MOVE  "COUNT"                    TO  共１−処理識別.         
006700     MOVE  Ｗ−出力−件数             TO  共１−データ内容.       
006710     MOVE  "契約売掛債権明細登録件数"                             
006720                                      TO  共１−その他メッセージ. 
006730     CALL  CLOCO001                USING  IF-CHOCO001.            
006740*                                                                 
006750 件数メッセージ出力−ＥＸＩＴ.                                    
006760     EXIT.                                                        
006770*                                                                 
006780******************************************************************
006790*    終了メッセージ出力処理                                      *
006800******************************************************************
006810 終了メッセージ出力                   SECTION.                    
006820 終了メッセージ出力−ＳＴＡＲＴ.                                  
006830*                                                                 
006840     INITIALIZE                       IF-CHOCO001.                
006850     MOVE  "3"                        TO  共１−イベント種別.     
006860     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
006870     MOVE  "0"                        TO  共１−復帰コード.       
006880     MOVE  "END"                      TO  共１−処理識別.         
006890     MOVE  定数−プログラム名         TO  共１−その他メッセージ. 
006900     CALL  CLOCO001                USING  IF-CHOCO001.            
006910*                                                                 
006920 終了メッセージ出力−ＥＸＩＴ.                                    
006930     EXIT.                                                        
006940*                                                                 
006950******************************************************************
006960*    ＤＢクローズ                                                *
006970******************************************************************
006980 ＤＢクローズ処理                     SECTION.                    
006990 ＤＢクローズ処理−ＳＴＡＲＴ.                                    
007000*                                                                 
007010*--< カーソル クローズ >                                          
007020     
      *    EXEC SQL                                                     
007030*       CLOSE  CUR1                                               
007040*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 369 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007050*                                                                 
007060 ＤＢクローズ処理−ＥＸＩＴ.                                      
007070     EXIT.                                                        
007080******************************************************************
007090*    ＤＢコミット処理                                            *
007100******************************************************************
007110 ＤＢコミット処理                     SECTION.                    
007120 ＤＢコミット処理−ＳＴＡＲＴ.                                    
007130*                                                                 
007140     
      *    EXEC  SQL                                                    
007150*       COMMIT  WORK  RELEASE                                     
007160*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 384 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007170*                                                                 
007180     INITIALIZE                       IF-CHOCO001.                
007190     MOVE  "3"                        TO  共１−イベント種別.     
007200     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
007210     MOVE  "0"                        TO  共１−復帰コード.       
007220     MOVE  "COMMIT"                   TO  共１−処理識別.         
007230     MOVE  "コミット実施"             TO  共１−その他メッセージ. 
007240     CALL  CLOCO001                USING  IF-CHOCO001.            
007250*                                                                 
007260 ＤＢコミット処理−ＥＸＩＴ.                                      
007270     EXIT.                                                        
007280******************************************************************
007290*    ＤＢロールバック処理                                        *
007300******************************************************************
007310 ＤＢロールバック処理                 SECTION.                    
007320 ＤＢロールバック処理−ＳＴＡＲＴ.                                
007330*                                                                 
007340     
      *    EXEC  SQL                                                    
007350*       ROLLBACK WORK  RELEASE                                    
007360*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 399 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007370*                                                                 
007380     INITIALIZE                       IF-CHOCO001.                
007390     MOVE  "1"                        TO  共１−イベント種別.     
007400     MOVE  定数−プログラムＩＤ       TO  共１−ソースＩＤ.       
007410     MOVE  "9"                        TO  共１−復帰コード.       
007420     MOVE  "ROLLBACK"                 TO  共１−処理識別.         
007430     MOVE  "ロールバック実施"         TO  共１−その他メッセージ. 
007440     CALL  CLOCO001                USING  IF-CHOCO001.            
007450*                                                                 
007460 ＤＢロールバック処理−ＥＸＩＴ.                                  
007470     EXIT.                                                        
007480
007490******************************************************************
007500*    エラー処理                                                  *
007510******************************************************************
007520 エラー処理                           SECTION.                    
007530 エラー処理−ＳＴＡＲＴ.                                          
007540*                                                                 
007550     MOVE  "Y"                        TO  Ｗ−異常終了−フラグ.   
007560     INITIALIZE                       IF-CHOCO001.                
007570*                                                                 
007580     EVALUATE  Ｗ−エラーコード                                   
007590        WHEN  -1                                                  
007600*--<       ＯＲＡＣＬＥ接続失敗 >                                 
007610           MOVE  "1"                  TO  共１−イベント種別      
007620           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
007630           MOVE  "9"                  TO  共１−復帰コード        
007640           MOVE  "CONNECT"            TO  共１−処理識別          
007650           MOVE  SQLCODE              TO  共１−データ内容        
007660           MOVE  SQLERRMC             TO  共１−その他メッセージ  
007670           CALL  CLOCO001          USING  IF-CHOCO001             
007680*                                                                 
007690        WHEN  -2                                                  
007700*--<       カーソルオープンエラー  >                              
007710           MOVE  "1"                  TO  共１−イベント種別      
007720           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
007730           MOVE  "9"                  TO  共１−復帰コード        
007740           MOVE  "LTRFCU"             TO  共１−処理テーブルＩＤ  
007750           MOVE  "OPEN"               TO  共１−処理識別          
007760           MOVE  SQLCODE              TO  共１−データ内容        
007770           MOVE  SQLERRMC             TO  共１−その他メッセージ  
007780           CALL  CLOCO001          USING  IF-CHOCO001             
007790*                                                                 
007800        WHEN  -3                                                  
007810*--<       結合テーブルカーソル読込エラー >                       
007820           MOVE  "1"                  TO  共１−イベント種別      
007830           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
007840           MOVE  "9"                  TO  共１−復帰コード        
007850           MOVE  SQLCODE              TO  共１−処理テーブルＩＤ  
007860           MOVE  "SELECT"             TO  共１−処理識別          
007870           MOVE  SQLCODE              TO  共１−データ内容        
007880           MOVE  SQLERRMC             TO  共１−その他メッセージ  
007890           CALL  CLOCO001          USING  IF-CHOCO001             
007900*                                                                 
007910        WHEN  -4                                                  
007920*--<       追加処理エラー  >                                      
007930           MOVE  "1"                  TO  共１−イベント種別      
007940           MOVE  定数−プログラムＩＤ TO  共１−ソースＩＤ        
007950           MOVE  "9"                  TO  共１−復帰コード        
007960           MOVE  "D414USM"            TO  共１−処理テーブルＩＤ  
007970           MOVE  "INSERT"             TO  共１−処理識別          
007980           MOVE  SQLCODE              TO  共１−データ内容        
007990           MOVE  SQLERRMC             TO  共１−その他メッセージ  
008000           CALL  CLOCO001          USING  IF-CHOCO001             
008010*                                                                 
008020        WHEN  OTHER                                               
008030           MOVE  "N"                  TO  Ｗ−異常終了−フラグ    
008040     END-EVALUATE.                                                
008050*                                                                 
008060     IF  Ｗ−異常終了−フラグ =  "Y"                              
008070*--<    件数メッセージ出力 >                                      
008080        PERFORM  件数メッセージ出力                               
008090*--<    終了メッセージ出力処理 >                                  
008100        PERFORM  終了メッセージ出力                               
008110*--<    プログラムリターンコード >                                
008120        MOVE  定数−異常状態          TO  PROGRAM-STATUS          
008130        EXIT  PROGRAM                                             
008140     END-IF.                                                      
008150*                                                                 
008160 エラー処理−ＥＸＩＴ.                                            
008170     EXIT.                                                        
008180******************************************************************
008190*                  END OF PROGRAM                                *
008200******************************************************************
