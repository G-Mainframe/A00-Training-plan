000010******************************************************************
000020*         CP(A)                                     *
000030*      1. vO    F_񔄊|׈ڍs                 *
000040*      2. vOID    FCOBIS490                             *
000050*      3. Tv        Frtllhst@N^Oca A*
000060*                           _񔄊|׃e[u쐬B *
000070*      4. 쐬          F                               *
000080*      5. 쐬          F2005.03.31                           *
000090******************************************************************
000100*                                                                 
000110******************************************************************
000120*    cdmshehb`shnm  chuhrhnm                *
000130******************************************************************
000140 IDENTIFICATION                       DIVISION.                   
000150*                                                                 
000160 PROGRAM-ID.                          COBIS490.                   
000170******************************************************************
000180*    dmuhqnmldms        chuhrhnm              *
000190******************************************************************
000200 ENVIRONMENT                          DIVISION.                   
000210******************************************************************
000220*    c`s`                      chuhrhnm              *
000230******************************************************************
000240 DATA                                 DIVISION.                   
000250******************************************************************
000260*  vnqjhmf|rsnq`fd  rdbshnm                *
000270******************************************************************
000280 WORKING-STORAGE                      SECTION.                    
000290*----------------------------------------------------------------*
000300*    zXgϐ`GA                                        *
000310*----------------------------------------------------------------*
000320     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +12.
           02  SQLFPN-FILENAME PIC X(12) VALUE "COBIS490.PCO".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(110) VALUE "select VR[h   into :b1
      -    "  from IKOTBL001 where (IKOTBL001.R[h=:b2 and IKOTB
      -    "L001.ړIbc='2')".

       01  SQ0003 GLOBAL.
           02  FILLER PIC X(100) VALUE "select }   into :b1  from IKO
      -     "TBL001 where (IKOTBL001.R[h=:b2 and IKOTBL001.ړI
      -    "bc='2')".

       01  SQ0004 GLOBAL.
           02  FILLER PIC X(100) VALUE "select }   into :b1  from IKO
      -     "TBL001 where (IKOTBL001.R[h=:b2 and IKOTBL001.ړI
      -    "bc='3')".

       01  SQ0005 GLOBAL.
           02  FILLER PIC X(159) VALUE "insert into D414USM_TBL(_ԍ
      -     ",הԍ,R[h,_R[h,zʋz,,,
      -     ",,,旧萔,旧萔Ŋz,
      -    "z,Г".

           02  FILLER PIC X(160) VALUE "敪,Г,N,e,
      -     "R[h,Г_,e_,Oϓ,,
      -    "敪,XVN,XV,XV,͒S҃R[h
      -    ",o^N".

           02  FILLER PIC X(160) VALUE ",o^,o^S) values (
      -    ":b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14
      -    ",:b15,:b16,:b17,:b18,:b19,:b20,:b21,:b22,:b23,:b24,:b25,:b26
      -    ",:b27,:b".

           02  FILLER PIC X(13) VALUE "28,:b29,:b30)".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +288037.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +30.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 30 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 30 TIMES.


       01  SQ0001 GLOBAL.
           02  FILLER PIC X(160) VALUE "select LTRFCU._ԍ  ,LTRFCK.
      -    "[U[R[h  ,LTRFCK.zʋz  ,LTRFCK.  ,LTRFCU.
      -    "  ,LTRFCU.ԓ  ,LTRFCU.  ,LTRFCU.  ,LTR
      -    "FCU.".

           02  FILLER PIC X(160) VALUE "萔  ,LTRFCU.萔
      -    "z  ,LTRFCU.z  ,LTRFCK.Г  ,LTRFCK.ev  ,L
      -    "TRFCK.R[h  ,LTRFCK.Г  ,LTRFCK.ev  ,LTRFC
      -    "U.O".

           02  FILLER PIC X(77) VALUE "ٓ   from LTRFCK ,LTRFCU wher
      -    "e LTRFCU._ԍ=LTRFCK._ԍ           ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +190.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +194.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +397.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +249.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +82.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +273.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +17.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +11.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +11.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +11.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +165.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +110.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +334.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +188.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +100.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +366.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +211.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +100.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +397.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +234.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +492.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +516.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +369.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +691.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +384.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +6.
           02     FILLER PIC S9(4) COMP-5 VALUE +12.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +30.
           02     FILLER PIC S9(4) COMP-5 VALUE +703.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +399.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +14.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +32.
           02     FILLER PIC S9(4) COMP-5 VALUE +723.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000330*                                                                 
000340 01  vr|N                   PIC  9(10) VALUE ZERO.      
000350 01  vr|Г敪               PIC  X(01) VALUE ZERO.      
000360 01  vr|                   PIC  X(10) VALUE ZERO.      
000370 01  vr|敪           PIC  X(01) VALUE ZERO.      
000380*                                                                 
000390*--< nq`bkdʕϐ >                                       
000400     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL             END-EXEC.
000410*                                                                 
000420*--< nq`bkd rpks (SQLCA) >                        
000010*--rpkʕϐ
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000430     
      *    EXEC  SQL  INCLUDE  SQLCA.COB              END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000440*                                                                 
000450*--< SUMMIŢݸޔ| >                                     
000460     
      *    EXEC  SQL  INCLUDE  LTRFCU.CBL             END-EXEC.
000470*                                                                 
000480*--< SUMMIŢݸފ{ >                                     
000010************************************************
000020* ̧ݸށi|j(LTRFCU)
000030************************************************
000040 01  ksqebt|_ԍ PIC  X(009).
000050 01  ksqebt| PIC  X(007).
000060 01  ksqebt|@ PIC S9(001) COMP-3.
000070 01  ksqebt|㗝敪 PIC S9(001) COMP-3.
000080 01  ksqebt|ԓ PIC S9(004) COMP-3.
000090 01  ksqebt|z PIC S9(013) COMP-3.
000100 01  ksqebt| PIC S9(013) COMP-3.
000110 01  ksqebt| PIC S9(003)V9(8) COMP-3.
000120 01  ksqebt|萔 PIC S9(013) COMP-3.
000130 01  ksqebt|萔œz PIC S9(013) COMP-3.
000140 01  ksqebt|ߗ\ PIC  X(007).
000150 01  ksqebt|x PIC  X(007).
000160 01  ksqebt|\ PIC  X(060).
000170 01  ksqebt|Oٓ PIC  X(007).
000180 01  ksqebt|߂z PIC S9(013) COMP-3.
000190 01  ksqebt|߂ PIC S9(003)V9(8) COMP-3.
000200 01  ksqebt|߂ PIC S9(004) COMP-3.
000210 01  ksqebt|߂E敪 PIC S9(001) COMP-3.
000220 01  ksqebt|ԍώ萔 PIC S9(013) COMP-3.
000230 01  ksqebt|ԍώ萔œz PIC S9(013) COMP-3.
000240 01  ksqebt|\ PIC  X(040).
000490     
      *    EXEC  SQL  INCLUDE  LTRFCK.CBL             END-EXEC.
000500*                                                                 
000510*--< _񔄊|ׂca >                                       
000010************************************************
000020* ̧ݸށi{j(LTRFCK)
000030************************************************
000040 01  ksqebj|_ԍ PIC  X(009).
000050 01  ksqebj|[U[R[h PIC  X(008).
000060 01  ksqebj|R[h PIC  X(008).
000070 01  ksqebj|ƏR[h PIC S9(004) COMP-3.
000080 01  ksqebj|S҃R[h PIC S9(004) COMP-3.
000090 01  ksqebj|_ PIC  X(007).
000100 01  ksqebj|s PIC  X(007).
000110 01  ksqebj|菈R[h PIC S9(002) COMP-3.
000120 01  ksqebj|Г PIC S9(003)V9(8) COMP-3.
000130 01  ksqebj| PIC S9(003)V9(8) COMP-3.
000140 01  ksqebj|ev PIC S9(013) COMP-3.
000150 01  ksqebj|zʋz PIC S9(013) COMP-3.
000160 01  ksqebj|Ɩ敪 PIC S9(001) COMP-3.
000170 01  ksqebj| PIC  X(007).
000180 01  ksqebj|sR[h PIC  X(007).
000190 01  ksqebj|ԍ PIC  X(007).
000200 01  ksqebj|a PIC S9(001) COMP-3.
000210 01  ksqebj|Č敪 PIC  X(001).
000220 01  ksqebj|gc敪 PIC S9(001) COMP-3.
000230 01  ksqebj|R[h PIC S9(001) COMP-3.
000240 01  ksqebj|[R[h PIC S9(001) COMP-3.
000250 01  ksqebj|O敪 PIC S9(001) COMP-3.
000260 01  ksqebj|В[[敪 PIC S9(001) COMP-3.
000270 01  ksqebj|ϓ敪 PIC S9(001) COMP-3.
000280 01  ksqebj|A敪 PIC S9(002) COMP-3.
000290 01  ksqebj|Xvbh PIC S9(003)V9(8) COMP-3.
000300 01  ksqebj|xΉ敪 PIC S9(001) COMP-3.
000310 01  ksqebj|҃R[h PIC  X(008).
000320 01  ksqebj|ҏP PIC  X(040).
000330 01  ksqebj|ҏQ PIC  X(040).
000340 01  ksqebj|ҏR PIC  X(040).
000350 01  ksqebj|Fmn PIC  X(006).
000360 01  ksqebj|xF PIC  X(007).
000370 01  ksqebj|xF|S҃R[h PIC  X(004).
000380 01  ksqebj|x@R[h PIC S9(002) COMP-3.
000390 01  ksqebj|Ǘs PIC  X(007).
000400 01  ksqebj|cao^ PIC  X(007).
000410 01  ksqebj|\ PIC  X(090).
000420 01  ksqebj|ʏ PIC  X(035).
000520     
      *    EXEC  SQL  INCLUDE  D414USM.CBL            END-EXEC.
000530*                                                                 
000540*--< ϊe[u >                                               
      *****************************************************************
      *   _񔄊|(D414USM_TBL)
      *****************************************************************
       01  _񔄊|.
           03  cSPS|_ԍ    PIC  X(010).
           03  cSPS|הԍ    PIC S9(003) PACKED-DECIMAL.
           03  cSPS|R[h
                                     PIC  X(009).
           03  cSPS|_R[h
                                     PIC  X(005).
           03  cSPS|zʋz    PIC S9(013) PACKED-DECIMAL.
           03  cSPS|        PIC  X(008).
           03  cSPS|    PIC  X(008).
           03  cSPS|        PIC S9(003) PACKED-DECIMAL.
           03  cSPS|      PIC S9(002)V9(008) PACKED-DECIMAL.
           03  cSPS|      PIC S9(013) PACKED-DECIMAL.
           03  cSPS|旧萔
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPS|旧萔Ŋz
                                     PIC S9(013) PACKED-DECIMAL.
           03  cSPS|z  PIC S9(013) PACKED-DECIMAL.
           03  cSPS|Г敪
                                     PIC  X(001).
           03  cSPS|Г    PIC S9(002)V9(008) PACKED-DECIMAL.
           03  cSPS|N    PIC S9(002)V9(008) PACKED-DECIMAL.
           03  cSPS|e        PIC S9(013) PACKED-DECIMAL.
           03  cSPS|R[h
                                     PIC  X(005).
           03  cSPS|Г|
                                     PIC S9(002)V9(008) PACKED-DECIMAL.
           03  cSPS|e|  PIC S9(013) PACKED-DECIMAL.
           03  cSPS|Oϓ
                                     PIC  X(008).
           03  cSPS|    PIC  X(010).
           03  cSPS|敪
                                     PIC  X(001).
           03  cSPS|XVN  PIC  X(008).
           03  cSPS|XV    PIC  X(008).
           03  cSPS|XV      PIC  X(008).
           03  cSPS|͒S҃R[h
                                     PIC  X(008).
           03  cSPS|o^N  PIC  X(008).
           03  cSPS|o^    PIC  X(008).
           03  cSPS|o^S  PIC  X(008).
000550     
      *    EXEC  SQL  INCLUDE  IKOTBL001.CBL          END-EXEC.
000560*                                                                 
000010************************************************
000020* ϊe[u(IKOTBL001)
000030************************************************
000040 01  hjnOOP|R[h PIC  X(008).
000050 01  hjnOOP|ړIbc PIC  X(001).
000060 01  hjnOOP|VR[h PIC  X(007).
000070 01  hjnOOP|} PIC  X(003).
000080 01  hjnOOP|^MR[h PIC  X(007).
000090 01  hjnOOP|񂹃R[h PIC  X(008).
000100 01  hjnOOP|[UR[h PIC  X(008).
000110 01  hjnOOP|ʂbc PIC  X(001).
000570     
      *    EXEC  SQL  END      DECLARE      SECTION   END-EXEC.
000580*----------------------------------------------------------------*
000590*    Ɨ̈`                                                *
000600*----------------------------------------------------------------*
000610 01  vnqj|GA.                                            
000620*                                                                 
000630*--< G[R[h >                                               
000640     03  v|G[R[h             PIC S9(02).                 
000650*                                                                 
000660*--< GA >                                                 
000670     03  GA.                                              
000680        05  v|́|            PIC  9(09).                 
000690        05  v|ó|            PIC  9(09).                 
000700*                                                                 
000710*--< tOAA >                                               
000720     03  tO|GA.                                          
000730        05  v|I|tO          PIC  X(01).                 
000740        05  v|ُI|tO      PIC  X(01).                 
000750*                                                                 
000850*----------------------------------------------------------------*
000860*   Ԓ`                                                 *
000870*----------------------------------------------------------------*
000880*--< ʏ >                                                   
000890 01  v|ʏ.                                                
000900     03  v|VXet.                                        
000910         05  v|I                 PIC  X(02) VALUE  "20".     
000920         05  v|N               PIC  X(06).                 
000930     03  v|VXe             PIC  X(08).                 
000940     03  v|S                   PIC  X(08) VALUE "IKPO    ".
000950*----------------------------------------------------------------*
000960*    Tu[`                                              *
000970*----------------------------------------------------------------*
000980 01  CALL-AREA.                                                   
000990*--< ʃOTu[` >                                       
001000     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001010     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001020*----------------------------------------------------------------*
001030*    bnoẍ                                                *
001040*----------------------------------------------------------------*
001050*--< ʃOpp[^ >                                       
001060 01  IF-CHOCO001.                                                 
001070     COPY  CHOCO001  REPLACING  ==()==  BY  ==P|==.           
001080*                                                                 
001090*----------------------------------------------------------------*
001100*    hmht@CǍTu[`pp^̈                *
001110*----------------------------------------------------------------*
001120 01  PARA-AREA.                                                   
001130     COPY CPBCO001.                                               
001140******************************************************************
001150*    萔pf[^`GA                                      *
001160******************************************************************
001170 CONSTANT                             SECTION.                    
001180 01  萔̈.                                                    
001190     03  萔|vOhc         PIC  X(08) VALUE "COBIS490".
001200     03  萔|vO           PIC  X(80) VALUE            
001210                                       "_񔄊|׈ڍs".    
001220     03  萔|rpknj             PIC  9(04) VALUE  0000.     
001230     03  萔|rpkdmc           PIC  9(04) VALUE  0100.     
001240     03  萔|               PIC  9(04) VALUE  ZERO.     
001250     03  萔|ُ               PIC  9(04) VALUE  0009.     
001260******************************************************************
001270*    oqnbdctqd            chuhrhnm              *
001280******************************************************************
001290 PROCEDURE                            DIVISION.                   
001300*                                                                 
001310     PERFORM  .                                           
001320*                                                                 
001330     PERFORM  又  UNTIL  v|I|tO  =  "Y".            
001340*                                                                 
001350     PERFORM  I.                                           
001360*                                                                 
001370     STOP RUN.                                                    
001380*                                                                 
001390******************************************************************
001400*                                                        *
001410******************************************************************
001420                              SECTION.                    
001430 |rs`qs.                                            
001440*                                                                 
001450*----------------------------------------------------------------*
001460*     JnbZ[Wo                                         *
001470*----------------------------------------------------------------*
001480     INITIALIZE                       IF-CHOCO001.                
001490     MOVE  "3"                        TO  P|Cxg.     
001500     MOVE  萔|vOhc       TO  P|\[Xhc.       
001510     MOVE  "0"                        TO  P|AR[h.       
001520     MOVE  "START"                    TO  P|.         
001530     MOVE  萔|vO         TO  P|̑bZ[W. 
001540     CALL  CLOCO001                USING  IF-CHOCO001.            
001550*                                                                 
001560*----------------------------------------------------------------*
001570*    Ɨ̈̏lݒ                                        *
001580*----------------------------------------------------------------*
001590     MOVE  SPACE                      TO  vnqj|GA.       
001600     INITIALIZE                           vnqj|GA.       
001610*                                                                 
001620*--< bott擾 >                                           
001630     ACCEPT  v|N               FROM  DATE.                 
001640*                                                                 
001650*--< bot擾 >                                           
001660     ACCEPT  v|VXe         FROM  TIME.                 
001670*----------------------------------------------------------------*
001680*    nq`bkdڑ                                            *
001690*----------------------------------------------------------------*
001700     PERFORM  nq`bkdڑ.                                   
001710*----------------------------------------------------------------*
001720*    e[uJ[\`                                    *
001730*----------------------------------------------------------------*
001740     PERFORM   e[uJ[\`                           
001750*----------------------------------------------------------------*
001760*    e[uJ[\Ǎ(P)                            *
001770*----------------------------------------------------------------*
001780     PERFORM  e[uJ[\Ǎ.                           
001790*----------------------------------------------------------------*
001800  |dwhs.                                             
001810     EXIT.                                                        
001820******************************************************************
001830*    nq`bkdڑ                                            *
001840******************************************************************
001850 nq`bkdڑ                     SECTION.                    
001860 nq`bkdڑ|rs`qs.                                    
001870*                                                                 
001880*--< hmht@CǍTu[`Ăяo >                     
001890     CALL  COBCO001                USING  PARA-AREA.              
001900*                                                                 
001910     MOVE  PARA-DBSTRING              TO  DB-STRING.              
001920     MOVE  PARA-USERNAME              TO  USERNAME.               
001930     MOVE  PARA-PASSWORD              TO  PASSWD.                 
001940*                                                                 
001950*----------------------------------------------------------------*
001960*    Jnڑ                                                    *
001970*----------------------------------------------------------------*
001980     IF  DB-STRING  =  SPACE                                      
001990        
      *       EXEC  SQL                                                 
002000*          CONNECT  :USERNAME  IDENTIFIED  BY  :PASSWD            
002010*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002020     ELSE                                                         
002030        
      *       EXEC  SQL                                                 
002040*          CONNECT  :USERNAME  IDENTIFIED  BY  :PASSWD            
002050*            USING  :DB-STRING                                    
002060*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002070     END-IF.                                                      
002080*                                                                 
002090*----------------------------------------------------------------*
002100*    ڑԔ                                                *
002110*----------------------------------------------------------------*
002120     EVALUATE  SQLCODE                                            
002130        WHEN  萔|rpknj                                    
002140*--<       ڑ >                                             
002150           CONTINUE                                               
002160        WHEN  OTHER                                               
002170*--<       ڑG[ >                                           
002180           MOVE     -1                TO  v|G[R[h        
002190           PERFORM  G[                                    
002200     END-EVALUATE.                                                
002210*                                                                 
002220 nq`bkdڑ|dwhs.                                      
002230     EXIT.                                                        
002240******************************************************************
002250*    e[uJ[\`                                    *
002260******************************************************************
002270*                                                                 
002280 e[uJ[\`             SECTION.                    
002290 e[uJ[\`|rs`qs.                            
002300*--< e[uJ[\`  >                                  
002310     
      *    EXEC SQL                                                     
002320*       DECLARE CUR1 CURSOR FOR                                   
002330*        SELECT  LTRFCU._ԍ                                  
002340*               ,LTRFCK.[U[R[h                            
002350* 	      ,LTRFCK.zʋz                                  
002360* 	      ,LTRFCK.                                      
002370* 	      ,LTRFCU.                                  
002380* 	      ,LTRFCU.ԓ                                  
002390* 	      ,LTRFCU.                                    
002400* 	      ,LTRFCU.                                    
002410* 	      ,LTRFCU.萔                                
002420* 	      ,LTRFCU.萔œz                      
002430* 	      ,LTRFCU.z                                  
002440* 	      ,LTRFCK.Г                                  
002450* 	      ,LTRFCK.ev                                    
002460*               ,LTRFCK.R[h                              
002470* 	      ,LTRFCK.Г                                  
002480* 	      ,LTRFCK.ev                                    
002490* 	      ,LTRFCU.Oٓ                              
002500*          FROM  LTRFCK                                           
002510*               ,LTRFCU                                           
002520*         WHERE  LTRFCU._ԍ = LTRFCK._ԍ                
002530*    END-EXEC.
002540*                                                                 
002550*----------------------------------------------------------------*
002560*    J[\I[v                                        *
002570*----------------------------------------------------------------*
002580     
      *    EXEC  SQL                                                    
002590*       OPEN  CUR1                                                
002600*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
002610*----------------------------------------------------------------*
002620*    J[\I[vmF                                        *
002630*----------------------------------------------------------------*
002640     EVALUATE  SQLCODE                                            
002650        WHEN  萔|rpknj                                    
002660*--<        >                                                 
002670           CONTINUE                                               
002680        WHEN  OTHER                                               
002690*--<       J[\I[vG[ >                               
002700           MOVE     -2                TO  v|G[R[h        
002710           PERFORM  G[                                    
002720     END-EVALUATE.                                                
002730*                                                                 
002740 e[uJ[\`|dwhs.                              
002750     EXIT.                                                        
002760******************************************************************
002770*    e[uJ[\Ǎ                                    *
002780******************************************************************
002790 e[uJ[\Ǎ             SECTION.                    
002800 e[uJ[\Ǎ|rs`qs.                            
002810*                                                                 
002820     
      *    EXEC  SQL                                                    
002830*       FETCH  CUR1                                               
002840*          INTO  :ksqebt|_ԍ                          
002850*               ,:ksqebj|[U[R[h                    
002860*               ,:ksqebj|zʋz                          
002870* 	      ,:ksqebj|                              
002880* 	      ,:ksqebt|                          
002890* 	      ,:ksqebt|ԓ                          
002900* 	      ,:ksqebt|                            
002910* 	      ,:ksqebt|                            
002920* 	      ,:ksqebt|萔                        
002930* 	      ,:ksqebt|萔œz              
002940* 	      ,:ksqebt|z                          
002950* 	      ,:ksqebj|Г                          
002960* 	      ,:ksqebj|ev                            
002970*               ,:ksqebj|R[h                      
002980*               ,:ksqebj|Г                          
002990* 	      ,:ksqebj|ev                            
003000* 	      ,:ksqebt|Oٓ   		        
003010*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 82 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ksqebt|_ԍ
               SQL-SQHSTV(1)
           MOVE 9 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ksqebj|[U[R[h
               SQL-SQHSTV(2)
           MOVE 8 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ksqebj|zʋz
               SQL-SQHSTV(3)
           MOVE 7 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ksqebj|
               SQL-SQHSTV(4)
           MOVE 7 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ksqebt|
               SQL-SQHSTV(5)
           MOVE 7 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               ksqebt|ԓ
               SQL-SQHSTV(6)
           MOVE 3 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               ksqebt|
               SQL-SQHSTV(7)
           MOVE 6 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               ksqebt|
               SQL-SQHSTV(8)
           MOVE 7 TO SQL-SQHSTL(8)
           MOVE 0 TO SQL-SQHSTS(8)
           MOVE 0 TO SQL-SQINDV(8)
           MOVE 0 TO SQL-SQINDS(8)
           MOVE 0 TO SQL-SQHARM(8)
           CALL "SQLADR" USING
               ksqebt|萔
               SQL-SQHSTV(9)
           MOVE 7 TO SQL-SQHSTL(9)
           MOVE 0 TO SQL-SQHSTS(9)
           MOVE 0 TO SQL-SQINDV(9)
           MOVE 0 TO SQL-SQINDS(9)
           MOVE 0 TO SQL-SQHARM(9)
           CALL "SQLADR" USING
               ksqebt|萔œz
               SQL-SQHSTV(10)
           MOVE 7 TO SQL-SQHSTL(10)
           MOVE 0 TO SQL-SQHSTS(10)
           MOVE 0 TO SQL-SQINDV(10)
           MOVE 0 TO SQL-SQINDS(10)
           MOVE 0 TO SQL-SQHARM(10)
           CALL "SQLADR" USING
               ksqebt|z
               SQL-SQHSTV(11)
           MOVE 7 TO SQL-SQHSTL(11)
           MOVE 0 TO SQL-SQHSTS(11)
           MOVE 0 TO SQL-SQINDV(11)
           MOVE 0 TO SQL-SQINDS(11)
           MOVE 0 TO SQL-SQHARM(11)
           CALL "SQLADR" USING
               ksqebj|Г
               SQL-SQHSTV(12)
           MOVE 6 TO SQL-SQHSTL(12)
           MOVE 0 TO SQL-SQHSTS(12)
           MOVE 0 TO SQL-SQINDV(12)
           MOVE 0 TO SQL-SQINDS(12)
           MOVE 0 TO SQL-SQHARM(12)
           CALL "SQLADR" USING
               ksqebj|ev
               SQL-SQHSTV(13)
           MOVE 7 TO SQL-SQHSTL(13)
           MOVE 0 TO SQL-SQHSTS(13)
           MOVE 0 TO SQL-SQINDV(13)
           MOVE 0 TO SQL-SQINDS(13)
           MOVE 0 TO SQL-SQHARM(13)
           CALL "SQLADR" USING
               ksqebj|R[h
               SQL-SQHSTV(14)
           MOVE 8 TO SQL-SQHSTL(14)
           MOVE 0 TO SQL-SQHSTS(14)
           MOVE 0 TO SQL-SQINDV(14)
           MOVE 0 TO SQL-SQINDS(14)
           MOVE 0 TO SQL-SQHARM(14)
           CALL "SQLADR" USING
               ksqebj|Г
               SQL-SQHSTV(15)
           MOVE 6 TO SQL-SQHSTL(15)
           MOVE 0 TO SQL-SQHSTS(15)
           MOVE 0 TO SQL-SQINDV(15)
           MOVE 0 TO SQL-SQINDS(15)
           MOVE 0 TO SQL-SQHARM(15)
           CALL "SQLADR" USING
               ksqebj|ev
               SQL-SQHSTV(16)
           MOVE 7 TO SQL-SQHSTL(16)
           MOVE 0 TO SQL-SQHSTS(16)
           MOVE 0 TO SQL-SQINDV(16)
           MOVE 0 TO SQL-SQINDS(16)
           MOVE 0 TO SQL-SQHARM(16)
           CALL "SQLADR" USING
               ksqebt|Oٓ
               SQL-SQHSTV(17)
           MOVE 7 TO SQL-SQHSTL(17)
           MOVE 0 TO SQL-SQHSTS(17)
           MOVE 0 TO SQL-SQINDV(17)
           MOVE 0 TO SQL-SQINDS(17)
           MOVE 0 TO SQL-SQHARM(17)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
003020*----------------------------------------------------------------*
003030*    e[uJ[\ǍG[                              *
003040*----------------------------------------------------------------*
003050     EVALUATE   SQLCODE                                           
003060        WHEN   萔|rpknj                                   
003070*--<        >                                                 
003080           COMPUTE  v|́|    =  v|́|  +  1     
003090        WHEN   萔|rpkdmc                                 
003100*--<       ǍI >                                             
003110           MOVE  "Y"                  TO  v|I|tO        
003120        WHEN   OTHER                                              
003130*--<       ǍG[ >                                           
003140           MOVE     -3                TO  v|G[R[h        
003150           PERFORM  G[                                    
003160     END-EVALUATE.                                                
003170*                                                                 
003180 e[uJ[\Ǎ|dwhs.                              
003190     EXIT.                                                        
003200*                                                                 
003210******************************************************************
003220*    又                                                      *
003230******************************************************************
003240 又                               SECTION.                    
003250 又|rs`qs.                                              
003260*----------------------------------------------------------------*
003270*--<  ҏWo͏ >                                             *
003280*---------------------------------------------------------------- 
003290        PERFORM  ҏW                                         
003300        PERFORM  o͏                                         
003310*                                                                 
003320*--< e[uJ[\ǍiQڈȍ~j >                     
003330     PERFORM  e[uJ[\Ǎ.                           
003340*                                                                 
003350 又|dwhs.                                                
003360     EXIT.                                                        
003370******************************************************************
003380*    ϊP                                                  *
003390******************************************************************
003400 ϊP                           SECTION.                    
003410 ϊP|rs`qs.                                          
003420*                                                                 
003430     
      *    EXEC  SQL                                                    
003440*          SELECT  VR[h                                 
003450*            INTO :hjnOOP|VR[h                   
003460*            FROM  IKOTBL001                                      
003470*           WHERE  IKOTBL001.R[h                         
003480*                                     =                           
003490*                                    :ksqebj|[U[R[h
003500*             AND  IKOTBL001.ړIbc = '2'                       
003510*    END-EXEC.
           CALL "SQLADR" USING SQ0002 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 165 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               hjnOOP|VR[h
               SQL-SQHSTV(1)
           MOVE 7 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ksqebj|[U[R[h
               SQL-SQHSTV(2)
           MOVE 8 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
003520*                                                                 
003530*----------------------------------------------------------------*
003540*    ϊPmF                                              *
003550*----------------------------------------------------------------*
003560     EVALUATE  SQLCODE                                            
003570        WHEN  萔|rpknj                                    
003580*--<        >                                                 
003590           CONTINUE                                               
003600        WHEN  OTHER                                               
003610*--<       ϊPG[ >                                     
003620           MOVE     SPACE             TO                          
003630                                      hjnOOP|VR[h
003640     END-EVALUATE.                                                
003650*                                                                 
003660  ϊP|dwhs.                                           
003670     EXIT.                                                        
003680*                                                                 
003690******************************************************************
003700*    ϊQ                                                  *
003710******************************************************************
003720 ϊQ                           SECTION.                    
003730 ϊQ|rs`qs.                                          
003740*                                                                 
003750     
      *    EXEC  SQL                                                    
003760*          SELECT }                                            
003770*            INTO :hjnOOP|}                             
003780*            FROM  IKOTBL001                                      
003790*           WHERE  IKOTBL001.R[h                         
003800*                                     =                           
003810*                                    :ksqebj|[U[R[h
003820*             AND  IKOTBL001.ړIbc = '2'                       
003830*    END-EXEC.
           CALL "SQLADR" USING SQ0003 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 188 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               hjnOOP|}
               SQL-SQHSTV(1)
           MOVE 3 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ksqebj|[U[R[h
               SQL-SQHSTV(2)
           MOVE 8 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
003840*                                                                 
003850*----------------------------------------------------------------*
003860*    ϊQmF                                              *
003870*----------------------------------------------------------------*
003880     EVALUATE  SQLCODE                                            
003890        WHEN  萔|rpknj                                    
003900*--<        >                                                 
003910           CONTINUE                                               
003920        WHEN  OTHER                                               
003930*--<       ϊQG[ >                                     
003940           MOVE     SPACE             TO  hjnOOP|}      
003950     END-EVALUATE.                                                
003960*                                                                 
003970 ϊQ|dwhs.                                            
003980     EXIT.                                                        
003990*                                                                 
004000******************************************************************
004010*    ϊR                                                  *
004020******************************************************************
004030 ϊR                           SECTION.                    
004040 ϊR|rs`qs.                                          
004050*                                                                 
004060     
      *    EXEC  SQL                                                    
004070*          SELECT  }                                           
004080*            INTO :hjnOOP|}                             
004090*            FROM  IKOTBL001                                      
004100*           WHERE  IKOTBL001.R[h                         
004110*                                     =                           
004120*                                      :ksqebj|R[h
004130*             AND  IKOTBL001.ړIbc = '3'                       
004140*    END-EXEC.
           CALL "SQLADR" USING SQ0004 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 211 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               hjnOOP|}
               SQL-SQHSTV(1)
           MOVE 3 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ksqebj|R[h
               SQL-SQHSTV(2)
           MOVE 8 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004150*                                                                 
004160*----------------------------------------------------------------*
004170*    ϊRmF                                              *
004180*----------------------------------------------------------------*
004190     EVALUATE  SQLCODE                                            
004200        WHEN  萔|rpknj                                    
004210*--<        >                                                 
004220           CONTINUE                                               
004230        WHEN  OTHER                                               
004240*--<       ϊRG[ >                                     
004250           MOVE     SPACE             TO  hjnOOP|}      
004260     END-EVALUATE.                                                
004270 ϊR|dwhs.                                            
004280      EXIT.                                                       
004290*                                                                 
004300******************************************************************
004310*     ҏW                                                   *
004320******************************************************************
004330 ҏW                             SECTION.                    
004340 ҏW|rs`qs.                                            
004350*                                                                 
004360*----------------------------------------------------------------*
004370*                                                      *
004380*----------------------------------------------------------------*
004390        MOVE  SPACE                   TO  _񔄊|.       
004400        INITIALIZE                        _񔄊|.       
004410*                                                                 
004420*----------------------------------------------------------------*
004430*       ڕҏW                                             *
004440*----------------------------------------------------------------*
004450*--<    No.01 >                                                   
004460        MOVE  ksqebt|_ԍ  TO  cSPS|_ԍ.     
004470*--<    No.02 >                                                   
004480        MOVE  v|ó|          TO  cSPS|הԍ.     
004490*--<    No.03 >                                                   
004500        PERFORM ϊP.                                       
004510        MOVE   hjnOOP|VR[h                       
004520                                      TO  cSPS|R[h. 
004530*--<    No.04 >                                                   
004540        PERFORM ϊQ.                                       
004550        MOVE  hjnOOP|}      TO  cSPS|_R[h. 
004560*--<    No.05 >                                                   
004570	      MOVE  ksqebj|zʋz  TO  cSPS|zʋz.     
004580*--<    No.06 >		                                        
004590        MOVE  ksqebj|      TO  cSPS|.         
004600*--<    No.07 >		                                        
004610	      MOVE  ksqebt|  TO  cSPS|.     
004620*--<    No.08 >		                                        
004630	      MOVE  ksqebt|ԓ  TO  cSPS|.         
004640*--<    No.09 >	                                                
004650	      MOVE  ksqebt|    TO  cSPS|.       
004660*--<    No.10 >		                                        
004670	      MOVE  ksqebt|    TO  cSPS|.       
004680*--<    No.11 >		                                        
004690	      MOVE  ksqebt|萔                            
004700                                      TO  cSPS|旧萔. 
004710*--<    No.12 >	       	                                        
004720	      MOVE  ksqebt|萔œz                  
004730                                      TO                          
004740                                  cSPS|旧萔Ŋz. 
004750*--<    No.13 >		                                        
004760	      MOVE  ksqebt|z  TO  cSPS|z.   
004770*--<    No.14 >		                                        
004780	      MOVE  vr|Г敪      TO  cSPS|Г敪. 
004790*--<    No.15 >		                                        
004800	      MOVE  ksqebj|Г  TO  cSPS|Г.     
004810*--<    No.16 >	                                                
004820	      MOVE  vr|N          TO  cSPS|N.     
004830*--<    No.17 >		                                        
004840	      MOVE  ksqebj|ev    TO  cSPS|e.         
004850*--<    No.18 >                                                   
004860        PERFORM ϊR.                                       
004870	      MOVE  hjnOOP|}      TO  cSPS|R[h. 
004880*--<    No.19 >		                                        
004890        MOVE  ksqebj|Г  TO                          
004900                                        cSPS|Г|. 
004910*--<    No.20 >		                                        
004920	      MOVE  ksqebj|ev    TO  cSPS|e|.   
004930*--<    No.21 >		                                        
004940	      MOVE  ksqebt|Oٓ                          
004950                                      TO  cSPS|Oϓ. 
004960*--<    No.22 >		                                        
004970	      MOVE  vr|          TO  cSPS|.     
004980*--<    No.23 >		                                        
004990	      MOVE  vr|敪  TO                          
005000                                      cSPS|敪. 
005010*--<    No.24 >	                                                
005020	      MOVE   v|VXet       TO  cSPS|XVN.   
005030*--<    No.25 >	       	                                        
005040	      MOVE   v|VXe       TO  cSPS|XV.     
005050*--<    No.26 >	                                                
005060	      MOVE   v|S             TO  cSPS|XV.       
005070*--<    No.27 >	 	                                        
005080	      MOVE   v|S             TO                          
005090                                      cSPS|͒S҃R[h. 
005100*--<    No.28 >		                                        
005110	      MOVE   v|VXet       TO  cSPS|o^N.   
005120*--<    No.29 >		                                        
005130	      MOVE   v|VXe       TO  cSPS|o^.     
005140*--<    No.30 >		                                        
005150	      MOVE   v|S             TO  cSPS|o^S.   
005160*                                                                 
005190 ҏWo͏|dwhs.                                          
005200     EXIT.                                                        
005210******************************************************************
005220*    o͏                                                    *
005230******************************************************************
005240 o͏                             SECTION.                    
005250 o͏|rs`qs.                                            
005260*                                                                 
005270       
      *      EXEC  SQL                                                  
005280*       INSERT  INTO  D414USM_TBL                                 
005290*          ( _ԍ                                             
005300*           ,הԍ                                             
005310*           ,R[h                                         
005320*           ,_R[h                                         
005330*           ,zʋz                                             
005340*           ,                                                 
005350*           ,                                             
005360*           ,                                                 
005370*           ,                                               
005380*           ,                                               
005390*           ,旧萔                                         
005400* 	  ,旧萔Ŋz                                 
005410* 	  ,z                                           
005420* 	  ,Г敪                                         
005430* 	  ,Г                                             
005440* 	  ,N                                             
005450* 	  ,e                                                 
005460* 	  ,R[h                                         
005470* 	  ,Г_                                        
005480* 	  ,e_                                            
005490* 	  ,Oϓ                                         
005500* 	  ,                                             
005510* 	  ,敪                                     
005520*           ,XVN                                           
005530*           ,XV                                             
005540*           ,XV                                               
005550*           ,͒S҃R[h                                     
005560*           ,o^N                                           
005570*           ,o^                                             
005580*           ,o^S)                                          
005590*      VALUES                                                     
005600*          ( :cSPS|_ԍ                                  
005610*           ,:cSPS|הԍ                                  
005620*           ,:cSPS|R[h                              
005630*           ,:cSPS|_R[h                              
005640*           ,:cSPS|zʋz                                  
005650* 	  ,:cSPS|                                      
005660* 	  ,:cSPS|                                  
005670* 	  ,:cSPS|                                      
005680* 	  ,:cSPS|                                    
005690* 	  ,:cSPS|                                    
005700* 	  ,:cSPS|旧萔                              
005710* 	  ,:cSPS|旧萔Ŋz                      
005720* 	  ,:cSPS|z                                
005730* 	  ,:cSPS|Г敪                              
005740* 	  ,:cSPS|Г                                  
005750* 	  ,:cSPS|N                                  
005760* 	  ,:cSPS|e                                      
005770* 	  ,:cSPS|R[h                              
005780* 	  ,:cSPS|Г|                            
005790* 	  ,:cSPS|e|                                
005800* 	  ,:cSPS|Oϓ                              
005810* 	  ,:cSPS|                                  
005820* 	  ,:cSPS|敪                          
005830* 	  ,:cSPS|XVN                                
005840* 	  ,:cSPS|XV                                  
005850* 	  ,:cSPS|XV                                    
005860* 	  ,:cSPS|͒S҃R[h                          
005870* 	  ,:cSPS|o^N                                
005880* 	  ,:cSPS|o^                                  
005890*           ,:cSPS|o^S)                               
005900*    END-EXEC.
             CALL "SQLADR" USING SQ0005 SQL-STMT
             MOVE 1 TO SQL-ITERS
             MOVE 234 TO SQL-OFFSET
             MOVE 0 TO SQL-OCCURS
             CALL "SQLADR" USING
                 SQLCUD
                 SQL-CUD
             CALL "SQLADR" USING
                 SQLCA
                 SQL-SQLEST
             MOVE 256 TO SQL-SQLETY
             CALL "SQLADR" USING
                 cSPS|_ԍ IN
                 _񔄊|
                 SQL-SQHSTV(1)
             MOVE 10 TO SQL-SQHSTL(1)
             MOVE 0 TO SQL-SQHSTS(1)
             MOVE 0 TO SQL-SQINDV(1)
             MOVE 0 TO SQL-SQINDS(1)
             MOVE 0 TO SQL-SQHARM(1)
             CALL "SQLADR" USING
                 cSPS|הԍ IN
                 _񔄊|
                 SQL-SQHSTV(2)
             MOVE 2 TO SQL-SQHSTL(2)
             MOVE 0 TO SQL-SQHSTS(2)
             MOVE 0 TO SQL-SQINDV(2)
             MOVE 0 TO SQL-SQINDS(2)
             MOVE 0 TO SQL-SQHARM(2)
             CALL "SQLADR" USING
                 cSPS|R[h IN
                 _񔄊|
                 SQL-SQHSTV(3)
             MOVE 9 TO SQL-SQHSTL(3)
             MOVE 0 TO SQL-SQHSTS(3)
             MOVE 0 TO SQL-SQINDV(3)
             MOVE 0 TO SQL-SQINDS(3)
             MOVE 0 TO SQL-SQHARM(3)
             CALL "SQLADR" USING
                 cSPS|_R[h IN
                 _񔄊|
                 SQL-SQHSTV(4)
             MOVE 5 TO SQL-SQHSTL(4)
             MOVE 0 TO SQL-SQHSTS(4)
             MOVE 0 TO SQL-SQINDV(4)
             MOVE 0 TO SQL-SQINDS(4)
             MOVE 0 TO SQL-SQHARM(4)
             CALL "SQLADR" USING
                 cSPS|zʋz IN
                 _񔄊|
                 SQL-SQHSTV(5)
             MOVE 7 TO SQL-SQHSTL(5)
             MOVE 0 TO SQL-SQHSTS(5)
             MOVE 0 TO SQL-SQINDV(5)
             MOVE 0 TO SQL-SQINDS(5)
             MOVE 0 TO SQL-SQHARM(5)
             CALL "SQLADR" USING
                 cSPS| IN
                 _񔄊|
                 SQL-SQHSTV(6)
             MOVE 8 TO SQL-SQHSTL(6)
             MOVE 0 TO SQL-SQHSTS(6)
             MOVE 0 TO SQL-SQINDV(6)
             MOVE 0 TO SQL-SQINDS(6)
             MOVE 0 TO SQL-SQHARM(6)
             CALL "SQLADR" USING
                 cSPS| IN
                 _񔄊|
                 SQL-SQHSTV(7)
             MOVE 8 TO SQL-SQHSTL(7)
             MOVE 0 TO SQL-SQHSTS(7)
             MOVE 0 TO SQL-SQINDV(7)
             MOVE 0 TO SQL-SQINDS(7)
             MOVE 0 TO SQL-SQHARM(7)
             CALL "SQLADR" USING
                 cSPS| IN
                 _񔄊|
                 SQL-SQHSTV(8)
             MOVE 2 TO SQL-SQHSTL(8)
             MOVE 0 TO SQL-SQHSTS(8)
             MOVE 0 TO SQL-SQINDV(8)
             MOVE 0 TO SQL-SQINDS(8)
             MOVE 0 TO SQL-SQHARM(8)
             CALL "SQLADR" USING
                 cSPS| IN
                 _񔄊|
                 SQL-SQHSTV(9)
             MOVE 6 TO SQL-SQHSTL(9)
             MOVE 0 TO SQL-SQHSTS(9)
             MOVE 0 TO SQL-SQINDV(9)
             MOVE 0 TO SQL-SQINDS(9)
             MOVE 0 TO SQL-SQHARM(9)
             CALL "SQLADR" USING
                 cSPS| IN
                 _񔄊|
                 SQL-SQHSTV(10)
             MOVE 7 TO SQL-SQHSTL(10)
             MOVE 0 TO SQL-SQHSTS(10)
             MOVE 0 TO SQL-SQINDV(10)
             MOVE 0 TO SQL-SQINDS(10)
             MOVE 0 TO SQL-SQHARM(10)
             CALL "SQLADR" USING
                 cSPS|旧萔 IN
                 _񔄊|
                 SQL-SQHSTV(11)
             MOVE 7 TO SQL-SQHSTL(11)
             MOVE 0 TO SQL-SQHSTS(11)
             MOVE 0 TO SQL-SQINDV(11)
             MOVE 0 TO SQL-SQINDS(11)
             MOVE 0 TO SQL-SQHARM(11)
             CALL "SQLADR" USING
                 cSPS|旧萔Ŋz IN
                 _񔄊|
                 SQL-SQHSTV(12)
             MOVE 7 TO SQL-SQHSTL(12)
             MOVE 0 TO SQL-SQHSTS(12)
             MOVE 0 TO SQL-SQINDV(12)
             MOVE 0 TO SQL-SQINDS(12)
             MOVE 0 TO SQL-SQHARM(12)
             CALL "SQLADR" USING
                 cSPS|z IN
                 _񔄊|
                 SQL-SQHSTV(13)
             MOVE 7 TO SQL-SQHSTL(13)
             MOVE 0 TO SQL-SQHSTS(13)
             MOVE 0 TO SQL-SQINDV(13)
             MOVE 0 TO SQL-SQINDS(13)
             MOVE 0 TO SQL-SQHARM(13)
             CALL "SQLADR" USING
                 cSPS|Г敪 IN
                 _񔄊|
                 SQL-SQHSTV(14)
             MOVE 1 TO SQL-SQHSTL(14)
             MOVE 0 TO SQL-SQHSTS(14)
             MOVE 0 TO SQL-SQINDV(14)
             MOVE 0 TO SQL-SQINDS(14)
             MOVE 0 TO SQL-SQHARM(14)
             CALL "SQLADR" USING
                 cSPS|Г IN
                 _񔄊|
                 SQL-SQHSTV(15)
             MOVE 6 TO SQL-SQHSTL(15)
             MOVE 0 TO SQL-SQHSTS(15)
             MOVE 0 TO SQL-SQINDV(15)
             MOVE 0 TO SQL-SQINDS(15)
             MOVE 0 TO SQL-SQHARM(15)
             CALL "SQLADR" USING
                 cSPS|N IN
                 _񔄊|
                 SQL-SQHSTV(16)
             MOVE 6 TO SQL-SQHSTL(16)
             MOVE 0 TO SQL-SQHSTS(16)
             MOVE 0 TO SQL-SQINDV(16)
             MOVE 0 TO SQL-SQINDS(16)
             MOVE 0 TO SQL-SQHARM(16)
             CALL "SQLADR" USING
                 cSPS|e IN
                 _񔄊|
                 SQL-SQHSTV(17)
             MOVE 7 TO SQL-SQHSTL(17)
             MOVE 0 TO SQL-SQHSTS(17)
             MOVE 0 TO SQL-SQINDV(17)
             MOVE 0 TO SQL-SQINDS(17)
             MOVE 0 TO SQL-SQHARM(17)
             CALL "SQLADR" USING
                 cSPS|R[h IN
                 _񔄊|
                 SQL-SQHSTV(18)
             MOVE 5 TO SQL-SQHSTL(18)
             MOVE 0 TO SQL-SQHSTS(18)
             MOVE 0 TO SQL-SQINDV(18)
             MOVE 0 TO SQL-SQINDS(18)
             MOVE 0 TO SQL-SQHARM(18)
             CALL "SQLADR" USING
                 cSPS|Г| IN
                 _񔄊|
                 SQL-SQHSTV(19)
             MOVE 6 TO SQL-SQHSTL(19)
             MOVE 0 TO SQL-SQHSTS(19)
             MOVE 0 TO SQL-SQINDV(19)
             MOVE 0 TO SQL-SQINDS(19)
             MOVE 0 TO SQL-SQHARM(19)
             CALL "SQLADR" USING
                 cSPS|e| IN
                 _񔄊|
                 SQL-SQHSTV(20)
             MOVE 7 TO SQL-SQHSTL(20)
             MOVE 0 TO SQL-SQHSTS(20)
             MOVE 0 TO SQL-SQINDV(20)
             MOVE 0 TO SQL-SQINDS(20)
             MOVE 0 TO SQL-SQHARM(20)
             CALL "SQLADR" USING
                 cSPS|Oϓ IN
                 _񔄊|
                 SQL-SQHSTV(21)
             MOVE 8 TO SQL-SQHSTL(21)
             MOVE 0 TO SQL-SQHSTS(21)
             MOVE 0 TO SQL-SQINDV(21)
             MOVE 0 TO SQL-SQINDS(21)
             MOVE 0 TO SQL-SQHARM(21)
             CALL "SQLADR" USING
                 cSPS| IN
                 _񔄊|
                 SQL-SQHSTV(22)
             MOVE 10 TO SQL-SQHSTL(22)
             MOVE 0 TO SQL-SQHSTS(22)
             MOVE 0 TO SQL-SQINDV(22)
             MOVE 0 TO SQL-SQINDS(22)
             MOVE 0 TO SQL-SQHARM(22)
             CALL "SQLADR" USING
                 cSPS|敪 IN
                 _񔄊|
                 SQL-SQHSTV(23)
             MOVE 1 TO SQL-SQHSTL(23)
             MOVE 0 TO SQL-SQHSTS(23)
             MOVE 0 TO SQL-SQINDV(23)
             MOVE 0 TO SQL-SQINDS(23)
             MOVE 0 TO SQL-SQHARM(23)
             CALL "SQLADR" USING
                 cSPS|XVN IN
                 _񔄊|
                 SQL-SQHSTV(24)
             MOVE 8 TO SQL-SQHSTL(24)
             MOVE 0 TO SQL-SQHSTS(24)
             MOVE 0 TO SQL-SQINDV(24)
             MOVE 0 TO SQL-SQINDS(24)
             MOVE 0 TO SQL-SQHARM(24)
             CALL "SQLADR" USING
                 cSPS|XV IN
                 _񔄊|
                 SQL-SQHSTV(25)
             MOVE 8 TO SQL-SQHSTL(25)
             MOVE 0 TO SQL-SQHSTS(25)
             MOVE 0 TO SQL-SQINDV(25)
             MOVE 0 TO SQL-SQINDS(25)
             MOVE 0 TO SQL-SQHARM(25)
             CALL "SQLADR" USING
                 cSPS|XV IN
                 _񔄊|
                 SQL-SQHSTV(26)
             MOVE 8 TO SQL-SQHSTL(26)
             MOVE 0 TO SQL-SQHSTS(26)
             MOVE 0 TO SQL-SQINDV(26)
             MOVE 0 TO SQL-SQINDS(26)
             MOVE 0 TO SQL-SQHARM(26)
             CALL "SQLADR" USING
                 cSPS|͒S҃R[h IN
                 _񔄊|
                 SQL-SQHSTV(27)
             MOVE 8 TO SQL-SQHSTL(27)
             MOVE 0 TO SQL-SQHSTS(27)
             MOVE 0 TO SQL-SQINDV(27)
             MOVE 0 TO SQL-SQINDS(27)
             MOVE 0 TO SQL-SQHARM(27)
             CALL "SQLADR" USING
                 cSPS|o^N IN
                 _񔄊|
                 SQL-SQHSTV(28)
             MOVE 8 TO SQL-SQHSTL(28)
             MOVE 0 TO SQL-SQHSTS(28)
             MOVE 0 TO SQL-SQINDV(28)
             MOVE 0 TO SQL-SQINDS(28)
             MOVE 0 TO SQL-SQHARM(28)
             CALL "SQLADR" USING
                 cSPS|o^ IN
                 _񔄊|
                 SQL-SQHSTV(29)
             MOVE 8 TO SQL-SQHSTL(29)
             MOVE 0 TO SQL-SQHSTS(29)
             MOVE 0 TO SQL-SQINDV(29)
             MOVE 0 TO SQL-SQINDS(29)
             MOVE 0 TO SQL-SQHARM(29)
             CALL "SQLADR" USING
                 cSPS|o^S IN
                 _񔄊|
                 SQL-SQHSTV(30)
             MOVE 8 TO SQL-SQHSTL(30)
             MOVE 0 TO SQL-SQHSTS(30)
             MOVE 0 TO SQL-SQINDV(30)
             MOVE 0 TO SQL-SQINDS(30)
             MOVE 0 TO SQL-SQHARM(30)
             CALL "SQLADR" USING
                 SQL-SQHSTV(1)
                 SQL-SQPHSV
             CALL "SQLADR" USING
                 SQL-SQHSTL(1)
                 SQL-SQPHSL
             CALL "SQLADR" USING
                 SQL-SQHSTS(1)
                 SQL-SQPHSS
             CALL "SQLADR" USING
                 SQL-SQINDV(1)
                 SQL-SQPIND
             CALL "SQLADR" USING
                 SQL-SQINDS(1)
                 SQL-SQPINS
             CALL "SQLADR" USING
                 SQL-SQHARM(1)
                 SQL-SQPARM
             CALL "SQLADR" USING
                 SQL-SQHARC(1)
                 SQL-SQPARC

             CALL "SQLBEX" USING
                 SQLCTX
                 SQLEXD
                 SQLFPN

             CALL "SQLGSS" USING
                SQLSTATE
                 .
005910*                                                                 
005920*----------------------------------------------------------------*
005930*    ǉmF                                              *
005940*----------------------------------------------------------------*
005950     EVALUATE  SQLCODE                                            
005960        WHEN   萔|rpknj                                   
005970*--<       ǉ >                                             
005980           COMPUTE  v|ó|    =  v|ó|  +  1     
005990        WHEN   OTHER                                              
006000*--<       ǉG[ >                                       
006010           MOVE     -4                TO  v|G[R[h        
006020           PERFORM  G[                                    
006030     END-EVALUATE.                                                
006040*                                                                 
006050 o͏|dwhs.                                              
006060     EXIT.                                                        
006070*                                                                 
006080******************************************************************
006090*    I                                                    *
006100******************************************************************
006110 I                             SECTION.                    
006120 I|rs`qs.                                            
006130*                                                                 
006140*----------------------------------------------------------------*
006150*    caN[Y                                            *
006160*----------------------------------------------------------------*
006170     PERFORM caN[Y.                                    
006180*----------------------------------------------------------------*
006190*    caR~bg                                             
006200*----------------------------------------------------------------*
006210     PERFORM  caR~bg                                    
006220*----------------------------------------------------------------*
006230*    bZ[Wo͏                                      *
006240*----------------------------------------------------------------*
006250     PERFORM  bZ[Wo.                                 
006260*----------------------------------------------------------------*
006270*    IbZ[Wo͏                                      *
006280*----------------------------------------------------------------*
006290     PERFORM  IbZ[Wo.                                 
006300*                                                                 
006310*--< vOI >                                         
006320     MOVE  萔|             TO  PROGRAM-STATUS.         
006330*                                                                 
006340 I|dwhs.                                              
006350     EXIT.                                                        
006360******************************************************************
006370*    bZ[Wo͏                                      *
006380******************************************************************
006390 bZ[Wo                   SECTION.                    
006400 bZ[Wó|rs`qs.                                  
006410*                                                                 
006420     INITIALIZE                       IF-CHOCO001.                
006430     MOVE  "3"                        TO  P|Cxg.     
006440     MOVE  萔|vOhc       TO  P|\[Xhc.       
006450     MOVE  "0"                        TO  P|AR[h.       
006460     MOVE  "LTRFCU"                   TO  P|e[uhc. 
006470     MOVE  "COUNT"                    TO  P|.         
006480     MOVE  v|́|             TO  P|f[^e.       
006490     MOVE  "SUMMIŢݸޔ|Ǎ"                       
006500                                      TO  P|̑bZ[W. 
006510     CALL  CLOCO001                USING  IF-CHOCO001.            
006520*                                                                 
006530     INITIALIZE                       IF-CHOCO001.                
006540     MOVE  "3"                        TO  P|Cxg.     
006550     MOVE  萔|vOhc       TO  P|\[Xhc.       
006560     MOVE  "0"                        TO  P|AR[h.       
006570     MOVE  "LTRFCK"                   TO  P|e[uhc. 
006580     MOVE  "COUNT"                    TO  P|.         
006590     MOVE  v|́|             TO  P|f[^e.       
006600     MOVE  "SUMMIŢݸފ{Ǎ"                       
006610                                      TO  P|̑bZ[W. 
006620     CALL  CLOCO001                USING  IF-CHOCO001.            
006630*                                                                 
006640     INITIALIZE                       IF-CHOCO001.                
006650     MOVE  "3"                        TO  P|Cxg.     
006660     MOVE  萔|vOhc       TO  P|\[Xhc.       
006670     MOVE  "0"                        TO  P|AR[h.       
006680     MOVE  "D414USM"                  TO  P|e[uhc. 
006690     MOVE  "COUNT"                    TO  P|.         
006700     MOVE  v|ó|             TO  P|f[^e.       
006710     MOVE  "_񔄊|דo^"                             
006720                                      TO  P|̑bZ[W. 
006730     CALL  CLOCO001                USING  IF-CHOCO001.            
006740*                                                                 
006750 bZ[Wó|dwhs.                                    
006760     EXIT.                                                        
006770*                                                                 
006780******************************************************************
006790*    IbZ[Wo͏                                      *
006800******************************************************************
006810 IbZ[Wo                   SECTION.                    
006820 IbZ[Wó|rs`qs.                                  
006830*                                                                 
006840     INITIALIZE                       IF-CHOCO001.                
006850     MOVE  "3"                        TO  P|Cxg.     
006860     MOVE  萔|vOhc       TO  P|\[Xhc.       
006870     MOVE  "0"                        TO  P|AR[h.       
006880     MOVE  "END"                      TO  P|.         
006890     MOVE  萔|vO         TO  P|̑bZ[W. 
006900     CALL  CLOCO001                USING  IF-CHOCO001.            
006910*                                                                 
006920 IbZ[Wó|dwhs.                                    
006930     EXIT.                                                        
006940*                                                                 
006950******************************************************************
006960*    caN[Y                                                *
006970******************************************************************
006980 caN[Y                     SECTION.                    
006990 caN[Y|rs`qs.                                    
007000*                                                                 
007010*--< J[\ N[Y >                                          
007020     
      *    EXEC SQL                                                     
007030*       CLOSE  CUR1                                               
007040*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 369 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007050*                                                                 
007060 caN[Y|dwhs.                                      
007070     EXIT.                                                        
007080******************************************************************
007090*    caR~bg                                            *
007100******************************************************************
007110 caR~bg                     SECTION.                    
007120 caR~bg|rs`qs.                                    
007130*                                                                 
007140     
      *    EXEC  SQL                                                    
007150*       COMMIT  WORK  RELEASE                                     
007160*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 384 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007170*                                                                 
007180     INITIALIZE                       IF-CHOCO001.                
007190     MOVE  "3"                        TO  P|Cxg.     
007200     MOVE  萔|vOhc       TO  P|\[Xhc.       
007210     MOVE  "0"                        TO  P|AR[h.       
007220     MOVE  "COMMIT"                   TO  P|.         
007230     MOVE  "R~bg{"             TO  P|̑bZ[W. 
007240     CALL  CLOCO001                USING  IF-CHOCO001.            
007250*                                                                 
007260 caR~bg|dwhs.                                      
007270     EXIT.                                                        
007280******************************************************************
007290*    ca[obN                                        *
007300******************************************************************
007310 ca[obN                 SECTION.                    
007320 ca[obN|rs`qs.                                
007330*                                                                 
007340     
      *    EXEC  SQL                                                    
007350*       ROLLBACK WORK  RELEASE                                    
007360*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 399 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
007370*                                                                 
007380     INITIALIZE                       IF-CHOCO001.                
007390     MOVE  "1"                        TO  P|Cxg.     
007400     MOVE  萔|vOhc       TO  P|\[Xhc.       
007410     MOVE  "9"                        TO  P|AR[h.       
007420     MOVE  "ROLLBACK"                 TO  P|.         
007430     MOVE  "[obN{"         TO  P|̑bZ[W. 
007440     CALL  CLOCO001                USING  IF-CHOCO001.            
007450*                                                                 
007460 ca[obN|dwhs.                                  
007470     EXIT.                                                        
007480
007490******************************************************************
007500*    G[                                                  *
007510******************************************************************
007520 G[                           SECTION.                    
007530 G[|rs`qs.                                          
007540*                                                                 
007550     MOVE  "Y"                        TO  v|ُI|tO.   
007560     INITIALIZE                       IF-CHOCO001.                
007570*                                                                 
007580     EVALUATE  v|G[R[h                                   
007590        WHEN  -1                                                  
007600*--<       nq`bkdڑs >                                 
007610           MOVE  "1"                  TO  P|Cxg      
007620           MOVE  萔|vOhc TO  P|\[Xhc        
007630           MOVE  "9"                  TO  P|AR[h        
007640           MOVE  "CONNECT"            TO  P|          
007650           MOVE  SQLCODE              TO  P|f[^e        
007660           MOVE  SQLERRMC             TO  P|̑bZ[W  
007670           CALL  CLOCO001          USING  IF-CHOCO001             
007680*                                                                 
007690        WHEN  -2                                                  
007700*--<       J[\I[vG[  >                              
007710           MOVE  "1"                  TO  P|Cxg      
007720           MOVE  萔|vOhc TO  P|\[Xhc        
007730           MOVE  "9"                  TO  P|AR[h        
007740           MOVE  "LTRFCU"             TO  P|e[uhc  
007750           MOVE  "OPEN"               TO  P|          
007760           MOVE  SQLCODE              TO  P|f[^e        
007770           MOVE  SQLERRMC             TO  P|̑bZ[W  
007780           CALL  CLOCO001          USING  IF-CHOCO001             
007790*                                                                 
007800        WHEN  -3                                                  
007810*--<       e[uJ[\ǍG[ >                       
007820           MOVE  "1"                  TO  P|Cxg      
007830           MOVE  萔|vOhc TO  P|\[Xhc        
007840           MOVE  "9"                  TO  P|AR[h        
007850           MOVE  SQLCODE              TO  P|e[uhc  
007860           MOVE  "SELECT"             TO  P|          
007870           MOVE  SQLCODE              TO  P|f[^e        
007880           MOVE  SQLERRMC             TO  P|̑bZ[W  
007890           CALL  CLOCO001          USING  IF-CHOCO001             
007900*                                                                 
007910        WHEN  -4                                                  
007920*--<       ǉG[  >                                      
007930           MOVE  "1"                  TO  P|Cxg      
007940           MOVE  萔|vOhc TO  P|\[Xhc        
007950           MOVE  "9"                  TO  P|AR[h        
007960           MOVE  "D414USM"            TO  P|e[uhc  
007970           MOVE  "INSERT"             TO  P|          
007980           MOVE  SQLCODE              TO  P|f[^e        
007990           MOVE  SQLERRMC             TO  P|̑bZ[W  
008000           CALL  CLOCO001          USING  IF-CHOCO001             
008010*                                                                 
008020        WHEN  OTHER                                               
008030           MOVE  "N"                  TO  v|ُI|tO    
008040     END-EVALUATE.                                                
008050*                                                                 
008060     IF  v|ُI|tO =  "Y"                              
008070*--<    bZ[Wo >                                      
008080        PERFORM  bZ[Wo                               
008090*--<    IbZ[Wo͏ >                                  
008100        PERFORM  IbZ[Wo                               
008110*--<    vO^[R[h >                                
008120        MOVE  萔|ُ          TO  PROGRAM-STATUS          
008130        EXIT  PROGRAM                                             
008140     END-IF.                                                      
008150*                                                                 
008160 G[|dwhs.                                            
008170     EXIT.                                                        
008180******************************************************************
008190*                  END OF PROGRAM                                *
008200******************************************************************
