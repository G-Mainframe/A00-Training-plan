000010******************************************************************
000020*         ＜海輝軟件(大連)＞                                     *
000030*      1. プログラム名  : 管理与信契約移行処理                   *
000040*      2. プログラムID  : COBIS660                               *
000050*      3. 処理概要      : ①与信(基本・明細)を全件対象として与信 *
000060*                          (明細)単位に管理与信契約を作成        *
000070*                         ②債権より消費税率を取得する。         *
000080*                         ③否認に登録された契約であるか否かを   *
000090*                            契約内容より取得する。              *
000100*      4. 作成者        : 徐宝君                                 *
000110*      5. 作成日        : 2005.4.1                               *
000120******************************************************************
000130*                                                                 
000140******************************************************************
000150*    ＩＤＥＮＴＩＦＩＣＡＴＩＯＮ  ＤＩＶＩＳＩＯＮ              *
000160******************************************************************
000170 IDENTIFICATION                       DIVISION.                   
000180*                                                                 
000190 PROGRAM-ID.                          COBIS660.                   
000200******************************************************************
000210*    ＥＮＶＩＲＯＮＭＥＮＴ        ＤＩＶＩＳＩＯＮ              *
000220******************************************************************
000230 ENVIRONMENT                          DIVISION.                   
000240******************************************************************
000250*    INPUT-OUTPUT                     SECTION                    *
000260******************************************************************
000270 INPUT-OUTPUT                          SECTION.                   
000280*                                                                 
000290 FILE-CONTROL.                                                    
000300     SELECT  出カファイル       ASSIGN     TO       U11           
000310     FILE    STATUS         IS         Ｗ－状態                   
000320     ORGANIZATION           IS         LINE        SEQUENTIAL.    
000330******************************************************************
000340*    ＤＡＴＡ                      ＤＩＶＩＳＩＯＮ              *
000350******************************************************************
000360 DATA                                 DIVISION.                   
000370******************************************************************
000380*            出カファイル                                        *
000390******************************************************************
000400 FILE                                 SECTION.                    
000410 FD  出カファイル                                                 
000420     LABEL     RECORD     IS          STANDARD                    
000430     BLOCK     CONTAINS   0           RECORDS.                    
000440*                                                                 
000450 01  出カーレコード.                                              
000460     COPY   CISUF660   REPLACING   ==()==  BY  ==出カー==.        
000470******************************************************************
000480*  ＷＯＲＫＩＮＧ－ＳＴＯＲＡＧＥ  ＳＥＣＴＩＯＮ                *
000490******************************************************************
000500  WORKING-STORAGE                     SECTION.                    
000510*----------------------------------------------------------------*
000520*    ホスト変数定義エリア                                        *
000530*----------------------------------------------------------------*
000540     
       01  SQLFPN GLOBAL.
           02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +12.
           02  SQLFPN-FILENAME PIC X(12) VALUE "COBIS660.PCO".

       01  SQ0002 GLOBAL.
           02  FILLER PIC X(109) VALUE "select 新取引先コード  ,取引先コ
      -    "ード   into :b1,:b2  from IKOTBL001 where (取引先コード=:b1 
      -    "and 目的ＣＤ='2')".

       01  SQ0003 GLOBAL.
           02  FILLER PIC X(101) VALUE "select max(再リース回数)   into 
      -    ":b1  from IKOTBL002 where (契約ＮＯ=:b2 and 旧債権勘定処理コ
      -    "ード=:b3)".

       01  SQ0004 GLOBAL.
           02  FILLER PIC X(107) VALUE  "select min(契約種類)  ,主契約区
      -    "分   into :b1,:b2  from IKOTBL002 where 再リース回数=:b3 gro
      -    "up by 主契約区分".

       01  SQ0005 GLOBAL.
           02  FILLER PIC X(80) VALUE "select 枝番   into :b1  from IKOT
      -    "BL001 where (取引先コード=:b2 and 目的ＣＤ='2')".

       01  SQ0006 GLOBAL.
           02  FILLER PIC X(100) VALUE "select 契約件名  ,否認区分   int
      -     "o :b1,:b2  from D31KYK_TBL where (契約番号=:b3 and 再リース
      -    "回数=:b4)".

       01  SQ0007 GLOBAL.
           02  FILLER PIC X(110) VALUE "select 最新消費税区分   into :b1
      -    "  from D32SAK_TBL where ((契約番号=:b2 and 再リース回数=:b3)
      -    " and 契約種類=:b4)".

       01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +288069.


       01  SQLEXD GLOBAL.
           02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
           02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +41.
           02  SQL-ITERS    PIC S9(9) COMP-5.
           02  SQL-OFFSET   PIC S9(9) COMP-5.
           02  SQL-SELERR   PIC S9(4) COMP-5.
           02  SQL-SQLETY   PIC S9(4) COMP-5.
           02  SQL-OCCURS   PIC S9(9) COMP-5.
           02  SQL-CUD      PIC S9(9) COMP-5.
           02  SQL-SQLEST   PIC S9(9) COMP-5.
           02  SQL-STMT     PIC S9(9) COMP-5.
           02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
           02  SQL-SQPHSV   PIC S9(9) COMP-5.
           02  SQL-SQPHSL   PIC S9(9) COMP-5.
           02  SQL-SQPHSS   PIC S9(9) COMP-5.
           02  SQL-SQPIND   PIC S9(9) COMP-5.
           02  SQL-SQPINS   PIC S9(9) COMP-5.
           02  SQL-SQPARM   PIC S9(9) COMP-5.
           02  SQL-SQPARC   PIC S9(9) COMP-5.
           02  SQL-SQPADTO  PIC S9(9) COMP-5.
           02  SQL-SQPTDSO  PIC S9(9) COMP-5.
           02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 41 TIMES.
           02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 41 TIMES.
           02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 41 TIMES.
           02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 41 TIMES.
           02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 41 TIMES.
           02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 41 TIMES.
           02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 41 TIMES.
           02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 41 TIMES.
           02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 41 TIMES.


       01  SQ0001 GLOBAL.
           02  FILLER PIC X(160) VALUE  "select NVL(YOSHINKIHON.管理与信
      -    "先コード,RPAD(' ',8,' '))  ,YOSHINMEISAI.契約ＮＯ  ,YOSHINME
      -     "ISAI.勘定コード  ,YOSHINMEISAI.事業所コード  ,YOSHINMEISAI.
      -    "事故日  ,Y".

           02  FILLER PIC X(160) VALUE "OSHINMEISAI.契約日  ,YOSHINMEISA
      -    "I.検収日  ,YOSHINMEISAI.満了日  ,YOSHINMEISAI.当債権残  ,YOS
      -    "HINMEISAI.貸付金別口  ,YOSHINMEISAI.非稼動資産  ,YOSHINMEISA
      -    "I.貯蔵品".

           02  FILLER PIC X(160) VALUE "  ,YOSHINMEISAI.信用保険付保区分
      -    "  ,YOSHINMEISAI.信用保険求償  ,YOSHINMEISAI.契約金額  ,YOSHI
      -    "NMEISAI.入金日  ,YOSHINMEISAI.開始回数  ,YOSHINMEISAI.明細支
      -    "払回数  ".

           02  FILLER PIC X(160) VALUE ",YOSHINMEISAI.計算方式  ,YOSHINM
      -    "EISAI.請求サイクル  ,YOSHINMEISAI.延滞開始日  ,YOSHINMEISAI.
      -    "歯抜けフラグ１  ,YOSHINMEISAI.歯抜けフラグ２  ,YOSHINMEISAI.
      -    "ヤクベン".

           02  FILLER PIC X(160) VALUE "区分  ,YOSHINMEISAI.残価額  ,YOS
      -    "HINMEISAI.月割Ｌ料  ,YOSHINMEISAI.事故債権残  ,YOSHINMEISAI.
      -    "事故元本残  ,YOSHINMEISAI.当債権残  ,YOSHINMEISAI.当元本残  
      -    ",YOSHINM".

           02  FILLER PIC X(160) VALUE "EISAI.未収元本  ,YOSHINMEISAI.未
      -    "収利息  ,YOSHINMEISAI.未徴収金  ,YOSHINMEISAI.Ｂ未徴収金  ,Y
      -    "OSHINMEISAI.売却金額  ,YOSHINMEISAI.固定利率  ,YOSHINMEISAI.
      -    "金利変動".

           02  FILLER PIC X(160) VALUE "区分  ,YOSHINMEISAI.スプレッド  
      -    ",YOSHINMEISAI.連動金利区分  ,NVL(YOSHINKIHON.解約区分,RPAD('
      -    " ',1,' '))  ,YOSHINMEISAI.更新日付   from YOSHINMEISAI ,YOSH
      -     "INKIHON ".

           02  FILLER PIC X(160) VALUE "where (((YOSHINMEISAI.管理与信先
      -    "コード=YOSHINKIHON.管理与信先コード(+) and YOSHINMEISAI.管理
      -     "与信区分=YOSHINKIHON.管理与信区分(+)) and YOSHINMEISAI.自動
      -     "与信区分=".

           02  FILLER PIC X(86) VALUE "YOSHINKIHON.自動与信区分(+)) and 
      -    "YOSHINMEISAI.事故日=YOSHINKIHON.事故日(+))           ".

       01  SQL-RUNTIME-VARS.
           02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
           02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
           02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.

       01  SQLCUD GLOBAL.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +4192.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +222.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +36.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +27.
           02     FILLER PIC S9(4) COMP-5 VALUE +226.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +10.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +67.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +1366.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +9.
           02     FILLER PIC S9(4) COMP-5 VALUE +312.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +82.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +358.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +41.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +13.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +11.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +11.
           02     FILLER PIC S9(4) COMP-5 VALUE +8.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +261.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +109.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +507.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +288.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +101.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +540.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +315.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +107.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +569.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +342.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +5.
           02     FILLER PIC S9(4) COMP-5 VALUE +80.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +600.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +365.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +6.
           02     FILLER PIC S9(4) COMP-5 VALUE +100.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +629.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +396.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +110.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +661.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +4.
           02     FILLER PIC S9(4) COMP-5 VALUE +3.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +7.
           02     FILLER PIC S9(4) COMP-5 VALUE +2.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +96.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +427.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +15.
           02     FILLER PIC S9(4) COMP-5 VALUE +1027.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
           02     FILLER PIC S9(4) COMP-5 VALUE +1.
           02     FILLER PIC S9(4) COMP-5 VALUE +0.
      *    EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.
000550*--<管理与信先コード>                                             
000560 01  ＷＳ－管理与信先                 PIC     X(08).              
000570*                                                                 
000580*--< ＯＲＡＣＬＥ共通変数 >                                       
000590     
      *    EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.
000600*                                                                 
000610*--< ＯＲＡＣＬＥ  ＳＱＬ実行情報 >                               
000010*--＜ＳＱＬ共通変数＞
000030   01  SQLSTATE                      PIC  X(005).
       01  SQLSTATEA REDEFINES SQLSTATE.
           05  SQLSTATEB OCCURS 5 TIMES PIC X.
000040   01  DB-STRING                     PIC  X(020).
000050   01  USERNAME                      PIC  X(010).
000060   01  PASSWD                        PIC  X(010).
000070*
000620     
      *    EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.
       01  SQLCA GLOBAL.
           05  SQLCAID               PIC X(8).
           05  SQLCABC               PIC S9(9) COMP-5.
           05  SQLCODE               PIC S9(9) COMP-5.
           05  SQLERRM.
               49 SQLERRML           PIC S9(4) COMP-5.
               49 SQLERRMC           PIC X(70).
           05  SQLERRP               PIC X(8).
           05  SQLERRD OCCURS 6 TIMES
                                     PIC S9(9) COMP-5.
           05  SQLWARN.
               10 SQLWARN0           PIC X(1).
               10 SQLWARN1           PIC X(1).
               10 SQLWARN2           PIC X(1).
               10 SQLWARN3           PIC X(1).
               10 SQLWARN4           PIC X(1).
               10 SQLWARN5           PIC X(1).
               10 SQLWARN6           PIC X(1).
               10 SQLWARN7           PIC X(1).
           05  SQLEXT                PIC X(8).
000630*                                                                 
000640*--< 与信(基本)テーブル>                                          
000650     
      *    EXEC  SQL  INCLUDE  YOSHINKIHON.CBL       END-EXEC.
000660*                                                                 
000670*--<与信(明細)テーブル >                                          
000010************************************************
000020* 与信(基本)(YOSHINKIHON)
000030************************************************
000040 01  ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード  PIC  X(008).
000050 01  ＹＯＳＨＩＮＫＩＨＯＮ－管理与信区分  PIC  X(001).
000060 01  ＹＯＳＨＩＮＫＩＨＯＮ－自動与信区分  PIC  X(001).
000070 01  ＹＯＳＨＩＮＫＩＨＯＮ－事故日  PIC  X(008).
000080 01  ＹＯＳＨＩＮＫＩＨＯＮ－解約区分  PIC  X(001).
000090 01  ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先名  PIC  X(080).
000100 01  ＹＯＳＨＩＮＫＩＨＯＮ－有特勘積立  PIC S9(013) COMP-3.
000110 01  ＹＯＳＨＩＮＫＩＨＯＮ－無特勘積立  PIC S9(013) COMP-3.
000120 01  ＹＯＳＨＩＮＫＩＨＯＮ－ＸＹＺ区分  PIC  X(001).
000130 01  ＹＯＳＨＩＮＫＩＨＯＮ－文言１  PIC  X(112).
000140 01  ＹＯＳＨＩＮＫＩＨＯＮ－文言２  PIC  X(112).
000150 01  ＹＯＳＨＩＮＫＩＨＯＮ－文言３  PIC  X(112).
000160 01  ＹＯＳＨＩＮＫＩＨＯＮ－文言４  PIC  X(112).
000170 01  ＹＯＳＨＩＮＫＩＨＯＮ－文言５  PIC  X(112).
000180 01  ＹＯＳＨＩＮＫＩＨＯＮ－文言６  PIC  X(112).
000190 01  ＹＯＳＨＩＮＫＩＨＯＮ－担保１  PIC  X(010).
000200 01  ＹＯＳＨＩＮＫＩＨＯＮ－担保２  PIC  X(010).
000210 01  ＹＯＳＨＩＮＫＩＨＯＮ－担保３  PIC  X(010).
000680     
      *    EXEC  SQL  INCLUDE  YOSHINMEISAI.CBL      END-EXEC.
000690*                                                                 
000700*--<契約内容テーブル>                                             
000010************************************************
000020* 与信(明細)(YOSHINMEISAI)
000030************************************************
000040 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－管理与信先コード  PIC  X(008).
000050 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－管理与信区分  PIC  X(001).
000060 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－自動与信区分  PIC  X(001).
000070 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－事故日  PIC  X(008).
000080 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－契約ＮＯ  PIC  X(009).
000090 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－勘定コード  PIC  X(002).
000100 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－事業所コード  PIC  X(004).
000110 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－歯抜けフラグ１  PIC  X(002).
000120 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－歯抜けフラグ２  PIC  X(002).
000130 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－物件名  PIC  X(060).
000140 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－契約日  PIC  X(008).
000150 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－検収日  PIC  X(008).
000160 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－満了日  PIC  X(008).
000170 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－延滞開始日  PIC  X(008).
000180 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－貸付金別口  PIC S9(013) COMP-3.
000190 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－非稼動資産  PIC S9(013) COMP-3.
000200 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－貯蔵品  PIC S9(013) COMP-3.
000210 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－信用保険付保区分  PIC  X(001).
000220 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－信用保険求償  PIC S9(013) 
000230                                                     COMP-3.
000240 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－契約金額  PIC S9(013) COMP-3.
000250 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－残価額  PIC S9(013) COMP-3.
000260 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－入金日  PIC  X(002).
000270 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－開始回数  PIC  X(001).
000280 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－明細支払回数  PIC  X(003).
000290 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－計算方式  PIC  X(001).
000300 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－請求サイクル  PIC  X(002).
000310 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－月割Ｌ料  PIC S9(013) COMP-3.
000320 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－ヤクベン区分  PIC  X(001).
000330 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－事故債権残  PIC S9(013) COMP-3.
000340 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－事故元本残  PIC S9(013) COMP-3.
000350 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－当債権残  PIC S9(013) COMP-3.
000360 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－当元本残  PIC S9(013) COMP-3.
000370 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－Ｎ当債権残  PIC S9(013) COMP-3.
000380 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－Ｎ当元本残  PIC S9(013) COMP-3.
000390 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－未収元本  PIC S9(013) COMP-3.
000400 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－未収利息  PIC S9(013) COMP-3.
000410 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－未徴収金  PIC S9(013) COMP-3.
000420 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－Ｂ未徴収金  PIC S9(013) COMP-3.
000430 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－売却金額  PIC S9(013) COMP-3.
000440 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－更新日付  PIC  X(008).
000450 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－固定利率  PIC S9(003)V9(8) 
000460                                                    COMP-3.
000470 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－金利変動区分  PIC  X(001).
000480 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－スプレッド  PIC S9(003)V9(8) 
000490                                                    COMP-3.
000500 01  ＹＯＳＨＩＮＭＥＩＳＡＩ－連動金利区分  PIC  X(001).
000710     
      *    EXEC  SQL  INCLUDE  D31KYK.CBL            END-EXEC.
000720*--<債権テーブル>                                                 
      *****************************************************************
      *   契約内容(D31KYK_TBL)
      *****************************************************************
       01  契約内容.
           03  Ｄ３１－契約番号      PIC  X(010).
           03  Ｄ３１－再リース回数  PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－見積番号      PIC S9(007) PACKED-DECIMAL.
           03  Ｄ３１－見積番号枝番  PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－取引先コード  PIC  X(009).
           03  Ｄ３１－稟議決裁日    PIC  X(008).
           03  Ｄ３１－貸付実行予定日
                                     PIC  X(008).
           03  Ｄ３１－成約年月日    PIC  X(008).
           03  Ｄ３１－引渡年月日    PIC  X(008).
           03  Ｄ３１－契約開始日    PIC  X(008).
           03  Ｄ３１－契約終了日    PIC  X(008).
           03  Ｄ３１－期間          PIC S9(003) PACKED-DECIMAL.
           03  Ｄ３１－契約件名      PIC  X(060).
           03  Ｄ３１－エンドユーザコード
                                     PIC  X(009).
           03  Ｄ３１－契約区分      PIC  X(001).
           03  Ｄ３１－紹介ルート    PIC  X(001).
           03  Ｄ３１－担当部課コード
                                     PIC  X(004).
           03  Ｄ３１－担当者コード  PIC  X(008).
           03  Ｄ３１－変則払        PIC  X(001).
           03  Ｄ３１－月額料金      PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－契約総額      PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－次回再リース料
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－再リース料金区分
                                     PIC  X(001).
           03  Ｄ３１－信用保険区分  PIC  X(001).
           03  Ｄ３１－担保区分      PIC  X(001).
           03  Ｄ３１－協調区分      PIC  X(001).
           03  Ｄ３１－契約先コード  PIC  X(005).
           03  Ｄ３１－主幹事先コード
                                     PIC  X(009).
           03  Ｄ３１－利回り        PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－ユーザ利回り  PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－長プラ金利    PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－社内金利      PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－請求先コード  PIC  X(005).
           03  Ｄ３１－請求書作成区分
                                     PIC  X(001).
           03  Ｄ３１－請求件名      PIC  X(060).
           03  Ｄ３１－第１回回収方法
                                     PIC  X(001).
           03  Ｄ３１－第１回回収サイト
                                     PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－第１回回収日  PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－第１回回収回数
                                     PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－振替開始年月  PIC  X(006).
           03  Ｄ３１－前払区分      PIC  X(001).
           03  Ｄ３１－頭金区分      PIC  X(001).
           03  Ｄ３１－営業コメント欄１
                                     PIC  X(080).
           03  Ｄ３１－営業コメント欄２
                                     PIC  X(080).
           03  Ｄ３１－状態フラグ    PIC  X(001).
           03  Ｄ３１－満了案内送付区分
                                     PIC  X(001).
           03  Ｄ３１－満了案内回答区分
                                     PIC  X(001).
           03  Ｄ３１－主契約区分    PIC  X(001).
           03  Ｄ３１－遡及処理区分  PIC  X(001).
           03  Ｄ３１－遡及処理年月  PIC  X(006).
           03  Ｄ３１－検収エントリ日
                                     PIC  X(008).
           03  Ｄ３１－検収取消日    PIC  X(008).
           03  Ｄ３１－検収取消エントリ日
                                     PIC  X(008).
           03  Ｄ３１－検収処理年月  PIC  X(006).
           03  Ｄ３１－検収取消年月  PIC  X(006).
           03  Ｄ３１－当初回収期間  PIC S9(003) PACKED-DECIMAL.
           03  Ｄ３１－最新回収期間  PIC S9(003) PACKED-DECIMAL.
           03  Ｄ３１－最終物件番号  PIC S9(004) PACKED-DECIMAL.
           03  Ｄ３１－再リースデータ作成区分
                                     PIC  X(001).
           03  Ｄ３１－再リース自動作成年月日
                                     PIC  X(008).
           03  Ｄ３１－リース割賦前払月数
                                     PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－頭金請求書作成フラグ
                                     PIC  X(001).
           03  Ｄ３１－前払請求書作成フラグ
                                     PIC  X(001).
           03  Ｄ３１－頭金請求済フラグ
                                     PIC  X(001).
           03  Ｄ３１－前払請求済フラグ
                                     PIC  X(001).
           03  Ｄ３１－解約申請フラグ
                                     PIC  X(001).
           03  Ｄ３１－解約フラグ    PIC  X(001).
           03  Ｄ３１－解約年月日    PIC  X(008).
           03  Ｄ３１－総回収回数    PIC S9(003) PACKED-DECIMAL.
           03  Ｄ３１－物件確認      PIC  X(001).
           03  Ｄ３１－まるめ単位    PIC  X(001).
           03  Ｄ３１－内訳印刷方法  PIC  X(001).
           03  Ｄ３１－契約期間回数印刷有無
                                     PIC  X(001).
           03  Ｄ３１－成約エントリ日
                                     PIC  X(008).
           03  Ｄ３１－成約取消エントリ日
                                     PIC  X(008).
           03  Ｄ３１－成約処理年月  PIC  X(006).
           03  Ｄ３１－成約取消年月  PIC  X(006).
           03  Ｄ３１－再リース請求間隔
                                     PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－再リース回収間隔
                                     PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－更新年月日    PIC  X(008).
           03  Ｄ３１－更新時間      PIC  X(008).
           03  Ｄ３１－更新者        PIC  X(008).
           03  Ｄ３１－当初利回り    PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－当初粗利額    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－当初月額料金  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－当初契約総額  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－以降回収サイト
                                     PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－以降回収日    PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－以降回収間隔  PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－旧取引番号    PIC  X(010).
           03  Ｄ３１－解約エントリ日
                                     PIC  X(008).
           03  Ｄ３１－解約処理年月  PIC  X(006).
           03  Ｄ３１－解約取消エントリ日
                                     PIC  X(008).
           03  Ｄ３１－解約取消処理年月
                                     PIC  X(006).
           03  Ｄ３１－満了予約フラグ
                                     PIC  X(001).
           03  Ｄ３１－満了予約エントリ日
                                     PIC  X(008).
           03  Ｄ３１－満了処理年月  PIC  X(006).
           03  Ｄ３１－再リースエントリ日
                                     PIC  X(008).
           03  Ｄ３１－再リース処理年月
                                     PIC  X(006).
           03  Ｄ３１－再リース取消エントリ日
                                     PIC  X(008).
           03  Ｄ３１－再リース取消処理年月
                                     PIC  X(006).
           03  Ｄ３１－承継エントリ日
                                     PIC  X(008).
           03  Ｄ３１－承継処理年月  PIC  X(006).
           03  Ｄ３１－承継取消エントリ日
                                     PIC  X(008).
           03  Ｄ３１－承継取消処理年月
                                     PIC  X(006).
           03  Ｄ３１－売却エントリ日
                                     PIC  X(008).
           03  Ｄ３１－売却処理年月  PIC  X(006).
           03  Ｄ３１－条件変更エントリ日
                                     PIC  X(008).
           03  Ｄ３１－条件変更処理年月
                                     PIC  X(006).
           03  Ｄ３１－管理債権レベル
                                     PIC  X(001).
           03  Ｄ３１－契約料率      PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－粗利額        PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－当初契約料率  PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－以降回収方法  PIC  X(001).
           03  Ｄ３１－請求サイト    PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－請求間隔      PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－請求基準月    PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－契約取引区分  PIC  X(001).
           03  Ｄ３１－責任区分      PIC  X(001).
           03  Ｄ３１－相殺区分      PIC  X(001).
           03  Ｄ３１－注文書出力区分
                                     PIC  X(001).
           03  Ｄ３１－満了案内帳票区分
                                     PIC  X(001).
           03  Ｄ３１－再リース料フラグ
                                     PIC  X(001).
           03  Ｄ３１－再リース自動継続区分
                                     PIC  X(001).
           03  Ｄ３１－契約書式      PIC  X(001).
           03  Ｄ３１－物件保管場所  PIC  X(001).
           03  Ｄ３１－請求先区分    PIC  X(001).
           03  Ｄ３１－不動産担保設定額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－有価証券担保設定額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－その他担保設定額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－保証人有無区分
                                     PIC  X(001).
           03  Ｄ３１－未収残高対象外フラグ
                                     PIC  X(001).
           03  Ｄ３１－保険会社区分  PIC  X(004).
           03  Ｄ３１－動総保険料    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－動総付保開始年月日
                                     PIC  X(008).
           03  Ｄ３１－入力担当者コード
                                     PIC  X(008).
           03  Ｄ３１－請求取引先コード
                                     PIC  X(009).
           03  Ｄ３１－問合せ番号    PIC  X(010).
           03  Ｄ３１－再リース区分  PIC  X(001).
           03  Ｄ３１－旧契約番号    PIC  X(010).
           03  Ｄ３１－購入選択権付リース区分
                                     PIC  X(001).
           03  Ｄ３１－再リース申請書有無区分
                                     PIC  X(001).
           03  Ｄ３１－再リース申請フラグ
                                     PIC  X(001).
           03  Ｄ３１－承継申請フラグ
                                     PIC  X(001).
           03  Ｄ３１－申請連番      PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－リスケフラグ  PIC  X(001).
           03  Ｄ３１－粗利益額－表  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－お支払明細書作成済フラグ
                                     PIC  X(001).
           03  Ｄ３１－お支払明細書要否
                                     PIC  X(001).
           03  Ｄ３１－申請年月日    PIC  X(008).
           03  Ｄ３１－対象元本額    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－消費税率区分  PIC  X(002).
           03  Ｄ３１－申請書出力年月日
                                     PIC  X(008).
           03  Ｄ３１－再リース申請書出力年月日
                                     PIC  X(008).
           03  Ｄ３１－請求基準      PIC  X(001).
           03  Ｄ３１－次回再リース回収サイト
                                     PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－次回再リース回収日
                                     PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－雑費保守料    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－雑費販促費    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－雑費信用保険  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－雑費その他    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－徴求完了フラグ
                                     PIC  X(001).
           03  Ｄ３１－徴求完了取消フラグ
                                     PIC  X(001).
           03  Ｄ３１－次回再リース区分
                                     PIC  X(001).
           03  Ｄ３１－契約書発行済フラグ
                                     PIC  X(001).
           03  Ｄ３１－注文書発行済フラグ
                                     PIC  X(001).
           03  Ｄ３１－その他発行済フラグ
                                     PIC  X(001).
           03  Ｄ３１－営業コメント欄３
                                     PIC  X(080).
           03  Ｄ３１－社内金利区分  PIC  X(001).
           03  Ｄ３１－雑費調整額    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－オープンブラインド区分
                                     PIC  X(001).
           03  Ｄ３１－協調回収区分  PIC  X(001).
           03  Ｄ３１－単年度契約    PIC  X(001).
           03  Ｄ３１－バック取引    PIC  X(001).
           03  Ｄ３１－否認区分      PIC  X(001).
           03  Ｄ３１－前渡金区分    PIC  X(001).
           03  Ｄ３１－非課税区分    PIC  X(001).
           03  Ｄ３１－包括区分      PIC  X(001).
           03  Ｄ３１－海外設置区分  PIC  X(001).
           03  Ｄ３１－物件コメント  PIC  X(040).
           03  Ｄ３１－解約金計算方法
                                     PIC  X(001).
           03  Ｄ３１－搬入予定日    PIC  X(008).
           03  Ｄ３１－申請契約額加算フラグ
                                     PIC  X(001).
           03  Ｄ３１－紹介先取引先  PIC  X(009).
           03  Ｄ３１－紹介先契約先  PIC  X(005).
           03  Ｄ３１－紹介先ＢＴＭ  PIC  X(004).
           03  Ｄ３１－紹介先僚店    PIC  X(004).
           03  Ｄ３１－紹介先銀行    PIC  X(004).
           03  Ｄ３１－紹介先支店    PIC  X(003).
           03  Ｄ３１－請求日        PIC  X(002).
           03  Ｄ３１－契約取消理由１
                                     PIC  X(080).
           03  Ｄ３１－契約取消理由２
                                     PIC  X(080).
           03  Ｄ３１－契約取消申請書発行済フラグ
                                     PIC  X(001).
           03  Ｄ３１－決裁登録申請フラグ
                                     PIC  X(001).
           03  Ｄ３１－契約登録申請フラグ
                                     PIC  X(001).
           03  Ｄ３１－検収登録申請フラグ
                                     PIC  X(001).
           03  Ｄ３１－契約取消申請フラグ
                                     PIC  X(001).
           03  Ｄ３１－検収取消申請フラグ
                                     PIC  X(001).
           03  Ｄ３１－変更申請フラグ
                                     PIC  X(001).
           03  Ｄ３１－変更フラグ    PIC  X(001).
           03  Ｄ３１－変更年月日    PIC  X(008).
           03  Ｄ３１－債務協調コード
                                     PIC  X(002).
           03  Ｄ３１－一般大口区分  PIC  X(001).
           03  Ｄ３１－制度リース    PIC  X(001).
           03  Ｄ３１－基本利回り総額分
                                     PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－実質利回り総額分
                                     PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－粗利額総額分  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－一般社内金利  PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－一般基本利回り
                                     PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－一般実質利回り
                                     PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－一般粗利額    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－一般基本利回り総額分
                                     PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－一般実質利回り総額分
                                     PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－一般粗利額自社分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－強制保存フラグ
                                     PIC  X(001).
           03  Ｄ３１－登録年月日    PIC  X(008).
           03  Ｄ３１－登録時間      PIC  X(008).
           03  Ｄ３１－登録担当者    PIC  X(008).
           03  Ｄ３１－転リース提携先コード
                                     PIC  X(003).
           03  Ｄ３１－斡旋手数料    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－業務区分      PIC  X(001).
           03  Ｄ３１－買戻義務区分  PIC  X(001).
           03  Ｄ３１－代理回収      PIC  X(001).
           03  Ｄ３１－買取金額      PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－金利変動区分  PIC  X(001).
           03  Ｄ３１－連動金利区分  PIC  X(002).
           03  Ｄ３１－割引率        PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－貸付金額      PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３１－貸付金利      PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－資金使途区分  PIC  X(002).
           03  Ｄ３１－資金使途文言  PIC  X(080).
           03  Ｄ３１－支払委託取引形態
                                     PIC  X(001).
           03  Ｄ３１－融資方法      PIC  X(001).
           03  Ｄ３１－返済条件      PIC  X(001).
           03  Ｄ３１－リース種類区分
                                     PIC  X(001).
           03  Ｄ３１－資産科目区分  PIC  X(001).
           03  Ｄ３１－重要性基準区分
                                     PIC  X(001).
           03  Ｄ３１－前渡金金利    PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－トリプルオプション方式
                                     PIC  X(001).
           03  Ｄ３１－引合中止区分  PIC  X(001).
           03  Ｄ３１－内容変更申請連番
                                     PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－承継分割種類  PIC  X(001).
           03  Ｄ３１－承継区分      PIC  X(001).
           03  Ｄ３１－満了条件区分  PIC  X(001).
           03  Ｄ３１－第１回目回収日文言
                                     PIC  X(040).
           03  Ｄ３１－第２回目以降回収日文言
                                     PIC  X(040).
           03  Ｄ３１－譲渡条件付リース区分
                                     PIC  X(001).
           03  Ｄ３１－残価回収サイト
                                     PIC S9(002)V9(002) PACKED-DECIMAL.
           03  Ｄ３１－債権買取区分  PIC  X(001).
           03  Ｄ３１－支払基準月    PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－損害賠償金文言
                                     PIC  X(080).
           03  Ｄ３１－流動化番号    PIC  X(006).
           03  Ｄ３１－流動化先      PIC  X(007).
           03  Ｄ３１－信託先設定日  PIC  X(008).
           03  Ｄ３１－信託終了日    PIC  X(008).
           03  Ｄ３１－債権流動化区分
                                     PIC  X(001).
           03  Ｄ３１－差入予約区分  PIC  X(001).
           03  Ｄ３１－債権買取日    PIC  X(008).
           03  Ｄ３１－相殺条項区分  PIC  X(001).
           03  Ｄ３１－譲渡禁止特約  PIC  X(001).
           03  Ｄ３１－先方契約番号  PIC  X(016).
           03  Ｄ３１－再リース料分子
                                     PIC S9(004) PACKED-DECIMAL.
           03  Ｄ３１－再リース料分母
                                     PIC S9(004) PACKED-DECIMAL.
           03  Ｄ３１－営業コメント欄４
                                     PIC  X(080).
           03  Ｄ３１－新規先区分    PIC  X(001).
           03  Ｄ３１－親密先区分    PIC  X(001).
           03  Ｄ３１－財務部金利    PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－一般前渡金金利
                                     PIC S9(002)V9(008) PACKED-DECIMAL.
           03  Ｄ３１－決裁ランク    PIC  X(001).
           03  Ｄ３１－お礼状発行フラグ
                                     PIC  X(001).
           03  Ｄ３１－移行フラグ    PIC  X(001).
           03  Ｄ３１－再リース申請条件区分
                                     PIC  X(002).
           03  Ｄ３１－問い合わせ担当部店コード
                                     PIC  X(004).
           03  Ｄ３１－問い合わせ担当者名
                                     PIC  X(020).
           03  Ｄ３１－再リース料支払予定日
                                     PIC  X(008).
           03  Ｄ３１－満了通知書回答期限
                                     PIC  X(008).
           03  Ｄ３１－申請区分      PIC  X(001).
           03  Ｄ３１－内容申請書印刷回数
                                     PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３１－内容申請書印刷済フラグ
                                     PIC  X(001).
           03  Ｄ３１－契約件名自動登録区分
                                     PIC  X(001).
           03  Ｄ３１－返済原資      PIC  X(080).
           03  Ｄ３１－否認処理区分  PIC  X(001).
           03  Ｄ３１－解約理由      PIC  X(002).
           03  Ｄ３１－流動化先契約先コード
                                     PIC  X(005).
000730     
      *    EXEC  SQL  INCLUDE  D32SAK.CBL            END-EXEC.
000740*--<契約種類等変換テーブル>                                       
      *****************************************************************
      *   債権 (D32SAK_TBL)
      *****************************************************************
       01  債権.
           03  Ｄ３２－契約番号      PIC  X(010).
           03  Ｄ３２－再リース回数  PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３２－契約種類      PIC  X(003).
           03  Ｄ３２－契約件名      PIC  X(040).
           03  Ｄ３２－請求件名      PIC  X(060).
           03  Ｄ３２－変則払        PIC  X(001).
           03  Ｄ３２－当初月額料金  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－当初消費税区分
                                     PIC  X(002).
           03  Ｄ３２－当初消費税額  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－当初契約総額  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－当初消費税総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－最新月額料金  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－最新消費税区分
                                     PIC  X(002).
           03  Ｄ３２－最新消費税額  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－最新契約総額  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－最新消費税総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－保守無償期間  PIC S9(003) PACKED-DECIMAL.
           03  Ｄ３２－状態フラグ    PIC  X(001).
           03  Ｄ３２－解約フラグ    PIC  X(001).
           03  Ｄ３２－解約年月日    PIC  X(008).
           03  Ｄ３２－解約区分      PIC  X(001).
           03  Ｄ３２－解約理由      PIC  X(002).
           03  Ｄ３２－解約回数      PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３２－最新履歴解約日
                                     PIC  X(008).
           03  Ｄ３２－回収額        PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－消費税回収額  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－最新回収日    PIC  X(008).
           03  Ｄ３２－管理債権レベル
                                     PIC  X(001).
           03  Ｄ３２－割賦原価総額  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－割賦利益総額  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－取得価額      PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－遡及解約フラグ
                                     PIC  X(001).
           03  Ｄ３２－解約処理年月  PIC  X(006).
           03  Ｄ３２－解約エントリ日
                                     PIC  X(008).
           03  Ｄ３２－満了フラグ    PIC  X(001).
           03  Ｄ３２－満了年月日    PIC  X(008).
           03  Ｄ３２－解約申請フラグ
                                     PIC  X(001).
           03  Ｄ３２－解約申請日    PIC  X(008).
           03  Ｄ３２－回収条件変更フラグ
                                     PIC  X(001).
           03  Ｄ３２－回収条件変更回数
                                     PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３２－回収条件変更日
                                     PIC  X(008).
           03  Ｄ３２－前払区分      PIC  X(001).
           03  Ｄ３２－次回再リース料
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－再リース料金区分
                                     PIC  X(001).
           03  Ｄ３２－保守有無フラグ
                                     PIC  X(001).
           03  Ｄ３２－再リース自動作成フラグ
                                     PIC  X(001).
           03  Ｄ３２－再リース自動作成年月日
                                     PIC  X(008).
           03  Ｄ３２－更新年月日    PIC  X(008).
           03  Ｄ３２－更新時間      PIC  X(008).
           03  Ｄ３２－更新者        PIC  X(008).
           03  Ｄ３２－当初取得額    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－取得額現価    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－前払月数      PIC S9(002) PACKED-DECIMAL.
           03  Ｄ３２－次回再リース料消費税
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－次回再リース料消費税区分
                                     PIC  X(002).
           03  Ｄ３２－請求回数      PIC S9(003) PACKED-DECIMAL.
           03  Ｄ３２－総回収回数    PIC S9(003) PACKED-DECIMAL.
           03  Ｄ３２－合算先契約種類
                                     PIC  X(003).
           03  Ｄ３２－今回再リース料金区分
                                     PIC  X(001).
           03  Ｄ３２－再リース手数料
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自振請求ストップ申請年月日
                                     PIC  X(008).
           03  Ｄ３２－自振請求ストップ申請部課
                                     PIC  X(004).
           03  Ｄ３２－自振請求ストップ申請者
                                     PIC  X(008).
           03  Ｄ３２－自振請求ストップ開始年月
                                     PIC  X(006).
           03  Ｄ３２－自振請求ストップ終了年月
                                     PIC  X(006).
           03  Ｄ３２－自振請求ストップ理由
                                     PIC  X(002).
           03  Ｄ３２－自振ストップエントリ日
                                     PIC  X(008).
           03  Ｄ３２－自振特別請求申請年月日
                                     PIC  X(008).
           03  Ｄ３２－自振特別請求申請部課
                                     PIC  X(004).
           03  Ｄ３２－自振特別請求申請者
                                     PIC  X(008).
           03  Ｄ３２－自振特別請求開始年月
                                     PIC  X(006).
           03  Ｄ３２－自振特別請求終了年月
                                     PIC  X(006).
           03  Ｄ３２－自振特別請求申請金額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自振特別エントリ日
                                     PIC  X(008).
           03  Ｄ３２－支払次回再リース料
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－委託保守区分  PIC  X(001).
           03  Ｄ３２－委託保守相当月額料金
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－入力担当者コード
                                     PIC  X(008).
           03  Ｄ３２－その他契約種類区分
                                     PIC  X(001).
           03  Ｄ３２－取引先コード  PIC  X(009).
           03  Ｄ３２－請求先コード  PIC  X(005).
           03  Ｄ３２－粗利益額      PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－粗利益額－表  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－手形受取日    PIC  X(008).
           03  Ｄ３２－手形枚数      PIC S9(003) PACKED-DECIMAL.
           03  Ｄ３２－自社分月額料金
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社分月額消費税
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社分契約総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社分消費税総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－他社購入額    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－残価設定額    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－他社残価設定額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－他社回収額    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－他社回収額消費税
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－他社割賦原価総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－他社割賦利益総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－再リース手数料回収額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－再リース手数料回収日
                                     PIC  X(008).
           03  Ｄ３２－売却代手数料  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－再リース自社残価設定額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－再リース他社残価設定額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－当初割賦原価総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－当初割賦利益総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－当初割賦原価総額自社
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－当初割賦利益総額自社
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－当初諸費用総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－債務勘定処理コード
                                     PIC  X(002).
           03  Ｄ３２－消費税長期－実績
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－勘定処理コード
                                     PIC  X(002).
           03  Ｄ３２－債権買取区分  PIC  X(001).
           03  Ｄ３２－当初月額料金総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－当初消費税額総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－最新月額料金総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－最新消費税額総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－最新契約総額総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－最新消費税総額総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－取得価額総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－当初取得額総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－次回再リース料総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－次回再リース料消費税総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－残価回収サイト
                                     PIC S9(002)V9(002) PACKED-DECIMAL.
           03  Ｄ３２－リスケ前契約総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－消費税徴収区分
                                     PIC  X(001).
           03  Ｄ３２－登録年月日    PIC  X(008).
           03  Ｄ３２－登録時間      PIC  X(008).
           03  Ｄ３２－登録担当者    PIC  X(008).
           03  Ｄ３２－自振請求金額変更理由
                                     PIC  X(002).
           03  Ｄ３２－自社分次回再リース料
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社分次回再リース料消費税
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－設置場所区分  PIC S9(001) PACKED-DECIMAL.
           03  Ｄ３２－当初契約総額総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－当初消費税総額総額分
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社購入額    PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社残価設定額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社元本総額  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社売上利息総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社利息総額  PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社諸費用総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社固定資産税総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社動総保険総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社委託保守料総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社その他諸費用総額
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社分支払費用適用合計
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－自社分支払費用一般合計
                                     PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－元本総額      PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－利息総額      PIC S9(013) PACKED-DECIMAL.
           03  Ｄ３２－諸費用総額    PIC S9(013) PACKED-DECIMAL.
000750     
      *    EXEC  SQL  INCLUDE  IKOTBL002.CBL         END-EXEC.
000760*--<変換テーブル>                                                 
000010************************************************
000020* 契約種類等変換テーブル(IKOTBL002)
000030************************************************
000040 01  ＩＫＯ００２－契約ＮＯ PIC  X(009).
000050 01  ＩＫＯ００２－再リースコード PIC S9(001) COMP-3.
000060 01  ＩＫＯ００２－旧債権勘定処理コード PIC S9(002) COMP-3.
000070 01  ＩＫＯ００２－旧債務勘定処理コード PIC S9(002) COMP-3.
000080 01  ＩＫＯ００２－再リース回数 PIC S9(002) COMP-3.
000090 01  ＩＫＯ００２－債権勘定処理コード PIC S9(002) COMP-3.
000100 01  ＩＫＯ００２－債務勘定処理コード PIC S9(002) COMP-3.
000110 01  ＩＫＯ００２－契約種類 PIC  X(003).
000120 01  ＩＫＯ００２－主契約区分 PIC  X(001).
000130 01  ＩＫＯ００２－回収手順 PIC  X(001).
000770     
      *    EXEC  SQL  INCLUDE  IKOTBL001.CBL         END-EXEC.
000780                                                                  
000010************************************************
000020* 変換テーブル(IKOTBL001)
000030************************************************
000040 01  ＩＫＯ００１－取引先コード PIC  X(008).
000050 01  ＩＫＯ００１－目的ＣＤ PIC  X(001).
000060 01  ＩＫＯ００１－新取引先コード PIC  X(007).
000070 01  ＩＫＯ００１－枝番 PIC  X(003).
000080 01  ＩＫＯ００１－与信括りコード PIC  X(007).
000090 01  ＩＫＯ００１－名寄せコード PIC  X(008).
000100 01  ＩＫＯ００１－ユーザコード PIC  X(008).
000110 01  ＩＫＯ００１－識別ＣＤ PIC  X(001).
000790     
      *    EXEC  SQL  END  DECLARE          SECTION  END-EXEC.
000800*                                                                 
000810*----------------------------------------------------------------*
000820*    ＷＯＲＫエリア                                              *
000830*----------------------------------------------------------------*
000840 01  ＷＯＲＫ－エリア.                                            
000850*--< エラー判定用 >                                               
000860     03  Ｗ－エラーコード             PIC S9(04).                 
000870     03  Ｗ－状態                     PIC X(02).                  
000880     03  Ｗ－管理与信先状態           PIC X(01).                  
000890*                                                                 
000900*--< フラグアリア >                                               
000910     03  フラグアリア.                                            
000920         05  Ｗ－終了－フラグ         PIC  X(01).                 
000930         05  Ｗ－異常終了－フラグ     PIC  X(01).                 
000940*                                                                 
000950*--< 件数エリア >                                                 
000960     03  件数エリア.                                              
000970         05  Ｗ－与信基本入力－件数   PIC  9(09).                 
000980         05  Ｗ－与信明細入力－件数   PIC  9(09).                 
000990         05  Ｗ－契約内容入力－件数   PIC  9(09).                 
001000         05  Ｗ－債権入力－件数       PIC  9(09).                 
001010         05  Ｗ－出力－件数           PIC  9(09).                 
001020                                                                  
001030*                                                                 
001040*--<消費税率 >                                                    
001050     03 Ｗ－消費税率                  PIC  9V99.                  
001060                                                                  
001070*                                                                 
001080*--< 共通情報 >                                                   
001090 01  Ｗ－共通情報.                                                
001100     03  Ｗ－システム日付.                                        
001110         05  Ｗ－世紀                 PIC  X(02) VALUE  "20".     
001120         05  Ｗ－年月日               PIC  X(06).                 
001130     03  Ｗ－システム時刻             PIC  X(08).                 
001140     03  Ｗ－担当者                   PIC  X(08) VALUE "IKOPG   ".
001150*                                                                 
001160*                                                                 
001170*----------------------------------------------------------------*
001180*    サブルーチン名                                              *
001190*----------------------------------------------------------------*
001200 01  CALL-AREA.                                                   
001210*--< 共通ログサブルーチン >                                       
001220     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001230     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001240*                                                                 
001250*----------------------------------------------------------------*
001260*    ＣＯＰＹ領域                                                *
001270*----------------------------------------------------------------*
001280*--< 共通ログ用パラメータ >                                       
001290 01  IF-CHOCO001.                                                 
001300     COPY  CHOCO001  REPLACING  ==()==  BY  ==共１－==.           
001310*                                                                 
001320*----------------------------------------------------------------*
001330*    ＩＮＩファイル読込サブルーチン用パラメタ領域                *
001340*----------------------------------------------------------------*
001350 01  PARA-AREA.                                                   
001360     COPY CPBCO001.                                               
001370******************************************************************
001380*    定数用データ定義エリア                                      *
001390******************************************************************
001400 CONSTANT                             SECTION.                    
001410 01  定数領域.                                                    
001420     03  定数－プログラムＩＤ         PIC  X(08) VALUE "COBIS660".
001430     03  定数－プログラム名           PIC  X(80)                  
001440                             VALUE  "管理与信契約移行処理".       
001450     03  定数－ＳＱＬＯＫ             PIC S9(04)  VALUE  ZERO.    
001460     03  定数－ＳＱＬＥＮＤ           PIC S9(04)  VALUE  0100.    
001470     03  定数－正常状態               PIC S9(04)  VALUE  ZERO.    
001480     03  定数－異常状態               PIC S9(04)  VALUE  0009.    
001490                                                                  
001500******************************************************************
001510*    ＰＲＯＣＥＤＵＲＥ            ＤＩＶＩＳＩＯＮ              *
001520******************************************************************
001530 PROCEDURE                            DIVISION.                   
001540*                                                                 
001550     PERFORM  初期処理.                                           
001560*                                                                 
001570     PERFORM  主処理  UNTIL  Ｗ－終了－フラグ  =  "Y".            
001580*                                                                 
001590     PERFORM  終了処理.                                           
001600*                                                                 
001610     STOP     RUN.                                                
001620*                                                                 
001630******************************************************************
001640*    初期処理                                                    *
001650******************************************************************
001660 初期処理                             SECTION.                    
001670 初期処理－ＳＴＡＲＴ.                                            
001680*                                                                 
001690*----------------------------------------------------------------*
001700*    開始メッセージ出力処理                                      *
001710*----------------------------------------------------------------*
001720     INITIALIZE                       IF-CHOCO001.                
001730     MOVE  "3"                        TO  共１－イベント種別.     
001740     MOVE  定数－プログラムＩＤ       TO  共１－ソースＩＤ.       
001750     MOVE  "0"                        TO  共１－復帰コード.       
001760     MOVE  "START"                    TO  共１－処理識別.         
001770     MOVE  定数－プログラム名         TO  共１－その他メッセージ. 
001780     CALL  CLOCO001                USING  IF-CHOCO001.            
001790*                                                                 
001800*----------------------------------------------------------------*
001810*    作業領域の初期値処理                                        *
001820*----------------------------------------------------------------*
001830     MOVE                SPACE        TO  ＷＯＲＫ－エリア.       
001840     INITIALIZE                           ＷＯＲＫ－エリア.       
001850*                                                                 
001860*--< ＣＰＵ日付を取得 >                                           
001870     ACCEPT  Ｗ－年月日               FROM  DATE.                 
001880*                                                                 
001890*--< ＣＰＵ時刻を取得 >                                           
001900     ACCEPT  Ｗ－システム時刻         FROM  TIME.                 
001910*                                                                 
001920*--< ＯＲＡＣＬＥ接続 >                                           
001930     PERFORM   ＯＲＡＣＬＥ接続.                                  
001940*                                                                 
001950*--< 結合テーブルカーソル宣言 >                                   
001960     PERFORM  結合テーブルカーソル宣言.                           
001970*                                                                 
001980*--<ファイルオープン>                                             
001990     PERFORM  ファイルオープン.                                   
002000*--<結合テーブルカーソル読込>                                     
002010     PERFORM   結合テーブルカーソル読込.                          
002020*                                                                 
002030 初期処理－ＥＸＩＴ.                                              
002040     EXIT.                                                        
002050******************************************************************
002060*    ＯＲＡＣＬＥ接続                                            *
002070******************************************************************
002080 ＯＲＡＣＬＥ接続                     SECTION.                    
002090 ＯＲＡＣＬＥ接続－ＳＴＡＲＴ.                                    
002100*                                                                 
002110*--< ＤＢ接続用情報を取得処理 >                                   
002120     CALL  COBCO001                USING  PARA-AREA.              
002130*                                                                 
002140     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002150     MOVE  PARA-USERNAME              TO  USERNAME.               
002160     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002170*                                                                 
002180*----------------------------------------------------------------*
002190*    開始接続                                                    *
002200*----------------------------------------------------------------*
002210     IF    DB-STRING  =  SPACE                                    
002220        
      *       EXEC SQL                                                  
002230*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002240*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 5 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002250     ELSE                                                         
002260        
      *       EXEC SQL                                                  
002270*          CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002280*            USING  :DB-STRING                                    
002290*       END-EXEC 
              CALL "ORASQL8"
              MOVE 10 TO SQL-ITERS
              MOVE 36 TO SQL-OFFSET
              MOVE 0 TO SQL-OCCURS
              CALL "SQLADR" USING
                  SQLCUD
                  SQL-CUD
              CALL "SQLADR" USING
                  SQLCA
                  SQL-SQLEST
              MOVE 256 TO SQL-SQLETY
              CALL "SQLADR" USING
                  USERNAME
                  SQL-SQHSTV(1)
              MOVE 10 TO SQL-SQHSTL(1)
              MOVE 0 TO SQL-SQHSTS(1)
              MOVE 0 TO SQL-SQINDV(1)
              MOVE 0 TO SQL-SQINDS(1)
              MOVE 0 TO SQL-SQHARM(1)
              CALL "SQLADR" USING
                  PASSWD
                  SQL-SQHSTV(2)
              MOVE 10 TO SQL-SQHSTL(2)
              MOVE 0 TO SQL-SQHSTS(2)
              MOVE 0 TO SQL-SQINDV(2)
              MOVE 0 TO SQL-SQINDS(2)
              MOVE 0 TO SQL-SQHARM(2)
              CALL "SQLADR" USING
                  DB-STRING
                  SQL-SQHSTV(3)
              MOVE 20 TO SQL-SQHSTL(3)
              MOVE 0 TO SQL-SQHSTS(3)
              MOVE 0 TO SQL-SQINDV(3)
              MOVE 0 TO SQL-SQINDS(3)
              MOVE 0 TO SQL-SQHARM(3)
              CALL "SQLADR" USING
                  SQL-SQHSTV(1)
                  SQL-SQPHSV
              CALL "SQLADR" USING
                  SQL-SQHSTL(1)
                  SQL-SQPHSL
              CALL "SQLADR" USING
                  SQL-SQHSTS(1)
                  SQL-SQPHSS
              CALL "SQLADR" USING
                  SQL-SQINDV(1)
                  SQL-SQPIND
              CALL "SQLADR" USING
                  SQL-SQINDS(1)
                  SQL-SQPINS
              CALL "SQLADR" USING
                  SQL-SQHARM(1)
                  SQL-SQPARM
              CALL "SQLADR" USING
                  SQL-SQHARC(1)
                  SQL-SQPARC

              CALL "SQLBEX" USING
                  SQLCTX
                  SQLEXD
                  SQLFPN

              CALL "SQLGSS" USING
                 SQLSTATE
002300     END-IF.                                                      
002310*                                                                 
002320*----------------------------------------------------------------*
002330*    接続確認                                                    *
002340*----------------------------------------------------------------*
002350     EVALUATE  SQLCODE                                            
002360        WHEN   定数－ＳＱＬＯＫ                                   
002370           CONTINUE                                               
002380        WHEN   OTHER                                              
002390*--<       接続エラー >                                           
002400           MOVE     -10               TO  Ｗ－エラーコード        
002410           PERFORM  エラー判定処理                                
002420     END-EVALUATE.                                                
002430*                                                                 
002440 ＯＲＡＣＬＥ接続－ＥＸＩＴ.                                      
002450******************************************************************
002460*        結合テーブルカーソル定義                                *
002470******************************************************************
002480 結合テーブルカーソル宣言             SECTION.                    
002490 結合テーブルカーソル宣言－ＳＴＡＲＴ.                            
002500*                                                                 
002510*----------------------------------------------------------------*
002520*    カーソルＯＰＥＮ処理                                        *
002530*----------------------------------------------------------------*
002540     
      *    EXEC SQL                                                     
002550*       DECLARE  CUR1  CURSOR FOR                                 
002560*          SELECT   NVL(YOSHINKIHON.管理与信先コード,             
002570*                                          RPAD(' ',8,' ')),      
002580*                   YOSHINMEISAI.契約ＮＯ,                        
002590*                   YOSHINMEISAI.勘定コード,                      
002600*                   YOSHINMEISAI.事業所コード,                    
002610*                   YOSHINMEISAI.事故日,                          
002620*                   YOSHINMEISAI.契約日,                          
002630*                   YOSHINMEISAI.検収日,                          
002640*                   YOSHINMEISAI.満了日,                          
002650*                   YOSHINMEISAI.当債権残,                        
002660*                   YOSHINMEISAI.貸付金別口,                      
002670*                   YOSHINMEISAI.非稼動資産,                      
002680*                   YOSHINMEISAI.貯蔵品,                          
002690*                   YOSHINMEISAI.信用保険付保区分,                
002700*                   YOSHINMEISAI.信用保険求償,                    
002710*                   YOSHINMEISAI.契約金額,                        
002720*                   YOSHINMEISAI.入金日,                          
002730*                   YOSHINMEISAI.開始回数,                        
002740*                   YOSHINMEISAI.明細支払回数,                    
002750*                   YOSHINMEISAI.計算方式,                        
002760*                   YOSHINMEISAI.請求サイクル,                    
002770*                   YOSHINMEISAI.延滞開始日,                      
002780*                   YOSHINMEISAI.歯抜けフラグ１,                  
002790*                   YOSHINMEISAI.歯抜けフラグ２,                  
002800*                   YOSHINMEISAI.ヤクベン区分,                    
002810*                   YOSHINMEISAI.残価額,                          
002820*                   YOSHINMEISAI.月割Ｌ料,                        
002830*                   YOSHINMEISAI.事故債権残,                      
002840*                   YOSHINMEISAI.事故元本残,                      
002850*                   YOSHINMEISAI.当債権残,                        
002860*                   YOSHINMEISAI.当元本残,                        
002870*                   YOSHINMEISAI.未収元本,                        
002880*                   YOSHINMEISAI.未収利息,                        
002890*                   YOSHINMEISAI.未徴収金,                        
002900*                   YOSHINMEISAI.Ｂ未徴収金,                      
002910*                   YOSHINMEISAI.売却金額,                        
002920*                   YOSHINMEISAI.固定利率,                        
002930*                   YOSHINMEISAI.金利変動区分,                    
002940*                   YOSHINMEISAI.スプレッド,                      
002950*                   YOSHINMEISAI.連動金利区分,                    
002960*                   NVL(YOSHINKIHON.解約区分, RPAD(' ',1,' ')),   
002970*                   YOSHINMEISAI.更新日付                         
002980*             FROM  YOSHINMEISAI,YOSHINKIHON                      
002990*            WHERE  YOSHINMEISAI.管理与信先コード =               
003000*                                YOSHINKIHON.管理与信先コード( + )
003010*              AND  YOSHINMEISAI.管理与信区分 =                   
003020*                                YOSHINKIHON.管理与信区分( + )    
003030* 	     AND  YOSHINMEISAI.自動与信区分 =                   
003040*                                YOSHINKIHON.自動与信区分( + )	
003050*              AND  YOSHINMEISAI.事故日 = YOSHINKIHON.事故日( + ) 
003060*                                                                 
003070*    END-EXEC.
003080*                                                                 
003090*----------------------------------------------------------------*
003100*    カーソルＯＰＥＮ処理                                        *
003110*----------------------------------------------------------------*
003120     
      *    EXEC SQL                                                     
003130*       OPEN  CUR1                                                
003140*    END-EXEC.
           CALL "SQLADR" USING SQ0001 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 67 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
003150*                                                                 
003160*----------------------------------------------------------------*
003170*    カーソルＯＰＥＮ確認                                        *
003180*----------------------------------------------------------------*
003190     EVALUATE  SQLCODE                                            
003200        WHEN  定数－ＳＱＬＯＫ                                    
003210*--<       正常 >                                                 
003220           CONTINUE                                               
003230        WHEN  OTHER                                               
003240*--<       カーソルＯＰＥＮエラー >                               
003250           MOVE -20                  TO  Ｗ－エラーコード         
003260           PERFORM  エラー判定処理                                
003270     END-EVALUATE.                                                
003280*                                                                 
003290 結合テーブルカーソル宣言－ＥＸＩＴ.                              
003300     EXIT.                                                        
003310* *************************************************************** 
003320*                   ファイルオープン.                           * 
003330***************************************************************** 
003340 ファイルオープン                     SECTION.                    
003350 ファイルオープン－ＳＴＡＲＴ.                                    
003360     OPEN  OUTPUT  出カファイル.                                  
003370*----------------------------------------------------------------*
003380*   ファイルオープンＯＰＥＮ確認                                 *
003390*----------------------------------------------------------------*
003400     EVALUATE   Ｗ－状態                                          
003410        WHEN  ZERO                                                
003420*--<       正常 >                                                 
003430           CONTINUE                                               
003440        WHEN  OTHER                                               
003450*--<       カーソルＯＰＥＮエラー >                               
003460           MOVE          -30          TO  Ｗ－エラーコード        
003470           PERFORM  エラー判定処理                                
003480     END-EVALUATE.                                                
003490 ファイルオープン－ＥＸＩＴ.                                      
003500     EXIT.                                                        
003510******************************************************************
003520*    結合テーブルカーソル読込                                    *
003530******************************************************************
003540 結合テーブルカーソル読込             SECTION.                    
003550 結合テーブルカーソル読込－ＳＴＡＲＴ.                            
003560*                                                                 
003570*--< 結合テーブルカーソル読込 >                                   
003580     
      *    EXEC SQL                                                     
003590*        FETCH  CUR1                                              
003600*         INTO :ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード,         
003610*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－契約ＮＯ,               
003620*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－勘定コード,             
003630*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－事業所コード,           
003640*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－事故日,                 
003650*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－契約日,                 
003660*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－検収日,                 
003670*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－満了日,                 
003680*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－当債権残,               
003690*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－貸付金別口,             
003700*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－非稼動資産,             
003710*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－貯蔵品,                 
003720*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－信用保険付保区分,       
003730*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－信用保険求償,           
003740*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－契約金額,               
003750*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－入金日,                 
003760*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－開始回数,               
003770*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－明細支払回数,           
003780*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－計算方式,               
003790*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－請求サイクル,           
003800*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－延滞開始日,             
003810*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－歯抜けフラグ１,         
003820*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－歯抜けフラグ２,         
003830*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－残価額,                 
003840*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－月割Ｌ料,               
003850*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－ヤクベン区分,           
003860*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－事故債権残,             
003870*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－事故元本残,             
003880*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－当債権残,               
003890*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－当元本残,               
003900*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－未収元本,               
003910*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－未収利息,               
003920*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－未徴収金,               
003930*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－Ｂ未徴収金,             
003940*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－売却金額,               
003950*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－固定利率,               
003960*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－金利変動区分,           
003970*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－スプレッド,             
003980*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－連動金利区分,           
003990*              :ＹＯＳＨＩＮＫＩＨＯＮ－解約区分,                 
004000*              :ＹＯＳＨＩＮＭＥＩＳＡＩ－更新日付                
004010*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 82 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード
               SQL-SQHSTV(1)
           MOVE 8 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－契約ＮＯ
               SQL-SQHSTV(2)
           MOVE 9 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－勘定コード
               SQL-SQHSTV(3)
           MOVE 2 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－事業所コード
               SQL-SQHSTV(4)
           MOVE 4 TO SQL-SQHSTL(4)
           MOVE 0 TO SQL-SQHSTS(4)
           MOVE 0 TO SQL-SQINDV(4)
           MOVE 0 TO SQL-SQINDS(4)
           MOVE 0 TO SQL-SQHARM(4)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－事故日
               SQL-SQHSTV(5)
           MOVE 8 TO SQL-SQHSTL(5)
           MOVE 0 TO SQL-SQHSTS(5)
           MOVE 0 TO SQL-SQINDV(5)
           MOVE 0 TO SQL-SQINDS(5)
           MOVE 0 TO SQL-SQHARM(5)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－契約日
               SQL-SQHSTV(6)
           MOVE 8 TO SQL-SQHSTL(6)
           MOVE 0 TO SQL-SQHSTS(6)
           MOVE 0 TO SQL-SQINDV(6)
           MOVE 0 TO SQL-SQINDS(6)
           MOVE 0 TO SQL-SQHARM(6)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－検収日
               SQL-SQHSTV(7)
           MOVE 8 TO SQL-SQHSTL(7)
           MOVE 0 TO SQL-SQHSTS(7)
           MOVE 0 TO SQL-SQINDV(7)
           MOVE 0 TO SQL-SQINDS(7)
           MOVE 0 TO SQL-SQHARM(7)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－満了日
               SQL-SQHSTV(8)
           MOVE 8 TO SQL-SQHSTL(8)
           MOVE 0 TO SQL-SQHSTS(8)
           MOVE 0 TO SQL-SQINDV(8)
           MOVE 0 TO SQL-SQINDS(8)
           MOVE 0 TO SQL-SQHARM(8)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－当債権残
               SQL-SQHSTV(9)
           MOVE 7 TO SQL-SQHSTL(9)
           MOVE 0 TO SQL-SQHSTS(9)
           MOVE 0 TO SQL-SQINDV(9)
           MOVE 0 TO SQL-SQINDS(9)
           MOVE 0 TO SQL-SQHARM(9)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－貸付金別口
               SQL-SQHSTV(10)
           MOVE 7 TO SQL-SQHSTL(10)
           MOVE 0 TO SQL-SQHSTS(10)
           MOVE 0 TO SQL-SQINDV(10)
           MOVE 0 TO SQL-SQINDS(10)
           MOVE 0 TO SQL-SQHARM(10)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－非稼動資産
               SQL-SQHSTV(11)
           MOVE 7 TO SQL-SQHSTL(11)
           MOVE 0 TO SQL-SQHSTS(11)
           MOVE 0 TO SQL-SQINDV(11)
           MOVE 0 TO SQL-SQINDS(11)
           MOVE 0 TO SQL-SQHARM(11)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－貯蔵品
               SQL-SQHSTV(12)
           MOVE 7 TO SQL-SQHSTL(12)
           MOVE 0 TO SQL-SQHSTS(12)
           MOVE 0 TO SQL-SQINDV(12)
           MOVE 0 TO SQL-SQINDS(12)
           MOVE 0 TO SQL-SQHARM(12)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－信用保険付保区分
               SQL-SQHSTV(13)
           MOVE 1 TO SQL-SQHSTL(13)
           MOVE 0 TO SQL-SQHSTS(13)
           MOVE 0 TO SQL-SQINDV(13)
           MOVE 0 TO SQL-SQINDS(13)
           MOVE 0 TO SQL-SQHARM(13)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－信用保険求償
               SQL-SQHSTV(14)
           MOVE 7 TO SQL-SQHSTL(14)
           MOVE 0 TO SQL-SQHSTS(14)
           MOVE 0 TO SQL-SQINDV(14)
           MOVE 0 TO SQL-SQINDS(14)
           MOVE 0 TO SQL-SQHARM(14)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－契約金額
               SQL-SQHSTV(15)
           MOVE 7 TO SQL-SQHSTL(15)
           MOVE 0 TO SQL-SQHSTS(15)
           MOVE 0 TO SQL-SQINDV(15)
           MOVE 0 TO SQL-SQINDS(15)
           MOVE 0 TO SQL-SQHARM(15)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－入金日
               SQL-SQHSTV(16)
           MOVE 2 TO SQL-SQHSTL(16)
           MOVE 0 TO SQL-SQHSTS(16)
           MOVE 0 TO SQL-SQINDV(16)
           MOVE 0 TO SQL-SQINDS(16)
           MOVE 0 TO SQL-SQHARM(16)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－開始回数
               SQL-SQHSTV(17)
           MOVE 1 TO SQL-SQHSTL(17)
           MOVE 0 TO SQL-SQHSTS(17)
           MOVE 0 TO SQL-SQINDV(17)
           MOVE 0 TO SQL-SQINDS(17)
           MOVE 0 TO SQL-SQHARM(17)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－明細支払回数
               SQL-SQHSTV(18)
           MOVE 3 TO SQL-SQHSTL(18)
           MOVE 0 TO SQL-SQHSTS(18)
           MOVE 0 TO SQL-SQINDV(18)
           MOVE 0 TO SQL-SQINDS(18)
           MOVE 0 TO SQL-SQHARM(18)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－計算方式
               SQL-SQHSTV(19)
           MOVE 1 TO SQL-SQHSTL(19)
           MOVE 0 TO SQL-SQHSTS(19)
           MOVE 0 TO SQL-SQINDV(19)
           MOVE 0 TO SQL-SQINDS(19)
           MOVE 0 TO SQL-SQHARM(19)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－請求サイクル
               SQL-SQHSTV(20)
           MOVE 2 TO SQL-SQHSTL(20)
           MOVE 0 TO SQL-SQHSTS(20)
           MOVE 0 TO SQL-SQINDV(20)
           MOVE 0 TO SQL-SQINDS(20)
           MOVE 0 TO SQL-SQHARM(20)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－延滞開始日
               SQL-SQHSTV(21)
           MOVE 8 TO SQL-SQHSTL(21)
           MOVE 0 TO SQL-SQHSTS(21)
           MOVE 0 TO SQL-SQINDV(21)
           MOVE 0 TO SQL-SQINDS(21)
           MOVE 0 TO SQL-SQHARM(21)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－歯抜けフラグ１
               SQL-SQHSTV(22)
           MOVE 2 TO SQL-SQHSTL(22)
           MOVE 0 TO SQL-SQHSTS(22)
           MOVE 0 TO SQL-SQINDV(22)
           MOVE 0 TO SQL-SQINDS(22)
           MOVE 0 TO SQL-SQHARM(22)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－歯抜けフラグ２
               SQL-SQHSTV(23)
           MOVE 2 TO SQL-SQHSTL(23)
           MOVE 0 TO SQL-SQHSTS(23)
           MOVE 0 TO SQL-SQINDV(23)
           MOVE 0 TO SQL-SQINDS(23)
           MOVE 0 TO SQL-SQHARM(23)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－残価額
               SQL-SQHSTV(24)
           MOVE 7 TO SQL-SQHSTL(24)
           MOVE 0 TO SQL-SQHSTS(24)
           MOVE 0 TO SQL-SQINDV(24)
           MOVE 0 TO SQL-SQINDS(24)
           MOVE 0 TO SQL-SQHARM(24)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－月割Ｌ料
               SQL-SQHSTV(25)
           MOVE 7 TO SQL-SQHSTL(25)
           MOVE 0 TO SQL-SQHSTS(25)
           MOVE 0 TO SQL-SQINDV(25)
           MOVE 0 TO SQL-SQINDS(25)
           MOVE 0 TO SQL-SQHARM(25)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－ヤクベン区分
               SQL-SQHSTV(26)
           MOVE 1 TO SQL-SQHSTL(26)
           MOVE 0 TO SQL-SQHSTS(26)
           MOVE 0 TO SQL-SQINDV(26)
           MOVE 0 TO SQL-SQINDS(26)
           MOVE 0 TO SQL-SQHARM(26)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－事故債権残
               SQL-SQHSTV(27)
           MOVE 7 TO SQL-SQHSTL(27)
           MOVE 0 TO SQL-SQHSTS(27)
           MOVE 0 TO SQL-SQINDV(27)
           MOVE 0 TO SQL-SQINDS(27)
           MOVE 0 TO SQL-SQHARM(27)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－事故元本残
               SQL-SQHSTV(28)
           MOVE 7 TO SQL-SQHSTL(28)
           MOVE 0 TO SQL-SQHSTS(28)
           MOVE 0 TO SQL-SQINDV(28)
           MOVE 0 TO SQL-SQINDS(28)
           MOVE 0 TO SQL-SQHARM(28)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－当債権残
               SQL-SQHSTV(29)
           MOVE 7 TO SQL-SQHSTL(29)
           MOVE 0 TO SQL-SQHSTS(29)
           MOVE 0 TO SQL-SQINDV(29)
           MOVE 0 TO SQL-SQINDS(29)
           MOVE 0 TO SQL-SQHARM(29)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－当元本残
               SQL-SQHSTV(30)
           MOVE 7 TO SQL-SQHSTL(30)
           MOVE 0 TO SQL-SQHSTS(30)
           MOVE 0 TO SQL-SQINDV(30)
           MOVE 0 TO SQL-SQINDS(30)
           MOVE 0 TO SQL-SQHARM(30)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－未収元本
               SQL-SQHSTV(31)
           MOVE 7 TO SQL-SQHSTL(31)
           MOVE 0 TO SQL-SQHSTS(31)
           MOVE 0 TO SQL-SQINDV(31)
           MOVE 0 TO SQL-SQINDS(31)
           MOVE 0 TO SQL-SQHARM(31)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－未収利息
               SQL-SQHSTV(32)
           MOVE 7 TO SQL-SQHSTL(32)
           MOVE 0 TO SQL-SQHSTS(32)
           MOVE 0 TO SQL-SQINDV(32)
           MOVE 0 TO SQL-SQINDS(32)
           MOVE 0 TO SQL-SQHARM(32)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－未徴収金
               SQL-SQHSTV(33)
           MOVE 7 TO SQL-SQHSTL(33)
           MOVE 0 TO SQL-SQHSTS(33)
           MOVE 0 TO SQL-SQINDV(33)
           MOVE 0 TO SQL-SQINDS(33)
           MOVE 0 TO SQL-SQHARM(33)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－Ｂ未徴収金
               SQL-SQHSTV(34)
           MOVE 7 TO SQL-SQHSTL(34)
           MOVE 0 TO SQL-SQHSTS(34)
           MOVE 0 TO SQL-SQINDV(34)
           MOVE 0 TO SQL-SQINDS(34)
           MOVE 0 TO SQL-SQHARM(34)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－売却金額
               SQL-SQHSTV(35)
           MOVE 7 TO SQL-SQHSTL(35)
           MOVE 0 TO SQL-SQHSTS(35)
           MOVE 0 TO SQL-SQINDV(35)
           MOVE 0 TO SQL-SQINDS(35)
           MOVE 0 TO SQL-SQHARM(35)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－固定利率
               SQL-SQHSTV(36)
           MOVE 6 TO SQL-SQHSTL(36)
           MOVE 0 TO SQL-SQHSTS(36)
           MOVE 0 TO SQL-SQINDV(36)
           MOVE 0 TO SQL-SQINDS(36)
           MOVE 0 TO SQL-SQHARM(36)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－金利変動区分
               SQL-SQHSTV(37)
           MOVE 1 TO SQL-SQHSTL(37)
           MOVE 0 TO SQL-SQHSTS(37)
           MOVE 0 TO SQL-SQINDV(37)
           MOVE 0 TO SQL-SQINDS(37)
           MOVE 0 TO SQL-SQHARM(37)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－スプレッド
               SQL-SQHSTV(38)
           MOVE 6 TO SQL-SQHSTL(38)
           MOVE 0 TO SQL-SQHSTS(38)
           MOVE 0 TO SQL-SQINDV(38)
           MOVE 0 TO SQL-SQINDS(38)
           MOVE 0 TO SQL-SQHARM(38)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－連動金利区分
               SQL-SQHSTV(39)
           MOVE 1 TO SQL-SQHSTL(39)
           MOVE 0 TO SQL-SQHSTS(39)
           MOVE 0 TO SQL-SQINDV(39)
           MOVE 0 TO SQL-SQINDS(39)
           MOVE 0 TO SQL-SQHARM(39)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＫＩＨＯＮ－解約区分
               SQL-SQHSTV(40)
           MOVE 1 TO SQL-SQHSTL(40)
           MOVE 0 TO SQL-SQHSTS(40)
           MOVE 0 TO SQL-SQINDV(40)
           MOVE 0 TO SQL-SQINDS(40)
           MOVE 0 TO SQL-SQHARM(40)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－更新日付
               SQL-SQHSTV(41)
           MOVE 8 TO SQL-SQHSTL(41)
           MOVE 0 TO SQL-SQHSTS(41)
           MOVE 0 TO SQL-SQINDV(41)
           MOVE 0 TO SQL-SQINDS(41)
           MOVE 0 TO SQL-SQHARM(41)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
004020                                                                  
004030                                                                  
004040*----------------------------------------------------------------*
004050*    結合テーブルカーソル読込を確認                              *
004060*----------------------------------------------------------------*
004070     EVALUATE   SQLCODE                                           
004080        WHEN   定数－ＳＱＬＯＫ                                   
004090*--<       正常 >                                                 
004100               COMPUTE Ｗ－与信基本入力－件数 =                   
004110                               Ｗ－与信基本入力－件数 + 1         
004120               COMPUTE Ｗ－与信明細入力－件数 =                   
004130                               Ｗ－与信明細入力－件数 + 1         
004140        WHEN   定数－ＳＱＬＥＮＤ                                 
004150*--<       読込終了 >                                             
004160           MOVE  "Y"                  TO  Ｗ－終了－フラグ        
004170        WHEN   OTHER                                              
004180*--<       読込エラー >                                           
004190           MOVE     -40               TO  Ｗ－エラーコード        
004200           PERFORM  エラー判定処理                                
004210     END-EVALUATE.                                                
004220*                                                                 
004230 結合テーブルカーソル読込－ＥＸＩＴ.                              
004240     EXIT.                                                        
004250******************************************************************
004260*    主処理                                                      *
004270******************************************************************
004280 主処理                               SECTION.                    
004290 主処理－ＳＴＡＲＴ.                                              
004300*--<与信管理先コード処理>                                         
004310     PERFORM  与信管理先コード処理.                               
004320*                                                                 
004330*--<Ｗ－管理与信先状態  = 'N'結合テーブルカーソル読込>            
004340     IF  Ｗ－管理与信先状態  = 'N'                                
004350         PERFORM  結合テーブルカーソル読込.                       
004360*                                                                 
004370*--<再リース回数処理>                                             
004380     PERFORM  再リース回数処理.                                   
004390                                                                  
004400*--<契約種類主契約区分処理>                                       
004410     PERFORM  契約種類主契約区分処理.                             
004420                                                                  
004430*--<契約先コード処理>                                             
004440     PERFORM  契約先コード処理.                                   
004450                                                                  
004460*--<契約内容処理>                                                 
004470     PERFORM  契約内容処理.                                       
004480                                                                  
004490*--<Ｗ－消費税率処理>                                             
004500     PERFORM  Ｗ－消費税率処理.                                   
004510                                                                  
004520*--<信用保険区分処理>                                             
004530     PERFORM  信用保険区分処理.                                   
004540                                                                  
004550*--<計算方式処理>                                                 
004560     PERFORM  計算方式処理.                                       
004570                                                                  
004580*--<出力編集>                                                     
004590     PERFORM  出力編集.                                           
004600                                                                  
004610*--<出力処理>                                                     
004620     PERFORM  出力処理.                                           
004630                                                                  
004640*--<結合テーブル読込（２件目以降）>                               
004650	   PERFORM   結合テーブル読込２件目以降.                        
004660*                                                                 
004670 主処理－ＥＸＩＴ.                                                
004680     EXIT.                                                        
004690                                                                  
004700******************************************************************
004710*    与信管理先コード処理                                        *
004720***************************************************************** 
004730 与信管理先コード処理                        SECTION.             
004740 与信管理先コード処理－ＳＴＡＲＴ.                                
004750     PERFORM  管理与信先コード処理.                               
004760                                                                  
004770 与信管理先コード処理－ＥＸＩＴ.                                  
004780     EXIT.                                                        
004790******************************************************************
004800* 管理与信先コード処理.                                 NO.1     *
004810****************************************************************  
004820 管理与信先コード処理                   SECTION.                  
004830 管理与信先コード処理－ＳＴＡＲＴ.                                
004840        MOVE   ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード           
004850                                  TO           ＷＳ－管理与信先.  
004860      EVALUATE  ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード          
004870         WHEN   '02683250'                                        
004880                MOVE  '02683233'  TO                              
004890                    ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード      
004900         WHEN   'T2677944'                                        
004910                MOVE  'T2672500'  TO                              
004920                    ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード      
004930         WHEN   'S1519455'                                        
004940                MOVE  'S1519684'  TO                              
004950                    ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード      
004960         WHEN   OTHER                                             
004970*--<変換テーブル処理        >                                     
004980                PERFORM  変換テーブル処理                         
004990      END-EVALUATE.                                               
005000 管理与信先コード処理－ＥＸＩＴ.                                  
005010     EXIT.                                                        
005020******************************************************************
005030* 変換テーブル処理.                                              *
005040****************************************************************  
005050 変換テーブル処理                       SECTION.                  
005060 変換テーブル処理－ＳＴＡＲＴ.                                    
005070       
      *      EXEC SQL                                                   
005080*        SELECT  新取引先コード,                                  
005090*                取引先コード                                     
005100*         INTO   :ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード,       
005110*                :ＩＫＯ００１－取引先コード                      
005120*         FROM   IKOTBL001                                        
005130*         WHERE  取引先コード =                                   
005140*                      :ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード  
005150*          AND   目的ＣＤ = '2'                                   
005160*                                                                 
005170*     END-EXEC.
             CALL "SQLADR" USING SQ0002 SQL-STMT
             MOVE 1 TO SQL-ITERS
             MOVE 261 TO SQL-OFFSET
             MOVE 0 TO SQL-OCCURS
             MOVE 1 TO SQL-SELERR
             CALL "SQLADR" USING
                 SQLCUD
                 SQL-CUD
             CALL "SQLADR" USING
                 SQLCA
                 SQL-SQLEST
             MOVE 256 TO SQL-SQLETY
             CALL "SQLADR" USING
                 ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード
                 SQL-SQHSTV(1)
             MOVE 8 TO SQL-SQHSTL(1)
             MOVE 0 TO SQL-SQHSTS(1)
             MOVE 0 TO SQL-SQINDV(1)
             MOVE 0 TO SQL-SQINDS(1)
             MOVE 0 TO SQL-SQHARM(1)
             CALL "SQLADR" USING
                 ＩＫＯ００１－取引先コード
                 SQL-SQHSTV(2)
             MOVE 8 TO SQL-SQHSTL(2)
             MOVE 0 TO SQL-SQHSTS(2)
             MOVE 0 TO SQL-SQINDV(2)
             MOVE 0 TO SQL-SQINDS(2)
             MOVE 0 TO SQL-SQHARM(2)
             CALL "SQLADR" USING
                 ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード
                 SQL-SQHSTV(3)
             MOVE 8 TO SQL-SQHSTL(3)
             MOVE 0 TO SQL-SQHSTS(3)
             MOVE 0 TO SQL-SQINDV(3)
             MOVE 0 TO SQL-SQINDS(3)
             MOVE 0 TO SQL-SQHARM(3)
             CALL "SQLADR" USING
                 SQL-SQHSTV(1)
                 SQL-SQPHSV
             CALL "SQLADR" USING
                 SQL-SQHSTL(1)
                 SQL-SQPHSL
             CALL "SQLADR" USING
                 SQL-SQHSTS(1)
                 SQL-SQPHSS
             CALL "SQLADR" USING
                 SQL-SQINDV(1)
                 SQL-SQPIND
             CALL "SQLADR" USING
                 SQL-SQINDS(1)
                 SQL-SQPINS
             CALL "SQLADR" USING
                 SQL-SQHARM(1)
                 SQL-SQPARM
             CALL "SQLADR" USING
                 SQL-SQHARC(1)
                 SQL-SQPARC

             CALL "SQLBEX" USING
                 SQLCTX
                 SQLEXD
                 SQLFPN

             CALL "SQLGSS" USING
                SQLSTATE
                 .
005180*----------------------------------------------------------------*
005190*   変換テーブル処理                                              
005200*---------------------------------------------------------------- 
005210     EVALUATE  SQLCODE                                            
005220        WHEN  定数－ＳＱＬＯＫ                                    
005230*--<       正常 >                                                 
005240           CONTINUE                                               
005250        WHEN  OTHER                                               
005260*--<       カーソルＯＰＥＮエラー >                               
005270           DISPLAY  "信先コードと目的ＣＤを表示"                  
005280           DISPLAY ＩＫＯ００１－取引先コード, "="                
005290                   ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード,      
005300                   "目的ＣＤ = '2'"                               
005310           MOVE    'N'       TO         Ｗ－管理与信先状態        
005320     END-EVALUATE.                                                
005330 変換テーブル処理－ＥＸＩＴ.                                      
005340     EXIT.                                                        
005350******************************************************************
005360* 再リース回数処理                                        NO.3   *
005370***************************************************************** 
005380 再リース回数処理                     SECTION.                    
005390 再リース回数処理－ＳＴＡＲＴ.                                    
005400     
      *    EXEC SQL                                                     
005410*     SELECT   MAX(再リース回数)                                  
005420*       INTO  :ＩＫＯ００２－再リース回数                         
005430*       FROM  IKOTBL002                                           
005440*      WHERE   契約ＮＯ = :ＹＯＳＨＩＮＭＥＩＳＡＩ－契約ＮＯ     
005450*       AND   旧債権勘定処理コード =                              
005460*                          :ＹＯＳＨＩＮＭＥＩＳＡＩ－勘定コード  
005470*    END-EXEC.
           CALL "SQLADR" USING SQ0003 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 288 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ＩＫＯ００２－再リース回数
               SQL-SQHSTV(1)
           MOVE 2 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－契約ＮＯ
               SQL-SQHSTV(2)
           MOVE 9 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ＹＯＳＨＩＮＭＥＩＳＡＩ－勘定コード
               SQL-SQHSTV(3)
           MOVE 2 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005480*----------------------------------------------------------------*
005490*   再リース回数処理                                             *
005500*---------------------------------------------------------------- 
005510     EVALUATE  SQLCODE                                            
005520        WHEN  定数－ＳＱＬＯＫ                                    
005530*--<       正常 >                                                 
005540           CONTINUE                                               
005550        WHEN  OTHER                                               
005560*--<       カーソルＯＰＥＮエラー >                               
005570           MOVE       -60           TO    Ｗ－エラーコード        
005580           PERFORM  エラー判定処理                                
005590           MOVE       ZERO          TO    出カー再リース回数      
005600     END-EVALUATE.                                                
005610 再リース回数処理－ＥＸＩＴ.                                      
005620     EXIT.                                                        
005630                                                                  
005640******************************************************************
005650*         契約種類主契約区分処理                        NO.4 NO.7*
005660***************************************************************** 
005670 契約種類主契約区分処理                 SECTION.                  
005680 契約種類主契約区分処理－ＳＴＡＲＴ.                              
005690     
      *    EXEC SQL                                                     
005700*     SELECT   MIN( 契約種類 ),                                   
005710*              主契約区分                                         
005720*       INTO  :ＩＫＯ００２－契約種類,                            
005730*             :ＩＫＯ００２－主契約区分                           
005740*       FROM  IKOTBL002                                           
005750*      WHERE  再リース回数 = :ＩＫＯ００２－再リース回数          
005760*      GROUP BY  主契約区分                                       
005770*    END-EXEC.
           CALL "SQLADR" USING SQ0004 SQL-STMT
           MOVE 1 TO SQL-ITERS
           MOVE 315 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           MOVE 1 TO SQL-SELERR
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY
           CALL "SQLADR" USING
               ＩＫＯ００２－契約種類
               SQL-SQHSTV(1)
           MOVE 3 TO SQL-SQHSTL(1)
           MOVE 0 TO SQL-SQHSTS(1)
           MOVE 0 TO SQL-SQINDV(1)
           MOVE 0 TO SQL-SQINDS(1)
           MOVE 0 TO SQL-SQHARM(1)
           CALL "SQLADR" USING
               ＩＫＯ００２－主契約区分
               SQL-SQHSTV(2)
           MOVE 1 TO SQL-SQHSTL(2)
           MOVE 0 TO SQL-SQHSTS(2)
           MOVE 0 TO SQL-SQINDV(2)
           MOVE 0 TO SQL-SQINDS(2)
           MOVE 0 TO SQL-SQHARM(2)
           CALL "SQLADR" USING
               ＩＫＯ００２－再リース回数
               SQL-SQHSTV(3)
           MOVE 2 TO SQL-SQHSTL(3)
           MOVE 0 TO SQL-SQHSTS(3)
           MOVE 0 TO SQL-SQINDV(3)
           MOVE 0 TO SQL-SQINDS(3)
           MOVE 0 TO SQL-SQHARM(3)
           CALL "SQLADR" USING
               SQL-SQHSTV(1)
               SQL-SQPHSV
           CALL "SQLADR" USING
               SQL-SQHSTL(1)
               SQL-SQPHSL
           CALL "SQLADR" USING
               SQL-SQHSTS(1)
               SQL-SQPHSS
           CALL "SQLADR" USING
               SQL-SQINDV(1)
               SQL-SQPIND
           CALL "SQLADR" USING
               SQL-SQINDS(1)
               SQL-SQPINS
           CALL "SQLADR" USING
               SQL-SQHARM(1)
               SQL-SQPARM
           CALL "SQLADR" USING
               SQL-SQHARC(1)
               SQL-SQPARC

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
005780                                                                  
005790*---------------------------------------------------------------- 
005800*   契約種類主契約区分処理                                  *     
005810*---------------------------------------------------------------- 
005820     EVALUATE  SQLCODE                                            
005830        WHEN  定数－ＳＱＬＯＫ                                    
005840*--<       正常 >                                                 
005850           CONTINUE                                               
005860        WHEN  OTHER                                               
005870*--<       カーソルＯＰＥＮエラー >                               
005880           MOVE       -70           TO    Ｗ－エラーコード        
005890           PERFORM  エラー判定処理                                
005900           MOVE       ZERO          TO   ＩＫＯ００２－契約種類   
005910           MOVE       ZERO          TO   ＩＫＯ００２－契約種類   
005920     END-EVALUATE.                                                
005930 契約種類主契約区分処理－ＥＸＩＴ.                                
005940     EXIT.                                                        
005950******************************************************************
005960*        契約先コード処理                       NO.8*            *
005970******************************************************************
005980 契約先コード処理                       SECTION.                  
005990 契約先コード処理－ＳＴＡＲＴ.                                    
006000       
      *      EXEC SQL                                                   
006010*        SELECT  枝番                                             
006020*         INTO   :ＩＫＯ００１－枝番                              
006030*         FROM   IKOTBL001                                        
006040*         WHERE  取引先コード = :ＷＳ－管理与信先                 
006050*          AND   目的ＣＤ = '2'                                   
006060*                                                                 
006070*     END-EXEC.
             CALL "SQLADR" USING SQ0005 SQL-STMT
             MOVE 1 TO SQL-ITERS
             MOVE 342 TO SQL-OFFSET
             MOVE 0 TO SQL-OCCURS
             MOVE 1 TO SQL-SELERR
             CALL "SQLADR" USING
                 SQLCUD
                 SQL-CUD
             CALL "SQLADR" USING
                 SQLCA
                 SQL-SQLEST
             MOVE 256 TO SQL-SQLETY
             CALL "SQLADR" USING
                 ＩＫＯ００１－枝番
                 SQL-SQHSTV(1)
             MOVE 3 TO SQL-SQHSTL(1)
             MOVE 0 TO SQL-SQHSTS(1)
             MOVE 0 TO SQL-SQINDV(1)
             MOVE 0 TO SQL-SQINDS(1)
             MOVE 0 TO SQL-SQHARM(1)
             CALL "SQLADR" USING
                 ＷＳ－管理与信先
                 SQL-SQHSTV(2)
             MOVE 8 TO SQL-SQHSTL(2)
             MOVE 0 TO SQL-SQHSTS(2)
             MOVE 0 TO SQL-SQINDV(2)
             MOVE 0 TO SQL-SQINDS(2)
             MOVE 0 TO SQL-SQHARM(2)
             CALL "SQLADR" USING
                 SQL-SQHSTV(1)
                 SQL-SQPHSV
             CALL "SQLADR" USING
                 SQL-SQHSTL(1)
                 SQL-SQPHSL
             CALL "SQLADR" USING
                 SQL-SQHSTS(1)
                 SQL-SQPHSS
             CALL "SQLADR" USING
                 SQL-SQINDV(1)
                 SQL-SQPIND
             CALL "SQLADR" USING
                 SQL-SQINDS(1)
                 SQL-SQPINS
             CALL "SQLADR" USING
                 SQL-SQHARM(1)
                 SQL-SQPARM
             CALL "SQLADR" USING
                 SQL-SQHARC(1)
                 SQL-SQPARC

             CALL "SQLBEX" USING
                 SQLCTX
                 SQLEXD
                 SQLFPN

             CALL "SQLGSS" USING
                SQLSTATE
                 .
006080                                                                  
006090*---------------------------------------------------------------- 
006100*   契約先コード処理                                              
006110*---------------------------------------------------------------- 
006120     EVALUATE  SQLCODE                                            
006130        WHEN  定数－ＳＱＬＯＫ                                    
006140*--<       正常 >                                                 
006150           CONTINUE                                               
006160        WHEN  OTHER                                               
006170*--<       カーソルＯＰＥＮエラー >                               
006180           MOVE       -80           TO    Ｗ－エラーコード        
006190           PERFORM  エラー判定処理                                
006200           MOVE       ZERO          TO   ＩＫＯ００１－枝番       
006210     END-EVALUATE.                                                
006220 契約先コード処理－ＥＸＩＴ.                                      
006230     EXIT.                                                        
006240******************************************************************
006250*        契約内容         NO.9  NO.66                            *
006260******************************************************************
006270 契約内容処理                       SECTION.                      
006280 契約内容処理－ＳＴＡＲＴ.                                        
006290      
      *     EXEC SQL                                                    
006300*        SELECT  契約件名,                                        
006310*                否認区分                                         
006320*         INTO   :Ｄ３１－契約件名,                               
006330*                :Ｄ３１－否認区分                                
006340*         FROM   D31KYK_TBL                                       
006350*         WHERE  契約番号 = :ＹＯＳＨＩＮＭＥＩＳＡＩ－契約ＮＯ   
006360*          AND   再リース回数 = :ＩＫＯ００２－再リース回数       
006370*      END-EXEC.
            CALL "SQLADR" USING SQ0006 SQL-STMT
            MOVE 1 TO SQL-ITERS
            MOVE 365 TO SQL-OFFSET
            MOVE 0 TO SQL-OCCURS
            MOVE 1 TO SQL-SELERR
            CALL "SQLADR" USING
                SQLCUD
                SQL-CUD
            CALL "SQLADR" USING
                SQLCA
                SQL-SQLEST
            MOVE 256 TO SQL-SQLETY
            CALL "SQLADR" USING
                Ｄ３１－契約件名 IN
                契約内容
                SQL-SQHSTV(1)
            MOVE 60 TO SQL-SQHSTL(1)
            MOVE 0 TO SQL-SQHSTS(1)
            MOVE 0 TO SQL-SQINDV(1)
            MOVE 0 TO SQL-SQINDS(1)
            MOVE 0 TO SQL-SQHARM(1)
            CALL "SQLADR" USING
                Ｄ３１－否認区分 IN
                契約内容
                SQL-SQHSTV(2)
            MOVE 1 TO SQL-SQHSTL(2)
            MOVE 0 TO SQL-SQHSTS(2)
            MOVE 0 TO SQL-SQINDV(2)
            MOVE 0 TO SQL-SQINDS(2)
            MOVE 0 TO SQL-SQHARM(2)
            CALL "SQLADR" USING
                ＹＯＳＨＩＮＭＥＩＳＡＩ－契約ＮＯ
                SQL-SQHSTV(3)
            MOVE 9 TO SQL-SQHSTL(3)
            MOVE 0 TO SQL-SQHSTS(3)
            MOVE 0 TO SQL-SQINDV(3)
            MOVE 0 TO SQL-SQINDS(3)
            MOVE 0 TO SQL-SQHARM(3)
            CALL "SQLADR" USING
                ＩＫＯ００２－再リース回数
                SQL-SQHSTV(4)
            MOVE 2 TO SQL-SQHSTL(4)
            MOVE 0 TO SQL-SQHSTS(4)
            MOVE 0 TO SQL-SQINDV(4)
            MOVE 0 TO SQL-SQINDS(4)
            MOVE 0 TO SQL-SQHARM(4)
            CALL "SQLADR" USING
                SQL-SQHSTV(1)
                SQL-SQPHSV
            CALL "SQLADR" USING
                SQL-SQHSTL(1)
                SQL-SQPHSL
            CALL "SQLADR" USING
                SQL-SQHSTS(1)
                SQL-SQPHSS
            CALL "SQLADR" USING
                SQL-SQINDV(1)
                SQL-SQPIND
            CALL "SQLADR" USING
                SQL-SQINDS(1)
                SQL-SQPINS
            CALL "SQLADR" USING
                SQL-SQHARM(1)
                SQL-SQPARM
            CALL "SQLADR" USING
                SQL-SQHARC(1)
                SQL-SQPARC

            CALL "SQLBEX" USING
                SQLCTX
                SQLEXD
                SQLFPN

            CALL "SQLGSS" USING
               SQLSTATE
                .
006380                                                                  
006390*---------------------------------------------------------------- 
006400*   契約内容処理                                                  
006410*---------------------------------------------------------------- 
006420     EVALUATE  SQLCODE                                            
006430        WHEN  定数－ＳＱＬＯＫ                                    
006440*--<       正常 >                                                 
006450           COMPUTE   Ｗ－契約内容入力－件数  =                    
006460                              Ｗ－契約内容入力－件数   +   1      
006470        WHEN  OTHER                                               
006480*--<       カーソルＯＰＥＮエラー >                               
006490           MOVE       -90           TO    Ｗ－エラーコード        
006500           PERFORM  エラー判定処理                                
006510     END-EVALUATE.                                                
006520 契約内容処理－ＥＸＩＴ.                                          
006530     EXIT.                                                        
006540                                                                  
006550                                                                  
006560******************************************************************
006570*       Ｗ－消費税率処理                                         *
006580******************************************************************
006590 Ｗ－消費税率処理                       SECTION.                  
006600 Ｗ－消費税率処理－ＳＴＡＲＴ.                                    
006610       
      *      EXEC SQL                                                   
006620*        SELECT  最新消費税区分                                   
006630*         INTO   :Ｄ３２－最新消費税区分                          
006640*         FROM   D32SAK_TBL                                       
006650*         WHERE  契約番号 = :ＹＯＳＨＩＮＭＥＩＳＡＩ－契約ＮＯ   
006660*          AND   再リース回数 = :ＩＫＯ００２－再リース回数       
006670*          AND   契約種類  = :ＩＫＯ００２－契約種類              
006680*                                                                 
006690*     END-EXEC.
             CALL "SQLADR" USING SQ0007 SQL-STMT
             MOVE 1 TO SQL-ITERS
             MOVE 396 TO SQL-OFFSET
             MOVE 0 TO SQL-OCCURS
             MOVE 1 TO SQL-SELERR
             CALL "SQLADR" USING
                 SQLCUD
                 SQL-CUD
             CALL "SQLADR" USING
                 SQLCA
                 SQL-SQLEST
             MOVE 256 TO SQL-SQLETY
             CALL "SQLADR" USING
                 Ｄ３２－最新消費税区分 IN
                 債権
                 SQL-SQHSTV(1)
             MOVE 2 TO SQL-SQHSTL(1)
             MOVE 0 TO SQL-SQHSTS(1)
             MOVE 0 TO SQL-SQINDV(1)
             MOVE 0 TO SQL-SQINDS(1)
             MOVE 0 TO SQL-SQHARM(1)
             CALL "SQLADR" USING
                 ＹＯＳＨＩＮＭＥＩＳＡＩ－契約ＮＯ
                 SQL-SQHSTV(2)
             MOVE 9 TO SQL-SQHSTL(2)
             MOVE 0 TO SQL-SQHSTS(2)
             MOVE 0 TO SQL-SQINDV(2)
             MOVE 0 TO SQL-SQINDS(2)
             MOVE 0 TO SQL-SQHARM(2)
             CALL "SQLADR" USING
                 ＩＫＯ００２－再リース回数
                 SQL-SQHSTV(3)
             MOVE 2 TO SQL-SQHSTL(3)
             MOVE 0 TO SQL-SQHSTS(3)
             MOVE 0 TO SQL-SQINDV(3)
             MOVE 0 TO SQL-SQINDS(3)
             MOVE 0 TO SQL-SQHARM(3)
             CALL "SQLADR" USING
                 ＩＫＯ００２－契約種類
                 SQL-SQHSTV(4)
             MOVE 3 TO SQL-SQHSTL(4)
             MOVE 0 TO SQL-SQHSTS(4)
             MOVE 0 TO SQL-SQINDV(4)
             MOVE 0 TO SQL-SQINDS(4)
             MOVE 0 TO SQL-SQHARM(4)
             CALL "SQLADR" USING
                 SQL-SQHSTV(1)
                 SQL-SQPHSV
             CALL "SQLADR" USING
                 SQL-SQHSTL(1)
                 SQL-SQPHSL
             CALL "SQLADR" USING
                 SQL-SQHSTS(1)
                 SQL-SQPHSS
             CALL "SQLADR" USING
                 SQL-SQINDV(1)
                 SQL-SQPIND
             CALL "SQLADR" USING
                 SQL-SQINDS(1)
                 SQL-SQPINS
             CALL "SQLADR" USING
                 SQL-SQHARM(1)
                 SQL-SQPARM
             CALL "SQLADR" USING
                 SQL-SQHARC(1)
                 SQL-SQPARC

             CALL "SQLBEX" USING
                 SQLCTX
                 SQLEXD
                 SQLFPN

             CALL "SQLGSS" USING
                SQLSTATE
                 .
006700                                                                  
006710*---------------------------------------------------------------- 
006720*   Ｗ－消費税率処理                                              
006730*---------------------------------------------------------------- 
006740     EVALUATE  SQLCODE                                            
006750        WHEN  定数－ＳＱＬＯＫ                                    
006760*--<       正常 >                                                 
006770              COMPUTE   Ｗ－債権入力－件数       =                
006780                            Ｗ－債権入力－件数      +   1         
006790              EVALUATE  Ｄ３２－最新消費税区分                    
006800                 WHEN   '11'                                      
006810                        MOVE   0.03   TO     Ｗ－消費税率         
006820                 WHEN   '12'                                      
006830                        MOVE   0.05   TO     Ｗ－消費税率         
006840                 WHEN  OTHER                                      
006850                        MOVE   0      TO     Ｗ－消費税率         
006860              END-EVALUATE                                        
006870        WHEN  OTHER                                               
006880*--<       カーソルＯＰＥＮエラー >                               
006890           MOVE       -100           TO    Ｗ－エラーコード       
006900           MOVE       0.05           TO    Ｗ－消費税率           
006910           PERFORM  エラー判定処理                                
006920     END-EVALUATE.                                                
006930 Ｗ－消費税率処理－ＥＸＩＴ.                                      
006940     EXIT.                                                        
006950******************************************************************
006960*       信用保険区分処理                             NO.23       *
006970***************************************************************** 
006980 信用保険区分処理                     SECTION.                    
006990 信用保険区分－ＳＴＡＲＴ.                                        
007000       EVALUATE  ＹＯＳＨＩＮＭＥＩＳＡＩ－信用保険付保区分       
007010        WHEN  '0'                                                 
007020*--<       正常 >                                                 
007030              CONTINUE                                            
007040        WHEN  OTHER                                               
007050*--<       カーソルＯＰＥＮエラー >                               
007060           MOVE          '1'         TO                           
007070                       ＹＯＳＨＩＮＭＥＩＳＡＩ－信用保険付保区分 
007080      END-EVALUATE.                                               
007090 信用保険区分処理－ＥＸＩＴ.                                      
007100     EXIT.                                                        
007110******************************************************************
007120*       計算方式処理                             NO.29           *
007130***************************************************************** 
007140 計算方式処理                         SECTION.                    
007150 計算方式処理－ＳＴＡＲＴ.                                        
007160       EVALUATE  ＹＯＳＨＩＮＭＥＩＳＡＩ－計算方式               
007170        WHEN  '0'                                                 
007180*--<       '0' >                                                  
007190               MOVE       '1'       TO                            
007200                                ＹＯＳＨＩＮＭＥＩＳＡＩ－計算方式
007210        WHEN  '1'                                                 
007220*--<       '1' >                                                  
007230               EVALUATE   ＹＯＳＨＩＮＭＥＩＳＡＩ－請求サイクル  
007240                  WHEN   '012'                                    
007250                          MOVE     '0'       TO                   
007260                            ＹＯＳＨＩＮＭＥＩＳＡＩ－請求サイクル
007270                  WHEN  OTHER                                     
007280                          MOVE     '2'       TO                   
007290                            ＹＯＳＨＩＮＭＥＩＳＡＩ－請求サイクル
007300               END-EVALUATE                                       
007310          WHEN  '2'                                               
007320*--<       '2' >                                                  
007330                 CONTINUE                                         
007340                                                                  
007350      END-EVALUATE.                                               
007360 計算方式処理－ＥＸＩＴ.                                          
007370     EXIT.                                                        
007380******************************************************************
007390*     出力編集	                                               *
007400***************************************************************** 
007410 出力編集                               SECTION.                  
007420 出力編集－ＳＴＡＲＴ.                                            
007430*NO.1                                                             
007440       MOVE   ＹＯＳＨＩＮＫＩＨＯＮ－管理与信先コード     TO     
007450                                      出カー与信管理先コード.     
007460*N0.2                                                             
007470       MOVE   ＹＯＳＨＩＮＭＥＩＳＡＩ－契約ＮＯ           TO     
007480                                      出カー契約番号.             
007490*NO.3                                                             
007500       MOVE   ＩＫＯ００２－再リース回数                   TO     
007510                                      出カー再リース回数.         
007520*NO.4                                                             
007530       MOVE   ＩＫＯ００２－契約種類                       TO     
007540                                      出カー契約種類.             
007550*NO.5                                                             
007560       MOVE   ＹＯＳＨＩＮＭＥＩＳＡＩ－勘定コード         TO     
007570                                      出カー勘定処理コード.       
007580*N0.6                                                             
007590       MOVE   ＹＯＳＨＩＮＭＥＩＳＡＩ－事業所コード       TO     
007600                                      出カー部課コード.           
007610*NO.7                                                             
007620       MOVE   ＩＫＯ００２－主契約区分                     TO     
007630                                      出カー主契約区分.           
007640*NO.8                                                             
007650       MOVE   ＩＫＯ００１－枝番                           TO     
007660                                      出カー契約先コード.         
007670*NO.9                                                             
007680       MOVE   Ｄ３１－契約件名                             TO     
007690                                      出カー契約件名.             
007700*NO.10                                                            
007710       MOVE   ＹＯＳＨＩＮＭＥＩＳＡＩ－事故日             TO     
007720                                      出カー取引年月日.           
007730*NO.11                                                            
007740       MOVE   ＹＯＳＨＩＮＭＥＩＳＡＩ－契約日             TO     
007750                                      出カー契約年月日.           
007760*NO.12                                                            
007770       MOVE   ＹＯＳＨＩＮＭＥＩＳＡＩ－検収日             TO     
007780                                      出カー検収年月日.           
007790*NO.13                                                            
007800       MOVE   ＹＯＳＨＩＮＭＥＩＳＡＩ－満了日             TO     
007810                                      出カー満了年月日.           
007820*NO.14                                                            
007830       MOVE   ＹＯＳＨＩＮＭＥＩＳＡＩ－当債権残           TO     
007840                                      出カー対外債権残高.         
007850*NO.15                                                            
007860       COMPUTE   出カー対外債権残高消費税  =  Ｗ－消費税率  *     
007870                              ＹＯＳＨＩＮＭＥＩＳＡＩ－当債権残 .
007880*NO.16                                                            
007890       MOVE            ZERO           TO        出カー前受金残高. 
007900*NO.17                                                            
007910       MOVE            ZERO           TO   出カー前受金残高消費税.
007920*NO.18                                                            
007930       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－貸付金別口       TO      
007940                                      出カー貸付金別口.           
007950*NO.19                                                            
007960       COMPUTE  出カー貸付金別口消費税  =   Ｗ－消費税率     *    
007970                             ＹＯＳＨＩＮＭＥＩＳＡＩ－貸付金別口.
007980*NO.20                                                            
007990       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－非稼動資産,      TO      
008000                                       出カー非稼働資産.          
008010*NO.21                                                            
008020       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－貯蔵品           TO      
008030                                       出カー貯蔵品.              
008040*NO.22                                                            
008050       MOVE            ZERO           TO           出カー担保残高.
008060*NO.23                                                            
008070       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－信用保険付保区分 TO      
008080                                       出カー信用保険区分.        
008090*NO.24                                                            
008100       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－信用保険求償     TO      
008110                                       出カー信用保険求償.        
008120*NO.25                                                            
008130       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－契約金額         TO      
008140                                       出カー契約金額.            
008150*NO.26                                                            
008160       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－入金日           TO      
008170                                       出カー入金日.              
008180*NO.27                                                            
008190       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－開始回数         TO      
008200                                       出カー開始回数.            
008210*NO.28                                                            
008220       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－明細支払回数     TO      
008230                                       出カー明細支払回数.        
008240*NO.29                                                            
008250       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－計算方式,        TO      
008260                                       出カー計算方式.            
008270*NO.30                                                            
008280       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－請求サイクル     TO      
008290                                       出カー請求サイクル.        
008300*NO.31                                                            
008310       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－延滞開始日       TO      
008320                                       出カー延滞開始年月日.      
008330*NO.32                                                            
008340       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－歯抜けフラグ１   TO      
008350                                       出カー歯抜フラグ１.        
008360*NO.33                                                            
008370       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－歯抜けフラグ２   TO      
008380                                       出カー歯抜フラグ２.        
008390*NO.34                                                            
008400       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－残価額           TO      
008410                                       出カー残価額.              
008420*NO.35                                                            
008430       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－月割Ｌ料         TO      
008440                                       出カー月割Ｌ料.            
008450*NO.36                                                            
008460       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－ヤクベン区分     TO      
008470                                       出カー約弁区分.            
008480*NO.37                                                            
008490       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－事故債権残       TO      
008500                                       出カー事故債権残.          
008510*NO.38                                                            
008520       COMPUTE  出カー事故債権残消費税  =  Ｗ－消費税率  *        
008530                            ＹＯＳＨＩＮＭＥＩＳＡＩ－事故債権残. 
008540*NO.39                                                            
008550       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－事故元本残       TO      
008560                                       出カー事故元本残.          
008570*NO.40                                                            
008580       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－当債権残         TO      
008590                                       出カー当月末債権残.        
008600*NO.41                                                            
008610       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－当元本残         TO      
008620                                       出カー当月末元本残.        
008630*NO.42                                                            
008640       MOVE            ZERO           TO    出カーＮ当月末債権残. 
008650*NO.43                                                            
008660       MOVE            ZERO           TO    出カーＮ当月末元本残. 
008670*NO.44                                                            
008680       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－未収元本         TO      
008690                                       出カー未収元本.            
008700*NO.45                                                            
008710       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－未収利息         TO      
008720                                       出カー未収利息.            
008730*NO.46                                                            
008740       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－未徴収金         TO      
008750                                       出カー未徴収金.            
008760*NO.47                                                            
008770       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－Ｂ未徴収金       TO      
008780                                       出カーＢ未徴収金.          
008790*NO.48                                                            
008800       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－売却金額         TO      
008810                                       出カー売却金額.            
008820*NO.49                                                            
008830       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－固定利率         TO      
008840                                       出カー固定利率.            
008850*NO.50                                                            
008860       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－金利変動区分     TO      
008870                                       出カー金利変動区分.        
008880*NO.51                                                            
008890       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－スプレッド       TO      
008900                                       出カースプレッド.          
008910*NO.52                                                            
008920       MOVE    ＹＯＳＨＩＮＭＥＩＳＡＩ－連動金利区分     TO      
008930                                       出カー連動金利区分.        
008940*NO.53                                                            
008950       MOVE           SPACE          TO        出カー備考.        
008960*NO.54                                                            
008970       MOVE           ZERO           TO        出カー対外元本残高.
008980*NO.55                                                            
008990       MOVE   出カー対外債権残高     TO                           
009000                                         出カー前月末対外債権残高.
009010*NO.56                                                            
009020      MOVE  出カー対外債権残高消費税 TO                           
009030                                   出カー前月末対外債権残高消費税.
009040*NO.57                                                            
009050      MOVE  出カー当月末元本残       TO                           
009060                                   出カー前月末対外元本残高.      
009070*NO.58                                                            
009080      MOVE  出カー前受金残高         TO   出カー前月末前受金残高. 
009090*NO.59                                                            
009100      MOVE  出カー前月末前受金残高   TO                           
009110                                    出カー前月末前受金残高消費税. 
009120*NO.60                                                            
009130      MOVE  出カー貸付金別口         TO   出カー前月末貸付金別口. 
009140*NO.61                                                            
009150      MOVE  出カー貸付金別口消費税   TO                           
009160                                     出カー前月末貸付金別口消費税.
009170*NO.62                                                            
009180      MOVE  出カー非稼働資産         TO   出カー前月末非稼働資産. 
009190*NO.63                                                            
009200      MOVE  出カー貯蔵品             TO   出カー前月末貯蔵品.     
009210*NO.64                                                            
009220      MOVE        '9'                TO   出カー解約理由.         
009230*NO.65                                                            
009240      MOVE  ＹＯＳＨＩＮＫＩＨＯＮ－解約区分         TO           
009250                                          出カー解約区分.         
009260*NO.66                                                            
009270      MOVE  Ｄ３１－否認区分         TO   出カー否認区分.         
009280*NO.67                                                            
009290      COMPUTE   出カー当月末債権残高消費税  =  Ｗ－消費税率  *    
009300                             ＹＯＳＨＩＮＭＥＩＳＡＩ－当債権残 . 
009310*NO.68                                                            
009320      COMPUTE   出カー未徴収金消費税        =  Ｗ－消費税率  *    
009330                             ＹＯＳＨＩＮＭＥＩＳＡＩ－未徴収金.  
009340*NO.69                                                            
009350      MOVE   Ｗ－年月日              TO    出カー登録年月日.      
009360*NO.70                                                            
009370      MOVE   Ｗ－システム時刻        TO    出カー登録時間.        
009380*NO.71                                                            
009390      MOVE   Ｗ－担当者              TO    出カー登録担当者.      
009400*NO.72                                                            
009410      MOVE   ＹＯＳＨＩＮＭＥＩＳＡＩ－更新日付       TO          
009420                                           出カー更新年月日.      
009430*NO.73                                                            
009440      MOVE   Ｗ－システム時刻        TO    出カー更新時間.        
009450*NO.74                                                            
009460      MOVE   Ｗ－担当者              TO    出カー更新者.          
009470*NO.75                                                            
009480      MOVE   Ｗ－担当者              TO    出カー入力担当者コード.
009490 出力編集－ＥＸＩＴ.                                              
009500     EXIT.                                                        
009510                                                                  
009520******************************************************************
009530*     出力処理	                                               *
009540***************************************************************** 
009550 出力処理                              SECTION.                   
009560 出力処理－ＳＴＡＲＴ.                                            
009570*                                                                 
009580     WRITE  出カーレコード.                                       
009590*                                                                 
009600*--< 出力処理の状態判定 >                                         
009610     EVALUATE  Ｗ－状態                                           
009620        WHEN  ZERO                                                
009630*--<       出力処理の加算 >                                       
009640           COMPUTE   Ｗ－出力－件数  =  Ｗ－出力－件数  + 1       
009650        WHEN  OTHER                                               
009660*--<       ファイル出力エラー >                                   
009670           MOVE     -110                TO  Ｗ－エラーコード      
009680           PERFORM  エラー判定処理                                
009690     END-EVALUATE.                                                
009700 出力処理－ＥＸＩＴ.                                              
009710     EXIT.                                                        
009720******************************************************************
009730*   結合テーブル読込（２件目以降                                 *
009740******************************************************************
009750 結合テーブル読込２件目以降             SECTION.                  
009760 結合テーブル読込２件目以降－ＳＴＡＲＴ.                          
009770      PERFORM  結合テーブルカーソル読込.                          
009780 結合テーブル読込２件目以降－ＥＸＩＴ.                            
009790     EXIT.                                                        
009800******************************************************************
009810*    終了処理                                                    *
009820******************************************************************
009830 終了処理                             SECTION.                    
009840 終了処理－ＳＴＡＲＴ.                                            
009850*                                                                 
009860     PERFORM  ＤＢクローズ処理.                                   
009870*                                                                 
009880     PERFORM  ファイルクローズ処理.				
009890                                                                  
009900     PERFORM  件数メッセージ出力.					
009910                                                                  
009920*                                                                 
009930     PERFORM  終了メッセージ出力.                                 
009940*                                                                 
009950*--< プログラム正常終了 >                                         
009960     MOVE  定数－正常状態             TO  PROGRAM-STATUS.         
009970*                                                                 
009980 終了処理－ＥＸＩＴ.                                              
009990     EXIT.                                                        
010000******************************************************************
010010*    終了メッセージ出力                                          *
010020******************************************************************
010030 終了メッセージ出力                   SECTION.                    
010040 終了メッセージ出力－ＳＴＡＲＴ.                                  
010050*                                                                 
010060*----------------------------------------------------------------*
010070*    終了メッセージ出力                                          *
010080*----------------------------------------------------------------*
010090     INITIALIZE                       IF-CHOCO001.                
010100     MOVE  "3"                        TO  共１－イベント種別.     
010110     MOVE  定数－プログラムＩＤ       TO  共１－ソースＩＤ.       
010120     MOVE  "ZERO"                     TO  共１－復帰コード.       
010130     MOVE  "END"                      TO  共１－処理識別.         
010140     MOVE  "プログラム処理終了メッセージ"				
010150                                      TO  共１－その他メッセージ. 
010160     CALL  CLOCO001                USING  IF-CHOCO001.            
010170*                                                                 
010180 終了メッセージ出力－ＥＸＩＴ.                                    
010190     EXIT.                                                        
010200******************************************************************
010210*    ＤＢクローズ                                                *
010220******************************************************************
010230 ＤＢクローズ処理                     SECTION.                    
010240 ＤＢクローズ処理－ＳＴＡＲＴ.                                    
010250*                                                                 
010260*--< カーソル クローズ >                                          
010270     
      *    EXEC SQL                                                     
010280*       CLOSE  CUR1                                               
010290*    END-EXEC.
           MOVE 1 TO SQL-ITERS
           MOVE 427 TO SQL-OFFSET
           MOVE 0 TO SQL-OCCURS
           CALL "SQLADR" USING
               SQLCUD
               SQL-CUD
           CALL "SQLADR" USING
               SQLCA
               SQL-SQLEST
           MOVE 256 TO SQL-SQLETY

           CALL "SQLBEX" USING
               SQLCTX
               SQLEXD
               SQLFPN

           CALL "SQLGSS" USING
              SQLSTATE
               .
010300*                                                                 
010310 ＤＢクローズ処理－ＥＸＩＴ.                                      
010320     EXIT.                                                        
010330******************************************************************
010340*       ファイルクローズ処理.                                    *
010350******************************************************************
010360 ファイルクローズ処理                   SECTION.                  
010370 ファイルクローズ処理－ＳＴＡＲＴ.                                
010380      CLOSE  出カファイル.                                        
010390                                                                  
010400 ファイルクローズ処理－ＥＸＩＴ.                                  
010410     EXIT.                                                        
010420******************************************************************
010430*       件数メッセージ出力.                                 *     
010440******************************************************************
010450 件数メッセージ出力                   SECTION.                    
010460 件数メッセージ出力－ＳＴＡＲＴ.                                  
010470*----------------------------------------------------------------*
010480*   与信基本入力 件数メッセージ入力処理                          *
010490*----------------------------------------------------------------*
010500     INITIALIZE                       IF-CHOCO001.                
010510     MOVE  "3"                        TO  共１－イベント種別.     
010520     MOVE  定数－プログラムＩＤ       TO  共１－ソースＩＤ.       
010530     MOVE  "ZERO"                     TO  共１－復帰コード.       
010540     MOVE  "YOSHINON"                 TO  共１－処理テーブルＩＤ. 
010550     MOVE  "COUNT"                    TO  共１－処理識別.         
010560     MOVE  Ｗ－与信基本入力－件数   TO  共１－データ内容.         
010570     MOVE  "与信(基本)読込件数"                                   
010580                                      TO  共１－その他メッセージ. 
010590     CALL  CLOCO001                  USING  IF-CHOCO001.          
010600*----------------------------------------------------------------*
010610*   与信明細入力 件数メッセージ入力処理                          *
010620*---------------------------------------------------------------- 
010630     INITIALIZE                       IF-CHOCO001.                
010640     MOVE  "3"                        TO  共１－イベント種別.     
010650     MOVE  定数－プログラムＩＤ       TO  共１－ソースＩＤ.       
010660     MOVE  "ZERO"                     TO  共１－復帰コード.       
010670     MOVE  "YOSHINAI"                 TO  共１－処理テーブルＩＤ. 
010680     MOVE  "COUNT"                    TO  共１－処理識別.         
010690     MOVE  Ｗ－与信明細入力－件数    TO  共１－データ内容.        
010700     MOVE  "与信(明細)読込件数"                                   
010710                                       TO  共１－その他メッセージ.
010720     CALL  CLOCO001                  USING  IF-CHOCO001.          
010730*----------------------------------------------------------------*
010740*   契約内容入力 件数メッセージ入力処理                          *
010750*---------------------------------------------------------------- 
010760     INITIALIZE                       IF-CHOCO001.                
010770     MOVE  "3"                        TO  共１－イベント種別.     
010780     MOVE  定数－プログラムＩＤ       TO  共１－ソースＩＤ.       
010790     MOVE  "ZERO"                     TO  共１－復帰コード.       
010800     MOVE  "D31KYK"                   TO  共１－処理テーブルＩＤ. 
010810     MOVE  "COUNT"                    TO  共１－処理識別.         
010820     MOVE  Ｗ－契約内容入力－件数     TO  共１－データ内容.       
010830     MOVE  "契約内容読込件数"                                     
010840                                       TO  共１－その他メッセージ.
010850     CALL  CLOCO001                  USING  IF-CHOCO001.          
010860*----------------------------------------------------------------*
010870*   債権入力 件数メッセージ入力処理                              *
010880*---------------------------------------------------------------- 
010890     INITIALIZE                       IF-CHOCO001.                
010900     MOVE  "3"                        TO  共１－イベント種別.     
010910     MOVE  定数－プログラムＩＤ       TO  共１－ソースＩＤ.       
010920     MOVE  "ZERO"                     TO  共１－復帰コード.       
010930     MOVE  "K32SAK"                   TO  共１－処理テーブルＩＤ. 
010940     MOVE  "COUNT"                    TO  共１－処理識別.         
010950     MOVE  Ｗ－債権入力－件数         TO  共１－データ内容.       
010960     MOVE  "債権読込件数"                                         
010970                                       TO  共１－その他メッセージ.
010980     CALL  CLOCO001                  USING  IF-CHOCO001.          
010990*----------------------------------------------------------------*
011000*    件数メッセージ出力処理                                      *
011010*----------------------------------------------------------------*
011020     INITIALIZE                       IF-CHOCO001.                
011030     MOVE  "3"                        TO  共１－イベント種別.     
011040     MOVE  定数－プログラムＩＤ       TO  共１－ソースＩＤ.       
011050     MOVE  "ZERO"                     TO  共１－復帰コード.    
011060     MOVE  "FFUIS660"                 TO  共１－処理テーブルＩＤ. 
011070     MOVE  "COUNT"                    TO  共１－処理識別.         
011080     MOVE  Ｗ－出力－件数             TO  共１－データ内容.       
011090     MOVE  "管理与信契約(PS)出力件数"                             
011100                                      TO  共１－その他メッセージ. 
011110     CALL  CLOCO001                USING  IF-CHOCO001.            
011120 件数メッセージ出力－ＥＸＩＴ.                                    
011130     EXIT.                                                        
011140                                                                  
011150******************************************************************
011160*    エラー処理                                                  *
011170******************************************************************
011180 エラー判定処理                       SECTION.                    
011190 エラー判定処理－ＳＴＡＲＴ.                                      
011200*                                                                 
011210     MOVE  "Y"                        TO Ｗ－異常終了－フラグ.    
011220     INITIALIZE                           IF-CHOCO001.            
011230*                                                                 
011240     EVALUATE  Ｗ－エラーコード                                   
011250        WHEN  -10                                                 
011260*--<       ＯＲＡＣＬＥ接続失敗 >                                 
011270           MOVE  "1"                  TO  共１－イベント種別      
011280           MOVE  定数－プログラムＩＤ TO  共１－ソースＩＤ        
011290           MOVE  "9"                  TO  共１－復帰コード        
011300           MOVE  "CONNECT"            TO  共１－処理識別          
011310           MOVE  SQLCODE              TO  共１－データ内容        
011320           MOVE  SQLERRMC             TO  共１－その他メッセージ  
011330           CALL  CLOCO001          USING  IF-CHOCO001             
011340*                                                                 
011350                                                                  
011360                                                                  
011370        WHEN   -20                                                
011380*--<結合テーブルカーソル宣言失敗  >                               
011390           MOVE  "1"                  TO  共１－イベント種別      
011400           MOVE  定数－プログラムＩＤ TO  共１－ソースＩＤ        
011410           MOVE  "9"                  TO  共１－復帰コード        
011420           MOVE  "YOSHISAI"           TO  共１－処理テーブルＩＤ  
011430           MOVE  "OPEN"               TO  共１－処理識別          
011440           MOVE  SQLCODE              TO  共１－データ内容        
011450           MOVE  SQLERRMC             TO  共１－その他メッセージ  
011460           CALL  CLOCO001          USING  IF-CHOCO001             
011470*                                                                 
011480        WHEN  -30                                                 
011490*--<   ファイルオープン失敗 >                                     
011500           MOVE  "1"                  TO  共１－イベント種別      
011510           MOVE  定数－プログラムＩＤ TO  共１－ソースＩＤ        
011520           MOVE  "9"                  TO  共１－復帰コード        
011530           MOVE  "FFUIS660"           TO  共１－処理テーブルＩＤ  
011540           MOVE  "OPEN"               TO  共１－処理識別          
011550           MOVE   Ｗ－状態            TO  共１－データ内容        
011560           MOVE   "ファイルオープン失敗 "                         
011570                                      TO  共１－その他メッセージ  
011580           CALL  CLOCO001          USING  IF-CHOCO001             
011590*                                                                 
011600        WHEN  -40                                                 
011610*--<  結合テーブルカーソル読込失敗     >                          
011620           MOVE  "1"                  TO  共１－イベント種別      
011630           MOVE  定数－プログラムＩＤ TO  共１－ソースＩＤ        
011640           MOVE  "9"                  TO  共１－復帰コード        
011650           MOVE  "YOSHSAI"            TO  共１－処理テーブルＩＤ  
011660           MOVE  "FETCH"              TO  共１－処理識別          
011670           MOVE  SQLCODE              TO  共１－データ内容        
011680           MOVE  SQLERRMC             TO  共１－その他メッセージ  
011690           CALL  CLOCO001          USING  IF-CHOCO001             
011700*                                                                 
011710*                                                                 
011720         WHEN  -60                                                
011730*--<     再リース回数処理失敗 >                                   
011740           MOVE  "2"                  TO  共１－イベント種別      
011750           MOVE  定数－プログラムＩＤ TO  共１－ソースＩＤ        
011760           MOVE  "9"                  TO  共１－復帰コード        
011770           MOVE  "IKO002"             TO  共１－処理テーブルＩＤ  
011780           MOVE  "SELECT"             TO  共１－処理識別          
011790           MOVE  SQLCODE              TO  共１－データ内容        
011800           MOVE  SQLERRMC             TO  共１－その他メッセージ  
011810           CALL  CLOCO001          USING  IF-CHOCO001             
011820           MOVE  "N"                  TO Ｗ－異常終了－フラグ     
011830                                                                  
011840*                                                                 
011850         WHEN  -70                                                
011860*--<   契約種類処理処理失敗 >                                     
011870           MOVE  "2"                  TO  共１－イベント種別      
011880           MOVE  定数－プログラムＩＤ TO  共１－ソースＩＤ        
011890           MOVE  "9"                  TO  共１－復帰コード        
011900           MOVE  "IKO002"             TO  共１－処理テーブルＩＤ  
011910           MOVE  "SELECT"             TO  共１－処理識別          
011920           MOVE  SQLCODE              TO  共１－データ内容        
011930           MOVE  SQLERRMC             TO  共１－その他メッセージ  
011940           CALL  CLOCO001          USING  IF-CHOCO001             
011950           MOVE  "N"                  TO Ｗ－異常終了－フラグ     
011960*                                                                 
011970         WHEN  -80                                                
011980*--<契約先コード処理失敗 >                                        
011990           MOVE  "2"                  TO  共１－イベント種別      
012000           MOVE  定数－プログラムＩＤ TO  共１－ソースＩＤ        
012010           MOVE  "9"                  TO  共１－復帰コード        
012020           MOVE  "IKOTL001"           TO  共１－処理テーブルＩＤ  
012030           MOVE  "SELECT"             TO  共１－処理識別          
012040           MOVE  SQLCODE              TO  共１－データ内容        
012050           MOVE  SQLERRMC             TO  共１－その他メッセージ  
012060           CALL  CLOCO001          USING  IF-CHOCO001             
012070          MOVE  "N"                  TO Ｗ－異常終了－フラグ      
012080                                                                  
012090         WHEN  -90                                                
012100*--<    契約内容 処理失敗 >                                       
012110           MOVE  "2"                  TO  共１－イベント種別      
012120           MOVE  定数－プログラムＩＤ TO  共１－ソースＩＤ        
012130           MOVE  "9"                  TO  共１－復帰コード        
012140           MOVE  "D31KYK"             TO  共１－処理テーブルＩＤ  
012150           MOVE  "SELECT"             TO  共１－処理識別          
012160           MOVE  SQLCODE              TO  共１－データ内容        
012170           MOVE  SQLERRMC             TO  共１－その他メッセージ  
012180           CALL  CLOCO001          USING  IF-CHOCO001             
012190           MOVE  "N"                  TO Ｗ－異常終了－フラグ     
012200                                                                  
012210         WHEN  -100                                               
012220*--<    Ｗ－消費税率処理失敗 >                                    
012230           MOVE  "2"                  TO  共１－イベント種別      
012240           MOVE  定数－プログラムＩＤ TO  共１－ソースＩＤ        
012250           MOVE  "9"                  TO  共１－復帰コード        
012260           MOVE  "D32SAK"             TO  共１－処理テーブルＩＤ  
012270           MOVE  "SELECT"             TO  共１－処理識別          
012280           MOVE  SQLCODE              TO  共１－データ内容        
012290           MOVE  SQLERRMC             TO  共１－その他メッセージ  
012300           CALL  CLOCO001          USING  IF-CHOCO001             
012310           MOVE  "N"                  TO Ｗ－異常終了－フラグ     
012320                                                                  
012330         WHEN  -110                                               
012340*--< WTITEファイル 処理失敗 >                                     
012350           MOVE  "1"                  TO  共１－イベント種別      
012360           MOVE  定数－プログラムＩＤ TO  共１－ソースＩＤ        
012370           MOVE  "9"                  TO  共１－復帰コード        
012380           MOVE  "FFUIS660"           TO  共１－処理テーブルＩＤ  
012390           MOVE  "WRITE"              TO  共１－処理識別          
012400           MOVE   Ｗ－状態            TO  共１－データ内容        
012410           MOVE   "WTITEファイル失敗"                             
012420                                      TO 共１－その他メッセージ   
012430           CALL  CLOCO001          USING  IF-CHOCO001             
012440                                                                  
012450*                                                                 
012460        WHEN  OTHER                                               
012470           MOVE  "N"                  TO Ｗ－異常終了－フラグ     
012480     END-EVALUATE.                                                
012490*                                                                 
012500     IF Ｗ－異常終了－フラグ  =  "Y"                              
012510*                                                                 
012520        PERFORM  件数メッセージ出力				
012530        PERFORM  終了メッセージ出力                               
012540*                                                                 
012550*--<    プログラム異常終了のリターンコード >                      
012560        MOVE  定数－異常状態          TO  PROGRAM-STATUS          
012570*                                                                 
012580        EXIT  PROGRAM                                             
012590     END-IF.                                                      
012600*                                                                 
012610 エラー判定処理－ＥＸＩＴ.                                        
012620     EXIT.                                                        
012630******************************************************************
012640*                  END OF PROGRAM                                *
012650******************************************************************
