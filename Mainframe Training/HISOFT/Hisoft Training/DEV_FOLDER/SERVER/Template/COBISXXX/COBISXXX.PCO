000010******************************************************************
000020*         ÅÉäCãPìÓåè(ëÂòA)ÅÑ                                     *
000030*      1. ÉvÉçÉOÉâÉÄñº  : ÇmÇmÇmÇm                               *
000040*      2. ÉvÉçÉOÉâÉÄID  : AAASED25                               *
000050*      3. èàóùäTóv      : ÇmÇmÇm                                 *
000060*                                                                *
000070*                                                                *
000080*      4. çÏê¨é“        : îCëÂóò                                 *
000090*      5. çÏê¨ì˙        : 2004.10.10                             *
000100******************************************************************
000110*                                                                 
000120******************************************************************
000130*    ÇhÇcÇdÇmÇsÇhÇeÇhÇbÇ`ÇsÇhÇnÇm  ÇcÇhÇuÇhÇrÇhÇnÇm              *
000140******************************************************************
000150 IDENTIFICATION                       DIVISION.                   
000160*                                                                 
000170 PROGRAM-ID.                          AAASED25.                   
000180******************************************************************
000190*    ÇdÇmÇuÇhÇqÇnÇmÇlÇdÇmÇs        ÇcÇhÇuÇhÇrÇhÇnÇm              *
000200******************************************************************
000210 ENVIRONMENT                          DIVISION.                   
000220******************************************************************
000230*    ÇhÇmÇoÇtÇsÅ|ÇnÇtÇsÇoÇtÇs      ÇrÇdÇbÇsÇhÇnÇm                *
000240******************************************************************
000250 INPUT-OUTPUT                         SECTION.                    
000260*                                                                 
000270 FILE-CONTROL.                                                    
000280     SELECT    ì¸óÕÉtÉ@ÉCÉã           ASSIGN    TO     U01        
000290     FILE      STATUS     IS          ÇvÅ|èÛë‘                    
000300     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000310*                                                                 
000320     SELECT    èoóÕÉtÉ@ÉCÉã           ASSIGN    TO     U11        
000330     FILE      STATUS     IS          ÇvÅ|èÛë‘                    
000340     ORGANIZATION         IS          LINE      SEQUENTIAL.       
000350*                                                                 
000360******************************************************************
000370*    ÇcÇ`ÇsÇ`                      ÇcÇhÇuÇhÇrÇhÇnÇm              *
000380******************************************************************
000390 DATA                                 DIVISION.                   
000400******************************************************************
000410*    ÇeÇhÇkÇd                      ÇrÇdÇbÇsÇhÇnÇm                *
000420******************************************************************
000430 FILE                                 SECTION.                    
000440*----------------------------------------------------------------*
000450*    ì¸óÕÉtÉ@ÉCÉã                                                *
000460*----------------------------------------------------------------*
000470 FD  ì¸óÕÉtÉ@ÉCÉã                                                 
000480     LABEL     RECORD     IS          STANDARD                    
000490     BLOCK     CONTAINS   0           RECORDS.                    
000500*                                                                 
000510 01  ì¸óÕÅ|ÉåÉRÅ[Éh.                                              
000520     COPY  CISUF470  REPLACING  ==()==  BY  ==ì¸óÕÅ|==.           
000530*----------------------------------------------------------------*
000540*    èoóÕÉtÉ@ÉCÉã                                                *
000550*----------------------------------------------------------------*
000560 FD  èoóÕÉtÉ@ÉCÉã                                                 
000570     LABEL     RECORD     IS          STANDARD                    
000580     BLOCK     CONTAINS   0           RECORDS.                    
000590*                                                                 
000600 01  èoóÕÅ|ÉåÉRÅ[Éh.                                              
000610     COPY  CISUF470  REPLACING  ==()==  BY  ==èoóÕÅ|==.           
000620*                                                                 
000630******************************************************************
000640*  ÇvÇnÇqÇjÇhÇmÇfÅ|ÇrÇsÇnÇqÇ`ÇfÇd  ÇrÇdÇbÇsÇhÇnÇm                *
000650******************************************************************
000660  WORKING-STORAGE                     SECTION.                    
000670*----------------------------------------------------------------*
000680*    ÉzÉXÉgïœêîíËã`ÉGÉäÉA                                        *
000690*----------------------------------------------------------------*
000700     EXEC  SQL  BEGIN  DECLARE        SECTION  END-EXEC.          
000710*                                                                 
000720*--< ÇnÇqÇ`ÇbÇkÇdã§í ïœêî >                                       
000730     EXEC  SQL  INCLUDE  SQLCOM.CBL            END-EXEC.          
000740*                                                                 
000750*--< ÇnÇqÇ`ÇbÇkÇd  ÇrÇpÇké¿çsèÓïÒ >                               
000760     EXEC  SQL  INCLUDE  SQLCA.COB             END-EXEC.          
000770*                                                                 
000780*--< à⁄çså„_ç¬å†ìWäJ >                                            
000790**     EXEC  SQL  INCLUDE  D411STK.CBL           END-EXEC.          
000800*                                                                 
000810     EXEC  SQL  END  DECLARE          SECTION  END-EXEC.          
000820*                                                                 
000830*----------------------------------------------------------------*
000840*    ÇvÇnÇqÇjÉGÉäÉA                                              *
000850*----------------------------------------------------------------*
000860 01  ÇvÇnÇqÇjÅ|ÉGÉäÉA.                                            
000870*--< ÉGÉâÅ[îªíËóp >                                               
000880     03  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh             PIC S9(04).                 
000890*                                                                 
000900*--< ÉtÉâÉOÉAÉäÉA >                                               
000910     03  ÉtÉâÉOÉAÉäÉA.                                            
000920         05  ÇvÅ|èIóπÅ|ÉtÉâÉO         PIC  X(01).                 
000930         05  ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     PIC  X(01).                 
000940*                                                                 
000950*--< åèêîÉGÉäÉA >                                                 
000960     03  åèêîÉGÉäÉA.                                              
000970         05  ÇvÅ|ì¸óÕÅ|åèêî           PIC  9(09).                 
000980         05  ÇvÅ|èoóÕÅ|åèêî           PIC  9(09).                 
000990*                                                                 
001000*--< ÉLÅ[ÉGÉäÉA >                                                 
001010     03  ÇjÇdÇxÅ|ÉGÉäÉA.                                          
001020        05  ÇmÇdÇvÉLÅ[.                                           
001030            07 ÇmÅ|å_ñÒî‘çÜ           PIC  X(09).                 
001040        05  ÇnÇkÇcÉLÅ[.                                           
001050            07 ÇnÅ|å_ñÒî‘çÜ           PIC  X(09).                 
001060*                                                                 
001070     03  ÇvÅ|èÛë‘                     PIC  X(02).                 
001080*--< ã§í èÓïÒ >                                                   
001090 01  ÇvÅ|ã§í èÓïÒ.                                                
001100     03  ÇvÅ|ÉVÉXÉeÉÄì˙ït.                                        
001110         05  ÇvÅ|ê¢ãI                 PIC  X(02) VALUE  "20".     
001120         05  ÇvÅ|îNåéì˙               PIC  X(06).                 
001130     03  ÇvÅ|ÉVÉXÉeÉÄéûçè             PIC  X(08).                 
001140     03  ÇvÅ|íSìñé“                   PIC  X(08) VALUE "IKOPG   ".
001150*                                                                 
001160*----------------------------------------------------------------*
001170*    ÉTÉuÉãÅ[É`Éìñº                                              *
001180*----------------------------------------------------------------*
001190 01  CALL-AREA.                                                   
001200*--< ã§í ÉçÉOÉTÉuÉãÅ[É`Éì >                                       
001210     03  CLOCO001                     PIC  X(08) VALUE "CLOCO001".
001220     03  COBCO001                     PIC  X(08) VALUE "COBCO001".
001230*                                                                 
001240*----------------------------------------------------------------*
001250*    ÇbÇnÇoÇxóÃàÊ                                                *
001260*----------------------------------------------------------------*
001270*--< ã§í ÉçÉOópÉpÉâÉÅÅ[É^ >                                       
001280 01  IF-CHOCO001.                                                 
001290     COPY  CHOCO001  REPLACING  ==()==  BY  ==ã§í Å|==.           
001300*                                                                 
001310*----------------------------------------------------------------*
001320*    ÇhÇmÇhÉtÉ@ÉCÉãì«çûÉTÉuÉãÅ[É`ÉìópÉpÉâÉÅÉ^óÃàÊ                *
001330*----------------------------------------------------------------*
001340 01  PARA-AREA.                                                   
001350     COPY CPBCO001.                                               
001360*                                                                 
001370*----------------------------------------------------------------*
001380*    ÉåÉRÅ[Éhèâä˙âªóÃàÊ                                          *
001390*----------------------------------------------------------------*
001400 01  èâä˙âªÉåÉRÅ[Éh.                                              
001410     COPY  CISUF470  REPLACING  ==()==  BY  ==èâä˙âªÅ|==.         
001420*                                                                 
001430******************************************************************
001440*    íËêîópÉfÅ[É^íËã`ÉGÉäÉA                                      *
001450******************************************************************
001460 CONSTANT                             SECTION.                    
001470 01  íËêîóÃàÊ.                                                    
001480     03  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc         PIC  X(08) VALUE "AAASED25".
001490     03  íËêîÅ|ÉvÉçÉOÉâÉÄñº           PIC  X(80)                  
001500                                      VALUE  "ÇmÇmÇmÇmÇm".        
001510     03  íËêîÅ|ÇrÇpÇkÇnÇj             PIC S9(04)  VALUE  ZERO.    
001520     03  íËêîÅ|ÇrÇpÇkÇdÇmÇc           PIC S9(04)  VALUE  0100.    
001530     03  íËêîÅ|ê≥èÌèÛë‘               PIC S9(04)  VALUE  ZERO.    
001540     03  íËêîÅ|àŸèÌèÛë‘               PIC S9(04)  VALUE  0009.    
001550******************************************************************
001560*    ÇoÇqÇnÇbÇdÇcÇtÇqÇd            ÇcÇhÇuÇhÇrÇhÇnÇm              *
001570******************************************************************
001580 PROCEDURE                            DIVISION.                   
001590*                                                                 
001600     PERFORM  èâä˙èàóù.                                           
001610*                                                                 
001620     PERFORM  éÂèàóù  UNTIL  ÇvÅ|èIóπÅ|ÉtÉâÉO  =  "Y".            
001630*                                                                 
001640     PERFORM  èIóπèàóù.                                           
001650*                                                                 
001660     STOP     RUN.                                                
001670*                                                                 
001680******************************************************************
001690*    èâä˙èàóù                                                    *
001700******************************************************************
001710 èâä˙èàóù                             SECTION.                    
001720 èâä˙èàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
001730*                                                                 
001740*----------------------------------------------------------------*
001750*    äJénÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
001760*----------------------------------------------------------------*
001770     INITIALIZE                       IF-CHOCO001.                
001780     MOVE  "3"                        TO  ã§í Å|ÉCÉxÉìÉgéÌï .     
001790     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§í Å|É\Å[ÉXÇhÇc.       
001800     MOVE  "0"                        TO  ã§í Å|ïúãAÉRÅ[Éh.       
001810     MOVE  "START"                    TO  ã§í Å|èàóùéØï .         
001820     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§í Å|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
001830     CALL  CLOCO001                USING  IF-CHOCO001.            
001840*                                                                 
001850*----------------------------------------------------------------*
001860*    çÏã∆óÃàÊÇÃèâä˙ílèàóù                                        *
001870*----------------------------------------------------------------*
001880     MOVE  SPACE                      TO  ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001890     INITIALIZE                           ÇvÇnÇqÇjÅ|ÉGÉäÉA.       
001900*                                                                 
001910     MOVE  LOW-VALUE                  TO  ÇnÇkÇcÉLÅ[.             
001920*                                                                 
001930*--< ÇbÇoÇtì˙ïtÇéÊìæ >                                           
001940     ACCEPT  ÇvÅ|îNåéì˙               FROM  DATE.                 
001950*                                                                 
001960*--< ÇbÇoÇtéûçèÇéÊìæ >                                           
001970     ACCEPT  ÇvÅ|ÉVÉXÉeÉÄéûçè         FROM  TIME.                 
001980*                                                                 
001990     PERFORM  ÉtÉ@ÉCÉãÉIÅ[ÉvÉì.                                   
002000*                                                                 
002010     PERFORM  ÇnÇqÇ`ÇbÇkÇdê⁄ë±.                                   
002020*                                                                 
002030     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`.                           
002040*                                                                 
002050*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû(ÇPåèñ⁄) >                           
002060     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
002070*                                                                 
002080 èâä˙èàóùÅ|ÇdÇwÇhÇs.                                              
002090     EXIT.                                                        
002100******************************************************************
002110*    ÇnÇqÇ`ÇbÇkÇdê⁄ë±                                            *
002120******************************************************************
002130 ÇnÇqÇ`ÇbÇkÇdê⁄ë±                     SECTION.                    
002140 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇrÇsÇ`ÇqÇs.                                    
002150*                                                                 
002160*--< ÇcÇaê⁄ë±ópèÓïÒÇéÊìæèàóù >                                   
002170     CALL  COBCO001                USING  PARA-AREA.              
002180*                                                                 
002190     MOVE  PARA-DBSTRING              TO  DB-STRING.              
002200     MOVE  PARA-USERNAME              TO  USERNAME.               
002210     MOVE  PARA-PASSWORD              TO  PASSWD.                 
002220*                                                                 
002230*----------------------------------------------------------------*
002240*    äJénê⁄ë±                                                    *
002250*----------------------------------------------------------------*
002260     IF    DB-STRING  =  SPACE                                    
002270        EXEC SQL                                                  
002280           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002290        END-EXEC                                                  
002300     ELSE                                                         
002310        EXEC SQL                                                  
002320           CONNECT  :USERNAME IDENTIFIED BY :PASSWD               
002330             USING  :DB-STRING                                    
002340        END-EXEC                                                  
002350     END-IF.                                                      
002360*                                                                 
002370*----------------------------------------------------------------*
002380*    ê⁄ë±ämîF                                                    *
002390*----------------------------------------------------------------*
002400     EVALUATE  SQLCODE                                            
002410        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
002420           CONTINUE                                               
002430        WHEN   OTHER                                              
002440*--<       ê⁄ë±ÉGÉâÅ[ >                                           
002450           MOVE     -10               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002460           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002470     END-EVALUATE.                                                
002480*                                                                 
002490 ÇnÇqÇ`ÇbÇkÇdê⁄ë±Å|ÇdÇwÇhÇs.                                      
002500     EXIT.                                                        
002510******************************************************************
002520*    ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                                            *
002530******************************************************************
002540 ÉtÉ@ÉCÉãÉIÅ[ÉvÉì                     SECTION.                    
002550 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇrÇsÇ`ÇqÇs.                                    
002560*                                                                 
002570*----------------------------------------------------------------*
002580*    ÇmÇmÇmÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉì                                    *
002590*----------------------------------------------------------------*
002600     OPEN  INPUT   ì¸óÕÉtÉ@ÉCÉã.                                  
002610*                                                                 
002620*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÇÃèÛë‘îªíË >                                 
002630     EVALUATE  ÇvÅ|èÛë‘                                           
002640        WHEN  ZERO                                                
002650           CONTINUE                                               
002660        WHEN  OTHER                                               
002670*--<       ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                               
002680           MOVE     -1                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002690           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002700     END-EVALUATE.                                                
002710*                                                                 
002720*----------------------------------------------------------------*
002730*    ÇmÇmÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉì                                      *
002740*----------------------------------------------------------------*
002750     OPEN  OUTPUT   èoóÕÉtÉ@ÉCÉã.                                 
002760*                                                                 
002770*--< ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÇÃèÛë‘îªíË >                                 
002780     EVALUATE  ÇvÅ|èÛë‘                                           
002790        WHEN  ZERO                                                
002800           CONTINUE                                               
002810        WHEN  OTHER                                               
002820*--<       ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                               
002830           MOVE     -2                TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
002840           PERFORM  ÉGÉâÅ[îªíËèàóù                                
002850     END-EVALUATE.                                                
002860*                                                                 
002870 ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÅ|ÇdÇwÇhÇs.                                      
002880     EXIT.                                                        
002890******************************************************************
002900*        åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`                                *
002910******************************************************************
002920 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`             SECTION.                    
002930 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇrÇsÇ`ÇqÇs.                            
002940*                                                                 
002950*----------------------------------------------------------------*
002960*    ÉJÅ[É\ÉãíËã`èàóù                                            *
002970*----------------------------------------------------------------*
002980**     EXEC SQL                                                     
002990**        DECLARE CUR1  CURSOR FOR                                  
003000**           SELECT  D411STK_TBL.å_ñÒî‘çÜ                           
003010**                  ,D411STK_TBL.çƒÉäÅ[ÉXâÒêî                       
003020**             FROM  D32SAK_TBL                                     
003030**                  ,D411STK_TBL                                    
003040**            WHERE  D32SAK_TBL.ïœë•ï•       =  '1'                 
003050**         ORDER BY  D411STK_TBL.å_ñÒî‘çÜ                           
003060**     END-EXEC.                                                    
003070*                                                                 
003080*----------------------------------------------------------------*
003090*    ÉJÅ[É\ÉãÇnÇoÇdÇmèàóù                                        *
003100*----------------------------------------------------------------*
003110**     EXEC  SQL                                                    
003120**        OPEN  CUR1                                                
003130**     END-EXEC.                                                    
003140*                                                                 
003150*----------------------------------------------------------------*
003160*    ÉJÅ[É\ÉãÇnÇoÇdÇmämîF                                        *
003170*----------------------------------------------------------------*
003180     EVALUATE  SQLCODE                                            
003190        WHEN  íËêîÅ|ÇrÇpÇkÇnÇj                                    
003200*--<       ê≥èÌ >                                                 
003210           CONTINUE                                               
003220        WHEN  OTHER                                               
003230*--<       ÉJÅ[É\ÉãÇnÇoÇdÇmÉGÉâÅ[ >                               
003240           MOVE -20                   TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003250           PERFORM  ÉGÉâÅ[îªíËèàóù                                
003260     END-EVALUATE.                                                
003270*                                                                 
003280 åãçáÉeÅ[ÉuÉãÉJÅ[É\ÉãíËã`Å|ÇdÇwÇhÇs.                              
003290     EXIT.                                                        
003300******************************************************************
003310*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû                                    *
003320******************************************************************
003330 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû             SECTION.                    
003340 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇrÇsÇ`ÇqÇs.                            
003350*                                                                 
003360*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû >                                   
003370**     EXEC SQL                                                     
003380**         FETCH  CUR1                                              
003390**          INTO  :ÇcÇSÇPÇPÅ|å_ñÒî‘çÜ                               
003400**               ,:ÇcÇSÇPÇPÅ|çƒÉäÅ[ÉXâÒêî                           
003410**     END-EXEC.                                                    
003420*                                                                 
003430*----------------------------------------------------------------*
003440*    åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÇämîF                              *
003450*----------------------------------------------------------------*
003460     EVALUATE   SQLCODE                                           
003470        WHEN   íËêîÅ|ÇrÇpÇkÇnÇj                                   
003480*--<       ê≥èÌ >                                                 
003490           COMPUTE  ÇvÅ|ì¸óÕÅ|åèêî  =  ÇvÅ|ì¸óÕÅ|åèêî  +  1       
003500        WHEN   íËêîÅ|ÇrÇpÇkÇdÇmÇc                                 
003510*--<       ì«çûèIóπ >                                             
003520           MOVE  "Y"                  TO  ÇvÅ|èIóπÅ|ÉtÉâÉO        
003530        WHEN   OTHER                                              
003540*--<       ì«çûÉGÉâÅ[ >                                           
003550           MOVE     -30               TO  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh        
003560           PERFORM  ÉGÉâÅ[îªíËèàóù                                
003570     END-EVALUATE.                                                
003580*                                                                 
003590 åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅ|ÇdÇwÇhÇs.                              
003600     EXIT.                                                        
003610******************************************************************
003620*    éÂèàóù                                                      *
003630******************************************************************
003640 éÂèàóù                               SECTION.                    
003650 éÂèàóùÅ|ÇrÇsÇ`ÇqÇs.                                              
003660*                                                                 
003670     PERFORM  ï“èWèoóÕèàóù.                                       
003680*                                                                 
003690*--< åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çûÅiÇQåèñ⁄à»ç~Åj >                     
003700     PERFORM  åãçáÉeÅ[ÉuÉãÉJÅ[É\Éãì«çû.                           
003710*                                                                 
003720 éÂèàóùÅ|ÇdÇwÇhÇs.                                                
003730     EXIT.                                                        
003740******************************************************************
003750*     ï“èWèoóÕèàóù                                               *
003760******************************************************************
003770 ï“èWèoóÕèàóù                         SECTION.                    
003780 ï“èWèoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                        
003790*                                                                 
003800*----------------------------------------------------------------*
003810*    ï“èWèàóù                                                    *
003820*----------------------------------------------------------------*
003830*                                                                 
003840     PERFORM  èoóÕèàóù.                                           
003850*                                                                 
003860 ï“èWèoóÕèàóùÅ|ÇdÇwÇhÇs.                                          
003870     EXIT.                                                        
003880******************************************************************
003890*    èoóÕèàóù                                                    *
003900******************************************************************
003910 èoóÕèàóù                             SECTION.                    
003920 èoóÕèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
003930*                                                                 
003940     COMPUTE  ÇvÅ|èoóÕÅ|åèêî  =  ÇvÅ|èoóÕÅ|åèêî  +  1.            
003950*                                                                 
003960 èoóÕèàóùÅ|ÇdÇwÇhÇs.                                              
003970     EXIT.                                                        
003980******************************************************************
003990*    èIóπèàóù                                                    *
004000******************************************************************
004010 èIóπèàóù                             SECTION.                    
004020 èIóπèàóùÅ|ÇrÇsÇ`ÇqÇs.                                            
004030*                                                                 
004040     PERFORM  ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóù.                               
004050*                                                                 
004060     PERFORM  ÇcÇaÉNÉçÅ[ÉYèàóù.                                   
004070*                                                                 
004080     PERFORM  ÇcÇaÉRÉ~ÉbÉgèàóù.                                   
004090*                                                                 
004100     PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ.                                 
004110*                                                                 
004120*--< ÉvÉçÉOÉâÉÄê≥èÌèIóπ >                                         
004130     MOVE  íËêîÅ|ê≥èÌèÛë‘             TO  PROGRAM-STATUS.         
004140*                                                                 
004150 èIóπèàóùÅ|ÇdÇwÇhÇs.                                              
004160     EXIT.                                                        
004170******************************************************************
004180*    ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóù                                        *
004190******************************************************************
004200 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóù                 SECTION.                    
004210 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùÅ|ÇrÇsÇ`ÇqÇs.                                
004220*                                                                 
004230     CLOSE  ì¸óÕÉtÉ@ÉCÉã.                                         
004240     CLOSE  èoóÕÉtÉ@ÉCÉã.                                         
004250*                                                                 
004260 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùÅ|ÇdÇwÇhÇs.                                  
004270     EXIT.                                                        
004280******************************************************************
004290*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
004300******************************************************************
004310 èIóπÉÅÉbÉZÅ[ÉWèoóÕ                   SECTION.                    
004320 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇrÇsÇ`ÇqÇs.                                  
004330*                                                                 
004340*----------------------------------------------------------------*
004350*    åèêîÉÅÉbÉZÅ[ÉWèoóÕèàóù                                      *
004360*----------------------------------------------------------------*
004370     INITIALIZE                       IF-CHOCO001.                
004380     MOVE  "3"                        TO  ã§í Å|ÉCÉxÉìÉgéÌï .     
004390     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§í Å|É\Å[ÉXÇhÇc.       
004400     MOVE  "0"                        TO  ã§í Å|ïúãAÉRÅ[Éh.       
004410     MOVE  "D411STK"                  TO  ã§í Å|èàóùÉeÅ[ÉuÉãÇhÇc. 
004420     MOVE  "COUNT"                    TO  ã§í Å|èàóùéØï .         
004430     MOVE  ÇvÅ|ì¸óÕÅ|åèêî             TO  ã§í Å|ÉfÅ[É^ì‡óe.       
004440     MOVE  "ÉåÉxÉãÉAÉbÉvç¬å†ìWäJì¸óÕåèêî"                         
004450                                      TO  ã§í Å|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
004460     CALL  CLOCO001                USING  IF-CHOCO001.            
004470*                                                                 
004480     INITIALIZE                       IF-CHOCO001.                
004490     MOVE  "3"                        TO  ã§í Å|ÉCÉxÉìÉgéÌï .     
004500     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§í Å|É\Å[ÉXÇhÇc.       
004510     MOVE  "0"                        TO  ã§í Å|ïúãAÉRÅ[Éh.       
004520     MOVE  "D34HNS"                   TO  ã§í Å|èàóùÉeÅ[ÉuÉãÇhÇc. 
004530     MOVE  "COUNT"                    TO  ã§í Å|èàóùéØï .         
004540     MOVE  ÇvÅ|èoóÕÅ|åèêî             TO  ã§í Å|ÉfÅ[É^ì‡óe.       
004550     MOVE  "ïœë•ï•DBèoóÕåèêî"         TO  ã§í Å|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
004560     CALL  CLOCO001                USING  IF-CHOCO001.            
004570*                                                                 
004580*----------------------------------------------------------------*
004590*    èIóπÉÅÉbÉZÅ[ÉWèoóÕ                                          *
004600*----------------------------------------------------------------*
004610     INITIALIZE                       IF-CHOCO001.                
004620     MOVE  "3"                        TO  ã§í Å|ÉCÉxÉìÉgéÌï .     
004630     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§í Å|É\Å[ÉXÇhÇc.       
004640     MOVE  "0"                        TO  ã§í Å|ïúãAÉRÅ[Éh.       
004650     MOVE  "END"                      TO  ã§í Å|èàóùéØï .         
004660     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄñº         TO  ã§í Å|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
004670     CALL  CLOCO001                USING  IF-CHOCO001.            
004680*                                                                 
004690 èIóπÉÅÉbÉZÅ[ÉWèoóÕÅ|ÇdÇwÇhÇs.                                    
004700     EXIT.                                                        
004710******************************************************************
004720*    ÇcÇaÉNÉçÅ[ÉY                                                *
004730******************************************************************
004740 ÇcÇaÉNÉçÅ[ÉYèàóù                     SECTION.                    
004750 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
004760*                                                                 
004770*--< ÉJÅ[É\Éã ÉNÉçÅ[ÉY >                                          
004780**     EXEC SQL                                                     
004790**        CLOSE  CUR1                                               
004800**     END-EXEC.                                                    
004810*                                                                 
004820 ÇcÇaÉNÉçÅ[ÉYèàóùÅ|ÇdÇwÇhÇs.                                      
004830     EXIT.                                                        
004840******************************************************************
004850*    ÇcÇaÉRÉ~ÉbÉgèàóù                                            *
004860******************************************************************
004870 ÇcÇaÉRÉ~ÉbÉgèàóù                     SECTION.                    
004880 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇrÇsÇ`ÇqÇs.                                    
004890*                                                                 
004900     EXEC  SQL                                                    
004910        COMMIT  WORK  RELEASE                                     
004920     END-EXEC.                                                    
004930*                                                                 
004940     INITIALIZE                       IF-CHOCO001.                
004950     MOVE  "3"                        TO  ã§í Å|ÉCÉxÉìÉgéÌï .     
004960     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§í Å|É\Å[ÉXÇhÇc.       
004970     MOVE  "0"                        TO  ã§í Å|ïúãAÉRÅ[Éh.       
004980     MOVE  "COMMIT"                   TO  ã§í Å|èàóùéØï .         
004990     MOVE  "ÉRÉ~ÉbÉgé¿é{"             TO  ã§í Å|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
005000     CALL  CLOCO001                USING  IF-CHOCO001.            
005010*                                                                 
005020 ÇcÇaÉRÉ~ÉbÉgèàóùÅ|ÇdÇwÇhÇs.                                      
005030     EXIT.                                                        
005040******************************************************************
005050*    ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                                        *
005060******************************************************************
005070 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                 SECTION.                    
005080 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóùÅ|ÇrÇsÇ`ÇqÇs.                                
005090*                                                                 
005100     EXEC  SQL                                                    
005110        ROLLBACK WORK  RELEASE                                    
005120     END-EXEC.                                                    
005130*                                                                 
005140     INITIALIZE                       IF-CHOCO001.                
005150     MOVE  "1"                        TO  ã§í Å|ÉCÉxÉìÉgéÌï .     
005160     MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc       TO  ã§í Å|É\Å[ÉXÇhÇc.       
005170     MOVE  "9"                        TO  ã§í Å|ïúãAÉRÅ[Éh.       
005180     MOVE  "ROLLBACK"                 TO  ã§í Å|èàóùéØï .         
005190     MOVE  "ÉçÅ[ÉãÉoÉbÉNé¿é{"         TO  ã§í Å|ÇªÇÃëºÉÅÉbÉZÅ[ÉW. 
005200     CALL  CLOCO001                USING  IF-CHOCO001.            
005210*                                                                 
005220 ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóùÅ|ÇdÇwÇhÇs.                                  
005230     EXIT.                                                        
005240******************************************************************
005250*    ÉGÉâÅ[èàóù                                                  *
005260******************************************************************
005270 ÉGÉâÅ[îªíËèàóù                       SECTION.                    
005280 ÉGÉâÅ[îªíËèàóùÅ|ÇrÇsÇ`ÇqÇs.                                      
005290*                                                                 
005300     MOVE  "Y"                        TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO.    
005310     INITIALIZE                           IF-CHOCO001.            
005320*                                                                 
005330     EVALUATE  ÇvÅ|ÉGÉâÅ[ÉRÅ[Éh                                   
005340        WHEN  -1                                                  
005350*--<       éùï™à»äOÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                       
005360           MOVE  "1"                  TO  ã§í Å|ÉCÉxÉìÉgéÌï       
005370           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§í Å|É\Å[ÉXÇhÇc        
005380           MOVE  "9"                  TO  ã§í Å|ïúãAÉRÅ[Éh        
005390           MOVE  "FFUIS47Q"           TO  ã§í Å|èàóùÉeÅ[ÉuÉãÇhÇc  
005400           MOVE  "OPEN"               TO  ã§í Å|èàóùéØï           
005410           MOVE  ÇvÅ|èÛë‘             TO  ã§í Å|ÉfÅ[É^ì‡óe        
005420           MOVE  "éùï™à»äOÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ "                
005430                                      TO  ã§í Å|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
005440           CALL  CLOCO001          USING  IF-CHOCO001             
005450*                                                                 
005460        WHEN  -2                                                  
005470*--<       éùï™ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ >                           
005480           MOVE  "1"                  TO  ã§í Å|ÉCÉxÉìÉgéÌï       
005490           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§í Å|É\Å[ÉXÇhÇc        
005500           MOVE  "9"                  TO  ã§í Å|ïúãAÉRÅ[Éh        
005510           MOVE  "FFUIS47R"           TO  ã§í Å|èàóùÉeÅ[ÉuÉãÇhÇc  
005520           MOVE  "OPEN"               TO  ã§í Å|èàóùéØï           
005530           MOVE  ÇvÅ|èÛë‘             TO  ã§í Å|ÉfÅ[É^ì‡óe        
005540           MOVE  "éùï™ÉtÉ@ÉCÉãÉIÅ[ÉvÉìÉGÉâÅ[ "                    
005550                                      TO  ã§í Å|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
005560           CALL  CLOCO001          USING  IF-CHOCO001             
005570*                                                                 
005580        WHEN  -10                                                 
005590*--<       ÇnÇqÇ`ÇbÇkÇdê⁄ë±é∏îs >                                 
005600           MOVE  "1"                  TO  ã§í Å|ÉCÉxÉìÉgéÌï       
005610           MOVE  íËêîÅ|ÉvÉçÉOÉâÉÄÇhÇc TO  ã§í Å|É\Å[ÉXÇhÇc        
005620           MOVE  "9"                  TO  ã§í Å|ïúãAÉRÅ[Éh        
005630           MOVE  "CONNECT"            TO  ã§í Å|èàóùéØï           
005640           MOVE  SQLCODE              TO  ã§í Å|ÉfÅ[É^ì‡óe        
005650           MOVE  SQLERRMC             TO  ã§í Å|ÇªÇÃëºÉÅÉbÉZÅ[ÉW  
005660           CALL  CLOCO001          USING  IF-CHOCO001             
005670*                                                                 
005680        WHEN  OTHER                                               
005690           MOVE  "N"                  TO ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO     
005700     END-EVALUATE.                                                
005710*                                                                 
005720     IF ÇvÅ|àŸèÌèIóπÅ|ÉtÉâÉO  =  "Y"                              
005730        PERFORM  ÇcÇaÉçÅ[ÉãÉoÉbÉNèàóù                             
005740*                                                                 
005750        PERFORM  èIóπÉÅÉbÉZÅ[ÉWèoóÕ                               
005760*                                                                 
005770*--<    ÉvÉçÉOÉâÉÄàŸèÌèIóπÇÃÉäÉ^Å[ÉìÉRÅ[Éh >                      
005780        MOVE  íËêîÅ|àŸèÌèÛë‘          TO  PROGRAM-STATUS          
005790*                                                                 
005800        EXIT  PROGRAM                                             
005810     END-IF.                                                      
005820*                                                                 
005830 ÉGÉâÅ[îªíËèàóùÅ|ÇdÇwÇhÇs.                                        
005840     EXIT.                                                        
005850******************************************************************
005860*                  END OF PROGRAM                                *
005870******************************************************************
