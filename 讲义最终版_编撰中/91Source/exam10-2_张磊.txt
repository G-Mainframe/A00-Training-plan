      IDENTIFICATION DIVISION.
      PROGRAM-ID.     EXAM102.
      ENVIRONMENT DIVISION.
      INPUT-OUTPUT SECTION.
      FILE-CONTROL.
            SELECT DA-FILE ASSIGN TO DA-FILE
                   ORGANIZATION IS SEQUENTIAL
                   ACCESS MODE IS SEQUENTIAL.
            SELECT IN-FILE ASSIGN TO IN-FILE
                   ORGANIZATION IS SEQUENTIAL
                   ACCESS MODE IS SEQUENTIAL.
      DATA DIVISION.
      FILE SECTION.
      FD DA-FILE LABEL RECORD IS STANDARD
         DATA RECORD IS DAREC.
      01 DAREC.
         02 DA-PRODUCT-CODE PIC X(4).
         02 DA-PRODUCT-NAME PIC X(10).
         02 DA-ON-HAND-QTY  PIC 9(5).
      FD IN-FILE LABEL RECORD IS STANDARD
         DATA RECORD IS INREC.
      01 INREC.
         02 IN-PRODUCT-CODE PIC X(4).
         02 IN-R-1-CODE     PIC X.
         02 IN-QTY          PIC 9(5).
      PROCEDURE DIVISION.
      START-RUN.
            OPEN INPUT IN-FILE.
            I-O DA-FILE.
      READ DA-FILE
         AT END MOVE HIGH-VALUE TO DA-PRODUCT-CODE.
      READ IN-FILE
         AT END MOVE HIGH-VALUE TO DA-PRODUCT-CODE.
      PERFORM RECORD PROCESSING
              UNTIL IN-PRODUCT-CODE = HIGH-VALUE.
      CLOSE IN-FILE DA-FILE.
      STOP RUN.

      RECORD-PROCESSING.
      IF DA-PRODUCTION-CODE<IN-PRODUCT-CODE
         PERFORM SKIP.
      ELSE
         IF DA-PRODUCT-CODE = IN-PRODUCT-CODE
            PERFORM MODIFY.
         ELSE
            PERFORM ERR.
      SKIP.
         READ DA-FILE.
            AT END MOVE HIGH-VALUE TO DA-PRODUCT-CODE.
      MODIFY.
         IF IN-R-I-CODE = 'R'
            ADD IN-QTY TO DA-ON-HAND-QTY.
         ELSE
            SUBTRACT IN-QTY FROM DA-ON-HAND-QTY.
         REWRITE DAREC.
         READ IN-FILE
            AT END MOVE HIGH-VALUE TO IN-PRODUCT-CODE.
      ERR.
         DISPLAY 'HAVE NOT THIS PRODUCT',INREC.
         READ IN-FILE
            AT END MOVE HIGH-VALUE TO IN-PRODUCT-CODE.
